# **SEDRA/SMITH Microelectronic Circuits**

## **SEVENTH EDITION**


# Microelectronic Circuits
# THE OXFORD SERIES IN ELECTRICAL AND COMPUTER ENGINEERING 

Adel S. Sedra, Series Editor

Allen and Holberg, CMOS Analog Circuit Design, 3rd edition
Bobrow, Elementary Linear Circuit Analysis, 2nd edition
Bobrow, Fundamentals of Electrical Engineering, 2nd edition
Campbell, Fabrication Engineering at the Micro- and Nanoscale, 4th edition
Chen, Digital Signal Processing
Chen, Linear System Theory and Design, 4th edition
Chen, Signals and Systems, 3rd edition
Comer, Digital Logic and State Machine Design, 3rd edition
Comer, Microprocessor-Based System Design
Cooper and McGillem, Probabilistic Methods of Signal and System Analysis, 3rd edition
Dimitrijev, Principles of Semiconductor Device, 2nd edition
Dimitrijev, Understanding Semiconductor Devices
Fortney, Principles of Electronics: Analog \& Digital
Franco, Electric Circuits Fundamentals
Ghausi, Electronic Devices and Circuits: Discrete and Integrated
Guru and Hiziroğlu, Electric Machinery and Transformers, 3rd edition
Houts, Signal Analysis in Linear Systems
Jones, Introduction to Optical Fiber Communication Systems
Krein, Elements of Power Electronics
Kuo, Digital Control Systems, 2nd edition
Lathi, Linear Systems and Signals, 2nd edition
Lathi and Ding, Modern Digital and Analog Communication Systems, 4th edition
Lathi, Signal Processing and Linear Systems
Martin, Digital Integrated Circuit Design
Miner, Lines and Electromagnetic Fields for Engineers
Parhami, Computer Architecture
Parhami, Computer Arithmetic, 2nd edition
Roberts and Sedra, SPICE, 2nd edition
Roberts, Taenzler, and Burns, An Introduction to Mixed-Signal IC Test and Measurement, 2nd edition
Roulston, An Introduction to the Physics of Semiconductor Devices
Sadiku, Elements of Electromagnetics, 6th edition
Santina, Stubberud, and Hostetter, Digital Control System Design, 2nd edition
Sarma, Introduction to Electrical Engineering
Schaumann, Xiao, and Van Valkenburg, Design of Analog Filters, 3rd edition
Schwarz and Oldham, Electrical Engineering: An Introduction, 2nd edition
Sedra and Smith, Microelectronic Circuits, 7th edition
Stefani, Shahian, Savant, and Hostetter, Design of Feedback Control Systems, 4th edition
Tsividis/McAndrew, Operation and Modeling of the MOS Transistor, 3rd edition
Van Valkenburg, Analog Filter Design
Warner and Grung, Semiconductor Device Electronics
Wolovich, Automatic Control Systems
Yariv and Yeh, Photonics: Optical Electronics in Modern Communications, 6th edition
Żak, Systems and Control
# SEVENTH EDITION 

## Microelectronic Circuits

Adel S. Sedra<br>University of Waterloo

Kenneth C. Smith
University of Toronto
Oxford University Press is a department of the University of Oxford. It furthers the University's objective of excellence in research, scholarship, and education by publishing worldwide.

Oxford New York
Auckland Cape Town Dar es Salaam Hong Kong Karachi
Kuala Lumpur Madrid Melbourne Mexico City Nairobi
New Delhi Shanghai Taipei Toronto
With offices in
Argentina Austria Brazil Chile Czech Republic France Greece
Guatemala Hungary Italy Japan Poland Portugal Singapore
South Korea Switzerland Thailand Turkey Ukraine Vietnam
Copyright (C) 2015, 2010, 2004, 1998 by Oxford University Press;
1991, 1987 Holt, Rinehart, and Winston, Inc.; 1982 CBS College Publishing
For titles covered by Section 112 of the US Higher Education
Opportunity Act, please visit www.oup.com/us/he for the
latest information about pricing and alternate formats.
Published in the United States of America by
Oxford University Press
198 Madison Avenue, New York, NY 10016
http://www.oup.com
Oxford is a registered trade mark of Oxford University Press.
All rights reserved. No part of this publication may be reproduced,
stored in a retrieval system, or transmitted, in any form or by any means,
electronic, mechanical, photocopying, recording, or otherwise,
without the prior permission of Oxford University Press.

# Library of Congress Cataloging-in-Publication Data 

Sedra, Adel S., author.
Microelectronic circuits / Adel S. Sedra, University of Waterloo, Kenneth C. Smith,
University of Toronto. - Seventh edition.
pages cm . - (The Oxford series in electrical and computer engineering)
Includes bibliographical references and index.
ISBN 978-0-19-933913-6

1. Electronic circuits. 2. Integrated circuits. I. Smith,

Kenneth C. (Kenneth Carless), author. II. Title.
TK7867.S39 2014
$621.3815-\mathrm{dc} 23$
2014033965
Multisim and National Instruments are trademarks of National Instruments. The Sedra/Smith, Microelectronic Circuits, Seventh Edition book is a product of Oxford University Press, not National Instruments Corporation or any of its affiliated companies, and Oxford University Press is solely responsible for the Sedra/Smith book and its content. Neither Oxford University Press, the Sedra/Smith book, nor any of the books and other goods and services offered by Oxford University Press are official publications of National Instruments Corporation or any of its affiliated companies, and they are not affiliated with, endorsed by, or sponsored by National Instruments Corporation or any of its affiliated companies.
OrCad and PSpice are trademarks of Cadence Design Systems, Inc. The Sedra/Smith, Microelectronic Circuits, Seventh Edition book is a product of Oxford University Press, not Cadence Design Systems, Inc., or any of its affiliated companies, and Oxford University Press is solely responsible for the Sedra/Smith book and its content. Neither Oxford University Press, the Sedra/Smith book, nor any of the books and other goods and services offered by Oxford University Press are official publications of Cadence Design Systems, Inc. or any of its affiliated companies, and they are not affiliated with, endorsed by, or sponsored by Cadence Design Systems, Inc. or any of its affiliated companies.
Cover Photo: This 3D IC system demonstrates the concept of wireless power delivery and communication through multiple layers of CMOS chips. The communication circuits were demonstrated in an IBM 45 nm SOI CMOS process. This technology is designed to serve a multi-Gb/s interconnect between cores spread across several IC layers for high-performance processors.
(Photo Credit: The picture is courtesy of Professor David Wentzloff, Director of the Wireless Integrated Circuits Group at the University of Michigan, and was edited by Muhammad Faisal, Founder of Movellus Circuits Incorporated.)

Printing number: 987654321
Printed in the United States of America
on acid-free paper
# BRIEF TABLE OF CONTENTS 

Tables xvi
"Expand-Your-Perspective" Notes xvii
Preface xix
PART I DEVICES AND BASIC CIRCUITS ..... 2
1 Signals and Amplifiers ..... 4
2 Operational Amplifiers ..... 58
3 Semiconductors ..... 134
4 Diodes ..... 174
5 MOS Field-Effect Transistors (MOSFETs) ..... 246
6 Bipolar Junction Transistors (BJTs) ..... 304
7 Transistor Amplifiers ..... 366
PART II INTEGRATED-CIRCUIT AMPLIFIERS ..... 506
8 Building Blocks of Integrated-Circuit Amplifiers ..... 508
9 Differential and Multistage Amplifiers ..... 594
10 Frequency Response ..... 696
11 Feedback ..... 806
12 Output Stages and Power Amplifiers ..... 920
13 Operational Amplifier Circuits ..... 994
PART III DIGITAL INTEGRATED CIRCUITS ..... 1086
14 CMOS Digital Logic Circuits ..... 1088
15 Advanced Topics in Digital Integrated-Circuit Design ..... 1166
16 Memory Circuits ..... 1236
PART IV FILTERS AND OSCILLATORS ..... 1288
17 Filters and Tuned Amplifiers ..... 1290
18 Signal Generators and Waveform-Shaping Circuits ..... 1378
Appendices A-L
Index IN-1
# CONTENTS 

Tables xvi
"Expand-Your-Perspective"
Notes xvii
Preface xix
PART I DEVICES AND BASIC
CIRCUITS 2
1 Signals and Amplifiers ..... 4
Introduction ..... 5
1.1 Signals ..... 6
1.2 Frequency Spectrum of Signals ..... 9
1.3 Analog and Digital Signals ..... 12
1.4 Amplifiers ..... 15
1.4.1 Signal Amplification ..... 15
1.4.2 Amplifier Circuit Symbol ..... 16
1.4.3 Voltage Gain ..... 17
1.4.4 Power Gain and Current Gain ..... 17
1.4.5 Expressing Gain in Decibels ..... 18
1.4.6 The Amplifier Power Supplies ..... 18
1.4.7 Amplifier Saturation ..... 21
1.4.8 Symbol Convention ..... 22
1.5 Circuit Models for Amplifiers ..... 23
1.5.1 Voltage Amplifiers ..... 23
1.5.2 Cascaded Amplifiers ..... 25
1.5.3 Other Amplifier Types ..... 28
1.5.4 Relationships between the Four Amplifier Models ..... 28
1.5.5 Determining $R_{i}$ and $R_{o}$ ..... 29
1.5.6 Unilateral Models ..... 29
1.6 Frequency Response of Amplifiers ..... 33
1.6.1 Measuring the Amplifier Frequency Response ..... 33
1.6.2 Amplifier Bandwidth ..... 34
1.6.3 Evaluating the Frequency Response of Amplifiers ..... 34
1.6.4 Single-Time-Constant Networks ..... 35
1.6.5 Classification of Amplifiers Based on Frequency Response ..... 41
Summary ..... 44
Problems ..... 45

## 2 Operational Amplifiers 58

Introduction 59
2.1 The Ideal Op Amp 60
2.1.1 The Op-Amp Terminals 60
2.1.2 Function and Characteristics of the Ideal Op Amp 61
2.1.3 Differential and Common-Mode Signals 63
2.2 The Inverting Configuration 64
2.2.1 The Closed-Loop Gain 65
2.2.2 Effect of the Finite Open-Loop Gain 67
2.2.3 Input and Output Resistances 68
2.2.4 An Important Application-The Weighted Summer 71
2.3 The Noninverting Configuration 73
2.3.1 The Closed-Loop Gain 73
2.3.2 Effect of Finite Open-Loop Gain 75
2.3.3 Input and Output Resistance 75
2.3.4 The Voltage Follower 75
2.4 Difference Amplifiers 77
2.4.1 A Single-Op-Amp Difference Amplifier 78
2.4.2 A Superior Circuit-The Instrumentation Amplifier 82
2.5 Integrators and Differentiators 87
2.5.1 The Inverting Configuration with General Impedances 87
2.5.2 The Inverting Integrator 89
2.5.3 The Op-Amp Differentiator 94
2.6 DC Imperfections 96
2.6.1 Offset Voltage 96
2.6.2 Input Bias and Offset Currents 100
2.6.3 Effect of $V_{O S}$ and $I_{O S}$ on the Operation of the Inverting Integrator 103
2.7 Effect of Finite Open-Loop Gain and Bandwidth on Circuit Performance 105
2.7.1 Frequency Dependence of the Open-Loop Gain 105
2.7.2 Frequency Response of Closed-Loop Amplifiers 107
2.8 Large-Signal Operation of Op Amps ..... 110
2.8.1 Output Voltage Saturation ..... 110
2.8.2 Output Current Limits ..... 110
2.8.3 Slew Rate ..... 112
2.8.4 Full-Power Bandwidth ..... 114
Summary ..... 115
Problems ..... 116
3 Semiconductors ..... 134
Introduction ..... 135
3.1 Intrinsic Semiconductors ..... 136
3.2 Doped Semiconductors ..... 139
3.3 Current Flow in Semiconductors ..... 142
3.3.1 Drift Current ..... 142
3.3.2 Diffusion Current ..... 145
3.3.3 Relationship between $D$ and $\mu$ ..... 148
3.4 The $p n$ Junction ..... 148
3.4.1 Physical Structure ..... 149
3.4.2 Operation with Open-Circuit Terminals ..... 149
3.5 The $p n$ Junction with an Applied Voltage ..... 155
3.5.1 Qualitative Description of Junction Operation ..... 155
3.5.2 The Current-Voltage Relationship of the Junction ..... 158
3.5.3 Reverse Breakdown ..... 162
3.6 Capacitive Effects in the $p n$ Junction ..... 164
3.6.1 Depletion or Junction Capacitance ..... 164
3.6.2 Diffusion Capacitance ..... 166
Summary ..... 168
Problems ..... 171
4 Diodes ..... 174
Introduction ..... 175
4.1 The Ideal Diode ..... 176
4.1.1 Current-Voltage Characteristic ..... 176
4.1.2 A Simple Application: The Rectifier ..... 177
4.1.3 Another Application: Diode Logic Gates ..... 180
4.2 Terminal Characteristics of Junction Diodes ..... 184
4.2.1 The Forward-Bias Region ..... 184
4.2.2 The Reverse-Bias Region ..... 189
4.2.3 The Breakdown Region ..... 190
4.3 Modeling the Diode Forward Characteristic ..... 190
4.3.1 The Exponential Model ..... 190
4.3.2 Graphical Analysis Using the Exponential Model ..... 191
4.3.3 Iterative Analysis Using the Exponential Model ..... 191
4.3.4 The Need for Rapid Analysis ..... 192
4.3.5 The Constant-Voltage-Drop Model ..... 193
4.3.6 The Ideal-Diode Model ..... 194
4.3.7 The Small-Signal Model ..... 195
4.3.8 Use of the Diode Forward Drop in Voltage Regulation ..... 200
4.4 Operation in the Reverse Breakdown Region-Zener Diodes ..... 202
4.4.1 Specifying and Modeling the Zener Diode ..... 203
4.4.2 Use of the Zener as a Shunt Regulator ..... 204
4.4.3 Temperature Effects ..... 206
4.4.4 A Final Remark ..... 207
4.5 Rectifier Circuits ..... 207
4.5.1 The Half-Wave Rectifier ..... 208
4.5.2 The Full-Wave Rectifier ..... 210
4.5.3 The Bridge Rectifier ..... 212
4.5.4 The Rectifier with a Filter Capacitor-The Peak Rectifier ..... 213
4.5.5 Precision Half-Wave Rectifier-The Superdiode ..... 219
4.6 Limiting and Clamping Circuits ..... 221
4.6.1 Limiter Circuits ..... 221
4.6.2 The Clamped Capacitor or DC Restorer ..... 224
4.6.3 The Voltage Doubler ..... 226
4.7 Special Diode Types ..... 227
4.7.1 The Schottky-Barrier Diode (SBD) ..... 227
4.7.2 Varactors ..... 228
4.7.3 Photodiodes ..... 228
4.7.4 Light-Emitting Diodes (LEDs) ..... 228
Summary ..... 229
Problems ..... 230
5 MOS Field-Effect Transistors (MOSFETs) ..... 246
Introduction ..... 247
5.1 Device Structure and Physical Operation ..... 248
5.1.1 Device Structure ..... 248
5.1.2 Operation with Zero Gate Voltage ..... 250
5.1.3 Creating a Channel for Current Flow ..... 250
5.1.4 Applying a Small $v_{D S}$ ..... 252
5.1.5 Operation as $v_{D S}$ Is Increased ..... 256
5.1.6 Operation for $v_{D S} \geq V_{O V}$ :
Channel Pinch-Off and Current Saturation ..... 258
5.1.7 The $p$-Channel MOSFET ..... 261
5.1.8 Complementary MOS or CMOS ..... 263
5.1.9 Operating the MOS Transistor in the Subthreshold Region ..... 264
5.2 Current-Voltage Characteristics ..... 264
5.2.1 Circuit Symbol ..... 264
5.2.2 The $i_{D}-v_{D S}$ Characteristics ..... 265
5.2.3 The $i_{D}-v_{G S}$ Characteristic ..... 267
5.2.4 Finite Output Resistance in Saturation ..... 271
5.2.5 Characteristics of the $p$-Channel MOSFET ..... 274
5.3 MOSFET Circuits at DC ..... 276
5.4 The Body Effect and Other Topics ..... 288
5.4.1 The Role of the Substrate-The Body Effect ..... 288
5.4.2 Temperature Effects ..... 289
5.4.3 Breakdown and Input Protection ..... 289
5.4.4 Velocity Saturation ..... 290
5.4.5 The Depletion-Type MOSFET ..... 290
Summary ..... 291
Problems ..... 292
6 Bipolar Junction Transistors (BJTs) ..... 304
Introduction ..... 305
6.1 Device Structure and Physical Operation ..... 306
6.1.1 Simplified Structure and Modes of Operation ..... 306
6.1.2 Operation of the $n p n$ Transistor in the Active Mode ..... 307
6.1.3 Structure of Actual Transistors ..... 315
6.1.4 Operation in the Saturation Mode ..... 316
6.1.5 The $p n p$ Transistor ..... 318
6.2 Current-Voltage Characteristics ..... 320
6.2.1 Circuit Symbols and Conventions ..... 320
6.2.2 Graphical Representation of Transistor Characteristics ..... 325
6.2.3 Dependence of $i_{C}$ on the Collector Voltage-The Early Effect ..... 326
6.2.4 An Alternative Form of the Common-Emitter Characteristics ..... 329
6.3 BJT Circuits at DC ..... 333
6.4 Transistor Breakdown and Temperature Effects ..... 351
6.4.1 Transistor Breakdown ..... 351
6.4.2 Dependence of $\beta$ on $I_{C}$ and Temperature ..... 353
Summary ..... 354
Problems ..... 355
7 Transistor Amplifiers ..... 366
Introduction ..... 367
7.1 Basic Principles ..... 368
7.1.1 The Basis for Amplifier Operation ..... 368
7.1.2 Obtaining a Voltage Amplifier ..... 369
7.1.3 The Voltage-Transfer Characteristic (VTC) ..... 370
7.1.4 Obtaining Linear Amplification by Biasing the Transistor ..... 371
7.1.5 The Small-Signal Voltage Gain ..... 374
7.1.6 Determining the VTC by Graphical Analysis ..... 380
7.1.7 Deciding on a Location for the Bias Point Q ..... 381
7.2 Small-Signal Operation and Models ..... 383
7.2.1 The MOSFET Case ..... 383
7.2.2 The BJT Case ..... 399
7.2.3 Summary Tables ..... 420
7.3 Basic Configurations ..... 423
7.3.1 The Three Basic Configurations ..... 423
7.3.2 Characterizing Amplifiers ..... 424
7.3.3 The Common-Source (CS) and Common-Emitter (CE) Amplifiers ..... 426
7.3.4 The Common-Source (Common-Emitter) Amplifier with a Source (Emitter) Resistance ..... 431
7.3.5 The Common-Gate (CG) and the Common-Base (CB) Amplifiers ..... 439
7.3.6 The Source and Emitter Followers ..... 442
7.3.7 Summary Tables and Comparisons ..... 452
7.3.8 When and How to Include the Transistor Output Resistance $r_{o} \quad 453$
7.4 Biasing 454
7.4.1 The MOSFET Case 455
7.4.2 The BJT Case 461
7.5 Discrete-Circuit Amplifiers 467
7.5.1 A Common-Source (CS) Amplifier 467
7.5.2 A Common-Emitter (CE) Amplifier 470
7.5.3 A Common-Emitter Amplifier with an Emitter Resistance $R_{e} \quad 471$
7.5.4 A Common-Base (CB) Amplifier 473
7.5.5 An Emitter Follower 475
7.5.6 The Amplifier Frequency Response 477
Summary 479
Problems 480

## PART II INTEGRATED-CIRCUIT AMPLIFIERS 506

## 8 Building Blocks of IntegratedCircuit Amplifiers 508

Introduction 509
8.1 IC Design Philosophy 510
8.2 IC Biasing-Current Sources, Current Mirrors, and Current-Steering Circuits 511
8.2.1 The Basic MOSFET Current Source 512
8.2.2 MOS Current-Steering Circuits 515
8.2.3 BJT Circuits 518
8.2.4 Small-Signal Operation of Current Mirrors 523
8.3 The Basic Gain Cell 525
8.3.1 The CS and CE Amplifiers with Current-Source Loads 525
8.3.2 The Intrinsic Gain 527
8.3.3 Effect of the Output Resistance of the Current-Source Load 530
8.3.4 Increasing the Gain of the Basic Cell 536
8.4 The Common-Gate and Common-Base Amplifiers 537
8.4.1 The CG Circuit 537
8.4.2 Output Resistance of a CS Amplifier with a Source Resistance 541
8.4.3 The Body Effect 542
8.4.4 The CB Circuit 543
8.4.5 Output Resistance of an EmitterDegenerated CE Amplifier 546
8.5 The Cascode Amplifier 546
8.5.1 Cascoding 546
8.5.2 The MOS Cascode Amplifier 547
8.5.3 Distribution of Voltage Gain in a Cascode Amplifier 552
8.5.4 Double Cascoding 555
8.5.5 The Folded Cascode 555
8.5.6 The BJT Cascode 557
8.6 Current-Mirror Circuits with Improved Performance 559
8.6.1 Cascode MOS Mirrors 559
8.6.2 The Wilson Current Mirror 560
8.6.3 The Wilson MOS Mirror 563
8.6.4 The Widlar Current Souce 565
8.7 Some Useful Transistor Pairings 567
8.7.1 The $\mathrm{CC}-\mathrm{CE}, \mathrm{CD}-\mathrm{CS}$, and $\mathrm{CD}-\mathrm{CE}$ Configurations 567
8.7.2 The Darlington Configuration 571
8.7.3 The $\mathrm{CC}-\mathrm{CB}$ and $\mathrm{CD}-\mathrm{CG}$ Configurations 572
Summary 575
Problems 576

## 9 Differential and Multistage Amplifiers 594

Introduction 595
9.1 The MOS Differential Pair 596
9.1.1 Operation with a Common-Mode Input Voltage 597
9.1.2 Operation with a Differential Input Voltage 601
9.1.3 Large-Signal Operation 602
9.1.4 Small-Signal Operation 607
9.1.5 The Differential Amplifier with Current-Source Loads 611
9.1.6 Cascode Differential Amplifier 612
9.2 The BJT Differential Pair 614
9.2.1 Basic Operation 614
9.2.2 Input Common-Mode Range 616
9.2.3 Large-Signal Operation 617
9.2.4 Small-Signal Operation 620
9.3 Common-Mode Rejection 627
9.3.1 The MOS Case 628
9.3.2 The BJT Case 634
9.4 DC Offset 637# 12.10.2 Power BJTs 

Device Structure The power BJT utilizes a variation on the basic structure in Fig. 6.7. Specifically:

1. To increase the current-handling capability of the BJT while maintaining the current density at a reasonable level, the emitter area is made much larger. This is accomplished by utilizing multiple emitter regions (called "emitter fingers") and connecting them together, as shown in the simplified device cross section in Fig. 12.37. To reduce the extrinsic base resistance $r_{x}$, the width of each emitter finger is kept small.
2. To support higher voltages without device breakdown, the base is made wider (with the attendant reduction in $\beta$ ), and the collector is made thicker and its doping lighter. Again, these features are indicated in Fig. 12.37.

Device Parameters As a result of the structural differences, the parameters of power BJTs can differ somewhat from those of small-signal devices. Important differences include the following.

1. The current gain $\beta$ is low, typically in the range of 10 to 80 , but can be as low as 5. Here it is important to recall that $\beta$ is a function of current and has a positive temperature coefficient (refer to Fig. 6.34).
2. The maximum collector current $I_{C \max }$ is typically in the ampere range but can be as high as 100 A .
3. The breakdown voltage ( $B V_{C E O}$; refer to Fig. 6.33) is typically 50 V to 100 V but can be as high as 500 V .
4. $I_{C B O}$ is large (a few tens of microamps) and, as usual, doubles for every $10^{\circ} \mathrm{C}$ rise in temperature.


Figure 12.37 Cross section of a power BJT.
5. At high currents, $r_{a}$ becomes small (a few ohms) and the extrinsic base resistance $r_{x}$ becomes important.
6. The transition frequency $f_{T}$ is low (a few megahertz), $C_{p}$ is large (hundreds of picofarads), and $C_{\pi}$ is even larger.
7. At high currents, the exponential $i_{C}-v_{B E}$ relationship exhibits a factor-of-2 reduction in the exponent: that is, $i_{C}=I_{S} e^{v_{B E} / 2 V_{T}}$.

At large collector currents, the low $\beta$ results in the requirement for a large base current. This can complicate the design of the circuit that drives the output transistors. The Darlington configuration discussed in Section 12.6 can be employed to provide a higher effective $\beta$.

The BJT Safe Operating Area The power dissipated in a BJT results in an increase in its temperature and thus power dissipation must be limited. The manufacturer specifies the maximum power that can be safely dissipated. In addition, the manufacturer provides a plot of the safe operating area (SOA) in the $i_{C}-v_{C E}$ plane. The SOA specification takes the form shown in Fig. 12.38; the following paragraph numbers correspond to the boundaries on the sketch.

1. The maximum allowable current $I_{C \max }$. Exceeding this current on a continuous basis can result in melting the wires that bond the device to the package terminals.
2. The maximum power dissipation hyberbola. This is the locus of the points for which $v_{C E} i_{C}=P_{D \max }$. The specified $P_{D \max }$ corresponds to a specific temperature of the transistor case, $T_{C 0}$. If the case temperature $T_{C}$ is higher than $T_{C 0}$, a lower value of $P_{D \max }$ and a correspondingly lower hyberbola apply. This point will be explained in Section 12.10.4. Although the operating point can be allowed to move temporarily above the hyberbola, the average power dissipation should not be allowed to exceed the applicable $P_{D \max }$.
3. The second-breakdown limit. Second breakdown is a phenomenon that results because current flow across the emitter-base junction is not uniform. Rather, the current density is greatest near the periphery of the junction. This "current-crowding" gives rise to increased localized power dissipation and hence temperature rise (at


Figure 12.38 Safe operating area (SOA) of a BJT.
locations called hot spots). Since a temperature rise causes an increase in current, a localized form of thermal runaway can occur, leading to junction destruction.
4. The collector-to-emitter breakdown voltage $B V_{C E O}$. The instantaneous value of $v_{C E}$ should never be allowed to exceed $B V_{C E O}$; otherwise, avalanche breakdown of the collector-base junction may occur (Section 6.4).

Finally, it should be noted that logarithmic scales are usually used for $i_{C}$ and $v_{C E}$ leading to a safe-operating-area boundary that consists of straight lines.

# 12.10.3 Power MOSFETs 

Power MOSFETs have in the past number of years gained popularity in the design of power electronic circuits. This is a result of the following properties.

1. Unlike BJTs, MOSFETs do not require dc gate drive current. This greatly simplifies the design of the driving circuitry.
2. MOSFETs can operate at much higher switching speeds than BJTs, a definite advantage for power circuits employing switching, such as class D amplifiers.
3. MOSFETs do not suffer from secondary breakdown, thus benefiting from an extension of SOA.
4. The thermal characteristics of the MOSFET, as we shall see shortly, are superior to those of the BJT.

Structure of the Power MOSFET The MOSFET structure studied in Chapter 5 (Fig. 5.1) is not suitable for high-power applications. To appreciate this fact, recall that the drain current of an $n$-channel MOSFET operating in the saturation region is given by

$$
i_{D}=\frac{1}{2} \mu_{n} C_{o s}\left(\frac{W}{L}\right)\left(v_{G S}-V_{s}\right)^{2}
$$

It follows that to increase the current capability of the MOSFET, its width $W$ should be made large and its channel length $L$ should be made as small as possible. Unfortunately, however, reducing the channel length of the standard MOSFET structure results in a drastic reduction in its breakdown voltage. Specifically, the depletion region of the reverse-biased body-to-drain junction spreads into the short channel, resulting in breakdown at a relatively low voltage. Thus the resulting device would not be capable of handling the high voltages typical of power-transistor applications. For this reason, new structures had to be found for fabricating short-channel (1- to $2-\mu \mathrm{m}$ ) MOSFETs with high breakdown voltages.

At the present time the most popular structure for a power MOSFET is the double-diffused or DMOS transistor shown in Fig. 12.39. As indicated, the device is fabricated on a lightly doped $n$-type substrate with a heavily doped region at the bottom for the drain contact. Two diffusions ${ }^{7}$ are employed, one to form the $p$-type body region and another to form the $n$-type source region.

The DMOS device operates as follows. Application of a positive gate voltage, $v_{G S}$, greater than the threshold voltage $V_{s}$, induces a lateral $n$ channel in the $p$-type body region underneath the gate oxide. The resulting channel is short; its length is denoted $L$ in Fig. 12.39. Current is then conducted by electrons from the source moving through the resulting short channel

[^0]
[^0]:    ${ }^{7}$ See Appendix A for a description of the IC fabrication process.


Figure 12.39 Double-diffused vertical MOS transistor (DMOS).
to the substrate and then vertically down the substrate to the drain. This should be contrasted with the lateral current flow in the standard small-signal MOSFET structure (Chapter 5).

Even though the DMOS transistor has a short channel, its breakdown voltage can be very high (as high as 600 V ). This is because the depletion region between the substrate and the body extends mostly in the lightly doped substrate and does not spread into the channel. The result is a MOS transistor that simultaneously has a high current capability ( 50 A is possible) as well as the high breakdown voltage just mentioned. Finally, we note that the vertical structure of the device provides efficient utilization of the silicon area.

Many unit devices such as that in Fig. 12.39 are usually fabricated on a chip and connected in parallel to achieve the required high current capability. Various layout and packing arrangements have been utilized, including an efficient design utilizing hexagons, termed HEXFET and available from International Rectifier.

Characteristics of Power MOSFETs In spite of their radically different structure, power MOSFETs exhibit characteristics that are quite similar to those of the small-signal MOSFETs studied in Chapter 5. Important differences exist, however, and these are discussed next.

Power MOSFETs have threshold voltages in the range of 1 V to 4 V . In saturation, the drain current is related to $v_{G S}$ by the square-law characteristic of Eq. (12.72). However, the $i_{D}-v_{G S}$ characteristic becomes linear for larger values of $v_{G S}$. The linear portion of the characteristic occurs as a result of the high electric field along the short channel, causing the velocity of charge carriers to reach an upper limit, a phenomenon known as velocity saturation. ${ }^{8}$ The linear $i_{D}-v_{G S}$ relationship implies a constant $g_{m}$ in the velocity-saturation region.

Of considerable interest in the design of MOS power circuits is the variation of the MOSFET characteristics with temperature, illustrated in Fig. 12.40. Observe that there is a value of $v_{G S}$ (in the range of 4 V to 6 V for most power MOSFETs) at which the temperature coefficient of $i_{D}$ is zero. At higher values of $v_{G S}, i_{D}$ exhibits a negative temperature coefficient. This is a significant property: It implies that a MOSFET operating beyond the zero-temperature-coefficient point does not risk the possibility of thermal runaway. This is not the case, however, at low currents (i.e., lower than the zero-temperature-coefficient point). In

[^0]
[^0]:    ${ }^{8}$ Velocity saturation occurs also in standard MOSFET structures when the channel length is in the submicron range. We shall discuss velocity saturation in some detail in Section 15.1.


Figure 12.40 The $i_{D}-v_{G S}$ characteristic curve of a power MOS transistor (IRF 630, Siliconix) at case temperatures of $-55^{\circ} \mathrm{C},+25^{\circ} \mathrm{C}$, and $+125^{\circ} \mathrm{C}$. (Courtesy of Siliconix Inc.)
the (relatively) low-current region, the temperature coefficient of $i_{D}$ is positive, and the power MOSFET can easily suffer thermal runaway (with unhappy consequences). Since class AB output stages are biased at low currents, means must be provided to guard against thermal runaway.

The reason for the positive temperature coefficient of $i_{D}$ at low currents is that $v_{O V}=\left(v_{G S}-V_{i}\right)$ is relatively low, and the temperature dependence is dominated by the negative temperature coefficient of $V_{i}$ (in the range of $-3 \mathrm{mV} /{ }^{\circ} \mathrm{C}$ to $-6 \mathrm{mV} /{ }^{\circ} \mathrm{C}$ ), which causes $v_{O V}$ to rise with temperature.

# 12.10.4 Thermal Considerations 

Power transistors dissipate large amounts of power. The dissipated power is converted into heat, which raises the junction temperature. However, the junction temperature $T_{J}$ must not be allowed to exceed a specified maximum, $T_{J \max }$; otherwise the transistor could suffer permanent damage. For silicon devices, $T_{J \max }$ is in the range of $150^{\circ} \mathrm{C}$ to $200^{\circ} \mathrm{C}$.

Thermal Resistance Consider first the situation of a transistor operating in free air-that is, with no special arrangements for cooling. The heat dissipated in the transistor will be conducted away from the junction to the transistor case, and from the case to the surrounding environment. In a steady state in which the transistor is dissipating $P_{D}$ watts, the temperature rise of the junction relative to the surrounding ambience can be expressed as

$$
T_{J}-T_{A}=\theta_{J A} P_{D}
$$
where $\theta_{J A}$ is the thermal resistance between junction and ambience, having the units of degrees Celsius per watt. Note that $\theta_{J A}$ simply gives the rise in junction temperature over the ambient temperature for each watt of dissipated power. Since we wish to be able to dissipate large amounts of power without raising the junction temperature above $T_{J \max }$, it is desirable to have, for the thermal resistance $\theta_{J A}$, as small a value as possible. For operation in free air, $\theta_{J A}$ depends primarily on the type of case in which the transistor is packaged. The value of $\theta_{J A}$ is usually specified on the transistor data sheet.

Equation (12.73), which describes the thermal-conduction process, is analogous to Ohm's law, which describes the electrical-conduction process. In this analogy, power dissipation corresponds to current, temperature difference corresponds to voltage difference, and thermal resistance corresponds to electrical resistance. Thus, we may represent the thermal-conduction process by the electric circuit shown in Fig. 12.41.

Power Dissipation versus Temperature The transistor manufacturer usually specifies the maximum junction temperature $T_{J \max }$, the maximum allowable power dissipation at a particular ambient temperature $T_{A 0}$ (usually $25^{\circ} \mathrm{C}$ ), and the thermal resistance $\theta_{J A}$. In addition, a graph such as that shown in Fig. 12.42 is usually provided. The graph simply states that for operation at ambient temperatures below $T_{A 0}$, the device can safely dissipate the rated value of $P_{D 0}$ watts. However, if the device is to be operated at higher ambient temperatures, the maximum allowable power dissipation must be derated according to the straight line shown in Fig. 12.42. The power-derating curve is a graphical representation of Eq. (12.73). Specifically, note that if the ambient temperature is $T_{A 0}$ and the power dissipation is at the maximum allowed $\left(P_{D 0}\right)$, then the junction temperature will be $T_{J \text { max }}$. Substituting these quantities in Eq. (12.73) results in

$$
\theta_{J A}=\frac{T_{J \max }-T_{A 0}}{P_{D 0}}
$$



Figure 12.41 Electrical equivalent circuit of the thermalconduction process; $T_{J}-T_{A}=P_{D} \theta_{J A}$.


Figure 12.42 Maximum allowable power dissipation versus ambient temperature for a BJT operated in free air. This is known as a "power-derating" curve.
which is the inverse of the slope of the power-derating straight line. At an ambient temperature $T_{A}$, higher than $T_{A 0}$, the maximum allowable power dissipation $P_{D \max }$ can be obtained from Eq. (12.73) by substituting $T_{J}=T_{J \max }$; thus,

$$
P_{D \max }=\frac{T_{J \max }-T_{A}}{\theta_{J A}}
$$

Observe that as $T_{A}$ approaches $T_{J \max }$, the allowable power dissipation decreases; the lower thermal gradient limits the amount of heat that can be removed from the junction. In the extreme situation of $T_{A}=T_{J \max }$, no power can be dissipated because no heat can be removed from the junction.

# Example 12.7 

A BJT is specified to have a maximum power dissipation $P_{D 0}$ of 2 W at an ambient temperature $T_{A 0}$ of $25^{\circ} \mathrm{C}$, and a maximum junction temperature $T_{J \max }$ of $150^{\circ} \mathrm{C}$. Find the following:
(a) the thermal resistance $\theta_{J A}$
(b) the maximum power that can be safely dissipated at an ambient temperature of $50^{\circ} \mathrm{C}$
(c) the junction temperature if the device is operating at $T_{A}=25^{\circ} \mathrm{C}$ and is dissipating 1 W

## Solution

(a) $\theta_{J A}=\frac{T_{J \max }-T_{A 0}}{P_{D 0}}=\frac{150-25}{2}=62.5^{\circ} \mathrm{C} / \mathrm{W}$
(b) $P_{D \max }=\frac{T_{J \max }-T_{A}}{\theta_{J A}}=\frac{150-50}{62.5}=1.6 \mathrm{~W}$
(c) $T_{J}=T_{A}+\theta_{J A} P_{D}=25+62.5 \times 1=87.5^{\circ} \mathrm{C}$

Transistor Case and Heat Sink The thermal resistance between junction and ambience, $\theta_{J A}$, can be expressed as

$$
\theta_{J A}=\theta_{J C}+\theta_{C A}
$$

where $\theta_{J C}$ is the thermal resistance between junction and transistor case (package) and $\theta_{C A}$ is the thermal resistance between case and ambience. For a given transistor, $\theta_{J C}$ is fixed by the device design and packaging. The device manufacturer can reduce $\theta_{J C}$ by encapsulating the device in a relatively large metal case, such as that in Fig. 12.35(a), and placing the collector (where most of the heat is dissipated) in direct contact with the case.

Although the circuit designer has no control over $\theta_{J C}$ (once a particular transistor has been selected), the designer can considerably reduce $\theta_{C A}$ below its free-air value (specified by the manufacturer as part of $\theta_{J A}$ ). Reduction of $\theta_{C A}$ can be effected by providing means to facilitate heat transfer from case to ambience. A popular approach is to bolt the transistor to
the chassis or to an extended metal surface such as the heat sink shown in Fig. 12.36. Heat is easily conducted from the transistor case to the heat sink; that is, the thermal resistance $\theta_{C S}$ is usually very small. Also, heat is efficiently transferred (by convection and radiation) from the heat sink to the ambience, resulting in a low thermal resistance $\theta_{S A}$. Thus, if a heat sink is utilized, the case-to-ambience thermal resistance given by

$$
\theta_{C A}=\theta_{C S}+\theta_{S A}
$$

can be small because its two components can be made small by the choice of an appropriate heat sink. For example, in very high-power applications the heat sink is usually equipped with fins that further facilitate cooling by radiation and convection.

The electrical analog of the thermal-conduction process when a heat sink is employed is shown in Fig. 12.43, from which we can write

$$
T_{J}-T_{A}=P_{D}\left(\theta_{J C}+\theta_{C S}+\theta_{S A}\right)
$$

As well as specifying $\theta_{J C}$, the device manufacturer usually supplies a derating curve for $P_{D \max }$ versus the case temperature, $T_{C}$. Such a curve is shown in Fig. 12.44. Note that the slope of the power-derating straight line is $-1 / \theta_{J C}$. For a given transistor, the maximum power dissipation at a case temperature $T_{C 0}$ (usually $25^{\circ} \mathrm{C}$ ) is much greater than that at an ambient temperature


Figure 12.43 Electrical analog of the thermal-conduction process when a heat sink is utilized.


Figure 12.44 Maximum allowable power dissipation versus transistor-case temperature.
$T_{A 0}$ (usually $25^{\circ} \mathrm{C}$, because $\theta_{J C} \ll \theta_{J A}$ ). If the device can be maintained at a case temperature $T_{C}, T_{C 0} \leq T_{C} \leq T_{J \max }$, then the maximum safe power dissipation is obtained when $T_{J}=T_{J \max }$,

$$
P_{D \max }=\frac{T_{J \max }-T_{C}}{\theta_{J C}}
$$

# Example 12.8 

A BJT is specified to have $T_{J \max }=150^{\circ} \mathrm{C}$ and to be capable of dissipating maximum power as follows:

$$
\begin{aligned}
40 \mathrm{~W} \text { at } T_{C} & =25^{\circ} \mathrm{C} \\
2 \mathrm{~W} \text { at } T_{A} & =25^{\circ} \mathrm{C}
\end{aligned}
$$

Above $25^{\circ} \mathrm{C}$, the maximum power dissipation is to be derated linearly with $\theta_{J C}=3.12^{\circ} \mathrm{C} / \mathrm{W}$ and $\theta_{J A}=62.5^{\circ} \mathrm{C} / \mathrm{W}$. Find the following:
(a) The maximum power that can be dissipated safely by this transistor when operated in free air at $T_{A}=50^{\circ} \mathrm{C}$.
(b) The maximum power that can be dissipated safely by this transistor when operated at an ambient temperature of $50^{\circ} \mathrm{C}$, but with a heat sink for which $\theta_{C S}=0.5^{\circ} \mathrm{C} / \mathrm{W}$ and $\theta_{S A}=4^{\circ} \mathrm{C} / \mathrm{W}$. Find the temperature of the case and of the heat sink.
(c) The maximum power that can be dissipated safely if an infinite heat sink is used and $T_{A}=50^{\circ} \mathrm{C}$.

## Solution

(a)

$$
P_{D \max }=\frac{T_{J \max }-T_{A}}{\theta_{J A}}=\frac{150-50}{62.5}=1.6 \mathrm{~W}
$$

(b) With a heat sink, $\theta_{J A}$ becomes

$$
\begin{aligned}
\theta_{J A} & =\theta_{J C}+\theta_{C S}+\theta_{S A} \\
& =3.12+0.5+4=7.62^{\circ} \mathrm{C} / \mathrm{W}
\end{aligned}
$$

Thus,

$$
P_{D \max }=\frac{150-50}{7.62}=13.1 \mathrm{~W}
$$

Figure 12.45 shows the thermal equivalent circuit with the various temperatures indicated.
(c) An infinite heat sink, if it existed, would cause the case temperature $T_{C}$ to equal the ambient temperature $T_{A}$. The infinite heat sink has $\theta_{C A}=0$. Obviously, one cannot buy an infinite heat sink; nevertheless, this terminology is used by some manufacturers to describe the power-derating curve of Fig. 12.44.
The abscissa is then labeled $T_{A}$ and the curve is called "power dissipation versus ambient temperature with an infinite heat sink." For our example, with infinite heat sink,

$$
P_{D \max }=\frac{T_{J \max }-T_{A}}{\theta_{J C}}=\frac{150-50}{3.12}=32 \mathrm{~W}
$$



Figure 12.45 Thermal equivalent circuit for Example 12.8.

The advantage of using a heat sink is clearly evident from Example 12.8: With a heat sink, the maximum allowable power dissipation increases from 1.6 W to 13.1 W . Also note that although the transistor considered can be called a " $40-\mathrm{W}$ transistor," this level of power dissipation cannot be achieved in practice; that would require an infinite heat sink and an ambient temperature $T_{A} \leq 25^{\circ} \mathrm{C}$.

# EXERCISE 

12.21 The 2 N 6306 power transistor is specified to have $T_{J \max }=200^{\circ} \mathrm{C}$ and $P_{D \max }=125 \mathrm{~W}$ for $T_{C} \leq 25^{\circ} \mathrm{C}$. For $T_{C} \geq 25^{\circ} \mathrm{C}, \theta_{J C}=1.4^{\circ} \mathrm{C} / \mathrm{W}$. If in a particular application this device is to dissipate 50 W and operate at an ambient temperature of $25^{\circ} \mathrm{C}$, find the maximum thermal resistance of the heat sink that must be used (i.e., $\theta_{S A}$ ). Assume $\theta_{C S}=0.6^{\circ} \mathrm{C} / \mathrm{W}$. What is the case temperature, $T_{C}$ ? Ans. $1.5^{\circ} \mathrm{C} / \mathrm{W} ; 130^{\circ} \mathrm{C}$$R_{1}, R_{2}, \ldots, R_{n}$, which are connected to the inverting terminal of the op amp. From our previous discussion, the ideal op amp will have a virtual ground appearing at its negative input terminal. Ohm's law then tells us that the currents $i_{1}, i_{2}, \ldots, i_{n}$ are given by

$$
i_{1}=\frac{v_{1}}{R_{1}}, \quad i_{2}=\frac{v_{2}}{R_{2}}, \quad \ldots, \quad i_{n}=\frac{v_{n}}{R_{n}}
$$



Figure 2.10 A weighted summer.
All these currents sum together to produce the current $i$,

$$
i=i_{1}+i_{2}+\cdots+i_{n}
$$

which will be forced to flow through $R_{f}$ (since no current flows into the input terminals of an ideal op amp). The output voltage $v_{O}$ may now be determined by another application of Ohm's law,

$$
v_{O}=0-i R_{f}=-i R_{f}
$$

Thus,

$$
v_{O}=-\left(\frac{R_{f}}{R_{1}} v_{1}+\frac{R_{f}}{R_{2}} v_{2}+\cdots+\frac{R_{f}}{R_{n}} v_{n}\right)
$$

That is, the output voltage is a weighted sum of the input signals $v_{1}, v_{2}, \ldots, v_{n}$. This circuit is therefore called a weighted summer. Note that each summing coefficient may be independently adjusted by adjusting the corresponding "feed-in" resistor ( $R_{1}$ to $R_{n}$ ). This nice property, which greatly simplifies circuit adjustment, is a direct consequence of the virtual ground that exists at the inverting op-amp terminal. As the reader will soon come to appreciate, virtual grounds are extremely "handy." In the weighted summer of Fig. 2.10 all the summing coefficients must be of the same sign. The need occasionally arises for summing signals with opposite signs. Such a function can be implemented, however, using two op amps as shown in Fig. 2.11. Assuming ideal op amps, it can be easily shown that the output voltage is given by

$$
v_{O}=v_{1}\left(\frac{R_{a}}{R_{1}}\right)\left(\frac{R_{c}}{R_{b}}\right)+v_{2}\left(\frac{R_{a}}{R_{2}}\right)\left(\frac{R_{c}}{R_{b}}\right)-v_{3}\left(\frac{R_{c}}{R_{3}}\right)-v_{4}\left(\frac{R_{c}}{R_{4}}\right)
$$

Weighted summers are utilized in a variety of applications including in the design of audio systems, where they can be used in mixing signals originating from different musical instruments.


Figure 2.11 A weighted summer capable of implementing summing coefficients of both signs.

# EXERCISES 

D2.7 Design an inverting op-amp circuit to form the weighted sum $v_{O}$ of two inputs $v_{1}$ and $v_{2}$. It is required that $v_{O}=-\left(v_{1}+5 v_{2}\right)$. Choose values for $R_{1}, R_{2}$, and $R_{f}$ so that for a maximum output voltage of 10 V the current in the feedback resistor will not exceed 1 mA .
Ans. A possible choice: $R_{1}=10 \mathrm{k} \Omega, R_{2}=2 \mathrm{k} \Omega$, and $R_{f}=10 \mathrm{k} \Omega$
D2.8 Use the idea presented in Fig. 2.11 to design a weighted summer that provides

$$
v_{O}=2 v_{1}+v_{2}-4 v_{3}
$$

Ans. A possible choice: $R_{1}=5 \mathrm{k} \Omega, R_{2}=10 \mathrm{k} \Omega, R_{a}=10 \mathrm{k} \Omega, R_{b}=10 \mathrm{k} \Omega, R_{3}=2.5 \mathrm{k} \Omega$, $R_{c}=10 \mathrm{k} \Omega$

### 2.3 The Noninverting Configuration

The second closed-loop configuration we shall study is shown in Fig. 2.12. Here the input signal $v_{I}$ is applied directly to the positive input terminal of the op amp while one terminal of $R_{1}$ is connected to ground.

### 2.3.1 The Closed-Loop Gain

Analysis of the noninverting circuit to determine its closed-loop gain $\left(v_{O} / v_{I}\right)$ is illustrated in Fig. 2.13. Again the order of the steps in the analysis is indicated by circled numbers. Assuming that the op amp is ideal with infinite gain, a virtual short circuit exists between its two input terminals. Hence the difference input signal is

$$
v_{I d}=\frac{v_{O}}{A}=0 \quad \text { for } A=\infty
$$

Thus the voltage at the inverting input terminal will be equal to that at the noninverting input terminal, which is the applied voltage $v_{I}$. The current through $R_{1}$ can then be determined as $v_{I} / R_{1}$. Because of the infinite input impedance of the op amp, this current will flow through $R_{2}$, as shown in Fig. 2.13. Now the output voltage can be determined from

$$
v_{O}=v_{I}+\left(\frac{v_{I}}{R_{1}}\right) R_{2}
$$


Figure 2.12 The noninverting configuration.


Figure 2.13 Analysis of the noninverting circuit. The sequence of the steps in the analysis is indicated by the circled numbers.
which yields

$$
\frac{v_{O}}{v_{I}}=1+\frac{R_{I}}{R_{2}}
$$

Further insight into the operation of the noninverting configuration can be obtained by considering the following: Since the current into the op-amp inverting input is zero, the circuit composed of $R_{1}$ and $R_{2}$ acts in effect as a voltage divider feeding a fraction of the output voltage back to the inverting input terminal of the op amp; that is,

$$
v_{1}=v_{O}\left(\frac{R_{1}}{R_{1}+R_{2}}\right)
$$

Then the infinite op-amp gain and the resulting virtual short circuit between the two input terminals of the op amp forces this voltage to be equal to that applied at the positive input terminal; thus,

$$
v_{O}\left(\frac{R_{1}}{R_{1}+R_{2}}\right)=v_{I}
$$

which yields the gain expression given in Eq. (2.9).
This is an appropriate point to reflect further on the action of the negative feedback present in the noninverting circuit of Fig. 2.12. Let $v_{I}$ increase. Such a change in $v_{I}$ will cause $v_{l d}$ to increase, and $v_{O}$ will correspondingly increase as a result of the high (ideally infinite) gain of the op amp. However, a fraction of the increase in $v_{O}$ will be fed back to the inverting input terminal of the op amp through the $\left(R_{1}, R_{2}\right)$ voltage divider. The result of this feedback will be to counteract the increase in $v_{l d}$, driving $v_{l d}$ back to zero, albeit at a higher value of $v_{O}$ that corresponds to the increased value of $v_{I}$. This degenerative action of negative feedback gives it the alternative name degenerative feedback. Finally, note that the argument above applies equally well if $v_{I}$ decreases. A formal and detailed study of feedback is presented in Chapter 11.
# 2.3.2 Effect of Finite Open-Loop Gain 

As we have done for the inverting configuration, we now consider the effect of the finite op-amp open-loop gain $A$ on the gain of the noninverting configuration. Assuming the op amp to be ideal except for having a finite open-loop gain $A$, it can be shown that the closed-loop gain of the noninverting amplifier circuit of Fig. 2.12 is given by

$$
G \equiv \frac{v_{O}}{v_{I}}=\frac{1+\left(R_{2} / R_{1}\right)}{1+\frac{1+\left(R_{2} / R_{1}\right)}{A}}
$$

Observe that the denominator is identical to that for the case of the inverting configuration (Eq. 2.5). This is no coincidence; it is a result of the fact that both the inverting and the noninverting configurations have the same feedback loop, which can be readily seen if the input signal source is eliminated (i.e., short-circuited). The numerators, however, are different, for the numerator gives the ideal or nominal closed-loop gain ( $-R_{2} / R_{1}$ for the inverting configuration, and $1+R_{2} / R_{1}$ for the noninverting configuration). Finally, we note (with reassurance) that the gain expression in Eq. (2.11) reduces to the ideal value for $A=\infty$. In fact, it approximates the ideal value for

$$
A \gg 1+\frac{R_{2}}{R_{1}}
$$

This is the same condition as in the inverting configuration, except that here the quantity on the right-hand side is the nominal closed-loop gain. The expressions for the actual and ideal values of the closed-loop gain $G$ in Eqs. (2.11) and (2.9), respectively, can be used to determine the percentage error in $G$ resulting from the finite op-amp gain $A$ as

$$
\text { Percent gain error }=-\frac{1+\left(R_{2} / R_{1}\right)}{A+1+\left(R_{2} / R_{1}\right)} \times 100
$$

Thus, as an example, if an op amp with an open-loop gain of 1000 is used to design a noninverting amplifier with a nominal closed-loop gain of 10 , we would expect the closed-loop gain to be about $1 \%$ below the nominal value.

### 2.3.3 Input and Output Resistance

The gain of the noninverting configuration is positive-hence the name noninverting. The input impedance of this closed-loop amplifier is ideally infinite, since no current flows into the positive input terminal of the op amp. The output of the noninverting amplifier is taken at the terminals of the ideal voltage source $A\left(v_{2}-v_{1}\right)$ (see the op-amp equivalent circuit in Fig. 2.3), and thus the output resistance of the noninverting configuration is zero.

### 2.3.4 The Voltage Follower

The property of high input impedance is a very desirable feature of the noninverting configuration. It enables using this circuit as a buffer amplifier to connect a source with a high impedance to a low-impedance load. We discussed the need for buffer amplifiers in Section 1.5. In many applications the buffer amplifier is not required to provide any voltage gain; rather, it is used mainly as an impedance transformer or a power amplifier. In such cases we may make $R_{2}=0$ and $R_{1}=\infty$ to obtain the unity-gain amplifier shown in Fig. 2.14(a). This circuit is commonly referred to as a voltage follower, since the output "follows" the input. In the ideal case, $v_{O}=v_{I}, R_{\text {in }}=\infty, R_{\text {out }}=0$, and the follower has the equivalent circuit shown in Fig. 2.14(b).


Figure 2.14 (a) The unity-gain buffer or follower amplifier. (b) Its equivalent circuit model.

Since in the voltage-follower circuit the entire output is fed back to the inverting input, the circuit is said to have $100 \%$ negative feedback. The infinite gain of the op amp then acts to make $v_{f d}=0$ and hence $v_{O}=v_{I}$. Observe that the circuit is elegant in its simplicity!

Since the noninverting configuration has a gain greater than or equal to unity, depending on the choice of $R_{2} / R_{1}$, some prefer to call it "a follower with gain."

# EXERCISES 

2.9 Use the superposition principle to find the output voltage of the circuit shown in Fig. E2.9. Ans. $v_{O}=6 v_{1}+4 v_{2}$


Figure E2.9
2.10 If in the circuit of Fig. E2.9 the $1-\mathrm{k} \Omega$ resistor is disconnected from ground and connected to a third signal source $v_{3}$, use superposition to determine $v_{O}$ in terms of $v_{1}, v_{2}$, and $v_{3}$. Ans. $v_{O}=6 v_{1}+4 v_{2}-9 v_{3}$
D2.11 Design a noninverting amplifier with a gain of 2 . At the maximum output voltage of 10 V the current in the voltage divider is to be $10 \mu \mathrm{~A}$.
Ans. $R_{1}=R_{2}=0.5 \mathrm{M} \Omega$
2.12 (a) Show that if the op amp in the circuit of Fig. 2.12 has a finite open-loop gain $A$, then the closed-loop gain is given by Eq. (2.11). (b) For $R_{1}=1 \mathrm{k} \Omega$ and $R_{2}=9 \mathrm{k} \Omega$ find the percentage deviation $\epsilon$ of the closed-loop gain from the ideal value of $\left(1+R_{2} / R_{1}\right)$ for the cases $A=10^{7}, 10^{4}$, and $10^{5}$. For $v_{I}=1 \mathrm{~V}$, find in each case the voltage between the two input terminals of the op amp. Ans. $\epsilon=-1 \%,-0.1 \%,-0.01 \% ; v_{2}-v_{1}=9.9 \mathrm{mV}, 1 \mathrm{mV}, 0.1 \mathrm{mV}$
2.13 For the circuit in Fig. E2.13 find the values of $i_{I}, v_{1}, i_{1}, i_{2}, v_{O}, i_{L}$, and $i_{o}$. Also find the voltage gain $v_{0} / v_{I}$, the current gain $i_{L} / i_{I}$, and the power gain $P_{L} / P_{I}$.
Ans. $0 ; 1 \mathrm{~V} ; 1 \mathrm{~mA} ; 1 \mathrm{~mA} ; 10 \mathrm{~V} ; 10 \mathrm{~mA} ; 11 \mathrm{~mA} ; 10 \mathrm{~V} / \mathrm{V}(20 \mathrm{~dB}) ; \infty ; \infty$


Figure E2.13
2.14 It is required to connect a transducer having an open-circuit voltage of 1 V and a source resistance of $1 \mathrm{M} \Omega$ to a load of $1-\mathrm{k} \Omega$ resistance. Find the load voltage if the connection is done (a) directly, and (b) through a unity-gain voltage follower.
Ans. (a) 1 mV ; (b) 1 V

# 2.4 Difference Amplifiers 

Having studied the two basic configurations of op-amp circuits together with some of their direct applications, we are now ready to consider a somewhat more involved but very important application. Specifically, we shall study the use of op amps to design difference or differential amplifiers. ${ }^{2}$ A difference amplifier is one that responds to the difference between the two signals applied at its input and ideally rejects signals that are common to the two inputs. The representation of signals in terms of their differential and common-mode components was given in Fig. 2.4. It is repeated here in Fig. 2.15 with slightly different symbols to serve as the input signals for the difference amplifiers we are about to design. Although ideally the difference amplifier will amplify only the differential input signal $v_{I d}$ and reject completely the common-mode input signal $v_{I c m}$, practical circuits will have an output voltage $v_{O}$ given by

$$
v_{O}=A_{d} v_{I d}+A_{c m} v_{I c m}
$$

where $A_{d}$ denotes the amplifier differential gain and $A_{c m}$ denotes its common-mode gain (ideally zero). The efficacy of a differential amplifier is measured by the degree of its rejection of common-mode signals in preference to differential signals. This is usually quantified by a measure known as the common-mode rejection ratio (CMRR), defined as

$$
\mathrm{CMRR}=20 \log \frac{\left|A_{d}\right|}{\left|A_{c m}\right|}
$$

[^0]
[^0]:    ${ }^{2}$ The terms difference and differential are usually used to describe somewhat different amplifier types. For our purposes at this point, the distinction is not sufficiently significant. We will be more precise near the end of this section.


Figure 2.15 Representing the input signals to a differential amplifier in terms of their differential and common-mode components.

The need for difference amplifiers arises frequently in the design of electronic systems, especially those employed in instrumentation. As a common example, consider a transducer providing a small (e.g., 1 mV ) signal between its two output terminals while each of the two wires leading from the transducer terminals to the measuring instrument may have a large interference signal (e.g., 1 V ) relative to the circuit ground. The instrument front end obviously needs a difference amplifier.

Before we proceed any further we should address a question that the reader might have: The op amp is itself a difference amplifier; why not just use an op amp? The answer is that the very high (ideally infinite) gain of the op amp makes it impossible to use by itself. Rather, as we did before, we have to devise an appropriate feedback network to connect to the op amp to create a circuit whose closed-loop gain is finite, predictable, and stable.

# 2.4.1 A Single-Op-Amp Difference Amplifier 

Our first attempt at designing a difference amplifier is motivated by the observation that the gain of the noninverting amplifier configuration is positive, $\left(1+R_{2} / R_{1}\right)$, while that of the inverting configuration is negative, $\left(-R_{2} / R_{1}\right)$. Combining the two configurations together is then a step in the right direction-namely, getting the difference between two input signals. Of course, we have to make the two gain magnitudes equal in order to reject common-mode signals. This, however, can be easily achieved by attenuating the positive input signal to reduce the gain of the positive path from $\left(1+R_{2} / R_{1}\right)$ to $\left(R_{2} / R_{1}\right)$. The resulting circuit would then look like that shown in Fig. 2.16, where the attenuation in the positive input path is achieved by the voltage divider $\left(R_{3}, R_{4}\right)$. The proper ratio of this voltage divider can be determined from

$$
\frac{R_{4}}{R_{4}+R_{3}}\left(1+\frac{R_{2}}{R_{1}}\right)=\frac{R_{2}}{R_{1}}
$$

which can be put in the form

$$
\frac{R_{4}}{R_{4}+R_{3}}=\frac{R_{2}}{R_{2}+R_{1}}
$$

This condition is satisfied by selecting

$$
\frac{R_{4}}{R_{3}}=\frac{R_{2}}{R_{1}}
$$


Figure 2.16 A difference amplifier.

This completes our work. However, we have perhaps proceeded a little too fast! Let's step back and verify that the circuit in Fig. 2.16 with $R_{3}$ and $R_{4}$ selected according to Eq. (2.15) does in fact function as a difference amplifier. Specifically, we wish to determine the output voltage $v_{O}$ in terms of $v_{I 1}$ and $v_{I 2}$. Toward that end, we observe that the circuit is linear, and thus we can use superposition.

To apply superposition, we first reduce $v_{I 2}$ to zero-that is, ground the terminal to which $v_{I 2}$ is applied-and then find the corresponding output voltage, which will be due entirely to $v_{I 1}$. We denote this output voltage $v_{O 1}$. Its value may be found from the circuit in Fig. 2.17(a), which we recognize as that of the inverting configuration. The existence of $R_{3}$ and $R_{4}$ does not affect the gain expression, since no current flows through either of them. Thus,

$$
v_{O 1}=-\frac{R_{2}}{R_{1}} v_{I 1}
$$

Next, we reduce $v_{I 1}$ to zero and evaluate the corresponding output voltage $v_{O 2}$. The circuit will now take the form shown in Fig. 2.17(b), which we recognize as the noninverting configuration with an additional voltage divider, made up of $R_{3}$ and $R_{4}$, connected to the input $v_{I 2}$. The output voltage $v_{O 2}$ is therefore given by

$$
v_{O 2}=v_{I 2} \frac{R_{4}}{R_{3}+R_{4}}\left(1+\frac{R_{2}}{R_{1}}\right)=\frac{R_{2}}{R_{1}} v_{I 2}
$$

where we have utilized Eq. (2.15).
The superposition principle tells us that the output voltage $v_{O}$ is equal to the sum of $v_{O 1}$ and $v_{O 2}$. Thus we have

$$
v_{O}=\frac{R_{2}}{R_{1}}\left(v_{I 2}-v_{I 1}\right)=\frac{R_{2}}{R_{1}} v_{I d}
$$

Thus, as expected, the circuit acts as a difference amplifier with a differential gain $A_{d}$ of

$$
A_{d}=\frac{R_{2}}{R_{1}}
$$

Of course this is predicated on the op amp being ideal and furthermore on the selection of $R_{3}$ and $R_{4}$ so that their ratio matches that of $R_{1}$ and $R_{2}$ (Eq. 2.15). To make this matching requirement a little easier to satisfy, we usually select

$$
R_{3}=R_{1} \quad \text { and } \quad R_{4}=R_{2}
$$


Figure 2.17 Application of superposition to the analysis of the circuit of Fig. 2.16.

Let's next consider the circuit with only a common-mode signal applied at the input, as shown in Fig. 2.18. The figure also shows some of the analysis steps. Thus,

$$
\begin{aligned}
i_{1} & =\frac{1}{R_{1}}\left[v_{I c m}-\frac{R_{4}}{R_{4}+R_{3}} v_{I c m}\right] \\
& =v_{I c m} \frac{R_{3}}{R_{4}+R_{3}} \frac{1}{R_{1}}
\end{aligned}
$$

The output voltage can now be found from

$$
v_{O}=\frac{R_{4}}{R_{4}+R_{3}} v_{I c m}-i_{2} R_{2}
$$

Substituting $i_{2}=i_{1}$ and for $i_{1}$ from Eq. (2.18),

$$
\begin{aligned}
v_{O} & =\frac{R_{4}}{R_{4}+R_{3}} v_{I c m}-\frac{R_{2}}{R_{1}} \frac{R_{3}}{R_{4}+R_{3}} v_{I c m} \\
& =\frac{R_{4}}{R_{4}+R_{3}}\left(1-\frac{R_{2}}{R_{1}} \frac{R_{3}}{R_{4}}\right) v_{I c m}
\end{aligned}
$$

Thus,

$$
A_{c m} \equiv \frac{v_{O}}{v_{I c m}}=\left(\frac{R_{4}}{R_{4}+R_{3}}\right)\left(1-\frac{R_{2}}{R_{1}} \frac{R_{3}}{R_{4}}\right)
$$

For the design with the resistor ratios selected according to Eq. (2.15), we obtain

$$
A_{c m}=0
$$

as expected. Note, however, that any mismatch in the resistance ratios can make $A_{c m}$ nonzero, and hence CMRR finite.

In addition to rejecting common-mode signals, a difference amplifier is usually required to have a high input resistance. To find the input resistance between the two input terminals


Figure 2.18 Analysis of the difference amplifier to determine its common-mode gain $A_{c m} \equiv v_{t l} / v_{l c m}$.
(i.e., the resistance seen by $v_{l d}$ ), called the differential input resistance $R_{i d}$, consider Fig. 2.19. Here we have assumed that the resistors are selected so that

$$
R_{3}=R_{1} \quad \text { and } \quad R_{4}=R_{2}
$$

Now

$$
R_{i d} \equiv \frac{v_{l d}}{i_{l}}
$$

Since the two input terminals of the op amp track each other in potential, we may write a loop equation and obtain

$$
v_{l d}=R_{1} i_{l}+0+R_{1} i_{l}
$$

Thus,

$$
R_{i d}=2 R_{1}
$$

Note that if the amplifier is required to have a large differential gain $\left(R_{2} / R_{1}\right)$, then $R_{1}$ of necessity will be relatively small and the input resistance will be correspondingly low, a drawback of this circuit. Another drawback of the circuit is that it is not easy to vary the differential gain of the amplifier. Both of these drawbacks are overcome in the instrumentation amplifier discussed next.


Figure 2.19 Finding the input resistance of the difference amplifier for the case $R_{3}=R_{1}$ and $R_{4}=R_{2}$.## Summary

- Output stages are classified according to the transistor conduction angle: class $\mathrm{A}\left(360^{\circ}\right)$, class AB (slightly more than $180^{\circ}$ ), class B $\left(180^{\circ}\right)$, and class C (less than $180^{\circ}$ ).
- The most common class A output stage is the emitter follower. It is biased at a current greater than the peak load current.
- The class A output stage dissipates its maximum power under quiescent conditions $\left(\mathrm{v}_{O}=0\right)$. It achieves a maximum power-conversion efficiency of $25 \%$.
- The class B stage is biased at zero current, and thus dissipates no power in quiescence.
- The class B stage can achieve a power-conversion efficiency as high as $78.5 \%$. It dissipates its maximum power for $\hat{V}_{o}=(2 / \pi) V_{C C}$.
- The class B stage suffers from crossover distortion.
- The class AB output stage is biased at a small current; thus both transistors conduct for small input signals, and crossover distortion is virtually eliminated.
- Except for an additional small quiescent power dissipation, the power relationships of the class AB stage are similar to those in class B.
- To guard against the possibility of thermal runaway, the bias voltage of the class AB circuit is made to vary with temperature in the same manner as does $V_{B E}$ of the output transistors.
- Use of the Darlington configuration in the class AB output stage reduces the base-current drive requirement. In integrated circuits, the compound $p n p$ configuration is commonly used.
- Output stages are usually equipped with circuitry that, in the event of a short circuit, can turn on and limit the base-current drive, and hence the emitter current, of the output transistors.
- The classical CMOS class AB output stage suffers from reduced output signal swing. This problem can be overcome by replacing the source-follower output transistors with a pair of complementary devices operating in the common-source configuration.
- The CMOS class AB output stage with common-source transistors allows the output voltage to swing to within an overdrive voltage from each of the two power supplies. Utilizing amplifiers in the feedback path of each of the output transistors reduces both the output resistance and the gain error of the stage.
- IC power amplifiers consist of a small-signal voltage amplifier cascaded with a high-power output stage. Overall feedback is applied either on-chip or externally.
- The bridge amplifier configuration provides, across a floating load, a peak-to-peak output voltage that is twice that possible from a single amplifier with a grounded load.
- Class D amplifiers convert the audio signal into a pulsewidth-modulated (PWM) signal. The latter is then used to drive complementary MOS switches that supply the load with power. A low-pass filter is utilized to eliminate the high-frequency components introduced by the switching waveform. Power-conversion efficiences in the range of $85 \%$ to $90 \%$ are achieved.
- MOSFETs have gained popularity over BJTs in the design of high-power output stages. This is due to their higher speed of operation and to the fact that they do not need a steady supply of gate currents, which allows the use of relatively simple driving circuitry.
- The DMOS transistor is a short-channel power device capable of both high-current and high-voltage operation.
- The drain current of a power MOSFET exhibits a positive temperature coefficient at low currents, and thus the device can suffer thermal runaway. At high currents the temperature coefficient of $i_{D}$ is negative.
- To facilitate the removal of heat from the silicon chip, power devices are usually mounted on heat sinks. The maximum power that can be safely dissipated in the device is given by

$$
P_{D \max }=\frac{T_{I \max }-T_{A}}{\theta_{I C}+\theta_{C S}+\theta_{S A}}
$$

where $T_{I \max }$ and $\theta_{A C}$ are specified by the manufacturer, while $\theta_{C S}$ and $\theta_{S A}$ depend on the heat-sink design.
## Computer Simulation Problems

SIM Problems identified by the Multisim/PSpice icon are intended to demonstrate the value of using SPICE simulation to verify hand analysis and design, and to investigate important issues such as allowable signal swing and amplifier nonlinear distortion. Instructions to assist in setting up PSpice and Multisim simulations for all the indicated problems can be found in the corresponding files on the website. Note that if a particular parameter value is not specified in the problem statement, you are to make a reasonable assumption.

## Section 12.2: Class A Output Stage

12.1 A class A emitter follower, biased using the circuit shown in Fig. 12.2, uses $V_{C C}=10 \mathrm{~V}, R=R_{L}=1 \mathrm{k} \Omega$, with all transistors (including $Q_{3}$ ) identical. Assume $V_{B E}=0.7 \mathrm{~V}$, $V_{C E \text { sat }}=0.3 \mathrm{~V}$, and $\beta$ to be very large. For linear operation, what are the upper and lower limits of output voltage, and the corresponding inputs? How do these values change if the emitter-base junction area of $Q_{3}$ is made twice as big as that of $Q_{3}$ ? Half as big?
12.2 A source-follower circuit using NMOS transistors is constructed following the pattern shown in Fig. 12.2. All three transistors used are identical, with $V_{i}=0.5 \mathrm{~V}$ and $\mu_{n} C_{o s} W / L=$ $20 \mathrm{~mA} / \mathrm{V}^{2} ; V_{C C}=2.5 \mathrm{~V}, R=R_{L}=1 \mathrm{k} \Omega$. For linear operation, what are the upper and lower limits of the output voltage, and the corresponding inputs?

D 12.3 Using the follower configuration shown in Fig. 12.2 with $\pm 5-\mathrm{V}$ supplies, provide a design capable of $\pm 3-\mathrm{V}$ outputs with a $1-\mathrm{k} \Omega$ load, using the smallest possible total supply current. You are provided with four identical, high- $\beta$ BJTs and a resistor of your choice. Select a standard resistor value of $5 \%$ tolerance, and specify the maximum power drawn from the negative supply.

D 12.4 An emitter follower using the circuit of Fig. 12.2, for which the output voltage range is $\pm 5 \mathrm{~V}$, is required using $V_{C C}=10 \mathrm{~V}$. The circuit is to be designed such that the current variation in the emitter-follower transistor is no greater than a factor of 15 , for load resistances as low as $100 \Omega$. What is the value of $R$ required? Find the incremental voltage gain of the resulting follower at $v_{O}=+5,0$, and -5 V , with a $100-\Omega$ load. What is the percentage change in gain over this range of $v_{O}$ ?
*12.5 Consider the operation of the follower circuit of Fig. 12.2 for which $R_{L}=V_{C C} / I$, when driven by a square wave such that the output ranges from $+V_{C C}$ to $-V_{C C}$ (ignoring $V_{C E \text { sat }}$ ). For this situation, sketch the equivalent of Fig. 12.4 for $v_{O}, i_{C 1}$, and $p_{D 1}$. Repeat for a square-wave output that has peak levels of $\pm V_{C C} / 2$. What is the average power dissipation in $Q_{1}$ in each case? Compare these results to those for sine waves of peak amplitude $V_{C C}$ and $V_{C C} / 2$, respectively.
12.6 Consider the situation described in Problem 12.5. For square-wave outputs having $\pm V_{C C}$ levels and $\pm \frac{1}{2} V_{C C}$ levels, and for sine waves of the same peak-to-peak values, find the average power loss in the current-source transistor $Q_{2}$.
12.7 Reconsider the situation described in Exercise 12.3 for variation in $V_{C C}$-specifically for $V_{C C}=16 \mathrm{~V}, 12 \mathrm{~V}$, 10 V , and 8 V . Assume $V_{C E \text { sat }}$ is nearly zero. What is the power-conversion efficiency in each case?

D 12.8 The emitter-follower output stage of Fig. 12.2 is designed to provide a maximum output swing of $\pm \hat{V}$ volts, across the load $R_{L}$. Neglecting the saturation voltage, what are the minimum required values of $V_{C C}$ and $I$ ? Now, if the output voltage is a sine wave of peak amplitude $(\hat{V} / 2)$, what is the power-conversion efficiency realized?

## Section 12.3: Class B Output Stage

12.9 Consider the circuit of a complementary-BJT class B output stage. For what amplitude of input signal does the crossover distortion represent a $10 \%$ loss in peak amplitude?
12.10 Consider the feedback configuration with a class B output stage shown in Fig. 12.9. Let the amplifier gain $A_{0}=$ $100 \mathrm{~V} / \mathrm{V}$. Derive an expression for $v_{O}$ versus $v_{I}$, assuming that $\left|V_{B E}\right|=0.7 \mathrm{~V}$. Sketch the transfer characteristic $v_{O}$ versus $v_{I}$, and compare it with that without feedback.

SIM 12.11 Consider the class B output stage, using MOSFETs, shown in Fig. P12.11. Let the devices have $\left|V_{i}\right|=$ 0.5 V and $\mu C_{o s} W / L=2 \mathrm{~mA} / \mathrm{V}^{2}$. With a $10-\mathrm{kHz}$ sine-wave input of $5-\mathrm{V}$ peak and a high value of load resistance, what peak output would you expect? What fraction of the sine-wave period does the crossover interval represent? For what value of load resistor is the peak output voltage reduced to half the input?


Figure P12.11
12.12 Consider the complementary-BJT class B output stage and neglect the effects of finite $V_{B E}$ and $V_{C E_{\text {sat }}}$. For $\pm 10-\mathrm{V}$ power supplies and an $8-\Omega$ load resistance, what is the maximum sine-wave output power available? What supply power corresponds? What is the power-conversion efficiency? For output signals of half this amplitude, find the output power, the supply power, and the power-conversion efficiency.

D 12.13 A class B output stage operates from $\pm 10-\mathrm{V}$ supplies. Assuming relatively ideal transistors, what is the output voltage for maximum power-conversion efficiency? What is the output voltage for maximum device dissipation? If each of the output devices is individually rated for 2-W dissipation, and a factor-of-2 safety margin is to be used, what is the smallest value of load resistance that can be tolerated, if operation is always at full output voltage? If operation is allowed at half the full output voltage, what is the smallest load permitted? What is the greatest possible output power available in each case?

D 12.14 A class B output stage is required to deliver an average power of 50 W into an $8-\Omega$ load. The power supply should be 4 V greater than the corresponding peak sine-wave output voltage. Determine the power-supply voltage required (to the nearest volt in the appropriate direction), the peak current from each supply, the total supply power, and the power-conversion efficiency. Also, determine the maximum possible power dissipation in each transistor for a sine-wave input.
12.15 Consider the class B BJT output stage with a square-wave output voltage of amplitude $\hat{V}_{o}$ across a load
$R_{L}$ and employing power supplies $\pm V_{S E}$. Neglecting the effects of finite $V_{B E}$ and $V_{C E \text { sat }}$, determine the load power, the supply power, the power-conversion efficiency, the maximum attainable power-conversion efficiency and the corresponding value of $\hat{V}_{o}$, and the maximum available load power. Also find the value of $\hat{V}_{o}$ at which the power dissipation in the transistors reaches its peak, and the corresponding value of power-conversion efficiency.
12.16 Sketch a graph for the small-signal voltage gain of the class B circuit of Fig. 12.5 as a function of $v_{t}$, for $v_{t}$ both positive and negative.

## Section 12.4: Class AB Output Stage

12.17 A class AB output stage, such as that in Fig. 12.11, utilizing transistors with $I_{S}=10^{-15} \mathrm{~A}$, is biased at a quiescent current $I_{Q}=1 \mathrm{~mA}$. Find $V_{B B}$, the output resistance $R_{\text {out }}$ at $v_{t}=0$, and the corresponding small-signal voltage gain. The load resistance $R_{L}=100 \Omega$. What does the incremental gain become when $v_{O}=10 \mathrm{~V}$ ?

D 12.18 Design the quiescent current of a class AB BJT output stage so that the incremental voltage gain for $v_{t}$ in the vicinity of the origin is in excess of $0.97 \mathrm{~V} / \mathrm{V}$ for loads larger than $100 \Omega$. Assume that the BJTs have $V_{B E}$ of 0.7 V at a current of 100 mA and determine the value of $V_{B B}$ required.

D 12.19 A class AB output stage, such as that in Fig. 12.11, drives a load resistance $R_{L}$ of $100 \Omega$. What bias current $I_{Q}$ will serve to limit the variation in the small-signal voltage gain to $5 \%$ as $i_{L}$ changes from 0 to 50 mA ?
12.20 For the class AB output stage considered in Example 12.3, add two columns to the table of results as follows: the total input current drawn from $v_{I}\left(i_{I}, \mathrm{~mA}\right)$; and the large-signal input resistance $R_{\text {in }} \equiv v_{I} / i_{I}$. Assume $\beta_{N}=\beta_{P}=\beta=49$. Compare the values of $R_{\text {in }}$ to the approximate value obtained using the resistance-reflection rule, $R_{\text {in }} \simeq \beta R_{L}$.
12.21 In this problem we investigate an important trade-off in the design of the class AB output stage of Fig. 12.11: Increasing the quiescent current $I_{Q}$ reduces the nonlinearity of the transfer characteristic at the expense of increased quiescent power dissipation. As a measure of nonlinearity, we use the maximum deviation of the stage incremental gain, which occurs at $v_{O}=0$, namely,

$$
\epsilon=\left.1-v_{o} / v_{i}\right|_{v_{O}=0}
$$

[^0]
[^0]:    120 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
(a) Show that $\epsilon$ is given by

$$
\epsilon=\frac{V_{T} / 2 I_{Q}}{R_{L}+\left(V_{T} / 2 I_{Q}\right)}
$$

which for $2 I_{Q} R_{L} \gg V_{T}$ can be approximated by

$$
\epsilon \simeq V_{T} / 2 I_{Q} R_{L}
$$

(b) If the stage is operated from power supplies of $\pm V_{C C}$, find the quiescent power dissipation, $P_{D}$.
(c) Show that for given $V_{C C}$ and $R_{L}$, the product of the quiescent power dissipation and the gain error is a constant given by

$$
\epsilon P_{D} \simeq V_{T}\left(\frac{V_{C C}}{R_{L}}\right)
$$

(d) For $V_{C C}=10 \mathrm{~V}$ and $R_{L}=100 \Omega$, find the required values of $P_{D}$ and $I_{Q}$ if $\epsilon$ is to be $5 \%, 2 \%$, and $1 \%$.
*12.22 A class AB output stage, resembling that in Fig. 12.11 but utilizing a single supply of +10 V and biased at $V_{i}=6 \mathrm{~V}$, is capacitively coupled to a $100-\Omega$ load. For transistors for which $\left|V_{B E}\right|=0.7 \mathrm{~V}$ at 1 mA and for a bias voltage $V_{B B}=1.4 \mathrm{~V}$, what quiescent current results? For a step change in output from 0 to -1 V , what input step is required? Assuming transistor-saturation voltages of zero, find the largest possible positive-going and negative-going steps at the output.

## Section 12.5: Biasing the Class AB Circuit

D 12.23 Consider the diode-biased class AB circuit of Fig. 12.14. For $I_{\text {BIAS }}=200 \mu \mathrm{~A}$, find the relative size $(n)$ that should be used for the output devices (in comparison to the biasing devices) to ensure that an output resistance of $8 \Omega$ or less is obtained in the quiescent state. Neglect the resistance of the biasing diodes.
$\mathbf{D}^{*}$ 12.24 A class AB output stage using a two-diode bias network as shown in Fig. 12.14 utilizes diodes having the same junction area as the output transistors. For $V_{C C}=10 \mathrm{~V}$, $I_{\text {BIAS }}=1 \mathrm{~mA}, R_{L}=100 \Omega, \beta_{N}=50$, and $\left|V_{C E s a t}\right|=0 \mathrm{~V}$, what is the quiescent current? What are the largest possible positive and negative output signal levels? To achieve a positive peak output level equal to the negative peak level, what value of $\beta_{N}$ is needed if $I_{\text {BIAS }}$ is not changed? What value of $I_{\text {BIAS }}$ is needed if $\beta_{N}$ is held at 50 ? For this value, what does $I_{Q}$ become?

D 12.25 It is required to evaluate the small-signal input resistance and small-signal voltage gain of the class AB
output stage in Fig. 12.14. To simplify matters, assume the small-signal resistances of $D_{1}$ and $D_{2}$ to be negligibly small. Replace each of $Q_{N}$ and $Q_{P}$ with its hybrid- $\pi$ model and neglect $r_{o}$. Hence show that the class AB stage is equivalent, from a small-signal point of view, to an emitter-follower transistor whose $r_{\pi}=r_{\pi N} \| r_{\pi P}$ and $g_{m}=g_{m N}+g_{m P}$, and hence $r_{e}=r_{e N} \| r_{e P}$ and $\beta=\left(g_{m N}+g_{m P}\right)\left(r_{\pi N} \| r_{\pi P}\right)$. Now show that

$$
\frac{v_{i}}{v_{i}}=\frac{R_{L}}{R_{L}+\left(r_{e N} \| r_{e P}\right)}
$$

and

$$
R_{m} \simeq \beta\left[R_{L}+\left(r_{e N} \| r_{e P}\right)\right]
$$

12.26 Figure P12.26 shows a class AB output stage with a common-emitter transistor added to increase the voltage gain and reduce the current that $v_{I}$ has to supply. Neglecting the small-signal resistances of $D_{1}$ and $D_{2}$, find the small-signal voltage gain $v_{o} / v_{i}$. (Hint: Use the expressions for voltage gain and input resistance of the class AB stage without $Q_{3}$, given in the statement for Problem 12.25.)


Figure P12.26
12.27 It is required to find an expression for the output resistance $R_{\text {out }}$ of the class AB output stage in Fig. P12.26. Toward that end, neglect the small-signal resistance of each of $D_{1}$ and $D_{2}$ and assume the current source supplying $I_{\text {BIAS }}$ has an
output resistance $R_{\text {BIAS }}$. Transistors $Q_{N}$ and $Q_{P}$ are equivalent to a single transistor with $r_{n}=r_{n N} \| r_{n P}, r_{e}=r_{e N} \| r_{e P}$, and $g_{m}=g_{m N}+g_{m P}$.
**12.28 A class AB output stage using a two-diode bias network as shown in Fig. 12.14 utilizes diodes having the same junction area as the output transistors. At a room temperature of about $20^{\circ} \mathrm{C}$ the quiescent current is 1 mA and $\left|V_{B E}\right|=0.6 \mathrm{~V}$. Through a manufacturing error, the thermal coupling between the output transistors and the biasing diode-connected transistors is omitted. After some output activity, the output devices heat up to $70^{\circ} \mathrm{C}$ while the biasing devices remain at $20^{\circ} \mathrm{C}$. Thus, while the $V_{B E}$ of each device remains unchanged, the quiescent current in the output devices increases. To calculate the new current value, recall that there are two effects: $I_{S}$ increases by about $14 \% /{ }^{\circ} \mathrm{C}$ and $V_{T}=k T / q$ changes, where $T=273^{\circ}+$ temperature in ${ }^{\circ} \mathrm{C}$, and $V_{T}=25 \mathrm{mV}$ only at $20^{\circ} \mathrm{C}$. However, you may assume that $\beta_{N}$ remains almost constant. This assumption is based on the fact that $\beta$ increases with temperature but decreases with current. What is the new value of $I_{Q}$ ? If the power supply is $\pm 20 \mathrm{~V}$, what additional power is dissipated? If thermal runaway occurs, and the temperature of the output transistors increases by $10^{\circ} \mathrm{C}$ for every watt of additional power dissipation, what additional temperature rise and current increase result?

D 12.29 Repeat Example 12.5 for the situation in which the peak positive output current is 250 mA . Use the same general approach to safety margins. What are the values of $R_{1}$ and $R_{2}$ you have chosen?
${ }^{* * 12.30}$ A $V_{B E}$ multiplier is designed with equal resistances for nominal operation at a terminal current of 1 mA , with half the current flowing in the bias network. The initial design is based on $\beta=\infty$ and $V_{B E}=0.7 \mathrm{~V}$ at 1 mA .
(a) Find the required resistor values and the terminal voltage.
(b) Find the terminal voltage that results when the terminal current increases to 2 mA . Assume $\beta=\infty$.
(c) Repeat (b) for the case the terminal current becomes 10 mA .
(d) Repeat (c) using the more realistic value of $\beta=100$.
*12.31 By replacing the transistor in the $V_{B E}$ multiplier by its hybrid- $\pi$, small-signal model (with $r_{o}$ neglected), show that the incremental resistance between the two terminals of the multiplier is given by

$$
r=\frac{R_{2}+\left(R_{1} \| r_{o}\right)}{1+g_{m}\left(R_{1} \| r_{o}\right)}
$$

Evaluate $r$ for the case $R_{1}=R_{2}=1.2 \mathrm{k} \Omega$, with the transistor operating at $I_{C}=1 \mathrm{~mA}$ and having $\beta=100$.

## Section 12.6: Variations on the Class AB Configuration

12.32 Use the results given in the answer to Exercise 12.9 to determine the input current of the circuit in Fig. 12.17 for $v_{I}=0$ and $\pm 10 \mathrm{~V}$ with infinite and $100-\Omega$ loads.
12.33 For the circuit in Fig 12.17, operated near $v_{I}=0$ and fed with a signal source having zero resistance, show that the output resistance is given by

$$
R_{\text {out }}=\frac{1}{2}\left[R_{3}+r_{e 3}+\left(R_{1} \| r_{e 1}\right) /\left(\beta_{3}+1\right)\right]
$$

Assume that the top and bottom halves of the circuit are perfectly matched.

D ${ }^{* * * 12.34}$ Consider the circuit of Fig. 12.17 in which $Q_{1}$ and $Q_{2}$ are matched, and $Q_{3}$ and $Q_{4}$ are matched but have three times the junction area of the others. Resistors $R_{3}$ and $R_{4}$ also are matched. For $V_{C C}=10 \mathrm{~V}$, find values for resistors $R_{1}$ through $R_{4}$ that allow for a base current of at least 10 mA in $Q_{3}$ (and $Q_{4}$ ) at $v_{I}=+5 \mathrm{~V}\left(v_{I}=-5 \mathrm{~V}\right)$, when a load demands it, with at most a 2-to-1 variation in currents in $Q_{1}$ (and $Q_{2}$ ). The quiescent current in $Q_{3}$ is to be 40 mA . Let $\beta_{1,2} \geq 150$ and $\beta_{3,4} \geq 50$. For input voltages around 0 V , estimate the output resistance of the overall follower driven by a source having zero resistance. For an input voltage of +1 V and a load resistance of $2 \Omega$, what output voltage results? $Q_{1}$ and $Q_{2}$ have $\left|V_{B E}\right|$ of 0.7 V at a current of 10 mA .
12.35 Figure P12.35 shows a variant of the class AB circuit of Fig. 12.17. Assume that all four transistors are matched and have $\beta=100$.
(a) For $v_{I}=0$, find the quiescent current in $Q_{3}$ and $Q_{4}$, the input current $i_{I}$, and the output voltage $v_{o}$.
(b) Since the circuit has perfect symmetry, the small-signal performance around $v_{I}=0$ can be determined by considering either the top or bottom half of the circuit only. In this case, the load on the half-circuit must be $2 R_{L}$, the input resistance found is $2 R_{m}$, and the output resistance
found is $2 R_{\text {out }}$. Using this approach, find $R_{\text {in }}, v_{o} / v_{i}$, and $R_{\text {out }}$ (assuming that the circuit is fed with a zero-resistance source).


Figure P12.35
12.36 For the Darlington configuration shown in Fig. 12.18, show that for $\beta_{1} \gg 1$ and $\beta_{2} \gg 1$ :
(a) The equivalent composite transistor has $\beta \simeq \beta_{1} \beta_{2}$.
(b) If the composite transistor is operated at a current $I_{C}$, then $Q_{2}$ will be operating at a collector current approximately equal to $I_{C}$, and $Q_{1}$ will be operating at a collector current approximately equal to $I_{C} / \beta_{2}$.
(c) The composite transistor has a base-emitter voltage $V_{B E} \simeq 2 V_{T} \ln \left(I_{C} / I_{S}\right)-V_{T} \ln \left(\beta_{2}\right)$, where $I_{S}$ is the saturation current of each of $Q_{1}$ and $Q_{2}$.
(d) The composite transistor has an equivalent $r_{a} \simeq$ $2 \beta_{1} \beta_{2}\left(V_{T} / I_{C}\right)$.
(e) The composite transistor has an equivalent $g_{m} \simeq$ $\frac{1}{2}\left(I_{C} / V_{T}\right)$.
*12.37 For the circuit in Fig. P12.37 in which the transistors have $V_{B E}=0.7 \mathrm{~V}$ and $\beta=100$ :
(a) Find the dc collector current for each of $Q_{1}$ and $Q_{2}$.
(b) Find the small-signal current $i_{s}$ that results from an input signal $v_{i}$, and hence find the voltage gain $v_{o} / v_{i}$.
(c) Find the input resistance $R_{\text {in }}$.


Figure P12.37

SIIT **12.38 The BJTs in the circuit of Fig. P12.38 have $\beta_{P}=10, \beta_{N}=100,\left|V_{B E}\right|=0.7 \mathrm{~V}$, and $\left|V_{A}\right|=100 \mathrm{~V}$.
(a) Find the dc collector current of each transistor and the value of $V_{C}$.
(b) Replacing each BJT with its hybrid- $\pi$ model, show that

$$
\frac{v_{o}}{v_{i}} \simeq g_{m 1}\left[r_{o 1}\left\|\beta_{N}\left(r_{o 2}\right\| R_{f}\right)\right]
$$

(c) Find the values of $v_{o} / v_{i}$ and $R_{\text {in }}$.


Figure P12.38
D **12.39 Consider the compound-transistor class AB output stage shown in Fig. 12.20 in which $Q_{2}$ and $Q_{4}$ are matched transistors with $V_{B E}=0.7 \mathrm{~V}$ at 10 mA and $\beta=100, Q_{1}$ and $Q_{5}$ have $V_{B E}=0.7 \mathrm{~V}$ at $1-\mathrm{mA}$ currents and $\beta=100$, and $Q_{3}$ has $V_{E B}=0.7 \mathrm{~V}$ at a $1-\mathrm{mA}$ current and $\beta=10$. Design the circuit for a quiescent current of 2 mA in $Q_{2}$ and $Q_{4}, I_{\text {BIAS }}$ that is 100 times the standby base current in $Q_{1}$, and a current in $Q_{5}$ that is nine times that in the associated resistors. Find the values of the input voltage required to produce outputs of $\pm 10 \mathrm{~V}$ for a $1-\mathrm{k} \Omega$ load. Use $V_{C C}$ of 15 V .
*12.40 Figure P12.40 shows a variant on the class AB amplifier known as class G. Here, in addition to the


Figure P12.40
normal power supply $\pm V_{C C 1}$, the circuit is equipped with a higher voltage supply $\pm V_{C C 2}$. The latter supply is utilized only infrequently. The circuit operates as follows. Normally, $D_{1}$ and $D_{2}$ are turned on and thus connect the $\pm V_{C C 1}$ supply to the class AB stage transistors $Q_{1}$ and $Q_{2}$. Simultaneously, $Q_{3}$ and $Q_{4}$ are off. For $v_{I}$ positive and exceeding a certain threshold, $Q_{3}$ turns on, $D_{1}$ turns off, and $Q_{2}$ is then effectively operating from the higher voltage supply $V_{C C 2}$. This continues as long as $v_{I}$ is larger than the specified threshold. As $v_{I}$ decreases below
the threshold value, $Q_{3}$ is turned off and $D_{1}$ turns on, thus connecting $Q_{1}$ to its normal supply $V_{C C 1}$. A similar process happens in the negative direction, with $D_{2}$ and $Q_{4}$ taking the place of $D_{1}$ and $Q_{3}$. Let $V_{C C 1}=35 \mathrm{~V}, V_{C C 2}=70 \mathrm{~V}, V_{Z 1}=3.3 \mathrm{~V}$, and the voltage of the $V_{B E}$ multiplier $V_{B B}=1.2 \mathrm{~V}$.
(a) Find the positive threshold value of $v_{I}$ at which $Q_{3}$ is turned on.
(b) If for $95 \%$ of the time $v_{I}$ is in the vicinity of 30 V and only $5 \%$ of the time it is in the vicinity of 65 V , use Eq. (12.19) to estimate the average power dissipated in the transistors, $P_{D}$. Compare to the value of $P_{D}$ dissipated in a class AB stage operated from a $\pm 70 \mathrm{~V}$ supply.
12.41 Repeat Exercise 12.11 for a design variation in which transistor $Q_{5}$ is increased in size by a factor of 20 , all other conditions remaining the same.
12.42 Repeat Exercise 12.11 for a design in which the limiting output current and normal peak current are 100 mA and 75 mA , respectively.

D 12.43 The circuit shown in Fig. P12.43 operates in a manner analogous to that in Fig. 12.21 to limit the output


Figure P12.43
current from $Q_{3}$ in the event of a short circuit or other mishap. It has the advantage that the current-sensing resistor $R$ does
not appear directly at the output. Find the value of $R$ that causes $Q_{5}$ to turn on and absorb all of $I_{\text {BIAS }}=2 \mathrm{~mA}$, when the current being sourced reaches 100 mA . For $Q_{5}, I_{S}=10^{-14} \mathrm{~A}$. If the normal peak output current is 75 mA , find the voltage drop across $R$ and the collector current in $Q_{5}$.

D 12.44 Consider the thermal shutdown circuit shown in Fig. 12.22. At $25^{\circ} \mathrm{C}, Z_{s}$ is a $6.8-\mathrm{V}$ zener diode with a TC of $2 \mathrm{mV} /{ }^{\circ} \mathrm{C}$, and $Q_{1}$ and $Q_{2}$ are BJTs that display $V_{B E}$ of 0.7 V at a current of $100 \mu \mathrm{~A}$ and have a TC of $-2 \mathrm{mV} /{ }^{\circ} \mathrm{C}$. Design the circuit so that at $125^{\circ} \mathrm{C}$, a current of $200 \mu \mathrm{~A}$ flows in each of $Q_{1}$ and $Q_{2}$. What is the current in $Q_{2}$ at $25^{\circ} \mathrm{C}$ ?

## Section 12.7: CMOS Class AB Output Stages

D 12.45 (a) Show that for the class AB circuit in Fig. 12.23, the small-signal output resistance in the quiescent state is given by

$$
R_{\text {out }} \simeq \frac{1}{g_{\text {mn }}+g_{\text {mp }}}
$$

which for matched devices becomes

$$
R_{\text {out }}=\frac{1}{2 g_{m}}
$$

(b) For a circuit that utilizes MOSFETs with $\left|V_{i}\right|=0.5 \mathrm{~V}$ and $k^{\prime}(W / L)=200 \mathrm{~mA} / \mathrm{V}^{2}$, find the voltage $V_{G G}$ that results in $R_{\text {out }}=20 \Omega$. Also, find $I_{Q}$.

D 12.46 (a) For the circuit in Fig. 12.23 in which $Q_{1}$ and $Q_{2}$ are matched, $Q_{N}$ and $Q_{P}$ are matched, and all devices have the same $\left|V_{i}\right|$, show that the small-signal voltage gain at the quiescent condition is given by

$$
\frac{v_{o}}{v_{i}}=\frac{R_{L}}{R_{L}+\left(2 / g_{m}\right)}
$$

where $g_{m}$ is the transconductance of each of $Q_{N}$ and $Q_{P}$ and where channel-length modulation is neglected.
(b) For the case $I_{\text {BIAS }}=0.2 \mathrm{~mA}, R_{L}=1 \mathrm{k} \Omega, k_{b}=k_{p}=n k_{1}=$ $n k_{2}$, where $k=\mu C_{o s}(W / L)$, and $k_{1}=20 \mathrm{~mA} / \mathrm{V}^{2}$, find the ratio $n$ that results in an incremental gain of 0.98 . Also find the quiescent current $I_{Q}$.
D 12.47 Design the circuit of Fig. 12.23 to operate at $I_{Q}$ $=1 \mathrm{~mA}$ with $I_{\text {BIAS }}=0.1 \mathrm{~mA}$. Let $\mu_{n} C_{o s}=250 \mu \mathrm{~A} / \mathrm{V}^{2}$, $\mu_{n} C_{o s}=100 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{m}=-V_{M}=0.45 \mathrm{~V}$, and $V_{D D}=V_{S S}=$ 2.5 V . Design so that $Q_{1}$ and $Q_{2}$ are matched and $Q_{N}$ and $Q_{P}$ are matched, and that in the quiescent state each operates at an overdrive voltage of 0.15 V .
(a) Specify the $W / L$ ratio for each of the four transistors.
(b) In the quiescent state with $v_{O}=0$, what must $v_{I}$ be?
(c) If $Q_{N}$ is required to supply a maximum load current of 10 mA , find the maximum allowable output voltage. Assume that the transistor supplying $I_{\text {BIAS }}$ needs a minimum of 0.2 V to operate properly.

D 12.48 Consider the design of the class AB output stage of Fig. 12.23 for the following conditions. The stage is operated from $\pm 2.5-\mathrm{V}$ power supplies and is required to provide a minimum output voltage swing of $\pm 1.5 \mathrm{~V}$ while supplying a maximum current equal to 10 times the quiescent current $I_{Q}$. Assume that $Q_{N}$ and $Q_{P}$ are matched and $Q_{1}$ and $Q_{2}$ are matched, that all devices have $\left|V_{i}\right|=0.5 \mathrm{~V}$, and that in the quiescent state all transistors are operated at the same overdrive voltage. What is the value of $V_{O V}$ required, and what $V_{G G}$ is needed?
12.49 The class AB output stage in Fig. 12.24 utilizes two matched transistors with $k_{n}=k_{p}=200 \mathrm{~mA} / \mathrm{V}^{2}$ and is operated from $\pm 2.5-\mathrm{V}$ power supplies. If the stage is required to supply a maximum current of $\pm 20 \mathrm{~mA}$, what is the output voltage swing realized?
12.50 For the CMOS output stage of Fig. 12.25 with $I_{Q}=$ $2 \mathrm{~mA},\left|V_{O V}\right|=0.2 \mathrm{~V}$ for each of $Q_{P}$ and $Q_{N}$ at the quiescent point, and $\mu=5$, find the output resistance at the quiescent point.
12.51 (a) Show that for the CMOS output stage of Fig. 12.25,

$$
|\text { Gain error }|=\frac{R_{\text {out }}}{R_{L}}
$$

(b) For a stage that drives a load resistance of $100 \Omega$ with a gain error of less than $3 \%$, find the overdrive voltage at which $Q_{P}$ and $Q_{N}$ should be operated. Let $I_{Q}=2.5 \mathrm{~mA}$ and $\mu=5$.
12.52 Show that in the CMOS class AB common-source output stage (Fig. 12.25), $Q_{N}$ turns off when $v_{O}=4 I_{Q} R_{L}$ and $Q_{P}$ turns off when $v_{O}=-4 I_{Q} R_{L}$. This is equivalent to saying that one of the transistors turns off when $\left|i_{L}\right|$ reaches $4 I_{Q}$.
$\mathbf{D} * 12.53$ It is required to design the circuit of Fig. 12.25 to drive a load resistance of $50 \Omega$ while exhibiting an output resistance, around the quiescent point, of $2.5 \Omega$.

[^0]
[^0]:    310 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
Operate $Q_{N}$ and $Q_{P}$ at $I_{Q}=1.5 \mathrm{~mA}$ and $\left|V_{O V}\right|=0.15 \mathrm{~V}$. The technology utilized is specified to have $k_{n}^{\prime}=250 \mu \mathrm{~A} / \mathrm{V}^{2}$, $k_{p}^{\prime}=100 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{m}=-V_{N}=0.5 \mathrm{~V}$, and $V_{D D}=V_{S S}=2.5 \mathrm{~V}$.
(a) Specify $(W / L)$ for each of $Q_{N}$ and $Q_{P}$.
(b) Specify the required value of $\mu$.
(c) What is the expected error in the stage gain?
(d) In the quiescent state, what dc voltage must appear at the output of each of the error amplifiers?
(e) At what value of positive $v_{O}$ will $Q_{P}$ be supplying all the load current? Repeat for negative $v_{O}$ and $Q_{N}$ supplying all the load current.
(f) What is the linear range of $v_{O}$ ?
*12.54 Figure P12.54 shows a class AB output stage utilizing a pair of complementary MOSFETs $\left(Q_{N}, Q_{P}\right)$ and
employing BJTs for biasing and in the driver stage. The latter consists of complementary Darlington emitter followers formed by $Q_{1}$ through $Q_{4}$ and has the low output resistance necessary for driving the output MOSFETs at high speeds. Of special interest is the bias circuit utilizing two $V_{B E}$ multipliers formed by $Q_{5}$ and $Q_{6}$ and their associated resistors. Transistor $Q_{6}$ is placed in direct thermal contact with the output transistors and thus has the same temperature as that of $Q_{N}$ and $Q_{P}$.
(a) Show that $V_{G G}$ is given by

$$
V_{G G}=\left(1+\frac{R_{3}}{R_{4}}\right) V_{B E 6}+\left(1+\frac{R_{3}}{R_{2}}\right) V_{B E 5}-4 V_{B E}
$$

(b) Noting that $V_{B E 6}$ is thermally coupled to the output devices while the other BJTs remain at constant temperature, show that


Figure P12.54

[^0]
[^0]:    516 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
$$
\frac{\partial V_{G G}}{\partial T}=\left(1+\frac{R_{3}}{R_{4}}\right) \frac{\partial V_{B E h}}{\partial T}
$$

(c) To keep the overdrive voltages of $Q_{N}$ and $Q_{P}$, and hence their quiescent current, constant with temperature variation, $\partial V_{G G} / \partial T$ is made equal to $\partial\left(V_{o V}+V_{i P}\right) / \partial T$. Find $R_{3} / R_{4}$ that provides this temperature stabilization when $\left|V_{i}\right|$ changes by $-3 \mathrm{mV} /{ }^{\circ} \mathrm{C}$ and $\partial V_{B E} / \partial T=$ $-2 \mathrm{mV} /{ }^{\circ} \mathrm{C}$.
(d) Using the value of $R_{3} / R_{4}$ found in (c) and assuming that the nominal value of $V_{B E}$ is 0.7 V and that the MOSFETs have $\left|V_{i}\right|=3 \mathrm{~V}$ and $\mu C_{o s}(W / L)=2 \mathrm{~A} / \mathrm{V}^{2}$, find $\left|V_{G S}\right|$, $V_{G G}, R$, and $R_{1} / R_{2}$ to establish a quiescent current of 100 mA in the output transistors and 20 mA in the driver stage.

## Section 12.8: IC Power Amplifiers

D 12.55 In the power-amplifier circuit of Fig. 12.29, two resistors are important in controlling the overall voltage gain. Which are they? Which controls the gain alone? Which affects both the dc output level and the gain? A new design is being considered in which the output dc level is approximately $\frac{3}{2} V_{S}$ (rather than approximately $\frac{1}{2} V_{S}$ ) with a gain of 50 (as before). What changes are needed?
12.56 Consider the front end of the circuit in Fig. 12.29. For $V_{S}=22 \mathrm{~V}$, calculate approximate values for the bias currents in $Q_{1}$ through $Q_{h}$. Assume $\beta_{\text {sym }}=100, \beta_{\text {prep }}=20$, and $\left|V_{B E}\right|=0.7 \mathrm{~V}$. Also find the dc voltage at the output.

D 12.57 It is required to use the LM380 power amplifier to drive an $8-\Omega$ loudspeaker while limiting the maximum possible device dissipation to 2 W . Use the graph of Fig. 12.31 to determine the maximum possible power-supply voltage that can be used. (Use only the given graphs; do not interpolate.) If the maximum allowed THD is to be $3 \%$, what is the maximum possible load power? To deliver this power to the load what peak-to-peak output sinusoidal voltage is required?
12.58 For the circuit in Fig. P12.58, assuming all transistors to have large $\beta$, show that $i_{O}=v_{I} / R$. [This voltage-to-current converter is an application of a versatile circuit building block known as the current conveyor; see Sedra and Roberts (1990).] For $\beta=100$, by what approximate percentage is $i_{O}$ actually lower than this ideal value?


Figure P12.58

D 12.59 For the bridge amplifier of Fig. 12.32, let $R_{1}=$ $R_{3}=10 \mathrm{k} \Omega$. Find $R_{2}$ and $R_{4}$ to obtain an overall gain of $8 \mathrm{~V} / \mathrm{V}$.

D 12.60 An alternative bridge amplifier configuration, with high input resistance, is shown in Fig. P12.60. [Note the similarity of this circuit to the front end of the instrumentation amplifier circuit shown in Fig. 2.20(b).] What is the gain $v_{O} / v_{I}$ ? For op amps (using $\pm 15-\mathrm{V}$ supplies) that limit at $\pm 13 \mathrm{~V}$, what is the largest sine wave you can provide across $R_{L}$ ? Using $1 \mathrm{k} \Omega$ as the smallest resistor, find resistor values that make $v_{O} / v_{I}=8 \mathrm{~V} / \mathrm{V}$. Make sure that the signals at the outputs of the two amplifiers are complementary.


Figure P12.60

[^0]
[^0]:    $\overline{\text { SIN }}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem## Section 12.9 Class D Power Amplifiers

12.61 Sketch diagrams resembling those in Figs. 12.33(a), (b). Let $v_{T}$ have $\pm 10 \mathrm{~V}$ peaks and assume $v_{A}$ is a sine wave with $5-\mathrm{V}$ peak amplitude. Let the frequency of $v_{T}$ be 5 times that of $v_{A}$. The comparator output levels are $\pm 10 \mathrm{~V}$.
12.62 A pulse waveform swinging between $\pm 10 \mathrm{~V}$ has a duty ratio of 0.65 . What is its average value? If the duty ratio is changed to 0.35 , what does the average value become?
12.63 For the circuit in Fig. 12.34(b):
(a) If $v_{A}$ is a sine wave, what is the maximum power supplied to a load of resistance $R$, in terms of $V_{D D}$ ?
(b) The power loss is mostly due to the repeated charging and discharging of a capacitance $C$ across the load. It can be shown that this switching power is given by $4 f_{s} C V_{D D}^{2}$. Find an expression for the power-conversion efficiency $\eta$ and evaluate the value of $\eta$ for the case $f_{s}=250 \mathrm{kHz}$ and $C=1000 \mathrm{pF}$.

## Section 12.10 Power Transistors

12.64 A power MOSFET is specified to have $I_{D \max }=5 \mathrm{~A}$, $V_{D S \max }=50 \mathrm{~V}$, and $P_{D \max }=50 \mathrm{~W}$.
(a) Sketch the SOA boundaries.
(b) If the MOSFET is used in the common-source configuration as shown in Fig. P12.64, show that the maximum current occurs when $V_{D S}=0$, the maximum $V_{D S}$ occurs when $I_{D}=0$, and the maximum power dissipation occurs when $V_{D S}=V_{D D} / 2$.
(c) For $V_{D D}=40 \mathrm{~V}$, find the smallest resistance $R$ for which the operating point is always within the SOA. What are the corresponding values of $I_{D \max }$ and $P_{D \max }$ ?
(d) Repeat (c) for $V_{D D}=30 \mathrm{~V}$.
(e) Repeat (c) for $V_{D D}=15 \mathrm{~V}$.


Figure P12.64

D 12.65 A particular transistor having a thermal resistance $\theta_{D s}=2.5^{\circ} \mathrm{C} / \mathrm{W}$ is operating at an ambient temperature of $30^{\circ} \mathrm{C}$ with a collector-emitter voltage of 20 V . If long life requires a maximum junction temperature of $130^{\circ} \mathrm{C}$, what is the corresponding device power rating? What is the greatest average collector current that should be considered?
12.66 A particular transistor has a power rating at $25^{\circ} \mathrm{C}$ of 10 W , and a maximum junction temperature of $150^{\circ} \mathrm{C}$. What is its thermal resistance? What is its power rating when operated at an ambient temperature of $50^{\circ} \mathrm{C}$ ? What is its junction temperature when dissipating 5 W at an ambient temperature of $50^{\circ} \mathrm{C}$ ?
12.67 A power transistor operating at an ambient temperature of $50^{\circ} \mathrm{C}$, and an average emitter current of 3 A , dissipates 20 W . If the thermal resistance of the transistor is known to be less than $3^{\circ} \mathrm{C} / \mathrm{W}$, what is the highest junction temperature you would expect? If the transistor $V_{B E}$ measured using a pulsed emitter current of 3 A at a junction temperature of $25^{\circ} \mathrm{C}$ is 0.80 V , what average $V_{B E}$ would you expect under normal operating conditions? (Use a temperature coefficient of $-2 \mathrm{mV} /{ }^{\circ} \mathrm{C}$.)
12.68 For a particular application of the transistor specified in Example 12.7, extreme reliability is essential. To improve reliability, the maximum junction temperature is to be limited to $100^{\circ} \mathrm{C}$. What are the consequences of this decision for the conditions specified?
12.69 A power transistor is specified to have a maximum junction temperature of $150^{\circ} \mathrm{C}$. When the device is operated at this junction temperature with a heat sink, the case temperature is found to be $97^{\circ} \mathrm{C}$. The case is attached to the heat sink with a bond having a thermal resistance $\theta_{C S}=0.5^{\circ} \mathrm{C} / \mathrm{W}$ and the thermal resistance of the heat sink $\theta_{S A}=0.1^{\circ} \mathrm{C} / \mathrm{W}$. If the ambient temperature is $25^{\circ} \mathrm{C}$, what is the power being dissipated in the device? What is the thermal resistance of the device, $\theta_{A C}$, from junction to case?
12.70 A power transistor for which $T_{\text {rmax }}=180^{\circ} \mathrm{C}$ can dissipate 50 W at a case temperature of $30^{\circ} \mathrm{C}$. If it is connected to a heat sink using an insulating washer for which the thermal resistance is $0.6^{\circ} \mathrm{C} / \mathrm{W}$, what heat-sink temperature is necessary to ensure safe operation at 30 W ? For an ambient temperature of $27^{\circ} \mathrm{C}$, what heat-sink thermal resistance is required? If, for a particular extruded-aluminum-finned heat sink, the thermal resistance in still air is $6^{\circ} \mathrm{C} / \mathrm{W}$ per centimeter of length, how long a heat sink is needed?
# CHAPTER 13 

## Operational-Amplifier Circuits

Introduction 995
13.1 The Two-Stage CMOS Op Amp 996
13.2 The Folded-Cascode CMOS Op Amp 1016
13.3 The 741 BJT Op Amp 1028
13.4 Modern Techniques for the Design of BJT Op Amps 1054

Summary 1073
Problems 1074
# IN THIS CHAPTER YOU WILL LEARN 

1. The design and analysis of the two basic CMOS op-amp architectures: the two-stage circuit and the single-stage, folded-cascode circuit.
2. The complete circuit of an analog IC classic: the 741 BJT op amp. Though over 40 years old, the 741 circuit includes so many interesting and useful design techniques that its study is still a must.
3. Interesting and useful applications of negative feedback within op-amp circuits to achieve bias stability and increased CMRR.
4. How to break a large analog circuit into its recognizable blocks to be able to make the analysis amenable to a pencil-and-paper approach, which is the best way to learn design.
5. Some of the modern techniques employed in the design of low-voltage, single-supply BJT op amps.
6. Most important, how the different topics we studied in the preceding chapters come together in the design of the most important analog IC, the op amp.

## Introduction

In this chapter, we shall study the internal circuitry of the most important analog IC, namely, the operational amplifier. The terminal characteristics and some circuit applications of op amps were covered in Chapter 2. Here, our objective is to expose the reader to some of the ingenious techniques that have evolved over the years for combining elementary analog circuit building blocks to realize a complete op amp. We shall study both CMOS and bipolar op amps.

The CMOS op-amp circuits considered find application primarily in the design of analog and mixed-signal VLSI circuits. Because these op amps are usually designed with a specific application in mind, they can be optimized to meet a subset of the list of desired specifications, such as high dc gain, wide bandwidth, or large output-signal swing. For instance, many CMOS op amps are utilized within an IC and do not connect to the outside terminals of the chip. As a result, the loads on their outputs are usually limited to small capacitances of at most a few picofarads. Internal CMOS op amps therefore do not need to have low output resistances, and their design rarely incorporates an output stage. Also, if the op-amp input terminals are not connected to the chip terminals, there will be no danger of static charge damaging the gate oxide of the input MOSFETs. Hence, internal CMOS op amps do not need input
clamping diodes for gate protection and thus do not suffer from the leakage effects of such diodes. In other words, the advantage of near-infinite input resistance of the MOSFET is fully realized.

While CMOS op amps are extensively used in the design of VLSI systems, the BJT remains the device of choice in the design of general-purpose op amps. These are op amps that are utilized in a wide variety of applications and are designed to fit a wide range of specifications. As a result, the circuit of a general-purpose op amp represents a compromise among many performance parameters. We shall study in detail one such circuit, the 741-type op amp. Although the 741 has been available for over 40 years, its internal circuit remains as relevant and interesting today as it ever was. Nevertheless, changes in technology have introduced new requirements, such as the need for general-purpose op amps that operate from a single power supply of only 2 V to 3 V . These new requirements have given rise to exciting challenges to op-amp designers. The result has been a wealth of new ideas and design techniques. We shall present a sample of these modern design techniques in the last section.

In addition to exposing the reader to some of the ideas that make analog IC design such an exciting topic, this chapter should serve to tie together many of the concepts and methods studied thus far.

THE GENIE OF ANALOG:

The need for precision in analog ICs supported a generation of highly skilled circuit and process engineers. Their creative approaches to overcoming the limitations of available technology led to celebrity status among their peers. Perhaps most famous of all was Robert Widlar, who teamed with process engineer Dave Talbert to bootstrap the analog business in the 1960s with highly successful designs for Fairchild and National Semiconductor. Widlar's pranks, including threatening to cut through bureaucracy with an axe, and buying a sheep to trim National's unkempt lawns, remain Silicon Valley legends.

Robert John Widlar was already a legendary chip designer at age 33 (but died at 53), and a pioneer of linear analog integrated-circuit design: the creator of the Widlar current source, the Widlar bandgap voltage reference, the Widlar output stage, and a host of op-amp designs, including the first mass-produced operational amplifier ICs (Fairchild $\mu \mathrm{A} 702, \mu \mathrm{~A} 709$ ), the first integrated voltage regulator ( $\mu \mathrm{A} 723$, National LM100), the first fully internally compensated operational amplifier (LM101), the field-effect input (LM101A), and the super-beta input (LM108). Each of Widlar's designs became a product champion in its class, undoubtedly because they all had at least one feature that was far ahead of the crowd.

# 13.1 The Two-Stage CMOS Op Amp 

The first op-amp circuit we shall study is the two-stage CMOS topology shown in Fig. 13.1. This simple but elegant circuit has become a classic and is used in a variety of forms in the design of VLSI systems. We have already studied this circuit in Section 9.6.1 as an example of a multistage CMOS amplifier. We urge the reader to review Section 9.6.1 before proceeding further. Here, our detailed study will emphasize the performance characteristics of the circuit and the trade-offs involved in its design.


Figure 13.1 The basic two-stage CMOS op-amp configuration.

# 13.1.1 The Circuit 

The circuit consists of two gain stages: The first stage is formed by the differential pair $Q_{1}-Q_{2}$ together with its current-mirror load $Q_{3}-Q_{4}$. This differential-amplifier circuit, studied in detail in Section 9.5, provides a voltage gain that is typically in the range of $20 \mathrm{~V} / \mathrm{V}$ to $60 \mathrm{~V} / \mathrm{V}$, as well as performing conversion from differential to single-ended form while providing a reasonably high common-mode rejection ratio (CMRR).

The differential pair is biased by current source $Q_{5}$, which is one of the two output transistors of the current mirror formed by $Q_{8}, Q_{5}$, and $Q_{7}$. The current mirror is fed by a reference current $I_{\mathrm{REF}}$, which can be generated by simply connecting a precision resistor (external to the chip) to the negative supply voltage $-V_{S S}$ or to a more precise negative voltage reference if one is available in the same integrated circuit. Alternatively, for applications with more stringent requirements, $I_{\text {REF }}$ can be generated using a circuit such as that studied later in this section (see Fig. 13.8).

The second gain stage consists of the common-source transistor $Q_{6}$ and its current-source load $Q_{7}$. The second stage typically provides a gain of $50 \mathrm{~V} / \mathrm{V}$ to $80 \mathrm{~V} / \mathrm{V}$. In addition, it takes part in the process of frequency compensating the op amp. From Section 11.10 the reader will recall that to guarantee that the op amp will operate in a stable fashion (as opposed to oscillating) when negative feedback of various amounts is applied, the open-loop gain is made to roll off with frequency at the uniform rate of $-20 \mathrm{~dB} /$ decade. This in turn is achieved by introducing a pole at a relatively low frequency and arranging for it to dominate the frequency-response determination. In the circuit we are studying, this is implemented using a compensation capacitance $C_{C}$ connected in the negative-feedback path of the second-stage amplifying transistor $Q_{6}$. As will be seen, $C_{C}$ (together with the much smaller capacitance $C_{p d 6}$ across it) is Miller-multiplied by the gain of the second stage, and the resulting capacitance at the input of the second stage interacts with the total resistance there to provide the required dominant pole (more on this later).
Unless properly designed, the CMOS op-amp circuit of Fig. 13.1 can exhibit a systematic output dc offset voltage. This point was discussed in Section 9.6.1, where it was found that the systematic dc offset can be eliminated by sizing the transistors so as to satisfy the following constraint:

$$
\frac{(W / L)_{6}}{(W / L)_{4}}=2 \frac{(W / L)_{7}}{(W / L)_{5}}
$$

Finally, we observe that the CMOS op-amp circuit of Fig. 13.1 does not have an output stage. This is because it is usually required to drive only small on-chip capacitive loads. ${ }^{1}$

# 13.1.2 Input Common-Mode Range and Output Swing 

Refer to Fig. 13.1 and consider the situation when the two input terminals are tied together and connected to a voltage $V_{I C M}$. The lowest value of $V_{I C M}$ has to be sufficiently large to keep $Q_{1}$ and $Q_{2}$ in saturation. Thus, the lowest value of $V_{I C M}$ should not be lower than the voltage at the drain of $Q_{1}\left(-V_{S S}+V_{G S 3}=-V_{S S}+V_{m}+V_{O V 3}\right)$ by more than $\left|V_{i p}\right|$, thus

$$
V_{I C M} \geq-V_{S S}+V_{m}+V_{O V 3}-\left|V_{i p}\right|
$$

The highest value of $V_{I C M}$ should ensure that $Q_{5}$ remains in saturation; that is, the voltage across $Q_{5}, V_{S D 5}$, should not decrease below $\left|V_{O V 5}\right|$. Equivalently, the voltage at the drain of $Q_{5}$ should not go higher than $V_{D D}-\left|V_{O V 5}\right|$. Thus the upper limit of $V_{I C M}$ is

$$
V_{I C M} \leq V_{D D}-\left|V_{O V 5}\right|-V_{S G 1}
$$

or equivalently

$$
V_{I C M} \leq V_{D D}-\left|V_{O V 5}\right|-\left|V_{i p}\right|-\left|V_{O V 1}\right|
$$

The expressions in Eqs. (13.2) and (13.3) can be combined to express the input common-mode range as

$$
-V_{S S}+V_{O V 3}+V_{m}-\left|V_{i p}\right| \leq V_{I C M} \leq V_{D D}-\left|V_{i p}\right|-\left|V_{O V 1}\right|-\left|V_{O V 5}\right|
$$

As expected, the overdrive voltages, which are important design parameters, subtract from the dc supply voltages, thereby reducing the input common-mode range. It follows that from a $V_{I C M}$ range point of view, it is desirable to select the values of $V_{O V}$ as low as possible. We observe from Eq. (13.4) that the lower limit of $V_{I C M}$ is approximately within an overdrive voltage of $-V_{S S}$. The upper limit, however, is not as good; it is lower than $V_{D D}$ by two overdrive voltages and a threshold voltage.

The extent of the signal swing allowed at the output of the op amp is limited at the lower end by the need to keep $Q_{6}$ saturated and at the upper end by the need to keep $Q_{7}$ saturated, thus

$$
-V_{S S}+V_{O V 6} \leq v_{O} \leq V_{D D}-\left|V_{O V 7}\right|
$$

Thus the output voltage can swing to within an overdrive voltage of each of the supply rails. This is a reasonably wide output swing and can be maximized by selecting values for $\left|V_{O V}\right|$ of $Q_{6}$ and $Q_{7}$ as low as possible.

[^0]
[^0]:    ${ }^{1}$ If the amplifier is required to drive low-resistance loads and thus a low output resistance is needed, a source follower can be connected to the output of the second stage.
An important requirement of an op-amp circuit is that it be possible for its output terminal to be connected back to its negative input terminal so that a unity-gain amplifier is obtained. For such a connection to be possible, there must be a substantial overlap between the allowable range of $v_{O}$ and the allowable range of $V_{I C M}$. This is usually the case in the CMOS amplifier circuit under study.

# EXERCISE 

13.1 For a particular design of the two-stage CMOS op amp of Fig. 13.1, $\pm 1.65-\mathrm{V}$ supplies are utilized and all transistors except for $Q_{6}$ and $Q_{7}$ are operated with overdrive voltages of $0.3-\mathrm{V}$ magnitude; $Q_{6}$ and $Q_{7}$ use overdrive voltages of $0.5-\mathrm{V}$ magnitude. The fabrication process employed provides $V_{i n}=\left|V_{i p}\right|=0.5 \mathrm{~V}$. Find the input common-mode range and the range allowed for $v_{O}$. Ans. -1.35 V to $0.55 \mathrm{~V} ;-1.15 \mathrm{~V}$ to +1.15 V

### 13.1.3 DC Voltage Gain

To determine the dc voltage gain and the frequency response, consider a simplified equivalent-circuit model for the small-signal operation of the CMOS amplifier (Fig. 13.2), where each of the two stages is modeled as a transconductance amplifier. As expected, the input resistance is practically infinite,

$$
R_{\mathrm{in}}=\infty
$$

The first-stage transconductance $G_{m 1}$ is equal to the transconductance of each of $Q_{1}$ and $Q_{2}$ (see Section 9.5),

$$
G_{m 1}=g_{m 1}=g_{m 2}
$$

Since $Q_{1}$ and $Q_{2}$ are operated at equal bias currents (I/2) and equal overdrive voltages, $\left|V_{O V 1}\right|=$ $\left|V_{O V 2}\right|$,

$$
G_{m 1}=\frac{2(I / 2)}{\left|V_{O V 1}\right|}=\frac{I}{\left|V_{O V 1}\right|}
$$



Figure 13.2 Small-signal equivalent circuit for the op amp in Fig. 13.1.
Resistance $R_{1}$ represents the output resistance of the first stage, thus

$$
R_{1}=r_{o 2} \| r_{o 4}
$$

where

$$
r_{o 2}=\frac{\left|V_{A 2}\right|}{I / 2}
$$

and

$$
r_{o 4}=\frac{V_{A 4}}{I / 2}
$$

The dc gain of the first stage is thus

$$
\begin{aligned}
A_{1} & =-G_{m 1} R_{1} \\
& =-g_{m 1}\left(r_{o 2} \| r_{o 4}\right) \\
& =-\frac{2}{\left|V_{O V 1}\right|} /\left[\frac{1}{\left|V_{A 2}\right|}+\frac{1}{V_{A 4}}\right]
\end{aligned}
$$

Observe that the magnitude of $A_{1}$ is increased by operating the differential-pair transistors, $Q_{1}$ and $Q_{2}$, at a low overdrive voltage, and by choosing longer channel lengths for $Q_{1}, Q_{2}, Q_{3}$, and $Q_{4}$ so as to obtain larger Early voltages, $\left|V_{A}\right|$.

Returning to the equivalent circuit in Fig. 13.2 and leaving the discussion of the various model capacitances until Section 13.1.5, we note that the second-stage transconductance $G_{m 2}$ is given by

$$
G_{m 2}=g_{m 6}=\frac{2 I_{D 6}}{V_{O V 6}}
$$

Resistance $R_{2}$ represents the output resistance of the second stage, thus

$$
R_{2}=r_{o 6} \| r_{o 7}
$$

where

$$
r_{o 6}=\frac{V_{A 6}}{I_{D 6}}
$$

and

$$
r_{o 7}=\frac{\left|V_{A 7}\right|}{I_{D 7}}=\frac{\left|V_{A 7}\right|}{I_{D 6}}
$$

The voltage gain of the second stage can now be found as

$$
\begin{aligned}
A_{2} & =-G_{m 2} R_{2} \\
& =-g_{m 6}\left(r_{o 6} \| r_{o 7}\right) \\
& =-\frac{2}{V_{O V 6}} /\left[\frac{1}{V_{A 6}}+\frac{1}{\left|V_{A 7}\right|}\right]
\end{aligned}
$$
Here again we observe that to increase the magnitude of $A_{2}, Q_{6}$ has to be operated at a low overdrive voltage, and the channel lengths of $Q_{6}$ and $Q_{7}$ should be made longer.

The overall dc voltage gain can be found as the product $A_{1} A_{2}$,

$$
\begin{aligned}
A_{v} & =A_{1} A_{2} \\
& =G_{m 1} R_{1} G_{m 2} R_{2} \\
& =g_{m 1}\left(r_{o 2} \| r_{o 4}\right) g_{m 6}\left(r_{o 6} \| r_{o 7}\right)
\end{aligned}
$$

Note that $A_{v}$ is of the order of $\left(g_{m} r_{o}\right)^{2}$. Thus the value of $A_{v}$ will be in the range of $500 \mathrm{~V} / \mathrm{V}$ to $5000 \mathrm{~V} / \mathrm{V}$.

Finally, we note that the output resistance of the op amp is equal to the output resistance of the second stage,

$$
R_{o}=r_{o 6} \| r_{o 7}
$$

Hence $R_{o}$ can be large (i.e., in the tens-of-kilohms range). Nevertheless, as we learned from the study of negative feedback in Chapter 11, application of negative feedback that samples the op-amp output voltage results in reducing the output resistance by a factor equal to the amount of feedback $(1+A \beta)$. Also, as mentioned before, CMOS op amps are rarely required to drive heavy resistive loads.

# EXERCISES 

13.2 The CMOS op amp of Fig. 13.1 is fabricated in a process for which $V_{A n}^{\prime}=\left|V_{A p}^{\prime}\right|=20 \mathrm{~V} / \mu \mathrm{m}$. Find $A_{1}, A_{2}$, and $A_{v}$ if all devices are $1 \mu \mathrm{~m}$ long, $\left|V_{O V 1}\right|=0.2 \mathrm{~V}$, and $V_{O V 6}=0.5 \mathrm{~V}$. Also, find the op-amp output resistance obtained when the second stage is biased at 0.5 mA .
Ans. $-100 \mathrm{~V} / \mathrm{V} ;-40 \mathrm{~V} / \mathrm{V} ; 4000 \mathrm{~V} / \mathrm{V} ; 20 \mathrm{k} \Omega$
13.3 If the CMOS op amp in Fig. 13.1 is connected as a unity-gain buffer, show that the closed-loop output resistance is given by
$R_{\text {out }} \simeq 1 / g_{m 6}\left[g_{m 1}\left(r_{o 2} \| r_{o 4}\right)\right]$

### 13.1.4 Common-Mode Rejection Ratio (CMRR)

The CMRR of the two-stage op amp of Fig. 13.1 is determined by the first stage. This was analyzed in Section 9.5.5 and the result is given in Eq. (9.158), namely,

$$
\mathrm{CMRR}=\left[g_{m 1}\left(r_{o 2} \| r_{o 4}\right)\right]\left[2 g_{m 3} R_{S S}\right]
$$

where $R_{S S}$ is the output resistance of the bias current source $Q_{5}\left(r_{o 5}\right)$. Observe that CMRR is of the order of $\left(g_{m} r_{o}\right)^{2}$ and thus can be reasonably high. Also, since $g_{m} r_{o}$ is proportional to $V_{A} / V_{O V}=V_{A}^{\prime} L / V_{O V}$, the CMRR is increased if long channels are used, especially for $Q_{5}$, and the transistors are operated at low overdrive voltages.# 13.1.5 Frequency Response 

Refer to the equivalent circuit in Fig. 13.2. Capacitance $C_{1}$ is the total capacitance between the output node of the first stage and ground, thus

$$
C_{1}=C_{g d 2}+C_{d b 2}+C_{g d 4}+C_{d b 4}+C_{g s 6}
$$

Capacitance $C_{2}$ represents the total capacitance between the output node of the op amp and ground and includes whatever load capacitance $C_{L}$ that the amplifier is required to drive, thus

$$
C_{2}=C_{d b 6}+C_{d b 7}+C_{g d 7}+C_{L}
$$

Usually, $C_{L}$ is larger than the transistor capacitances, with the result that $C_{2}$ becomes much larger than $C_{1}$. As mentioned before, capacitor $C_{C}$ is deliberately included for the purpose of equipping the op amp with a uniform $-6-\mathrm{dB} /$ octave frequency response. In the following, we shall see how this is possible and how to select a value for $C_{C}$. Finally, note that in the equivalent circuit of Fig. 13.2 we should have included $C_{g d b}$ in parallel with $C_{C}$. Usually, however, $C_{C} \gg C_{g d b}$, which is the reason we have neglected $C_{g d b}$.

To determine $V_{o}$, analysis of the circuit in Fig. 13.2 proceeds as follows. Writing a node equation at node $\mathrm{D}_{2}$ yields

$$
G_{m 1} V_{i d}+\frac{V_{i 2}}{R_{1}}+s C_{1} V_{i 2}+s C_{C}\left(V_{i 2}-V_{o}\right)=0
$$

Writing a node equation at node $\mathrm{D}_{6}$ yields

$$
G_{m 2} V_{i 2}+\frac{V_{o}}{R_{2}}+s C_{2} V_{o}+s C_{C}\left(V_{o}-V_{i 2}\right)=0
$$

To eliminate $V_{i 2}$ and thus determine $V_{o}$ in terms of $V_{i d}$, we use Eq. (13.28) to express $V_{i 2}$ in terms of $V_{o}$ and substitute the result into Eq. (13.27). After some straightforward manipulations we obtain the amplifier transfer function

$$
\frac{V_{o}}{V_{i d}}=\frac{G_{m 1}\left(G_{m 2}-s C_{C}\right) R_{1} R_{2}}{1+s\left[C_{1} R_{1}+C_{2} R_{2}+C_{C}\left(G_{m 2} R_{1} R_{2}+R_{1}+R_{2}\right)\right]+s^{2}\left[C_{1} C_{2}+C_{C}\left(C_{1}+C_{2}\right)\right] R_{1} R_{2}}
$$

First we note that for $s=0$ (i.e., dc), Eq. (13.29) gives $V_{o} / V_{i d}=\left(G_{m 1} R_{1}\right)\left(G_{m 2} R_{2}\right)$, which is what we should have expected. Second, the transfer function in Eq. (13.29) indicates that the amplifier has a transmission zero at $s=s_{Z}$, which is determined from

$$
G_{m 2}-s_{Z} C_{C}=0
$$

Thus,

$$
s_{Z}=\frac{G_{m 2}}{C_{C}}
$$

In other words, the zero is on the positive real axis with a frequency $\omega_{Z}$ of

$$
\omega_{Z}=\frac{G_{m 2}}{C_{C}}
$$
Also, the amplifier has two poles that are the roots of the denominator polynomial of Eq. (13.29). If the frequencies of the two poles are denoted $\omega_{P 1}$ and $\omega_{P 2}$, then the denominator polynomial can be expressed as

$$
D(s)=\left(1+\frac{s}{\omega_{P 1}}\right)\left(1+\frac{s}{\omega_{P 2}}\right)=1+s\left(\frac{1}{\omega_{P 1}}+\frac{1}{\omega_{P 2}}\right)+\frac{s^{2}}{\omega_{P 1} \omega_{P 2}}
$$

Now if one of the poles is dominant, say with frequency $\omega_{P 1}$, then $\omega_{P 1} \ll \omega_{P 2}$, and $D(s)$ can be approximated by

$$
D(s) \simeq 1+\frac{s}{\omega_{P 1}}+\frac{s^{2}}{\omega_{P 1} \omega_{P 2}}
$$

The frequency of the dominant pole, $\omega_{P 1}$, can now be determined by equating the coefficients of the $s$ terms in the denominator in Eq. (13.29) and in Eq. (13.32),

$$
\begin{aligned}
\omega_{P 1} & =\frac{1}{C_{1} R_{1}+C_{2} R_{2}+C_{C}\left(G_{m 2} R_{2} R_{1}+R_{1}+R_{2}\right)} \\
& =\frac{1}{R_{1}\left[C_{1}+C_{C}\left(1+G_{m 2} R_{2}\right)\right]+R_{2}\left(C_{2}+C_{C}\right)}
\end{aligned}
$$

We recognize the first term in the denominator as arising at the interface between the first and second stages. Here, $R_{1}$, the output resistance of the first stage, is interacting with the total capacitance at the interface. The latter is the sum of $C_{1}$ and the Miller capacitance $C_{C}\left(1+G_{m 2} R_{2}\right)$, which results from connecting $C_{C}$ in the negative-feedback path of the second stage whose gain is $G_{m 2} R_{2}$. Now, since $R_{1}$ and $R_{2}$ are usually of comparable value, we see that the first term in the denominator will be much larger than the second and we can approximate $\omega_{P 1}$ as

$$
\omega_{P 1} \simeq \frac{1}{R_{1}\left[C_{1}+C_{C}\left(1+G_{m 2} R_{2}\right)\right]}
$$

A further approximation is possible because $C_{1}$ is usually much smaller than the Miller capacitance and $G_{m 2} R_{2} \gg 1$, thus

$$
\omega_{P 1} \simeq \frac{1}{R_{1} C_{C} G_{m 2} R_{2}}
$$

The frequency of the second, nondominant pole can be found by equating the coefficients of the $s^{2}$ terms in the denominator of Eq. (13.29) and in Eq. (13.32) and substituting for $\omega_{P 1}$ from Eq. (13.34). The result is

$$
\omega_{P 2}=\frac{G_{m 2} C_{C}}{C_{1} C_{2}+C_{C}\left(C_{1}+C_{2}\right)}
$$

Since $C_{1} \ll C_{2}$ and $C_{1} \ll C_{C}, \omega_{P 2}$ can be approximated as

$$
\omega_{P 2} \simeq \frac{G_{m 2}}{C_{2}}
$$

To provide the op amp with a uniform gain rolloff of $-20 \mathrm{~dB} /$ decade down to 0 dB , the value of the compensation capacitor $C_{C}$ is selected so that the resulting value of $\omega_{P 1}$ (Eq. 13.34),
when multiplied by the dc gain $\left(G_{m 1} R_{1} G_{m 2} R_{2}\right)$, results in a unity-gain frequency $\omega_{t}$ lower than $\omega_{Z}$ and $\omega_{P 2}$. Specifically

$$
\omega_{t}=\left(G_{m 1} R_{1} G_{m 2} R_{2}\right) \omega_{P 1}=\frac{G_{m 1}}{C_{C}}
$$

which must be lower than $\omega_{Z}=\frac{G_{m 2}}{C_{C}}$ and $\omega_{P 2} \simeq \frac{G_{m 2}}{C_{2}}$. Thus, the design must satisfy the following two conditions:

$$
\begin{aligned}
\frac{G_{m 1}}{C_{C}} & <\frac{G_{m 2}}{C_{2}} \\
G_{m 1} & <G_{m 2}
\end{aligned}
$$

# EXERCISE 

D13.4 Consider the frequency response of the op amp analyzed in Chapter 9 (see Example 9.6). Let $C_{1}=0.1 \mathrm{pF}$ and $C_{2}=2 \mathrm{pF}$. Find the value of $C_{C}$ that results in $f_{t}=10 \mathrm{MHz}$ and verify that $f_{t}$ is lower than $f_{Z}$ and $f_{P 2}$. Recall from the results of Example 9.6 that $G_{m 1}=0.3 \mathrm{~mA} / \mathrm{V}$ and $G_{m 2}=0.6 \mathrm{~mA} / \mathrm{V}$. Ans. $C_{C}=4.8 \mathrm{pF} ; f_{Z}=20 \mathrm{MHz} ; f_{P 2}=48 \mathrm{MHz}$

Simplified Equivalent Circuit The uniform $-20-\mathrm{dB} /$ decade gain rolloff obtained at frequencies $f \gg f_{P 1}$ but lower than $f_{P 2}$ and $f_{Z}$ suggests that at these frequencies, the op amp can be represented by the simplified equivalent circuit shown in Fig. 13.3. Observe that this attractive simplification is based on the assumption that the gain of the second stage, $\left|A_{2}\right|$, is large, and hence a virtual ground appears at the input terminal of the second stage. The second stage then effectively acts as an integrator that is fed with the output current signal of the first stage; $G_{m 1} V_{i d}$. Although derived for the CMOS amplifier, this simplified equivalent circuit is general and applies to a variety of two-stage op amps, including the first two stages of the 741-type bipolar op amp studied later in this chapter.


Figure 13.3 An approximate high-frequency equivalent circuit of the two-stage op amp. This circuit applies for frequencies $f \gg f_{P 1}$ but lower than $f_{P 2}$ and $f_{Z}$.


Figure 13.4 Typical frequency response of the two-stage op amp.

Phase Margin The frequency compensation scheme utilized in the two-stage CMOS amplifier is of the pole-splitting type, studied in Section 11.10.3: It provides a dominant low-frequency pole with frequency $f_{P 1}$ and shifts the second pole beyond $f_{t}$. Figure 13.4 shows a representative Bode plot for the gain magnitude and phase. Note that at the unity-gain frequency $f_{t}$, the phase lag exceeds the $90^{\circ}$ caused by the dominant pole at $f_{P 1}$. This so-called excess phase shift is due to the second pole,

$$
\phi_{P 2}=-\tan ^{-1}\left(\frac{f_{t}}{f_{P 2}}\right)
$$

and the right-half-plane zero,

$$
\phi_{Z}=-\tan ^{-1}\left(\frac{f_{t}}{f_{Z}}\right)
$$

Thus the phase lag at $f=f_{t}$ will be

$$
\phi_{\text {total }}=90^{\circ}+\tan ^{-1}\left(f_{t} / f_{P 2}\right)+\tan ^{-1}\left(f_{t} / f_{Z}\right)
$$

and thus the phase margin will be

$$
\begin{aligned}
\text { Phase margin } & =180^{\circ}-\phi_{\text {total }} \\
& =90^{\circ}-\tan ^{-1}\left(f_{t} / f_{P 2}\right)-\tan ^{-1}\left(f_{t} / f_{Z}\right)
\end{aligned}
$$


Figure 13.5 Small-signal equivalent circuit of the op amp in Fig. 13.1 with a resistance $R$ included in series with $C_{C}$.

From our study of the stability of feedback amplifiers in Section 11.9.2, we know that the magnitude of the phase margin significantly affects the closed-loop gain. ${ }^{2}$ Therefore, obtaining a desired minimum value of phase margin is usually a design requirement.

The problem of the additional phase lag provided by the right-half-plane zero has a rather simple and elegant solution: By including a resistance $R$ in series with $C_{C}$, as shown in Fig. 13.5, the transmission zero can be moved to other less harmful locations. To find the new location of the transmission zero, set $V_{o}=0$. Then, the current through $C_{C}$ and $R$ will be $V_{i 2} /\left(R+1 / s C_{C}\right)$, and a node equation at the output yields

$$
\frac{V_{i 2}}{R+\frac{1}{s C_{C}}}=G_{m 2} V_{i 2}
$$

Thus the zero is now at

$$
s=1 / C_{C}\left(\frac{1}{G_{m 2}}-R\right)
$$

We observe that by selecting $R=1 / G_{m 2}$, we can place the zero at infinite frequency. An even better choice would be to select $R$ greater than $1 / G_{m 2}$, thus placing the zero at a negative real-axis location where the phase it introduces becomes a phase lead and thus adds to the phase margin.

# EXERCISE 

13.5 A particular implementation of the CMOS amplifier of Figs. 13.1 and 13.2 provides $G_{m 1}=1 \mathrm{~mA} / \mathrm{V}$, $G_{m 2}=2 \mathrm{~mA} / \mathrm{V}, r_{o 2}=r_{o 4}=100 \mathrm{k} \Omega, r_{o 6}=r_{o 7}=40 \mathrm{k} \Omega$, and $C_{2}=1 \mathrm{pF}$.
(a) Find the value of $C_{C}$ that results in $f_{t}=100 \mathrm{MHz}$. What is the $3-\mathrm{dB}$ frequency of the open-loop gain?
(b) Find the value of the resistance $R$ that when placed in series with $C_{C}$ causes the transmission zero to be located at infinite frequency.
(c) Find the frequency of the second pole and hence find the excess phase lag at $f=f_{t}$, introduced by the second pole, and the resulting phase margin assuming that the situation in (b) pertains.
Ans. $1.6 \mathrm{pF} ; 50 \mathrm{kHz} ; 500 \Omega ; 318 \mathrm{MHz} ; 17.4^{\circ} ; 72.6^{\circ}$

[^0]
[^0]:    ${ }^{2}$ The magnitude of the phase margin also affects the step response of the closed-loop amplifier.
# 13.1.6 Slew Rate 

The slew-rate limitation of op amps is discussed in Chapter 2. Here, we shall illustrate the origin of the slewing phenomenon in the context of the two-stage CMOS amplifier under study.

Consider the unity-gain follower of Fig. 13.6 with a step of, say, 1 V applied at the input. Because of the amplifier dynamics, its output will not change in zero time. Thus, immediately after the input is applied, the entire value of the step will appear as a differential signal between the two input terminals. In all likelihood, such a large signal will exceed the voltage required to turn off one side of the input differential pair $\left(\sqrt{2} V_{O V 1}\right.$ : see earlier illustration in Chapter 9, Fig. 9.6) and switch the entire bias current $I$ to the other side. Reference to Fig. 13.1 shows that for our example, $Q_{2}$ will turn off, and $Q_{1}$ will conduct the entire current $I$. Thus $Q_{4}$ will sink a current $I$ that will be pulled from $C_{C}$, as shown in Fig. 13.7. Here, as we did in Fig. 13.3, we are modeling the second stage as an ideal integrator. We see that the output voltage will be a ramp with a slope of $I / C_{C}$ :

$$
v_{O}(t)=\frac{I}{C_{C}} t
$$

Thus the slew rate, $S R$, is given by

$$
S R=\frac{I}{C_{C}}
$$

It should be pointed out, however, that this is a rather simplified model of the slewing process.
Relationship Between $S R$ and $f_{T}$ A simple relationship exists between the unity-gain bandwidth $f_{t}$ and the slew rate $S R$. This relationship can be found by combining Eqs. (13.36) and (13.45) and noting that $G_{m 1}=g_{m 1}=I / V_{O V 1}$, to obtain

$$
S R=2 \pi f_{t} V_{O V 1}
$$



Figure 13.6 A unity-gain follower with a large step input. Since the output voltage cannot change immediately, a large differential voltage appears between the op-amp input terminals.

Figure 13.7 Model of the two-stage CMOS op-amp of Fig. 13.1 when a large differential voltage is applied.
or equivalently,

$$
S R=V_{O V 1} \omega_{t}
$$

Thus, for a given $\omega_{t}$, the slew rate is determined by the overdrive voltage at which the first-stage transistors are operated. A higher slew rate is obtained by operating $Q_{1}$ and $Q_{2}$ at a larger $V_{O V}$. Now, for a given bias current $I$, a larger $V_{O V}$ is obtained if $Q_{1}$ and $Q_{2}$ are $p$-channel devices. This is an important reason for using $p$-channel rather than $n$-channel devices in the first stage of the CMOS op amp. Another reason is that it allows the second stage to employ an $n$-channel device. Now, since $n$-channel devices have greater transconductances than corresponding $p$-channel devices, $G_{m 2}$ will be high, resulting in a higher second-pole frequency and a correspondingly higher $\omega_{t}$. However, the price paid for these improvements is a lower $G_{m 1}$ and hence a lower dc gain.

# EXERCISE 

13.6 Find $S R$ for the CMOS op amp of Fig. 13.1 for the case $f_{t}=100 \mathrm{MHz}$ and $V_{O V 1}=0.2 \mathrm{~V}$. If $C_{C}=1.6 \mathrm{pF}$, what must the bias current $I$ be?
Ans. $126 \mathrm{~V} / \mu \mathrm{s} ; 200 \mu \mathrm{~A}$

### 13.1.7 Power-Supply Rejection Ratio (PSRR)

CMOS op amps are usually utilized in what are known as mixed-signal circuits: IC chips that combine analog and digital circuits. In such circuits, the switching activity in the digital portion usually results in increased ripple on the power supplies. A portion of the supply ripple can make its way to the op-amp output and thus corrupt the output signal. The traditional approach for reducing supply ripple by connecting large capacitances between the supply rails and ground is not viable in IC design, as such capacitances would consume most of the chip area. Instead, the analog IC designer has to pay attention to another op-amp specification that so far we have ignored, namely, the power-supply rejection ratio (PSRR).

The PSRR is defined as the ratio of the amplifier differential gain to the gain experienced by a change in the power-supply voltage ( $v_{d d}$ and $v_{s s}$ ). For circuits utilizing two power supplies, we define

$$
\operatorname{PSRR}^{+} \equiv \frac{A_{d}}{A^{+}}
$$

and

$$
\operatorname{PSRR}^{-}=\frac{A_{d}}{A^{-}}
$$

where

$$
\begin{aligned}
A^{+} & \equiv \frac{v_{o}}{v_{d d}} \\
A^{-} & =\frac{v_{o}}{v_{s s}}
\end{aligned}
$$
Obviously, to minimize the effect of the power-supply ripple, we require the op amp to have a large PSRR.

A detailed analysis of the PSRR of the two-stage CMOS op amp is beyond the scope of this book (see Gray et al., 2009). Nevertheless, we make the following brief remarks. It can be shown that the circuit is remarkably insensitive to variations in $V_{D D}$, and thus $\mathrm{PSRR}^{+}$is very high. This is not the case, however, for the negative-supply ripple $v_{s s}$, which is coupled to the output primarily through the second-stage transistors $Q_{6}$ and $Q_{7}$. In particular, the portion of $v_{s s}$ that appears at the op-amp output is determined by the voltage divider formed by the output resistances of $Q_{6}$ and $Q_{7}$,

$$
v_{o}=v_{s s} \frac{r_{o 7}}{r_{o 6}+r_{o 7}}
$$

Thus,

$$
A^{-} \equiv \frac{v_{o}}{v_{s s}}=\frac{r_{o 7}}{r_{o 6}+r_{o 7}}
$$

Now utilizing $A_{d}$ from Eq. (13.22) gives

$$
\mathrm{PSRR}^{-} \equiv \frac{A_{d}}{A^{-}}=g_{m 1}\left(r_{o 2} \| r_{o 4}\right) g_{m 6} r_{o 6}
$$

Thus, $\mathrm{PSRR}^{-}$is of the form $\left(g_{m} r_{o}\right)^{2}$ and therefore is maximized by selecting long channels $L$ (to increase $\left|V_{A}\right|$ ), and operating at low $\left|V_{O V}\right|$.

# 13.1.8 Design Trade-Offs 

The performance parameters of the two-stage CMOS amplifier are primarily determined by two design parameters:

1. The length $L$ used for the channel of each MOSFET.
2. The overdrive voltage $\left|V_{O V}\right|$ at which each transistor is operated.

Throughout this section, we have found that a larger $L$ and correspondingly larger $\left|V_{A}\right|$ increases the amplifier gain, CMRR and PSRR. We also found that operating at a lower $\left|V_{O V}\right|$ increases these three parameters as well as increasing the input common-mode range and the allowable range of output swing. Also, although we have not analyzed the offset voltage of the op amp here, we know from our study of the subject in Section 9.4.1 that a number of the components of the input offset voltage that arises from random device mismatches are proportional to $\left|V_{O V}\right|$ at which the MOSFETs of the input differential pair are operated. Thus the offset is minimized by operating at a lower $\left|V_{O V}\right|$.

There is, however, an important MOSFET performance parameter that requires the selection of a larger $\left|V_{O V}\right|$, namely, the transition frequency $f_{T}$, which determines the high-frequency performance of the MOSFET (see Section 10.2.1),

$$
f_{T}=\frac{g_{m}}{2 \pi\left(C_{g s}+C_{g d}\right)}
$$
For an $n$-channel MOSFET, it can be shown that ${ }^{3}$

$$
f_{T} \simeq \frac{1.5 \mu_{n} V_{O V}}{2 \pi L^{2}}
$$

A similar relationship applies for the PMOS transistor, with $\mu_{p}$ and $\left|V_{O V}\right|$ replacing $\mu_{n}$ and $V_{O V}$, respectively. Thus to increase $f_{T}$ and improve the high-frequency response of the op amp, we need to use a larger overdrive value and, not surprisingly, shorter channels. A larger $\left|V_{O V}\right|$ also results in a higher op-amp slew rate $S R$ (Eq. 13.46). Finally, note that the selection of a larger $\left|V_{O V}\right|$ results, for the same bias current, and thus the same power dissipation, in a smaller $W / L$, which combined with a short $L$ leads to smaller devices and hence lower values of MOSFET capacitances and higher frequencies of operation.

In conclusion, the selection of $\left|V_{O V}\right|$ presents the designer with a trade-off between improving the low-frequency performance parameters on the one hand and the high-frequency performance on the other. For modern submicron technologies, which require operation from power supplies of 1 V to 1.5 V , overdrive voltages between 0.1 V and 0.3 V are typically utilized. For these process technologies, analog designers typically use channel lengths that are at least 1.5 to 2 times the specified value of $L_{\min }$, and even longer channels are used for current-source bias transistors.

# 13.1.9 A Bias Circuit for the Two-Stage CMOS Op Amp 

We now present a circuit for generating the bias current $I_{\text {REF }}$ of the two-stage CMOS op amp of Fig. 13.1. As will be seen, the value of the bias current generated is independent of both the supply voltage and the threshold voltage of the MOSFETs. As well, the transconductance of each MOSFET biased by this circuit (i.e., by a multiple of $I_{\text {REF }}$ ) has a value determined by only a single resistor and the device dimensions.

The bias circuit is shown in Fig. 13.8. It consists of two deliberately mismatched transistors, $Q_{12}$ and $Q_{13}$, with $Q_{12}$ usually about four times wider than $Q_{13}$. A resistor $R_{B}$ is connected in series with the source of $Q_{12}$. Since, as will be shown, $R_{B}$ determines both


Figure 13.8 Bias circuit for the CMOS op amp. Note that $Q_{8}$ is the same $Q_{8}$ in the circuit of Fig. 13.1.

[^0]
[^0]:    ${ }^{3}$ See Appendix G on the companion website.
the bias current $I_{\mathrm{REF}}$ and the transconductance $g_{m 12}$, its value should be accurate and stable; in most applications, $R_{B}$ would be an off-chip resistor. In order to minimize the channel-length modulation effect on $Q_{12}$, we include a cascode transistor $Q_{10}$ and a matched diode-connected transistor $Q_{11}$ to provide a bias voltage for $Q_{10}$. Finally, a $p$-channel current mirror formed by a pair of matched devices, $Q_{8}$ and $Q_{9}$, both replicates the current $I_{B}$ back to $Q_{11}$ and $Q_{13}$ and provides a bias line for $Q_{5}$ and $Q_{7}$ of the CMOS op-amp circuit of Fig. 13.11.

The circuit operates as follows: The current mirror $\left(Q_{8}, Q_{9}\right)$ causes $Q_{13}$ to conduct a current equal to that in $Q_{12}$, that is, $I_{\mathrm{REF}}$. Thus,

$$
I_{\mathrm{REF}}=\frac{1}{2} \mu_{n} C_{o s}\left(\frac{W}{L}\right)_{12}\left(V_{G S 12}-V_{t}\right)^{2}
$$

and,

$$
I_{\mathrm{REF}}=\frac{1}{2} \mu_{n} C_{o s}\left(\frac{W}{L}\right)_{13}\left(V_{G S 13}-V_{t}\right)^{2}
$$

From the circuit, we see that the gate-source voltages of $Q_{12}$ and $Q_{13}$ are related by

$$
V_{G S 13}=V_{G S 12}+I_{\mathrm{REF}} R_{B}
$$

Subtracting $V_{t}$ from both sides of this equation and using Eqs. (13.57) and (13.58) to replace $\left(V_{G S 12}-V_{t}\right)$ and $\left(V_{G S 13}-V_{t}\right)$ results in

$$
\sqrt{\frac{2 I_{\mathrm{REF}}}{\mu_{n} C_{o s}(W / L)_{13}}}=\sqrt{\frac{2 I_{\mathrm{REF}}}{\mu_{n} C_{o s}(W / L)_{12}}}+I_{\mathrm{REF}} R_{B}
$$

This equation can be rearranged to yield

$$
I_{\mathrm{REF}}=\frac{2}{\mu_{n} C_{o s}(W / L)_{12} R_{B}^{2}}\left(\sqrt{\frac{(W / L)_{12}}{(W / L)_{13}}}-1\right)^{2}
$$

from which we observe that $I_{\mathrm{REF}}$ is determined by the dimensions of $Q_{12}$ and the value of $R_{B}$ and by the ratio of the dimensions of $Q_{12}$ and $Q_{13}$. Furthermore, Eq. (13.60) can be rearranged to the form

$$
R_{B}=\frac{2}{\sqrt{2 \mu_{n} C_{o s}(W / L)_{12} I_{\mathrm{REF}}}}\left(\sqrt{\frac{(W / L)_{12}}{(W / L)_{13}}}-1\right)
$$

in which we recognize the factor $\sqrt{\mu_{n} C_{o s}(W / L)_{12} I_{\mathrm{REF}}}$ as $g_{m 12}$; thus,

$$
g_{m 12}=\frac{2}{R_{B}}\left(\sqrt{\frac{(W / L)_{12}}{(W / L)_{13}}}-1\right)
$$

This is a very interesting result: $g_{m 12}$ is determined solely by the value of $R_{B}$ and the ratio of the dimensions of $Q_{12}$ and $Q_{13}$. Furthermore, since $g_{m}$ of a MOSFET is proportional to $\sqrt{I_{D}(W / L)}$, each transistor biased by the circuit of Fig. 13.8; that is, each transistor whose bias current is derived from $I_{\mathrm{REF}}$ will have a $g_{m}$ value that is a multiple of $g_{m 12}$. Specifically, the $i$ th $n$-channel MOSFET will have

$$
g_{m i}=g_{m 12} \sqrt{\frac{I_{D i}(W / L)_{i}}{I_{\mathrm{REF}}(W / L)_{12}}}
$$and the $i$ th $p$-channel device will have

$$
g_{m i}=g_{m 12} \sqrt{\frac{\mu_{p} I_{D i}(W / L)_{i}}{\mu_{n} I_{\mathrm{REF}}(W / L)_{12}}}
$$

Finally, it should be noted that the bias circuit of Fig. 13.8 employs positive feedback, and thus care should be exercised in its design to avoid unstable performance. Instability is avoided by making $Q_{12}$ wider than $Q_{13}$, as has already been pointed out. Nevertheless, some form of instability may still occur; in fact, the circuit can operate in a stable state in which all currents are zero. To get it out of this state, current needs to be injected into one of its nodes, to "kick start" its operation. Feedback and stability are studied in Chapter 11.

# EXERCISES 

13.7 Consider the bias circuit of Fig. 13.8 for the case of $(W / L)_{8}=(W / L)_{9}=(W / L)_{10}=(W / L)_{11}=$ $(W / L)_{13}=20$ and $(W / L)_{12}=80$. The circuit is fabricated in a process technology for which $\mu_{n} C_{e x}=90 \mu \mathrm{~A} / \mathrm{V}^{2}$. Find the value of $R_{B}$ that results in a bias current $I_{\mathrm{REF}}=10 \mu \mathrm{~A}$. Also, find the transconductance $g_{m 12}$.
Ans. $5.27 \mathrm{k} \Omega ; 0.379 \mathrm{~mA} / \mathrm{V}$
D13.8 Design the bias circuit of Fig. 13.8 to operate with the CMOS op amp of Example 9.6. Use $Q_{8}$ and $Q_{9}$ as identical devices with $Q_{8}$ having the dimensions given in Example 9.6. Transistors $Q_{10}, Q_{11}$, and $Q_{13}$ are to be identical, with the same $g_{m}$ as $Q_{8}$ and $Q_{9}$. Transistor $Q_{12}$ is to be four times as wide as $Q_{13}$. Find the required value of $R_{B}$. What is the voltage drop across $R_{B}$ ? Also give the values of the dc voltages at the gates of $Q_{12}, Q_{10}$, and $Q_{8}$.
Ans. $1.67 \mathrm{k} \Omega ; 150 \mathrm{mV} ;-1.5 \mathrm{~V} ;-0.5 \mathrm{~V} ;+1.4 \mathrm{~V}$

## Example 13.1

We conclude our study of the two-stage CMOS op amp with a design example. Let it be required to design the circuit to obtain a dc gain of $4000 \mathrm{~V} / \mathrm{V}$. Assume that the available fabrication technology is of the $0.5-\mu \mathrm{m}$ type for which $V_{t n}=\left|V_{t p}\right|=0.5 \mathrm{~V}, k_{n}^{\prime}=200 \mu \mathrm{~A} / \mathrm{V}^{2}, k_{p}^{\prime}=80 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{A n}^{\prime}=\left|V_{A p}^{\prime}\right|=20 \mathrm{~V} / \mu \mathrm{m}$, and $V_{D D}=V_{S S}=1.65 \mathrm{~V}$. To achieve a reasonable dc gain per stage, use $L=1 \mu \mathrm{~m}$ for all devices. Also, for simplicity, operate all devices at the same $\left|V_{D V}\right|$, in the range of 0.2 V to 0.4 V . Use $I=200 \mu \mathrm{~A}$, and to obtain a higher $G_{m 2}$, and hence a higher $f_{P 2}$, use $I_{D 6}=0.5 \mathrm{~mA}$. Specify the $W / L$ ratios for all transistors. Also give the values realized for the input common-mode range, the maximum possible output swing, $R_{i n}$ and $R_{o}$. Also determine the CMRR and PSRR realized. If $C_{1}=0.2 \mathrm{pF}$ and $C_{2}=0.8 \mathrm{pF}$, find the required values of $C_{C}$ and the series resistance $R$ to place the transmission zero at $s=\infty$ and to obtain the highest possible $f_{t}$ consistent with a phase margin of $85^{\circ}$. Evaluate the values obtained for $f_{t}$ and $S R$.
# Solution 

Using the voltage-gain expression in Eq. (13.22),

$$
\begin{aligned}
A_{v} & =g_{m 1}\left(r_{o 2} \| r_{o 4}\right) g_{m 6}\left(r_{o 6} \| r_{o 7}\right) \\
& =\frac{2(I / 2)}{V_{O V}} \times \frac{1}{2} \times \frac{V_{4}}{(I / 2)} \times \frac{2 I_{D 6}}{V_{O V}} \times \frac{1}{2} \times \frac{V_{4}}{I_{D 6}} \\
& =\left(\frac{V_{4}}{V_{O V}}\right)^{2}
\end{aligned}
$$

To obtain $A_{v}=4000$, given $V_{4}=20 \mathrm{~V}$,

$$
\begin{aligned}
4000 & =\frac{400}{V_{O V}^{2}} \\
V_{O V} & =0.316 \mathrm{~V}
\end{aligned}
$$

To obtain the required $(W / L)$ ratios of $Q_{1}$ and $Q_{2}$,

$$
\begin{aligned}
I_{D 1} & =\frac{1}{2} k_{p}\left(\frac{W}{L}\right)_{1} V_{O V}^{2} \\
100 & =\frac{1}{2} \times 80\left(\frac{W}{L}\right)_{1} \times 0.316^{2}
\end{aligned}
$$

Thus,

$$
\left(\frac{W}{L}\right)_{1}=\frac{25 \mu \mathrm{~m}}{1 \mu \mathrm{~m}}
$$

and

$$
\left(\frac{W}{L}\right)_{2}=\frac{25 \mu \mathrm{~m}}{1 \mu \mathrm{~m}}
$$

For $Q_{3}$ and $Q_{4}$ we write

$$
100=\frac{1}{2} \times 200\left(\frac{W}{L}\right)_{3} \times 0.316^{2}
$$

to obtain

$$
\left(\frac{W}{L}\right)_{3}=\left(\frac{W}{L}\right)_{4}=\frac{10 \mu \mathrm{~m}}{1 \mu \mathrm{~m}}
$$

For $Q_{5}$,

$$
200=\frac{1}{2} \times 80\left(\frac{W}{L}\right)_{5} \times 0.316^{2}
$$
# Example 13.1 continued 

Thus,

$$
\left(\frac{W}{L}\right)_{5}=\frac{50 \mu \mathrm{~m}}{1 \mu \mathrm{~m}}
$$

Since $Q_{7}$ is required to conduct $500 \mu \mathrm{~A}$, its $(W / L)$ ratio should be 2.5 times that of $Q_{5}$,

$$
\left(\frac{W}{L}\right)_{7}=2.5\left(\frac{W}{L}\right)_{5}=\frac{125 \mu \mathrm{~m}}{1 \mu \mathrm{~m}}
$$

For $Q_{6}$ we write

$$
500=\frac{1}{2} \times 200 \times\left(\frac{W}{L}\right)_{6} \times 0.316^{2}
$$

Thus,

$$
\left(\frac{W}{L}\right)_{6}=\frac{50 \mu \mathrm{~m}}{1 \mu \mathrm{~m}}
$$

At this point we should check that condition (13.1) is satisfied, which is indeed the case, ensuring that there will be no systematic output offset voltage.

Finally, let's select $I_{\text {REF }}=20 \mu \mathrm{~A}$, thus

$$
\left(\frac{W}{L}\right)_{8}=0.1\left(\frac{W}{L}\right)_{5}=\frac{5 \mu \mathrm{~m}}{1 \mu \mathrm{~m}}
$$

The input common-mode range can be found using the expression in Eq. (13.4) as

$$
-1.33 \mathrm{~V} \leq V_{I C M} \leq 0.52 \mathrm{~V}
$$

The maximum signal swing allowable at the output is found using the expression in Eq. (13.5) as

$$
-1.33 \mathrm{~V} \leq v_{O} \leq 1.33 \mathrm{~V}
$$

The input resistance is practically infinite, and the output resistance is

$$
R_{o}=r_{o 6} \| r_{o 7}=\frac{1}{2} \times \frac{20}{0.5}=20 \mathrm{k} \Omega
$$

The CMRR is determined using Eq. (13.24),

$$
\mathrm{CMRR}=g_{m 1}\left(r_{o 2} \| r_{o 4}\right)\left(2 g_{m 3} R_{S S}\right)
$$

where $R_{S S}=r_{o 5}=V_{A} / I$. Thus,

$$
\begin{aligned}
\mathrm{CMRR} & =\frac{2(I / 2)}{V_{O V}} \times \frac{1}{2} \times \frac{V_{A}}{(I / 2)} \times 2 \times \frac{2(I / 2)}{V_{O V}} \times \frac{V_{A}}{I} \\
& =2\left(\frac{V_{A}}{V_{O V}}\right)^{2}=2\left(\frac{20}{0.316}\right)^{2}=8000
\end{aligned}
$$
Expressed in decibels, we have

$$
\mathrm{CMRR}=20 \log 8000=78 \mathrm{~dB}
$$

The PSRR is determined using Eq. (13.53):

$$
\begin{aligned}
\mathrm{PSRR} & =g_{m 1}\left(r_{o 2} \| r_{o 4}\right) g_{m 6} r_{o 6} \\
& =\frac{2(I / 2)}{V_{O V}} \times \frac{1}{2} \times \frac{V_{A}}{(I / 2)} \times \frac{2 I_{D 6}}{V_{O V}} \times \frac{V_{A}}{I_{D 6}} \\
& =2\left(\frac{V_{A}}{V_{O V}}\right)^{2}=2\left(\frac{20}{0.316}\right)^{2}=8000
\end{aligned}
$$

or, expressed in decibels,

$$
\mathrm{PSRR}=20 \log 8000=78 \mathrm{~dB}
$$

To determine $f_{P 2}$ we use Eq. (13.35) and substitute for $G_{m 2}$,

$$
G_{m 2}=g_{m 6}=\frac{2 I_{D 6}}{V_{O V}}=\frac{2 \times 0.5}{0.316}=3.2 \mathrm{~mA} / \mathrm{V}
$$

Thus,

$$
f_{P 2}=\frac{3.2 \times 10^{-3}}{2 \pi \times 0.8 \times 10^{-12}}=637 \mathrm{MHz}
$$

To move the transmission zero to $s=\infty$, we select the value of $R$ as

$$
R=\frac{1}{G_{m 2}}=\frac{1}{3.2 \times 10^{-3}}=316 \Omega
$$

For a phase margin of $85^{\circ}$, the phase shift due to the second pole at $f=f_{t}$ must be $5^{\circ}$, that is,

$$
\tan ^{-1} \frac{f_{t}}{f_{P 2}}=5^{\circ}
$$

Thus,

$$
f_{t}=637 \times \tan 5^{\circ}=55.7 \mathrm{MHz}
$$

The value of $C_{C}$ can be found using Eq. (13.36),

$$
C_{C}=\frac{G_{m 1}}{2 \pi f_{t}}
$$
Example 13.1 continued
where

$$
G_{m 1}=g_{m 1}=\frac{2 \times 100 \mu \mathrm{~A}}{0.316 \mathrm{~V}}=0.63 \mathrm{~mA} / \mathrm{V}
$$

Thus,

$$
C_{C 1}=\frac{0.63 \times 10^{-3}}{2 \pi \times 55.7 \times 10^{6}}=1.8 \mathrm{pF}
$$

The value of $S R$ can now be found using Eq. (13.46) as

$$
\begin{aligned}
S R & =2 \pi \times 55.7 \times 10^{6} \times 0.316 \\
& =111 \mathrm{~V} / \mu \mathrm{s}
\end{aligned}
$$

# 13.2 The Folded-Cascode CMOS Op Amp 

In this section we study another type of CMOS op-amp circuit: the folded cascode. The circuit is based on the folded-cascode amplifier studied in Section 8.5.5. There, it was mentioned that although composed of a CS transistor and a CG transistor of opposite polarity, the folded-cascode configuration is generally considered to be a single-stage amplifier. Similarly, the op-amp circuit that is based on the cascode configuration is considered to be a single-stage op amp. Nevertheless, it can be designed to provide performance parameters that equal and in some respects exceed those of the two-stage topology studied in the preceding section. Indeed, the folded-cascode op-amp topology is currently as popular as the two-stage structure.

### 13.2.1 The Circuit

Figure 13.9 shows the structure of the CMOS folded-cascode op amp. Here, $Q_{1}$ and $Q_{2}$ form the input differential pair, and $Q_{3}$ and $Q_{4}$ are the cascode transistors. Recall that for differential input signals, each of $Q_{1}$ and $Q_{2}$ acts as a common-source amplifier. Also note that the gate terminals of $Q_{3}$ and $Q_{4}$ are connected to a constant dc voltage ( $V_{\text {BIAS1 }}$ ) and hence are at signal ground. Thus, for differential input signals, each of the transistor pairs $Q_{1}-Q_{3}$ and $Q_{2}-Q_{4}$ acts as a folded-cascode amplifier, such as the one in Fig. 8.36. Note that the input differential pair is biased by a constant-current source $I$. Thus each of $Q_{1}$ and $Q_{2}$ is operating at a bias current $I / 2$. A node equation at each of their drains shows that the bias current of each of $Q_{3}$ and $Q_{4}$ is $\left(I_{B}-I / 2\right)$. As will be seen shortly, both the dc gain and the unity-gain frequency are proportional to $g_{m}$ of each of $Q_{1}$ and $Q_{2}$. Thus, the bias current $I$ is usually made large to obtain a high value for $g_{m 1,2}$. For a given power dissipation and thus a given total current $2 I_{B}$, the current that biases each of $Q_{3}$ and $Q_{4}\left(I_{B}-\frac{I}{2}\right)$ will of necessity be small. It turns out, however, that this is advantageous, as it results in a large $r_{o}$ for $Q_{4}$ and thus a large output resistance and a correspondingly large dc gain for the op amp. As a rule of thumb, the ratio of $I_{D 1,2}$ to $I_{D 3,4}$ can be selected as large as 4 .


Figure 13.9 Structure of the folded-cascode CMOS op amp.

# EXERCISE 

13.9 To limit the power dissipation in the op-amp circuit of Fig. 13.9 to an acceptable level, the total dc current is limited to 0.3 mA . If it is desired to bias each of $Q_{1}$ and $Q_{2}$ at a dc current four times the bias current of each of $Q_{3}$ and $Q_{4}$, find the values of $I_{B}, I, I_{D 1,2}$, and $I_{D 3,4}$. Ans. $150 \mu \mathrm{~A} ; 240 \mu \mathrm{~A} ; 120 \mu \mathrm{~A} ; 30 \mu \mathrm{~A}$

As we learned in Chapter 8, if the full advantage of the high output resistance achieved through cascoding is to be realized, the output resistance of the current-source load must be equally high. This is the reason for using the cascode current mirror $Q_{5}$ to $Q_{8}$ in the circuit of Fig. 13.9. (This current-mirror circuit was studied in Section 8.6.1.) Finally, note that capacitance $C_{L}$ denotes the total capacitance at the output node. It includes the internal transistor capacitances, an actual load capacitance (if any), and possibly an additional capacitance deliberately introduced for the purpose of frequency compensation. In many cases, however, the load capacitance will be sufficiently large, obviating the need to provide additional capacitance to achieve the desired frequency compensation. This topic will be discussed shortly. For the time being, we note that unlike the two-stage circuit, which requires


Figure 13.10 A more complete circuit for the folded-cascode CMOS amplifier of Fig. 13.9.
the introduction of a separate compensation capacitor $C_{C}$, here the load capacitance contributes to frequency compensation.

A more complete circuit for the CMOS folded-cascode op amp is shown in Fig. 13.10. Here we show the two transistors $Q_{9}$ and $Q_{10}$, which provide the constant bias currents $I_{B}$, and transistor $Q_{11}$, which provides the constant current $I$ utilized for biasing the differential pair. Observe that the details for generating the bias voltages $V_{\text {BIAS1 }}, V_{\text {BIAS2 }}$, and $V_{\text {BIAS3 }}$ are not shown. Nevertheless, we are interested in how the values of these voltages are to be selected. Toward that end, we evaluate the input common-mode range and the allowable output swing.

# 13.2.2 Input Common-Mode Range and Output Swing 

To find the input common-mode range, let the two input terminals be tied together and connected to a voltage $V_{I C M}$. The maximum value of $V_{I C M}$ is limited by the requirement that $Q_{1}$ and $Q_{2}$ operate in saturation at all times. Thus $V_{I C M \max }$ should be at most $V_{m}$ volts above the voltage at the drains of $Q_{1}$ and $Q_{2}$. The latter voltage is determined by $V_{\text {BIAS1 }}$ and must allow for a voltage drop across $Q_{9}$ and $Q_{10}$ at least equal to their overdrive voltage, $\left|V_{O V 9}\right|=\left|V_{O V 10}\right|$. Assuming that $Q_{9}$ and $Q_{10}$ are indeed operated at the edge of saturation, $V_{I C M \max }$ will be

$$
V_{I C M \max }=V_{D D}-\left|V_{O V 9}\right|+V_{m}
$$

which can be larger than $V_{D D}$, a significant improvement over the case of the two-stage circuit. The value of $V_{\text {BIAS2 }}$ should be selected to yield the required value of $I_{B}$ while operating $Q_{9}$ and $Q_{10}$ at a small value of $\left|V_{O V}\right|$ (e.g., 0.2 V or so). The minimum value of $V_{I C M}$ is limited by the need to keep $Q_{11}$ operating in saturation at all times, which is assured by keeping the voltage
across it no smaller than $V_{O V 11}$ at all times. Thus

$$
V_{I C M \min }=-V_{S S}+V_{O V 11}+V_{O V 1}+V_{t n}
$$

The presence of the threshold voltage $V_{t n}$ in this expression indicates that $V_{I C M \text { min }}$ is not sufficiently low. Later in this section we shall describe an ingenious technique for solving this problem. For the time being, note that the value of $V_{\text {BIAS3 }}$ should be selected to provide the required value of $I$ while operating $Q_{11}$ at a low overdrive voltage. Combining Eqs. (13.64) and (13.65) provides

$$
-V_{S S}+V_{O V 11}+V_{O V 1}+V_{t n} \leq V_{I C M} \leq V_{D D}-\left|V_{O V 9}\right|+V_{t n}
$$

The upper end of the allowable range of $v_{O}$ is determined by the need to maintain $Q_{10}$ and $Q_{4}$ in saturation. Note that $Q_{10}$ will operate in saturation as long as an overdrive voltage, $\left|V_{O V 10}\right|$, appears across it. It follows that to maximize the allowable positive swing of $v_{O}$ (and also $V_{I C M \max }$ ), we should select the value of $V_{\text {BIAS1 }}$ so that $Q_{10}$ operates at the edge of saturation, that is,

$$
V_{\mathrm{BIAS} 1}=V_{D D}-\left|V_{O V 10}\right|-V_{S G 4}
$$

The upper limit of $v_{O}$ will then be

$$
v_{O \max }=V_{D D}-\left|V_{O V 10}\right|-\left|V_{O V 4}\right|
$$

which is two overdrive voltages below $V_{D D}$. The situation is not as good, however, at the other end: Since the voltage at the gate of $Q_{6}$ is $-V_{S S}+V_{G S 7}+V_{G S 5}$ or equivalently $-V_{S S}+V_{O V 7}$ $+V_{O V 5}+2 V_{t n}$, the lowest possible $v_{O}$ is obtained when $Q_{6}$ reaches the edge of saturation, namely, when $v_{O}$ decreases below the voltage at the gate of $Q_{6}$ by $V_{t n}$, that is,

$$
v_{O \min }=-V_{S S}+V_{O V 7}+V_{O V 5}+V_{t n}
$$

Note that this value is two overdrive voltages plus a threshold voltage above $-V_{S S}$. This is a drawback of utilizing the cascode mirror. The problem can be alleviated by using a modified mirror circuit, as we shall shortly see.

# EXERCISE 

13.10 For a particular design of the folded-cascode op amp of Fig. 13.10, $\pm 1.65-\mathrm{V}$ supplies are utilized and all transistors are operated at overdrive voltages of $0.3-\mathrm{V}$ magnitude. The fabrication process employed provides $V_{t n}=\left|V_{s c}\right|=0.5 \mathrm{~V}$. Find the input common-mode range and the range allowed for $v_{O}$.
Ans. -0.55 V to +1.85 V ; -0.55 V to +1.05 V
# 13.2.3 Voltage Gain 

The folded-cascode op amp is simply a transconductance amplifier with an infinite input resistance, a transconductance $G_{m}$, and an output resistance $R_{o}$. In addition, $G_{m}$ is equal to $g_{m}$ of each of the two transistors of the differential pair,

$$
G_{m}=g_{m 1}=g_{m 2}
$$

Thus,

$$
G_{m}=\frac{2(I / 2)}{V_{O V 1}}=\frac{I}{V_{O V 1}}
$$

The output resistance $R_{o}$ is the parallel equivalent of the output resistance of the cascode amplifier and the output resistance of the cascode mirror, thus

$$
R_{o}=R_{o 4} \| R_{o 6}
$$

Reference to Fig. 13.10 shows that the resistance $R_{o 4}$ is the output resistance of the CG transistor $Q_{4}$. The latter has a resistance $\left(r_{o 2} \| r_{o 10}\right)$ in its source lead, thus

$$
R_{o 4} \simeq\left(g_{m 4} r_{o 4}\right)\left(r_{o 2} \| r_{o 10}\right)
$$

The resistance $R_{o 6}$ is the output resistance of the cascode mirror and is thus given by Eq. (8.94), thus

$$
R_{o 6} \simeq g_{m 6} r_{o 6} r_{o 8}
$$

Combining Eqs. (13.72) to (13.74) gives

$$
R_{o}=\left[g_{m 4} r_{o 4}\left(r_{o 2} \| r_{o 10}\right)\right] \|\left(g_{m 6} r_{o 6} r_{o 8}\right)
$$

The dc open-loop gain can now be found using $G_{m}$ and $R_{o}$, as

$$
A_{v}=G_{m} R_{o}
$$

Thus,

$$
A_{v}=g_{m 1}\left\{\left[g_{m 4} r_{o 4}\left(r_{o 2} \| r_{o 10}\right)\right] \|\left(g_{m 6} r_{o 6} r_{o 8}\right)\right\}
$$

Figure 13.11 shows the equivalent-circuit model including the load capacitance $C_{L}$, which we shall take into account shortly.

Because the folded-cascode op amp is a transconductance amplifier, it has been given the name operational transconductance amplifier (OTA). Its very high output resistance, which is of the order of $g_{m} r_{o}^{2}$ (see Eq. 13.75) is what makes it possible to realize a relatively high voltage gain in a single amplifier stage. However, such a high output resistance may be


Figure 13.11 Small-signal equivalent circuit of the folded-cascode CMOS amplifier. Note that this circuit is in effect an operational transconductance amplifier (OTA).
a cause of concern to the reader; after all, in Chapter 2, we stated that an ideal op amp has a zero output resistance! To alleviate this concern somewhat, let us find the closed-loop output resistance of a unity-gain follower formed by connecting the output terminal of the circuit of Fig. 13.10 back to the negative input terminal. Since this feedback is of the voltage sampling type, it reduces the output resistance by the factor $(1+A \beta)$, where $A=A_{v}$ and $\beta=1$, that is,

$$
R_{o f}=\frac{R_{o}}{1+A_{v}} \simeq \frac{R_{o}}{A_{v}}
$$

Substituting for $A_{v}$ from Eq. (13.76) gives

$$
R_{o f} \simeq \frac{1}{G_{m}}
$$

which is a general result that applies to any OTA to which $100 \%$ voltage feedback is applied. For our particular circuit, $G_{m}=g_{m 1}$, thus

$$
R_{o f}=1 / g_{m 1}
$$

Since $g_{m 1}$ is of the order of $1 \mathrm{~mA} / \mathrm{V}, R_{o f}$ will be of the order of $1 \mathrm{k} \Omega$. Although this is not very small, it is reasonable in view of the simplicity of the op-amp circuit as well as the fact that this type of op amp is not usually intended to drive low-valued resistive loads.

# EXERCISE 

13.11 The CMOS op amp of Figs. 13.9 and 13.10 is fabricated in a process for which $V_{A o}^{\prime}=\left|V_{A p}^{\prime}\right|=$ $20 \mathrm{~V} / \mu \mathrm{m}$. If all devices have $1-\mu \mathrm{m}$ channel length and are operated at equal overdrive voltages of $0.2-\mathrm{V}$ magnitude, $I=240 \mu \mathrm{~A}$, and $I_{B}=150 \mu \mathrm{~A}$, find the voltage gain and the value of $R_{o}$ obtained. Ans. $16,000 \mathrm{~V} / \mathrm{V} ; 13.3 \mathrm{M} \Omega$

### 13.2.4 Frequency Response

From Section 10.5, we know that one of the advantages of the cascode configuration is its excellent high-frequency response. It has three poles: one at the input, one at the connection between the CS and CG transistors (i.e., at the source terminals of $Q_{3}$ and $Q_{4}$ ), and the third at the output terminal. Normally, the first two poles are at very high frequencies, especially when the resistance of the signal generator that feeds the differential pair is small. Since the primary purpose of CMOS op amps is to feed capacitive loads, $C_{L}$ is usually large, and the pole at the output becomes dominant. Even if $C_{L}$ is not large, we can increase it deliberately to give the op amp a dominant pole and thus an open-loop gain that decreases at the uniform rate of $-20 \mathrm{~dB} /$ decade down to the unity-gain frequency $f_{i}$, ensuring stable operation when feedback is applied. From Fig. 13.11 we can write

$$
\frac{V_{o}}{V_{o f}}=\frac{G_{m} R_{o}}{1+s C_{L} R_{o}}
$$

Thus, the dominant pole has a frequency $f_{P}$,

$$
f_{P}=\frac{1}{2 \pi C_{L} R_{o}}
$$and the unity-gain frequency $f_{i}$ will be

$$
f_{i}=G_{m} R_{o} f_{P}=\frac{G_{m}}{2 \pi C_{L}}
$$

From a design point of view, the value of $C_{L}$ should be such that at $f=f_{i}$ the excess phase resulting from the nondominant poles is small enough to permit the required phase margin to be achieved. If $C_{L}$ is not large enough to achieve this purpose, it can be augmented.

It is important to note the difference in the effect of increasing the load capacitance on the operation of each of the two op-amp circuits we have studied. In the two-stage circuit, if $C_{L}$ is increased, the frequency of the second pole decreases, the excess phase shift at $f=f_{i}$ increases, and the phase margin is reduced. Here, on the other hand, when $C_{L}$ is increased, $f_{i}$ decreases, but the phase margin increases. In other words, a heavier capacitive load decreases the bandwidth of the folded-cascode amplifier but does not impair its response (which happens when the phase margin decreases). Of course, if an increase in $C_{L}$ is anticipated in the two-stage op-amp case, the designer can increase $C_{C}$, thus decreasing $f_{i}$ and restoring the phase margin to its required value.

# 13.2.5 Slew Rate 

As discussed in Section 13.1.6, slewing occurs when a large differential signal appears at the op-amp input. Refer to Fig. 13.9 and consider the case when $V_{S I}$ is large and turns $Q_{2}$ off. Transistor $Q_{1}$ will then attempt to conduct the entire bias current $I$. This, however, would not be possible, since $I$ is usually larger than $I_{B}$. Consideration of the drain node of $Q_{1}$ indicates that for the node equation to be satisfied, not only must the current in $Q_{3}$ reduce to zero, but also the current of $Q_{1}$ must reduce to equal $I_{B}$. For this to happen, both $Q_{1}$ and the transistor supplying $I$ must enter the triode mode of operation, and the voltages at their drains must fall accordingly. Now, the zero current in $Q_{3}$ causes the input current of the mirror to be zero, and correspondingly its output current, in the drain of $Q_{6}$, will be zero. Meanwhile, the zero current in the drain of $Q_{2}$ forces the entire current $I_{B}$ to flow through $Q_{4}$ and into $C_{L}$. This causes the output voltage $v_{O}$ to ramp with a slope of $I_{B} / C_{L}$, which is the slew rate,

$$
S R=\frac{I_{B}}{C_{L}}
$$

After the slewing process is completed, before the amplifier can return to its normal linear operation, both $Q_{1}$ and the transistor that supplies the bias current $I$ must leave the triode mode and return to the saturation mode of operation. This, however, can take some time and may introduce additional distortion in the output signal. As usual, however, creative circuit design comes to the rescue! Problem 13.27 investigates an ingenious way to deal with this issue.

## Example 13.2

Consider a design of the folded-cascode op amp of Fig. 13.10 for which $I=240 \mu \mathrm{~A}, I_{B}=150 \mu \mathrm{~A}$, and $\left|V_{O V}\right|$ for all transistors is 0.25 V . Assume that the fabrication process provides $k_{n}=100 \mu \mathrm{~A} / \mathrm{V}^{2}, k_{p}=40$ $\mu \mathrm{A} / \mathrm{V}^{2},\left|V_{n}\right|=20 \mathrm{~V} / \mu \mathrm{m}, V_{D D}=V_{S S}=2.5 \mathrm{~V}$, and $\left|V_{i}\right|=0.75 \mathrm{~V}$. Let all transistors have $L=1 \mu \mathrm{~m}$ and assume that $C_{L}=5 \mathrm{pF}$. Find $I_{D}, g_{m}, r_{o}$, and $W / L$ for all transistors. Find the allowable range of $V_{I C M}$ and of
the output voltage swing. Determine the values of $A_{c}, f_{i}, f_{p}$, and $S R$. What is the power dissipation of the op amp?

# Solution 

From the given values of $I$ and $I_{B}$ we can determine the drain current $I_{D}$ for each transistor. The transconductance of each device is found using

$$
g_{m}=\frac{2 I_{D}}{V_{o v}}=\frac{2 I_{D}}{0.25}
$$

and the output resistance $r_{o}$ from

$$
r_{o}=\frac{\left|V_{A}\right|}{I_{D}}=\frac{20}{I_{D}}
$$

The $W / L$ ratio for each transistor is determined from

$$
\left(\frac{W}{L}\right)_{i}=\frac{2 I_{D i}}{k^{\prime} V_{O V}^{2}}
$$

The results are as follows:

|  | $\boldsymbol{Q}_{\mathbf{1}}$ | $\boldsymbol{Q}_{\mathbf{2}}$ | $\boldsymbol{Q}_{\mathbf{3}}$ | $\boldsymbol{Q}_{\mathbf{4}}$ | $\boldsymbol{Q}_{\mathbf{5}}$ | $\boldsymbol{Q}_{\mathbf{6}}$ | $\boldsymbol{Q}_{\mathbf{7}}$ | $\boldsymbol{Q}_{\mathbf{8}}$ | $\boldsymbol{Q}_{\mathbf{9}}$ | $\boldsymbol{Q}_{\mathbf{1 0}}$ | $\boldsymbol{Q}_{\mathbf{1 1}}$ |
| :-- | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| $I_{D}(\mu \mathrm{~A})$ | 120 | 120 | 30 | 30 | 30 | 30 | 30 | 30 | 150 | 150 | 240 |
| $g_{m}(\mathrm{~mA} / \mathrm{V})$ | 0.96 | 0.96 | 0.24 | 0.24 | 0.24 | 0.24 | 0.24 | 0.24 | 1.2 | 1.2 | 1.92 |
| $r_{o}(\mathrm{k} \Omega)$ | 167 | 167 | 667 | 667 | 667 | 667 | 667 | 667 | 133 | 133 | 83 |
| $W / L$ | 38.4 | 38.4 | 24 | 24 | 9.6 | 9.6 | 9.6 | 9.6 | 120 | 120 | 76.8 |

Note that for all transistors,

$$
\begin{aligned}
g_{m} r_{o} & =160 \mathrm{~V} / \mathrm{V} \\
V_{G S} & =1.0 \mathrm{~V}
\end{aligned}
$$

Using the expression in Eq. (13.66), the input common-mode range is found to be

$$
-1.25 \mathrm{~V} \leq V_{I C M} \leq 3 \mathrm{~V}
$$

The output voltage swing is found using Eqs. (13.68) and (13.69) to be

$$
-1.25 \mathrm{~V} \leq v_{O} \leq 2 \mathrm{~V}
$$
# Example 13.2 continued 

To obtain the voltage gain, we first determine $R_{o 4}$ using Eq. (13.73) as

$$
R_{o 4}=160(167 \| 133)=11.85 \mathrm{M} \Omega
$$

and $R_{o 6}$ using Eq. (13.74) as

$$
R_{o 6}=106.7 \mathrm{M} \Omega
$$

The output resistance $R_{o}$ can then be found as

$$
R_{o}=R_{o 4} \| R_{o 6}=10.7 \mathrm{M} \Omega
$$

and the voltage gain

$$
\begin{aligned}
A_{v} & =G_{m} R_{o}=0.96 \times 10^{-3} \times 10.7 \times 10^{6} \\
& =10,240 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

The unity-gain bandwidth is found using Eq. (13.83),

$$
f_{t}=\frac{0.96 \times 10^{-3}}{2 \pi \times 5 \times 10^{-12}}=30.6 \mathrm{MHz}
$$

Thus, the dominant-pole frequency must be

$$
f_{P}=\frac{f_{t}}{A_{v}}=\frac{30.6 \mathrm{MHz}}{10,240}=3 \mathrm{kHz}
$$

The slew rate can be determined using Eq. (13.84),

$$
S R=\frac{I_{B}}{C_{L}}=\frac{150 \times 10^{-6}}{5 \times 10^{-12}}=30 \mathrm{~V} / \mu \mathrm{s}
$$

Finally, to determine the power dissipation we note that the total current is $300 \mu \mathrm{~A}=0.3 \mathrm{~mA}$, and the total supply voltage is 5 V , thus

$$
P_{D}=5 \times 0.3=1.5 \mathrm{~mW}
$$

### 13.2.6 Increasing the Input Common-Mode Range: Rail-to-Rail Input Operation

In Section 13.2.2 we found that while the upper limit on the input common-mode range exceeds the supply voltage $V_{D D}$, the magnitude of the lower limit is significantly lower than $V_{S S}$. The opposite situation occurs if the input differential amplifier is made up of PMOS transistors. It follows that an NMOS and a PMOS differential pair placed in parallel would provide an input stage with a common-mode range that exceeds the power-supply voltage in both directions. This is known as rail-to-rail input operation. Figure 13.12 shows such an


Figure 13.12 A folded-cascode op amp that employs two parallel complementary input stages to achieve rail-to-rail input common-mode operation. Note that the two " + " terminals are connected together and the two "-" terminals are connected together.
arrangement. To keep the diagram simple, we have not shown the parallel connection of the two differential pairs: The two positive-input terminals are to be connected together and the two negative-input terminals are to be tied together. Transistors $Q_{5}$ and $Q_{6}$ are the cascode transistors for the $Q_{1}-Q_{2}$ pair, and transistors $Q_{7}$ and $Q_{8}$ are the cascode devices for the $Q_{3}-Q_{4}$ pair. The output voltage $V_{o}$ is shown taken differentially between the drains of the cascode devices. To obtain a single-ended output, a differential-to-single-ended conversion circuit should be connected in cascade.

Figure 13.12 indicates by arrows the direction of the current increments that result from the application of a positive differential input signal $V_{i d}$. Each of the current increments indicated is equal to $G_{m}\left(V_{i d} / 2\right)$ where $G_{m}=g_{m 1}=g_{m 2}=g_{m 3}=g_{m 4}$. Thus the total current feeding each of the two output nodes will be $G_{m} V_{i d}$. Now, if the output resistance between each of the two nodes and ground is denoted $R_{o}$, the output voltage will be

$$
V_{o}=2 G_{m} R_{o} V_{i d}
$$

Thus the voltage gain will be

$$
A_{v}=2 G_{m} R_{o}
$$

This, however, assumes that both differential pairs will be operating simultaneously. This in turn occurs only over a limited range of $V_{I C M}$. Over the remainder of the input common-mode range, only one of the two differential pairs will be operational, and the gain drops to half of the
value in Eq. (13.85). This rail-to-rail, folded-cascode structure is utilized in a commercially available op amp. ${ }^{4}$

# EXERCISE 

13.12 For the circuit in Fig. 13.12, assume that all transistors, including those that implement the current sources, are operating at equal overdrive voltages of $0.3-\mathrm{V}$ magnitude and have $\left|V_{i}\right|=0.7 \mathrm{~V}$ and that $V_{D O}=V_{S S}=2.5 \mathrm{~V}$.
(a) Find the range over which the NMOS input stage operates.
(b) Find the range over which the PMOS input stage operates.
(c) Find the range over which both operate (the overlap range).
(d) Find the input common-mode range.
(Note that to operate properly, each of the current sources requires a minimum voltage of $\left|V_{O V}\right|$ across its terminals.)
Ans. -1.2 V to $+2.9 \mathrm{~V} ;-2.9 \mathrm{~V}$ to $+1.2 \mathrm{~V},-1.2 \mathrm{~V}$ to $+1.2 \mathrm{~V} ;-2.9 \mathrm{~V}$ to +2.9 V

### 13.2.7 Increasing the Output Voltage Range: The Wide-Swing Current Mirror

In Section 13.2.2 it was found that while the output voltage of the circuit of Fig. 13.10 can swing to within $2\left|V_{O V}\right|$ of $V_{D D}$, the cascode current mirror limits the negative swing to $\left[2\left|V_{O V}\right|+V_{i}\right]$ above $-V_{S S}$. In other words, the cascode mirror reduces the voltage swing by $V_{i}$ volts. This point is further illustrated in Fig. 13.13(a), which shows a cascode mirror (with $V_{S S}=0$, for simplicity) and indicates the voltages that result at the various nodes. Observe that because the voltage at the gate of $Q_{3}$ is $2 V_{t}+2 V_{O V}$, the minimum voltage permitted at the output (while $Q_{3}$ remains saturated) is $V_{i}+2 V_{O V}$, hence the extra $V_{i}$. Also, observe that $Q_{1}$ is operating with a drain-to-source voltage $V_{t}+V_{O V}$, which is $V_{i}$ volts greater than it needs to operate in saturation.

The observations above lead us to the conclusion that to permit the output voltage at the drain of $Q_{3}$ to swing as low as $2 V_{O V}$, we must lower the voltage at the gate of $Q_{3}$ from $2 V_{t}+2 V_{O V}$ to $V_{t}+2 V_{O V}$. This is exactly what is done in the modified mirror circuit in Fig. 13.13(b): The gate of $Q_{3}$ is now connected to a bias voltage $V_{\text {BIAS }}=V_{t}+2 V_{O V}$. Thus the output voltage can go down to $2 V_{O V}$ with $Q_{3}$ still in saturation. Also, the voltage at the drain of $Q_{1}$ is now $V_{O V}$ and thus $Q_{1}$ is operating at the edge of saturation. The same is true of $Q_{2}$ and thus the current tracking between $Q_{1}$ and $Q_{2}$ will be assured. Note, however, that we can no longer connect the gate of $Q_{2}$ to its drain. Rather, it is connected to the drain of $Q_{4}$. This establishes a voltage of $V_{t}+V_{O V}$ at the drain of $Q_{4}$, which is sufficient to operate $Q_{4}$ in saturation (as long as $V_{t}$ is greater than $V_{O V}$, which is usually the case). This circuit is known as the wide-swing current mirror. Finally, note that Fig. 13.13(b) does not show the circuit for generating $V_{\text {BIAS }}$. There are a number of possible circuits to accomplish this task, one of which is explored in Exercise 13.13.

[^0]
[^0]:    ${ }^{4}$ The Texas Instruments OPA357.


Figure 13.13 (a) Cascode current mirror with the voltages at all nodes indicated. Note that the minimum voltage allowed at the output is $V_{i}+2 V_{O V}$. (b) A modification of the cascode mirror that results in the reduction of the minimum output voltage to $V_{O V}$. This is the wide-swing current mirror. The circuit requires a bias voltage $V_{\text {BIAS }}$.

# EXERCISE 

13.13 Show that if transistor $Q_{5}$ in the circuit of Fig. E13.13 has a $W / L$ ratio equal to one-quarter that of the transistors in the wide-swing current mirror of Fig. 13.13(b), and provided the same value of $I_{\text {REF }}$ is utilized in both circuits, then the voltage generated, $V_{5}$, is $V_{i}+2 V_{O V}$, which is the value of $V_{\text {BIAS }}$ needed for the gates of $Q_{3}$ and $Q_{4}$.


Figure E13.13
# 13.3 The 741 BJT Op Amp 

Our study of BJT op amps is in two parts: The first part, in this section, is focused on an analog IC classic, the 741 op-amp circuit; the second part, in Section 13.4, presents some of the more recent design techniques.

### 13.3.1 The 741 Circuit

Figure 13.14 shows the 741 op-amp circuit. In keeping with the IC design philosophy, the circuit uses a large number of transistors, but relatively few resistors and only one capacitor. This philosophy is dictated by the economics (silicon area, ease of fabrication, quality of realizable components) of the fabrication of active and passive components in IC form (see Section 8.1 and Appendix A).

As in the case of most general-purpose IC op amps, the 741 requires two power supplies, $+V_{C C}$ and $-V_{E E}$. Normally, $V_{C C}=V_{E E}=15 \mathrm{~V}$, but the circuit also operates satisfactorily with the power supplies reduced to much lower values (such as $\pm 5 \mathrm{~V}$ ). ${ }^{5}$ It is important to observe that no circuit node is connected to ground, the common terminal of the two supplies.

With a relatively large circuit like that shown in Fig. 13.14, the first step in the analysis is to identify its recognizable parts and their functions. Thus, we begin with a qualitative description of the circuit. Our description is aided by the division of the circuit into its various parts, as indicated in the diagram.

Bias Circuit The reference bias current of the 741 circuit, $I_{\mathrm{REF}}$, is generated in the branch at the extreme left of Fig. 13.14, consisting of the two diode-connected transistors $Q_{11}$ and $Q_{12}$ and the resistance $R_{5}$. Using a Widlar current source formed by $Q_{11}, Q_{10}$, and $R_{4}$, bias current for the first stage is generated in the collector of $Q_{10}$. Another current mirror formed by $Q_{8}$ and $Q_{9}$ takes part in biasing the first stage.

The reference bias current $I_{\mathrm{REF}}$ is used to provide two proportional currents in the collectors of $Q_{13}$. This double-collector lateral ${ }^{6} p n p$ transistor can be thought of as two transistors whose base-emitter junctions are connected in parallel. Thus $Q_{12}$ and $Q_{13}$ form a two-output current mirror: One output, the collector of $Q_{13 B}$, provides bias current and acts as a current-source load for $Q_{17}$, and the other output, the collector of $Q_{13 A}$, provides bias current for the output stage of the op amp.

Two more transistors, $Q_{18}$ and $Q_{19}$, take part in the dc bias process. The purpose of $Q_{18}$ and $Q_{19}$ is to establish two $V_{B E}$ drops between the bases of the output transistors $Q_{14}$ and $Q_{20}$.

Short-Circuit-Protection Circuitry The 741 circuit includes a number of transistors that are normally off and conduct only if one attempts to draw a large current from the op-amp output terminal. This happens, for example, if the output terminal is short-circuited to one of the two supplies. The short-circuit-protection network (shown in color in Fig. 13.14) consists of $R_{6}, R_{7}, Q_{15}, Q_{21}, Q_{24}, R_{11}$, and $Q_{22}$. In the following we shall assume that these transistors are off. Operation of the short-circuit-protection network will be explained in Section 13.3.3.

[^0]
[^0]:    ${ }^{5}$ The 741 is fabricated in what is known as the "standard high-voltage technology." See Appendix K for the parameter values of devices fabricated in this process.
    ${ }^{6}$ See Appendix A for a description of lateral pnp transistors. Also, their characteristics are given in Appendix K.


Figure 13.14 The 741 op-amp circuit: $Q_{11}, Q_{22}$, and $R_{5}$ generate a reference bias current, $I_{\mathrm{RBF}} \cdot Q_{10}, Q_{8}$, and $Q_{4}$ bias the input stage, which is composed of $Q_{2}$ to $Q_{7}$. The second gain stage is composed of $Q_{18}$ and $Q_{17}$ with $Q_{11 B}$ acting as active load. The class AB output stage is formed by $Q_{14}$ and $Q_{20}$ with biasing devices $Q_{13 A}, Q_{18}$, and $Q_{19}$, and an input buffer $Q_{22}$. Transistors $Q_{15}, Q_{21}, Q_{24}$, and $Q_{32}$ serve to protect the amplifier against output short circuits and are normally cut off.
The Input Stage The 741 circuit consists of three stages: an input differential stage, an intermediate single-ended high-gain stage, and an output-buffering stage. The input stage consists of transistors $Q_{1}$ through $Q_{7}$, with biasing performed by $Q_{8}, Q_{9}$, and $Q_{10}$. Transistors $Q_{1}$ and $Q_{2}$ act as emitter followers, causing the input resistance to be high and delivering the differential input signal to the differential common-base amplifier formed by $Q_{3}$ and $Q_{4}$. Thus the input stage is the differential version of the common-collector, common-base configuration discussed in Section 8.7.3.

Transistors $Q_{5}, Q_{6}$, and $Q_{7}$ and resistors $R_{1}, R_{2}$, and $R_{3}$ form the load circuit of the input stage. This is an elaborate current-mirror-load circuit, which we will analyze in Section 13.3.3. The circuit is based on the base-current-compensated mirror studied in Section 8.2.3, but it includes two emitter-degeneration resistors $R_{1}$ and $R_{2}$, and a large resistor $R_{3}$ in the emitter of $Q_{7}$. As is the case with current-mirror loads, this circuit not only provides a high-resistance load for $Q_{4}$ but also converts the signal from differential to single-ended form with no loss in gain or common-mode rejection. The output of the input stage is taken single-endedly at the collector of $Q_{4}$.

As mentioned in Section 9.6.2, every op-amp circuit includes a level shifter whose function is to shift the dc level of the signal so that the signal at the op-amp output can swing positive and negative. In the 741 , level shifting is done in the first stage using the lateral pnp transistors $Q_{3}$ and $Q_{4}$. Although lateral pnp transistors have poor high-frequency performance, their use in the common-base configuration (which is known to have good high-frequency response) does not seriously impair the op-amp frequency response.

The use of the lateral pnp transistors $Q_{3}$ and $Q_{4}$ in the first stage results in an added advantage: protection of the input-stage transistors $Q_{1}$ and $Q_{2}$ against emitter-base junction breakdown. Since the emitter-base junction of an $n p n$ transistor breaks down at about 7 V of reverse bias (see Section 6.4.1), regular npn differential stages suffer such a breakdown if, say, the supply voltage is accidentally connected between the input terminals. Lateral pnp transistors, however, have high emitter-base breakdown voltages (about 50 V ), and because they are connected in series with $Q_{1}$ and $Q_{2}$, they provide protection of the 741 input transistors, $Q_{1}$ and $Q_{2}$.

Finally, note that except for using input buffer transistors, the 741 input stage is essentially a current-mirror-loaded differential amplifier. It is quite similar to the input stage of the CMOS amplifier in Fig. 13.1.

The Second Stage The second or intermediate stage is composed of $Q_{16}, Q_{17}, Q_{13 B}$, and the two resistors $R_{8}$ and $R_{9}$. Transistor $Q_{16}$ acts as an emitter follower, thus giving the second stage a high input resistance. This minimizes the loading on the input stage and avoids loss of gain. Also, adding $Q_{16}$ with its $50-\mathrm{k} \Omega$ emitter resistance (which is similar to $Q_{7}$ and $R_{3}$ ) increases the symmetry of the first stage and thus improves its CMRR. Transistor $Q_{17}$ acts as a common-emitter amplifier with a $100-\Omega$ resistor in the emitter. Its load is composed of the high output resistance of the pnp current source $Q_{13 B}$ in parallel with the input resistance of the output stage (seen looking into the base of $Q_{23}$ ). Using a transistor current source as a load resistance (active load) enables one to obtain high gain without resorting to the use of large resistances, which would occupy a large chip area and require large power-supply voltages.

The output of the second stage is taken at the collector of $Q_{17}$. Capacitor $C_{C}$ is connected in the feedback path of the second stage to provide frequency compensation using the Miller compensation technique studied in Section 11.10.3. It will be shown in Section 13.3.4 that the relatively small capacitor $C_{C}$ gives the 741 a dominant pole at about 4 Hz . Furthermore, pole splitting causes other poles to be shifted to much higher frequencies, giving the op amp a uniform $-20-\mathrm{dB} /$ decade gain rolloff with a unity-gain bandwidth of about 1 MHz . It should
be pointed out that although $C_{C}$ is small in value, the chip area that it occupies is about 13 times that of a standard $n p n$ transistor!

## THE CREATOR OF THE $\mu$ A741-DAVID FULLAGAR:

David Fullagar was at Fairchild Semiconductor in 1967 when he designed the $\mu \mathrm{A} 741$, perhaps the most successful op amp ever. Fairchild, TI, and National still sell updated versions of this ubiquitous device. Fullagar, educated at Cambridge, U.K., and formerly employed at Ferranti, had joined Fairchild in 1966 following Widlar's departure after the $\mu \mathrm{A} 702$ and $\mu \mathrm{A} 709$ designs. Fullagar's $\mu \mathrm{A} 741$ creation incorporated internal compensation, short-circuit protection, and a novel high-impedance input stage to resolve shortcomings of the earlier designs. After leaving Fairchild, he joined Intersil as the company's first analog IC designer. The engineer-designer cofounded and became a vital technical contributor to Maxim Integrated Products in 1983; he retired in 1999.

The Output Stage The purpose of the output stage (Chapter 12) is to provide the amplifier with a low output resistance. In addition, the output stage should be able to supply relatively large load currents without dissipating an unduly large amount of power in the IC. The 741 uses an efficient class AB output stage, which we shall study in Section 13.3.3.

The output stage of the 741 consists of the complementary pair $Q_{14}$ and $Q_{20}$, where $Q_{20}$ is a substrate pnp (see Appendix A). Transistors $Q_{18}$ and $Q_{19}$ are fed by current source $Q_{13 A}$ and bias the output transistors $Q_{14}$ and $Q_{20}$. Transistor $Q_{23}$ (which is another substrate pnp) acts as an emitter follower, thus minimizing the loading effect of the output stage on the second stage.

Device Parameters In the following sections and in the exercises and end-of-chapter problems we shall carry out a detailed analysis of the 741 circuit. For the standard npn and pnp transistors, the following parameters will be used:

$$
\begin{array}{ll}
\text { npn: } & I_{S}=10^{-14} \mathrm{~A}, \beta=200, V_{A}=125 \mathrm{~V} \\
\text { pnp: } & I_{S}=10^{-14} \mathrm{~A}, \beta=50, V_{A}=50 \mathrm{~V}
\end{array}
$$

In the 741 circuit the nonstandard devices are $Q_{13}, Q_{14}$, and $Q_{20}$. Transistor $Q_{13}$ will be assumed to be equivalent to two transistors, $Q_{13 A}$ and $Q_{13 B}$, with parallel base-emitter junctions and having the following saturation currents:

$$
I_{S A}=0.25 \times 10^{-14} \mathrm{~A} \quad I_{S B}=0.75 \times 10^{-14} \mathrm{~A}
$$

Transistors $Q_{14}$ and $Q_{20}$ will be assumed to each have an area three times that of a standard device. Output transistors usually have relatively large areas, to be able to supply large load currents and dissipate relatively large amounts of power with only a moderate increase in device temperature.# EXERCISE 

13.14 For the standard $n p n$ transistor whose parameters are given in Section 13.3.1, find approximate values for the following parameters at $I_{C}=0.1 \mathrm{~mA}: V_{B E}, g_{m}, r_{e}, r_{\pi}$, and $r_{o}$. Ans. $575 \mathrm{mV} ; 4 \mathrm{~mA} / \mathrm{V} ; 250 \Omega ; 50 \mathrm{k} \Omega ; 1.25 \mathrm{M} \Omega$

### 13.3.2 DC Analysis

In this section, we shall carry out a dc analysis of the 741 circuit to determine the bias point of each device. For the dc analysis of an op-amp circuit, the input terminals are grounded. Theoretically speaking, this should result in zero dc voltage at the output. However, because the op amp has very large gain, any slight approximation in the analysis will show that the output voltage is far from being zero and is close to either $+V_{C C}$ or $-V_{E E}$. In actual practice, an op amp left open-loop will have an output voltage saturated close to one of the two supplies. To overcome this problem in the dc analysis, it will be assumed that the op amp is connected in a negative feedback loop that stabilizes the output dc voltage to zero volts.

Reference Bias Current The reference bias current $I_{\mathrm{REF}}$ is generated in the branch composed of the two diode-connected transistors $Q_{11}$ and $Q_{12}$ and resistor $R_{5}$. Thus,

$$
I_{\mathrm{REF}}=\frac{V_{C C}-V_{E B 12}-V_{B E 11}-\left(-V_{E E}\right)}{R_{5}}
$$

For $V_{C C}=V_{E E}=15 \mathrm{~V}$ and $V_{B E 11}=V_{E B 12} \simeq 0.7 \mathrm{~V}$, we have $I_{\mathrm{REF}}=0.73 \mathrm{~mA}$.
Input-Stage Bias Transistors $Q_{11}$ and $Q_{10}$ and resistor $R_{4}$ form a Widlar current source (Section 8.6.4), thus

$$
V_{T} \ln \frac{I_{\mathrm{REF}}}{I_{C 10}}=I_{C 10} R_{4}
$$

## EXERCISE

13.15 Use Eq. (13.86) to determine the value of $I_{C 10}$ by trial and error. Note that $I_{\mathrm{REF}}=0.73 \mathrm{~mA}$ and $R_{4}=5 \mathrm{k} \Omega$.
Ans. $I_{C 10}=19 \mu \mathrm{~A}$

Having determined $I_{C 10}$, we proceed to determine the dc current in each of the input-stage transistors. For this purpose, we show in Fig. 13.15 the centerpiece of the input stage: As will


Figure 13.15 The dc analysis of the 741 input stage.
be seen shortly, this is a negative-feedback circuit that stabilizes the bias current of each of $Q_{1}$ to $Q_{4}$ at a value approximately equal to $I_{C 10} / 2$. Refer to the analysis indicated in the diagram (where $\beta_{N}$ is assumed to be high). The sum of the collector currents of $Q_{1}$ and $Q_{2}(2 I)$ is fed to (or sensed by) the input of the current mirror $Q_{8}-Q_{9}$. The output current of the mirror, which for large $\beta_{P}$ is approximately equal to $2 I$, is compared to $I_{C 10}$ at node X . The difference between the two currents $\left(2 I / \beta_{P}\right)$ establishes the base currents of $Q_{3}$ and $Q_{4}$. This is the error signal of the feedback loop. For large $\beta_{P}$, this current approaches zero and a node equation at X gives $2 I \simeq I_{C 10}$, and thus $I \simeq I_{C 10} / 2$.

To verify the action of the negative-feedback loop in stabilizing the value of $I$, assume that for some reason $I$ increases. We see that the input current of the $Q_{8}-Q_{9}$ mirror increases and, correspondingly, its output current increases. Assuming that $I_{C 10}$ remains constant, consideration of node X reveals that the base currents in $Q_{3}$ and $Q_{4}$ must decrease. This in turn decreases the value of $I$, which is opposite to the originally assumed change.

# EXERCISES 

13.16 Using the value of $I_{C 10}$ found in Exercise 13.15, find the value of the bias current of each of $Q_{1}, Q_{2}$, $Q_{3}$, and $Q_{4}$.
Ans. $9.5 \mu \mathrm{~A}$
13.17 It is required to determine the loop gain of the feedback loop in Fig. 13.15. Break the loop at the input of the $Q_{8}-Q_{9}$ mirror. Since the input resistance of the mirror is low, ground the connection of the collectors of $Q_{1}$ and $Q_{2}$. Apply an input test current $i_{i}$ to the current mirror and find the feedback current that appears in the combined connection of the collectors of $Q_{1}$ and $Q_{2}$. Assume $I_{C 10}$ remains constant.
Ans. Loop gain $\simeq \beta_{P}$

Continuing with the dc analysis of the input stage, we show in Fig. 13.16 the current-mirror load $\left(Q_{5}, Q_{6}\right.$, and $\left.Q_{7}\right)$ and the input transistor of the second stage $\left(Q_{16}\right)$. The current-mirror load is fed by $I_{C 3}=I_{C 4} \simeq I$. The analysis is illustrated in the figure and shows that for large $\beta_{N}$, each of $Q_{5}$ and $Q_{6}$ is biased at a current approximately equal to $I$. The bias current of $Q_{7}$ is somewhat higher, as shown in Exercise 13.18.


Figure 13.16 Continuation of the dc analysis of the 741 input stage.

# EXERCISES 

13.18 Refer to Fig. 13.16 and recall that $I=9.5 \mu \mathrm{~A}, R_{1}=R_{2}=1 \mathrm{k} \Omega, R_{3}=50 \mathrm{k} \Omega, \beta_{N}=200$, and $I_{S}$ (for all three transistors) is $10^{-14} \mathrm{~A}$. Find $V_{B E 6}, V_{B 6}$, and $I_{C 7}$.
Ans. $517 \mathrm{mV} ; 526.5 \mathrm{mV} ; 10.5 \mu \mathrm{~A}$
13.19 Recalling from Chapters 2 and 9 that the input bias current of an op amp is the average of its two input currents, thus

$$
I_{B}=\frac{1}{2}\left(I_{B 1}+I_{B 2}\right)
$$
and the input offset current is

$$
I_{O S}=\left|I_{B 1}-I_{B 2}\right|
$$

find $I_{B}$ and $I_{O S}$ for the 741 if $\beta_{1}$ and $\beta_{2}$ are nominally 200 but can deviate from nominal by as much as $\pm 5 \%$.
Ans. $47.5 \mathrm{nA} ; 4.75 \mathrm{nA}$

Input Common-Mode Range The input common-mode range is the range of input common-mode voltages over which the input stage remains in the linear active mode. Refer to Fig. 13.14. We see that in the 741 circuit the input common-mode range is determined at the upper end by saturation of $Q_{1}$ and $Q_{2}$, and at the lower end by saturation of $Q_{3}$ and $Q_{4}$.

# EXERCISE 

13.20 Neglect the voltage drops across $R_{1}$ and $R_{2}$ and assume that $V_{C C}=V_{E E}=15 \mathrm{~V}$. Show that the input common-mode range of the 741 is approximately -12.9 V to +14.7 V . (Assume that $V_{B E} \simeq 0.6 \mathrm{~V}$ and that to avoid saturation $V_{C B} \geq-0.3 \mathrm{~V}$ for an $n p n$ transistor, and $V_{B C} \geq-0.3 \mathrm{~V}$ for a $p n p$ transistor.)

Second-Stage Bias Reference to Fig. 13.14 shows that if we neglect the base current of $Q_{23}$, the collector current of $Q_{17}$ will be equal to the current supplied by $Q_{13 B}$. We can then use $I_{C 17}$ to determine $V_{B E 17}, V_{B 17}$, the current through $R_{9}$ and hence $I_{E 16}$, and finally $I_{C 16} \simeq I_{E 16}$.

## EXERCISE

13.21 Recalling that $Q_{13 B}$ has a scale current 0.75 times that of $Q_{12}$, find $I_{C 13 B}$ and hence $I_{C 17}$. Assume $\beta_{P} \gg 1$. Then determine $V_{B E 17}, I_{C 16}$, and $I_{B 16}$. (Recall that $I_{\mathrm{REF}}=0.73 \mathrm{~mA}, I_{S}=10^{-14} \mathrm{~A}$, and $\beta_{N}=200$.) Ans. $550 \mu \mathrm{~A} ; 550 \mu \mathrm{~A} ; 618 \mathrm{mV} ; 16.2 \mu \mathrm{~A} ; 0.08 \mu \mathrm{~A}$

Output-Stage Bias Figure 13.17 shows the output stage of the 741 with the short-circuitprotection circuitry omitted. Current source $Q_{13 A}$ delivers a current of $0.25 I_{\mathrm{REF}}$ (because $I_{S}$ of $Q_{13 A}$ is 0.25 times the $I_{S}$ of $Q_{12}$ ) to the network composed of $Q_{18}, Q_{19}$, and $R_{10}$. As mentioned in Section 13.3.1, the purpose of the $Q_{18}-Q_{19}$ network is to establish two $V_{B E}$ drops between


Figure 13.17 The 741 output stage without the short-circuit-protection devices.
the bases of the output transistors $Q_{14}$ and $Q_{20}$. If we neglect the base currents of $Q_{14}$ and $Q_{20}$, then the emitter current of $Q_{23}$ will also be equal to $0.25 I_{\mathrm{REF}}$.

The determination of the bias currents of the output-stage transistors is illustrated by the following example.

# Example 13.3 

Determine $I_{C 23}, I_{B 23}, V_{B B}=V_{B E 18}+V_{B E 19}, I_{C 14}$, and $I_{C 20}$. Recall that $Q_{14}$ and $Q_{20}$ are nonstandard devices with $I_{S 14}=I_{S 20}=3 \times 10^{-14} \mathrm{~A}$.

## Solution

Reference to Fig. 13.7 shows that

$$
I_{C 23} \simeq I_{E 23} \simeq 0.25 I_{\mathrm{REF}}=180 \mu \mathrm{~A}
$$

Thus we see that the base current of $Q_{23}$ is only $180 / 50=3.6 \mu \mathrm{~A}$, which is negligible compared to $I_{C 17}$, as we assumed before.
If we assume that $V_{B E 18}$ is approximately 0.6 V , we can determine the current in $R_{10}$ as $15 \mu \mathrm{~A}$. The emitter current of $Q_{18}$ is therefore

$$
I_{E 18}=180-15=165 \mu \mathrm{~A}
$$

Also,

$$
I_{C 18} \simeq I_{E 18}=165 \mu \mathrm{~A}
$$

At this value of current we find that $V_{B E 18}=588 \mathrm{mV}$, which is quite close to the value assumed. The base current of $Q_{18}$ is $165 / 200=0.8 \mu \mathrm{~A}$, which can be added to the current in $R_{10}$ to determine the $Q_{19}$ current as

$$
I_{C 19} \simeq I_{E 19}=15.8 \mu \mathrm{~A}
$$

The voltage drop across the base-emitter junction of $Q_{19}$ can now be determined as

$$
V_{B E 19}=V_{T} \ln \frac{I_{C 19}}{I_{S}}=530 \mathrm{mV}
$$

The voltage drop $V_{B B}$ can now be calculated as

$$
V_{B B}=V_{B E 18}+V_{B E 19}=588+530=1.118 \mathrm{~V}
$$

Since $V_{B B}$ appears across the series combination of the base-emitter junctions of $Q_{14}$ and $Q_{20}$, we can write

$$
V_{B B}=V_{T} \ln \frac{I_{C 14}}{I_{S 14}}+V_{T} \ln \frac{I_{C 20}}{I_{S 20}}
$$

Using the calculated value of $V_{B B}$ and substituting $I_{S 14}=I_{S 20}=3 \times 10^{-14} \mathrm{~A}$, we determine the collector currents as

$$
I_{C 14}=I_{C 20}=154 \mu \mathrm{~A}
$$

This is the small current (relative to the load currents that the output stage is called upon to supply) at which the class AB output stage is biased.

Summary For future reference, Table 13.1 provides a listing of the values of the collector bias currents of the 741 transistors.
Table 13.1 DC Collector Currents of the 741 Circuit ( $\mu \mathrm{A}$ )

| $Q_{1}$ | 9.5 | $Q_{8}$ | 19 | $Q_{13 B}$ | 550 | $Q_{19}$ | 15.8 |
| :-- | :-- | :-- | :-- | :-- | :-- | :-- | :-- |
| $Q_{2}$ | 9.5 | $Q_{9}$ | 19 | $Q_{14}$ | 154 | $Q_{20}$ | 154 |
| $Q_{3}$ | 9.5 | $Q_{10}$ | 19 | $Q_{15}$ | 0 | $Q_{21}$ | 0 |
| $Q_{4}$ | 9.5 | $Q_{11}$ | 730 | $Q_{16}$ | 16.2 | $Q_{22}$ | 0 |
| $Q_{5}$ | 9.5 | $Q_{12}$ | 730 | $Q_{17}$ | 550 | $Q_{23}$ | 180 |
| $Q_{6}$ | 9.5 | $Q_{13 A}$ | 180 | $Q_{18}$ | 165 | $Q_{24}$ | 0 |
| $Q_{7}$ | 10.5 |  |  |  |  |  |  |

# EXERCISE 

13.22 If in the circuit of Fig. 13.17 the $Q_{18}-Q_{19}$ network is replaced by two diode-connected transistors, find the current in $Q_{14}$ and $Q_{20}$. Assume that the diode-connected transistors utilize standard devices with $I_{S}=10^{-14} \mathrm{~A}$, while the nonstandard $Q_{14}$ and $Q_{20}$ have $I_{S}=3 \times 10^{-14} \mathrm{~A}$.
Ans. $540 \mu \mathrm{~A}$

### 13.3.3 Small-Signal Analysis

The Input Stage Figure 13.18 shows part of the 741 input stage for the purpose of performing small-signal analysis. Note that since the collectors of $Q_{1}$ and $Q_{2}$ are connected to a constant dc voltage, they are shown grounded. Also, the constant-current biasing of the bases of $Q_{3}$ and $Q_{4}$ is equivalent to having the common-base terminal open-circuited.

The differential signal $v_{i}$ applied between the input terminals effectively appears across four equal emitter resistances connected in series-those of $Q_{1}, Q_{2}, Q_{3}$, and $Q_{4}$. As a result,


Figure 13.18 Small-signal analysis of the 741 input stage.
emitter signal currents flow as indicated in Fig. 13.18 with

$$
i_{e}=\frac{v_{i}}{4 r_{e}}
$$

where $r_{e}$ denotes the emitter resistance of each of $Q_{1}$ through $Q_{4}$. Thus

$$
r_{e}=\frac{V_{T}}{I}
$$

Thus the four transistors $Q_{1}$ through $Q_{4}$ supply the load circuit with a pair of complementary current signals $\alpha i_{e}$, as indicated in Fig. 13.18.

The input differential resistance of the op amp can be obtained from Fig. 13.18 as

$$
R_{i d}=4\left(\beta_{N}+1\right) r_{e}
$$

Proceeding with the input-stage analysis, we show in Fig. 13.19 the current-mirror-load circuit fed with the complementary pair of current signals found earlier. The analysis, together with the order of the steps in which it is performed, is indicated on the diagram. As expected, the current mirror provides an output current $i_{o}$,

$$
i_{o}=2 \alpha i_{e}
$$

Combining Eqs. (13.87) and (13.89) provides the transconductance of the input stage as

$$
G_{m 1} \equiv \frac{i_{o}}{v_{i}}=\frac{\alpha}{2 r_{e}}=\frac{1}{2} g_{m 1}
$$

where $g_{m 1}$ is the transconductance of each of the four transistors $Q_{1}, Q_{2}, Q_{3}$, and $Q_{4}$.


Figure 13.19 The current-mirror-load circuit of the input stage fed by the two complementary current signals generated by $Q_{1}$ through $Q_{4}$ in Fig. 13.18. Circled numbers indicate the order of the analysis steps.
# EXERCISES 

13.23 Recalling that each of the input-stage transistors is biased at a current $I=9.5 \mu \mathrm{~A}$ and that $\beta_{N}=200$, find $r_{e}, g_{m 1}, G_{m 1}$, and $R_{o l}$.
Ans. $2.63 \mathrm{k} \Omega ; 0.38 \mathrm{~mA} / \mathrm{V} ; 0.19 \mathrm{~mA} / \mathrm{V} ; 21 \mathrm{M} \Omega$
13.24 For the circuit in Fig. 13.19, find the following in terms of $i_{e}$ : (a) the signal voltage at the base of $Q_{6}$; (b) the signal current in the emitter of $Q_{7}$; (c) the signal current in the base of $Q_{7}$; (d) the signal voltage at the base of $Q_{7}$; (e) the input resistance seen by the left-hand-side signal current source $\alpha i_{e}$. For simplicity, assume that $I_{C 7} \simeq I_{C 5}=I_{C 6}$, and use the results of Exercise 13.23.
Ans. (a) $3.63 \mathrm{k} \Omega \times i_{e}$; (b) $0.08 i_{e}$; (c) $0.0004 i_{e}$; (d) $3.84 \mathrm{k} \Omega \times i_{e}$; (e) $3.84 \mathrm{k} \Omega$

To complete our modeling of the 741 input stage, we must find its output resistance $R_{o 1}$. This is the resistance seen "looking back" into the output terminal of the circuit in Fig. 13.19. Thus $R_{o 1}$ is the parallel equivalent of the output resistance of the current source supplying the signal current $\alpha i_{e}$, and the output resistance of $Q_{6}$. The first component is the resistance looking into the collector of $Q_{4}$ in Fig. 13.18. Finding this resistance is considerably simplified if we assume that the common bases of $Q_{3}$ and $Q_{4}$ are at a virtual ground. This of course happens only when the input signal $v_{i}$ is applied in a complementary fashion. Nevertheless, making this assumption does not result in a large error.

Assuming that the base of $Q_{4}$ is at virtual ground, the resistance we are after is $R_{o 4}$, indicated in Fig. 13.20(a). This is the output resistance of a common-base transistor that has a resistance $\left(r_{e}\right.$ of $\left.Q_{2}\right)$ in its emitter. To find $R_{o 4}$ we use the following expression (Eq. 8.70):

$$
R_{o}=r_{o}\left[1+g_{m}\left(R_{e} \| r_{o}\right)\right]
$$

where $R_{e}=r_{e}$ and $r_{o}=V_{A p} / I$.
The second component of the output resistance is that seen looking into the collector of $Q_{6}$ in Fig. 13.19 with the $\alpha i_{e}$ generator set to 0 . Although the base of $Q_{6}$ is not at signal ground, we shall assume that the signal voltage at the base is small enough to make this approximation valid. The circuit then takes the form shown in Fig. 13.20(b), and $R_{o 6}$ can be determined using Eq. (13.91) with $R_{e}=R_{2}$.


Figure 13.20 Simplified circuits for finding the two components of the output resistance $R_{o 1}$ of the first stage.
Figure 13.21 shows the equivalent circuit that we have derived for the input stage.


Figure 13.21 Small-signal equivalent circuit for the input stage of the 741 op amp.

# EXERCISES 

13.25 Find the values of $R_{o 1}$ and $R_{o 6}$ and thus the output resistance of the first stage, $R_{o 1}$. Recall that $I=9.5 \mu \mathrm{~A}, V_{A o}=125 \mathrm{~V}, V_{A e}=50 \mathrm{~V}, R_{2}=1 \mathrm{k} \Omega, \beta_{N}=200$, and $\beta_{P}=50$.
Ans. $10.5 \mathrm{M} \Omega ; 18.2 \mathrm{M} \Omega ; 6.7 \mathrm{M} \Omega$
13.26 Use the equivalent circuit of Fig. 13.21 together with the value of $G_{m 1}$ found in Exercise 13.23 and the value of $R_{o 1}$ found in Exercise 13.25 to determine the open-circuit voltage gain of the 741 input stage.
Ans. $\left|A_{v o}\right|=G_{m 1} R_{o 1}=1273 \mathrm{~V} / \mathrm{V}$

## Example 13.4

We wish to find the input offset voltage resulting from a $2 \%$ mismatch between the resistances $R_{1}$ and $R_{2}$ in Fig. 13.14.

## Solution

Consider first the situation when both input terminals are grounded, and assume that $R_{1}=R$ and $R_{2}=R+$ $\Delta R$, where $\Delta R / R=0.02$. From Fig. 13.22 we see that while $Q_{S}$ still conducts a current equal to $I$, the current in $Q_{6}$ will be smaller by $\Delta I$. The value of $\Delta I$ can be found from

$$
V_{B E 5}+I R=V_{B E 6}+(I-\Delta I)(R+\Delta R)
$$

Thus

$$
V_{B E 5}-V_{B E 6}=I \Delta R-\Delta I(R+\Delta R)
$$

The quantity on the left-hand side is in effect the change in $V_{B E}$ due to a change in $I_{E}$ of $\Delta I$. We may therefore write

$$
V_{B E 5}-V_{B E 6} \simeq \Delta I r_{e}
$$# Example 13.4 continued 

Equations (13.92) and (13.93) can be combined to obtain

$$
\frac{\Delta I}{I}=\frac{\Delta R}{R+\Delta R+r_{e}}
$$

Substituting $R=1 \mathrm{k} \Omega$ and $r_{e}=2.63 \mathrm{k} \Omega$ shows that a $2 \%$ mismatch between $R_{1}$ and $R_{2}$ gives rise to an output current $\Delta I=5.5 \times 10^{-3} I$. To reduce this output current to zero we have to apply an input voltage $V_{O S}$ given by

$$
V_{O S}=\frac{\Delta I}{G_{m 1}}=\frac{5.5 \times 10^{-3} I}{G_{m 1}}
$$

Substituting $I=9.5 \mu \mathrm{~A}$ and $G_{m 1}=0.19 \mathrm{~mA} / \mathrm{V}$ results in the offset voltage $V_{O S} \simeq 0.3 \mathrm{mV}$.
It should be pointed out that the offset voltage calculated is only one component of the input offset voltage of the 741 . Other components arise because of mismatches in transistor characteristics. The 741 offset voltage is specified to be typically 2 mV .


Figure 13.22 Input stage with both inputs grounded and a mismatch $\Delta R$ between $R_{1}$ and $R_{2}$.

## Example 13.5

It is required to find the CMRR of the 741 input stage. Assume that the circuit is balanced except for mismatches in the current-mirror load that result in an error $\epsilon_{m}$ in the mirror's current-transfer ratio; that is, the ratio becomes $\left(1-\epsilon_{m}\right)$.
# Solution 

In Section 9.5.5 we analyzed the common-mode operation of the current-mirror-loaded differential amplifier and derived an expression for its CMRR. The situation in the 741 input stage, however, differs substantially because of the feedback loop that regulates the bias current. Since this feedback loop is sensitive to the common-mode signal, as will be seen shortly, the loop operates to reduce the common-mode gain and, correspondingly, to increase the CMRR. Hence, its action is referred to as common-mode feedback.

Figure 13.23 shows the 741 input stage with a common-mode signal $v_{i c m}$ applied to both input terminals. We have assumed that as a result of $v_{i c m}$, a signal current $i$ flows as shown. Since the stage is balanced, both sides carry the same current $i$.


Figure 13.23 Example 13.5: Analysis of the common-mode gain of the 741 input stage. Note that $R_{o}=R_{o 8} \| R_{o 10}$ has been "pulled out" and shown separately, leaving behind ideal current sources $Q_{9}$ and $Q_{10}$.

Our objective now is to determine how $i$ relates to $v_{i c m}$. Toward that end, observe that for common-mode inputs, both sides of the differential amplifier, that is, $Q_{1}-Q_{3}$ and $Q_{2}-Q_{4}$, act as followers, delivering a signal almost equal to $v_{i c m}$ to the common-base node of $Q_{3}$ and $Q_{4}$. Now, this node Y is connected to the collectors of two current sources, $Q_{9}$ and $Q_{10}$. Denoting the total resistance between node Y and ground $R_{o}$, we write

$$
R_{o}=R_{o 9} \| R_{o 10}
$$
# Example 13.5 continued 

In Fig. 13.23 we have "pulled $R_{o}$ out," thus leaving behind ideal current sources $Q_{8}$ and $Q_{10}$. Since the current in $Q_{10}$ is constant, we show $Q_{10}$ in Fig. 13.23 as having a zero incremental current. Transistor $Q_{4}$, on the other hand, provides a current approximately equal to that fed into $Q_{8}$, which is $2 i$. This is the feedback current. Since $Q_{8}$ senses the sum of the currents in the two sides of the differential amplifier, the feedback loop operates only on the common-mode signal and is insensitive to any difference signal.

Proceeding with the analysis, we now can write a node equation at Y ,

$$
2 i+\frac{2 i}{\beta_{P}}=\frac{v_{i, m}}{R_{o}}
$$

Assuming $\beta_{P} \gg 1$, this equation simplifies to

$$
i \simeq \frac{v_{i, m}}{2 R_{o}}
$$

Having determined $i$, we now proceed to complete our analysis by finding the output current $i_{o}$. From the circuit in Fig. 13.23, we see that

$$
i_{o}=\epsilon_{m} i
$$

Thus the common-mode transconductance of the input stage is given by

$$
G_{m c m} \equiv \frac{i_{o}}{v_{i, m}}=\frac{\epsilon_{m} i}{v_{i, m}}
$$

Substituting for $i$ from Eq. (13.98) gives

$$
G_{m c m}=\frac{\epsilon_{m}}{2 R_{o}}
$$

Finally, the CMRR can be found as the ratio of the differential transconductance $G_{m 1}$ found in Eq. (13.90) and the common-mode transconductance $G_{m c m}$,

$$
\mathrm{CMRR} \equiv \frac{G_{m 1}}{G_{m c m}}=g_{m 1} R_{o} / \epsilon_{m}
$$

where $g_{m 1}$ is the transconductance of $Q_{1}$. Now substituting for $R_{o}$ from Eq. (13.96), we obtain

$$
\mathrm{CMRR}=g_{m 1}\left(R_{o 9} \| R_{o 10}\right) / \epsilon_{m}
$$

Before leaving this example, we observe that if the feedback were not present, the $2 i$ term in Eq. (13.97) would be absent and the current $i$ would become $\beta_{P}\left(v_{i, m} / 2 R_{o}\right)$, which is $\beta_{P}$ times higher than that when feedback is present. In other words, common-mode feedback reduces $i$, hence the common-mode transconductance and the common-mode gain, by a factor $\beta_{P}$. It can be shown that $\beta_{P}$ is the magnitude of the loop gain. (See Exercise 13.17.)
# EXERCISES 

13.27 Show that if the source of the imbalance in the current-mirror load is that while $R_{1}=R, R_{2}=R+\Delta R$, the error $\epsilon_{m}$ is given by

$$
\epsilon_{m}=\frac{\Delta R}{R+r_{e 5}+\Delta R}
$$

Evaluate $\epsilon_{m}$ for $\Delta R / R=0.02$.
Ans. $\epsilon_{m}=5.5 \times 10^{-3}$
13.28 Refer to Fig. 13.23 and assume that the bases of $Q_{9}$ and $Q_{10}$ are at approximately constant voltages (signal ground). Find $R_{o 9}, R_{o 10}$, and hence $R_{o}$. Use $V_{A}=125 \mathrm{~V}$ for $n p n$ and 50 V for $p n p$ transistors. Use the bias current values in Table 13.1.
Ans. $R_{o 9}=2.63 \mathrm{M} \Omega ; R_{o 10}=31.1 \mathrm{M} \Omega ; R_{o}=2.43 \mathrm{M} \Omega$
13.29 Use the results of Exercises 13.27 and 13.28 to determine $G_{m o m}$ and CMRR of the 741 input stage. What would the CMRR be if the common-mode feedback were not present? Assume $\beta_{P}=50$. Ans. $G_{m o m}=1.13 \times 10^{-6} \mathrm{~mA} / \mathrm{V} ; \mathrm{CMRR}=1.68 \times 10^{5}$ or 104.5 dB ; without common-mode feedback, $\mathrm{CMRR}=70.5 \mathrm{~dB}$

The Second Stage Figure 13.24(a) shows the 741 second stage prepared for small-signal analysis, and Fig. 13.24(b) shows its small-signal model. The three model parameters $R_{i 2}$, $G_{m 2}$, and $R_{o 2}$ can be determined as follows.

The input resistance $R_{i 2}$ can be found by inspection to be

$$
R_{i 2}=\left(\beta_{16}+1\right)\left\{r_{e 16}+\left[R_{9} \|\left(\beta_{17}+1\right)\left(r_{e 17}+R_{8}\right)\right]\right\}
$$

From the equivalent circuit of Fig. 13.24(b), we see that the transconductance $G_{m 2}$ is the ratio of the short-circuit output current to the input voltage. Short-circuiting the output terminal of the second stage (Fig. 13.24a) to ground makes the signal current through the output resistance of $Q_{13 B}$ zero, and the output short-circuit current becomes equal to the collector signal current of $Q_{17}\left(i_{c 17}\right)$. This latter current can be easily related to $v_{i 2}$ as follows:

$$
\begin{aligned}
i_{c 17} & =\frac{\alpha v_{b 17}}{r_{e 17}+R_{8}} \\
v_{b 17} & =v_{i 2} \frac{\left(R_{9} \| R_{i 17}\right)}{\left(R_{9} \| R_{i 17}\right)+r_{e 16}} \\
R_{i 17} & =\left(\beta_{17}+1\right)\left(r_{e 17}+R_{8}\right)
\end{aligned}
$$

where we have neglected $r_{o 16}$ because $r_{o 16} \gg R_{9}$. These equations can be combined to obtain

$$
G_{m 2} \equiv \frac{i_{c 17}}{v_{i 2}}
$$

To determine the output resistance $R_{o 2}$ of the second stage in Fig. 13.24(a), we ground the input terminal and find the resistance looking back into the output terminal. It follows that $R_{o 2}$


Figure 13.24 (a) The 741 second stage prepared for small-signal analysis. (b) Equivalent circuit.
is given by

$$
R_{o 2}=\left(R_{o 13 B} \| R_{o 17}\right)
$$

where $R_{o 13 B}$ is the resistance looking into the collector of $Q_{13 B}$ while its base and emitter are connected to ground. It can be easily seen that

$$
R_{o 13 B}=r_{o 13 B}
$$

The second component in Eq. (13.108), $R_{o 17}$, is the resistance seen looking into the collector of $Q_{17}$. Since the resistance between the base of $Q_{17}$ and ground is relatively small (approximately equal to $r_{e 16}$ ), one can considerably simplify matters by assuming that the base is grounded. Doing this, we can use Eq. (13.91) to determine $R_{o 17}$.

# EXERCISES 

In the following exercises use $I_{C 13 B}=550 \mu \mathrm{~A}, I_{C 16}=16.2 \mu \mathrm{~A}, I_{C 17}=550 \mu \mathrm{~A}, \beta_{N}=200, \beta_{P}=50$, $V_{A n}=125 \mathrm{~V}, V_{A p}=50 \mathrm{~V}, R_{9}=50 \mathrm{k} \Omega$, and $R_{8}=100 \Omega$.
13.30 Determine the value of $R_{i 2}$.

Ans. $4 \mathrm{M} \Omega$
13.31 Determine the value of $G_{m 2}$.

Ans. $6.5 \mathrm{~mA} / \mathrm{V}$
13.32 Determine the values of $R_{o 13 B}, R_{o 17}$, and $R_{o 2}$.

Ans. $90.9 \mathrm{k} \Omega ; 787 \mathrm{k} \Omega ; 81 \mathrm{k} \Omega$
13.33 Determine the value of the open-circuit voltage gain of the second stage.

Ans. $-526.5 \mathrm{~V} / \mathrm{V}$
The Output Stage The 741 output stage is shown in Fig. 13.25 without the short-circuitprotection circuitry. The stage is shown driven by the second-stage transistor $Q_{17}$ and loaded with a $2-\mathrm{k} \Omega$ resistance. The circuit is of the AB class (Section 12.4), with the network composed of $Q_{18}, Q_{19}$, and $R_{10}$ providing the bias of the output transistors $Q_{14}$ and $Q_{20}$. The use of this network rather than two diode-connected transistors in series enables biasing the output transistors at a low current $(0.15 \mathrm{~mA})$ in spite of the fact that the output devices are three times as large as the standard devices. This result is obtained by arranging that the current in $Q_{19}$ is very small and thus its $V_{B E}$ is also small. We analyzed the dc bias in Section 13.3.2.

Another feature of the 741 output stage worth noting is that the stage is driven by an emitter follower $Q_{23}$. As will be shown, this emitter follower provides added buffering, which makes the op-amp gain almost independent of the parameters of the output transistors.

Let's first determine the allowable range of output voltage swing. The maximum positive output voltage is limited by the saturation of current-source transistor $Q_{13 A}$. Thus,

$$
v_{O \max }=V_{C C}-\left|V_{C E s a t}\right|-V_{B E 14}
$$

which is about 1 V below $V_{C C}$. The minimum output voltage (i.e., maximum negative amplitude) is limited by the saturation of $Q_{17}$. Neglecting the voltage drop across $R_{8}$, we obtain

$$
v_{O \min }=-V_{E E}+V_{C E \text { sat }}+V_{E B 23}+V_{E B 20}
$$

which is about 1.5 V above $-V_{E E}$.


Figure 13.25 The 741 output stage without the short-circuit-protection circuitry.


Figure 13.26 Model for the 741 output stage in Fig. 13.25.
Next, we consider the small-signal analysis of the output stage. Specifically, we model the output stage using the equivalent circuit in Fig. 13.26 and determine the model parameters as follows. Note that the model is shown fed with the open-circuit voltage of the second stage $v_{o 2}$, where from Fig. 13.24(b), $v_{o 2}=-G_{s o 2} R_{o 2} v_{i 2}$.

To determine the input resistance $R_{\text {in }}$, we take into account the load resistance $R_{L}$ and assume that one of the output transistors is conducting, as illustrated in the following example.

# Example 13.6 

Assuming that $Q_{14}$ is off and $Q_{20}$ is conducting a current of 5 mA to a load $R_{L}=2 \mathrm{k} \Omega$, determine the value of $R_{\text {in }}$. Using $G_{s o 2}=6.5 \mathrm{~mA} / \mathrm{V}$ and $R_{o 2}=81 \mathrm{k} \Omega$, determine the voltage gain of the second stage.

## Solution

Refer to Fig. 13.25. The input resistance looking into the base of $Q_{20}$ is approximately $\beta_{20} R_{L}=50 \times 2=100 \mathrm{k} \Omega$. This resistance appears in parallel with the series combination of $r_{o 134}=$ $V_{A p} / I_{C 13 A}=50 \mathrm{~V} / 180 \mu \mathrm{~A}=280 \mathrm{k} \Omega$, and the resistance of the $Q_{18}-Q_{19}$ network. The latter resistance is very small (about $160 \Omega$; see later: Exercise 13.35). Thus, the total resistance in the emitter of $Q_{23}$ is approximately $(100 \mathrm{k} \Omega \| 280 \mathrm{k} \Omega)$ or $74 \mathrm{k} \Omega$, and the input resistance $R_{\text {in }}$ is obtained as

$$
R_{\text {in } 3}=\beta_{23} \times 74 \mathrm{k} \Omega=50 \times 74=3.7 \mathrm{M} \Omega
$$

We thus see that $R_{\text {in }} \gg R_{o 2}$, and the value of $R_{\text {in }}$ will have little effect on the performance of the op amp. Still we can determine the gain of the second stage as

$$
\begin{aligned}
A_{2} & \equiv \frac{v_{i 3}}{v_{i 2}}=-G_{s o 2} R_{o 2} \frac{R_{\text {in }}}{R_{\text {in } 3}+R_{o 2}} \\
& =-6.5 \times 81 \frac{3700}{3700+81}=-515 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

Continuing with the determination of the equivalent-circuit model parameters, we note from Fig. 13.26 that $G_{s o 3}$ is the open-circuit overall voltage gain of the output stage,

$$
G_{s o 3}=\left.\frac{v_{o}}{v_{o 2}}\right|_{R_{L}=\infty}
$$
With $R_{L}=\infty$, the gain of the emitter-follower output transistor $\left(Q_{14}\right.$ or $\left.Q_{20}\right)$ will be nearly unity. Also, with $R_{L}=\infty$ the resistance in the emitter of $Q_{23}$ will be very large. This means that the gain of $Q_{23}$ will be nearly unity and the input resistance of $Q_{23}$ will be very large. We thus conclude that $G_{\text {out }} \simeq 1$.

Next, we shall find the value of the output resistance of the op amp, $R_{\text {out }}$. For this purpose refer to the circuit shown in Fig. 13.27. In accordance with the definition of $R_{\text {out }}$ from Fig. 13.26, the input source feeding the output stage is grounded, but its resistance (which is the output resistance of the second stage, $R_{o 2}$ ) is included. We have assumed that the output voltage $v_{O}$ is negative, and thus $Q_{20}$ is conducting most of the current; transistor $Q_{14}$ has therefore been eliminated. The exact value of the output resistance will of course depend on which transistor $\left(Q_{14}\right.$ or $\left.Q_{20}\right)$ is conducting and on the value of load current. Nevertheless, we wish to find an estimate of $R_{\text {out }}$. The analysis for doing so is shown in Fig. 13.27. It should be noted, however, that to the value of $R_{\text {out }}$ given in the figure we must add the resistance $R_{7}$ $(27 \Omega)$ (see Fig. 13.14), which is included for short-circuit protection, in order to obtain the total output resistance of the 741 .


Figure 13.27 Circuit for finding the output resistance $R_{\text {out }}$.

# EXERCISES 

13.34 Find the value of $R_{o 23}, R_{\text {out }}$, and the total output resistance of the 741 op amp. Use $R_{o 2}=81 \mathrm{k} \Omega$, $\beta_{23}=\beta_{20}=50$, and $I_{C 23}=180 \mu \mathrm{~A}$, and assume that $Q_{20}$ is conducting a load current of 5 mA . Ans. $1.73 \mathrm{k} \Omega ; 39 \Omega ; 66 \Omega$
13.35 Using a simple $\left(r_{\pi}, g_{m}\right)$ model for each of the two transistors $Q_{18}$ and $Q_{19}$ in Fig. E13.35, find the small-signal resistance between $A$ and $A^{\prime}$. (Note: From Table 13.1, $I_{C 18}=165 \mu \mathrm{~A}$ and $I_{C 19} \simeq 16 \mu \mathrm{~A}$. Also, $\beta_{N}=200$.)
Ans. $163 \Omega$


Figure E13.35

Output Short-Circuit Protection If the op-amp output terminal is short-circuited to one of the power supplies, one of the two output transistors could conduct a large amount of current. Such a large current can result in sufficient heating to cause burnout of the IC (Chapter 12). To guard against this possibility, the 741 op amp is equipped with a special circuit for short-circuit protection. The function of this circuit is to limit the current in the output transistors in the event of a short circuit.

Refer to Fig. 13.14 and note that the short-circuit-protection circuitry is highlighted in color. Resistance $R_{\mathrm{fi}}$ together with transistor $Q_{15}$ limits the current that would flow out of $Q_{14}$ in the event of a short circuit. Specifically, if the current in the emitter of $Q_{14}$ exceeds about 20 mA , the voltage drop across $R_{\mathrm{fi}}$ exceeds 540 mV , which turns $Q_{15}$ on. As $Q_{15}$ turns on, its collector robs some of the current supplied by $Q_{13 A}$, thus reducing the base current of $Q_{14}$. This mechanism thus limits the maximum current that the op amp can source (i.e., supply from the output terminal in the outward direction) to about 20 mA .

Limiting of the maximum current that the op amp can sink, and hence the current through $Q_{20}$, is done by a mechanism similar to the one discussed above. The relevant circuit is composed of $R_{7}, Q_{21}, Q_{24}$, and $Q_{22}$. For the components shown, the current in the inward direction is limited also to about 20 mA .

Overall Voltage Gain The overall small-signal gain can be found from the cascade of the equivalent circuits derived above for the three op-amp stages. This cascade is shown in Fig. 13.28, loaded with $R_{L}=2 \mathrm{k} \Omega$, which is the typical value used in measuring


Figure 13.28 Cascading the small-signal equivalent circuits of the individual stages for the evaluation of the overall voltage gain.
and specifying the 741 data. The overall gain can be expressed as

$$
\begin{aligned}
\frac{v_{o}}{v_{i}} & =\frac{v_{i 2}}{v_{i}} \frac{v_{o 2}}{v_{i 2}} \frac{v_{o}}{v_{o 2}} \\
& =-G_{m 1}\left(R_{o 1} \| R_{i 2}\right)\left(-G_{m 2} R_{o 2}\right) G_{v o 3} \frac{R_{L}}{R_{L}+R_{\text {out }}}
\end{aligned}
$$

Using the values found earlier yields for the overall open-circuit voltage gain,

$$
\begin{aligned}
A_{0} & \equiv \frac{v_{o}}{v_{i}}=-476.1 \times(-526.5) \times 0.97=243,147 \mathrm{~V} / \mathrm{V} \\
& =107.7 \mathrm{~dB}
\end{aligned}
$$

# 13.3.4 Frequency Response 

The 741 is an internally compensated op amp. It employs the Miller compensation technique, studied in Section 11.10.3, to introduce a dominant low-frequency pole. Specifically, a $30-\mathrm{pF}$ capacitor $\left(C_{C}\right)$ is connected in the negative-feedback path of the second stage. An approximate estimate of the frequency of the dominant pole can be obtained as follows.

From Miller's theorem (Section 10.3.3), we see that the effective capacitance due to $C_{C}$ between the base of $Q_{16}$ and ground is (see Fig. 13.14)

$$
C_{\text {in }}=C_{C}\left(1+\left|A_{2}\right|\right)
$$

where $A_{2}$ is the second-stage gain. Use of the value calculated for $A_{2}$ found in Example 13.6, $A_{2}=-515$, results in $C_{\text {in }}=15,480 \mathrm{pF}$. Since this capacitance is quite large, we shall neglect all other capacitances between the base of $Q_{16}$ and signal ground. The total resistance between this node and ground is

$$
\begin{aligned}
R_{t} & =R_{o 1} \| R_{i 2} \\
& =6.7 \mathrm{M} \Omega \| 4 \mathrm{M} \Omega=2.5 \mathrm{M} \Omega
\end{aligned}
$$

Thus the dominant pole has a frequency $f_{P}$ given by

$$
f_{P}=\frac{1}{2 \pi C_{\text {in }} R_{t}}=4.1 \mathrm{~Hz}
$$

It should be noted that this approach is equivalent to using the approximate formula in Eq. (11.93).

Figure 13.29 Bode plot for the 741 gain, neglecting nondominant poles.

As discussed in Section 11.10.3, Miller compensation provides an additional advantageous effect, namely, pole splitting. As a result, the other poles of the circuit are moved to very high frequencies. This has been confirmed by computer-aided analysis (see Gray et al., 2000).

Assuming that all nondominant poles are at very high frequencies, the calculated values give rise to the Bode plot shown in Fig. 13.29, where $f_{3 \mathrm{~dB}}=f_{p}$. The unity-gain bandwidth $f_{t}$ can be calculated from

$$
f_{t}=A_{0} f_{3 \mathrm{~dB}}
$$

Thus,

$$
f_{t}=243,147 \times 4.1 \simeq 1 \mathrm{MHz}
$$

Although this Bode plot implies that the phase shift at $f_{t}$ is $-90^{\circ}$ and thus that the phase margin is $90^{\circ}$, in practice a phase margin of about $80^{\circ}$ is obtained. The excess phase shift (about $10^{\circ}$ ) is due to the nondominant poles. This phase margin is sufficient to provide stable operation of closed-loop amplifiers with any value of feedback factor $\beta$. This convenience of use of the internally compensated 741 is achieved at the expense of a great reduction in open-loop gain and hence in the amount of negative feedback. In other words, if one requires a closed-loop amplifier with a gain of 1000 , then the 741 is overcompensated for such an application, and one would be much better off designing one's own compensation (assuming, of course, the availability of an op amp that is not already internally compensated).

A Simplified Model The simplified model of the 741 op amp shown in Fig. 13.30 is similar to what we used for the CMOS two-stage op amp (Section 13.1.5). Here, however, the high-gain second stage, with its feedback capacitance $C_{C}$, is modeled by an ideal integrator. In this model, the gain of the second stage is assumed to be sufficiently large that a virtual ground appears at its input. For this reason the output resistance of the input stage and the input resistance of the second stage have been omitted. Furthermore, the output stage is assumed to be an ideal unity-gain follower. (Of course, the two-stage CMOS amplifier does not have an output stage.)


Figure 13.30 A simple model for the 741 based on modeling the second stage as an integrator.

Analysis of the model in Fig. 13.30 gives

$$
A(s) \equiv \frac{V_{o}(s)}{V_{i}(s)}=\frac{G_{m 1}}{s C_{C}}
$$

Thus,

$$
A(j \omega)=\frac{G_{m 1}}{j \omega C_{C}}
$$

and the magnitude of gain becomes unity at $\omega=\omega_{t}$, where

$$
\omega_{t}=\frac{G_{m 1}}{C_{C}}
$$

Substituting $G_{m 1}=0.19 \mathrm{~mA} / \mathrm{V}$ and $C_{C}=30 \mathrm{pF}$ yields

$$
f_{t}=\frac{\omega_{t}}{2 \pi} \simeq 1 \mathrm{MHz}
$$

which is equal to the value calculated before. It should be pointed out, however, that this model is valid only at frequencies $f \gg f_{\text {MB }}$. At such frequencies, the gain falls off with a slope of $-20 \mathrm{~dB} /$ decade (Fig. 13.29), just like that of an integrator.

# 13.3.5 Slew Rate 

The slew-rate limitation of op amps is discussed in Chapter 2, and expressions for $S R$ are derived for the two-stage CMOS op amp in Section 13.1 and for the folded-cascode CMOS op amp in Section 13.2. The 741 slewing is very similar to that of the two-stage CMOS op amp. Thus, following an identical procedure, we can show that for the 741 op amp,

$$
S R=\frac{2 I}{C_{C}}
$$

when $2 I$ is the total bias current of the input differential stage. ${ }^{7}$ For the $741, I=9.5 \mu \mathrm{~A}$, and $C_{C}=30 \mathrm{pF}$, resulting in $S R=0.63 \mathrm{~V} / \mu \mathrm{s}$.

[^0]
[^0]:    ${ }^{7}$ Note that in the CMOS two-stage op amp, the total bias current of the input stage is denoted $I$; hence the apparent discrepancy between the expressions in Eqs. (13.125) and (13.45).
Also, as we have done for the two-stage CMOS op amp, we can derive a relationship between $S R$ and $\omega_{t}$. For the 741 case, we can show that

$$
S R=4 V_{T} \omega_{t}
$$

where $V_{T}$ is the thermal voltage (approximately 25 mV at room temperature). As a check, for the 741 we have

$$
S R=4 \times 25 \times 10^{-3} \times 2 \pi \times 10^{6}=0.63 \mathrm{~V} / \mu \mathrm{s}
$$

which is the result obtained previously. Observe that Eq. (13.126) is of the same form as Eq. (13.47), which applies to the two-stage CMOS op amp. Here, $4 V_{T}$ replaces $V_{O V}$. Since, typically, $V_{O V}$ will be two to three times the value of $4 V_{T}$, a two-stage CMOS op amp with an $f_{t}$ equal to that of the 741 exhibits a slew rate that is two to three times as large as that of the 741 .

# EXERCISE 

13.36 Use the value of the slew rate calculated above to find the full-power bandwidth $f_{M}$ of the 741 op amp. Assume that the maximum output is $\pm 10 \mathrm{~V}$.
Ans. 10 kHz

## (3) 13.4 Modern Techniques for the Design of BJT Op Amps

Although the ingenious techniques employed in the design of the 741 op amp have stood the test of time, they are now more than 40 years old! Technological advances have resulted in changes in the user requirements of general-purpose bipolar op amps. The resulting more demanding specifications have in turn posed new challenges to analog IC designers, who, as they have done repeatedly before, are responding with new and exciting circuits. In this section we present a sample of recently developed design techniques. For more on this rather advanced topic the reader is referred to the Analog Circuits section of the bibliography in Appendix I.

### 13.4.1 Special Performance Requirements

Many of the special performance requirements stem from the need to operate modern op amps from power supplies of much lower voltages. Thus while the 741-type op amp operated from $\pm 15-\mathrm{V}$ power supplies, many modern BJT op amps are required to operate from a single power supply of only 2 V to 3 V . This is done for a number of reasons, including the following.

1. Modern small-feature-size IC fabrication technologies require low power-supply voltages.
2. Compatibility must be achieved with other parts of the system that use low-voltage supplies.
3. Power dissipation must be minimized, especially for battery-operated equipment.


Figure 13.31 Power-supply requirements have changed considerably. Modern BJT op amps are required to operate from a single supply $V_{C C}$ of 2 V to 3 V .

As Fig. 13.31 indicates, there are two important changes: the use of a single ground-referenced power supply $V_{C C}$, and the low value of $V_{C C}$. Both of these requirements give rise to changes in performance specifications and pose new design challenges. In the following we discuss two of the resulting changes.

Rail-to-Rail Input Common-Mode Range Recall that the input common-mode range of an op amp is the range of common-mode input voltages for which the op amp operates properly and meets its performance specifications, such as voltage gain and CMRR. Op amps of the 741 type operate from $\pm 15-\mathrm{V}$ supplies and exhibit an input common-mode range that extends to within a couple of volts of each supply. Such a gap between the input common-mode range and the power supply is obviously unacceptable if the op amp is to be operated from a single supply that is only 2 V to 3 V . Indeed we will now show that these single-supply, low-voltage op amps need to have an input common-mode range that extends over the entire supply voltage, 0 to $V_{C C}$, referred to as rail-to-rail input common-mode range.

Consider first the inverting op-amp configuration shown in Fig. 13.32(a). Since the positive input terminal is connected to ground (which is the voltage of the negative supply rail), ground voltage has to be within the allowable input common-mode range. In fact, because for positive output voltages the voltage at the inverting input terminal can go slightly negative, the input common-mode range should extend below the negative supply rail (ground).

Next consider the unity-gain voltage follower obtained by applying $100 \%$ negative feedback to an op amp, as shown in Fig. 13.32(b). Here the input common-mode voltage is equal to the input signal $v_{I}$. To maximize the usefulness of this buffer amplifier, its input signal $v_{I}$ should be allowed to extend from 0 to $V_{C C}$, especially since $V_{C C}$ is only 2 V to 3 V . Thus the input common-mode range should include also the positive supply rail. As will be seen shortly, modern BJT op amps can operate over an input common-mode voltage range that extends a fraction of a volt beyond its two supply rails: that is, more than rail-to-rail operation!

(a)

(b)

Figure 13.32 (a) In the inverting configuration, the positive op-amp input is connected to ground; thus it is imperative that the input common-mode range includes ground voltage. (b) In the unity-gain follower configuration, $v_{I C M}=v_{I}$; thus it is highly desirable for the input common-mode range to include ground voltage and $V_{C C}$.
Near Rail-to-Rail Output Signal Swing In the 741 op amp, we were satisfied with an output that can swing to within 2 V or so of each of the supply rails. With a supply of $\pm 15 \mathrm{~V}$, this capacity resulted in a respectable $\pm 13-\mathrm{V}$ output range. However, to limit the output swing to within 2 V of the supply rails in an op amp operating from a single $3-\mathrm{V}$ supply would result in an unusable device! Thus, here too, we require near rail-to-rail operation. As we shall see in Section 13.4.5, this requirement forces us to adopt a whole new approach to output-stage design.

Device Parameters The technology we shall use in the examples, exercises, and problems for this section has the following characteristics:

$$
\begin{array}{ll}
\text { npn transistors: } & \beta=40 \quad V_{A}=30 \mathrm{~V} \\
\text { pnp transistors: } & \beta=10 \quad\left|V_{A}\right|=20 \mathrm{~V}
\end{array}
$$

For both, $\left|V_{B E}\right| \simeq 0.7 \mathrm{~V}$ and $\left|V_{C E s a t}\right| \simeq 0.1 \mathrm{~V}$. It is important to note that we will assume that for this technology, the transistor will remain in the active mode for $\left|V_{C E}\right|$ as low as 0.1 V (in other words, that 0.6 V is needed to forward-bias the CBJ).

# 13.4.2 Bias Design 

As in the 741 circuit, the bias design of modern BJT amplifiers makes extensive use of current mirrors and current-steering circuits (Sections 8.2 and 8.6). Typically, however, the bias currents are small (in the microamp range). Thus, the Widlar current source (Section 8.6.4) is especially popular here. As well, emitter-degeneration resistors (in the tens-of-kilohm range) are frequently used.

Figure 13.33 shows a self-biased current-reference source that utilizes a Widlar circuit formed by $Q_{1}, Q_{2}$, and $R_{2}$, and a current mirror $Q_{3}-Q_{4}$ with matched emitter-degeneration resistors $R_{3}$ and $R_{4}$. The circuit establishes a current $I$ in each of the four transistors, with the value of $I$ determined as follows. Neglecting base currents and $r_{o}$ 's for simplicity, we write

$$
\begin{aligned}
& V_{B E 1}=V_{T} \ln \left(\frac{I}{I_{S 1}}\right) \\
& V_{B E 2}=V_{T} \ln \left(\frac{I}{I_{S 2}}\right)
\end{aligned}
$$



Figure 13.33 A self-biased current-reference source utilizing a Widlar circuit to generate $I=\left(V_{x} / R_{2}\right) \ln \left(I_{S 2} / I_{S 1}\right)$. The bias voltages $V_{\text {BIAS } 1}$ and $V_{\text {BIAS } 2}$ are utilized in other parts of the op-amp circuit for biasing other transistors.
Thus,

$$
V_{B E 1}-V_{B E 2}=V_{T} \ln \left(\frac{I_{S 2}}{I_{S 1}}\right)
$$

But,

$$
V_{B E 1}-V_{B E 2}=I R_{2}
$$

Thus,

$$
I=\frac{V_{T}}{R_{2}} \ln \left(\frac{I_{S 2}}{I_{S 1}}\right)
$$

Thus the value of $I$ is determined by $R_{2}$ and the ratio of the emitter areas of $Q_{1}$ and $Q_{2}$. Also, observe that $I$ is independent of $V_{C C}$, a highly desirable outcome. Neglecting the temperature dependence of $R_{2}$, we see that $I$ is directly PTAT (proportional to the absolute temperature $T$ ). It follows that transistors biased by $I$ or mirrored versions of it will exhibit $g_{m}{ }^{*}$ s that are constant independent of temperature!

# EXERCISE 

D13.37 Design the circuit in Fig. 13.33 to generate a current $I=10 \mu \mathrm{~A}$. Utilize transistors $Q_{1}$ and $Q_{2}$ having their areas in a 1:2 ratio. Assume that $Q_{3}$ and $Q_{4}$ are matched and design for a $0.2-\mathrm{V}$ drop across each of $R_{3}$ and $R_{4}$. Specify the values of $R_{2}, R_{3}$, and $R_{4}$.
Ans. $1.73 \mathrm{k} \Omega ; 20 \mathrm{k} \Omega ; 20 \mathrm{k} \Omega$

The circuit in Fig. 13.33 provides a bias line $V_{\text {BIAS1 }}$ with a voltage equal to $V_{B E 1}$. This can be used to bias other transistors and thus generate currents proportional to $I$ by appropriately scaling their emitter areas. Similarly, the circuit provides a bias line $V_{\text {BIAS2 }}$ at a voltage $\left(I R_{3}+V_{E R 3}\right)$ below $V_{C C}$. This bias line can be used to bias other transistors and thus generate constant currents proportional to $I$ by appropriately scaling emitter areas and emitter-degeneration resistances. These ideas are illustrated in Fig. 13.34.

## EXERCISE

D13.38 Refer to the circuit in Fig. 13.34 and assume that the $V_{\text {BIAS2 }}$ line is connected to the corresponding line in Fig. 13.33. It is required to generate currents $I_{8}=10 \mu \mathrm{~A}, I_{9}=20 \mu \mathrm{~A}$, and $I_{10}=5 \mu \mathrm{~A}$. Specify the required emitter areas of $Q_{8}, Q_{9}$, and $Q_{10}$ as ratios of the emitter area of $Q_{3}$. Also specify the values required for $R_{8}, R_{9}$, and $R_{10}$. Use the values of $R_{3}$ and $R_{4}$ found in Exercise 13.37. Ignore base currents.

Ans. 1, 2, 0.5; $20 \mathrm{k} \Omega, 10 \mathrm{k} \Omega, 40 \mathrm{k} \Omega$


Figure 13.34 The bias lines $V_{\text {BIAS1 }}$ and $V_{\text {BIAS2 }}$ provided by the circuit in Fig. 13.33 are utilized to bias other transistors and generate constant currents $I_{s}$ to $I_{i n}$. Both the transistor area and the emitter-degeneration resistance value have to be appropriately scaled.

# 13.4.3 Design of the Input Stage to Obtain Rail-to-Rail $V_{I C M}$ 

The classical differential input stage with current-mirror load is shown in Fig. 13.35(a). This is essentially the core of the 741 input stage, except that here we are using a single positive power supply. As well, the CMOS counterpart of this circuit is utilized in nearly every CMOS op-amp design (see Section 13.1). Unfortunately, this very popular circuit does not meet our requirement of rail-to-rail common-mode operation.

Consider first the low end of the input common-mode range. The value of $V_{I C M \text { min }}$ is limited by the need to keep $Q_{1}$ in the active mode. Specifically, since the collector of $Q_{1}$ is at a voltage $V_{B E 3} \simeq 0.7 \mathrm{~V}$, we see that the voltage applied to the base of $Q_{1}$ cannot go lower than 0.1 V without causing the collector-base junction of $Q_{1}$ to become forward biased.


Figure 13.35 For the input commonmode range to include ground voltage, the classical current-mirror-loaded input stage in (a) has to be replaced with the resistively loaded configuration in (b) with the dc voltage drop across $R_{C}$ limited to 0.2 V to 0.3 V .
Thus $V_{I C M \min }=0.1 \mathrm{~V}$, and the input common-mode range does not include ground voltage as required.

The only way to extend $V_{I C M \text { min }}$ to 0 V is to lower the voltage at the collector of $Q_{1}$. This in turn can be achieved only by abandoning the use of the current-mirror load and utilizing instead resistive loads, as shown in Fig. 13.35(b). Observe that in effect we are going back to the resistively loaded differential pair with which we began our study of differential amplifiers in Chapter 9!

The minimum allowed value of $V_{I C M}$ in the circuit of Fig. 13.35(b) is still of course limited by the need to keep $Q_{1}$ and $Q_{2}$ in the active mode. This in turn is achieved by avoiding $V_{I C M}$ values that cause the base voltages of $Q_{1}$ and $Q_{2}$ to go below their collector voltages by more than 0.6 V ,

$$
V_{I C M \min }=V_{R_{C}}-0.6 \mathrm{~V}
$$

where $V_{R_{C}}$ is the voltage drop across each of $R_{C 1}$ and $R_{C 2}$. Now if $V_{R_{C}}$ is selected to be 0.2 V to 0.3 V , then $V_{I C M \text { min }}$ will be -0.4 V to -0.3 V , which is exactly what we need.

The major drawback of replacing the current-mirror load with resistive loads is that the differential gain realized is considerably reduced,

$$
\begin{aligned}
\frac{v_{o}}{v_{i d}} & =-g_{m 1,2} R_{C} \\
& =-\frac{I / 2}{V_{T}} R_{C}=-\frac{V_{R_{C}}}{V_{T}}
\end{aligned}
$$

where we have neglected $r_{o}$ for simplicity. Thus for $V_{R_{C}}=0.3 \mathrm{~V}$, the gain realized is only $12 \mathrm{~V} / \mathrm{V}$. As we will see shortly, this low-gain problem can be solved by cascoding.

Next consider the upper end of the input common-mode range. Reference to the circuit in Fig. 13.35(b) shows that the maximum voltage that can be applied to the bases of $Q_{1}$ and $Q_{2}$ is limited by the need to keep the current-source transistor in the active mode. This in turn is achieved by ensuring that the voltage across $Q_{5}, V_{E C 5}$, does not fall below 0.1 V or so. Thus the maximum value of $V_{I C M}$ will be a voltage $V_{E B 1,2}$ or approximately 0.7 V lower,

$$
V_{I C M \max }=V_{C C}-0.1-0.7=V_{C C}-0.8
$$

That is, the upper end of the input common-mode range is at least 0.8 V below $V_{C C}$, a severe limitation.

To recap, while the circuit in Fig. 13.35(b) has $V_{I C M \text { min }}$ of a few tenths of a volt below the negative power-supply rail (at ground voltage), the upper end of $V_{I C M}$ is rather far from $V_{C C}$,

$$
-0.3 \leq V_{I C M} \leq V_{C C}-0.8
$$

where we have assumed $V_{R_{C}}=0.3 \mathrm{~V}$. To extend the upper end of $V_{I C M}$, we adopt a solution similar to that used in the CMOS case (Section 13.2.6, Fig. 13.12), namely, we utilize a parallel complementary input stage. Toward that end, note that the $n p n$ version of the circuit of Fig. 13.35(b), shown in Fig. 13.36, has a common-input range of

$$
0.8 \leq V_{I C M} \leq V_{C C}+0.3
$$

where we have assumed that $V_{R_{C}}=0.3 \mathrm{~V}$. Thus, as expected, the high end meets our specifications and in fact is above the positive supply rail by 0.3 V . The lower end, however, does not, but this should cause us no concern because the lower end will be looked after by the


Figure 13.36 The complement of the circuit in Fig. 13.35(b). While the input common-mode range of the circuit in Figure 13.35(b) extends below ground, here it extends above $V_{C C}$. Connecting the two circuits in parallel, as will be shown, results in a rail-to-rail $V_{I C M}$ range.
$p n p$ pair. Finally, note that there is a range of $V_{I C M}$ in which both the $p n p$ and the $n p n$ circuits will be active and properly operating,

$$
0.8 \leq V_{I C M} \leq V_{C C}-0.8
$$

Figure 13.37 shows an input stage that achieves more than rail-to-rail input common-mode range by utilizing a $p n p$ differential pair $\left(Q_{1}, Q_{2}\right)$ and an $n p n$ differential pair $\left(Q_{3}, Q_{4}\right)$, connected in parallel. To keep the diagram simple, we are not showing the parallel connection of the input terminals; the + input terminals are assumed to be connected together, and similarly for the - input terminals. In order to increase the gain obtained from the resistively loaded differential pairs, a folded-cascode stage is added. Here $R_{7}$ and $R_{8}$ are the resistive loads of the $p n p$ pair $Q_{1}-Q_{2}$, and $Q_{7}-Q_{8}$ are its cascode transistors. Similarly, $R_{9}$ and $R_{10}$ are


Figure 13.37 Input stage with rail-to-rail input common-mode range and a folded-cascode stage to increase the gain. Note that all the bias voltages including $V_{\text {BIAS3 }}$ and $V_{B}$ are generated elsewhere on the chip.
the resistive loads of the $n p n$ pair $Q_{3}-Q_{4}$, and $Q_{9}-Q_{10}$ are its cascode transistors. Observe that the cascode transistors do "double duty." For instance, $Q_{7}-Q_{8}$ operate as the cascode devices for $Q_{1}-Q_{2}$ and at the same time as current-source loads for $Q_{9}-Q_{10}$. A similar statement can be made about $Q_{9}-Q_{10}$. The output voltage of the first stage, $v_{o d}$, is taken between the collectors of the cascode devices.

For $V_{I C M} \ll 0.8 \mathrm{~V}$, the $n p n$ stage will be inactive and the gain is determined by the transconductance $G_{m}$ of the $Q_{1}-Q_{2}$ pair together with the output resistance seen between the collectors of the cascode transistors. At the other end of $V_{I C M}$, that is, $V_{I C M} \gg V_{C C}-0.8$, the $Q_{1}-Q_{2}$ stage will be inactive, and the gain will be determined by the transconductance $G_{m}$ of the $Q_{3}-Q_{4}$ pair and the output resistance between the collectors of the cascode devices. In the overlap region $0.8 \leq V_{I C M} \leq V_{C C}-0.8$, both the pnp and npn stages will be active and their effective transconductances $G_{m}$ add up, thus resulting in a higher gain. The dependence of the differential gain on the input common-mode $V_{I C M}$ is usually undesirable and can be reduced considerably by arranging that one of the two differential pairs is turned off when the other one is active. ${ }^{8}$

# Example 13.7 

It is required to find the input resistance and the voltage gain of the input stage shown in Fig. 13.37. Let $V_{I C M} \ll 0.8 \mathrm{~V}$ so that the $Q_{3}-Q_{4}$ pair is off. Assume that $Q_{5}$ supplies $10 \mu \mathrm{~A}$, that each of $Q_{7}$ to $Q_{10}$ is biased at $10 \mu \mathrm{~A}$, and that all four cascode transistors are operating in the active mode. The input resistance of the second stage of the op amp (not shown) is $R_{L}=2 \mathrm{M} \Omega$. The emitter-degeneration resistances are $R_{7}=R_{8}=20 \mathrm{k} \Omega$, and $R_{9}=R_{10}=30 \mathrm{k} \Omega$. Recall that the device parameters are $\beta_{N}=40, \beta_{P}=10$, $V_{A n}=30 \mathrm{~V},\left|V_{A p}\right|=20 \mathrm{~V}$.

## Solution

Since the stage is fully balanced, we can use the differential half-circuit shown in Fig. 13.38(a). The input resistance $R_{s d}$ is twice the value of $r_{n 1}$,

$$
R_{s d}=2 r_{n 1}=2 \beta_{P} / g_{m 1}
$$

where

$$
g_{m 1}=\frac{I_{C 1}}{V_{T}}=\frac{5 \times 10^{-6}}{25 \times 10^{-3}}=0.2 \mathrm{~mA} / \mathrm{V}
$$

Thus,

$$
R_{s d}=\frac{2 \times 10}{0.2}=100 \mathrm{k} \Omega
$$

To find the short-circuit transconductance, we short the output to ground as shown in Fig. 13.38(b) and find $G_{m 1}$ as

$$
G_{m 1}=\frac{i_{o}}{v_{o d} / 2}
$$

[^0]
[^0]:    ${ }^{8}$ This is done in the NE5234 op amp, whose circuit is described and analyzed in great detail in Gray et al. (2009).Example 13.7 continued

(a)

(b)

Figure 13.38 (a) Differential half-circuit for the input stage shown in Fig. 13.37 with $V_{B / M} \ll 0.8 \mathrm{~V}$. (b) Determining $G_{m 1}=i_{o} /\left(v_{s d} / 2\right)$

At node $X$ we have four parallel resistances to ground,

$$
\begin{aligned}
& r_{o 1}=\frac{\left|V_{A p}\right|}{I_{C 1}}=\frac{20 \mathrm{~V}}{5 \mu \mathrm{~A}}=4 \mathrm{M} \Omega \\
& R_{7}=20 \mathrm{k} \Omega \\
& r_{o 7}=\frac{V_{A n}}{I_{C 7}}=\frac{30 \mathrm{~V}}{10 \mu \mathrm{~A}}=3 \mathrm{M} \Omega \\
& r_{o 7} \simeq \frac{1}{g_{m 7}}=\frac{V_{T}}{I_{C 7}}=\frac{25 \mathrm{mV}}{10 \mu \mathrm{~A}}=2.5 \mathrm{k} \Omega
\end{aligned}
$$

Obviously $r_{o 1}$ and $r_{o 7}$ are very large and can be neglected. Then, the portion of $g_{m 1}\left(v_{s d} / 2\right)$ that flows into the emitter proper of $Q_{7}$ can be found from

$$
\begin{aligned}
i_{o 7} & \simeq g_{m 1}\left(\frac{v_{s d}}{2}\right) \frac{R_{7}}{R_{7}+r_{o 7}} \\
& =g_{m 1}\left(\frac{v_{s d}}{2}\right) \frac{20}{20+2.5}=0.89 g_{m 1}\left(\frac{v_{s d}}{2}\right)
\end{aligned}
$$

and the output short-circuit current $i_{o}$ is

$$
i_{o} \simeq i_{o 7}=0.89 g_{m 1}\left(v_{s d} / 2\right)
$$
Thus,

$$
G_{m 1}=\frac{i_{o}}{v_{i g} / 2}=0.89 g_{m 1}=0.89 \times 0.2=0.18 \mathrm{~mA} / \mathrm{V}
$$

To find the voltage gain we need to determine the total resistance between the output node and ground for the circuit in Fig. 13.38(a),

$$
R=R_{o 9}\left\|R_{o 7}\right\|\left(R_{L} / 2\right)
$$

The resistance $R_{o 9}$ is the output resistance of $Q_{9}$, which has an emitter-degeneration resistance $R_{9}$. Thus $R_{o 9}$ can be found using Eq. (8.68),

$$
R_{o 9}=r_{o 9}+\left(R_{9} \| r_{\pi 9}\right)\left(1+g_{m 9} r_{o 9}\right)
$$

where

$$
\begin{aligned}
& r_{o 9}=\frac{\left|V_{A p}\right|}{I_{C 9}}=\frac{20 \mathrm{~V}}{10 \mu \mathrm{~A}}=2 \mathrm{M} \Omega \\
& g_{m 9}=\frac{I_{C 9}}{V_{T}}=\frac{10 \mu \mathrm{~A}}{25 \mathrm{mV}}=0.4 \mathrm{~mA} / \mathrm{V} \\
& r_{\pi 9}=\frac{\beta_{P}}{g_{m 9}}=\frac{10}{0.4 \mathrm{~mA} / \mathrm{V}}=25 \mathrm{k} \Omega
\end{aligned}
$$

Thus

$$
\begin{aligned}
R_{o 9} & =2+(30 \| 25) \times 10^{-3}\left(1+0.4 \times 2 \times 10^{3}\right) \\
& =12.9 \mathrm{M} \Omega
\end{aligned}
$$

The resistance $R_{o 7}$ is the output resistance of $Q_{7}$, which has an emitter-degeneration resistance $\left(R_{7} \| r_{o 1}\right) \simeq$ $R_{7}$. Thus,

$$
R_{o 7}=r_{o 7}+\left(R_{7} \| r_{\pi 7}\right)\left(1+g_{m 7} r_{o 7}\right)
$$

where

$$
\begin{aligned}
& r_{o 7}=\frac{V_{A n}}{I_{C 7}}=\frac{30 \mathrm{~V}}{10 \mu \mathrm{~A}}=3 \mathrm{M} \Omega \\
& g_{m 7}=\frac{I_{C 7}}{V_{T}}=\frac{10 \mu \mathrm{~A}}{25 \mathrm{mV}}=0.4 \mathrm{~mA} / \mathrm{V} \\
& r_{\pi 7}=\frac{\beta_{N}}{g_{m 7}}=\frac{40}{0.4}=100 \mathrm{k} \Omega
\end{aligned}
$$

Thus,

$$
\begin{aligned}
R_{o 7} & =3+(20\|100) \times 10^{-3}\left(1+0.4 \times 3 \times 10^{3}\right) \\
& =23 \mathrm{M} \Omega \\
\frac{R_{L}}{2} & =\frac{2 \mathrm{M} \Omega}{2}=1 \mathrm{M} \Omega
\end{aligned}
$$
# Example 13.7 continued 

The total resistance $R$ can now be found as

$$
R=12.9\|23\| 1=0.89 \mathrm{M} \Omega
$$

Finally, we can find the voltage gain as

$$
\begin{aligned}
A_{d} & =\frac{v_{o d} / 2}{v_{o d} / 2}=G_{m 1} R \\
& =0.18 \times 0.89 \times 10^{3}=160 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

### 13.4.4 Common-Mode Feedback to Control the DC Voltage at the Output of the Input Stage

For the cascode circuit in Fig. 13.37 to operate properly and provide high output resistance and thus high voltage gain, the cascode transistors $Q_{7}$ through $Q_{10}$ must operate in the active mode at all times. However, relying solely on matching will not be sufficient to ensure that the currents supplied by $Q_{8}$ and $Q_{10}$ are exactly equal to the currents supplied by $Q_{7}$ and $Q_{8}$. Any small mismatch $\Delta I$ between the two sets of currents will be multiplied by the large output resistance between each of the collector nodes and ground, and thus there will be large changes in the voltages $v_{O 1}$ and $v_{O 2}$. These changes in turn can cause one set of the current sources (i.e., $Q_{7}-Q_{8}$ or $Q_{9}-Q_{10}$ ) to saturate. We therefore need a circuit that detects the change in the dc or common-mode component $V_{C M}$ of $v_{O 1}$ and $v_{O 2}$,

$$
V_{C M}=\frac{1}{2}\left(v_{O 1}+v_{O 2}\right)
$$

and adjusts the bias voltage on the bases of $Q_{7}$ and $Q_{8}, V_{B}$, to restore current equality. This negative-feedback loop should be insensitive to the differential signal components of $v_{O 1}$ and $v_{O 2}$; otherwise it would reduce the differential gain. Thus the feedback loop should provide common-mode feedback (CMF).

Figure 13.39 shows the cascode circuit with the CMF circuit as a black box. The CMF circuit accepts $v_{O 1}$ and $v_{O 2}$ as inputs and provides the bias voltage $V_{B}$ as output. In a particular implementation we will present shortly, the CMF circuit has the transfer characteristic

$$
V_{B}=V_{C M}+0.4
$$

By keeping $V_{B}$ higher than $V_{C M}$ by only 0.4 V , the CMF circuit ensures that $Q_{7}$ and $Q_{8}$ remain active ( 0.6 V is needed for saturation).

The nominal value of $V_{B}$ is determined by the quiescent current of $Q_{7}$ through $Q_{10}$, the quiescent value of $I_{1}$ and $I_{2}$, and the value of $R_{7}$ and $R_{8}$. The resulting nominal value of $V_{B}$ and the corresponding value of $V_{C M}$ from Eq. (13.129) are designed to ensure that $Q_{9}$ and $Q_{10}$ operate in the active mode. Here, it is important to recall that $V_{\text {BIAS3 }}$ is determined by the rest of the op-amp bias circuit.


Figure 13.39 The cascode output circuit of the input stage and the CMF circuit that responds to the common-mode component $V_{C M}=\frac{1}{2}\left(v_{O 1}+v_{O 2}\right)$ by adjusting $V_{B}$ so that $Q_{7}-Q_{8}$ conduct equal currents to $Q_{9}-Q_{10}$, and $Q_{7}-Q_{10}$ operate in the active mode.

To see how the CMF circuit regulates the dc voltage $V_{C M}$, assume that for some reason $V_{B}$ is higher than it should be and as a result the currents of $Q_{7}$ and $Q_{8}$ exceed the currents supplied by $Q_{9}$ and $Q_{10}$ by an increment $\Delta I$. When multiplied by the total resistance between each of the output nodes and ground, the increment $\Delta I$ will result in a large negative voltage increment in $v_{O 1}$ and $v_{O 2}$. The CMF circuit responds by lowering $V_{B}$ to the value that restores the equality of currents. The change in $V_{B}$ needed to restore equilibrium is usually small (see Example 13.8 below) and according to Eq. (13.129) the corresponding change in $V_{C M}$ will be equally small. Thus we see negative feedback in action: It minimizes the initial change and thus keeps $V_{C M}$ nearly constant at its nominal value, which is designed to operate $Q_{7}$ through $Q_{10}$ in the active region.

We conclude by considering briefly a possible implementation of the CMF circuit. Figure 13.40 shows the second stage of an op-amp circuit. The circuit is fed by the outputs of the input stage, $v_{O 1}$ and $v_{O 2}$,

$$
\begin{aligned}
& v_{O 1}=V_{C M}+v_{d} / 2 \\
& v_{O 2}=V_{C M}-v_{d} / 2
\end{aligned}
$$

In addition to amplifying the differential component of $v_{d}$, the circuit generates a dc voltage $V_{B}$,

$$
V_{B}=V_{C M}+0.4
$$

To see how the circuit works, note that $Q_{11}$ and $Q_{12}$ are emitter followers that minimize the loading of the second stage on the input stage. The emitter followers deliver to the bases of the differential pair $Q_{13}-Q_{14}$ voltages that are almost equal to $v_{O 1}$ and $v_{O 2}$ but dc shifted


Figure 13.40 An op-amp second stage incorporating the common-mode feedback circuit for the input stage. Note that the circuit generates the voltage $V_{B}$ needed to bias the cascode circuit in the first stage. Diode $D$ is a Schottky-barrier diode, which exhibits a forward voltage drop of about 0.4 V .
by $V_{E B 11,12}$. Thus the voltage at the emitters of $Q_{13}-Q_{14}$ will be

$$
V_{E}=V_{C M}+V_{E B 11,12}-V_{B E 13,14}
$$

which reduces to

$$
V_{E} \simeq V_{C M}
$$

The voltage $V_{B}$ is simply equal to $V_{E}$ plus the voltage drop of diode $D_{1}$. The latter is a Schottky-barrier diode (SBD), which features a low forward drop of about 0.4 V . Thus,

$$
V_{B}=V_{E}+V_{D}=V_{C M}+0.4
$$

as required.

# Example 13.8 

Consider the operation of the circuit in Fig. 13.39. Assume that $V_{I C M} \ll 0.8 \mathrm{~V}$ and thus the $n p n$ input pair (Fig. 13.37) is off. Hence $I_{3}=I_{4}=0$. Also assume that only dc voltages are present and thus $I_{1}=I_{2}=5 \mu \mathrm{~A}$. Each of $Q_{7}$ to $Q_{10}$ is biased at $10 \mu \mathrm{~A}, V_{C C}=3 \mathrm{~V}, V_{\text {BIAS3 }}=V_{C C}-1, R_{7}=R_{8}=20 \mathrm{k} \Omega$, and $R_{9}=R_{10}=30 \mathrm{k} \Omega$. Neglect base currents and neglect the loading effect of the CMF circuit on the output nodes of the cascode circuit. The CMF circuit provides $V_{B}=V_{C M}+0.4$.
(a) Determine the nominal values of $V_{B}$ and $V_{C M}$. Does the value of $V_{C M}$ ensure operation in the active mode for $Q_{7}$ through $Q_{10}$ ?
(b) If the CMF circuit were not present, what would be the change in $v_{O 1}$ and $v_{O 2}$ (i.e., in $V_{C M}$ ) as a result of a current mismatch $\Delta I=0.3 \mu \mathrm{~A}$ between $Q_{7}-Q_{8}$ and $Q_{9}-Q_{10}$ ? Use the output resistance values found in Example 13.7.
(c) Now, if the CMF circuit is connected, what change will it cause in $V_{B}$ to eliminate the current mismatch $\Delta I$ ? What is the corresponding change in $V_{C M}$ from its nominal value?

# Solution 

(a) The nominal value of $V_{B}$ is found as follows:

$$
\begin{aligned}
V_{B} & =V_{B E 7}+\left(I_{E 7}+I_{1}\right) R_{7} \\
& \simeq 0.7+(10+5) \times 10^{-3} \times 20 \\
& =1 \mathrm{~V}
\end{aligned}
$$

The nominal value of $V_{C M}$ can now be found from

$$
V_{C M}=V_{B}-0.4=1-0.4=0.6 \mathrm{~V}
$$

For $Q_{7}-Q_{8}$ to be active,

$$
V_{C M}>V_{B 7.8}-0.6
$$

that is,

$$
V_{C M}>0.4 \mathrm{~V}
$$

For $Q_{9}-Q_{10}$ to be active

$$
V_{C M}<V_{\text {BIAS3 }}+0.6
$$

That is,

$$
V_{C M}<V_{C C}-1+0.6
$$

resulting in

$$
V_{C M}<2.6 \mathrm{~V}
$$

Thus, for all four cascode transistors to operate in the active mode,

$$
0.4 \mathrm{~V}<V_{C M}<2.6 \mathrm{~V}
$$

Thus the nominal value of 0.6 V ensures active-mode operation.
# Example 13.8 continued 

(b) For $I_{C 9}-I_{C 7}=I_{C 10}-I_{C 8}=\Delta I$,

$$
\Delta V_{C M}=\Delta I R_{o 1}
$$

where $R_{o 1}$ is the output resistance between the collectors of $Q_{7}$ and $Q_{9}$ and ground,

$$
R_{o 1}=R_{o 7} \| R_{o 9}
$$

In Example 13.7 we found that $R_{o 7}=23 \mathrm{M} \Omega$ and $R_{o 9}=12.9 \mathrm{M} \Omega$; thus,

$$
R_{o 1}=23 \| 12.9=8.3 \mathrm{M} \Omega
$$

Thus,

$$
\Delta V_{C M}=0.3 \times 8.3 \simeq 2.5 \mathrm{~V}
$$

Now if $\Delta V_{C M}$ is positive,

$$
V_{C M}=0.6+2.5=3.1 \mathrm{~V}
$$

which exceeds the 2.6 V maximum allowed value before $Q_{9}-Q_{10}$ saturate. If $\Delta V_{C M}$ is negative,

$$
V_{C M}=0.6-2.5=-1.9 \mathrm{~V}
$$

which is far below the +0.4 V needed to keep $Q_{7}-Q_{8}$ in the active mode. Thus, in the absence of CMF, a current mismatch of $\pm 0.3 \mu \mathrm{~A}$ would cause one set of the cascode transistors (depending on the polarity of $\Delta I$ ) to saturate.
(c) With the CMF circuit in place, the feedback will adjust $V_{B}$ by $\Delta V_{B}$ so that the currents in $Q_{7}$ and $Q_{8}$ will change by an increment equal to $\Delta I$, thus restoring current equality. Since a change $\Delta V_{B}$ results in

$$
\Delta I_{C 7}=\Delta I_{C 8}=\frac{\Delta V_{B}}{r_{e 7}+R_{7}}
$$

then

$$
\begin{aligned}
\Delta I & =\frac{\Delta V_{B}}{r_{e 7}+R_{7}} \\
\Delta V_{B} & =\Delta I\left(r_{e 7}+R_{7}\right) \\
& =0.3 \mu \mathrm{~A}\left(\frac{25 \mathrm{mV}}{10 \mu \mathrm{~A}}+20 \mathrm{k} \Omega\right) \\
& =0.3 \times 22.5=6.75 \mathrm{mV}
\end{aligned}
$$

Correspondingly

$$
\Delta V_{C M}=\Delta V_{B}=6.75 \mathrm{mV}
$$

Thus, to restore the current equality, the change required in $V_{B}$ and $V_{C M}$ is only 6.75 mV .
# 13.4.5 Output-Stage Design for Near Rail-to-Rail Output Swing 

As mentioned earlier, modern low-voltage bipolar op amps cannot afford to use the classical emitter-follower-based class AB output stage, which would consume too much of the power-supply voltage. Instead, a complementary pair of common-emitter transistors are utilized, as shown in Fig. 13.41. The output transistors $Q_{P}$ and $Q_{N}$ are operated in a class AB fashion. Typically, $i_{L}$ can be as high as 10 mA to 15 mA and is determined by $v_{O}$ and $R_{L}$. For $i_{L}=0, i_{P}=i_{N}=I_{Q}$, where the quiescent current $I_{Q}$ is normally a fraction of a milliamp.

The output stage in Fig. 13.41 is driven by two separate but equal signals, $v_{B P}$ and $v_{B N}$. When $v_{B P}$ and $v_{B N}$ are high, $Q_{N}$ supplies the load current in the direction opposite to that shown ${ }^{9}$ and the output voltage $v_{O}$ can swing to within 0.1 V or so of ground. In the meantime, $Q_{P}$ is inactive. Nevertheless, in order to minimize crossover distortion, $Q_{P}$ is prevented from turning off and is forced (as will be shown shortly) to conduct a minimum current of about $I_{Q} / 2$.

The opposite happens when $v_{B P}$ and $v_{B N}$ are low: $Q_{P}$ supplies the load current $i_{L}$ in the direction indicated, and $v_{O}$ can go up as high as $V_{C C}-0.1 \mathrm{~V}$. In the meantime, $Q_{N}$ is inactive but is prevented from turning off and forced to conduct a minimum current of about $I_{Q} / 2$.

From the description above, we see that $v_{O}$ can swing to within 0.1 V of each of the supply rails. This near rail-to-rail operation is the major advantage of this CE output stage. Its disadvantage is the relatively high output resistance. However, given that the op amp will almost always be used with a negative-feedback loop, the closed-loop output resistance can still be very low.


Figure 13.41 In order to provide $v_{O}$ that can swing to within 0.1 V of $V_{C C}$ and ground, a near rail-to-rail operation, the output stage utilizes common-emitter transistors. Note that the driving signals $v_{B P}$ and $v_{B N}$ are separate but identical.

A Buffer/Driver Stage The output transistors can be called on to supply currents in the 10 mA to 15 mA range. When this happens, the base currents of $Q_{P}$ and $Q_{N}$ can be substantial (recall that $\beta_{P} \simeq 10$ and $\beta_{N} \simeq 40$ ). Such large currents cannot usually be supplied directly by the amplifier stage preceding the output stage. Rather, a buffer/driver stage is usually needed, as shown in Fig. 13.42. Here an emitter follower $Q_{3}$ is used to drive $Q_{N}$. However, because of the low $\beta_{P}$, a double buffer consisting of complementary emitter followers $Q_{1}$ and $Q_{2}$ is used to drive $Q_{P}$. The driver stage is fed by two separate but identical signals $v_{I P}$ and $v_{I N}$ that come from the preceding amplifier stage (which is usually the second stage) in the op-amp circuit. ${ }^{10}$

[^0]
[^0]:    ${ }^{9}$ For this to happen, either $R_{L}$ is returned to the positive supply (rather than ground) or $R_{L}$ is capacitively coupled to the amplifier output.
    ${ }^{10}$ An interesting approach for generating two identical outputs in the second stage is utilized in the NE5234 (see Gray et al., 2009).


Figure 13.42 The output stage that is operated as class AB needs emitter-follower buffers/drivers to reduce the loading on the preceding stage and to provide the current gain necessary to drive $Q_{P}$ and $Q_{N}$.

# EXERCISE 

13.39 (a) For the circuit in Fig. 13.42, find the current gain from each of the $v_{I P}$ and $v_{I N}$ terminals to the output in terms of $\beta_{P}$ and $\beta_{N}$.
(b) For $i_{L}= \pm 10 \mathrm{~mA}$, how much signal current is needed at the $v_{I P}$ and $v_{I N}$ inputs? Ans. (a) $\beta_{N} \beta_{P}^{\uparrow}, \beta_{N}^{\uparrow}$; (b) $2.5 \mu \mathrm{~A}, 6.25 \mu \mathrm{~A}$

Establishing $I_{Q}$ and Maintaining a Minimum Current in the Inactive Transistor We next consider the circuit for establishing the quiescent current $I_{Q}$ in $Q_{N}$ and $Q_{P}$ and for maintaining a minimum current of $I_{Q} / 2$ in the inactive output transistor. Figure 13.43 shows a fuller version of the output stage. In addition to the output transistors $Q_{P}-Q_{N}$ and the buffer/driver stage, which we have already discussed, the circuit includes two circuit blocks whose operation we shall now explain.

The first is the circuit composed of the differential pair $Q_{6}-Q_{7}$ and associated transistors $Q_{4}$ and $Q_{5}$, and resistors $R_{4}$ and $R_{5}$. This circuit measures the currents in the output transistors,


Figure 13.43 A more complete version of the output stage showing the circuits that establish the quiescent current in $Q_{P}$ and $Q_{N}$. As well, this circuit forces a minimum current of $\left(I_{Q} / 2\right)$ to follow in the inactive output transistor, preventing the transistor from turning off and thus minimizing crossover distortion.
$i_{P}$ and $i_{N}$, and arranges for the current $I$ to divide between $Q_{6}$ and $Q_{7}$ according to the ratio $i_{N} / i_{P}$, and provides a related output voltage $v_{E}$. Specifically, it can be shown (Problems 13.86 and 13.87 ) that

$$
\begin{aligned}
& i_{C 6}=I \frac{i_{N}}{i_{P}+i_{N}} \\
& i_{C 7}=I \frac{i_{P}}{i_{P}+i_{N}} \\
& v_{E}=V_{T} \ln \left[\frac{i_{N} i_{P}}{i_{N}+i_{P}} \frac{I}{I_{S N} I_{S 7}}\right]
\end{aligned}
$$9.4.1 Input Offset Voltage of the MOS Differential Amplifier 637
9.4.2 Input Offset Voltage of the Bipolar Differential Amplifier 640
9.4.3 Input Bias and Offset Currents of the Bipolar Differential Amplifier 643
9.4.4 A Concluding Remark 644
9.5 The Differential Amplifier with a Current-Mirror Load 644
9.5.1 Differential to Single-Ended Conversion 644
9.5.2 The Current-Mirror-Loaded MOS Differential Pair 645
9.5.3 Differential Gain of the Current-Mirror-Loaded MOS Pair 647
9.5.4 The Bipolar Differential Pair with a Current-Mirror Load 651
9.5.5 Common-Mode Gain and CMRR 655
9.6 Multistage Amplifiers 659
9.6.1 A Two-Stage CMOS Op Amp 659
9.6.2 A Bipolar Op Amp 664

Summary 672
Problems 674

## 10 Frequency Response 696

Introduction 697
10.1 Low-Frequency Response of Discrete-Circuit Common-
Source and Common-Emitter Amplifiers 699
10.1.1 The CS Amplifier 699
10.1.2 The Method of Short-Circuit Time-Constants 707
10.1.3 The CE Amplifier 707
10.2 Internal Capacitive Effects and the High-Frequency Model of the MOSFET and the BJT 711
10.2.1 The MOSFET 711
10.2.2 The BJT 717
10.3 High-Frequency Response of the CS and CE Amplifiers 722
10.3.1 The Common-Source Amplifier 722
10.3.2 The Common-Emitter Amplifier 728
10.3.3 Miller's Theorem 732
10.3.4 Frequency Response of the CS Amplifier When $R_{\text {sig }}$ Is Low 735
10.4 Useful Tools for the Analysis of the High-Frequency Response of Amplifiers 739
10.4.1 The High-Frequency Gain Function 739
10.4.2 Determining the 3-dB Frequency $f_{H} \quad 740$
10.4.3 The Method of Open-Circuit Time Constants 743
10.4.4 Application of the Method of Open-Circuit Time Constants to the CS Amplifier 744
10.4.5 Application of the Method of Open-Circuit Time Constants to the CE Amplifier 748
10.5 High-Frequency Response of the Common-Gate and Cascode Amplifiers 748
10.5.1 High-Frequency Response of the CG Amplifier 748
10.5.2 High-Frequency Response of the MOS Cascode Amplifier 754
10.5.3 High-Frequency Response of the Bipolar Cascode Amplifier 759
10.6 High-Frequency Response of the Source and Emitter Followers 760
10.6.1 The Source-Follower Case 761
10.6.2 The Emitter-Follower Case 767
10.7 High-Frequency Response of Differential Amplifiers 768
10.7.1 Analysis of the Resistively Loaded MOS Amplifier 768
10.7.2 Analysis of the Current-MirrorLoaded MOS Amplifier 772
10.8 Other Wideband Amplifier Configurations 778
10.8.1 Obtaining Wideband Amplification by Source and Emitter Degeneration 778
10.8.2 The CD-CS, CC-CE, and CD-CE Configurations 781
10.8.3 The $\mathrm{CC}-\mathrm{CB}$ and $\mathrm{CD}-\mathrm{CG}$ Configurations 786
Summary 788
Problems 789

## 11 Feedback 806

Introduction 807
11.1 The General Feedback Structure 808
11.1.1 Signal-Flow Diagram 808
11.1.2 The Closed-Loop Gain 809
11.1.3 The Loop Gain ..... 810
11.1.4 Summary ..... 814
11.2 Some Properties of Negative Feedback ..... 815
11.2.1 Gain Desensitivity ..... 815
11.2.2 Bandwidth Extension ..... 816
11.2.3 Interference Reduction ..... 817
11.2.4 Reduction in NonlinearDistortion 819
11.3 The Feedback Voltage Amplifier ..... 820
11.3.1 The Series-Shunt Feedback Topology ..... 820
11.3.2 Examples of Series-Shunt Feedback Amplifiers ..... 821
11.3.3 Analysis of the Feedback Voltage Amplifier Utilizing the Loop Gain ..... 823
11.3.4 A Final Remark ..... 828
11.4 Systematic Analysis of Feedback Voltage Amplifiers ..... 828
11.4.1 The Ideal Case ..... 829
11.4.2 The Practical Case ..... 831
11.5 Other Feedback Amplifier Types ..... 840
11.5.1 Basic Principles ..... 840
11.5.2 The Feedback Transconductance Amplifier (Series-Series) ..... 844
11.5.3 The Feedback Transresistance Amplifier (Shunt-Shunt) ..... 855
11.5.4 The Feedback Current Amplifier (Shunt-Series) ..... 865
11.6 Summary of the Feedback Analysis Method ..... 871
11.7 The Stability Problem ..... 871
11.7.1 Transfer Function of the Feedback Amplifier ..... 871
11.7.2 The Nyquist Plot ..... 873
11.8 Effect of Feedback on the Amplifier Poles ..... 875
11.8.1 Stability and Pole Location ..... 875
11.8.2 Poles of the Feedback Amplifier ..... 876
11.8.3 Amplifier with a Single-Pole Response ..... 877
11.8.4 Amplifier with a Two-Pole Response ..... 878
11.8.5 Amplifiers with Three or More Poles ..... 883
11.9 Stability Study Using Bode Plots ..... 885
11.9.1 Gain and Phase Margins ..... 885
11.9.2 Effect of Phase Margin on Closed-Loop Response ..... 886
11.9.3 An Alternative Approach for Investigating Stability ..... 887
11.10 Frequency Compensation ..... 889
11.10.1 Theory ..... 889
11.10.2 Implementation ..... 891
11.10.3 Miller Compensation and Pole Splitting ..... 892
Summary ..... 895
Problems ..... 896
12 Output Stages and Power Amplifiers ..... 920
Introduction ..... 921
12.1 Classification of Output Stages ..... 922
12.2 Class A Output Stage ..... 923
12.2.1 Transfer Characteristic ..... 924
12.2.2 Signal Waveforms ..... 925
12.2.3 Power Dissipation ..... 926
12.2.4 Power-Conversion Efficiency ..... 928
12.3 Class B Output Stage ..... 929
12.3.1 Circuit Operation ..... 929
12.3.2 Transfer Characteristic ..... 929
12.3.3 Power-Conversion Efficiency ..... 930
12.3.4 Power Dissipation ..... 931
12.3.5 Reducing Crossover Distortion ..... 933
12.3.6 Single-Supply Operation ..... 934
12.4 Class AB Output Stage ..... 935
12.4.1 Circuit Operation ..... 935
12.4.2 Output Resistance ..... 937
12.5 Biasing the Class AB Circuit ..... 940
12.5.1 Biasing Using Diodes ..... 940
12.5.2 Biasing Using the $V_{B E}$ Multiplier ..... 942
12.6 Variations on the Class AB Configuration ..... 945
12.6.1 Use of Input Emitter Followers ..... 945
12.6.2 Use of Compound Devices ..... 946
12.6.3 Short-Circuit Protection ..... 949
12.6.4 Thermal Shutdown ..... 950
12.7 CMOS Class AB Output Stages ..... 950
12.7.1 The Classical Configuration ..... 950
12.7.2 An Alternative Circuit Utilizing Common-Source Transistors ..... 953
12.8 IC Power Amplifiers ..... 961
12.8.1 A Fixed-Gain IC Power Amplifier ..... 962
12.8.2 The Bridge Amplifier ..... 966
12.9 Class D Power Amplifiers ..... 967
12.10 Power Transistors ..... 971
12.10.1 Packages and Heat
Sinks ..... 971
12.10.2 Power BJTs ..... 972
12.10.3 Power MOSFETs ..... 974
12.10.4 Thermal Considerations ..... 976
Summary ..... 982
Problems ..... 983
13 Operational-Amplifier Circuits ..... 994
Introduction ..... 995
13.1 The Two-Stage CMOS Op Amp ..... 996
13.1.1 The Circuit ..... 997
13.1.2 Input Common-Mode Range and
Output Swing ..... 998
13.1.3 DC Voltage Gain ..... 999
13.1.4 Common-Mode Rejection Ratio (CMRR) ..... 1001
13.1.5 Frequency Response ..... 1002
13.1.6 Slew Rate ..... 1007
13.1.7 Power-Supply Rejection Ratio (PSRR) ..... 1008
13.1.8 Design Trade-Offs ..... 1009
13.1.9 A Bias Circuit for the Two-Stage CMOS Op Amp ..... 1010
13.2 The Folded-Cascode CMOS Op Amp ..... 1016
13.2.1 The Circuit ..... 1016
13.2.2 Input Common-Mode Range and Output Swing ..... 1018
13.2.3 Voltage Gain ..... 1020
13.2.4 Frequency Response ..... 1021
13.2.5 Slew Rate ..... 1022
13.2.6 Increasing the Input Common- Mode Range: Rail-to-Rail Input Operation ..... 1024
13.2.7 Increasing the Output Voltage Range: The Wide-Swing Current Mirror ..... 1026
13.3 The 741 BJT Op Amp ..... 1028
13.3.1 The 741 Circuit ..... 1028
13.3.2 DC Analysis ..... 1032
13.3.3 Small-Signal Analysis ..... 1038
13.3.4 Frequency Response ..... 1051
13.3.5 Slew Rate ..... 1053
13.4 Modern Techniques for the Design of BJT Op Amps ..... 1054
13.4.1 Special Performance Requirements ..... 1054
13.4.2 Bias Design ..... 1056
13.4.3 Design of the Input Stage to Obtain Rail-to-Rail $V_{I C M}$ ..... 1058
13.4.4 Common-Mode Feedback to Control the DC Voltage at the Output of the Input Stage ..... 1064
13.4.5 Output-Stage Design for Near
Rail-to-Rail Output Swing ..... 1069
13.4.6 Concluding Remark ..... 1073
Summary ..... 1073
Problems ..... 1074
PART III DIGITAL INTEGRATED CIRCUITS ..... 1086
14 CMOS Digital Logic Circuits ..... 1088
Introduction ..... 1089
14.1 CMOS Logic-Gate Circuits ..... 1090
14.1.1 Switch-Level Transistor Model ..... 1090
14.1.2 The CMOS Inverter ..... 1091
14.1.3 General Structure of CMOS Logic ..... 1091
14.1.4 The Two-Input NOR Gate ..... 1094
14.1.5 The Two-Input NAND Gate ..... 1095
14.1.6 A Complex Gate ..... 1096
14.1.7 Obtaining the PUN from the PDN and Vice Versa ..... 1096
14.1.8 The Exclusive-OR Function ..... 1097
14.1.9 Summary of the Synthesis Method ..... 1098
14.2 Digital Logic Inverters ..... 1100
14.2.1 The Voltage-Transfer Characteristic (VTC) ..... 1100
14.2.2 Noise Margins ..... 1101
14.2.3 The Ideal VTC ..... 1103
14.2.4 Inverter Implementation ..... 1103
14.3 The CMOS Inverter ..... 1114
14.3.1 Circuit Operation ..... 1114
14.3.2 The Voltage-Transfer Characteristic (VTC) ..... 1117
14.3.3 The Situation When $Q_{N}$ and $Q_{P}$ Are Not Matched ..... 1120
14.4 Dynamic Operation of the CMOS Inverter ..... 1125
14.4.1 Propagation Delay ..... 1125
14.4.2 Determining the Propagation Delay of the CMOS Inverter ..... 1129
14.4.3 Determining the Equivalent Load Capacitance $C$ ..... 1136
14.5 Transistor Sizing ..... 1139
14.5.1 Inverter Sizing ..... 1139
14.5.2 Transistor Sizing in CMOS Logic Gates ..... 1141
14.5.3 Effects of Fan-In and Fan-Out on Propagation Delay ..... 1145
14.5.4 Driving a Large Capacitance ..... 1146
14.6 Power Dissipation ..... 1149
14.6.1 Sources of Power Dissipation ..... 1149
14.6.2 Power-Delay and Energy-Delay Products ..... 1152
Summary ..... 1154
Problems ..... 1156
15 Advanced Topics in Digital Integrated-Circuit Design ..... 1166
Introduction ..... 1167
15.1 Implications of Technology
Scaling: Issues in Deep-Submicron Design ..... 1168
15.1.1 Silicon Area ..... 1169
15.1.2 Scaling Implications ..... 1169
15.1.3 Velocity Saturation ..... 1171
15.1.4 Subthreshold Conduction ..... 1177
15.1.5 Temperature, Voltage, and Process Variations ..... 1178
15.1.6 Wiring: The Interconnect ..... 1178
15.2 Digital IC Technologies,
Logic-Circuit Families, and Design Methodologies ..... 1179
15.2.1 Digital IC Technologies and Logic-Circuit Families ..... 1180
15.2.2 Styles for Digital System Design ..... 1182
15.2.3 Design Abstraction and Computer Aids ..... 1182
15.3 Pseudo-NMOS Logic Circuits ..... 1183
15.3.1 The Pseudo-NMOS Inverter ..... 1183
15.3.2 Static Characteristics ..... 1184
15.3.3 Derivation of the VTC ..... 1186
15.3.4 Dynamic Operation ..... 1188
15.3.5 Design ..... 1189
15.3.6 Gate Circuits ..... 1189
15.3.7 Concluding Remarks ..... 1190
15.4 Pass-Transistor
Logic Circuits ..... 1192
15.4.1 An Essential Design Requirement ..... 1193
15.4.2 Operation with NMOS Transistors as Switches ..... 1194
15.4.3 Restoring the Value of $V_{O H}$ to $V_{D D}$ ..... 1198
15.4.4 The Use of CMOS Transmission Gates as Switches ..... 1199
15.4.5 Examples of Pass-Transistor Logic Circuits ..... 1206
15.4.6 A Final Remark ..... 1208
15.5 Dynamic MOS Logic Circuits ..... 1208
15.5.1 The Basic Principle ..... 1209
15.5.2 Nonideal Effects ..... 1212
15.5.3 Domino CMOS Logic ..... 1216
15.5.4 Concluding Remarks ..... 1217
15.6 Bipolar and BiCMOS Logic
Circuits ..... 1217
15.6.1 Emitter-Coupled Logic (ECL) ..... 1218
15.6.2 BiCMOS Digital Circuits ..... 1223
Summary ..... 1226
Problems ..... 1227
16 Memory Circuits ..... 1236
Introduction ..... 1237
16.1 Latches and Flip-Flops ..... 1238
16.1.1 The Latch ..... 1238
16.1.2 The SR Flip-Flop ..... 1240
16.1.3 CMOS Implementation of SR Flip-Flops ..... 1241
16.1.4 A Simpler CMOS Implementation of the Clocked SR Flip-Flop ..... 1247
16.1.5 D Flip-Flop Circuits ..... 1247
16.2 Semiconductor Memories: Types and Architectures ..... 1249
16.2.1 Memory-Chip Organization ..... 1250
16.2.2 Memory-Chip Timing ..... 1252
16.3 Random-Access Memory (RAM) Cells ..... 1253
16.3.1 Static Memory (SRAM) Cell ..... 1253
16.3.2 Dynamic Memory (DRAM) Cell ..... 1260
16.4 Sense Amplifiers and Address Decoders ..... 1262
16.4.1 The Sense Amplifier ..... 1263
16.4.2 The Row-Address Decoder ..... 1271
16.4.3 The Column-Address Decoder ..... 1273
16.4.4 Pulse-Generation Circuits ..... 1274
16.5 Read-Only Memory (ROM) ..... 1276
16.5.1 A MOS ROM ..... 1276
16.5.2 Mask Programmable ROMs ..... 1278
16.5.3 Programmable ROMs (PROMs, EPROMs, and Flash) ..... 1279
16.6 CMOS Image Sensors ..... 1281
Summary ..... 1282
Problems ..... 1283
PART IV FILTERS AND OSCILLATORS 1288
17 Filters and Tuned Amplifiers ..... 1290
Introduction ..... 1291
17.1 Filter Transmission, Types, and Specification ..... 1292
17.1.1 Filter Transmission ..... 1292
17.1.2 Filter Types ..... 1293
17.1.3 Filter Specification ..... 1293
17.2 The Filter Transfer Function ..... 1296
17.3 Butterworth and Chebyshev Filters ..... 1300
17.3.1 The Butterworth Filter ..... 1300
17.3.2 The Chebyshev Filter ..... 1304
17.4 First-Order and Second-Order Filter Functions ..... 1307
17.4.1 First-Order Filters ..... 1308
17.4.2 Second-Order Filter Functions ..... 1311
17.5 The Second-Order LCR Resonator ..... 1316
17.5.1 The Resonator Natural Modes ..... 1316
17.5.2 Realization of Transmission Zeros ..... 1317
17.5.3 Realization of the Low-Pass Function ..... 1317
17.5.4 Realization of the High-Pass Function ..... 1319
17.5.5 Realization of the Bandpass Function ..... 1319
17.5.6 Realization of the Notch Functions ..... 1319
17.5.7 Realization of the All-Pass Function ..... 1321
17.6 Second-Order Active Filters Based on Inductor Replacement ..... 1322
17.6.1 The Antoniou InductanceSimulation Circuit ..... 1322
17.6.2 The Op Amp-RC Resonator ..... 1323
17.6.3 Realization of the Various Filter Types ..... 1325
17.6.4 The All-Pass Circuit ..... 1325
17.7 Second-Order Active Filters
Based on the Two-Integrator-Loop Topology ..... 1330
17.7.1 Derivation of the Two-Integrator- Loop Biquad ..... 1330
17.7.2 Circuit Implementation ..... 1332
17.7.3 An Alternative Two-Integrator- Loop Biquad Circuit ..... 1334
17.7.4 Final Remarks ..... 1335
17.8 Single-Amplifier Biquadratic Active Filters ..... 1336
17.8.1 Synthesis of the Feedback Loop ..... 1336
17.8.2 Injecting the Input Signal ..... 1339
17.8.3 Generation of Equivalent Feedback Loops ..... 1341
17.9 Sensitivity ..... 1344
17.10 Transconductance-C Filters ..... 1347
17.10.1 Methods for IC Filter Implementation ..... 1347
17.10.2 Transconductors ..... 1348
17.10.3 Basic Building Blocks ..... 1349
17.10.4 Second-Order $G_{m}-C$ Filter ..... 1351
17.11 Switched-Capacitor Filters ..... 1354
17.11.1 The Basic Principle ..... 1354
17.11.2 Practical Circuits ..... 1356
17.11.3 Final Remarks ..... 1359
17.12 Tuned Amplifiers ..... 1359
17.12.1 The Basic Principle ..... 1360
17.12.2 Inductor Losses ..... 1362
17.12.3 Use of Transformers ..... 1363
17.12.4 Amplifiers with Multiple Tuned Circuits ..... 1365
17.12.5 The Cascode and the CC-CB Cascade ..... 1366
17.12.6 Synchronous Tuning and Stagger Tuning ..... 1367
Summary ..... 1368
Problems ..... 1369
18 Signal Generators and Waveform-Shaping Circuits 1378
Introduction ..... 1379
18.1 Basic Principles of Sinusoidal Oscillators ..... 1380
18.1.1 The Oscillator Feedback Loop ..... 1380
18.1.2 The Oscillation Criterion ..... 1381
18.1.3 Analysis of Oscillator Circuits ..... 1382
18.1.4 Nonlinear Amplitude Control ..... 1385
18.1.5 A Popular Limiter Circuit for Amplitude Control ..... 1386
18.2 Op Amp-RC Oscillator Circuits ..... 1388
18.2.1 The Wien-Bridge Oscillator ..... 1388
18.2.2 The Phase-Shift Oscillator ..... 1391
18.2.3 The Quadrature Oscillator ..... 1392
18.2.4 The Active-Filter-Tuned Oscillator ..... 1394
18.2.5 A Final Remark ..... 1396
18.3 LC and Crystal Oscillators ..... 1396
18.3.1 The Colpitts and Hartley Oscillators ..... 1396
18.3.2 The Cross-Coupled LC Oscillator ..... 1400
18.3.3 Crystal Oscillators ..... 1402
18.4 Bistable Multivibrators ..... 1404
18.4.1 The Feedback Loop ..... 1405
18.4.2 Transfer Characteristic of the Bistable Circuit ..... 1406
18.4.3 Triggering the Bistable Circuit ..... 1407
18.4.4 The Bistable Circuit as a Memory Element ..... 1407
18.4.5 A Bistable Circuit with Noninverting Transfer Characteristic ..... 1408
18.4.6 Application of the Bistable Circuit as a Comparator ..... 1409
18.4.7 Making the Output Levels More Precise ..... 1411
18.5 Generation of Square and Triangular Waveforms Using Astable
Multivibrators ..... 1412
18.5.1 Operation of the Astable Multivibrator ..... 1413
18.5.2 Generation of Triangular Waveforms ..... 1415
18.6 Generation of a Standardized Pulse: The Monostable Multivibrator ..... 1417
18.7 Integrated-Circuit Timers ..... 1419
18.7.1 The 555 Circuit ..... 1419
18.7.2 Implementing a Monostable Multivibrator Using the 555 IC ..... 1420
18.7.3 An Astable Multivibrator Using the 555 IC ..... 1420
18.8 Nonlinear Waveform-Shaping Circuits ..... 1424
18.8.1 The Breakpoint Method ..... 1424
18.8.2 The Nonlinear-Amplification Method ..... 1426
Summary ..... 1428
Problems ..... 1428
Appendices
A. VLSI Fabrication Technology (on website) A-1
B. SPICE Device Models and Design and Simulation Examples Using PSpice ${ }^{\circledR}$ and Multisim ${ }^{\text {TM }}$ (on website) B-1
C. Two-Port Network Parameters (on website) C-1
D. Some Useful Network Theorems (on website) D-1
E. Single-Time-Constant Circuits (on website) E-1
F. s-Domain Analysis: Poles, Zeros, and Bode Plots (on website) F-1
G. Comparison of the MOSFET and the BJT (on website, also Table G. 3 in text) G-1
H. Design of Stagger-Tuned Amplifiers (on website) H-1
I. Bibliography (on website) I-1
J. Standard Resistance Values and Unit Prefixes J-1
K. Typical Parameter Values for IC Devices Fabricated in CMOS and Bipolar Processes K-1
L. Answers to Selected Problems (on website) L-1
Index IN-1
# TABLES 

## FOR REFERENCE AND STUDY

Table 1.1 The Four Amplifier Types ..... 28
Table 1.2 Frequency Response of STC Networks ..... 36
Table 2.1 Characteristics of the Ideal Op Amp ..... 62
Table 3.1 Summary of Important Semiconductor Equations ..... 169
Table 5.1 Regions of Operation of the NMOS Transistor ..... 266
Table 5.2 Regions of Operation of the PMOS Transistor ..... 275
Table 6.1 BJT Modes of Operation ..... 307
Table 6.2 Summary of the BJT Current-Voltage Relationships in the Active Mode ..... 322
Table 6.3 Simplified Models for the Operation of the BJT in DC Circuits ..... 334
Table 7.1 Systematic Procedure for the Analysis of Transistor Amplifier Circuits ..... 421
Table 7.2 Small-Signal Models of the MOSFET ..... 421
Table 7.3 Small-Signal Models of the BJT ..... 422
Table 7.4 Characteristics of MOSFET Amplifiers ..... 452
Table 7.5 Characteristics of BJT Amplifiers ..... 453
Table 8.1 Gain Distribution in the MOS Cascode Amplifier for Various Values of $R_{L}$ ..... 554
Table 10.1 The MOSFET High-Frequency Model ..... 716
Table 10.2 The BJT High-Frequency Model ..... 722
Table 11.1 Summary of the Parameters and Formulas for the Ideal Feedback-Amplifier Structure of Fig. 11.1 ..... 815
Table 11.2 Summary of Relationships for the Four Feedback- Amplifier Topologies ..... 872
Table 13.1 DC Collector Currents of the 741 Circuit ( $\mu \mathrm{A}$ ) ..... 1038
Table 14.1 Important Parameters of the VTC of the Logic Inverter 1102
Table 14.2 Summary of Important Characteristics of the CMOS Logic Inverter ..... 1155
Table 15.1 Implications of Device and Voltage Scaling ..... 1170
Table 15.2 Regions of Operation of the Pseudo-NMOS Inverter ..... 1187
Table 17.1 Design Data for the Circuits Based on Inductance Simulation (Fig 17.22) ..... 1328
Table 17.2 Design Data for the Tow-Thomas Biquad Circuit in Fig 17.26 ..... 1335
Table G. 3 Comparison of the MOSFET and the BJT ..... G-1
Table J. 1 Standard Resistance Values ..... J-1
Table J. 2 SI Unit Prefixes ..... J-2
Table J. 3 Meter Conversion Factors ..... J-2
Table K. 1 Typical Values of CMOS Device Parameters ..... K-1
Table K. 2 Typical Parameter Values for BJTs ..... K-1
# "EXPAND-YOUR-PERSPECTIVE" NOTES 

Chapter 1: Analog vs. Digital Circuit Engineers ..... 15
Chapter 1: Bode Plots ..... 37
Chapter 2: Integrated Instrumentation Amplifiers ..... 85
Chapter 2: Early Op Amps and Analog Computation ..... 88
Chapter 3: LCDs, the Face of Electronics ..... 139
Chapter 4: The Earliest Semiconductor Diode ..... 219
Chapter 4: From Indication to Illumination ..... 229
Chapter 5: The First Field-Effect Devices ..... 248
Chapter 5: Gordon Moore-His Law ..... 288
Chapter 6: The Invention of the BJT ..... 320
Chapter 7: Shockley and Silicon Valley ..... 405
Chapter 7: Lee de Forest-a Father of the Electronics Age ..... 454
Chapter 8: Solid Circuits with "Flying Wires" ..... 511
Chapter 8: The Integrated Circuit 525
Chapter 9: The Long-Tailed Pair ..... 612
Chapter 9: The International Solid-State Circuits Conference (ISSCC) ..... 659
Chapter 10: John Milton Miller-Capacitance Multiplication ..... 735
Chapter 10: RFID-Identification at a Distance ..... 772
Chapter 11: Feedback-Historical Note ..... 823
Chapter 11: Harry Nyquist-A Diverse Electronics Fundamentalist ..... 875
Chapter 12: Early Power-Op-Amp Product ..... 962
Chapter 12: Hans Camenzind-the Inventor of the Class D Amplifier ..... 968
Chapter 13: The Genie of Analog ..... 996
Chapter 13: The Creator of the $\mu \mathrm{A} 741$-David Fullagar ..... 1031
Chapter 14: Frank Marion Wanless-the Inventor of CMOS ..... 1117
Chapter 14: Federico Faggin-a Pioneer in Microprocessor Electronics ..... 1141
Chapter 15: The Invisible Computer ..... 1182
Chapter 15: Grand-Scale Graphics ..... 1213
Chapter 16: Flip-Flop Fact ..... 1240
Chapter 16: Blinding Flash ..... 1282
Chapter 17: A Brief History of Analog Filters ..... 1295
Chapter 17: Early Filter Pioneers-Cauer and Darlington ..... 1348
Chapter 18: The Wien-Bridge Oscillator ..... 1390
Chapter 18: Oscillator Pioneers ..... 1400
.
# PREFACE 

Microelectronic Circuits, Seventh Edition, is intended as a text for the core courses in electronic circuits taught to majors in electrical and computer engineering. It should also prove useful to engineers and other professionals wishing to update their knowledge through self-study.

As was the case with the first six editions, the objective of this book is to develop in the reader the ability to analyze and design electronic circuits, both analog and digital, discrete and integrated. While the application of integrated circuits is covered, emphasis is placed on transistor circuit design. This is done because of our belief that even if the majority of those studying this book were not to pursue a career in IC design, knowledge of what is inside the IC package would enable intelligent and innovative application of such chips. Furthermore, with the advances in VLSI technology and design methodology, IC design itself has become accessible to an increasing number of engineers.

## Prerequisites

The prerequisite for studying the material in this book is a first course in circuit analysis. As a review, some linear circuits material is included here in the appendices: specifically, two-port network parameters in Appendix C; some useful network theorems in Appendix D; single-time-constant circuits in Appendix E; and s-domain analysis in Appendix F. In addition, a number of relevant circuit analysis problems are included at the beginning of the end-of-chapter problems section of Chapter 1. No prior knowledge of physical electronics is assumed. All required semiconductor device physics is included, and Appendix A provides a brief description of IC fabrication. All these appendices can be found on the book's website.

## Emphasis on Design

It has been our philosophy that circuit design is best taught by pointing out the various tradeoffs available in selecting a circuit configuration and in selecting component values for a given configuration. The emphasis on design has been retained in this edition. In addition to design examples, and design-oriented exercises and end-of-chapter problems (indicated with a D), the book includes on its website an extensive appendix (Appendix B) where a large number of simulation and design examples are presented. These emphasize the use of SPICE, the most valuable circuit-design aid.where $I_{S N}$ and $I_{S 7}$ are the saturation currents of $Q_{N}$ and $Q_{7}$, respectively. Observe that for $i_{P} \gg i_{N}, i_{C 6} \simeq 0$ and $i_{C 7} \simeq I$. Thus $Q_{6}$ turns off and $Q_{7}$ conducts all of $I$. The emitter voltage $v_{E}$ becomes

$$
v_{E} \simeq V_{T} \ln \left(\frac{i_{N}}{I_{S N}}\right)+V_{T} \ln \left(\frac{I}{I_{S 7}}\right)
$$

Thus,

$$
v_{E}=V_{T} \ln \left(\frac{i_{N}}{I_{S N}}\right)+V_{E B 7}
$$

This equation simply states that $v_{E}=v_{B E N}+V_{E B 7}$, which could have been directly obtained from the circuit diagram in Fig. 13.43. The important point to note, however, is that since $V_{E B 7}$ is a constant, $v_{E}$ is determined by the current $i_{N}$ in the inactive transistor, $Q_{N}$. In the other extreme case of $i_{N} \gg i_{P}, i_{C 6} \simeq I, i_{C 7} \simeq 0$; thus $Q_{7}$ turns off and $Q_{6}$ conducts all of $I$. In this case we can use Eq. (13.132) to show that

$$
v_{E}=V_{T} \ln \left(\frac{i_{P}}{I_{S N}}\right)+V_{E B 6}
$$

Thus, here too, since $V_{E B 6}$ is a constant, $v_{E}$ is determined by the current in the inactive transistor, $Q_{P}$.

The second circuit block is a differential amplifier composed of $Q_{8}-Q_{9}$ with their emitter-degeneration resistors $R_{8}, R_{9}$. The voltage $v_{E}$ generated by the measuring circuit is fed to one input of the differential amplifier, and the other input is fed with a reference voltage $V_{\text {REF }}$ generated by passing a reference current $I_{\text {REF }}$ through the series connection of diode-connected transistors $Q_{10}$ and $Q_{11}$. This differential amplifier takes part in a negative-feedback loop that uses the value of $v_{E}$ to control the currents $i_{P}$ and $i_{N}$ through the nodes $v_{I P}$ and $v_{I N}$. The objective of the feedback control is to set the current in the inactive output transistor to a minimum value. To see how the feedback operates, consider the case when $i_{P} \gg i_{N}$, and thus $Q_{N}$ is the inactive transistor. In this case, $Q_{6}$ turns off, $Q_{7}$ conducts all of $I$, and $v_{E}$ is given by Eq. (13.133). Now, if for some reason $i_{N}$ falls below its minimum intended value, $v_{E}$ decreases, causing $i_{C 9}$ to decrease. This in turn will cause the node $v_{I N}$ to rise and the voltage at the base of $Q_{N}$ will eventually rise, thus increasing $i_{N}$ to its intended value.

Analytically, we can obtain a relationship between $i_{N}$ and $i_{P}$ as follows. Assume that the loop gain of the feedback loop that is anchored by the differential amplifier $Q_{8}-Q_{9}$ is high enough to force the two input terminals to the same voltage, that is,

$$
v_{E}=V_{\mathrm{REF}}=V_{T} \ln \frac{I_{\mathrm{REF}}}{I_{S 10}}+V_{T} \ln \frac{I_{\mathrm{REF}}}{I_{S 11}}
$$

Substituting for $v_{E}$ from Eq. (13.132) results in

$$
\frac{i_{N} i_{P}}{i_{N}+i_{P}}=\left(\frac{I_{\mathrm{REF}}^{2}}{I}\right)\left(\frac{I_{S N}}{I_{S 10}}\right)\left(\frac{I_{S 7}}{I_{S 11}}\right)
$$

Observe that the quantity on the right-hand side is a constant. In the quiescent case, $i_{N}=i_{P}=I_{Q}$, Eq. (13.135) yields

$$
I_{Q}=2\left(\frac{I_{\mathrm{REF}}^{2}}{I}\right)\left(\frac{I_{S N}}{I_{S 10}}\right)\left(\frac{I_{S 7}}{I_{S 11}}\right)
$$
Thus, the constant on the right-hand side of Eq. (13.135) is $I_{Q} / 2$, and we can rewrite (13.135) as

$$
\frac{i_{N} i_{P}}{i_{N}+i_{P}}=\frac{1}{2} I_{Q}
$$

Equation (13.137) clearly shows that for $i_{N} \gg i_{P}, i_{P} \simeq \frac{1}{2} I_{Q}$, and that for $i_{P} \gg i_{N}, i_{N} \simeq \frac{1}{2} I_{Q}$. Thus the circuit not only establishes the quiescent current $I_{Q}$ (Eq. 13.136) but also sets the minimum current in the inactive output transistor at $\frac{1}{2} I_{Q}$.

# EXERCISE 

D13.40 For the circuit in Fig. 13.43, determine the value that $I_{\mathrm{REF}}$ should have so that $Q_{N}$ and $Q_{P}$ have a quiescent current $I_{Q}=0.4 \mathrm{~mA}$. Assume that the transistor areas are scaled so that $I_{89} / I_{810}=10$ and $I_{87} / I_{811}=2$. Let $I=10 \mu \mathrm{~A}$. Also, if $i_{L}$ in the direction out of the amplifier is 10 mA , find $i_{P}$ and $i_{N}$. Ans. $I_{\text {REF }}=10 \mu \mathrm{~A} ; i_{P} \simeq 10.2 \mathrm{~mA}, i_{N} \simeq 0.2 \mathrm{~mA}$

### 13.4.6 Concluding Remark

This section presented a sample of the design techniques employed in modern BJT op amps.

## Summary

- Most CMOS op amps are designed to operate as part of a VLSI circuit and thus are required to drive only small capacitive loads. Therefore, most do not have a low-output-resistance stage.
- There are basically two approaches to the design of CMOS op amps: a two-stage configuration and a single-stage topology utilizing the folded-cascode circuit.
- In the two-stage CMOS op amp, approximately equal gains are realized in the two stages.
- The threshold mismatch $\Delta V_{t}$ together with the low transconductance of the input stage result in a larger input offset voltage for CMOS op amps than for bipolar units.
- Miller compensation is employed in the two-stage CMOS op amp, but a series resistor is required to place the transmission zero at either $s=\infty$ or on the negative real axis so as to increase the phase margin.
- CMOS op amps have higher slew rates than their bipolar counterparts with comparable $f_{t}$ values.
- Use of the cascode configuration increases the gain of a CMOS amplifier stage by about two orders of magnitude, thus making possible a single-stage op amp.
- The dominant pole of the folded-cascode op amp is determined by the total capacitance at the output node, $C_{L}$. Increasing $C_{L}$ improves the phase margin at the expense of reducing the bandwidth.
- By using two complementary input differential pairs in parallel, the input common-mode range can be extended to equal the entire power-supply voltage, providing so-called rail-to-rail operation at the input.
- The output voltage swing of the folded-cascode op amp can be extended by utilizing a wide-swing current mirror in place of the cascode mirror.
- The internal circuit of the 741 op amp embodies many of the design techniques employed in bipolar analog integrated circuits.
- The 741 circuit consists of an input differential stage, a high-gain single-ended second stage, and a class AB output stage. Though more than 40 years old, this structure is typical of most BJT op amps and is known as the two-stage topology (not counting the output stage). It is also the same structure used in the two-stage CMOS op amp of Section 13.1.
- To obtain low input offset voltage and current, and high CMRR, the 741 input stage is designed to be perfectly balanced. The CMRR is increased by common-mode feedback, which also stabilizes the dc operating point.
- To obtain high input resistance and low input bias current, the input stage of the 741 is operated at a very low current level.
- In the 741, output short-circuit protection is accomplished by turning on a transistor that takes away most of the base current drive of the output transistor.
- The use of Miller frequency compensation in the 741 circuit enables locating the dominant pole at a very low frequency while utilizing a relatively small compensating capacitance.
- Two-stage op amps can be modeled as a transconductance amplifier feeding an ideal integrator with $C_{C}$ as the integrating capacitor.
- The slew rate of a two-stage op amp is determined by the first-stage bias current and the frequency-compensation capacitor.
- While the 741 and its generation of op amps nominally operate from $\pm 15-\mathrm{V}$ power supplies, modern BJT op amps typically utilize a single ground-referenced supply of only 2 V to 3 V .
- Operation from a single low-voltage supply gives rise to a number of new important specifications including a common-mode input range that extends beyond the supply rails (i.e., more than rail-to-rail operation) and a near rail-to-rail output voltage swing.
- The rail-to-rail input common-mode range is achieved by using resistive loads (instead of current-mirror loads) for the input differential pair as well as utilizing two complementary differential amplifiers in parallel.
- To increase the gain of the input stage above that achieved with resistive loads, the folded-cascode configuration is utilized.
- To regulate the dc bias voltages at the outputs of the differential folded-cascode stage so as to maintain active-mode operation at all times, common-mode feedback is employed.
- The output stage of a low-voltage op amp utilizes a complementary pair of common-emitter transistors. This allows $v_{O}$ to swing to within 0.1 V or so from each of the supply rails. The disadvantage is a high open-loop output resistance. This, however, is substantially reduced when negative feedback is applied around the op amp.
- Modern output stages operate in the class AB mode and utilize interesting feedback techniques to set the quiescent current as well as to ensure that the inactive output transistor does not turn off, a precaution that avoids increases in crossover distortion.


# PROBLEMS 

## Computer Simulation Problems

SIIC Problems identified by the Multisim/PSpice icon are intended to demonstrate the value of using SPICE simulation to verify hand analysis and design, and to investigate important issues such as allowable signal swing and amplifier nonlinear distortion. Instructions to assist in setting up PSpice and Multisim simulations for all the indicated problems can be found in the corresponding files on the website. Note that if a particular parameter value is not specified in the problem statement, you are to make a reasonable assumption.

## Section 13.1: The Two-Stage CMOS Op Amp

13.1 A particular design of the two-stage CMOS operational amplifier of Fig. 13.1 utilizes $\pm 1-\mathrm{V}$ power supplies. All transistors are operated at overdrive voltages of $0.2-\mathrm{V}$ magnitude. The process technology provides devices with $V_{m}=\left|V_{m}\right|=0.4 \mathrm{~V}$. Find the input common-mode range and the range allowed for $v_{O}$.
13.2 The CMOS op amp of Fig. 13.1 is fabricated in a process for which $\mathrm{V}_{A n}^{\prime}=25 \mathrm{~V} / \mu \mathrm{m}$ and $\left|V_{A p}^{\prime}\right|=20 \mathrm{~V} / \mu \mathrm{m}$. Find $A_{1}, A_{2}$,

[^0]
[^0]:    SIIC = Multisim/PSpice; * = difficult problem; ** = more difficult; ${ }^{* * *}=$ very challenging; $D=$ design problem
| Transistor | $\mathbf{Q}_{\mathbf{1}}$ | $\mathbf{Q}_{\mathbf{2}}$ | $\mathbf{Q}_{\mathbf{3}}$ | $\mathbf{Q}_{\mathbf{4}}$ | $\mathbf{Q}_{\mathbf{5}}$ | $\mathbf{Q}_{\mathbf{6}}$ | $\mathbf{Q}_{\mathbf{7}}$ | $\mathbf{Q}_{\mathbf{8}}$ |
| :-- | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| $W / L(\mu \mathrm{~m} / \mu \mathrm{m})$ | $36 / 0.3$ | $36 / 0.3$ | $6 / 0.3$ | $6 / 0.3$ | $30 / 0.3$ | $W / 0.3$ | $45 / 0.3$ | $6 / 0.3$ |

and $A_{v}$ if all devices are $0.3 \mu \mathrm{~m}$ long, $Q_{1}$ and $Q_{2}$ are operated at overdrive voltages of $0.15-\mathrm{V}$ magnitude, and $Q_{6}$ is operated at $V_{O V}=0.2 \mathrm{~V}$. Also, determine the op-amp output resistance obtained when the second stage is biased at 0.3 mA . What do you expect the output resistance of a unity-gain voltage amplifier to be, using this op amp?

D 13.3 The CMOS op amp of Fig. 13.1 is fabricated in a process for which $\left|V_{A}^{\prime}\right|$ for all devices is $20 \mathrm{~V} / \mu \mathrm{m}$. If all transistors have $L=0.3 \mu \mathrm{~m}$ and are operated at equal overdrive voltages, find the magnitude of the overdrive voltage required to obtain a dc open-loop gain of $1600 \mathrm{~V} / \mathrm{V}$.
13.4 Consider the circuit in Fig. 13.1 with the device geometries shown at the top of this page. Let $I_{\mathrm{REF}}=40 \mu \mathrm{~A}$, $\left|V_{i}\right|$ for all devices $=0.45 \mathrm{~V}, \mu_{a} C_{o s}=270 \mu \mathrm{~A} / \mathrm{V}^{2}, \mu_{g} C_{o s}=$ $70 \mu \mathrm{~A} / \mathrm{V}^{2},\left|V_{A}\right|$ for all devices $=15 \mathrm{~V}, V_{D D}=V_{S S}=1 \mathrm{~V}$. Determine the width of $Q_{6}, W$, that will ensure that the op amp will not have a systematic offset voltage. Then, for all devices, evaluate $I_{D},\left|V_{O V}\right|,\left|V_{G S}\right|, g_{m}$, and $r_{a}$. Provide your results in a table. Also find $A_{1}, A_{2}$, the dc open-loop voltage gain, the input common-mode range, and the output voltage range. Neglect the effect of $V_{A}$ on the bias currents.

D 13.5 Design the two-stage CMOS op amp in Fig. 13.1 to provide a CMRR of about 72 dB . If all the transistors are operated at equal overdrive voltages of 0.15 V and have equal channel lengths, find the minimum required channel length. For this technology, $\left|V_{A}^{\prime}\right|=15 \mathrm{~V} / \mu \mathrm{m}$. What is the dc gain realized?
13.6 A two-stage CMOS op amp has $G_{m 1}=0.8 \mathrm{~mA} / \mathrm{V}$, $G_{m 2}=2.4 \mathrm{~mA} / \mathrm{V}, C_{1}=0.1 \mathrm{pF}$, and $C_{2}=1.2 \mathrm{pF}$. Find the value of $C_{C}$ that will provide a unity-gain frequency of 120 MHz . Also, determine the values of $f_{P 2}$ and $f_{Z}$.
13.7 For the CMOS amplifier in Fig. 13.1, whose equivalent circuit is shown in Fig. 13.2, let $G_{m 1}=1 \mathrm{~mA} / \mathrm{V}, R_{1}=$
$100 \mathrm{k} \Omega, C_{1}=0.1 \mathrm{pF}, G_{m 2}=2 \mathrm{~mA} / \mathrm{V}, R_{2}=50 \mathrm{k} \Omega$, and $C_{2}=2 \mathrm{pF}$.
(a) Find the dc gain.
(b) Without $C_{C}$ connected, find the frequencies of the two poles in radians per second and sketch a Bode plot for the gain magnitude.
(c) With $C_{C}$ connected, find $\omega_{P 2}$. Then find the value of $C_{C}$ that will result in a unity-gain frequency $\omega_{i}$ at least two octaves below $\omega_{P 2}$. For this value of $C_{C}$, find $\omega_{P 1}$ and $\omega_{Z}$ and sketch a Bode plot for the gain magnitude.
13.8 A CMOS op amp with the topology in Fig. 13.1 has $g_{m 1}=g_{m 2}=1 \mathrm{~mA} / \mathrm{V}, g_{m 6}=3 \mathrm{~mA} / \mathrm{V}$, the total capacitance between node $D_{2}$ and ground is 0.2 pF , and the total capacitance between the output node and ground is 3 pF . Find the value of $C_{C}$ that results in $f_{t}=50 \mathrm{MHz}$, and verify that $f_{t}$ is lower than $f_{Z}$ and $f_{P 2}$.
13.9 A particular design of the two-stage CMOS op amp of Fig. 13.1 has $G_{m 1}=1 \mathrm{~mA} / \mathrm{V}$ and $G_{m 2}=2 \mathrm{~mA} / \mathrm{V}$. The total capacitance at the output node is 1 pF . While utilizing a Miller compensation capacitor $C_{C}$ without a series resistance $R$, the amplifier is made to have a uniform $-20-\mathrm{dB} /$ decade gain rolloff with a unity-gain frequency $f_{t}$ of 100 MHz .
(a) What must the value of $C_{C}$ be?
(b) What do you estimate the frequencies of the poles, $f_{P 1}$ and $f_{P 2}$, and of the right-half-plane zero, $f_{Z}$, to be?
(c) What is the phase margin obtained?
(d) To increase the phase margin, a resistance $R$ is connected in series with $C_{C}$. What is the value of $R$ that results in $f_{Z}=\infty$, and what is the resulting phase margin?
(e) If $R$ is increased further, until it moves the zero into the left half-plane and thus turns the phase it introduces into phase lead, what value of $R$ is needed to obtain a phase margin of $85^{\circ}$ ?

D 13.10 A particular implementation of the CMOS amplifier of Figs. 13.1 and 13.2 provides $G_{m 1}=0.3 \mathrm{~mA} / \mathrm{V}$,
$G_{m 2}=0.6 \mathrm{~mA} / \mathrm{V}, r_{o 2}=r_{o 4}=222 \mathrm{k} \Omega, r_{o 6}=r_{o 7}=111 \mathrm{k} \Omega$, and $C_{2}=1 \mathrm{pF}$.
(a) Find the dc gain.
(b) Find the frequency of the second pole, $f_{P 2}$.
(c) Find the value of the resistance $R$ that, when placed in series with $C_{C}$, causes the transmission zero to be located at $s=\infty$.
(d) With $R$ in place, as in (c), find the value of $C_{C}$ that results in the highest possible value of $f_{i}$ while providing a phase margin of $80^{\circ}$. What value of $f_{i}$ is realized? What is the corresponding frequency of the dominant pole?
(e) To what value should $C_{C}$ be changed to double the value of $f_{i}$ ? At the new value of $f_{i}$, what is the phase shift introduced by the second pole? To reduce this excess phase shift to $10^{\circ}$ and thus obtain an $80^{\circ}$ phase margin, as before, what value should $R$ be changed to?
13.11 A two-stage CMOS op amp has each of its first-stage transistors $Q_{1}$ and $Q_{2}$ operating at an overdrive voltage of 0.2 V . The op amp has a uniform $-20-\mathrm{dB} /$ decade frequency response with a unity-gain frequency of 100 MHz . What do you expect the slew rate of this amplifier to be? If each of $Q_{1}$ and $Q_{2}$ is biased at $50 \mu \mathrm{~A}$, what must the value of $C_{C}$ be?

D 13.12 A two-stage CMOS op amp similar to that in Fig. 13.1 is found to have a capacitance between the output node and ground of 0.7 pF . If it is desired to have a unity-gain bandwidth $f_{i}$ of 100 MHz with a phase margin of $72^{\circ}$ what must $g_{m 6}$ be set to? Assume that a resistance $R$ is connected in series with the frequency-compensation capacitor $C_{C}$ and adjusted to place the transmission zero at infinity. What value should $R$ have? If the first stage is operated at $\left|V_{O V}\right|=0.15 \mathrm{~V}$, what is the value of slew rate obtained? If the first-stage bias current $I=100 \mu \mathrm{~A}$, what is the required value of $C_{C}$ ?

D 13.13 A CMOS op amp with the topology shown in Fig. 13.1 is designed to provide $G_{m 1}=1 \mathrm{~mA} / \mathrm{V}$ and $G_{m 2}=5 \mathrm{~mA}$.
(a) Find the value of $C_{C}$ that results in $f_{i}=80 \mathrm{MHz}$.
(b) What is the maximum value that $C_{2}$ can have while achieving a $70^{\circ}$ phase margin?

D 13.14 A CMOS op amp with the topology shown in Fig. 13.1 but with a resistance $R$ included in series with $C_{C}$ is designed to provide $G_{m 1}=0.8 \mathrm{~mA} / \mathrm{V}$ and $G_{m 2}=2 \mathrm{~mA} / \mathrm{V}$.
(a) Find the value of $C_{C}$ that results in $f_{i}=100 \mathrm{MHz}$.
(b) For $R=500 \Omega$, what is the maximum allowed value of $C_{2}$ for which a phase margin of at least $60^{\circ}$ is obtained?
13.15 A two-stage CMOS op amp resembling that in Fig. 13.1 is found to have a slew rate of $60 \mathrm{~V} / \mu \mathrm{s}$ and a unity-gain bandwidth $f_{i}$ of 60 MHz .
(a) Estimate the value of the overdrive voltage at which the input-stage transistors are operating.
(b) If the first-stage bias current $I=120 \mu \mathrm{~A}$, what value of $C_{C}$ must be used?
(c) For a process for which $\mu_{a} C_{o s}=60 \mu \mathrm{~A} / \mathrm{V}^{2}$, what $W / L$ ratio applies for $Q_{1}$ and $Q_{2}$ ?
D 13.16 Sketch the circuit of a two-stage CMOS amplifier having the structure of Fig. 13.1 but utilizing NMOS transistors in the input stage (i.e., $Q_{1}$ and $Q_{2}$ ).

D 13.17 (a) Show that the $\mathrm{PSRR}^{-}$of a CMOS two-stage op amp for which all transistors have the same channel length and are operated at equal $\left|V_{O V}\right|$ is given by

$$
\mathrm{PSRR}^{-}=2\left|\frac{V_{A}}{V_{O V}}\right|^{2}
$$

(b) For $\left|V_{O V}\right|=0.15 \mathrm{~V}$, what is the minimum channel length required to obtain a $\mathrm{PSRR}^{-}$of 72 dB ? For the technology available, $\left|V_{A}^{\prime}\right|=15 \mathrm{~V} / \mu \mathrm{m}$.

D 13.18 It is required to design the circuit of Fig. 13.8 to provide a bias current $I_{\text {REF }}$ of $225 \mu \mathrm{~A}$ with $Q_{8}$ and $Q_{9}$ as matched devices having $W / L=60 / 0.5$. Transistors $Q_{10}, Q_{11}$, and $Q_{13}$ are to be identical and must have the same $g_{m}$ as $Q_{8}$ and $Q_{9}$. Transistor $Q_{12}$ is to be four times as wide as $Q_{13}$. Let $k_{a}^{\prime}=3 k_{b}^{\prime}=180 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $V_{m}=\left|V_{W}\right|=0.5 \mathrm{~V}$; let all channel lengths be equal; and let $V_{D D}=V_{E E}=1.5 \mathrm{~V}$. Find the required value of $R_{B}$. What is the voltage drop across $R_{B}$ ? Also specify the $W / L$ ratios of $Q_{10}, Q_{11}, Q_{12}$, and $Q_{13}$ and give the expected dc voltages at the gates of $Q_{12}, Q_{10}$, and $Q_{8}$.

[^0]
[^0]:    13.15 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
## Section 13.2: The Folded-Cascode CMOS Op Amp

D 13.19 The op-amp circuit of Fig. 13.10 is operated from $\pm 1-\mathrm{V}$ power supplies. If the power dissipated in the circuit is to be limited to 1 mW , find the maximum value of $I_{B}$ allowed. If this value is used, and each of $Q_{1}$ and $Q_{2}$ is to be biased at a current four times that used for each of $Q_{3}$ and $Q_{4}$, find the value of $I, I_{D 1,2}$, and $I_{D 3,4}$.
D 13.20 For the folded-cascode op amp in Fig. 13.10 utilizing power supplies of $\pm 1 \mathrm{~V}$, find the values of $V_{\text {BIAS1 }}, V_{\text {BIAS2 }}$, and $V_{\text {BIAS3 }}$ to maximize the allowable range of $V_{I C M}$ and $v_{O}$. Assume that all transistors are operated at equal overdrive voltages of 0.15 V . Assume $\left|V_{i}\right|$ for all devices is 0.4 V . Specify the maximum range of $V_{I C M}$ and of $v_{O}$.

D 13.21 For the folded-cascode op-amp circuit of Figs. 13.9 and 13.10 with bias currents $I=400 \mu \mathrm{~A}$ and $I_{B}=250 \mu \mathrm{~A}$, and with all transistors operated at overdrive voltages of 0.2 V , find the $W / L$ ratios for all devices. Assume that the technology available is characterized by $k_{n}^{\prime}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $k_{p}^{\prime}=100 \mu \mathrm{~A} / \mathrm{V}^{2}$.
13.22 Consider a design of the cascode op amp of Fig. 13.10 for which $I=400 \mu \mathrm{~A}$ and $I_{B}=250 \mu \mathrm{~A}$. Assume that all transistors are operated at $\left|V_{O V}\right|=0.2 \mathrm{~V}$ and that for all devices, $\left|V_{A}\right|=10 \mathrm{~V}$. Find $G_{m}, R_{e}$, and $A_{e}$. Also, if the op amp is connected in the feedback configuration shown in Fig. P13.22, find the voltage gain and output resistance of the closed-loop amplifier.


Figure P13.22

D 13.23 Consider the folded-cascode op amp of Fig. 13.9 when loaded with a $10-\mathrm{pF}$ capacitance. What should the bias current $I_{B}$ be to obtain a slew rate of at least $10 \mathrm{~V} / \mu \mathrm{s}$ ? If the input-stage transistors are biased at a current three times that at which each of $Q_{3}$ and $Q_{4}$ is biased, find the value of $I$. If the
input-stage transistors are operated at overdrive voltages of 0.15 V , what is the unity-gain bandwidth realized? If the two nondominant poles have the same frequency of 50 MHz , what is the phase margin obtained? If it is required to have a phase margin of $75^{\circ}$, what must $f_{s}$ be reduced to? By what amount should $C_{L}$ be increased? What is the new value of $S R$ ?
13.24 For a particular design of the folded-cascode op amp in Fig. 13.9, $I<I_{B}$. What slew rate is obtained?

D *13.25 Design the folded-cascode circuit of Fig. 13.10 to provide voltage gain of 80 dB and a unity-gain frequency of 20 MHz when $C_{L}=10 \mathrm{pF}$. Design for $I_{B}=I$, and operate all devices at the same $\left|V_{O V}\right|$. Utilize transistors with $1-\mu \mathrm{m}$ channel length for which $\left|V_{A}\right|$ is specified to be 12 V . Find the required overdrive voltages and bias currents. What slew rate is achieved? Also, for $k_{n}^{\prime}=2.5 k_{p}^{\prime}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$, specify the required width of each of the 11 transistors used.

D 13.26 Sketch the circuit that is complementary to that in Fig. 13.10, that is, one that uses an input $p$-channel differential pair.
**13.27 This problem presents a very interesting addition to the folded-cascode op-amp circuit of Fig. 13.10, designed to deal with the situation during amplifier slewing. In particular, the additional circuitry does two things: It prevents $Q_{1}$ and $Q_{11}$ from going into the triode region, and it increases the current available to charge $C_{L}$ and thus increases the slew rate. The circuit is shown in Fig. P13.27 (with the current-mirror circuit omitted, for simplicity). Observe that three transistors are added: $Q_{14}$, which is biased by a constant-current source $(20 \mu \mathrm{~A})$, establishes the dc currents in $Q_{9}$ and $Q_{10}$. Assume with respect to $Q_{9}$ and $Q_{10}$ that each has a $W / L$ ratio 10 times that of $Q_{14}$. The other two additional transistors are $Q_{12}$ and $Q_{13}$, which are diode connected and are normally cut off.
(a) For $V_{i d}=0$, find the bias current in each of $Q_{1}, Q_{2}, Q_{3}$, $Q_{4}, Q_{14}, Q_{9}$, and $Q_{10}$. Also, for the dc voltages shown, and assuming $V_{t o}=\left|V_{t p}\right|=0.45 \mathrm{~V}$ and that all conducting devices are operating at $\left|V_{O V}\right|=0.15 \mathrm{~V}$, show that $Q_{12}$ and $Q_{13}$ will be cut off.
(b) For an input differential signal that causes $Q_{2}$ to turn off and $Q_{1}$ to conduct the entire bias current ( $320 \mu \mathrm{~A}$ ), $Q_{12}$ turns on (while $Q_{13}$ remains off). Noting that the drain current of $Q_{12}$ adds to the $20 \mu \mathrm{~A}$ flowing through $Q_{14}$, find the current that now flows through $Q_{10}$ and onto $C_{L}$.

[^0]
[^0]:    $1 \mathrm{H}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem


Figure P13.27

By what factor does the slew rate increase relative to the value without $Q_{12}$ present? Also give an approximate estimate of the voltage at the drain of $Q_{1}$ during the slewing transient.
13.28 For the circuit in Fig. 13.12, assume that all transistors are operating at equal overdrive voltages of $0.15-\mathrm{V}$ magnitude and have $\left|V_{t}\right|=0.45 \mathrm{~V}$ and that $V_{D D}=V_{S S}=1 \mathrm{~V}$. Find (a) the range over which the NMOS input stage operates, (b) the range over which the PMOS input stage operates, (c) the range over which both operate (the overlap range), and (d) the input common-mode range. Assume that all current sources require a minimum voltage of $\left|V_{O V}\right|$ to operate properly.
13.29 A particular design of the wide-swing current mirror of Fig. 13.13(b) utilizes devices having $W / L=20$, $k_{n}^{\prime}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $V_{t}=0.45 \mathrm{~V}$. For $I_{\mathrm{REF}}=90 \mu \mathrm{~A}$, what value of $V_{\text {BIAS }}$ is needed? Also give the voltages that you expect to appear at all nodes and specify the minimum voltage allowable at the output terminal. If $V_{A}$ is specified to be 10 V , what is the output resistance of the mirror?

D 13.30 For the folded-cascode circuit of Fig. 13.9, let the total capacitance to ground at each of the source nodes of $Q_{3}$ and $Q_{4}$ be denoted $C_{P}$. Assuming that the incremental resistance between the drain of $Q_{3}$ and ground is small, show that the pole that arises at the interface between the first and second stages has a frequency $f_{P} \simeq g_{m 3} / 2 \pi C_{P}$. Now, if this is the only nondominant pole, what is the largest value that $C_{P}$ can be (expressed as a fraction of $C_{L}$ ) while a phase margin of $80^{\circ}$ is achieved? Assume that all transistors are operated at the same bias current and overdrive voltage.

## Section 13.3: The 741 BJT Op Amp

13.31 In the 741 op-amp circuit of Fig. 13.14, $Q_{1}, Q_{2}, Q_{5}$, and $Q_{6}$ are biased at collector currents of $9.5 \mu \mathrm{~A} ; Q_{16}$ is biased at a collector current of $16.2 \mu \mathrm{~A}$; and $Q_{17}$ is biased at a collector current of $550 \mu \mathrm{~A}$. All these devices are of the "standard $n p n$ " type, having $I_{S}=10^{-14} \mathrm{~A}, \beta=200$, and $V_{A}=125 \mathrm{~V}$. For each of these transistors, find $V_{B E}, g_{m}, r_{e}, r_{n}$, and $r_{c}$. Provide your results in table form. (Note that these parameter values are utilized in the text in the analysis of the 741 circuit.)
D 13.32 For the circuit in Fig. P13.32, neglect base currents and use the exponential $i_{C}-v_{B E}$ relationship to show that

$$
I_{3}=I_{1} \sqrt{\frac{I_{S 3} I_{S 4}}{I_{S 1} I_{S 2}}}
$$

Find $I_{1}$ for the case in which $I_{S 3}=I_{S 4}=3 \times 10^{-14} \mathrm{~A}, I_{S 1}=$ $I_{S 2}=10^{-14} \mathrm{~A}$, and a bias current $I_{3}=150 \mu \mathrm{~A}$ is required.


Figure P13.32
13.33 Transistor $Q_{13}$ in the circuit of Fig. 13.14 consists, in effect, of two transistors whose emitter-base junctions are connected in parallel and for which $I_{S A}=0.25 \times 10^{-14} \mathrm{~A}$, $I_{S B}=0.75 \times 10^{-14} \mathrm{~A}, \beta=50$, and $V_{A}=50 \mathrm{~V}$. For operation at a total emitter current of 0.73 mA , find values for the parameters $V_{E B}, g_{m}, r_{e}, r_{\pi}$, and $r_{o}$ for the A and B devices.
13.34 In the circuit of Fig. 13.14, $Q_{1}$ and $Q_{3}$ exhibit emitter-base breakdown at 7 V , while for $Q_{3}$ and $Q_{4}$ such a breakdown occurs at about 50 V . What differential input voltage would result in the breakdown of the input-stage transistors?

D 13.35 Figure P13.35 shows the CMOS version of the circuit in Fig. P13.32. Find the relationship between $I_{3}$ and $I_{1}$ in terms of $k_{1}, k_{2}, k_{3}$, and $k_{4}$ of the four transistors, assuming the threshold voltages of all devices to be equal in magnitude. Note that $k$ denotes $\mu C_{o s} W / L$. In the event that $k_{1}=k_{2}$ and
$k_{3}=k_{4}=16 k_{1}$, find the required value of $I_{1}$ to yield a bias current in $Q_{3}$ and $Q_{4}$ of 1.6 mA .


Figure P13.35

D 13.36 For the 741 circuit, estimate the reference current $I_{\text {REF }}$ in the event that $\pm 10-\mathrm{V}$ supplies are used. What value of $R_{S}$ would be necessary to reestablish the same bias current for $\pm 10-\mathrm{V}$ supplies as exists for $\pm 15 \mathrm{~V}$ in the original design?

D 13.37 Design a Widlar current source to supply a current of $10 \mu \mathrm{~A}$ given a reference input current of 0.3 mA . Assume that the transistors have $I_{S}=10^{-14} \mathrm{~A}$ and high $\beta$. Find $V_{B E}$ of each of the two transistors as well as the value of $R$.
13.38 Consider the dc analysis of the 741 input stage shown in Fig. 13.15.
(a) Derive an expression for $I$ taking $\beta_{P}$ into account. What is the percentage change in $I$ if $\beta_{P}$ drops from 50 to 20 ?
(b) Now, consider an alternative design of this circuit in which the feedback loop is eliminated. That is, $Q_{8}$ and $Q_{9}$ are eliminated and $I_{C 10}$ is fed to the common-base connection of $Q_{3}$ and $Q_{4}$. What is $I$ now in terms of $I_{C 10}$ ? If $\beta_{P}$ changes from 50 to 20 , what is the resulting percentage change in $I$ ?

D 13.39 Consider the dc analysis of the 741 input stage shown in Fig. 13.15 for the situation in which $I_{S 9}=2 I_{S 8}$. For $I_{C 10}=19 \mu \mathrm{~A}$ and assuming $\beta_{p}$ to be high, what does $I$ become? Redesign the Widlar source to reestablish $I_{C 1}=$ $I_{C 2}=9.5 \mu \mathrm{~A}$.

[^0]
[^0]:    $S I A=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
D 13.40 Consider the circuit shown in Fig. 13.15. If $I_{C 10}=$ $40 \mu \mathrm{~A}$ and $I$ is required to be $10 \mu \mathrm{~A}$, what must be the ratio of the emitter-junction area of $Q_{8}$ to that area of $Q_{8}$ ? Assume that $\beta_{P}$ is large.
13.41 For the mirror circuit shown in Fig. 13.16 with the bias and component values given in the text for the 741 circuit, what does the current in $Q_{6}$ become if $R_{2}$ is shorted?

D 13.42 It is required to redesign the circuit of Fig. 13.16 by selecting a new value for $R_{3}$ so that when the base currents are not neglected, the collector currents of $Q_{3}, Q_{6}$, and $Q_{7}$ all become equal, assuming that the input current $I_{C 3}=9.5 \mu \mathrm{~A}$. Find the new value of $R_{3}$ and the three currents. Recall that $\beta_{N}=200$.
13.43 Consider the input circuit of the 741 op amp of Fig. 13.14 when the emitter current of $Q_{8}$ is about $19 \mu \mathrm{~A}$. If $\beta$ of $Q_{1}$ is 150 and that of $Q_{2}$ is 220 , find the input bias current $I_{B}$ and the input offset current $I_{O S}$ of the op amp.
13.44 For a particular application, consideration is being given to selecting 741 ICs for input bias and offset currents limited to 60 nA and 5 nA , respectively. Assuming other aspects of the selected units to be normal, what minimum $\beta_{N}$ and what $\beta_{N}$ variation are implied?
13.45 For a 741 employing $\pm 5-\mathrm{V}$ supplies, $\left|V_{B E}\right|=0.6 \mathrm{~V}$, and $\left|V_{C E s a t}\right|=0.2 \mathrm{~V}$, find the input common-mode range. Neglect the voltage drops across $R_{1}$ and $R_{2}$.

D 13.46 Consider the design of the second stage of the 741. What value of $R_{9}$ would be needed to reduce $I_{C 16}$ to $9.5 \mu \mathrm{~A}$ ? (Hint: Build on Exercise 13.21)

D 13.47 Reconsider the 741 output stage as shown in Fig. 13.17, in which $R_{10}$ is adjusted to make $I_{C 19}=I_{C 18}$. What is the new value of $R_{10}$ ? What values of $I_{C 14}$ and $I_{C 20}$ result? Recall that $I_{\text {REF }}=0.73 \mathrm{~mA}$.

D*13.48 An alternative approach to providing the voltage drop needed to bias the output transistors is the $V_{B E}$-multiplier circuit shown in Fig. P13.48. Design the circuit to provide a terminal voltage of 1.118 V (the same as in the 741 circuit). Base your design on half the current flowing through $R_{1}$, and assume that $I_{S}=10^{-14} \mathrm{~A}$ and $\beta=200$. What is the incremental
resistance between the two terminals of the $V_{B E}$-multiplier circuit?


Figure P13.48
13.49 For the circuit of Fig. 13.14, what is the total current required from the power supplies when the op amp is operated in the linear mode, but with no load? Hence, estimate the quiescent power dissipation in the circuit. (Hint: Use the data given in Table 13.1.)
13.50 Consider the 741 input stage as modeled in Fig. 13.18, with two additional $n p n$ diode-connected transistors, $Q_{1 o}$ and $Q_{2 o}$, connected between the present $n p n$ and $p n p$ devices, one per side. Convince yourself that each of the additional devices will be biased at the same current as $Q_{1}$ to $Q_{4}$-that is, $9.5 \mu \mathrm{~A}$. What does $R_{o I}$ become? What does $G_{m 1}$ become? What is the value of $R_{o 4}$ now? What is the output resistance of the first stage, $R_{o 1}$ ? (Note that $R_{o 6}$ remains unchanged at $18.2 \mathrm{M} \Omega$.) What is the new open-circuit voltage gain, $G_{m 1} R_{o 1}$ ? Compare these values with the original ones, namely, $R_{o I}=21 \mathrm{M} \Omega$, $G_{m 1}=0.19 \mathrm{~mA} / \mathrm{V}, R_{o 4}=10.5 \mathrm{M} \Omega, R_{o 1}=6.7 \mathrm{M} \Omega$, and $\left|A_{s o r}\right|=1273 \mathrm{~V} / \mathrm{V}$.
13.51 Consider the current mirror in Fig. 13.19. What value must $R_{2}$ be increased to in order to increase $R_{o 6}$ by a factor of 2 ? Recall that $Q_{6}$ is operating at $I_{C 6}=9.5 \mu \mathrm{~A}$ and has $\beta=200$ and $V_{A}=125 \mathrm{~V}$.
13.52 Repeat Exercise 13.24 with $R_{1}=R_{2}$ replaced by $2-\mathrm{k} \Omega$ resistors.

[^0]
[^0]:    $E I B=$ Multisim/PSpice; * = difficult problem; ** = more difficult; ${ }^{* * *}=$ very challenging; $D=$ design problem
13.53 A manufacturing problem in a 741 op amp causes the current-transfer ratio of the mirror circuit that loads the input stage to become $0.8 \mathrm{~A} / \mathrm{A}$. For input devices $\left(Q_{1}-Q_{4}\right)$ appropriately matched and with high $\beta$, and normally biased at $9.5 \mu \mathrm{~A}$, what input offset voltage results?
*13.54 In Example 13.4 we investigated the effect of a mismatch between $R_{1}$ and $R_{2}$ on the input offset voltage of the op amp. Conversely, $R_{1}$ and $R_{2}$ can be deliberately mismatched (using the circuit shown in Fig. P13.54, for example) to compensate for the op-amp input offset voltage.
(a) Show that an input offset voltage $V_{O S}$ can be compensated for (i.e., reduced to zero) by creating a relative mismatch $\Delta R / R$ between $R_{1}$ and $R_{2}$,

$$
\frac{\Delta R}{R}=\frac{V_{O S}}{2 V_{T}} \frac{1+r_{e} / R}{1-V_{O S} / 2 V_{T}}
$$

where $r_{e}$ is the emitter resistance of each of $Q_{1}$ to $Q_{6}$, and $R$ is the nominal value of $R_{1}$ and $R_{2}$. (Hint: Use Eq. 13.94.)
(b) Find $\Delta R / R$ to trim a $3-\mathrm{mV}$ offset to zero.
(c) What is the maximum offset voltage that can be trimmed this way (corresponding to $R_{2}$ completely shorted)? (Recall that each of $Q_{5}$ and $Q_{6}$ is biased at $9.5 \mu \mathrm{~A}$.)


Figure P13.54
13.55 Through a processing imperfection, the $\beta$ of $Q_{4}$ in Fig. 13.14 is reduced to 10 , while the $\beta$ of $Q_{3}$ remains at its regular value of 50 . Assuming that the collector current of $Q_{3}$ remains unchanged at $9.5 \mu \mathrm{~A}$, find the net output dc current of
the $Q_{5}-Q_{6}$ mirror, and hence find also the input offset voltage that this mismatch introduces.
13.56 If the current transfer ratio of the mirror load of the 741 input stage is 0.995 , find the CMRR of the input stage. (Hint: Use Eq. 13.102 together with the output resistance values determined in Exercise 13.28. Recall that the input-stage transistors are biased at $9.5 \mu \mathrm{~A}$.)
13.57 Consider the circuit of Fig. 13.14 modified to include resistors $R$ in series with the emitters of each of $Q_{8}$ and $Q_{9}$. What does the resistance looking into the collector of $Q_{9}, R_{o 9}$, become? For what value of $R$ does it equal $R_{o 10}$ (i.e., $31.1 \mathrm{M} \Omega$ )? For this case, what does $R_{o}$ looking to the left of node $Y$ become? (Recall that $Q_{9}$ is biased at 0.73 mA .)
*13.58 What is the effect on the differential gain of the 741 op amp of short-circuiting one or the other or both of $R_{1}$ and $R_{2}$ in Fig. 13.14? (Refer to Fig. 13.19.) For simplicity, assume $\beta=\infty$.
13.59 An alternative approach to that presented in Example 13.5 for determining the CMRR of the 741 input stage is investigated in this problem. Rather than performing the analysis on the closed loop shown in Fig. 13.23, we observe that the negative feedback increases the resistance at node Y by the amount of negative feedback. Thus, we can break the loop at Y and connect a resistance $R_{f}=(1+A \beta) R_{o}$ between the common-base connection of $Q_{3}-Q_{4}$ and ground. We can then determine the current $i$ and $G_{m c m}$. Using the fact that the loop gain is approximately equal to $\beta_{P}$ (Exercise 13.17) show that this approach yields an identical result to that found in Example 13.5.
13.60 Consider a variation on the design of the 741 second stage in which $R_{8}=50 \Omega$. What $R_{i 2}$ and $G_{m 2}$ correspond?

D 13.61 In the analysis of the 741 second stage, note that $R_{o 2}$ is affected most strongly by the low value of $R_{o 13 B}$. Consider the effect of placing appropriate resistors in the emitters of $Q_{12}, Q_{13 A}$, and $Q_{13 B}$ on this value. What resistor in the emitter of $Q_{13 B}$ would be required to make $R_{o 13 B}$ equal to $R_{o 17}$ and thus $R_{o 2}$ half as great? What resistors in each of the other emitters would be required?# EXERCISES 

2.15 Consider the difference-amplifier circuit of Fig. 2.16 for the case $R_{1}=R_{3}=2 \mathrm{k} \Omega$ and $R_{2}=R_{4}=200 \mathrm{k} \Omega$. (a) Find the value of the differential gain $A_{d}$. (b) Find the value of the differential input resistance $R_{i d}$ and the output resistance $R_{o}$. (c) If the resistors have $1 \%$ tolerance (i.e., each can be within $\pm 1 \%$ of its nominal value), use Eq. (2.19) to find the worst-case common-mode gain $A_{c m}$ and hence the corresponding value of CMRR.
Ans. (a) $100 \mathrm{~V} / \mathrm{V}(40 \mathrm{~dB})$; (b) $4 \mathrm{k} \Omega, 0 \Omega$; (c) $0.04 \mathrm{~V} / \mathrm{V}, 68 \mathrm{~dB}$
D2.16 Find values for the resistances in the circuit of Fig. 2.16 so that the circuit behaves as a difference amplifier with an input resistance of $20 \mathrm{k} \Omega$ and a gain of 10 .
Ans. $R_{1}=R_{3}=10 \mathrm{k} \Omega ; R_{2}=R_{4}=100 \mathrm{k} \Omega$

### 2.4.2 A Superior Circuit—The Instrumentation Amplifier

The low-input-resistance problem of the difference amplifier of Fig. 2.16 can be solved by using voltage followers to buffer the two input terminals; that is, a voltage follower of the type in Fig. 2.14 is connected between each input terminal and the corresponding input terminal of the difference amplifier. However, if we are going to use two additional op amps, we should ask the question: Can we get more from them than just impedance buffering? An obvious answer would be that we should try to get some voltage gain. It is especially interesting that


Figure 2.20 A popular circuit for an instrumentation amplifier. (a) Initial approach to the circuit. (b) The circuit in (a) with the connection between node X and ground removed and the two resistors $R_{1}$ and $R_{3}$ lumped together. This simple wiring change dramatically improves performance. (c) Analysis of the circuit in (b) assuming ideal op amps.


Figure 2.20 continued
we can achieve this without compromising the high input resistance simply by using followers with gain rather than unity-gain followers. Achieving some or indeed the bulk of the required gain in this new first stage of the differential amplifier eases the burden on the difference amplifier in the second stage, leaving it to its main task of implementing the differencing function and thus rejecting common-mode signals.

The resulting circuit is shown in Fig. 2.20(a). It consists of two stages in cascade. The first stage is formed by op amps $A_{1}$ and $A_{2}$ and their associated resistors, and the second stage is the by-now-familiar difference amplifier formed by op amp $A_{3}$ and its four associated resistors. Observe that as we set out to do, each of $A_{1}$ and $A_{2}$ is connected in the noninverting configuration and thus realizes a gain of $\left(1+R_{2} / R_{1}\right)$. It follows that each of $v_{I 1}$ and $v_{I 2}$ is amplified by this factor, and the resulting amplified signals appear at the outputs of $A_{1}$ and $A_{2}$, respectively.

The difference amplifier in the second stage operates on the difference signal $\left(1+R_{2} / R_{1}\right)\left(v_{I 2}-v_{I 1}\right)=\left(1+R_{2} / R_{1}\right) v_{I d}$ and provides at its output

$$
v_{O}=\frac{R_{4}}{R_{3}}\left(1+\frac{R_{2}}{R_{1}}\right) v_{I d}
$$
Thus the differential gain realized is

$$
A_{d}=\left(\frac{R_{4}}{R_{3}}\right)\left(1+\frac{R_{2}}{R_{1}}\right)
$$

The common-mode gain will be zero because of the differencing action of the second-stage amplifier.

The circuit in Fig. 2.20(a) has the advantage of very high (ideally infinite) input resistance and high differential gain. Also, provided $A_{1}$ and $A_{2}$ and their corresponding resistors are matched, the two signal paths are symmetric-a definite advantage in the design of a differential amplifier. The circuit, however, has three major disadvantages:

1. The input common-mode signal $v_{l c m}$ is amplified in the first stage by a gain equal to that experienced by the differential signal $v_{l d}$. This is a very serious issue, for it could result in the signals at the outputs of $A_{1}$ and $A_{3}$ being of such large magnitudes that the op amps saturate (more on op-amp saturation in Section 2.8). But even if the op amps do not saturate, the difference amplifier of the second stage will now have to deal with much larger common-mode signals, with the result that the CMRR of the overall amplifier will inevitably be reduced.
2. The two amplifier channels in the first stage have to be perfectly matched, otherwise a spurious signal may appear between their two outputs. Such a signal would get amplified by the difference amplifier in the second stage.
3. To vary the differential gain $A_{d}$, two resistors have to be varied simultaneously, say the two resistors labeled $R_{1}$. At each gain setting the two resistors have to be perfectly matched: a difficult task.

All three problems can be solved with a very simple wiring change: Simply disconnect the node between the two resistors labeled $R_{1}$, node X , from ground. The circuit with this small but functionally profound change is redrawn in Fig. 2.20(b), where we have lumped the two resistors ( $R_{1}$ and $R_{1}$ ) together into a single resistor $\left(2 R_{1}\right)$.

Analysis of the circuit in Fig. 2.20(b), assuming ideal op amps, is straightforward, as is illustrated in Fig. 2.20(c). The key point is that the virtual short circuits at the inputs of op amps $A_{1}$ and $A_{2}$ cause the input voltages $v_{I 1}$ and $v_{I 2}$ to appear at the two terminals of resistor $\left(2 R_{1}\right)$. Thus the differential input voltage $v_{I 2}-v_{I 1} \equiv v_{I d}$ appears across $2 R_{1}$ and causes a current $i=v_{I d} / 2 R_{1}$ to flow through $2 R_{1}$ and the two resistors labeled $R_{2}$. This current in turn produces a voltage difference between the output terminals of $A_{1}$ and $A_{2}$ given by

$$
v_{O 2}-v_{O 1}=\left(1+\frac{2 R_{2}}{2 R_{1}}\right) v_{I d}
$$

The difference amplifier formed by op amp $A_{3}$ and its associated resistors senses the voltage difference $\left(v_{O 2}-v_{O 1}\right)$ and provides a proportional output voltage $v_{O}$ :

$$
\begin{aligned}
v_{O} & =\frac{R_{3}}{R_{3}}\left(v_{O 2}-v_{O 1}\right) \\
& =\frac{R_{2}}{R_{3}}\left(1+\frac{R_{2}}{R_{1}}\right) v_{I d}
\end{aligned}
$$
Thus the overall differential voltage-gain is given by

$$
A_{d} \equiv \frac{v_{O}}{v_{I d}}=\frac{R_{4}}{R_{3}}\left(1+\frac{R_{2}}{R_{1}}\right)
$$

Observe that proper differential operation does not depend on the matching of the two resistors labeled $R_{2}$. Indeed, if one of the two is of different value, say $R_{2}^{\prime}$, the expression for $A_{d}$ becomes

$$
A_{d}=\frac{R_{4}}{R_{3}}\left(1+\frac{R_{2}+R_{2}^{\prime}}{2 R_{1}}\right)
$$

Consider next what happens when the two input terminals are connected together to a common-mode input voltage $v_{I c m}$. It is easy to see that an equal voltage appears at the negative input terminals of $A_{1}$ and $A_{2}$, causing the current through $2 R_{1}$ to be zero. Thus there will be no current flowing in the $R_{2}$ resistors, and the voltages at the output terminals of $A_{1}$ and $A_{2}$ will be equal to the input (i.e., $v_{I c m}$ ). Thus the first stage no longer amplifies $v_{I c m}$; it simply propagates $v_{I c m}$ to its two output terminals, where they are subtracted to produce a zero common-mode output by $A_{3}$. The difference amplifier in the second stage, however, now has a much improved situation at its input: The difference signal has been amplified by $\left(1+R_{2} / R_{1}\right)$ while the common-mode voltage remained unchanged.

Finally, we observe from the expression in Eq. (2.22) that the gain can be varied by changing only one resistor, $2 R_{1}$. We conclude that this is an excellent differential amplifier circuit and is widely employed as an instrumentation amplifier, that is, as the input amplifier used in a variety of electronic instruments.

## INTEGRATED INSTRUMENTATION AMPLIFIERS:

The conventional combination of three op amps and a number of precision resistors to form an instrumentation amplifier is an extremely powerful tool for the design of instruments for many applications. While the earliest applications used separate op amps and discrete resistors, fully integrated versions incorporating most required components in a single integrated-circuit package are increasingly available from many manufacturers. Low-power versions of these units are extremely important in the design of portable, wearable, and implantable medical monitoring devices, such as wristband activity monitors.

# Example 2.3 

Design the instrumentation amplifier circuit in Fig. 2.20(b) to provide a gain that can be varied over the range of 2 to 1000 utilizing a $100-\mathrm{k} \Omega$ variable resistance (a potentiometer, or "pot" for short).

## Solution

It is usually preferable to obtain all the required gain in the first stage, leaving the second stage to perform the task of taking the difference between the outputs of the first stage and thereby rejecting the common-mode signal. In other words, the second stage is usually designed for a gain of 1 . Adopting this approach, we select
# Example 2.3 continued 

all the second-stage resistors to be equal to a practically convenient value, say $10 \mathrm{k} \Omega$. The problem then reduces to designing the first stage to realize a gain adjustable over the range of 2 to 1000 . Implementing $2 R_{1}$ as the series combination of a fixed resistor $R_{1 f}$ and the variable resistor $R_{1 v}$ obtained using the $100-\mathrm{k} \Omega$ pot (Fig. 2.21), we can write

$$
1+\frac{2 R_{2}}{R_{1 f}+R_{1 v}}=2 \text { to } 1000
$$

Thus,

$$
1+\frac{2 R_{2}}{R_{1 f}}=1000
$$

and

$$
1+\frac{2 R_{2}}{R_{1 f}+100 \mathrm{k} \Omega}=2
$$

These two equations yield $R_{1 f}=100.2 \Omega$ and $R_{2}=50.050 \mathrm{k} \Omega$. Other practical values may be selected; for instance, $R_{1 f}=100 \Omega$ and $R_{2}=49.9 \mathrm{k} \Omega$ (both values are available as standard $1 \%$-tolerance metal-film resistors; see Appendix J) results in a gain covering approximately the required range.


Figure 2.21 To make the gain of the circuit in Fig. 2.20(b) variable, $2 R_{1}$ is implemented as the series combination of a fixed resistor $R_{1 f}$ and a variable resistor $R_{1 v}$. Resistor $R_{1 f}$ ensures that the maximum available gain is limited.

## EXERCISE

2.17 Consider the instrumentation amplifier of Fig. 2.20(b) with a common-mode input voltage of +5 V (dc) and a differential input signal of $10-\mathrm{mV}$-peak sine wave. Let $\left(2 R_{1}\right)=1 \mathrm{k} \Omega, R_{2}=0.5 \mathrm{M} \Omega$, and $R_{3}=R_{4}=10 \mathrm{k} \Omega$. Find the voltage at every node in the circuit.
Ans. $v_{11}=5-0.005 \sin \omega t ; v_{12}=5+0.005 \sin \omega t ; v_{-}\left(\right.$op amp $\left.A_{1}\right)=5-0.005 \sin \omega t ; v_{-}\left(\right.$op amp $\left.A_{2}\right)=5+$ $0.005 \sin \omega t ; v_{O 1}=5-5.005 \sin \omega t ; v_{O 2}=5+5.005 \sin \omega t ; v_{-}\left(A_{3}\right)=v_{+}\left(A_{3}\right)=2.5+2.5025 \sin \omega t ; v_{O}=$ $10.01 \sin \omega t$ (all in volts)
# 2.5 Integrators and Differentiators 

The op-amp circuit applications we have studied thus far utilized resistors in the op-amp feedback path and in connecting the signal source to the circuit, that is, in the feed-in path. As a result, circuit operation has been (ideally) independent of frequency. By allowing the use of capacitors together with resistors in the feedback and feed-in paths of op-amp circuits, we open the door to a very wide range of useful and exciting applications of the op amp. We begin our study of op-amp- $R C$ circuits by considering two basic applications, namely, signal integrators and differentiators. ${ }^{3}$

### 2.5.1 The Inverting Configuration with General Impedances

To begin with, consider the inverting closed-loop configuration with impedances $Z_{1}(s)$ and $Z_{2}(s)$ replacing resistors $R_{1}$ and $R_{2}$, respectively. The resulting circuit is shown in Fig. 2.22 and, for an ideal op amp, has the closed-loop gain or, more appropriately, the closed-loop transfer function

$$
\frac{V_{o}(s)}{V_{i}(s)}=-\frac{Z_{2}(s)}{Z_{1}(s)}
$$

As explained in Section 1.6, replacing $s$ by $j \omega$ provides the transfer function for physical frequencies $\omega$, that is, the transmission magnitude and phase for a sinusoidal input signal of frequency $\omega$.


Figure 2.22 The inverting configuration with general impedances in the feedback and the feed-in paths.

[^0]
[^0]:    ${ }^{3}$ At this point, a review of Section 1.6 would be helpful. Also, an important fact to remember: Passing a constant current $I$ through a capacitor $C$ for a time $t$ causes a change of $I t$ to accumulate on the capacitor. Thus the capacitor voltage changes by $\triangle V=\triangle Q / C=I t / C$; that is, the capacitor voltage increases linearly with time.
## EARLY OP AMPS AND ANALOG COMPUTATION:

In 1941, Karl D. Swartzel Jr. of Bell Labs patented "the summing amplifier," a high-gain dc inverting amplifier, intended to be used with negative feedback. This precursor of the op amp used three vacuum tubes (the predecessor of the transistor) and $\pm 350-\mathrm{V}$ power supplies to achieve a gain of 90 dB . Though lacking a differential input, it provided the usual applications of summation, integration, and general filtering using convenient passive resistive and capacitive components.

Soon after (1942), Loebe Julie, working with Professor John R. Regazzini at Columbia University, created a differential version, still using vacuum tubes. During World War II, these units were used extensively to provide analog computational functions in association with radar-directed antiaircraft firing control involving aircraft speed projection.

In the early 1950s, driven by the demonstrated wartime success of op-amp-based computation, general-purpose commercial systems called "analog computers" began to appear. They consisted of a few dozen op amps and associated passive components, including potentiometers; the interconnections required for programming were achieved with plug boards. These computers were used to solve differential equations.

# Example 2.4 

For the circuit in Fig. 2.23, derive an expression for the transfer function $V_{o}(s) / V_{i}(s)$. Show that the transfer function is that of a low-pass STC circuit. By expressing the transfer function in the standard form shown in Table 1.2 on page 36, find the dc gain and the 3-dB frequency. Design the circuit to obtain a dc gain of 40 dB , a $3-\mathrm{dB}$ frequency of 1 kHz , and an input resistance of $1 \mathrm{k} \Omega$. At what frequency does the magnitude of transmission become unity? What is the phase angle at this frequency?


Figure 2.23 Circuit for Example 2.4.

## Solution

To obtain the transfer function of the circuit in Fig. 2.23, we substitute in Eq. (2.24), $Z_{1}=R_{1}$ and $Z_{2}=R_{2} \|\left(1 / s C_{2}\right)$. Since $Z_{2}$ is the parallel connection of two components, it is more convenient to work in terms of $Y_{2}$; that is, we use the following alternative form of the transfer function:

$$
\frac{V_{o}(s)}{V_{i}(s)}=-\frac{1}{Z_{1}(s) Y_{2}(s)}
$$
and substitute $Z_{1}=R_{1}$ and $Y_{2}(s)=\left(1 / R_{2}\right)+s C_{2}$ to obtain

$$
\frac{V_{o}(s)}{V_{i}(s)}=-\frac{1}{\frac{R_{1}}{R_{2}}+s C_{2} R_{1}}
$$

This transfer function is of first order, has a finite dc gain (at $s=0, V_{o} / V_{i}=-R_{2} / R_{1}$ ), and has zero gain at infinite frequency. Thus it is the transfer function of a low-pass STC network and can be expressed in the standard form of Table 1.2 as follows:

$$
\frac{V_{o}(s)}{V_{i}(s)}=\frac{-R_{2} / R_{1}}{1+s C_{2} R_{2}}
$$

from which we find the dc gain $K$ to be

$$
K=-\frac{R_{2}}{R_{1}}
$$

and the 3-dB frequency $\omega_{0}$ as

$$
\omega_{0}=\frac{1}{C_{2} R_{2}}
$$

We could have found all this from the circuit in Fig. 2.23 by inspection. Specifically, note that the capacitor behaves as an open circuit at dc; thus at dc the gain is simply $\left(-R_{2} / R_{1}\right)$. Furthermore, because there is a virtual ground at the inverting input terminal, the resistance seen by the capacitor is $R_{2}$, and thus the time constant of the STC network is $C_{2} R_{2}$.

Now to obtain a dc gain of 40 dB , that is, $100 \mathrm{~V} / \mathrm{V}$, we select $R_{2} / R_{1}=100$. For an input resistance of $1 \mathrm{k} \Omega$, we select $R_{1}=1 \mathrm{k} \Omega$, and thus $R_{2}=100 \mathrm{k} \Omega$. Finally, for a 3-dB frequency $f_{0}=1 \mathrm{kHz}$, we select $C_{2}$ from

$$
2 \pi \times 1 \times 10^{3}=\frac{1}{C_{2} \times 100 \times 10^{3}}
$$

which yields $C_{2}=1.59 \mathrm{nF}$.
The circuit has gain and phase Bode plots of the standard form in Fig. 1.23. As the gain falls off at the rate of $-20 \mathrm{~dB} /$ decade, it will reach 0 dB in two decades, that is, at $f=100 f_{0}=100 \mathrm{kHz}$. As Fig. 1.23(b) indicates, at such a frequency, which is much greater than $f_{0}$, the phase is approximately $-90^{\circ}$. To this, however, we must add the $180^{\circ}$ arising from the inverting nature of the amplifier (i.e., the negative sign in the transfer function expression). Thus at 100 kHz , the total phase shift will be $-270^{\circ}$ or, equivalently, $+90^{\circ}$.

# 2.5.2 The Inverting Integrator 

By placing a capacitor in the feedback path (i.e., in place of $Z_{2}$ in Fig. 2.22) and a resistor at the input (in place of $Z_{1}$ ), we obtain the circuit of Fig. 2.24(a). We shall now show that this circuit realizes the mathematical operation of integration. Let the input be a time-varying function $v_{I}(t)$. The virtual ground at the inverting op-amp input causes $v_{I}(t)$ to appear in effect
across $R$, and thus the current $i_{1}(t)$ will be $v_{I}(t) / R$. This current flows through the capacitor $C$, causing charge to accumulate on $C$. If we assume that the circuit begins operation at time $t=0$, then at an arbitrary time $t$ the current $i_{1}(t)$ will have deposited on $C$ a charge equal to $\int_{0}^{t} i_{1}(t) d t$. Thus the capacitor voltage $v_{C}(t)$ will change by $\frac{1}{C} \int_{0}^{t} i_{1}(t) d t$. If the initial voltage on $C$ (at $t=0$ ) is denoted $V_{C}$, then

$$
v_{C}(t)=V_{C}+\frac{1}{C} \int_{0}^{t} i_{1}(t) d t
$$

Now the output voltage $v_{O}(t)=-v_{C}(t)$; thus,

$$
v_{O}(t)=-\frac{1}{C R} \int_{0}^{t} v_{I}(t) d t-V_{C}
$$

Thus the circuit provides an output voltage that is proportional to the time integral of the input, with $V_{C}$ being the initial condition of integration and $C R$ the integrator time constant. Note that, as expected, there is a negative sign attached to the output voltage, and thus this integrator circuit is said to be an inverting integrator. It is also known as a Miller integrator after an early worker in this field.

The operation of the integrator circuit can be described alternatively in the frequency domain by substituting $Z_{1}(s)=R$ and $Z_{2}(s)=1 / s C$ in Eq. (2.24) to obtain the transfer function

$$
\frac{V_{o}(s)}{V_{i}(s)}=-\frac{1}{s C R}
$$

For physical frequencies, $s=j \omega$ and

$$
\frac{V_{o}(j \omega)}{V_{i}(j \omega)}=-\frac{1}{j \omega C R}
$$

Thus the integrator transfer function has magnitude

$$
\left|\frac{V_{o}}{V_{i}}\right|=\frac{1}{\omega C R}
$$

and phase

$$
\phi=+90^{\circ}
$$

The Bode plot for the integrator magnitude response can be obtained by noting from Eq. (2.28) that as $\omega$ doubles (increases by an octave) the magnitude is halved (decreased by 6 dB ). Thus the Bode plot is a straight line of slope $-6 \mathrm{~dB} /$ octave (or, equivalently, $-20 \mathrm{~dB} /$ decade). This line (shown in Fig. 2.24b) intercepts the $0-\mathrm{dB}$ line at the frequency that makes $\left|V_{o} / V_{i}\right|=1$, which from Eq. (2.28) is

$$
\omega_{\mathrm{int}}=\frac{1}{C R}
$$

The frequency $\omega_{\text {int }}$ is known as the integrator frequency and is simply the inverse of the integrator time constant.

Comparison of the frequency response of the integrator to that of an STC low-pass network indicates that the integrator behaves as a low-pass filter with a corner frequency of zero. Observe also that at $\omega=0$, the magnitude of the integrator transfer function is infinite. This


Figure 2.24 (a) The Miller or inverting integrator. (b) Frequency response of the integrator.
indicates that at dc the op amp is operating with an open loop. This should also be obvious from the integrator circuit itself. Reference to Fig. 2.24(a) shows that the feedback element is a capacitor, and thus at dc, where the capacitor behaves as an open circuit, there is no negative feedback! This is a very significant observation and one that indicates a source of problems with the integrator circuit: Any tiny dc component in the input signal will theoretically produce an infinite output. Of course, no infinite output voltage results in practice; rather, the output of the amplifier saturates at a voltage close to the op-amp positive or negative power supply ( $L_{+}$or $L_{-}$), depending on the polarity of the input dc signal.

The dc problem of the integrator circuit can be alleviated by connecting a resistor $R_{F}$ across the integrator capacitor $C$, as shown in Fig. 2.25, and thus the gain at dc will be $-R_{F} / R$ rather than infinite. Such a resistor provides a dc feedback path. Unfortunately, however, the integration is no longer ideal, and the lower the value of $R_{F}$, the less ideal the integrator circuit becomes. This is because $R_{F}$ causes the frequency of the integrator pole to move from its ideal location at $\omega=0$ to one determined by the corner frequency of the STC network $\left(R_{F}, C\right)$. Specifically, the integrator transfer function becomes

$$
\frac{V_{o}(s)}{V_{i}(s)}=-\frac{R_{F} / R}{1+s C R_{F}}
$$13.62 For a 741 employing $\pm 5-\mathrm{V}$ supplies, $\left|V_{B E}\right|=0.6 \mathrm{~V}$ and $\left|V_{C E s a t}\right|=0.2 \mathrm{~V}$, find the output voltage limits that apply.

D 13.63 Consider an alternative to the present 741 output stage in which $Q_{23}$ is not used, that is, in which its base and emitter are joined. Reevaluate the reflection of $R_{L}=2 \mathrm{k} \Omega$ to the collector of $Q_{17}$. What does $A_{2}$ become?
13.64 Figure P13.64 shows the circuit for determining the op-amp output resistance when $v_{\Omega}$ is positive and $Q_{14}$ is conducting most of the current. Using the resistance of the $Q_{18}-Q_{19}$ network calculated in Exercise $13.35(163 \Omega)$ and neglecting the large output resistance of $Q_{13 A}$, find $R_{\text {out }}$ when $Q_{14}$ is sourcing an output current of 5 mA .


Figure P13.64
13.65 Consider the positive current-limiting circuit involving $Q_{13 A}, Q_{15}$, and $R_{6}$. Find the current in $R_{6}$ at which the collector current of $Q_{15}$ equals the current available from $Q_{13 A}$ $(180 \mu \mathrm{~A})$ minus the base current of $Q_{14}$. (You need to perform a couple of iterations.)

D 13.66 Consider the 741 sinking-current limit involving $R_{7}$, $Q_{21}, Q_{24}, R_{11}$, and $Q_{22}$. For what current through $R_{7}$ is the
current in $Q_{22}$ equal to the maximum current available from the input stage (i.e., the current in $Q_{8}$ )? What simple change would you make to reduce this current limit to 10 mA ?
13.67 Using the data provided in Eq. (13.115) (alone) for the overall gain of the 741 with a $2-\mathrm{k} \Omega$ load, and realizing the significance of the factor 0.97 in relation to the load, calculate the open-circuit voltage gain, the output resistance, and the gain with a load of $500 \Omega$.
13.68 A 741 op amp has a phase margin of $80^{\circ}$. If the excess phase shift is due to a second single pole, what is the frequency of this pole?
13.69 A 741 op amp has a phase margin of $80^{\circ}$. If the op amp has nearly coincident second and third poles, what is their frequency?

D*13.70 For a modified 741 whose second pole is at 5 MHz , what dominant-pole frequency is required for $85^{\circ}$ phase margin with a closed-loop gain of 100? Assuming $C_{C}$ continues to control the dominant pole, what value of $C_{C}$ would be required?
13.71 An internally compensated op amp having an $f_{i}$ of 5 MHz and dc gain of $10^{6}$ utilizes Miller compensation around an inverting amplifier stage with a gain of -1000 . If space exists for at most a $50-\mathrm{pF}$ capacitor, what resistance level must be reached at the input of the Miller amplifier for compensation to be possible?
13.72 Consider the integrator op-amp model shown in Fig. 13.30. For $G_{m 1}=2 \mathrm{~mA} / \mathrm{V}, C_{C}=100 \mathrm{pF}$, and a resistance of $2 \times 10^{7} \Omega$ shunting $C_{C}$, sketch and label a Bode plot for the magnitude of the open-loop gain. If $G_{m 1}$ is related to the first-stage bias current as $G_{m 1}=I / 2 V_{T}$, find the slew rate of this op amp.
13.73 For an amplifier with a slew rate of $10 \mathrm{~V} / \mu \mathrm{s}$, what is the full-power bandwidth for outputs of $\pm 10 \mathrm{~V}$ ? What unity-gain bandwidth, $\omega_{i}$, would you expect if the topology was similar to that of the 741 ?

D 13.74 If a resistance $R_{E}$ is included in each of the emitter leads of $Q_{3}$ and $Q_{4}$ of the 741 circuit, show that the slew rate is $4\left(V_{T}+I R_{E} / 2\right) \omega_{i}$. Hence find the value of $R_{E}$ that would double the 741 slew rate while keeping $\omega_{i}$ and $I$ unchanged. What are the new values of $C_{C}$, the dc gain, and the 3-dB frequency?

[^0]
[^0]:    $5 \mathrm{~N}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; ${ }^{* * *}=$ very challenging; $\mathrm{D}=$ design problem


Figure P13.75

D 13.75 Figure P13.75 shows a circuit suitable for op-amp applications. For all transistors $\beta=100, V_{B E}=0.7 \mathrm{~V}$, and $r_{o}=\infty$.
(a) For inputs grounded and output held at 0 V (by negative feedback) find the collector currents of all transistors. Neglect base currents.
(b) Calculate the input resistance.
(c) Calculate the gain of the amplifier with a load of $5 \mathrm{k} \Omega$.
(d) With load as in (c) calculate the value of the capacitor $C$ required for a 3-dB frequency of 100 Hz .

## Section 13.4: Modern Techniques for the Design of BJT Op Amps

Unless otherwise specified, for the problems in this section assume $\beta_{N}=40, \beta_{P}=10, V_{A n}=30 \mathrm{~V},\left|V_{A p}\right|=20 \mathrm{~V},\left|V_{B E}\right|=$ $0.7 \mathrm{~V},\left|V_{C E s a t}\right|=0.1 \mathrm{~V}$.

D 13.76 Design the circuit in Fig. 13.33 to generate a current $I=5 \mu \mathrm{~A}$. Utilize transistors $Q_{1}$ and $Q_{2}$ having areas in a ratio of 1:4. Assume that $Q_{3}$ and $Q_{4}$ are matched and design for a
$0.15-\mathrm{V}$ drop across each of $R_{1}$ and $R_{4}$. Specify the values of $R_{2}, R_{3}$, and $R_{4}$. Ignore base currents.

D 13.77 Consider the circuit of Fig. 13.33 for the case designed in Exercise 13.37, namely, $I=10 \mu \mathrm{~A}, I_{S 2} / I_{S 1}=$ $2, R_{2}=1.73 \mathrm{k} \Omega, R_{3}=R_{4}=20 \mathrm{k} \Omega$. Augment the circuit with $n p n$ transistors $Q_{5}$ and $Q_{6}$ with emitters connected to ground and bases connected to $V_{\text {BIAS1 }}$, to generate constant currents of $10 \mu \mathrm{~A}$ and $40 \mu \mathrm{~A}$, respectively. What should the emitter areas of $Q_{5}$ and $Q_{6}$ be relative to that of $Q_{1}$ ? What value of a resistance $R_{6}$ will, when connected in the emitter of $Q_{6}$, reduce the current generated by $Q_{6}$ to $10 \mu \mathrm{~A}$ ? Assuming that the $V_{\text {BIAS1 }}$ line has a low incremental resistance to ground, find the output resistance of current source $Q_{5}$ and of current source $Q_{6}$ with $R_{6}$ connected. Ignore base currents.

D 13.78 It is required to use the circuit in Fig. 13.33 to bias an $n p n$ differential pair. The bias current-source transistor of the pair, $Q_{5}$, is identical to $Q_{2}$ and its base is connected to the BIAS1 line. In its emitter lead is connected a resistance $R_{5}$ equal to $R_{2}$. The differential pair has two equal collector

[^0]
[^0]:    $5 \mathrm{~N} \mathrm{\&}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
resistances $R_{C}$ connected to $V_{C C}$, and the output voltage $v_{o}$ is taken between the two collectors.
(a) Find an expression for the differential gain $A_{d}$ in terms of $\left(R_{C} / R_{S}\right)$ and $\left(I_{S S} / I_{S 1}\right)$. Comment on the expected temperature dependence of $A_{d}$. Neglect the effect of finite $\beta_{N}$.
(b) Design the circuit for $I=20 \mu \mathrm{~A}$ and $A_{d}=10 \mathrm{~V} / \mathrm{V}$. Let the emitter areas of $Q_{1}$ and $Q_{5}$ be in the ratio 1:4. Specify the required values of $R_{S}$ and $R_{C}$.

D 13.79 (a) Find the input common-mode range of the circuit in Fig. 13.35(a). Let $V_{C C}=3 \mathrm{~V}$ and $V_{\text {BIAS }}=2.3 \mathrm{~V}$.
(b) Give the complementary version of the circuit in Fig. 13.35(a), that is, the one in which the differential pair is $n p n$. For the same conditions as in (a), what is the input common-mode range?
13.80 For the circuit in Fig. 13.35(b), let $V_{C C}=3 \mathrm{~V}$, $V_{\text {BIAS }}=2.3 \mathrm{~V}, I=20 \mu \mathrm{~A}$, and $R_{C}=25 \mathrm{k} \Omega$. Find the input common-mode range and the differential voltage gain $v_{o} / v_{o f}$. Neglect base currents.

D 13.81 For the circuit in Fig. 13.36, let $V_{C C}=3 \mathrm{~V}, V_{\text {BIAS }}=$ 0.7 V , and $I_{C N}=40 \mu \mathrm{~A}$. Find $R_{C}$ that results in a differential gain of $10 \mathrm{~V} / \mathrm{V}$. What is the input common-mode range and the input differential resistance? Ignore base currents except when calculating $R_{o f}$. If $R_{o f}$ is to be increased by a factor of 4 while the gain and $V_{I C M}$ remain unchanged, what must $I$ and $R_{C}$ be changed to?
13.82 It is required to find the input resistance and the voltage gain of the input stage shown in Fig. 13.37. Let $V_{I C M} \ll 0.8 \mathrm{~V}$ so that the $Q_{3}-Q_{4}$ pair is off. Assume that $Q_{5}$ supplies $8 \mu \mathrm{~A}$, that each of $Q_{7}$ to $Q_{10}$ is biased at $8 \mu \mathrm{~A}$, and that all four cascode transistors are operating in the active mode. The input resistance of the second stage of the op amp is $1.5 \mathrm{M} \Omega$. The emitter-degeneration resistances are $R_{7}=R_{8}=22 \mathrm{k} \Omega$, and $R_{9}=R_{10}=33 \mathrm{k} \Omega$. [Hint: Refer to Fig. 13.38.]

D*13.83 Consider the equivalent half-circuit shown in Fig. 13.38. Assume that in the original circuit, $Q_{1}$ is biased at a current $I, Q_{7}$ and $Q_{9}$ are biased at $2 I$, the dc voltage drop across $R_{7}$ is 0.2 V , and the dc voltage drop across $R_{9}$ is 0.3 V . Find the output resistance in terms of $I$, and hence find the open-circuit voltage gain (i.e., the voltage gain for $R_{L}=\infty$ ). Now with $R_{L}$ connected, find the voltage gain in terms of
$\left(I R_{L}\right)$. For $R_{L}=1 \mathrm{M} \Omega$, find $I$ that will result in the voltage gains of $150 \mathrm{~V} / \mathrm{V}$ and $300 \mathrm{~V} / \mathrm{V}$.
*13.84 (a) For the circuit in Fig. 13.39, show that the loop gain of the common-mode feedback loop is

$$
A \beta \simeq \frac{R_{e 0} \| R_{e 2}}{r_{e 7}+R_{7}}
$$

Recall that the CMF circuit responds only to the average voltage $V_{C M}$ of its two input voltages and realizes the transfer characteristic $V_{B}=V_{C M}+0.4$. Ignore the loading effect of the CMF circuit on the collectors of the cascode transistors.
(b) For the values in Example 13.8, calculate the loop gain $A \beta$.
(c) In Example 13.8, we found that with the CMF absent, a current mismatch $\Delta I=0.3 \mu \mathrm{~A}$ gives rise to $\Delta V_{C M}=2.5 \mathrm{~V}$. Now, with the CMF present, use the value of loop gain found in (b) to calculate the expected $\Delta V_{C M}$ and compare to the value found by a different approach in Example 13.8. [Hint: Recall that negative feedback reduces change by a factor equal to $(1+A \beta)$.]
13.85 The output stage in Fig. 13.41 operates at a quiescent current $I_{O}$ of 0.6 mA . The maximum current $i_{L}$ that the stage can provide in either direction is 12 mA . Also, the output stage is equipped with a feedback circuit that maintains a minimum current of $I_{o f} / 2$ in the inactive output transistor. Also, $V_{C C}=3 \mathrm{~V}$.
(a) What is the allowable range of $v_{O}$ ?
(b) For $i_{L}=0$, what is the output resistance of the op amp?
(c) If the open-loop gain of the op amp is $100,000 \mathrm{~V} / \mathrm{V}$, find the closed-loop output resistance obtained when the op amp is connected in the unity-gain voltage follower configuration, with $i_{L}=0$.
(d) If the op amp is sourcing a load current $i_{L}=12 \mathrm{~mA}$, find $i_{P}, i_{N}$, and the open-loop output resistance.
(e) Repeat (d) for the case of the open-loop op amp sinking a load current of 12 mA .
13.86 It is required to derive the expressions in Eqs. (13.130) and (13.131). Toward that end, first find $v_{B 7}$ in terms of $v_{B E N}$ and hence $i_{N}$. Then find $v_{B 6}$ in terms of $i_{P}$. For the latter purpose note that $Q_{4}$ measures $v_{E B P}$ and develops a current $i_{4}=\left(v_{E B P}-v_{E B 4}\right) / R_{4}$. This current is supplied to the series connection of $Q_{5}$ and $R_{5}$ where $R_{5}=R_{4}$. In the expression you

[^0]
[^0]:    $S I A=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; $D=$ design problem
obtain for $v_{B 6}$, use the relationship

$$
\frac{I_{S P}}{I_{S 4}}=\frac{I_{S N}}{I_{S 5}}
$$

to express $v_{B 6}$ in terms of $i_{P}$ and $I_{S N}$. Now with $v_{B 6}$ and $v_{B 7}$ determined, find $i_{C 6}$ and $i_{C 7}$.
13.87 It is required to derive the expression for $v_{E}$ in Eq. (13.132). Toward that end, note from the circuit in

Fig. 13.43 that $v_{E}=v_{E B 7}+v_{B E N}$ and note that $Q_{N}$ conducts a current $i_{N}$ and $Q_{7}$ conducts a current $i_{C 7}$ given by Eq. (13.131).

D 13.88 For the output stage in Fig. 13.43, find the current $I_{\text {REF }}$ that results in a quiescent current $I_{Q}=0.6 \mathrm{~mA}$. Assume that $I=12 \mu \mathrm{~A}, Q_{N}$ has eight times the area of $Q_{10}$, and $Q_{7}$ has four times the area of $Q_{11}$. What is the minimum current in $Q_{N}$ and $Q_{P}$ ?
# PART III 

## Digital Integrated Circuits

CHAPTER 14
CMOS Digital Logic Circuits 1088

CHAPTER 15
Advanced Topics in Digital Integrated-Circuit Design 1166

CHAPTER 16
Memory Circuits 1236

There are two indisputable facts about digital systems. They have dramatically changed our lives; and the digital revolution is driven by microelectronics.
Evidence of the pervasiveness and influence of digital systems can be found by thinking of what we do in our daily lives. Digital circuits exist in almost every electrical appliance we use in our homes; in the vehicles and transportation systems we use to travel; in the telephones and, most obviously, the mobile phones we use to communicate; in the medical equipment needed to care for our health; in the computers we use to do our work; and in the audio and video systems and the radio and TV sets we use to entertain ourselves. Indeed, it is very difficult to conceive of modern life without digital systems, none of which would have been possible without microelectronics.
Although the idea of a digital computing machine was conceived as early as the 1830s, early implementations were very cumbersome and used expensive mechanical devices. The first serious digital computers using vacuum tubes appeared in the 1930s and 1940s. These early computers used thousands of tubes and were housed literally in many rooms. Their fundamental limitation was low reliability: vacuum tubes had a finite life and needed large amounts of power. Had it not been for the invention of the transistor in 1947, ushering in the era of solid-state electronics, digital computers would have remained specialized machines used primarily in military and scientific applications.

By the mid-1950s, the first digital logic gates made of discrete bipolar transistors were commercially available. The invention of the integrated circuit in the late 1950s was also key, leading to the first digital IC in the early 1960s. Early digital ICs were made of bipolar transistors, with the most successful logic-circuit family of this type being transistor-transistor logic (or TTL), which dominated digital-circuit design, until the early 1980s.

Bipolar was replaced by NMOS, and NMOS by CMOS, again predominantly because of power dissipation and the need to pack more and more transistors on each IC chip. Bearing out Moore's law, which predicted in 1968 that IC chips would double the number of their transistors every two to three years (see Section 15.1), digital ICs have grown from a few transistors to 4 billion devices and to memory chips with 4-Gbit capacity.

Part III aims to provide a concise but nonetheless comprehensive and sufficiently detailed exposure to digital IC design. Our treatment is almost self-contained, requiring for the most part only a thorough understanding of the MOSFET material presented in Chapter 5. Thus Part III can be studied right after Chapter 5. The only exception to this is the last section in Chapter 15, which requires knowledge of the BJT (Chapter 6). Also, knowledge of the MOSFET internal capacitances (Section 10.2.2) will be needed.

Chapter 14 is the cornerstone of Part III. It provides a study of the bread-and-butter topic of digital IC design: the CMOS inverter and logic gates. Today, CMOS represents $98 \%$ of newly designed digital systems. The material in Chapter 14 is the minimum needed to learn something meaningful about digital circuits; it is a must study!

In Chapter 15, which has a modular structure, each section deals with an important though somewhat advanced topic. We consider the implications of technology scaling (Moore's law), survey digital IC technologies and logic-circuit families, and study the methodologies that make it possible to design complex digital IC chips with billions of transistors. We also present three types of MOS logic circuits that are used to supplement regular CMOS and look briefly at logic circuits that employ bipolar transistors.

Digital circuits can be broadly divided into logic and memory circuits. The latter form the subject of Chapter 16.
# CHAPTER 14 

## CMOS Digital Logic Circuits

Introduction 1089
14.1 CMOS Logic-Gate Circuits 1090
14.2 Digital Logic Inverters 1100
14.3 The CMOS Inverter 1114
14.4 Dynamic Operation of the CMOS Inverter 1125
14.5 Transistor Sizing 1139
14.6 Power Dissipation 1149

Summary 1154
Problems 1156
# IN THIS CHAPTER YOU WILL LEARN 

1. How CMOS logic circuits can be implemented by using arrangements of MOS transistors operating as voltage-controlled switches.
2. How to synthesize CMOS logic circuits that realize standard (e.g., inverter, NAND, and NOR gates) and complex Boolean functions.
3. How the operation of the logic inverter is characterized by such parameters as noise margins, propagation delay, and power dissipation; and how the inverter can be implemented by using one of three possible arrangements of voltage-controlled switches (transistors).
4. The structure, circuit operation, and design of the CMOS inverter, as well as static and dynamic performance analysis of the circuit.
5. How to select sizes for the transistors in a CMOS logic circuit so as to meet various performance requirements.
6. The sources of power consumption in logic circuits, with emphasis on CMOS, and the trade-off between power dissipation and speed of operation.

## Introduction

This chapter provides a self-contained study of CMOS logic circuits, the bread and butter of digital IC design. We begin (Section 14.1) by learning how to synthesize CMOS circuits that implement various logic functions. This discussion will be at a high level without getting into the details of circuit operation and performance. To delve into these issues, we consider in Section 14.2 the most fundamental element of digital circuits: the logic inverter. We study its characterization, performance metrics, and methods of implementation. Out of this general study, CMOS emerges as the most ideal inverter implementation.

A thorough study of the CMOS inverter is undertaken in Section 14.3. This is followed by the consideration of the two most significant aspects of digital circuits: their speed of operation (Section 14.4) and their power consumption (Section 14.6). The fundamental design issue of selecting optimum sizes for the MOS transistors is dealt with in Section 14.5.

Besides presenting the most important digital IC technology (CMOS), this chapter lays the foundation for the more advanced topics studied in the two subsequent chapters.
# 14.1 CMOS Logic-Gate Circuits 

In this section we consider the synthesis of CMOS circuits that realize combinational-logic functions. In combinational circuits, the output at any time is a function only of the values of input signals at that time. Thus, these circuits do not have memory and do not employ feedback. Combinational circuits are used in large quantities in every digital system.

### 14.1.1 Switch-Level Transistor Model

CMOS digital circuits utilize NMOS and PMOS transistors operating as switches. From Chapter 5, we know that a MOS transistor can operate as an on/off switch by using the gate voltage to operate the transistor in the triode region ("on" position) and in the cutoff region ("off" position).

Specifically, an NMOS transistor behaves as a closed switch, exhibiting a very small resistance ( $R_{\mathrm{on}}$ or $r_{D S}$ ) between its drain and source terminals when its gate voltage is "high," usually at the power-supply level $V_{D D}$, which represents a logic 1 . Conversely, when the gate voltage is "low" (i.e., at or close to ground voltage), which represents a logic 0 , the transistor is cut off, thus conducting zero current and acting as an open switch. This is illustrated in Fig. 14.1(a).


Figure 14.1 Operation of the (a) NMOS and (b) PMOS transistor as an on/off switch. The gate voltage controls the operation of the transistor switch, with the voltage $V_{D D}$ representing a logic 1 and 0 V representing a logic 0 . Note that the connections of the drain and source terminals are not shown.


Figure 14.2 (a) Block representation of the logic inverter; (b) its CMOS realization; (c) operation when the input is a logic 1 ; (d) operation when the input is a logic 0 .

The PMOS transistor operates in a complementary fashion: To turn the transistor on, its gate voltage is made low ( 0 V or logic 0 ). Raising the gate voltage to $V_{D D}$ (logic 1) turns the PMOS transistor off. This is illustrated in Fig. 14.1(b).

We observe that the gate terminal of the MOSFET is used as the controlling node, and thus it is usually the input terminal of the logic gate.

# 14.1.2 The CMOS Inverter 

Armed with this knowledge of the switching behavior of MOSFETs, let's consider making an inverter. As its name implies, the logic inverter inverts the logic value of its input signal. Thus, for a logic- 0 input, the output will be a logic 1 , and vice versa. Thus the logic function of the inverter can be represented by the Boolean expression

$$
Y=\bar{X}
$$

An inverter operated from a power supply $V_{D D}$ is shown in block form in Fig. 14.2(a). Its CMOS circuit implementation is shown in Fig. 14.2(b). It consists of an NMOS transistor $Q_{N}$ and a PMOS transistor $Q_{P}$, with the gate terminals connected together to constitute the inverter input terminal, to which a logic input $X$ is applied. Also, both drain terminals are connected together to constitute the inverter output terminal on which the output logic variable $Y$ appears.

When $X=1$-that is, $V_{X}=V_{D D}$ [Fig. 14.2(c)]—the PMOS transistor will be off but the NMOS transistor will be on and will be connecting the inverter output terminal to ground through the small on-resistance $R_{\mathrm{on}}$. Thus, the output voltage will be zero and $Y=0$. When $X=0$, that is, $V_{X}=0$ [see Fig. 14.2(d)], the NMOS transistor will be off but the PMOS transistor will be on and will be connecting the output terminal to $V_{D D}$ through the small resistance $R_{\mathrm{on}}$. Thus the output voltage will be equal to $V_{D D}$ and $Y$ will be 1 .

### 14.1.3 General Structure of CMOS Logic

A CMOS logic circuit is in effect an extension, or a generalization, of the CMOS inverter: The inverter consists of an NMOS pull-down transistor and a PMOS pull-up transistor,

Figure 14.3 Representation of a three-input CMOS logic gate. The PUN comprises PMOS transistors, and the PDN comprises NMOS transistors.
operated by the input voltage in a complementary fashion. The CMOS logic gate consists of two networks: the pull-down network (PDN) constructed of NMOS transistors, and the pull-up network (PUN) constructed of PMOS transistors (see Fig. 14.3). The two networks are operated by the input variables, in a complementary fashion. Thus, for the three-input gate represented in Fig. 14.3, the PDN will conduct for all input combinations that require a low output $(Y=0)$ and will then pull the output node down to ground, causing a zero voltage to appear at the output, $v_{Y}=0$. Simultaneously, the PUN will be off, and no direct dc path will exist between $V_{D D}$ and ground. On the other hand, all input combinations that call for a high output $(Y=1)$ will cause the PUN to conduct, and the PUN will then pull the output node up to $V_{D D}$, establishing an output voltage $v_{Y}=V_{D D}$. Simultaneously, the PDN will be cut off, and again, no dc current path between $V_{D D}$ and ground will exist in the circuit.

Now, since the PDN comprises NMOS transistors, and since an NMOS transistor conducts when the signal at its gate is high, the PDN is activated (i.e., conducts) when the inputs are high. In a dual manner, the PUN comprises PMOS transistors, and a PMOS transistor conducts when the input signal at its gate is low; thus the PUN is activated when the inputs are low.

The PDN utilizes devices in parallel to form an OR function and devices in series to form an AND function; the same is true of the PUN. Here, the OR and AND notation refer to current flow or conduction. Figure 14.4 shows examples of PDNs. For the circuit in Fig. 14.4(a), we observe that $Q_{A}$ will conduct when $A$ is high $\left(v_{A}=V_{D D}\right)$ and will then pull the output node down to ground $\left(v_{Y}=0 \mathrm{~V}, Y=0\right)$. Similarly, $Q_{B}$ conducts and pulls $Y$ down when $B$ is high. Thus $Y$ will be low when $A$ is high or $B$ is high, which can be expressed as

$$
\bar{Y}=A+B
$$

or equivalently

$$
Y=\overline{A+B}
$$

The PDN in Fig. 14.4(b) will conduct only when $A$ and $B$ are both high simultaneously. Thus $Y$ will be low when $A$ is high and $B$ is high,

$$
\bar{Y}=A B
$$


Figure 14.4 Examples of pull-down networks.


Figure 14.5 Examples of pull-up networks.
or equivalently

$$
Y=\overline{A B}
$$

As a final example, the PDN in Fig. 14.4(c) will conduct and cause $Y$ to be 0 when $A$ is high or when $B$ and $C$ are both high, thus

$$
\bar{Y}=A+B C
$$

or equivalently

$$
Y=\overline{A+B C}
$$

Next consider the PUN examples shown in Fig. 14.5. The PUN in Fig. 14.5(a) will conduct and pull $Y$ up to $V_{D D}(Y=1)$ when $A$ is low or when $B$ is low, thus

$$
Y=\bar{A}+\bar{B}
$$


Figure 14.6 Usual and alternative circuit symbols for MOSFETs.

The PUN in Fig. 14.5(b) will conduct and produce a high output ( $v_{Y}=V_{D D}, Y=1$ ) only when $A$ and $B$ are both low, thus

$$
Y=\overline{A B}
$$

Finally, the PUN in Fig. 14.5(c) will conduct and cause $Y$ to be high (logic 1) if $A$ is low or if $B$ and $C$ are both low; thus,

$$
Y=\bar{A}+\bar{B} \bar{C}
$$

Having developed an understanding and an appreciation of the structure and operation of PDNs and PUNs, we are almost ready to consider complete CMOS gates. First, however, we wish to introduce alternative circuit symbols that are almost universally used for MOS transistors by digital-circuit designers. Figure 14.6 shows our usual symbols (left) and the corresponding "digital" symbols (right). Observe that the symbol for the PMOS transistor with a circle at the gate terminal is intended to indicate that the signal at the gate has to be low for the device to be activated (i.e., to conduct). Thus, in terms of logic-circuit terminology, the gate terminal of the PMOS transistor is an active low input. Besides indicating this property of PMOS devices, the digital symbols omit any indication of which of the device terminals is the source and which is the drain. This should cause no difficulty at this stage of our study; simply remember that for an NMOS transistor, the drain is the terminal that is at the higher voltage (current flows from drain to source), and for a PMOS transistor the source is the terminal that is at the higher voltage (current flows from source to drain). To be consistent with the literature, we shall henceforth use these modified symbols for MOS transistors in logic applications, except in locations where our usual symbols help in understanding circuit operation.

# 14.1.4 The Two-Input NOR Gate 

We first consider the CMOS gate that realizes the two-input NOR function

$$
Y=\overline{A+B}=\overline{A B}
$$


$$
Y=\overline{A+B}
$$

Figure 14.7 A two-input CMOS NOR gate.

We see that $Y$ is to be low (PDN conducting) when $A$ is high or $B$ is high. Thus the PDN consists of two parallel NMOS devices with $A$ and $B$ as inputs [i.e., the circuit in Fig. 14.4(a)]. For the PUN, we note from the second expression in Eq. (14.1) that $Y$ is to be high when $A$ and $B$ are both low. Thus the PUN consists of two series PMOS devices with $A$ and $B$ as the inputs [i.e., the circuit in Fig. 14.5(b)]. Putting the PDN and the PUN together gives the CMOS NOR gate shown in Fig. 14.7. Note that extension to a higher number of inputs is straightforward: For each additional input, an NMOS transistor is added in parallel with $Q_{N A}$ and $Q_{N B}$, and a PMOS transistor is added in series with $Q_{P A}$ and $Q_{P B}$.

# 14.1.5 The Two-Input NAND Gate 

The two-input NAND function is described by the Boolean expression

$$
Y=\overline{A B}=\bar{A}+\bar{B}
$$

To synthesize the PDN, we consider the input combinations that require $Y$ to be low: There is only one such combination, namely, $A$ and $B$ both high. Thus, the PDN simply comprises two NMOS transistors in series [such as the circuit in Fig. 14.4(b)]. To synthesize the PUN, we consider the input combinations that result in $Y$ being high. These are found from the second expression in Eq. (14.2) as $A$ low or $B$ low. Thus, the PUN consists of two parallel PMOS transistors with $A$ and $B$ applied to their gates [such as the circuit in Fig. 14.5(a)]. Putting the PDN and PUN together results in the CMOS NAND gate implementation shown in Fig. 14.8. Note that extension to a higher number of inputs is straightforward: For each additional input, we add an NMOS transistor in series with $Q_{N A}$ and $Q_{N B}$, and a PMOS transistor in parallel with $Q_{P A}$ and $Q_{P B}$.


Figure 14.8 A two-input CMOS NAND gate.

# 14.1.6 A Complex Gate 

Consider next the more complex logic function

$$
Y=\overline{A(B+C D)}
$$

Since $\bar{Y}=A(B+C D)$, we see that $Y$ should be low for $A$ high and simultaneously either $B$ high or $C$ and $D$ both high, from which the PDN is directly obtained. To obtain the PUN, we need to express $Y$ in terms of the complemented variables. We do this through repeated application of DeMorgan's law, as follows:

$$
\begin{aligned}
Y & =\overline{A(B+C D)} \\
& =\bar{A}+\overline{B+C D} \\
& =\bar{A}+\overline{B C D} \\
& =\bar{A}+\bar{B}(\bar{C}+\bar{D})
\end{aligned}
$$

Thus, $Y$ is high for $A$ low or $B$ low and either $C$ or $D$ low. The corresponding complete CMOS circuit will be as shown in Fig. 14.9.

### 14.1.7 Obtaining the PUN from the PDN and Vice Versa

From the CMOS gate circuits considered thus far (e.g., that in Fig. 14.9), we observe that the PDN and the PUN are dual networks: Where a series branch exists in one, a parallel branch exists in the other. Thus, we can obtain one from the other, a process that can be simpler than having to synthesize each separately from the Boolean expression of the function. For instance, in the circuit of Fig. 14.9, we found it relatively easy to obtain the PDN, simply because we already had $\bar{Y}$ in terms of the uncomplemented inputs. On the other hand, to obtain the PUN, we had to manipulate the given Boolean expression to express $Y$ as a function of the complemented variables, the form convenient for synthesizing PUNs. Alternatively, we could have used this duality property to obtain the PUN from the PDN. The reader is urged to refer to Fig. 14.9 to convince herself that this is indeed possible.


$$
Y=\overline{A(B+C D)}
$$

Figure 14.9 CMOS realization of a complex gate.

It should, however, be mentioned that at times it is not easy to obtain one of the two networks from the other using the duality property. For such cases, one has to resort to a more rigorous process, which is beyond the scope of this book (see Kang and Leblebici, 1999).

# 14.1.8 The Exclusive-OR Function 

An important function that often arises in logic design is the exclusive-OR (XOR) function,

$$
Y=A \bar{B}+\bar{A} B
$$

We observe that since $Y$ (rather than $\bar{Y}$ ) is given, it is easier to synthesize the PUN. We note, however, that unfortunately $Y$ is not a function of the complemented variables only (as we would like it to be). Thus, we will need additional inverters. The PUN obtained directly from Eq. (14.5) is shown in Fig. 14.10(a). Note that the $Q_{1}, Q_{2}$ branch realizes the first term $(A \bar{B})$, whereas the $Q_{3}, Q_{4}$ branch realizes the second term $(\bar{A} B)$. Note also the need for two additional inverters to generate $\bar{A}$ and $\bar{B}$.

As for synthesizing the PDN, we can obtain it as the dual network of the PUN in Fig. 14.10(a). Alternatively, we can develop an expression for $\bar{Y}$ and use it to synthesize the PDN. Leaving the first approach for the reader to do as an exercise, we shall utilize the direct synthesis approach. DeMorgan's law can be applied to the expression in Eq. (14.5) to obtain $\bar{Y}$ as

$$
\bar{Y}=A B+\bar{A} \bar{B}
$$


Figure 14.10 Realization of the exclusive-OR (XOR) function. (a) The PUN synthesized directly from the expression in Eq. (14.5). (b) The complete XOR realization utilizing the PUN in (a) and a PDN that is synthesized directly from the expression in Eq. (14.6). Note that two inverters (not shown) are needed to generate the complemented variables. Also note that in this XOR realization, the PDN and the PUN are not dual networks; however, a realization based on dual networks is possible (see Problem 14.9).

The corresponding PDN will be as in Fig. 14.10(b), which shows the CMOS realization of the exclusive-OR function except for the two additional inverters. Note that the exclusive-OR requires 12 transistors for its realization, a rather complex network. Later, in Section 15.5, we shall show a simpler realization of the XOR employing a different form of CMOS logic.

Another interesting observation follows from the circuit in Fig. 14.10(b). The PDN and the PUN here are not dual networks. Indeed, duality of the PDN and the PUN is not a necessary condition. Thus, although a dual of PDN (or PUN) can always be used for PUN (or PDN), the two networks are not necessarily duals.

# 14.1.9 Summary of the Synthesis Method 

1. The PDN can be most directly synthesized by expressing $\bar{Y}$ as a function of the uncomplemented variables. If complemented variables appear in this expression, additional inverters will be required to generate them.
2. The PUN can be most directly synthesized by expressing $Y$ as a function of the complemented variables and then applying the uncomplemented variables to the gates of the PMOS transistors. If uncomplemented variables appear in the expression, additional inverters will be needed.
3. The PDN can be obtained from the PUN (and vice versa) using the duality property.
# Example 14.1 

Synthesize a CMOS logic circuit that implements the Boolean function

$$
Y=\overline{A+B(C+D)}
$$

## Solution

To obtain the PDN we use

$$
\bar{Y}=A+B(C+D)
$$

and note that $Y$ will be low when $A$ is high or when $[B(C+D)]$ is high. Thus we have two parallel networks. One consists of a single transistor with $A$ supplied to its gate, and the second is a network composed of a transistor controlled by $B$ in series with two parallel transistors controlled by $C$ and $D$. The resulting PDN is shown in Fig. 14.11(a).


Figure 14.11 (a) The PDN and (b) the PUN for the logic function in Example 14.1.
A question arises: Should the $B$ transistor be placed closer to ground (with the $C$ and $D$ transistors closer to $Y$ ) or closer to $Y$ ? From a logic standpoint, both are valid solutions. When one is optimizing for time delay, however, there may be a difference. We will explore this point in greater detail later on.

To obtain the PUN we use deMorgan's law on the given expression for $Y$ to obtain

$$
Y=\bar{A}(\bar{B}+\bar{C} \bar{D})
$$

which leads to the circuit in Fig. 14.11(b). Here again, we may exchange the positions of the $C$ and $D$ transistors with no effect on the logic behavior. Finally, the complete circuit can be obtained by combining the PDN and the PUN shown in Fig. 14.11.
# 14.2 Digital Logic Inverters 

Having learned how to synthesize CMOS circuits that implement various logic functions, we next consider the design and performance evaluation of these CMOS logic circuits. Toward that end, we step back to study in detail the characterization of the basic logic element, the inverter. We will do this in this section in general terms; that is, our study will not be confined to CMOS inverters only. In subsequent sections we specialize what we will have learned in this section to the case of the CMOS inverter and extend it to CMOS logic gates.

### 14.2.1 The Voltage-Transfer Characteristic (VTC)

Refer to the inverter shown in block form in Fig. 14.1(a). To quantify the operation of the inverter, we utilize its voltage-transfer characteristic (VTC). We have already introduced the concept of the VTC and utilized it to characterize the operation of basic MOSFET amplifiers in Section 7.1.3. Figure 14.12 shows such a circuit, together with its VTC. Observe that the circuit in fact implements the inverter function: For a logic- 0 input, $v_{I}$ is close to 0 V and specifically lower than the MOSFET threshold voltage $V_{m}$, the transistor will be off, $i_{D}=0$, and $v_{O}=V_{D D}$, which is a logic 1 . For a logic-1 input, $v_{I}=V_{D D}$, the transistor will be conducting and operating in the triode region (at point D on the VTC), and the output voltage will be low (logic 0).

Thus to use this amplifier as a logic inverter, we utilize its extreme regions of operation. This is exactly the opposite to its use as a signal amplifier, where it would be biased at the middle of the transfer characteristic segment BC and the signal kept small enough to restrict operation to a short, almost linear, segment of the transfer curve. Digital applications, on the other hand, make use of the gross nonlinearity exhibited by the VTC.

With these observations in mind, we show in Fig. 14.13 a possible VTC of a logic inverter. For simplicity, we are using three straight lines to approximate the VTC, which is usually a


Figure 14.12 The simple resistively loaded MOS amplifier can be used as a logic inverter when operated in cutoff $\left(v_{I}<V_{m}\right)$ and in triode $\left(v_{I}>V_{I C}\right)$. The output high level is $V_{D D}$ and the low level is $V_{D D}$.


Figure 14.13 Voltage-transfer characteristic of an inverter. The VTC is approximated by three straight-line segments. Note the four parameters of the VTC ( $V_{O H}, V_{O L}, V_{I L}$, and $V_{I H}$ ) and their use in determining the noise margins $\left(N M_{H}\right.$ and $\left.N M_{L}\right)$.
nonlinear curve such as that in Fig. 14.12. Observe that the output high level, denoted $V_{O H}$, does not depend on the exact value of $v_{I}$ as long as $v_{I}$ does not exceed the value labeled $V_{I L}$; when $v_{I}$ exceeds $V_{I L}$, the output decreases and the inverter enters its amplifier region of operation, also called the transition region. It follows that $V_{I L}$ is an important parameter of the inverter VTC: It is the maximum value that $v_{I}$ can have while being interpreted by the inverter as representing a logic 0 .

Similarly, we observe that the output low level, denoted $V_{O L}$, does not depend on the exact value of $v_{I}$ as long as $v_{I}$ does not fall below $V_{I H}$. Thus $V_{I H}$ is an important parameter of the inverter VTC: It is the minimum value that $v_{I}$ can have while being interpreted by the inverter as representing a logic 1 .

# 14.2.2 Noise Margins 

The insensitivity of the inverter output to the exact value of $v_{I}$ within allowed regions is a great advantage that digital circuits have over analog circuits. To quantify this insensitivity property, consider the situation that occurs often in a digital system where an inverter (or a logic gate based on the inverter circuit) is driving another similar inverter, as shown in Fig. 14.14.


Figure 14.14 Noise voltage $v_{N}$ is coupled to the interconnection between the output of inverter $G_{1}$ and the input of inverter $G_{2}$.Table 14.1 Important Parameters of the VTC of the Logic Inverter (Refer to Fig. 14.13)

| $V_{O L}:$ | Output low level |
| :-- | :-- |
| $V_{O H}:$ | Output high level |
| $V_{I L}:$ | Maximum value of input interpreted by the inverter as a logic 0 |
| $V_{I H}:$ | Minimum value of input interpreted by the inverter as a logic 1 |
| $N M_{L}:$ | Noise margin for low input $=V_{I L}-V_{O L}$ |
| $N M_{H}:$ | Noise margin for high input $=V_{O H}-V_{I H}$ |

Here we assume that a noise or interference signal $v_{N}$ is somehow coupled to the interconnection between the output of inverter $G_{1}$ and the input of inverter $G_{2}$ with the result that the input of $G_{2}$ becomes

$$
v_{I 2}=v_{O 1}+v_{N}
$$

where the noise voltage $v_{N}$ can be either positive or negative. Now consider the case $v_{O 1}=V_{O L}$; that is, inverter $G_{2}$ is driven by a logic-0 signal. Reference to Fig. 14.13 indicates that in this case $G_{2}$ will continue to function properly as long as its input $v_{I 2}$ does not exceed $V_{I L}$. Equation (14.7) then indicates that $v_{N}$ can be as high as $V_{I L}-V_{O L}$ while $G_{2}$ continues to function properly. Thus, we can say that inverter $G_{2}$ has a noise margin for low input, $N M_{L}$, of

$$
N M_{L}=V_{I L}-V_{O L}
$$

Similarly, if $v_{O 1}=V_{O H}$, the driven inverter $G_{2}$ will continue to see a high input as long as $v_{I 2}$ does not fall below $V_{I H}$. Thus, in the high-input state, inverter $G_{2}$ can tolerate a negative $v_{N}$ of magnitude as high as $V_{O H}-V_{I H}$. We can thus state that $G_{2}$ has a high-input noise margin, $N M_{H}$, of

$$
N M_{H}=V_{O H}-V_{I H}
$$

In summary, four parameters, $V_{O H}, V_{O L}, V_{I H}$, and $V_{I L}$, define the VTC of an inverter and determine its noise margins, which in turn measure the ability of the inverter to tolerate variations in the input signal levels. In this regard, observe that changes in the input signal level within the noise margins are rejected by the inverter. Thus noise is not allowed to propagate further through the system, a definite advantage of digital over analog circuits. Alternatively, we can think of the inverter as restoring the signal levels to standard values ( $V_{O L}$ and $V_{O H}$ ) even when it is presented with corrupted input signal levels (within the noise margins). As a summary, useful for future reference, we present a listing and definitions of the important parameters of the inverter VTC in Table 14.1.

The formal definitions of the threshold voltages $V_{I L}$ and $V_{I H}$ are given in Fig. 14.15. Observe that $V_{I L}$ and $V_{I H}$ are defined as the VTC points at which the slope is $-1 \mathrm{~V} / \mathrm{V}$. As $v_{I}$ exceeds $V_{I L}$, the magnitude of the inverter gain increases and the VTC enters its transition region. Similarly, as $v_{I}$ falls below $V_{I H}$, the inverter enters the transition region and the magnitude of the gain increases. Finally, note that Fig. 14.15 shows the definition of another important point on the VTC; this is point M at which $v_{O}=v_{I}$. Point M is loosely considered to be the midpoint of the VTC and thus the point at which the inverter switches from one state to the other. Point M plays an important role in the definition of the time delay of the inverter, as we shall see shortly.


Figure 14.15 Typical voltage-transfer characteristic (VTC) of a logic inverter, illustrating the definition of the critical points.

# 14.2.3 The Ideal VTC 

What constitutes an ideal VTC for an inverter? The answer to this naturally arising question follows directly from the preceding discussion: An ideal VTC is one that maximizes the output signal swing and the noise margins. For an inverter operated from a power supply $V_{D D}$, maximum signal swing is obtained when

$$
V_{O H}=V_{D D}
$$

and

$$
V_{O L}=0
$$

To obtain maximum noise margins, we first arrange for the transition region to be made as narrow as possible and ideally of zero width. Then, the two noise margins are equalized by arranging for the transition from high to low to occur at the midpoint of the power supply, that is, at $V_{D D} / 2$. The result is the VTC shown in Fig. 14.16, for which

$$
V_{I L}=V_{I H}=V_{M}=V_{D D} / 2
$$

Observe that the sharp transition at $V_{D D} / 2$ indicates that if the inverter were to be used as an amplifier, its gain would be infinite. Again, we point out that while the analog designer's interest would be focused on the transition region of the VTC, the digital designer would prefer the transition region to be as narrow as possible, as is the case in the ideal VTC of Fig. 14.16. Finally, we will see in Section 14.3 that inverters implemented using CMOS technology come very close to realizing the ideal VTC.

### 14.2.4 Inverter Implementation

Inverters are implemented using transistors (Chapters 5 and 6) operating as voltage-controlled switches. The simplest inverter implementation is shown in Fig. 14.17(a). The switch is


Figure 14.16 The VTC of an ideal inverter.


Figure 14.17 (a) The simplest implementation of a logic inverter using a voltage-controlled switch; (b) equivalent circuit when $v_{I}$ is low; (c) equivalent circuit when $v_{I}$ is high. Note that the switch is assumed to close when $v_{I}$ is high.
controlled by the inverter input voltage $v_{I}$ : When $v_{I}$ is low, the switch will be open and $v_{O}=V_{D D}$, since no current flows through $R$. When $v_{I}$ is high, the switch will be closed and, assuming an ideal switch, $v_{O}$ will be 0 .

Transistor switches, however, as we know from Chapters 5 and 6, are not perfect. Although their off-resistances are very high, and thus an open switch closely approximates an open circuit, the "on" switch has a finite closure, or on-resistance, $R_{\text {on }}$. The result is that when $v_{I}$
is high, the inverter has the equivalent circuit shown in Fig. 14.17(c), from which $V_{O L}$ can be found. ${ }^{1}$

$$
V_{O L}=V_{D D} \frac{R_{o n}}{R+R_{o n}}
$$

We observe that the circuit in Fig. 14.12(a) is a direct implementation of the inverter in Fig. 14.17. In this case, $R_{o n}$ is equal to $r_{D S}$ of the MOSFET evaluated at its operating point in the triode region with $V_{G S}=V_{D D}$.

# EXERCISE 

D14.1 Design the inverter in Fig. 14.12(a) to provide $V_{O L}=90 \mathrm{mV}$ and to draw a supply current of $30 \mu \mathrm{~A}$ in the low-output state. Let the transistor be specified to have $V_{t}=0.4 \mathrm{~V}, \mu_{n} C_{o s}=125 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $\lambda=0$. The power supply $V_{D D}=1.8 \mathrm{~V}$. Specify the required values of $W / L$ and $R_{D}$. How much power is drawn from $V_{D D}$ when the switch is open? Closed?
Hint: Recall that for small $v_{D S}$,

$$
r_{D S} \simeq 1 /\left[\left(\mu_{n} C_{o s}\right)\left(\frac{W}{L}\right)\left(V_{G S}-V_{t}\right)\right]
$$

Ans. $1.9 ; 57 \mathrm{k} \Omega ; 0 ; 54 \mu \mathrm{~W}$

More elaborate implementations of the logic inverter exist, and we show two of these in Fig. 14.18(a) and 14.19. The circuit in Fig. 14.18(a) utilizes a pair of complementary switches, the "pull-up" (PU) switch connects the output node to $V_{D D}$, and the "pull-down" (PD) switch connects the output node to ground. When $v_{I}$ is low, the PU switch will be closed and the PD switch open, resulting in the equivalent circuit of Fig. 14.18(b). Observe that in this case $R_{\text {on }}$ of PU connects the output to $V_{D D}$, thus establishing $V_{O H}=V_{D D}$. Also observe that no current flows, and thus no power is dissipated, in the circuit. Next, if $v_{I}$ is raised to the logic-1 level, the PU switch will open while the PD switch will close, resulting in the equivalent circuit shown in Fig. 14.18(c). Here $R_{o n}$ of the PD switch connects the output to ground, thus establishing $V_{O L}=0$. Here again no current flows, and no power is dissipated. The superiority of this inverter implementation over that using the single pull-down switch and a resistor (known as a pull-up resistor) should be obvious: With $V_{O L}=0$ and $V_{O H}=V_{D D}$, the signal swing is at its maximum possible, and the power dissipation is zero in both states. This circuit constitutes the basis of the CMOS inverter that we synthesized in the previous section [Fig. 14.2(b)] and will study in detail in Section 14.3.

[^0]
[^0]:    ${ }^{1}$ If a BJT is used to implement the switch in Fig. 14.17(a), its equivalent circuit in the closed position includes in addition to the resistance $R_{o n}=R_{\text {CEout }}$ an offset voltage of about 50 mV to 100 mV [see Fig. 6.20(c)]. We shall not pursue this subject any further here, since the relatively long delay time needed to turn off a saturated BJT has caused the use of BJT switches operated in saturation to all but disappear from the digital IC world.


Figure 14.18 A more elaborate implementation of the logic inverter utilizing two complementary switches. This is the basis of the CMOS inverter that we synthesized in the previous section [Fig. 14.2(b)] and shall study in Section 14.3.


Figure 14.19 Another inverter implementation utilizing a double-throw switch to steer the constant current $I_{E E}$ to $R_{C 1}$ (when $v_{I}$ is high) or $R_{C 2}$ (when $v_{I}$ is low). This is the basis of the emitter-coupled logic (ECL) studied briefly in Chapter 15 .

Finally, consider the inverter implementation of Fig. 14.19. Here a double-throw switch is used to steer the constant current $I_{E E}$ into one of two resistors connected to the positive supply $V_{C C}$. The reader is urged to show that if a high $v_{I}$ results in the switch being connected to $R_{C 1}$, then a logic inversion function is realized at $v_{O 1}$. Note that the output voltage is independent of the switch resistance. This current-steering or current-mode logic arrangement is the basis of the fastest available digital logic circuits, called emitter-coupled logic (ECL), which we shall study briefly in Section 15.6.1. In fact, ECL is the only BJT logic-circuit type that is currently employed in new designs and the only one studied in this book.
# EXERCISE 

14.2 For the current-steering circuit in Fig. 14.19, let $V_{C C}=5 \mathrm{~V}, I_{E E}=1 \mathrm{~mA}$, and $R_{C 1}=R_{C 2}=2 \mathrm{k} \Omega$. What are the high and low logic levels obtained at the outputs?
Ans. $V_{O H}=5 \mathrm{~V} ; V_{O L}=3 \mathrm{~V}$

## Example 14.2 Resistively Loaded MOS Inverter

For the simple MOS inverter in Fig. 14.12(a):
(a) Derive expressions for $V_{O H}, V_{O L}, V_{I L}, V_{I H}$, and $V_{M}$. For simplicity, neglect channel-length modulation (i.e., assume $\lambda=0$ ). Show that these inverter parameters can be expressed in terms of $V_{D D}, V_{i}$, and $\left(k_{n} R_{D}\right)$. The latter parameter has the dimension of $\mathrm{V}^{-1}$, and to simplify the expressions, denote $k_{n} R_{D} \equiv$ $1 / V_{s}$.
(b) Show that $V_{s}$ can be used as a design parameter for the inverter circuit. In particular, find the value of $V_{s}$ that results in $V_{M}=V_{D D} / 2$.
(c) Find numerical values for all parameters and for the inverter noise margins for $V_{D D}=1.8 \mathrm{~V}, V_{i}=0.5 \mathrm{~V}$, and $V_{s}$ set to the value found in (b).
(d) For $k_{n}=300 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $W / L=1.5$, find the required value of $R_{D}$ and use it to determine the average power dissipated in the inverter, assuming that the inverter spends half of the time in each of its two states.
(e) Comment on the characteristics of this inverter circuit vis-à-vis the ideal characteristics as well as on its suitability for implementation in integrated-circuit form.

## Solution

(a) Refer to Fig. 14.20. For $v_{I}<V_{i}$, the MOSFET is off, $i_{D}=0$, and $v_{O}=V_{D D}$. Thus

$$
V_{O H}=V_{D D}
$$

As $v_{I}$ exceeds $V_{i}$, the MOSFET turns on and operates initially in the saturation region. Assuming $\lambda=0$,

$$
i_{D}=\frac{1}{2} k_{n}\left(v_{I}-V_{i}\right)^{2}
$$

and

$$
v_{O}=V_{D D}-R_{D} i_{D}=V_{D D}-\frac{1}{2} k_{n} R_{D}\left(v_{I}-V_{i}\right)^{2}
$$

substituting $k_{n} R_{D}=1 / V_{s}$, the BC segment of the VTC is described by

$$
v_{O}=V_{D D}-\frac{1}{2 V_{s}}\left(v_{I}-V_{i}\right)^{2}
$$
Example 14.2 continued


Figure 14.20 The resistively loaded MOS inverter and its VTC (Example 14.2).

To determine $V_{I L}$, we differentiate Eq. (14.11) and set $d v_{O} / d v_{I}=-1$,

$$
\begin{aligned}
\frac{d v_{O}}{d v_{I}} & =-\frac{1}{V_{s}}\left(v_{I}-V_{i}\right) \\
-1 & =-\frac{1}{V_{s}}\left(V_{I L}-V_{i}\right)
\end{aligned}
$$

which results in

$$
V_{I L}=V_{i}+V_{s}
$$

To determine the coordinates of the midpoint $M$, we substitute $v_{O}=v_{I}=V_{M}$ in Eq. (14.11), thus obtaining

$$
V_{D D}-V_{M}=\frac{1}{2 V_{s}}\left(V_{M}-V_{i}\right)^{2}
$$
which can be solved to obtain

$$
V_{M}=V_{s}+\sqrt{2\left(V_{D D}-V_{s}\right) V_{s}+V_{s}^{2}}-V_{s}
$$

The boundary of the saturation-region segment BC , point C , is determined by substituting $v_{O}=v_{I}-V_{s}$ in Eq. (14.11) and solving for $v_{O}$ to obtain

$$
V_{O C}=\sqrt{2 V_{D D} V_{s}+V_{s}^{2}}-V_{s}
$$

and

$$
V_{I C}=V_{s}+\sqrt{2 V_{D D} V_{s}+V_{s}^{2}}-V_{s}
$$

Beyond point C , the transistor operates in the triode region, thus

$$
i_{D}=k_{b}\left[\left(v_{I}-V_{s}\right) v_{O}-\frac{1}{2} v_{O}^{2}\right]
$$

and the output voltage is obtained as

$$
v_{O}=V_{D D}-\frac{1}{V_{s}}\left[\left(v_{I}-V_{s}\right) v_{O}-\frac{1}{2} v_{O}^{2}\right]
$$

which describes the segment CD of the VTC. To determine $V_{I H}$, we differentiate Eq. (14.17) and set $d v_{O} / d v_{I}=-1$ :

$$
\begin{aligned}
\frac{d v_{O}}{d v_{I}} & =-\left(\frac{1}{V_{s}}\right)\left[\left(v_{I}-V_{s}\right) \frac{d v_{O}}{d v_{I}}+v_{O}-v_{O} \frac{d v_{O}}{d v_{I}}\right] \\
& -1=-\frac{1}{V_{s}}\left[-\left(V_{I H}-V_{s}\right)+2 v_{O}\right]
\end{aligned}
$$

which results in

$$
V_{I H}-V_{s}=2 v_{O}-V_{s}
$$

Substituting in Eq. (14.17) for $v_{I}$ with the value of $V_{I H}$ from Eq. (14.18) results in an equation in the value of $v_{O}$ corresponding to $v_{I}=V_{I H}$, which can be solved to yield

$$
\left.v_{O}\right|_{v_{I}=V_{I H}}=0.816 \sqrt{V_{D D} V_{s}}
$$

which can be substituted in Eq. (14.18) to obtain

$$
V_{I H}=V_{s}+1.63 \sqrt{V_{D D} V_{s}}-V_{s}
$$
# Example 14.2 continued 

To determine $V_{O L}$ we substitute $v_{I}=V_{O H}=V_{D D}$ in Eq. (14.17):

$$
V_{O L}=V_{D D}-\frac{1}{V_{s}}\left[\left(V_{D D}-V_{i}\right) V_{O L}-\frac{1}{2} V_{O L}^{2}\right]
$$

Since we expect $V_{O L}$ to be much smaller than $2\left(V_{D D}-V_{i}\right)$, we can approximate Eq. (14.21) as

$$
V_{O L} \simeq V_{D D}-\frac{1}{V_{s}}\left(V_{D D}-V_{i}\right) V_{O L}
$$

which results in

$$
V_{O L}=\frac{V_{D D}}{1+\left[\left(V_{D D}-V_{i}\right) / V_{s}\right]}
$$

It is interesting to note that the value of $V_{O L}$ can alternatively be found by noting that at point D , the MOSFET switch has a closure resistance $r_{D S}$,

$$
r_{D S}=\frac{1}{h_{o}\left(V_{D D}-V_{i}\right)}
$$

and $V_{O L}$ can be obtained from the voltage divider formed by $R_{D}$ and $r_{D S}$,

$$
V_{O L}=V_{D D} \frac{r_{D S}}{R_{D}+r_{D S}}=\frac{V_{D D}}{1+R_{D} / r_{D S}}
$$

Substituting for $r_{D S}$ from Eq. (14.23) gives an expression for $V_{O L}$ identical to that in Eq. (14.22).
(b) We observe that all the inverter parameters derived above are functions of $V_{D D}, V_{i}$, and $V_{s}$ only. Since $V_{D D}$ and $V_{i}$ are determined by the process technology, the only design parameter available is $V_{s} \equiv 1 / k_{0} R_{D}$. To place $V_{M}$ at half the supply voltage $V_{D D}$, we substitute $V_{M}=V_{D D} / 2$ in Eq. (14.13) to obtain the value $V_{s}$ must have as

$$
\left.V_{s}\right|_{V_{M}=V_{D D} / 2}=\frac{\left(V_{D D} / 2-V_{i}\right)^{2}}{V_{D D}}
$$

(c) For $V_{D D}=1.8 \mathrm{~V}$ and $V_{i}=0.5$, we use Eq. (14.25) to obtain

$$
\left.V_{s}\right|_{V_{M}=0.9 \mathrm{~V}}=\frac{(1.8 / 2-0.5)^{2}}{1.8}=0.089 \mathrm{~V}
$$

From Eq. (14.10):
$V_{O H}=1.8 \mathrm{~V}$
From Eq. (14.22):
$V_{O L}=0.12 \mathrm{~V}$
From Eq. (14.12):
$V_{I L}=0.59 \mathrm{~V}$
From Eq. (14.20):
$V_{I H}=1.06 \mathrm{~V}$
$$
\begin{gathered}
N M_{L}=V_{I L}-V_{O L}=0.47 \mathrm{~V} \\
N M_{H}=V_{O H}-V_{H I}=0.74 \mathrm{~V}
\end{gathered}
$$

(d) To determine $R_{D}$, we use

$$
k_{u} R_{D}=\frac{1}{V_{s}}=\frac{1}{0.089}=11.24
$$

Thus,

$$
R_{D}=\frac{11.24}{k_{u}^{\prime}(W / L)}=\frac{11.24}{300 \times 10^{-6} \times 1.5}=25 \mathrm{k} \Omega
$$

The inverter dissipates power only when the output is low, in which case the current drawn from the supply is

$$
I_{D D}=\frac{V_{D D}-V_{O L}}{R_{D}}=\frac{1.8-0.12}{25 \mathrm{k} \Omega}=67 \mu \mathrm{~A}
$$

and the power drawn from the supply during the low-output interval is

$$
P_{D}=V_{D D} I_{D D}=1.8 \times 67=121 \mu \mathrm{~W}
$$

Since the inverter spends half of the time in this state,

$$
P_{\text {Daverage }}=\frac{1}{2} P_{D}=60.5 \mu \mathrm{~W}
$$

(e) We now can make a few comments on the characteristics of this inverter circuit in comparison to the ideal characteristics:

1. The output signal swing, though not equal to the full power supply, is reasonably good: $V_{O H}=1.8 \mathrm{~V}$, $V_{O L}=0.12 \mathrm{~V}$.
2. The noise margins, though of reasonable values, are far from the optimum value of $V_{D D} / 2$. This is particularly the case for $N M_{L}$.
3. Most seriously, the gate dissipates a relatively large amount of power. To appreciate this point, consider an IC chip with a million inverters (a small number by today's standards): Its power dissipation will be 61 W . This is too large, especially given that this is "static power," unrelated to the switching activity of the gates (more on this later).

We consider this inverter implementation to be entirely unsuitable for IC fabrication because each inverter requires a load resistance of $25 \mathrm{k} \Omega$, a value that needs a large chip area (see Appendix A). To overcome this problem, we investigate in Example 14.3 the replacement of the passive resistance $R_{D}$ with a PMOS transistor.# EXERCISES 

D14.3 In an attempt to reduce the required value of $R_{D}$ to $10 \mathrm{k} \Omega$, the designer of the inverter in Example 14.2 decides to keep the parameter $V_{s}$ unchanged but increases W/L. What is the new value required for $W / L$ ? Do the noise margins change? What does the power dissipation become? Ans. 3.75; no; $151 \mu \mathrm{~W}$
D14.4 In an attempt to reduce the required value of $R_{D}$ to $10 \mathrm{k} \Omega$, the designer of the inverter in Example 14.2 decides to change $V_{s}$ while keeping $W / L$ unchanged. What new value of $V_{s}$ is needed? What do the noise margins become? What does the power dissipation become?
Ans. $V_{s}=0.22 \mathrm{~V} ; N M_{L}=0.46 \mathrm{~V}, N M_{H}=0.49 \mathrm{~V} ; 139 \mu \mathrm{~W}$

## Example 14.3 The Pseudo-NMOS Inverter

To eliminate the problem associated with the need for a large resistance $R_{D}$ in the circuit of Fig. 14.20(a), studied in Example 14.2, $R_{D}$ can be replaced by a MOSFET. One such possibility is the circuit in Fig. 14.21, where the load is a PMOS transistor $Q_{P}$ whose gate is tied to ground in order to turn it on. Because of its resemblance to an earlier form of logic (NMOS logic, now obsolete) in which the load is an NMOS transistor, this circuit is known as a pseudo-NMOS inverter.
(a) Assuming $\lambda_{1}=\lambda_{2}=0, V_{m}=-V_{W}=V_{s}$, and $k_{n}=5 k_{p}$, find $V_{D H}$ and $V_{D L}$.
(b) For $k_{n}=300 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{s}=0.4 \mathrm{~V}$, and $V_{D D}=1.8 \mathrm{~V}$, evaluate the values of $V_{D H}$ and $V_{D L}$ and find the average power dissipated in the inverter, assuming it spends half the time in each of its two states.


Figure 14.21 Pseudo-NMOS inverter for Example 14.3.
# Solution 

(a) To find $V_{O H}$, we set $v_{t}=0$. Clearly $Q_{N}$ will be off and conducting zero current. Transistor $Q_{P}$ also will be conducting zero current but because its $V_{S G}=V_{D D}$, it will be operating in the triode region with a zero voltage between its source and drain; thus the output voltage will be equal to $V_{D D}$,

$$
V_{O H}=V_{D D}
$$

Next, we find $V_{O L}$ by setting $v_{t}=V_{D D}$. Transistor $Q_{N}$ will be conducting. Since the output voltage $V_{O L}$ will likely be low and thus lower than $V_{t}, Q_{P}$ will be operating in the saturation region, thus

$$
i_{D P}=\frac{1}{2} k_{p}\left(V_{D D}-V_{t}\right)^{2}
$$

$Q_{N}$ will be operating in the triode region, thus

$$
i_{D N}=k_{n}\left[\left(V_{D D}-V_{t}\right) V_{O L}-\frac{1}{2} V_{O L}^{2}\right]
$$

Equating $i_{D P}$ and $i_{D N}$ yields a quadratic equation in $V_{O L}$ that can be solved to obtain

$$
V_{O L}=\left(V_{D D}-V_{t}\right)\left[1-\sqrt{1-\left(k_{p} / k_{n}\right)}\right]
$$

Here we have rejected the other root of the quadratic equation on the assumption that its value will be greater than $V_{t}$ and thus contravening our original assumption. The numerical values can be used to check these assumptions.
(b) Substituting the given numerical values we obtain

$$
\begin{aligned}
& V_{O H}=1.8 \mathrm{~V} \\
& V_{O L}=0.15 \mathrm{~V}
\end{aligned}
$$

We note that $V_{O L}$ is indeed lower than $V_{t}$, as originally assumed.
The inverter dissipates power in only one of its two states; namely, when its output is low. In this case, $Q_{P}$ is operating in saturation and

$$
\begin{aligned}
i_{D P} & =\frac{1}{2} k_{p}\left(V_{D D}-V_{t}\right)^{2} \\
& =\frac{1}{2} \times\left(\frac{300}{5}\right)(1.8-0.4)^{2} \\
& =58.8 \mu \mathrm{~A}
\end{aligned}
$$

and the power dissipation can be found from

$$
P=i_{D P} V_{D D}=58.8 \times 1.8=105.8 \mu \mathrm{~W}
$$

The average power dissipation can now be found as

$$
P_{a v}=\frac{1}{2} \times 105.8=52.9 \mu \mathrm{~W}
$$
# EXERCISE 

14.5 It is required to find $V_{M}$ for the pseudo-NMOS inverter of Fig. 14.21. Recall that $V_{M}$ is defined as a value of $v_{I}$ that results in $v_{O}=V_{M}$. Convince yourself that because $V_{M}>V_{i}, Q_{N}$ will be operating in saturation and $Q_{P}$ will be operating in the triode region. Hence show that

$$
V_{M}=V_{i}+\frac{V_{D D}-V_{i}}{\sqrt{r+1}}
$$

when $r \equiv k_{n} / k_{P}$.
Evaluate $V_{M}$ for $V_{D D}=1.8 \mathrm{~V}, V_{i}=0.4 \mathrm{~V}$, and $r=5$.
Ans. 0.97 V

### 14.3 The CMOS Inverter

In this section we study the inverter circuit of the most widely used digital IC technology: CMOS. The basic CMOS inverter, synthesized in Section 14.1.2, is shown in Fig. 14.22. It utilizes two MOSFETs: one, $Q_{N}$, with an $n$ channel and the other, $Q_{P}$, with a $p$ channel. The body of each device is connected to its source, and thus no body effect arises. As will be seen shortly, the CMOS circuit realizes the conceptual inverter implementation studied in the previous section (Fig. 14.18), where a pair of switches are operated in a complementary fashion by the input voltage $v_{I}$.

### 14.3.1 Circuit Operation

We first consider the two extreme cases: when $v_{I}$ is at logic-0 level, which is 0 V , and when $v_{I}$ is at logic-1 level, which is $V_{D D}$ volts. In both cases, for ease of exposition we shall consider the $n$-channel device $Q_{N}$ to be the driving transistor and the $p$-channel device $Q_{P}$ to be the


Figure 14.22 The CMOS inverter.


Figure 14.23 Operation of the CMOS inverter when $v_{I}$ is high: (a) circuit with $v_{I}=V_{D D}$ (logic-1 level, or $V_{O H}$ ); (b) graphical construction to determine the operating point; (c) equivalent circuit.
load. However, since the circuit is symmetric, this assumption is obviously arbitrary, and the reverse would lead to identical results.

Figure 14.23 illustrates the case when $v_{I}=V_{D D}$, showing the $i_{D}-v_{D S}$ characteristic curve for $Q_{N}$ with $v_{G S N}=V_{D D}$. (Note that $i_{D}=i$ and $v_{D S N}=v_{O}$.) Superimposed on the $Q_{N}$ characteristic curve is the load curve, which is the $i_{D}-v_{S D}$ curve of $Q_{P}$ for the case $v_{S G P}=0 \mathrm{~V}$. Since $v_{S G P}<\left|V_{i}\right|$, the load curve will be a horizontal straight line at zero current level. The operating point will be at the intersection of the two curves, where we note that the output voltage is zero and the current through the two devices is also zero. This means that the power dissipation in the circuit is zero. Note, however, that although $Q_{N}$ is operating at zero current and zero drain-source voltage (i.e., at the origin of the $i_{D}-v_{D S}$ plane), the operating point is on a steep segment of the $i_{D}-v_{D S}$ characteristic curve. Thus $Q_{N}$ provides a low-resistance path between the output terminal and ground, with the resistance obtained using Eq. (5.13b) as

$$
r_{D S N}=1 /\left[k_{n}^{\prime}\left(\frac{W}{L}\right)_{n}\left(V_{D D}-V_{t n}\right)\right]
$$

Figure 14.23(c) shows the equivalent circuit of the inverter when the input is high. ${ }^{2}$ This circuit confirms that $v_{O} \equiv V_{O L}=0 \mathrm{~V}$ and that the power dissipation in the inverter is zero.

The other extreme case, when $v_{I}=0 \mathrm{~V}$, is illustrated in Fig. 14.24. In this case $Q_{N}$ is operating at $v_{G S N}=0$; hence its $i_{D}-v_{D S}$ characteristic is a horizontal straight line at zero current level. The load curve is the $i_{D}-v_{S D}$ characteristic of the $p$-channel device with $v_{S G P}=$ $V_{D D}$. As shown, at the operating point the output voltage is equal to $V_{D D}$, and the current in the two devices is still zero. Thus the power dissipation in the circuit is zero in both extreme states.

[^0]
[^0]:    ${ }^{2}$ In Section 14.1 we referred to $r_{D S N}$ (and $r_{D S P}$ for $p$-channel devices) as $R_{o n}$.


Figure 14.24 Operation of the CMOS inverter when $v_{t}$ is low: (a) circuit with $v_{t}=0 \mathrm{~V}$ (logic-0 level, or $V_{O L}$ ); (b) graphical construction to determine the operating point; (c) equivalent circuit.

Figure 14.24(c) shows the equivalent circuit of the inverter when the input is low. Here we see that $Q_{P}$ provides a low-resistance path between the output terminal and the dc supply $V_{D D}$, with the resistance given by

$$
r_{D S P}=1 /\left[k_{p}\left(\frac{W}{L}\right)_{p}\left(V_{D D}-\left|V_{t p}\right|\right)\right]
$$

The equivalent circuit confirms that in this case $v_{O} \equiv V_{O H}=V_{D D}$ and that the power dissipation in the inverter is zero.

It should be noted, however, that in spite of the fact that the quiescent current is zero, the load-driving capability of the CMOS inverter is high. For instance, with the input high, as in the circuit of Fig. 14.23, transistor $Q_{N}$ can sink a relatively large load current. This current can quickly discharge the load capacitance, as will be seen shortly. Because of its action in sinking load current and thus pulling the output voltage down toward ground, transistor $Q_{N}$ is known as the pull-down device. Similarly, with the input low, as in the circuit of Fig. 14.24, transistor $Q_{P}$ can source a relatively large load current. This current can quickly charge up a load capacitance, thus pulling the output voltage up toward $V_{D D}$. Hence, $Q_{P}$ is known as the pull-up device. The reader will recall that we used this terminology in connection with the conceptual inverter circuit of Fig. 14.18 and in Section 14.1 as well.

From the above, we conclude that the basic CMOS logic inverter behaves as an ideal inverter. In summary:

1. The output voltage levels are 0 and $V_{D D}$, and thus the signal swing is the maximum possible. This, coupled with the fact that the inverter can be designed to provide a symmetrical voltage-transfer characteristic, results in wide noise margins.
2. The static power dissipation in the inverter is zero (neglecting the dissipation due to leakage currents) in both of its states. This is because no dc path exists between the power supply and ground in either state.
3. A low-resistance path exists between the output terminal and ground (in the low-output state) or $V_{D D}$ (in the high-output state). These low-resistance paths ensure that the output voltage is 0 or $V_{D D}$ independent of the exact values of the $W / L$ ratios or
other device parameters. Furthermore, the low output resistance makes the inverter less sensitive to the effects of noise and other disturbances.
4. The active pull-up and pull-down devices provide the inverter with high output-driving capability in both directions. As will be seen in Section 14.4, this speeds up the operation considerably.
5. The input resistance of the inverter is infinite (because $I_{G}=0$ ). Thus the inverter can drive an arbitrarily large number of similar inverters with no loss in signal level. Of course, each additional inverter increases the load capacitance on the driving inverter and slows down the operation. In Section 14.4, we will consider the inverter switching times.

FRANK MARION WANLESS-THE INVENTOR OF CMOS:

While working for Fairchild Semiconductor in 1963, Frank Wanless filed the first patent on CMOS logic, heralding the new age of zero-static-power logic. In 1964, as director of research and engineering at General Microelectronics (a start-up later bought by Philco-Ford), he created the first commercial CMOS integrated circuit. The symmetry of the logic form Wanless had invented was at first emphasized by the use of the name COmplementary Symmetry MOS, or COS-MOS, but the simpler CMOS shorthand soon prevailed.

# 14.3.2 The Voltage-Transfer Characteristic (VTC) 

The complete voltage-transfer characteristic (VTC) of the CMOS inverter can be obtained by repeating the graphical procedure, used above in the two extreme cases, for all intermediate values of $v_{I}$. In the following, we shall calculate the critical points of the resulting voltage-transfer curve. For this we need the $i-v$ relationships of $Q_{N}$ and $Q_{P}$. For $Q_{N}$,

$$
i_{D N}=k_{n}^{\prime}\left(\frac{W}{L}\right)_{n}\left[\left(v_{I}-V_{t n}\right) v_{O}-\frac{1}{2} v_{O}^{2}\right] \quad \text { for } v_{O} \leq v_{I}-V_{t n}
$$

and

$$
i_{D N}=\frac{1}{2} k_{v}^{\prime}\left(\frac{W}{L}\right)_{n}\left(v_{I}-V_{t n}\right)^{2} \quad \text { for } v_{O} \geq v_{I}-V_{t n}
$$

For $Q_{P}$,

$$
\begin{array}{r}
i_{D P}=k_{p}^{\prime}\left(\frac{W}{L}\right)_{p}\left[\left(V_{D D}-v_{I}-\left|V_{t p}\right|\right)\left(V_{D D}-v_{O}\right)-\frac{1}{2}\left(V_{D D}-v_{O}\right)^{2}\right] \\
\text { for } v_{O} \geq v_{I}+\left|V_{t p}\right|
\end{array}
$$

and

$$
i_{D P}=\frac{1}{2} k_{p}^{\prime}\left(\frac{W}{L}\right)_{p}\left(V_{D D}-v_{I}-\left|V_{t p}\right|\right)^{2} \quad \text { for } v_{O} \leq v_{I}+\left|V_{t p}\right|
$$


Figure 14.25 The voltage-transfer characteristic of the CMOS inverter when $Q_{N}$ and $Q_{P}$ are matched.

The CMOS inverter is usually designed to have $V_{m}=\left|V_{t p}\right|=V_{t}$. Also, although this is not always the case, we shall assume that $Q_{N}$ and $Q_{P}$ are matched; that is, $k_{n}^{\prime}(W / L)_{n}=k_{n}^{\prime}(W / L)_{p}$. It should be noted that since $\mu_{p}$ is 0.25 to 0.5 times the value of $\mu_{n}$, to make $k^{\prime}(W / L)$ of the two devices equal, the width of the $p$-channel device is made two to four times that of the $n$-channel device. More specifically, the two devices are designed to have equal lengths, with widths related by

$$
\frac{W_{p}}{W_{n}}=\frac{\mu_{n}}{\mu_{p}}
$$

This will result in $k_{n}^{\prime}(W / L)_{n}=k_{p}^{\prime}(W / L)_{p}$, and the inverter will have a symmetric transfer characteristic and equal current-driving capability in both directions (pull-up and pull-down).

With $Q_{N}$ and $Q_{P}$ matched, the CMOS inverter has the voltage-transfer characteristic shown in Fig. 14.25. As indicated, the transfer characteristic has five distinct segments corresponding to different combinations of modes of operation of $Q_{N}$ and $Q_{P}$. The vertical segment BC is obtained when both $Q_{N}$ and $Q_{P}$ are operating in the saturation region. Because we are neglecting the finite output resistance in saturation, that is, assuming $\lambda_{N}=\lambda_{P}=0$, the inverter gain in this region is infinite. From symmetry, this vertical segment occurs at $v_{I}=V_{D D} / 2$ and is bounded by $v_{O}(\mathrm{~B})=V_{D D} / 2+V_{t}$, at which value $Q_{P}$ enters the triode region and $v_{O}(\mathrm{C})=$ $V_{D D} / 2-V_{t}$, at which value $Q_{N}$ enters the triode region.
The reader will recall from Section 14.2.1 that in addition to $V_{O L}$ and $V_{O H}$, two other points on the transfer curve determine the noise margins of the inverter. These are the maximum permitted logic-0 or "low" level at the input, $V_{I L}$, and the minimum permitted logic-1 or "high" level at the input, $V_{I H}$. These are formally defined as the two points on the transfer curve at which the incremental gain is unity (i.e., the slope is $-1 \mathrm{~V} / \mathrm{V}$ ).

To determine $V_{I H}$, we note that $Q_{N}$ is in the triode region, and thus its current is given by Eq. (14.28), while $Q_{P}$ is in saturation and its current is given by Eq. (14.31). Equating $i_{D N}$ and $i_{D P}$, and assuming matched devices, gives

$$
\left(v_{I}-V_{t}\right) v_{O}-\frac{1}{2} v_{O}^{2}=\frac{1}{2}\left(V_{D D}-v_{I}-V_{t}\right)^{2}
$$

Differentiating both sides relative to $v_{I}$ results in

$$
\left(v_{I}-V_{t}\right) \frac{d v_{O}}{d v_{I}}+v_{O}-v_{O} \frac{d v_{O}}{d v_{I}}=-\left(V_{D D}-v_{I}-V_{t}\right)
$$

in which we substitute $v_{I}=V_{I H}$ and $d v_{O} / d v_{I}=-1$ to obtain

$$
v_{O}=V_{I H}-\frac{V_{D D}}{2}
$$

Substituting $v_{I}=V_{I H}$ and for $v_{O}$ from Eq. (14.34) in Eq. (14.33) gives

$$
V_{I H}=\frac{1}{8}\left(5 V_{D D}-2 V_{t}\right)
$$

$V_{I L}$ can be determined in a manner similar to that used to find $V_{I H}$. Alternatively, we can use the symmetry relationship

$$
V_{I H}-\frac{V_{D D}}{2}=\frac{V_{D D}}{2}-V_{I L}
$$

together with $V_{I H}$ from Eq. (14.35) to obtain

$$
V_{I L}=\frac{1}{8}\left(3 V_{D D}+2 V_{t}\right)
$$

The noise margins can now be determined as follows:

$$
\begin{aligned}
N M_{H} & =V_{O H}-V_{I H} \\
& =V_{D D}-\frac{1}{8}\left(5 V_{D D}-2 V_{t}\right) \\
& =\frac{1}{8}\left(3 V_{D D}+2 V_{t}\right) \\
N M_{L} & =V_{I L}-V_{O L} \\
& =\frac{1}{8}\left(3 V_{D D}+2 V_{t}\right)-0 \\
& =\frac{1}{8}\left(3 V_{D D}+2 V_{t}\right)
\end{aligned}
$$
As expected, the symmetry of the voltage-transfer characteristic results in equal noise margins. Of course, if $Q_{N}$ and $Q_{P}$ are not matched, the voltage-transfer characteristic will no longer be symmetric, and the noise margins will not be equal.

# 14.3.3 The Situation When $Q_{N}$ and $Q_{P}$ Are Not Matched 

In the above we assumed that $Q_{N}$ and $Q_{P}$ are matched; that is, in addition to $V_{t n}=\left|V_{t p}\right|$, the transconductance parameters $k_{n}$ and $k_{p}$ are made equal by selecting $W_{p} / W_{n}$ according to Eq. (14.32). The result is a symmetrical VTC that switches at the midpoint of the supply; that is, $V_{M}=V_{D D} / 2$. The symmetry, as we have seen, equalizes and maximizes the noise margins.

The price paid for obtaining a perfectly symmetric VTC is that the width of the $p$-channel device can be three to four times as large as that of the $n$-channel device. This can result in a relatively large silicon area, which, besides being wasteful of silicon real estate, can also result in increased device capacitances and a corresponding increase in the propagation delay of the inverter (Section 14.4). It is useful, therefore, to inquire into the effect of not matching $Q_{N}$ and $Q_{P}$. Toward that end we derive an expression for the switching voltage $V_{M}$ as follows.

Since at M, both $Q_{N}$ and $Q_{P}$ operate in saturation, their currents are given by Eqs. (14.29) and (14.31), respectively. Substituting $v_{I}=v_{O}=V_{M}$, and equating the two currents results in

$$
V_{M}=\frac{r\left(V_{D D}-\left|V_{t p}\right|\right)+V_{t n}}{r+1}
$$

where

$$
r=\sqrt{\frac{k_{p}}{k_{n}}}=\sqrt{\frac{\mu_{p} W_{p}}{\mu_{n} W_{n}}}
$$

where we have assumed that $Q_{N}$ and $Q_{P}$ have the same channel length $L$, which is usually the case with $L$ equal to the minimum available for the given process technology. Note that the matched case corresponds to $r=1$. For $\left|V_{t p}\right|=V_{t n}$, and $r=1$, Eq. (14.39) yields $V_{M}=V_{D D} / 2$, as expected. For a given process, that is, given values for $V_{D D}, V_{t n}$, and $V_{t p}$, one can plot $V_{M}$ versus the matching parameter $r$. Such a plot, for a $0.18-\mu \mathrm{m}$ process, is shown in Fig. 14.26. We make the following two observations:


Figure 14.26 Variation of the inverter switching voltage, $V_{M}$, with the parameter $r=\sqrt{k_{p} / k_{n}}$.
1. $V_{M}$ increases with $r$. Thus, making $k_{p}>k_{n}$ shifts $V_{M}$ toward $V_{D D}$. Conversely, making $k_{p}<k_{n}$ shifts $V_{M}$ toward 0 .
2. $V_{M}$ is not a strong function of $r$. For the particular case shown, lowering $r$ by a factor of 2 (from 1 to 0.5 ), reduces $V_{M}$ by only 0.13 V .

Observation 2 implies that if one is willing to tolerate a small reduction in $N M_{L}$, substantial savings in silicon area can be obtained. This point is illustrated in Example 14.4.

# Example 14.4 CMOS Inverter Static Characteristics and Design 

Consider a CMOS inverter fabricated in a $0.18-\mu \mathrm{m}$ process for which $V_{D D}=1.8 \mathrm{~V}, V_{i n}=\left|V_{i n}\right|=0.5 \mathrm{~V}$, $\mu_{n}=4 \mu_{p}$, and $\mu_{n} C_{o s}=300 \mu \mathrm{~A} / \mathrm{V}^{2}$. In addition, $Q_{N}$ and $Q_{P}$ have $L=0.18 \mu \mathrm{~m}$ and $(W / L)_{n}=1.5$.
(a) Find $W_{p}$ that results in $V_{M}=V_{D D} / 2=0.9 \mathrm{~V}$. What is the silicon area utilized by the inverter in this case?
(b) For the matched case in (a), find the values of $V_{O H}, V_{O L}, V_{I H}, V_{I L}$, and the noise margins $N M_{L}$ and $N M_{H}$. For $v_{I}=V_{I H}$, what value of $v_{O}$ results? This can be considered the worst-case value of $V_{O L}$. Similarly, for $v_{I}=V_{I L}$, find $v_{O}$ that is the worst-case value of $V_{O H}$. Now, use these worst-case values to determine more conservative values for the noise margins.
(c) For the matched case in (a), find the output resistance of the inverter in each of its two states.
(d) If $\lambda_{n}=\left|\lambda_{p}\right|=0.2 \mathrm{~V}^{-1}$, what is the inverter gain at $v_{I}=V_{M}$ ? If a straight line is drawn through the point $v_{I}=v_{O}=V_{M}$ with a slope equal to the gain, at what values of $v_{I}$ does it intercept the horizontal lines $v_{O}=0$ and $v_{O}=V_{D D}$ ? Use these intercepts to estimate the width of the transition region of the VTC.
(e) If $W_{p}=W_{n}$, what value of $V_{M}$ results? What do you estimate the reduction of $N M_{L}$ (relative to the matched case) to be? What is the percentage savings in silicon area (relative to the matched case)?
(f) Repeat (e) for the case $W_{p}=2 W_{n}$. This case, which is frequently used in industry, can be considered to be a compromise between the minimum-area case in (e) and the matched case.

## Solution

(a) To obtain $V_{M}=V_{D D} / 2=0.9 \mathrm{~V}$, we select $W_{p}$ according to Eq. (14.32),

$$
\frac{W_{p}}{W_{n}}=\frac{\mu_{n}}{\mu_{p}}=4
$$

Since $W_{n} / L=1.5, W_{n}=1.5 \times 0.18=0.27 \mu \mathrm{~m}$. Thus,

$$
W_{p}=4 \times 0.27=1.08 \mu \mathrm{~m}
$$

For this design, the silicon area is

$$
\begin{aligned}
A & =W_{n} L+W_{p} L=L\left(W_{n}+W_{p}\right) \\
& =0.18(0.27+1.08)=0.243 \mu \mathrm{~m}^{2}
\end{aligned}
$$

(b)

$$
\begin{aligned}
V_{O H} & =V_{D D}=1.8 \mathrm{~V} \\
V_{O L} & =0 \mathrm{~V}
\end{aligned}
$$# Example 14.4 continued 

To obtain $V_{I H}$ we use Eq. (14.35),

$$
V_{I H}=\frac{1}{8}\left(5 V_{D D}-2 V_{t}\right)=\frac{1}{8}(5 \times 1.8-2 \times 0.5)=1 \mathrm{~V}
$$

To obtain $V_{I L}$ we use Eq. (14.36),

$$
V_{I L}=\frac{1}{8}\left(3 V_{D D}+2 V_{t}\right)=\frac{1}{8}(3 \times 1.8+2 \times 0.5)=0.8 \mathrm{~V}
$$

We can now compute the noise margins as

$$
\begin{aligned}
& N M_{H}=V_{O H}-V_{I H}=1.8-1.0=0.8 \mathrm{~V} \\
& N M_{L}=V_{I L}-V_{O L}=0.8-0=0.8 \mathrm{~V}
\end{aligned}
$$

As expected, $N M_{H}=N M_{L}$, and their value is very close to the optimum value of $V_{D D} / 2=0.9 \mathrm{~V}$.
For $v_{I}=V_{I H}=1 \mathrm{~V}$, we can obtain the corresponding value of $v_{O}$ by substituting in Eq. (14.34),

$$
v_{O}=V_{I H}-\frac{V_{D D}}{2}=1-\frac{1.8}{2}=0.1 \mathrm{~V}
$$

Thus, the worst-case value of $V_{O L}$, that is, $V_{O L_{\max }}$, is 0.1 V , and the noise margin $N M_{L}$ reduces to

$$
N M_{L}=V_{I L}-V_{O L \max }=0.8-0.1=0.7 \mathrm{~V}
$$

From symmetry, we can obtain the value of $v_{O}$ corresponding to $v_{I}=V_{I L}$ as

$$
v_{O}=V_{D D}-0.1=1.7 \mathrm{~V}
$$

Thus the worst-case value of $V_{O H}$, that is, $V_{O H_{\text {min }}}$, is 1.7 V , and the noise margin $N M_{H}$ reduces to

$$
N M_{H}=V_{O H \text { min }}-V_{I H}=1.7-1=0.7 \mathrm{~V}
$$

Note that the reduction in the noise margins is slight.
(c) The output resistance of the inverter in the low-output state is

$$
\begin{aligned}
r_{D S N} & =\frac{1}{\mu_{a} C_{o s}(W / L)_{o}\left(V_{D D}-V_{I n}\right)} \\
& =\frac{1}{300 \times 10^{-6} \times 1.5(1.8-0.5)}=1.71 \mathrm{k} \Omega
\end{aligned}
$$
Since $Q_{N}$ and $Q_{P}$ are matched, the output resistance in the high-output state will be equal, that is,

$$
r_{D S P}=r_{D S N}=1.71 \mathrm{k} \Omega
$$

(d) If the inverter is biased to operate at $v_{I}=v_{O}=V_{M}=0.9 \mathrm{~V}$, then each of $Q_{N}$ and $Q_{P}$ will be operating at an overdrive voltage $V_{O V}=V_{M}-V_{t}=0.9-0.5=0.4 \mathrm{~V}$ and will be conducting equal dc currents $I_{D}$ of

$$
\begin{aligned}
I_{D} & =\frac{1}{2} \mu_{n} C_{o s}\left(\frac{W}{L}\right)_{N} V_{O V}^{2} \\
& =\frac{1}{2} \times 300 \times 1.5 \times 0.4^{2} \\
& =36 \mu \mathrm{~A}
\end{aligned}
$$

Thus, $Q_{N}$ and $Q_{P}$ will have equal transconductances:

$$
g_{m n}=g_{m p}=\frac{2 I_{D}}{V_{O V}}=\frac{2 \times 36}{0.4}=0.18 \mathrm{~mA} / \mathrm{V}^{2}
$$

Transistors $Q_{N}$ and $Q_{P}$ will have equal output resistances $r_{o}$,

$$
r_{o n}=r_{o p}=\frac{\left|V_{A}\right|}{I_{D}}=\frac{1}{|\lambda| I_{D}}=\frac{1}{0.2 \times 36}=139 \mathrm{k} \Omega
$$

We can now compute the voltage gain at M as

$$
\begin{aligned}
A_{v} & =-\left(g_{m n}+g_{m p}\right)\left(r_{o n} \| r_{o p}\right) \\
& =-(0.18+0.18)(139 \| 139)=-25 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

When the straight line at M of slope $-25 \mathrm{~V} / \mathrm{V}$ is extrapolated, it intersects the line $v_{O}=0$ at $[0.9+0.9 / 25]=$ 0.936 V and the line $v_{O}=V_{D O}$ at $0.9-0.9 / 25=0.864 \mathrm{~V}$. Thus the width of the transition region can be considered to be $(0.936-0.864)=0.072 \mathrm{~V}$.
(e) For $W_{p}=W_{n}$, the parameter $r$ can be found from Eq. (14.40),

$$
r=\sqrt{\frac{\mu_{p} W_{p}}{\mu_{n} W_{n}}}=\sqrt{\frac{1}{4} \times 1}=0.5
$$

The corresponding value of $V_{M}$ can be determined from Eq. (14.39) as

$$
V_{M}=\frac{0.5(1.8-0.5)+0.5}{0.5+1}=0.77 \mathrm{~V}
$$
# Example 14.4 continued 

Thus $V_{M}$ shifts by only -0.13 V . Without recalculating $V_{H}$, we can estimate the reduction in $N M_{L}$ to be approximately equal to the shift in $V_{M}$, that is, $N M_{L}$ becomes $0.8-0.13=0.67 \mathrm{~V}$. The silicon area for this design can be computed as follows:

$$
\begin{aligned}
A & =L\left(W_{n}+W_{p}\right)=0.18(0.27+0.27) \\
& =0.0972 \mu \mathrm{~m}^{2}
\end{aligned}
$$

This represents a $60 \%$ reduction from the matched case!
(f) For $W_{p}=2 W_{n}$,

$$
\begin{aligned}
r & =\sqrt{\frac{1}{4} \times 2}=\frac{1}{\sqrt{2}}=0.707 \\
V_{M} & =\frac{0.707(1.8-0.5)+0.5}{0.707+1}=0.83 \mathrm{~V}
\end{aligned}
$$

Thus, relative to the matched case, the shift in $V_{M}$ is only -0.07 V . We estimate that $N M_{L}$ will decrease from 0.8 V by the same amount; thus $N M_{L}$ becomes 0.73 V . In this case, the silicon area required is

$$
\begin{aligned}
A & =L\left(W_{n}+W_{p}\right)=0.18(0.27+0.54) \\
& =0.146 \mu \mathrm{~m}^{2}
\end{aligned}
$$

which represents a $40 \%$ reduction relative to the matched case!

## EXERCISES

14.6 Consider a CMOS inverter fabricated in a $0.13-\mu \mathrm{m}$ process for which $V_{D D}=1.2 \mathrm{~V}, V_{m}=-V_{i p}=$ $0.4 \mathrm{~V}, \mu_{w} / \mu_{p}=4$, and $\mu_{w} C_{o s}=430 \mu \mathrm{~A} / \mathrm{V}^{2}$. In addition, $Q_{N}$ and $Q_{P}$ have $L=0.13 \mu \mathrm{~m}$ and $(W / L)_{n}=1.0$.
(a) Find $W_{p}$ that results in $V_{M}=0.6 \mathrm{~V}$.
(b) For the matched case in (a), find the values of $V_{O H}, V_{O L}, V_{I H}, V_{I L}, N M_{H}$, and $N M_{L}$.
(c) For the inverter in (a), find the output resistance in each of its two states.
(d) For a minimum-size inverter for which $(W / L)_{p}=(W / L)_{n}=1.0$, find $V_{M}$.

Ans. (a) $0.52 \mu \mathrm{~m}$; (b) $1.2 \mathrm{~V}, 0 \mathrm{~V}, 0.65 \mathrm{~V}, 0.55 \mathrm{~V}, 0.55 \mathrm{~V}, 0.55 \mathrm{~V}$; (c) $2.9 \mathrm{k} \Omega, 2.9 \mathrm{k} \Omega$; (d) 0.53 V
D14.7 A CMOS inverter utilizes $V_{D D}=5 \mathrm{~V}, V_{m}=\left|V_{i p}\right|=1 \mathrm{~V}$, and $\mu_{w} C_{o s}=2 \mu_{p} C_{o s}=50 \mu \mathrm{~A} / \mathrm{V}^{2}$. Find $(W / L)_{n}$ and $(W / L)_{p}$ so that $V_{M}=2.5 \mathrm{~V}$ and so that for $v_{I}=V_{D D}$, the inverter can sink a current of 0.2 mA with the output voltage not exceeding 0.2 V .
Ans. $(W / L)_{n} \simeq 5 ;(W / L)_{p} \simeq 10$
# 14.4 Dynamic Operation of the CMOS Inverter 

The speed of operation of a digital system (e.g., a computer) is determined by the propagation delay of the logic gates used to construct the system. Since the inverter is the basic logic gate of any digital IC technology, the propagation delay of the inverter is a fundamental parameter in characterizing the speed of a given technology. We begin our study of the dynamic operation of CMOS in Section 14.4.1 by considering the propagation delay of a general inverter circuit. There, we introduce key definitions and analysis methods that are applied in the CMOS case in Sections 14.4.2 and 14.4.3.

### 14.4.1 Propagation Delay

The propagation delay is the time the inverter takes to respond to a change at its input. To be specific, let us consider an inverter fed with the ideal pulse shown in Fig. 14.27(a). The resulting output signal of the inverter is shown in Fig. 14.27(b). We make the following two observations.

1. The output signal is no longer an ideal pulse. Rather, it has rounded edges; that is, the pulse takes some time to fall to its low value and to rise to its high value. We speak of this as the pulse having finite fall and rise times. We will provide a precise definition of these shortly.
2. There is a time delay between each edge of the input pulse and the corresponding change in the output of the inverter. If we define the "switching point" of the output as the time at which the output pulse passes through the half-point of its excursion, then we can define the propagation delays of the inverter as indicated in Fig. 14.27(b). Note that there are two propagation delays, which are not necessarily equal: the propagation delay for the output going from high to low, $t_{P H L}$, and the propagation delay for the


Figure 14.27 An inverter fed with the ideal pulse in (a) provides at its output the pulse in (b). Two delay times are defined as indicated.
output going from low to high, $t_{P L H}$. The inverter propagation delay $t_{P}$ is defined as the average of the two,

$$
t_{P} \equiv \frac{1}{2}\left(t_{P L H}+t_{P H L}\right)
$$

Having defined the inverter propagation delay, we now consider the maximum switching frequency of the inverter. From Fig. 14.27(b) we can see that the minimum period for each cycle is

$$
T_{\min }=t_{P H L}+t_{P L H}=2 t_{P}
$$

Thus the maximum switching frequency ${ }^{3}$ is

$$
f_{\max }=\frac{1}{T_{\min }}=\frac{1}{2 t_{P}}
$$

At this point the reader is no doubt wondering about the cause of the finite propagation time of the inverter. It is simply a result of the time needed to charge and discharge the various capacitances in the circuit. These include the MOSFET capacitances, the wiring capacitance, and the input capacitances of all the logic gates driven by the inverter. We will have a lot more to say about these capacitances and about the determination of $t_{P}$ shortly. For the time being, however, we make two important points:

1. A fundamental relationship in analyzing the dynamic operation of a circuit is

$$
I \Delta t=\Delta Q=C \Delta V
$$

That is, a current $I$ flowing through a capacitance $C$ for an interval $\Delta t$ deposits a charge $\Delta Q$ on the capacitor, which causes the capacitor voltage to increase by $\Delta V$.
2. A thorough familiarity with the time response of single-time-constant (STC) circuits is of great help in the analysis of the dynamic operation of digital circuits. A review of this subject is presented in Appendix E. For our purposes here, we remind the reader of the key equation in determining the response to a step function:
Consider a step-function input applied to an STC circuit of either the low-pass or high-pass type, and let the circuit have a time constant $\tau$. The output at any time $t$ is given by

$$
y(t)=Y_{\infty}-\left(Y_{\infty}-Y_{0+}\right) e^{-t / \tau}
$$

where $Y_{\infty}$ is the final value, that is, the value toward which the response is heading, and $Y_{0+}$ is the value of the response immediately after $t=0$. This equation states that the output at any time $t$ is equal to the difference between the final value $Y_{\infty}$ and a gap whose initial value is $Y_{\infty}-\mathrm{Y}_{0+}$ and that is shrinking exponentially.

[^0]
[^0]:    ${ }^{3}$ This is a theoretical upper bound; practical circuits are operated at frequencies 10 to 20 times lower.
# Example 14.5 Calculating the Propagation Delay of a Simple Inverter 

Return to the inverter of Fig. 14.17(a) and consider the case where a capacitor $C$ is connected between the output node and ground. If at $t=0, v_{t}$ goes low, and assuming that the switch opens instantaneously, find the time for $v_{O}$ to reach $\frac{1}{2}\left(V_{O H}+V_{O L}\right)$. This is the low-to-high propagation time, $t_{P L H}$. Calculate the value of $t_{P L H}$ for the case $R=25 \mathrm{k} \Omega$ and $C=10 \mathrm{fF}$.


Figure 14.28 Example 14.5: (a) The inverter circuit after the switch opens (i.e., for $t \geq 0+$ ). (b) Waveforms of $v_{t}$ and $v_{O}$. Observe that the switch is assumed to operate instantaneously. $v_{O}$ rises exponentially, starting at $V_{O L}$ and heading toward $V_{O H}$.

## Solution

Before the switch opens, $v_{O}=V_{O L}$. When the switch opens at $t=0$, the circuit takes the form shown in Fig. 14.28(a). Since the voltage across the capacitor cannot change instantaneously, at $t=0+$ the output will still be $V_{O L}$. Then the capacitor charges through $R$, and $v_{O}$ rises exponentially toward $V_{D D}$. The output waveform will be as shown in Fig. 14.28(b), and its equation can be obtained by substituting in Eq. (14.45): $v_{O}(\infty)=V_{O H}=V_{D D}$ and $v_{O}(0+)=V_{O L}$. Thus,

$$
v_{O}(t)=V_{O H}-\left(V_{O H}-V_{O L}\right) e^{-t / \tau}
$$

where $\tau=C R$. To find $t_{P L H}$, we substitute

$$
v_{O}\left(t_{P L H}\right)=\frac{1}{2}\left(V_{O H}+V_{O L}\right)
$$

Thus,

$$
\frac{1}{2}\left(V_{O H}+V_{O L}\right)=V_{O H}-\left(V_{O H}-V_{O L}\right) e^{-t_{P L H} / \tau}
$$

which results in

$$
t_{P L H}=\tau \ln 2=0.69 \tau
$$
# Example 14.5 continued 

Note that this expression is independent of the values of $V_{O L}$ and $V_{O H}$. For the numerical values given,

$$
\begin{aligned}
t_{P L H} & =0.69 R C \\
& =0.69 \times 25 \times 10^{7} \times 10 \times 10^{-15} \\
& =173 \mathrm{ps}
\end{aligned}
$$

## EXERCISES

14.8 A capacitor $C$ whose initial voltage is 0 is charged to a voltage $V_{D D}$ by a constant-current source $I$. Find the time $t_{P L H}$ at which the capacitor voltage reaches $\left(V_{D D} / 2\right)$. What value of $I$ is required to obtain a 10 -ps propagation delay with $C=10 \mathrm{fF}$ and $V_{D D}=1.8 \mathrm{~V}$ ?
Ans. $t_{P L H}=C V_{D D} / 2 I ; 0.9 \mathrm{~mA}$
14.9 For the inverter of Fig. 14.18(a), let the on-resistance of $P_{U}$ be $20 \mathrm{k} \Omega$ and that of $P_{D}=10 \mathrm{k} \Omega$. If the capacitance $C=10 \mathrm{fF}$, find $t_{P L H}, t_{P H L}$, and $t_{P}$.
Ans. $138 \mathrm{ps} ; 69 \mathrm{ps} ; 104 \mathrm{ps}$

We conclude this section by showing in Fig. 14.29 the formal definition of the propagation delay of an inverter. As shown, an input pulse with finite (nonzero) rise and fall times is applied. The inverted pulse at the output exhibits finite rise and fall times (labeled $t_{T L H}$ and $t_{T H L}$, where the subscript $T$ denotes transition, $L H$ denotes low to high, and $H L$ denotes high to low). There is also a delay time between the input and output waveforms. The usual way to specify the propagation delay is to take the average of the high-to-low propagation delay, $t_{P H L}$, and the low-to-high propagation delay, $t_{P L H}$. As indicated, these delays are measured between the $50 \%$ points of the input and output waveforms. Also note that the transition times are specified using the $10 \%$ and $90 \%$ points of the output excursion $\left(V_{O H}-V_{O L}\right)$.

## EXERCISE

14.10 A capacitor $C=100 \mathrm{fF}$ is discharged from a voltage $V_{D D}$ to zero through a resistance $R=2 \mathrm{k} \Omega$. Find the fall time $t_{f}$ of the capacitor voltage.
Ans. $t_{f} \simeq 2.2 C R=0.44 \mathrm{~ns}$


Figure 14.29 Definitions of propagation delays and transition times of the logic inverter.

# 14.4.2 Determining the Propagation Delay of the CMOS Inverter 

Our strategy for determining the propagation delay of the CMOS inverter consists of two steps:

1. Replace all the capacitances in the circuit; that is, the various capacitances associated with $Q_{N}$ and $Q_{P}$, the capacitance of the wire that connects the output of the inverter to other circuits, and the input capacitance of the logic gates the inverter drives, by a single equivalent capacitance $C$ connected between the output node of the inverter and ground.
2. Analyze the resulting capacitively loaded inverter to determine its $t_{P L H}$ and $t_{P H L}$, and hence $t_{P}$.

We shall study these two separable steps in reverse order. Thus, in this section we show how the propagation delay can be determined. Then, in Section 14.4.3, we show how to calculate the value of $C$.

Figure 14.30(a) shows a CMOS inverter with a capacitance $C$ connected between its output node and ground. To determine the propagation delays $t_{P H L}$ and $t_{P L H}$, we apply to the input an ideal pulse, that is, one with zero rise and fall times, as shown in Fig. 14.30(b). Since the circuit has a symmetric structure, the analyses to determine the two propagation delays will be similar. Therefore, we will derive $t_{P H L}$ in detail and extrapolate the result to determine $t_{P L H}$.

Just prior to the leading edge of the input pulse (i.e., at $t=0-$ ), the output voltage is equal to $V_{D D}$ and capacitor $C$ is charged to this voltage. At $t=0, v_{I}$ rises to $V_{D D}$, causing $Q_{P}$ to turn off and $Q_{N}$ to turn on. From then on, the circuit is equivalent to that shown in Fig. 14.30(c), with the initial value of $v_{O}=V_{D D}$. Thus, at $t=0+, Q_{N}$ will operate in the saturation region and will supply a relatively large current to begin the process of discharging $C$. Figure 14.30(d) shows the trajectory of the operating point of $Q_{N}$ as $C$ is discharged. Here we are interested in


Figure 14.30 Dynamic operation of a capacitively loaded CMOS inverter: (a) circuit; (b) input and output waveforms; (c) equivalent circuit during the capacitor discharge; (d) trajectory of the operating point as the input goes high and $C$ discharges through $Q_{N}$.
the interval $t_{P H L}$ during which $v_{O}$ reduces from $V_{D D}$ to $V_{D D} / 2$. Correspondingly, the operating point of $Q_{N}$ moves from E to M . For a portion of this time, corresponding to the segment EF of the trajectory, $Q_{N}$ operates in saturation. Then at $\mathrm{F}, v_{O}=V_{D D}-V_{i}$, and $Q_{N}$ enters the triode region.

A simple approach for determining $t_{P H L}$ consists of first calculating the average value of the current supplied by $Q_{N}$ over the segment EM. Then, we use this average value of the discharge current to determine $t_{P H L}$ by means of the charge balance equation

$$
I_{a}, t_{P H L}=C\left[V_{D D}-\left(V_{D D} / 2\right)\right]
$$

resulting in

$$
t_{P H L}=\frac{C V_{D D}}{2 I_{a}}
$$
The value of $I_{\mathrm{av}}$ can be found as follows:

$$
I_{\mathrm{av}}=\frac{1}{2}\left[i_{D N}(\mathrm{E})+i_{D N}(\mathrm{M})\right]
$$

where

$$
i_{D N}(\mathrm{E})=\frac{1}{2} k_{n}^{\prime}\left(\frac{W}{L}\right)_{n}\left(V_{D D}-V_{t n}\right)^{2}
$$

and

$$
i_{D N}(\mathrm{M})=k_{n}^{\prime}\left(\frac{W}{L}\right)_{n}\left[\left(V_{D D}-V_{t n}\right)\left(\frac{V_{D D}}{2}\right)-\frac{1}{2}\left(\frac{V_{D D}}{2}\right)^{2}\right]
$$

Note that we have assumed $\lambda_{n}=0$. Combining Eqs. (14.46) to (14.49) provides

$$
t_{P H L}=\frac{\alpha_{n} C}{k_{n}^{\prime}(W / L)_{n} V_{D D}}
$$

where $\alpha_{n}$ is a factor determined by the relative values of $V_{t}$ and $V_{D D}$;

$$
\alpha_{n}=2 \int\left[\frac{7}{4}-\frac{3 V_{t n}}{V_{D D}}+\left(\frac{V_{t n}}{V_{D D}}\right)^{2}\right]
$$

The value of $\alpha_{n}$ typically falls in the range of 1 to 2 .
An expression for the low-to-high inverter delay, $t_{P L H}$, can be written by analogy to the $t_{P H L}$ expression in Eq. (14.50),

$$
t_{P L H}=\frac{\alpha_{p}}{k_{p}^{\prime}(W / L)_{p} V_{D D}}
$$

where

$$
\alpha_{p}=2 \int\left[\frac{7}{4}-\frac{3\left|V_{t p}\right|}{V_{D D}}+\left|\frac{V_{t p}}{V_{D D}}\right|^{2}\right]
$$

Finally, the propagation delay $t_{P}$ can be found as the average of $t_{P H L}$ and $t_{P L H}$,

$$
t_{P}=\frac{1}{2}\left(t_{P H L}+t_{P L H}\right)
$$

Examination of the formulas in Eqs. (14.50) to (14.53) enables us to make a number of useful observations:

1. As expected, the two components of $t_{P}$ can be equalized by selecting the $(W / L)$ ratios to equalize $k_{n}$ and $k_{p}$, that is, by matching $Q_{N}$ and $Q_{P}$. This assumes that $\alpha_{n}=\alpha_{p}$, which obtains when $V_{t n}=-V_{t p}$.2. Since $t_{P}$ is proportional to $C$, the designer should strive to reduce $C$. This is achieved by using the minimum possible channel length and by minimizing wiring and other parasitic capacitances. Careful layout of the chip can result in significant reduction in such capacitances.
3. Using a process technology with larger transconductance parameter $k^{\prime}$ can result in shorter propagation delays. Keep in mind, however, that for such processes $C_{o s}$ is increased, and thus the value of $C$ increases at the same time (more on this later).
4. Using larger $W / L$ ratios can result in a reduction in $t_{P}$. Care, however, should be exercised here also, since increasing the size of the devices increases the value of $C$, and thus the expected reduction in $t_{P}$ might not materialize. Reducing $t_{P}$ by increasing $W / L$, however, is an effective strategy when $C$ is dominated by components not directly related to the size of the driving device (such as wiring or fan-out devices).
5. A larger supply voltage $V_{D D}$ results in a lower $t_{P}$. However, $V_{D D}$ is determined by the process technology and thus is often not under the control of the designer. Furthermore, modern process technologies in which device sizes are reduced require lower $V_{D D}$ (see Appendix K). A motivating factor for lowering $V_{D D}$ is the need to keep the dynamic power dissipation at acceptable levels, especially in very-high-density chips. We will have more to say on this point in Section 14.6.

These observations clearly illustrate the conflicting requirements and the trade-offs available in the design of a CMOS digital integrated circuit (and indeed in any engineering design problem).

An Alternative Approach The formulas derived above for $t_{P H L}$ and $t_{P L H}$ underestimate the delay values for inverters implemented in deep-submicron technologies. This arises because of the velocity-saturation effect, which we shall discuss briefly in Section 15.1. There we will see that velocity saturation results in lower MOSFET currents in the saturation region, and hence in increased delay times. To deal with this problem, we present a very simple alternative approach to estimating the inverter propagation delay.

Figure 14.31 illustrates the alternative approach. During the discharge delay $t_{P H L}, Q_{N}$ is replaced by an equivalent resistance $R_{N}$. Similarly, during the charging delay $t_{P L H}, Q_{P}$ is replaced by an equivalent resistance $R_{P}$. It is easy to show that

$$
t_{P H L}=0.69 R_{N} C
$$

and

$$
t_{P L H}=0.69 R_{P} C
$$

Empirical values have been found for $R_{N}$ and $R_{P}$,

$$
\begin{aligned}
& R_{N}=\frac{12.5}{(W / L)_{n}} \mathrm{k} \Omega \\
& R_{P}=\frac{30}{(W / L)_{p}} \mathrm{k} \Omega
\end{aligned}
$$


Figure 14.31 Equivalent circuits for determining the propagation delays (a) $t_{P H L}$ and (b) $t_{P L H}$ of the inverter.

Furthermore, it has been found that these values apply for a number of CMOS fabrication processes including $0.25 \mu \mathrm{~m}, 0.18 \mu \mathrm{~m}$, and $0.13 \mu \mathrm{~m}$ (see Hodges et al., 2004).

As a final point, we note that the delay expressions in Eqs. (14.54) and (14.55) are obtained by assuming that the inverter is driven by a step-input voltage. In the more practical case of a ramp-input voltage, it has been shown that the 0.69 factor approaches unity, thus

$$
t_{P H L} \simeq R_{n} C
$$

and

$$
t_{P L H} \simeq R_{p} C
$$

# Example 14.6 Determining the Propagation Delay of the CMOS Inverter 

For the $0.25-\mu \mathrm{m}$ process characterized by $V_{D D}=2.5 \mathrm{~V}, V_{t n}=-V_{t p}=0.5 \mathrm{~V}, k_{n}^{\prime}=3.5 k_{p}^{\prime}=110 \mu \mathrm{~A} / \mathrm{V}^{2}$, find $t_{P L H}, t_{P H L}$, and $t_{P}$ for an inverter for which $(W / L)_{n}=1.5$ and $(W / L)_{p}=3$, and for $C=10 \mathrm{fF}$. Use both the approach based on average currents and that based on equivalent resistances, and compare the results obtained. If to save on power dissipation, the inverter is operated at $V_{D D}=2.0 \mathrm{~V}$, by what factor does $t_{P}$ change?
# Example 14.6 continued 

## Solution

(a) Using the average current approach, we determine from Eq. (14.51),

$$
\alpha_{a}=\frac{2}{\frac{7}{4}-\frac{3 \times 0.5}{2.5}+\left(\frac{0.5}{2.5}\right)^{2}}=1.7
$$

and using Eq. (14.50),

$$
t_{P H L}=\frac{1.7 \times 10 \times 10^{-15}}{110 \times 10^{-6} \times 1.5 \times 2.5}=41.2 \mathrm{ps}
$$

Since $\left|V_{i p}\right|=V_{i n}$,

$$
\alpha_{p}=\alpha_{n}=1.7
$$

and we can determine $t_{P L H}$ from Eq. (14.52) as

$$
t_{P L H}=\frac{1.7 \times 10 \times 10^{-15}}{(110 / 3.5) \times 10^{-6} \times 3 \times 2.5}=72.1 \mathrm{ps}
$$

The propagation delay can now be found as

$$
\begin{aligned}
t_{P} & =\frac{1}{2}\left(t_{P H L}+t_{P L H}\right) \\
& =\frac{1}{2}(41.2+72.1)=56.7 \mathrm{ps}
\end{aligned}
$$

(b) Using the equivalent-resistance approach, we first find $R_{N}$ from Eq. (14.56) as

$$
R_{N}=\frac{12.5}{1.5}=8.33 \mathrm{k} \Omega
$$

and then use Eq. (14.54) to determine $t_{P H L}$,

$$
t_{P H L}=0.69 \times 8.33 \times 10^{3} \times 10 \times 10^{-15}=57.5 \mathrm{ps}
$$

Similarly we use Eq. (14.57) to determine $R_{P}$,

$$
R_{P}=\frac{30}{3}=10 \mathrm{k} \Omega
$$
and Eq. (14.55) to determine $t_{P L H}$,

$$
t_{P L H}=0.69 \times 10 \times 10^{3} \times 10 \times 10^{-15}=69 \mathrm{ps}
$$

Thus, while the value obtained for $t_{P H L}$ is higher than that found using average currents, the value for $t_{P L H}$ is about the same. Finally, $t_{P}$ can be found as

$$
t_{P}=\frac{1}{2}(57.5+69)=63.2 \mathrm{ps}
$$

which is a little higher than the value found using average currents.
To find the change in propagation delays obtained when the inverter is operated at $V_{D D}=2.0 \mathrm{~V}$, we have to use the method of average currents. (The dependence on the power-supply voltage is absorbed in the empirical values of $R_{N}$ and $R_{P}$.) Using Eq. (14.51), we write

$$
\alpha_{n}=\frac{2}{\frac{7}{4}-\frac{3 \times 0.5}{2}+\left(\frac{0.5}{2}\right)^{2}}=1.9
$$

The value of $t_{P H L}$ can now be found by using Eq. (14.50):

$$
t_{P H L}=\frac{1.9 \times 10 \times 10^{-15}}{110 \times 10^{-6} \times 1.5 \times 2}=57.6 \mathrm{ps}
$$

Similarly, the value of $\alpha_{p}=\alpha_{n}=1.9$ can be substituted in Eq. (14.52) to obtain,

$$
t_{P L H}=\frac{1.9 \times 10 \times 10^{-15}}{(110 / 3.5) \times 10^{-6} \times 3 \times 2}=100.8 \mathrm{ps}
$$

and $t_{P}$ can be calculated as

$$
t_{P}=\frac{1}{2}(57.6+100.8)=79.8 \mathrm{ps}
$$

Thus, as expected, reducing $V_{D D}$ has resulted in increased propagation delay.

Before leaving the subject of propagation delay, we should emphasize that hand analysis using the simple formulas above should not be expected to yield precise results. Rather, its value is in obtaining design insight. Precise results can always be obtained using SPICE and Multisim simulations (see examples in Appendix B and the extensive material on the website). However, it is never a good idea to use simulation if one does not know beforehand approximate values of the expected results.
# EXERCISES 

14.11 For a CMOS inverter fabricated in a $0.18-\mu \mathrm{m}$ process with $V_{D D}=1.8 \mathrm{~V}, V_{m}=-V_{i p}=0.5 \mathrm{~V}$, $k_{n}^{\prime}=4 k_{p}^{\prime}=300 \mu \mathrm{~A} / \mathrm{V}^{2}$, and having $(W / L)_{n}=1.5$ and $(W / L)_{p}=3$, find $t_{P H L}, t_{P L H}$, and $t_{P}$ when the equivalent load capacitance $C=10 \mathrm{fF}$. Use the method of average currents.
Ans. $24.8 \mathrm{ps} ; 49.6 \mathrm{ps} ; 37.2 \mathrm{ps}$
D14.12 For a CMOS inverter fabricated in a $0.13-\mu \mathrm{m}$ process, use the equivalent-resistances approach to determine $(W / L)_{n}$ and $(W / L)_{p}$ so that $t_{P L H}=t_{P H L}=50 \mathrm{ps}$ when the effective load capacitance $C=$ 20 fF .
Ans. 3.5; 8.3

### 14.4.3 Determining the Equivalent Load Capacitance C

Having determined the propagation delay of the CMOS inverter in terms of the equivalent load capacitance $C$, it now remains to determine the value of $C$. For this purpose, a thorough understanding of the various capacitances in a MOS transistor is essential, and we urge the reader to review the material in Section 10.2.1.

Figure 14.32 shows the circuit for determining the propagation delay of the CMOS inverter formed by $Q_{1}$ and $Q_{2}$. Note that we are showing the inverter driving a similar inverter formed by transistors $Q_{3}$ and $Q_{4}$. This reflects a practical situation and will help us explain how to determine the contribution of a driven inverter to the equivalent capacitance $C$ at the output of the inverter under study (that formed by $Q_{1}$ and $Q_{2}$ ).

Indicated in Fig. 14.32 are the various transistor capacitances that connect to the output node of the $Q_{1}-Q_{2}$ inverter. Also shown is the wiring capacitance $C_{w}$, which represents


Figure 14.32 Circuit for analyzing the propagation delay of the inverter formed by $Q_{1}$ and $Q_{2}$, which is driving a similar inverter formed by $Q_{3}$ and $Q_{4}$.


Figure 14.33 The Miller multiplication of the feedback capacitance $C_{g d 1}$.
the capacitance of the wire or interconnect that connects the output of the $Q_{1}-Q_{2}$ inverter to the input of the $Q_{3}-Q_{4}$ inverter. Interconnect capacitances have become increasingly dominant as the technology has scaled down. In fact, some digital IC designers hold the view that interconnect poses a greater limitation on the speed of operation than the transistors themselves. We will discuss this topic briefly in Section 15.1.

A glance at the circuit in Fig. 14.32 should be sufficient to indicate that a pencil-and-paper analysis is virtually impossible. That, of course, is the reason we opted for the simplification of replacing all these capacitances with an equivalent capacitance $C$. Before we consider the determination of $C$, it is useful to observe that during $t_{P L H}$ or $t_{P H L}$, the output of the first inverter changes from 0 to $V_{D D} / 2$ or from $V_{D D}$ to $V_{D D} / 2$, respectively. Assuming that the switching threshold of the second inverter is $V_{D D} / 2$, it follows that the second inverter remains in the same state during each of our analysis intervals. This observation will have an important bearing on our estimation of the equivalent input capacitance of the second inverter. Let's now consider the contribution of each of the capacitances in Fig. 14.32 to the value of the equivalent load capacitance $C$ :

1. The gate-drain overlap capacitance of $Q_{1}, C_{g d 1}$, can be replaced by an equivalent capacitance between the output node and ground of $2 C_{g d 1}$. The factor 2 arises because of the Miller effect (Section 10.3.3). Specifically, refer to Fig. 14.33 and note that as $v_{I}$ goes high and $v_{O}$ goes low by the same amount, the change in voltage across $C_{g d 1}$ is twice that amount. Thus the output node sees in effect twice the value of $C_{g d 1}$. The same applies for the gate-drain overlap capacitance of $Q_{2}$, $C_{g d 2}$, which can be replaced by a capacitance $2 C_{g d 2}$ between the output node and ground.
2. Each of the drain-body capacitances $C_{d b 1}$ and $C_{d b 2}$ has a terminal at a constant voltage. Thus for the purpose of our analysis here, $C_{d b 1}$ and $C_{d b 2}$ can be replaced with equal capacitances between the output node and ground. Note, however, that the formulas given in Section 10.2.1 for calculating $C_{d b 1}$ and $C_{d b 2}$ are small-signal relationships, whereas the analysis here is obviously a large-signal one. A technique has been developed for finding equivalent large-signal values for $C_{d b 1}$ and $C_{d b 2}$ (see Hodges et al., 2004 and Rabaey et al., 2003).
3. Since the second inverter does not switch states, we will assume that the input capacitances of $Q_{3}$ and $Q_{4}$ remain approximately constant and equal to the total gate capacitance $\left(W L C_{o x}+C_{g s o v}+C_{g d o v}\right)$. That is, the input capacitance of the load inverter will be

$$
C_{g 3}+C_{g 4}=(W L)_{3} C_{o x}+(W L)_{4} C_{o x}+C_{g s o v 3}+C_{g d o v 3}+C_{g s o v 4}+C_{g d o v 4}
$$
4. The last component of $C$ is the wiring capacitance $C_{w}$, which simply adds to the value of $C$.

Thus, the total value of $C$ is given by

$$
C=2 C_{g d 1}+2 C_{g d 2}+C_{d b 1}+C_{d b 2}+C_{g 3}+C_{g 4}+C_{w}
$$

# Example 14.7 Determining the Effective Load Capacitance C and the Propagation Delay 

Consider a CMOS inverter fabricated in a $0.25-\mu \mathrm{m}$ process for which $C_{o s}=6 \mathrm{fF} / \mu \mathrm{m}^{2}, \mu_{n} C_{o s}=110 \mu \mathrm{~A} / \mathrm{V}^{2}$, $\mu_{p} C_{o s}=30 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{m}=-V_{t p}=0.5 \mathrm{~V}$, and $V_{D D}=2.5 \mathrm{~V}$. The $W / L$ ratio of $Q_{N}$ is $0.375 \mu \mathrm{~m} / 0.25 \mu \mathrm{~m}$, and that for $Q_{P}$ is $1.125 \mu \mathrm{~m} / 0.25 \mu \mathrm{~m}$. The gate-source and gate-drain overlap capacitances are specified to be $0.3 \mathrm{fF} / \mu \mathrm{m}$ of gate width. Further, the effective (large-signal) values of drain-body capacitances are $C_{d b n}=1 \mathrm{fF}$ and $C_{d b p}=1 \mathrm{fF}$. The wiring capacitance $C_{w}=0.2 \mathrm{fF}$. Find $t_{P H L}, t_{P L H}$, and $t_{P}$ when the inverter is driving an identical inverter.

## Solution

First, we determine the value of the equivalent capacitance $C$ using Eqs. (14.58) and (14.59),

$$
C=2 C_{g d 1}+2 C_{g d 2}+C_{d b 1}+C_{d b 2}+C_{g 3}+C_{g 4}+C_{w}
$$

where

$$
\begin{aligned}
C_{g d 1} & =0.3 \times W_{n}=0.3 \times 0.375=0.1125 \mathrm{fF} \\
C_{g d 2} & =0.3 \times W_{p}=0.3 \times 1.125=0.3375 \mathrm{fF} \\
C_{d b 1} & =1 \mathrm{fF} \\
C_{d b 2} & =1 \mathrm{fF} \\
C_{g 3} & =0.375 \times 0.25 \times 6+2 \times 0.3 \times 0.375=0.7875 \mathrm{fF} \\
C_{g 4} & =1.125 \times 0.25 \times 6+2 \times 0.3 \times 1.125=2.3625 \mathrm{fF} \\
C_{w} & =0.2 \mathrm{fF}
\end{aligned}
$$

Thus,

$$
C=2 \times 0.1125+2 \times 0.3375+1+1+0.7875+2.3625+0.2=6.25 \mathrm{fF}
$$

Next we use Eqs. (14.51) and (14.52) to determine $t_{P H L}$,

$$
\begin{gathered}
\alpha_{n}=\frac{2}{\frac{7}{4}-\frac{3 \times 0.5}{2.5}+\left(\frac{0.5}{2.5}\right)^{2}}=1.7 \\
t_{P H L}=\frac{1.7 \times 6.25 \times 10^{-15}}{110 \times 10^{-6} \times(0.375 / 0.25) \times 2.5}=25.8 \mathrm{ps}
\end{gathered}
$$
Similarly, we use Eqs. (14.53) and (14.54) to determine $t_{P L H}$,

$$
\begin{gathered}
\alpha_{p}=1.7 \\
t_{P L H}=\frac{1.7 \times 6.25 \times 10^{-15}}{30 \times 10^{-6} \times(1.125 / 0.25) \times 2.5}=31.5 \mathrm{ps}
\end{gathered}
$$

Finally, we determine $t_{P}$ as

$$
t_{P}=\frac{1}{2}(25.8+31.5)=28.7 \mathrm{ps}
$$

# EXERCISES 

14.13 Consider the inverter specified in Example 14.7 when loaded with an additional 0.1-pF capacitance. What will the propagation delay become?
Ans. 488 ps
14.14 In an attempt to decrease the area of the inverter in Example 14.7, $(W / L)_{p}$ is made equal to $(W / L)_{n}$. What is the percentage reduction in area achieved? Find the new values of $C, t_{P H L}, t_{P L H}$, and $t_{P}$. Assume that $C_{\text {dia }}$ does not change significantly.
Ans. $50 \% ; 4.225 \mathrm{fF} ; 17.4 \mathrm{ps} ; 63.8 \mathrm{ps} ; 40.6 \mathrm{ps}$
14.15 For the inverter of Example 14.7, find the theoretical maximum frequency at which it can be operated. Ans. 17.4 GHz

### 14.5 Transistor Sizing

In this section we address the extremely important design question of selecting appropriate sizes (i.e., $L$ and $W / L$ values) for all transistors in a CMOS logic circuit. We begin with the CMOS inverter and then consider general logic gates.

### 14.5.1 Inverter Sizing

In this section we are concerned with the selection of appropriate values for the channel length $L$ and the $(W / L)$ ratios for the two transistors $Q_{N}$ and $Q_{P}$ in an inverter. Our reasoning can be summarized as follows.

1. To minimize area, the length of all channels is usually made equal to the minimum length permitted by the given technology.
2. In a given inverter, if our interest is strictly to minimize area, $(W / L)_{n}$ is usually selected in the range 1 to 1.5 . The selection of $(W / L)_{p}$ relative to $(W / L)_{n}$ has influence on the noise margins and $t_{P L H}$. Both are optimized by matching $Q_{P}$ and $Q_{N}$. This, however, is usually wasteful of area and, equally important, can increase the effective capacitance $C$, so that although $t_{P L H}$ is made equal to $t_{P H L}$, the value of both can be higher than in the case without matching (see Problem 14.55). Thus, selecting $(W / L)_{p}=(W / L)_{n}$ is a possibility, and $(W / L)_{p}=2(W / L)_{n}$ is a frequently used compromise.
3. Having settled on an appropriate ratio of $(W / L)_{p}$ to $(W / L)_{n}$, we still have to select $(W / L)_{n}$ to reduce $t_{P}$ and thus allow higher speeds of operation. Any increase in $(W / L)_{n}$ and proportionally in $(W / L)_{p}$ will of course increase area, and hence the inverter contribution to the value of the equivalent capacitance $C$. To be more precise we express $C$ as the sum of an intrinsic component $C_{\text {int }}$ contributed by $Q_{N}$ and $Q_{P}$ of the inverter, and an extrinsic component $C_{\text {ext }}$ resulting from the wiring and the input capacitance of the driven gates,

$$
C=C_{\text {int }}+C_{\text {ext }}
$$

Increasing $(W / L)_{n}$ and $(W / L)_{p}$ of the inverter by a factor $S$ relative to that of a minimum-size inverter for which $C_{\text {int }}=C_{\text {int0 }}$ results in

$$
C=S C_{\text {int } 0}+C_{\text {ext }}
$$

Now, if we use the equivalent-resistances approach to compute $t_{P}$ and define an equivalent inverter resistance $R_{\mathrm{eq}}$ as

$$
R_{\mathrm{eq}}=\frac{1}{2}\left(R_{N}+R_{P}\right)
$$

then,

$$
t_{P}=0.69 R_{\mathrm{eq}} C
$$

Further, if for the minimum-size inverter $R_{\mathrm{eq}}$ is $R_{\mathrm{eq} 0}$, increasing $(W / L)_{n}$ and $(W / L)_{p}$ by the factor $S$ reduces $R_{\mathrm{eq}}$ by the same factor:

$$
R_{\mathrm{eq}}=R_{\mathrm{eq} 0} / S
$$

Combining Eqs. (14.63), (14.64), and (14.61), we obtain

$$
\begin{aligned}
& t_{P}=0.69\left(\frac{R_{\mathrm{eq} 0}}{S}\right)\left(S C_{\text {int } 0}+C_{\text {ext }}\right) \\
& t_{P}=0.69\left(R_{\mathrm{eq} 0} C_{\text {int } 0}+\frac{1}{S} R_{\mathrm{eq} 0} C_{\text {ext }}\right)
\end{aligned}
$$

We thus see that scaling the $W / L$ ratios does not change the component of $t_{P}$ caused by the capacitances of $Q_{N}$ and $Q_{P}$. It does, however, reduce the component of $t_{P}$ that results from capacitances external to the inverter itself. It follows that one can use Eq. (14.65) to decide on a suitable scaling factor $S$ that keeps $t_{P}$ below a specified maximum value, keeping in mind of course the effect of increasing $S$ on silicon area.
# EXERCISE 

14.16 For the inverter analyzed in Example 14.7:
(a) Find the intrinsic and extrinsic components of $C$.
(b) By what factor must $(W / L)_{n}$ and $(W / L)_{p}$ be increased to reduce the extrinsic part of $t_{F}$ by a factor of 2 ?
(c) Estimate the resulting $t_{F}$.
(d) By what factor is the inverter area increased?

Ans. (a) $2.9 \mathrm{fF}, 3.35 \mathrm{fF}$; (b) 2 ; (c) 21 ps ; (d) 2

## FEDERICO FAGGIN-A PIONEER IN MICROPROCESSOR ELECTRONICS:

Holder of a degree in physics from the University of Padua, Federico Faggin first worked for SGS-Fairchild in Italy. In 1968 he relocated to California, joining Fairchild in Palo Alto, where he developed the silicon-gate MOS device that has dominated MOS production ever since. In 1970 he joined Intel, where he led the design and production of the Intel 4004, the world's first commercial single-chip microcomputer, introduced in 1971. This design was based on a four-chip version with separated memory that Ted Hoff had designed in 1969 in response to the request by a Japanese calculator company for a twelve-chip flexible design. The 4004, a 4-bit processor, included 2300 PMOS logic circuits (a long-obsolete logic-circuit form) on a $3 \mathrm{~mm} \times 4 \mathrm{~mm}$ die, using a random-logic process created by Faggin. Subsequently, Faggin was responsible for the 8008 at Intel, and the Z80 8-bit microprocessor at Zilog (which he founded in 1974). Later, he went on to cofound several other companies, including Synaptics (in 1986 with Carver Mead and others), which provided touch-sensitive pad and screen designs for the mobile and PC products of many manufacturers.

### 14.5.2 Transistor Sizing in CMOS Logic Gates

Once a CMOS gate circuit has been generated, the only significant step remaining in the design is to decide on $W / L$ ratios for all devices. These ratios usually are selected to provide the gate with current-driving capability in both directions equal to that of the basic inverter. For the basic inverter design, denote $(W / L)_{n}=n$ and $(W / L)_{p}=p$, where $n$ is usually 1 to 1.5 and, for a matched design, $p=\left(\mu_{n} / \mu_{p}\right) n$; it should be noted, however, that often $p=2 n$ and for minimum area $p=n$. Thus, we wish to select individual $W / L$ ratios for all transistors in a logic gate so that the PDN should be able to provide a capacitor discharge current at least equal to that of an NMOS transistor with $W / L=n$, and the PUN should be able to provide a charging current at least equal to that of a PMOS transistor with $W / L=p$. This will guarantee a worst-case gate delay equal to that of the basic inverter. ${ }^{4}$

[^0]
[^0]:    ${ }^{4}$ This statement assumes that the total effective capacitance $C$ of the logic gate is the same as that of the inverter. In actual practice, the value of $C$ will be larger for a gate, especially as the fan-in is increased.In the preceding description, the idea of "worst case" should be emphasized. It means that in deciding on device sizing, we should find the input combinations that result in the lowest output current and then choose sizes that will make this current equal to that of the basic inverter. Before we consider examples, we need to address the issue of determining the current-driving capability of a circuit consisting of a number of MOS devices. In other words, we need to find the equivalent $W / L$ ratio of a network of MOS transistors. Toward that end, we consider the parallel and series connection of MOSFETs and find the equivalent $W / L$ ratios.

The derivation of the equivalent $W / L$ ratio is based on the fact that the on-resistance of a MOSFET is inversely proportional to $W / L$ (see Eqs. 14.56 and 14.57). Thus, if a number of MOSFETs having ratios of $(W / L)_{1},(W / L)_{2}, \ldots$, are connected in series, the equivalent series resistance obtained by adding the on-resistances will be

$$
\begin{aligned}
R_{\text {series }} & =R_{N 1}+R_{N 2}+\ldots \\
& =\frac{\text { constant }}{(W / L)_{1}}+\frac{\text { constant }}{(W / L)_{2}}+\ldots \\
& =\text { constant }\left[\frac{1}{(W / L)_{1}}+\frac{1}{(W / L)_{2}}+\ldots\right] \\
& =\frac{\text { constant }}{(W / L)_{\mathrm{eq}}}
\end{aligned}
$$

resulting in the following expression for $(W / L)_{\text {eq }}$ for transistors connected in series:

$$
(W / L)_{\mathrm{eq}}=\frac{1}{\frac{1}{(W / L)_{1}}+\frac{1}{(W / L)_{2}}+\ldots}
$$

Similarly, we can show that the parallel connection of transistors with $W / L$ ratios of $(W / L)_{1}$, $(W / L)_{2}, \ldots$, results in an equivalent $W / L$ of

$$
(W / L)_{\mathrm{eq}}=(W / L)_{1}+(W / L)_{2}+\ldots
$$

As an example, two identical MOS transistors with individual $W / L$ ratios of 4 result in an equivalent $W / L$ of 2 when connected in series and of 8 when connected in parallel. ${ }^{5}$

As an example of proper sizing, consider the four-input NOR in Fig. 14.34. Here, the worst case (the lowest current) for the PDN is obtained when only one of the NMOS transistors is conducting. We therefore select the $W / L$ of each NMOS transistor to be equal to that of the NMOS transistor of the basic inverter, namely, $n$. For the PUN, however, the worst-case situation (and indeed the only case) occurs when all inputs are low and the four series PMOS transistors are conducting. Since the equivalent $W / L$ will be one-quarter of that of each PMOS device, we should select the $W / L$ ratio of each PMOS transistor to be four times that of $Q_{P}$ of the basic inverter, that is, $4 p$.

[^0]
[^0]:    ${ }^{5}$ Another way of thinking about this is as follows: Connecting MOS transistors in series is equivalent to adding the lengths of their channels while the width does not change; connecting MOS transistors in parallel does not change the channel length but increases the width to the sum of the $W^{\prime} \mathrm{s}$.


Figure 14.34 Proper transistor sizing for a four-input NOR gate. Note that $n$ and $p$ denote the $W / L$ ratios of $Q_{N}$ and $Q_{P}$, respectively, of the basic inverter.


Figure 14.35 Proper transistor sizing for a four-input NAND gate. Note that $n$ and $p$ denote the $W / L$ ratios of $Q_{N}$ and $Q_{P}$, respectively, of the basic inverter.

As another example, we show in Fig. 14.35 the proper sizing for a four-input NAND gate. Comparison of the NAND and NOR gates in Figs. 14.34 and 14.35 indicates that because $p$ is usually two to three times $n$, the NOR gate will require much greater area than the NAND gate. For this reason, NAND gates are generally preferred for implementing combinational-logic functions in CMOS.
# Example 14.8 Transistor Sizing of a CMOS Gate 

Provide transistor $W / L$ ratios for the logic circuit shown in Fig. 14.36. Assume that for the basic inverter $n=1.5$ and $p=5$ and that the channel length is $0.25 \mu \mathrm{~m}$.


Figure 14.36 Circuit for Example 14.8.

## Solution

Refer to Fig. 14.36, and consider the PDN first. We note that the worst case occurs when $Q_{N B}$ is on and either $Q_{N C}$ or $Q_{N D}$ is on. That is, in the worst case, we have two transistors in series. Therefore, we select each of $Q_{N B}, Q_{N C}$, and $Q_{N D}$ to have twice the width of the $n$-channel device in the basic inverter, thus

$$
\begin{aligned}
& Q_{N B}: W / L=2 n=3=0.75 / 0.25 \\
& Q_{N C}: W / L=2 n=3=0.75 / 0.25 \\
& Q_{N D}: W / L=2 n=3=0.75 / 0.25
\end{aligned}
$$
For transistor $Q_{N A}$, select $W / L$ to be equal to that of the $n$-channel device in the basic inverter:

$$
Q_{N A}: W / L=n=1.5=0.375 / 0.25
$$

Next, consider the PUN. Here, we see that in the worst case, we have three transistors in series: $Q_{P A}$, $Q_{P C}$, and $Q_{P D}$. Therefore, we select the $W / L$ ratio of each of these to be three times that of $Q_{P}$ in the basic inverter, that is, $3 p$, thus

$$
\begin{aligned}
& Q_{P A}: W / L=3 p=15=3.75 / 0.25 \\
& Q_{P C}: W / L=3 p=15=3.75 / 0.25 \\
& Q_{P D}: W / L=3 p=15=3.75 / 0.25
\end{aligned}
$$

Finally, the $W / L$ ratio for $Q_{P B}$ should be selected so that the equivalent $W / L$ of the series connection of $Q_{P B}$ and $Q_{P A}$ should be equal to $p$. It follows that for $Q_{P B}$ the ratio should be $1.5 p$,

$$
Q_{P B}: W / L=1.5 p=7.5=1.875 / 0.25
$$

Figure 14.36 shows the circuit with the transistor sizes indicated.

# 14.5.3 Effects of Fan-In and Fan-Out on Propagation Delay 

Each additional input to a CMOS gate requires two additional transistors, one NMOS and one PMOS. This is in contrast to other forms of MOS logic, where each additional input requires only one additional transistor, such as in the pseudo-NMOS logic, whose basic inverter was considered in Example 14.3 and which will be studied in some detail in the next chapter. The additional transistor in CMOS not only increases the chip area but also increases the total effective capacitance per gate and in turn increases the propagation delay. The size-scaling method described earlier compensates for some (but not all) of the increase in $t_{P}$. Specifically, by increasing device size, we are able to preserve the current-driving capability. However, the capacitance $C$ increases because of both the increased number of inputs and the increase in device size. Thus $t_{P}$ will still increase with fan-in, a fact that imposes a practical limit on the fan-in of, say, the NAND gate to about 4. If a higher number of inputs is required, then "clever" logic design should be adopted to realize the given Boolean function with gates of no more than four inputs. This would usually mean an increase in the number of cascaded stages and thus an increase in delay. However, such an increase in delay can be less than the increase due to the large fan-in (see Problem 14.59).

An increase in a gate's fan-out adds directly to its load capacitance and, thus, increases its propagation delay.

Thus although CMOS has many advantages, it does suffer from increased circuit complexity when the fan-in and fan-out are increased, and from the corresponding effects of this complexity on both chip area and propagation delay. In Chapter 15, we shall study some simplified forms of CMOS logic that attempt to reduce this complexity, although at the expense of forgoing some of the advantages of basic CMOS.
# EXERCISES 

14.17 For a process technology with $L=0.18 \mu \mathrm{~m}, n=1.5, p=3$, give the sizes of all transistors in (a) a four-input NOR and (b) a four-input NAND. Also, give the relative areas of the two gates. Ans.
(a) NMOS devices: $W / L=0.27 / 0.18$, PMOS devices: $2.16 / 0.18$;
(b) NMOS devices: $W / L=1.08 / 0.18$, PMOS devices: $0.54 / 0.18$;

NOR area/NAND area $=1.5$
14.18 For the scaled NAND gate in Exercise 14.17, find the ratio of the maximum to minimum current available to (a) charge a load capacitance and (b) discharge a load capacitance.
Ans. (a) 4 ; (b) 1

### 14.5.4 Driving a Large Capacitance

In many cases in digital CMOS design, a logic gate must drive a large load capacitance. This might, for example, be due to a long wire on a chip, or to a requirement to drive an off-chip printed-circuit board trace, where the load capacitance can be several hundred times larger than the parasitic capacitances of the driving gate.

Let's investigate how to drive such a large load capacitance without causing the propagation delay to be unacceptably large. Figure 14.37(a) shows the large capacitive load $C_{L}$ driven by a standard inverter. Note that we have simplified the model of the inverter by assuming that all its capacitances can be lumped into a capacitance $C$ between its input and ground and that it has an effective output resistance $R$. Connecting $C_{L}$ directly to the inverter output results in a propagation delay, assuming a ramp input, equal to the time constant $\tau$,

$$
t_{P}=\tau=C_{L} R
$$

This propagation delay can be very large.
In an attempt to reduce the propagation delay, we can make the driver inverter large. Such a case is shown in Fig. 14.37(b), where an inverter $m$ times larger than the standard inverter is used. Its output resistance will be $R / m$, that is, $m$ times lower than that of the standard inverter. As a result, the propagation delay in this case will be

$$
\tau=C_{L}(R / m)=\frac{1}{m} C_{L} R
$$

which as desired has been reduced by a factor $m$. However, all is not well. Observe that the input capacitance of the large inverter is $m C$, which can be very large, requiring a large driving inverter to ensure that it does not contribute significantly to lengthening the overall propagation delay. Thus, it appears that we have not solved the problem, but rather shifted the burden to another inverter to drive the input of our large inverter.

The above reasoning leads to the idea of a chain of inverters connected in cascade, as shown in Fig. 14.37(c). Here we have $n$ inverters of progressively larger sizes. In fact, it has been found that the optimum (i.e., lowest overall propagation delay) is obtained when each inverter in the chain is larger than the preceding inverter by the same factor $x$. Thus if inverter 1 has a unit


Figure 14.37 Driving a large load capacitance $C_{L}$ : (a) directly; (b) by utilizing a large inverter; (c) by using a chain of progressively larger inverters.
size, inverter 2 has a size $x$, inverter 3 has a size $x^{2}$, and so on. Figure 14.37(c) shows the effect of inverter size scaling on its input capacitance and its equivalent output resistance. Observe that the delay time associated with the interface between each two succeeding inverters is $\tau=x C R$; that is, each interface contributes equally to the overall delay. This, of course, is a result of the geometric size scaling of the inverters in this chain. It has been shown that minimum delay is obtained if this equality of time constants extends to the output node, that is, by making

$$
\tau_{n} \equiv C_{L}\left(\frac{R}{x^{n-1}}\right)
$$

equal to $x C R$, which can be achieved if

$$
x^{n}=\frac{C_{L}}{C}
$$

in which case the overall delay becomes

$$
t_{P}=\tau_{\text {total }}=n x C R
$$
The question of selecting values for $x$ and $n$ remains. First, observe that there is already one condition on their values, namely, that in Eq. (14.70). It can be shown mathematically that the second condition that leads to minimum propagation delay (see Problem 14.62) is

$$
x=e=2.718
$$

In practice, it has been found that values for $x$ between 2.5 and 4 lead to optimum performance (see Hodges et al., 2004).

# Example 14.9 Design of an Inverter Chain to Drive a Large Load Capacitance 

An inverter whose input capacitance $C=10 \mathrm{fF}$ and whose equivalent output resistance $R=1 \mathrm{k} \Omega$ must ultimately drive a load capacitance $C_{L}=1 \mathrm{pF}$.
(a) What is the time delay that results if the inverter is connected directly to $C_{L}$ ?
(b) If a driver chain such as that in Fig. 14.37(c) is used, how many inverters $n$ and what size ratio $x$ should you use to minimize the total delay? What is the total path delay achieved?

## Solution

(a) $t_{P}=\tau=C_{L} R=10^{-12} \times 10^{3}=1 \mathrm{~ns}$.
(b) The delay is minimized by selecting

$$
x=e=2.718
$$

and

$$
x^{\prime \prime}=\frac{C_{L}}{C}=\frac{10^{-12}}{10 \times 10^{-15}}=100
$$

which yields

$$
n=\frac{\ln 100}{\ln x}=\frac{\ln 100}{\ln e}=4.6
$$

Since we must use an integral number of inverters, we select

$$
n=5
$$

and obtain $x$ from

$$
x^{\prime \prime}=x^{5}=\frac{C_{L}}{C}=100
$$

which yields

$$
x=(100)^{1 / 5}=2.51
$$

The total path delay will be

$$
\begin{aligned}
t_{P} & =n x C R \\
& =5 \times 2.51 \times 10 \times 10^{-15} \times 10^{3}=125.5 \mathrm{ps}
\end{aligned}
$$

which is a reduction in delay by a factor of about 8 !
# 14.6 Power Dissipation 

Many of today's integrated circuits are battery powered. Some even rely on "scavenged" energy, therefore severely limiting the supply of power. Other high-performance circuits, such as those found at computer server farms, have heat-dissipation limitations. Also, the desire to pack an ever-increasing number of gates on an IC chip (many millions at present) while keeping the power dissipated in the chip to an acceptable limit, has made attending to the power dissipated in a logic-gate circuit of paramount importance. Indeed, at the present time, minimizing power dissipation in digital ICs is perhaps the most important design challenge.

In this section, we look at sources of power consumption in digital CMOS circuits and present some metrics that are used in power optimization.

### 14.6.1 Sources of Power Dissipation

Let us return to the inverter of Fig. 14.17, which dissipates no power when $v_{t}$ is low and the switch is open. In the other state, however, the power dissipation is approximately $V_{D D}^{2} / R$ and can be substantial, as we saw in Examples 14.2 and 14.3. This power dissipation occurs even if the inverter is not switching and is thus known as static power dissipation.

Another inverter we studied earlier (see Fig. 14.18), which is the basis for the CMOS inverter, exhibits no static power dissipation, a definite advantage. Unfortunately, however, another component of power dissipation arises when a capacitance exists between the output node of the inverter and ground. As we have already seen, this is always the case, for the devices that implement the switches have internal capacitances, the wires that connect the inverter output to other circuits have capacitance, and, of course, there is the input capacitance of whatever circuit the inverter is driving. Now, as the inverter is switched from one state to another, current must flow through the switch(es) to charge (and discharge) the load capacitance. These currents give rise to power dissipation in the switches, called dynamic power dissipation.

An expression for the dynamic power dissipation of the inverter of Fig. 14.18 can be derived as follows. Consider first the situation when $v_{t}$ goes low. The pull-down switch $P_{D}$ turns off and the pull-up switch $P_{U}$ turns on. In this state, the inverter can be represented by the equivalent circuit shown in Fig. 14.38(a). Capacitor $C$ will charge through the on-resistance of the pull-up switch, and the voltage across $C$ will increase from 0 to $V_{D D}$. Denoting by $i_{D}(t)$ the charging current supplied by $V_{D D}$, we can write for the instantaneous power drawn from


Figure 14.38 Equivalent circuits for calculating the dynamic power dissipation of the inverter in Figure 14.18: (a) when $v_{t}$ is low; (b) when $v_{t}$ is high.
$V_{D D}$ the expression

$$
p_{D D}(t)=V_{D D} i_{D}(t)
$$

The energy delivered by the power supply to charge the capacitor can be determined by integrating $p_{D D}(t)$ over the charging interval $T_{c}$,

$$
\begin{aligned}
E_{D D} & =\int_{0}^{T_{c}} V_{D D} i_{D}(t) d t \\
& =V_{D D} \int_{0}^{T_{c}} i_{D}(t) d t \\
& =V_{D D} Q
\end{aligned}
$$

where $Q$ is the charge delivered to the capacitor during the charging interval. Since the initial charge on $C$ was zero,

$$
Q=C V_{D D}
$$

Thus,

$$
E_{D D}=C V_{D D}^{2}
$$

Since at the end of the charging process the energy stored on the capacitor is

$$
E_{\text {stored }}=\frac{1}{2} C V_{D D}^{2}
$$

we can find the energy dissipated in the pull-up switch as

$$
E_{\text {dissipated }}=E_{D D}-E_{\text {stored }}=\frac{1}{2} C V_{D D}^{2}
$$

This energy is dissipated in the on-resistance of switch $P_{U}$ and is converted to heat.
Next consider the situation when $v_{I}$ goes high. The pull-up switch $P_{U}$ turns off and the pull-down switch $P_{D}$ turns on. The equivalent circuit in this case is that shown in Fig. 14.38(b). Capacitor $C$ is discharged through the on-resistance of the pull-down switch, and its voltage changes from $V_{D D}$ to 0 . At the end of the discharge interval, there will be no energy left on the capacitor. Thus all of the energy initially stored on the capacitor, $\frac{1}{2} C V_{D D}^{2}$, will be dissipated in the pull-down switch,

$$
E_{\text {dissipated }}=\frac{1}{2} C V_{D D}^{2}
$$

This amount of energy is dissipated in the on-resistance of switch $P_{D}$ and is converted to heat.
Thus in each cycle of inverter switching, an amount of energy of $\frac{1}{2} C V_{D D}^{2}$ is dissipated in the pull-up switch and $\frac{1}{2} C V_{D D}^{2}$ is dissipated in the pull-down switch, for a total energy loss per cycle of

$$
E_{\text {dissipated }} / \text { cycle }=C V_{D D}^{2}
$$

If the inverter is switched at a frequency of $f \mathrm{~Hz}$, the dynamic power dissipation of the inverter will be

$$
P_{\text {dyn }}=f C V_{D D}^{2}
$$

This is a general expression that does not depend on the inverter circuit details or the values of the on-resistance of the switches.

The expression in Eq. (14.78) indicates that to minimize the dynamic power dissipation, one must strive to reduce the value of $C$. However, in many cases $C$ is largely determined by the transistors of the inverter itself and cannot be substantially reduced. Another important factor in determining the dynamic power dissipation is the power-supply voltage $V_{D D}$. Reducing $V_{D D}$ reduces $P_{\text {dyn }}$ significantly. This has been a major motivating factor behind the reduction of $V_{D D}$ with every technology generation (see Appendix K). Thus, while the $0.5-\mu \mathrm{m}$ CMOS process utilized a $5-\mathrm{V}$ power supply, the power-supply voltage used with the $0.13-\mu \mathrm{m}$ process is only 1.2 V .

Finally, since $P_{\text {dyn }}$ is proportional to the operating frequency $f$, one may be tempted to reduce $P_{\text {dyn }}$ by reducing $f$. However, this is not a viable proposition in light of the desire to operate digital systems at increasingly higher speeds. These newer chips, however, pack much more circuitry on the chip (as many as 2.75 billion transistors) and operate at higher frequencies (microprocessor clock frequencies above 5 GHz are now available). The dynamic power dissipation of such high-density chips can be over 100 W .

In addition to the dynamic power dissipation that results from the periodic charging and discharging of the inverter load capacitance, there is another component of power dissipation in the CMOS inverter that results from the current that flows through $Q_{P}$ and $Q_{N}$ during every switching event. Figure 14.39 shows this inverter current as a function of the input voltage



Figure 14.39 The current in the CMOS inverter versus the input voltage.$v_{I}$ for a matched inverter. We note that the current peaks at $V_{M}=V_{D D} / 2$. Since at this voltage both $Q_{N}$ and $Q_{P}$ operate in saturation, the peak current is given by

$$
I_{\text {peak }}=\frac{1}{2} \mu_{u} C_{o s}\left(\frac{W}{L}\right)_{u}\left(\frac{V_{D D}}{2}-V_{i n}\right)^{2}
$$

The width of the current pulse will depend on the rate of change of $v_{I}$ with time; the slower the rising edge of the input waveform, the wider the current pulse and the greater the energy drawn from the supply. In general, however, this power component is usually much smaller than $P_{\text {dyn }}$.

# EXERCISES 

14.19 Find the dynamic power dissipation of the inverter analyzed in Example 14.7 when operated at a 1-GHz frequency. Recall that $C=6.25 \mathrm{fF}$ and $V_{D D}=2.5 \mathrm{~V}$.
Ans. $39 \mu \mathrm{~W}$.
14.20 Find the dynamic power dissipation of a CMOS inverter operated from a $1.8-\mathrm{V}$ supply and having a load capacitance of 100 fF . Let the inverter be switched at 100 MHz .
Ans. $32.4 \mu \mathrm{~W}$
14.21 A particular inverter circuit initially designed in a $0.5-\mu \mathrm{m}$ process is fabricated in a $0.13-\mu \mathrm{m}$ process. Assuming that the capacitance $C$ will scale down in proportion to the minimum feature size (more on this in the next chapter) and that the power supply will be reduced from 5 V to 1.2 V , by what factor do you expect the dynamic power dissipation to decrease? Assume that the switching frequency $f$ remains unchanged.
Ans. 66.8

### 14.6.2 Power-Delay and Energy-Delay Products

One is usually interested in high-speed operation (low $t_{P}$ ) combined with low power dissipation. Unfortunately, these two requirements are often in conflict: Generally, if the designer of an inverter attempts to reduce power dissipation by, say, decreasing the supply voltage $V_{D D}$, or the supply current, or both, the current-driving capability of the inverter decreases. This in turn results in longer times to charge and discharge the load and parasitic capacitances, and thus the propagation delay increases. It follows that a figure of merit for comparing logic-circuit technologies is the power-delay product (PDP) of the basic inverter of the given technology, defined as

$$
P D P \equiv P_{D} t_{P}
$$

where $P_{D}$ is the power dissipation of the inverter. Note that the $P D P$ is an energy quantity and has the units of joules. The lower the $P D P$, the more effective the inverter and the logic circuits based on the inverter are.
For CMOS logic circuits, the static power dissipation of the inverter is zero, ${ }^{6}$ and thus $P_{D}$ is equal to $P_{\text {dyn }}$ and given by Eq. (14.78),

$$
P_{D}=f C V_{D D}^{2}
$$

Thus for the CMOS inverter,

$$
P D P=f C V_{D D}^{2} t_{P}
$$

If the inverter is operated at its theoretical maximum switching speed given by Eq. (14.43), then

$$
P D P=\frac{1}{2} C V_{D D}^{2}
$$

From our earlier discussion of dynamic power dissipation we know that $\frac{1}{2} C V_{D D}^{2}$ is the amount of energy dissipated during each charging or discharging event of the capacitor, that is, for each output transition of the inverter. Thus, the $P D P$ has an interesting physical interpretation: It is the energy consumed by the inverter for each output transition.

Although the $P D P$ is a valuable metric for comparing different technologies for implementing inverters, it is not useful as a design parameter for optimizing a given inverter circuit. To appreciate this point, observe that the expression in Eq. (14.82) indicates that the $P D P$ can be minimized by reducing $V_{D D}$ as much as possible while, of course, maintaining proper circuit operation. This, however, would not necessarily result in optimal performance, for $t_{P}$ will increase as $V_{D D}$ is reduced. The problem is that the $P D P$ expression in Eq. (14.82) does not in fact have information about $t_{P}$. It follows that a better metric can be obtained by multiplying the energy per transition by the propagation delay. We can thus define the energy-delay product $E D P$ as

$$
\begin{aligned}
E D P & \equiv \text { Energy per transition } \times t_{P} \\
& =\frac{1}{2} C V_{D D}^{2} t_{P}
\end{aligned}
$$

We will utilize the $E D P$ in later sections.

# EXERCISE 

14.22 For the CMOS inverter analyzed in Example 14.7, it was found that $C=6.25 \mathrm{fF}, V_{D D}=2.5 \mathrm{~V}$, and $t_{P}=28.7 \mathrm{ps}$. Find the power-delay product when the inverter is operated at its theoretical maximum possible operating frequency. Also find $E D P$.
Ans. $19.5 \mathrm{fJ} ; 5.6 \times 10^{-25} \mathrm{~J} \cdot \mathrm{~s}$.

[^0]
[^0]:    ${ }^{6}$ The exception to this statement is the power dissipation due to leakage currents and subthreshold conduction in the MOSFETs, discussed in Section 15.1.4.
## Summary

- A CMOS logic gate consists of an NMOS pull-down network (PDN) and a PMOS pull-up network (PUN). The PDN conducts for every input combination that requires a low output. Since an NMOS transistor conducts when its input is high, the PDN is most directly synthesized from the expression for the low output $(\bar{Y})$ as a function of the uncomplemented inputs. In a complementary fashion, the PUN conducts for every input combination that corresponds to a high output. Since a PMOS conducts when its input is low, the PUN is most directly synthesized from the expression for a high output $(Y)$ as a function of the complemented inputs.
- The digital logic inverter is the basic building block of digital circuits, just as the amplifier is the basic building block of analog circuits.
- The static operation of a logic inverter is described by its voltage-transfer characteristic (VTC). The VTC determines the inverter noise margins; refer to Fig. 14.13, Fig. 14.15, and to Table 14.1 for the definitions of important VTC points and the noise margins. In particular, note that $N M_{H}=V_{O H}-V_{I H}$ and $N M_{L}=V_{I L}-V_{O L}$, and refer to the ideal VTC in Fig. 14.16.
- The inverter is implemented using transistors operating as voltage-controlled switches. There are three possible arrangements, shown in Figs. 14.17, 14.18, and 14.19. The arrangement in Fig. 14.18 results in a high-performance inverter and is the basis for the CMOS inverter studied in Section 14.3.
- The speed of operation of the inverter is characterized by its propagation delay, $t_{p}$. Refer to Fig. 14.29 for the definitions of $t_{P L H}$ and $t_{P R L}$, and note that $t_{p}=$ $\frac{1}{2}\left(t_{P L H}+t_{P R L}\right)$.
- Digital ICs usually utilize the minimum channel length of the technology available. Thus for the CMOS inverter, $Q_{N}$ and $Q_{P}$ have $L=L_{\text {min }}$. If matching is desired, $W_{p} / W_{n}$ is selected equal to $\mu_{n} / \mu_{p}$ at the expense of increased area
and capacitance. For minimum area, $W_{p}=W_{n}$. Also, a frequently used compromise is $W_{p}=2 W_{n}$.
- For minimum area, $(W / L)_{n}$ is selected equal to 1 . However, to reduce $t_{P}$ especially when a major part of $C$ is extrinsic to the inverter, $(W / L)_{n}$ and correspondingly $(W / L)_{p}$ can be increased.
- CMOS logic circuits are usually designed to provide equal current-driving capability in both directions. Furthermore, the worst-case values of the pull-up and pull-down currents are made equal to those of the basic inverter. Transistor sizing is based on this principle and makes use of the equivalent $W / L$ ratios of series and parallel devices (Eqs. 14.66 and 14.67).
- An important performance parameter of the inverter is the amount of power it dissipates. There are two components of power dissipation: static and dynamic. The first is the result of current flow in either the 0 or 1 state or both. The second occurs when the inverter is switched and has a capacitor load $C$. Dynamic power dissipation $P_{\text {dyn }}=\beta C V_{D D}^{2}$.
- A metric that combines speed of operation and power dissipation is the power-delay product, $P D P=P_{D} t_{P}$. The lower the $P D P$, the more effective the logic-circuit family is. If dynamic power is dominant, such as in CMOS, the delay-power product for an inverter operated at its theoretical maximum switching frequency is $P D P=$ $\frac{1}{2} C V_{D D}^{2}$, which is the energy drawn from the supply for a 0 -to-1 and a 1-to-0 transition.
- Besides speed of operation and power dissipation, the silicon area required for an inverter is the third significant metric in digital IC design.
- Predominantly because of its low power dissipation and because of its scalability, CMOS is by far the most dominant technology for digital IC design. This situation is expected to continue for many years to come.
- Table 14.2 provides a summary of the important characteristics of the CMOS inverter.
Table 14.2 Summary of Important Characteristics of the CMOS Logic Inverter

# Inverter Output Resistance 

When $v_{D}$ is low (current sinking):

$$
r_{D S N}=1 /\left[I_{b}\left(\frac{W}{L}\right)_{n}\left(V_{D D}-V_{t n}\right)\right]
$$

When $v_{D}$ is high (current sourcing):

$$
r_{D S P}=1 /\left[I_{b}\left(\frac{W}{L}\right)_{p}\left(V_{D D}-\left|V_{t p}\right|\right)\right]
$$



## Inverter VTC and Noise Margins

$V_{M}=\frac{r\left(V_{D D}-\left|V_{t p}\right|\right)+V_{t n}}{1+r} \quad$ where $\quad r=\sqrt{\frac{I_{b}(W / L)_{p}}{I_{b}(W / L)_{n}}}$
For matched devices, that is, $\mu_{n}\left(\frac{W}{L}\right)_{n}=\mu_{p}\left(\frac{W}{L}\right)_{p}$, and $V_{t n}=-V_{t p}=V_{t}$
$r=1$
$V_{M}=V_{D D} / 2$
$V_{I L}=\frac{1}{8}\left(3 V_{D D}+2 V_{t}\right)$
$V_{I H}=\frac{1}{8}\left(5 V_{D D}-2 V_{t}\right)$
$N M_{H}=N M_{L}=\frac{1}{8}\left(3 V_{D D}+2 V_{t}\right)$


## Propagation Delay (Fig. 14.30)

Using average currents:
$t_{P H L} \approx \frac{\alpha_{n} C}{I_{b}(W / L)_{n} V_{D D}} \quad$ where $\quad \alpha_{n}=2 /\left[\frac{7}{4}-\frac{3 V_{t n}}{V_{D D}}+\left(\frac{V_{t n}}{V_{D D}}\right)^{2}\right]$
$t_{P L H} \approx \frac{\alpha_{p} C}{I_{b}(W / L)_{p} V_{D D}} \quad$ where $\quad \alpha_{p}=2 /\left[\frac{7}{4}-\frac{3\left|V_{t p}\right|}{V_{D D}}+\left(\frac{\left|V_{t p}\right|}{V_{D D}}\right)^{2}\right]$
Using equivalent resistances (Fig. 14.31):
$t_{P H L}=0.69 R_{N} C \quad$ where $\quad R_{N}=\frac{12.5}{(W / L)_{n}} \mathrm{k} \Omega$
$t_{P L H}=0.69 R_{P} C \quad$ where $\quad R_{P}=\frac{30}{(W / L)_{p}} \mathrm{k} \Omega$
For a ramp-input signal, $t_{P H L}=R_{N} C$ and $t_{P L H}=R_{P} C$.
## Computer Simulation Problems

310 Problems identified by the Multisim/PSpice icon are intended to demonstrate the value of using SPICE simulation to verify hand analysis and design, and to investigate important issues such as gate noise margins and propagation delays. Instructions to assist in setting up PSpice and Multisim simulations for all the indicated problems can be found in the corresponding files on the website. Note that if a particular parameter value is not specified in the problem statement, you are to make a reasonable assumption.

## Section 14.1: CMOS Logic-Gate Circuits

D 14.1 Consider MOS transistors fabricated in a $65-\mathrm{nm}$ process for which $\mu_{n} C_{e s}=470 \mu \mathrm{~A} / \mathrm{V}^{2}, \mu_{p} C_{e s}=190 \mu \mathrm{~A} / \mathrm{V}^{2}$, $V_{m}=-V_{t p}=0.35 \mathrm{~V}$, and $V_{D D}=1 \mathrm{~V}$.
(a) Find $R_{o u}$ of an NMOS transistor with $W / L=1.5$.
(b) Find $R_{o u}$ of a PMOS transistor with $W / L=1.5$.
(c) If $R_{o u}$ of the PMOS device is to be equal to that of the NMOS device in (a), what must $(W / L)_{p}$ be?

D 14.2 The CMOS inverter of Fig. 14.2(b) is implemented in a $0.13-\mu \mathrm{m}$ process for which $\mu_{n} C_{e s}=500 \mu \mathrm{~A} / \mathrm{V}^{2}, \mu_{p} C_{e s}=$ $125 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{m}=-V_{t p}=0.4 \mathrm{~V}$, and $V_{D D}=1.2 \mathrm{~V}$. The NMOS transistor has $(W / L)_{n}=1.5$.
(a) What must $(W / L)_{p}$ be if $Q_{N}$ and $Q_{P}$ are to have equal $R_{o u}$ resistances?
(b) Find the value of $R_{o u}$.

D 14.3 Give the CMOS circuit that realizes a three-input NOR gate.

D 14.4 Give the CMOS circuit for a three-input NAND gate.
D 14.5 Find the PUN that corresponds to the PDN shown in Fig. P14.5, and hence the complete CMOS logic circuit. What is the Boolean function realized?


Figure P14.5

D 14.6 Find the PUN that corresponds to the PDN shown in Fig. P14.6, and hence the complete CMOS logic circuit. What is the Boolean function realized?


Figure P14.6

D 14.7 Find the PDN that corresponds to the PUN shown in Fig. P14.7, and hence the complete CMOS logic circuit. What is the Boolean function realized?


Figure P14.7

D 14.8 Give the CMOS realization for the Boolean function

$$
Y=\overline{(A+B)(C+D)}
$$

D 14.9 Find the PDN that is the dual of the PUN in Fig. 14.10(a) and hence give a CMOS realization of the exclusive-OR (XOR) function.

[^0]
[^0]:    310 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
D 14.10 Provide a CMOS logic gate circuit that realizes the function

$$
Y=\bar{A} B C+A \bar{B} C+A B \bar{C}
$$

How many transistors are required? Explore the possibility of reducing the number of the transistors required.

D 14.11 Sketch a CMOS logic circuit that realizes the function $Y=A B+\bar{A} \bar{B}$. This is called the equivalence or coincidence function.

D 14.12 Sketch a CMOS logic circuit that realizes the function $Y=A B C+\bar{A} \bar{B} \bar{C}$.

D 14.13 It is required to design a CMOS logic circuit that realizes a three-input, even-parity checker. Specifically, the output $Y$ is to be low when an even number ( 0 or 2 ) of the inputs $A, B$, and $C$ are high.
(a) Give the Boolean function $\bar{Y}$.
(b) Sketch a PDN directly from the expression for $\bar{Y}$. Note that it requires 12 transistors in addition to those in the inverters.
(c) From inspection of the PDN circuit, reduce the number of transistors to 10 (not counting those in the inverters).
(d) Find the PUN as a dual of the PDN in (c), and hence the complete realization.

D 14.14 Give a CMOS logic circuit that realizes the function of a three-input, odd-parity checker. Specifically, the output is to be high when an odd number (1 or 3 ) of the inputs are high. Attempt a design with 10 transistors (not counting those in the inverters) in each of the PUN and the PDN.

D 14.15 Design a CMOS full-adder circuit with inputs $A$, $B$, and $C$, and two outputs $S$ and $C_{0}$ such that $S$ is 1 if one or three inputs are 1 , and $C_{0}$ is 1 if two or more inputs are 1 .

## Section 14.2: Digital Logic Inverters

14.16 A particular logic inverter is specified to have $V_{I L}=0.9 \mathrm{~V}, V_{I H}=1.2 \mathrm{~V}, V_{O L}=0.2 \mathrm{~V}$, and $V_{O H}=1.8 \mathrm{~V}$. Find the high and low noise margins, $N M_{H}$ and $N M_{L}$.
14.17 The voltage-transfer characteristic of a particular logic inverter is modeled by three straight-line segments in the manner shown in Fig. 14.13. If $V_{I L}=1.2 \mathrm{~V}, V_{I H}=1.3 \mathrm{~V}$, $V_{O L}=0.4 \mathrm{~V}$, and $V_{O H}=1.8 \mathrm{~V}$, find:
(a) the noise margins
(b) the value of $V_{M}$
(c) the voltage gain in the transition region
14.18 For a particular inverter design using a power supply $V_{D D}, V_{O L}=0.1 V_{D D}, V_{O H}=0.8 V_{D D}, V_{I L}=0.4 V_{D D}$, and $V_{I H}=0.6 V_{D D}$. What are the noise margins? What is the width of the transition region? For a minimum noise margin of 0.4 V , what value of $V_{D D}$ is required?
14.19 A logic-circuit family that used to be very popular is transistor-transistor logic (TTL). The TTL logic gates and other building blocks are available commercially in small-scale-integrated (SSI) and medium-scale-integrated (MSI) packages. Such packages can be assembled on printed-circuit boards to implement a digital system. The device data sheets provide the following specifications of the basic TTL inverter (of the SN7400 type):
Logic-1 input level required to ensure a logic-0 level at the output: MIN (minimum) 2 V
Logic-0 input level required to ensure a logic-1 level at the output: MAX (maximum) 0.8 V
Logic-1 output voltage: MIN 2.4 V, TYP (typical) 3.3 V
Logic-0 output voltage: TYP 0.22 V, MAX 0.4 V
Logic-0-level supply current: TYP 3 mA , MAX 5 mA
Logic-1-level supply current: TYP 1 mA , MAX 2 mA
(a) Find the worst-case values of the noise margins.
(b) Assuming that the inverter is in the logic-1 state $50 \%$ of the time and in the logic-0 state $50 \%$ of the time, find the average power dissipation in a typical circuit. The power supply is 5 V .
14.20 Consider an inverter implemented as in Fig. 14.17(a). Let $V_{D D}=2.5 \mathrm{~V}, R=2 \mathrm{k} \Omega, R_{o n}=100 \Omega, V_{I L}=0.8 \mathrm{~V}$, and $V_{I H}=1 \mathrm{~V}$.
(a) Find $V_{O L}, V_{O H}, N M_{H}$, and $N M_{L}$.
(b) The inverter is driving $N$ identical inverters. Each of these load inverters, or fan-out inverters as they are usually called, is specified to require an input current of 0.2 mA when the input voltage (of the fan-out inverter) is high and zero current when the input voltage is low. Noting that the input currents of the fan-out inverters will have to be supplied through $R$ of the driving inverter, find the resulting value of $V_{O H}$ and of $N M_{H}$ as a function of the number of fan-out inverters $N$. Hence find the maximum value $N$ can have while the inverter is still providing an $N M_{H}$ value approximately equal to its $N M_{L}$.

[^0]
[^0]:    $\overline{\text { SIN }}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; ${ }^{* * *}=$ very challenging; $\mathrm{D}=$ design problem
(c) Find the power dissipation in the inverter in the two cases: (i) the output is low, and (ii) the output is high and driving the maximum fan-out found in (b).
14.21 For an inverter employing a 2-V supply, suggest an ideal set of values for $V_{M}, V_{I L}, V_{I H}, V_{O L}, V_{O H}, N M_{L}, N M_{H}$. Also, sketch the VTC. What value of voltage gain in the transition region does your ideal specification imply?
14.22 For a particular inverter, the basic technology used provides an inherent limit to the small-signal, low-frequency voltage gain of $50 \mathrm{~V} / \mathrm{V}$. If, with a $2-\mathrm{V}$ supply, the values of $V_{O L}$ and $V_{O H}$ are ideal, but $V_{M}=0.4 V_{D D}$, what are the best possible values of $V_{I L}$ and $V_{I H}$ that can be expected? What are the best possible noise margins you could expect? Find the large-signal voltage gain, where the gain is defined by $\left(V_{O H}-\right.$ $\left.V_{O L}\right) /\left(V_{I L}-V_{I H}\right)$. (Hint: Use straight-line approximations for the VTC.)
*14.23 A logic-circuit type intended for use in a digital-signal-processing application in a newly developed hearing aid can operate down to single-cell supply voltages of 1.2 V . If for its inverter, the output signals swing between 0 and $V_{D D}$, the "gain-of-one" points are separated by less than $\frac{1}{3} V_{D D}$, and the noise margins are within $30 \%$ of one another, what ranges of values of $V_{I L}, V_{I H}, V_{O L}, V_{O H}, N M_{L}$, and $N M_{H}$ can you expect for the lowest possible battery supply?

D 14.24 Design the inverter circuit in Fig. 14.12(a) to provide $V_{O H}=1.2 \mathrm{~V}, V_{O L}=50 \mathrm{mV}$, and so that the current drawn from the supply in the low-output state is $30 \mu \mathrm{~A}$. The transistor has $V_{t}=0.4 \mathrm{~V}, \mu_{n} C_{o s}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $\lambda=0$. Specify the required values of $V_{D D}, R_{D}$, and $W / L$. How much power is drawn from the supply when the output is high? When the output is low?
14.25 For the current-steering circuit in Fig. 14.19, $V_{C C}=$ $2 \mathrm{~V}, I_{E E}=0.5 \mathrm{~mA}$, find the values of $R_{C 1}$ and $R_{C 2}$ to obtain a voltage swing of 0.5 V at each output. What are the values realized for $V_{O H}$ and $V_{O L}$ ?

D 14.26 Refer to the analysis of the resistive-load MOS inverter in Example 14.2 and utilize the expressions derived there for the various inverter parameters. Design the circuit to satisfy the following requirements: $V_{O H}=1.2 \mathrm{~V}$,
$V_{O L}=50 \mathrm{mV}$, and the power dissipation in the low-output state $=60 \mu \mathrm{~W}$. The transistor available has $V_{t}=0.4 \mathrm{~V}$, $\mu_{n} C_{o s}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $\lambda=0$. Specify the required values of $V_{D D}, R_{D}$, and $W / L$. What are the values obtained for $V_{I L}, V_{M}$, $V_{I H}, N M_{L}$, and $N M_{H}$ ?

D 14.27 Refer to the analysis of the resistive-load MOS inverter in Example 14.2 and utilize the expressions derived there for the various inverter parameters. For a technology for which $V_{t}=0.3 V_{D D}$, it is required to design the inverter to obtain $V_{M}=V_{D D} / 2$. In terms of $V_{D D}$, what is the required value of the design parameter $V_{t}$ ? What values are obtained for $V_{O H}, V_{O L}, V_{I L}, V_{I H}, N M_{H}$, and $N M_{L}$, in terms of $V_{D D}$ ? Give numerical values for the case $V_{D D}=1.2 \mathrm{~V}$. Now, express the power dissipated in the inverter in its low-output state in terms of the transistor's $W / L$ ratio. Let $k_{n}^{\prime}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$. If the power dissipation is to be limited to approximately $100 \mu \mathrm{~W}$, what $W / L$ ratio is needed and what value of $R_{D}$ corresponds?
14.28 An earlier form of logic circuits, now obsolete, utilized NMOS transistors only and was appropriately called NMOS logic. The basic inverter, shown in Fig. P14.28, utilizes an NMOS driver transistor $Q_{1}$ and another NMOS transistor $Q_{2}$, connected as a diode, forms the load of the inverter. Observe that $Q_{2}$ operates in saturation at all times. Assume $V_{t 1}=V_{t 2}=V_{t}, \lambda_{1}=\lambda_{2}=0$, and denote $\sqrt{k_{n 1} / k_{n 2}}$ by $k_{r}$. Also neglect the body effect in $Q_{2}$ (note that the body of $Q_{2}$, not shown, is connected to ground).


Figure P14.28
(a) Sketch $i-v$ for $Q_{2}$ and hence show that for $v_{I}$ low (i.e., $v_{I}<V_{m}$ ), the output voltage will be $V_{O H}=V_{D D}-V_{i}$. (Hint: Although $Q_{2}$ will be conducting zero current, it will have a voltage drop of $V_{i}$.)
(b) Taking $V_{I L}$ as the value of $v_{I}$ at which $Q_{1}$ begins to conduct and $v_{O}$ begins to fall, find $V_{I L}$.
(c) Find the relationship between $v_{O}$ and $v_{I}$ in the transition region. This is the region for which $v_{I}>V_{i}$ and both $Q_{1}$ and $Q_{2}$ are operating in saturation. Show that the relationship is linear and find its slope.
(d) If $V_{O L} \simeq 0 \mathrm{~V}$, find the current $I_{D D}$ drawn from $V_{D D}$ and hence the average power dissipation in the inverter, assuming that it spends half the time in each of its two states.
(e) Find numerical values for all the parameters asked for above for the case $V_{D D}=1.8 \mathrm{~V}, V_{i}=0.5 \mathrm{~V},(W / L)_{1}=5$, $(W / L)_{2}=\frac{1}{5}$, and $\mu_{n} C_{o s}=300 \mu \mathrm{~A} / \mathrm{V}^{2}$.
14.29 For the pseudo-NMOS inverter analyzed in Example 14.3 and in Exercise 14.5, what is the value of $r$ that results in $V_{M}=V_{D D} / 2=0.9 \mathrm{~V}$ ?
14.30 Repeat Example 14.3 for a pseudo-NMOS inverter fabricated in a $0.13-\mu \mathrm{m}$ CMOS technology for which $V_{D D}=$ $1.2 \mathrm{~V},|V_{i}|=0.4 \mathrm{~V}, k_{n} / k_{p}=5$, and $k_{n}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$. Find $V_{O H}$, $V_{O L}, I_{D D}$, and the average power dissipation $P_{a s}$. Also, use the expression given in Exercise 14.5 to evaluate $V_{M}$.

## Section 14.3: The CMOS Inverter

14.31 Consider a CMOS inverter fabricated in a $65-\mathrm{nm}$ CMOS process for which $V_{D D}=1 \mathrm{~V}, V_{m}=-V_{i p}=0.35 \mathrm{~V}$, and $\mu_{n} C_{o s}=2.5 \mu_{p} C_{o s}=470 \mu \mathrm{~A} / \mathrm{V}^{2}$. In addition, $Q_{N}$ and $Q_{P}$ have $L=65 \mathrm{~nm}$ and $(W / L)_{n}=1.5$.
(a) Find $W_{p}$ that results in $V_{M}=V_{D D} / 2$. What is the silicon area utilized by the inverter in this case?
(b) For the matched case in (a), find the values of $V_{O H}, V_{O L}$, $V_{I H}, V_{I L}, N M_{L}$, and $N M_{H}$.
(c) For the matched case in (a), find the output resistance of the inverter in each of its two states.
14.32 Consider a CMOS inverter fabricated in a $0.25-\mu \mathrm{m}$ CMOS process for which $V_{D D}=2.5 \mathrm{~V}, V_{m}=-V_{i p}=$ 0.5 V , and $\mu_{n} C_{o s}=3.5 \mu_{p} C_{o s}=115 \mu \mathrm{~A} / \mathrm{V}^{2}$. In addition, $Q_{N}$
and $Q_{P}$ have $L=0.25 \mu \mathrm{~m}$ and $(W / L)_{n}=1.5$. Investigate the variation of $V_{M}$ with the ratio $W_{p} / W_{n}$. Specifically, calculate $V_{M}$ for (a) $W_{p}=3.5 W_{n}$ (the matched case), (b) $W_{p}=W_{n}$ (the minimum-size case); and (c) $W_{p}=2 W_{n}$ (a compromise case). For cases (b) and (c), estimate the approximate reduction in $N M_{L}$ and silicon area relative to the matched case (a).
14.33 For a technology in which $V_{m}=0.3 V_{D D}$, show that the maximum current that the inverter can sink while its low-output level does not exceed $0.1 V_{D D}$ is $0.065 k_{n}^{\prime}(W / L)_{n} V_{D D}^{2}$. For $V_{D D}=1.3 \mathrm{~V}, k_{n}^{\prime}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$, find $(W / L)_{n}$ that permits this maximum current to be 0.1 mA .
14.34 A CMOS inverter for which $k_{n}=5 k_{p}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{i}=0.5 \mathrm{~V}$ is connected as shown in Fig. P14.34 to a sinusoidal signal source having a Thévenin equivalent voltage of $0.1-\mathrm{V}$ peak amplitude and resistance of $100 \mathrm{k} \Omega$. What signal voltage appears at node $A$ with $v_{I}=+1.5 \mathrm{~V}$ ? With $v_{I}=-1.5 \mathrm{~V} ?$


Figure P14.34

D 14.35 There are situations in which $Q_{N}$ and $Q_{P}$ of the CMOS inverter are deliberately mismatched to realize a certain desired value for $V_{M}$. Show that the value required of the parameter $r$ of Eq. (14.40) is given by

$$
r=\frac{V_{M}-V_{m}}{V_{D D}-\left|V_{i p}\right|-V_{M}}
$$

For a $0.13-\mu \mathrm{m}$ process characterized by $V_{m}=-V_{i p}=0.4 \mathrm{~V}$, $V_{D D}=1.3 \mathrm{~V}$, and $\mu_{n}=4 \mu_{p}$, find the ratio $W_{p} / W_{n}$ required to obtain $V_{M}=0.6 V_{D D}$.
14.36 Consider the CMOS inverter of Fig. 14.22 with $Q_{N}$ and $Q_{P}$ matched and with the input $v_{I}$ rising slowly from 0 to $V_{D D}$. At what value of $v_{I}$ does the current flowing through $Q_{N}$ and $Q_{P}$ reach its peak? Give an expression for the peak current, neglecting $\lambda_{n}$ and $\lambda_{p}$. For $k_{n}^{\prime}=500 \mu \mathrm{~A} / \mathrm{V}^{2},(W / L)_{n}=1.5$, $V_{D D}=1.3 \mathrm{~V}$, and $V_{m}=0.4 \mathrm{~V}$, find the value of the peak current.
14.37 Repeat Example 14.4 for a CMOS inverter fabricated in a $0.13-\mu \mathrm{m}$ process for which $V_{D D}=1.3 \mathrm{~V}, V_{m}=\left|V_{m}\right|=$ $0.4 \mathrm{~V}, \mu_{n}=4 \mu_{p}$, and $\mu_{n} C_{o s}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$. In addition, $Q_{N}$ and $Q_{P}$ have $L=0.13 \mu \mathrm{~m}$ and $(W / L)_{n}=1.5$. For part (a) use $V_{M}=V_{D D} / 2=0.65 \mathrm{~V}$.

## Section 14.4: Dynamic Operation of the CMOS Inverter

14.38 For the circuit shown in Fig. P14.38, let switch $S$ open at $t=0$.
(a) Give the expression for $v_{O}(t)$.
(b) For $I=1 \mathrm{~mA}$ and $C=10 \mathrm{pF}$, find the time at which $v_{O}$ reaches 1 V .


Figure P14.38
14.39 For the circuit in Fig. P14.39, let $C$ be charged to 10 V and switch $S$ closes at $t=0$.
(a) Give the expression for $v_{O}(t)$.
(b) For $C=100 \mathrm{pF}$ and $R=1 \mathrm{k} \Omega$, find $t_{P H L}$ and $t_{f}$.


Figure P14.39
14.40 For the inverter circuit in Fig. P14.40, let $v_{I}$ go from $V_{D D}$ to 0 V at $t=0$. At $t=0+, v_{O}=V_{O L}$. Find expressions for $V_{O H}, v_{O}(t)$, and $t_{P H H}$. If $R=10 \mathrm{k} \Omega$, what is the largest value of $C$ that ensures that $t_{P H H}$ is at most 100 ps ?


Figure P14.40
14.41 For the inverter of Fig. 14.18(a) with a capacitance $C$ connected between the output and ground, let the on-resistance of $P_{U}$ be $2 \mathrm{k} \Omega$ and that of $P_{D}$ be $1 \mathrm{k} \Omega$. If the capacitance $C=50 \mathrm{fF}$, find $t_{P H H}, t_{P H L}$, and $t_{P}$.
14.42 A logic inverter is implemented using the arrangement of Fig. 14.18 with switches having $R_{o n}=2 \mathrm{k} \Omega, V_{D D}=1.8 \mathrm{~V}$, and $V_{I L}=V_{H I}=V_{D D} / 2$.
(a) Find $V_{O L}, V_{O H}, N M_{L}$, and $N M_{H}$.
(b) If $v_{I}$ rises instantaneously from 0 V to +1.8 V and assuming the switches operate instantaneously-that is, at $t=0$, PU opens and PD closes-find an expression for $v_{O}(t)$, assuming that a capacitance $C$ is connected between the output node and ground. Hence find the high-to-low
propagation delay $\left(t_{P H L}\right)$ for $C=0.1 \mathrm{pF}$. Also find $t_{T H L}$ (see Fig. 14.29).
(c) Repeat (b) for $v_{I}$ falling instantaneously from +1.8 V to 0 V . Again assume that PD opens and PU closes instantaneously. Find an expression for $v_{O}(t)$, and hence find $t_{P L H}$ and $t_{T L H}$.
14.43 In a particular logic family, the standard inverter, when loaded by a similar circuit, has a propagation delay specified to be 0.9 ns :
(a) If the current available to charge a load capacitance is half as large as that available to discharge the capacitance, what do you expect $t_{P L H}$ and $t_{P H L}$ to be?
(b) If when an external capacitive load of 0.5 pF is added at the inverter output, its propagation delays increase by $50 \%$, what do you estimate the normal combined capacitance of inverter output and input to be?
(c) If without the additional $0.5-\mathrm{pF}$ load connected, the load inverter is removed and the propagation delays were observed to decrease by $40 \%$, estimate the two components of the capacitance found in (b): that is, the component due to the inverter output and other associated parasitics, and the component due to the input of the load inverter.
*14.44 Consider an inverter for which $t_{P L H}, t_{P H L}, t_{T L H}$, and $t_{T H L}$ are $20 \mathrm{~ns}, 10 \mathrm{~ns}, 30 \mathrm{~ns}$, and 15 ns , respectively. The rising and falling edges of the inverter output can be approximated by linear ramps. Also, for simplicity, we define $t_{T L H}$ to be $0 \%$ to $100 \%$ (rather than $10 \%$ to $90 \%$ ) rise time, and similarly for $t_{T H L}$. Two such inverters are connected in tandem and driven by an ideal input having zero rise and fall times. Calculate the time taken for the output voltage to complete its excursion for (a) a rising input and (b) a falling input. What is the propagation delay for the inverter?

14.45 For a CMOS inverter fabricated in a $0.13-\mu \mathrm{m}$ process with $V_{D D}=1.2 \mathrm{~V}, V_{m}=-V_{q r}=0.4 \mathrm{~V}, k_{n}^{\prime}=4 k_{p}^{\prime}=$ $430 \mu \mathrm{~A} / \mathrm{V}^{2}$, and having $(W / L)_{n}=1.5$ and $(W / L)_{p}=3$, find $t_{P H L}, t_{P L H}$, and $t_{P}$ when the equivalent load capacitance $C=10$ fF. Use the method of average currents.

D 14.46 Consider a matched CMOS inverter fabricated in the $0.13-\mu \mathrm{m}$ process specified in Problem 14.45. If $C=30 \mathrm{fF}$,
use the method of average currents to determine the required $(W / L)$ ratios so that $t_{P} \leq 80 \mathrm{ps}$.
14.47 For the CMOS inverter in Exercise 14.11 use the method of equivalent resistance to determine $t_{P H L}, t_{P L H}$, and $t_{P}$.
14.48 Use the method of equivalent resistance to determine the propagation delay of a minimum-size inverter, that is, one for which $(W / L)_{n}=(W / L)_{p}=1$, designed in a $0.13-\mu \mathrm{m}$ technology. The equivalent load capacitance $C=20 \mathrm{fF}$.

D 14.49 Use the method of equivalent resistance to design an inverter to be fabricated in a $0.13-\mu \mathrm{m}$ technology. It is required that for $C=10 \mathrm{fF}, t_{P L H}=t_{P H L}$, and $t_{P} \leq 50 \mathrm{ps}$.
14.50 The method of average currents yields smaller values for $t_{P H L}$ and $t_{P L H}$ than those obtained by the method of equivalent resistances. Most of this discrepancy is due to the fact that the formula we derived for $I_{a s}$ does not take into account velocity saturation. As will be seen in Section 15.1.2, velocity saturation reduces the current significantly. Using the results in Example 14.6, by what factor do you estimate the current reduction to be in the NMOS transistor? Since $t_{P L H}$ does not change, what do you conclude about the effect of velocity saturation on the PMOS transistor in this technology?
14.51 Use the method of average currents to estimate $t_{P H L}, t_{P L H}$, and $t_{P}$ of a CMOS inverter fabricated in a $65-\mathrm{nm}$ process for which $V_{m}=\left|V_{q r}\right|=0.35 \mathrm{~V}, V_{D D}=1$ $\mathrm{V}, \mu_{a} C_{c o}=470 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $\mu_{a} C_{c o}=190 \mu \mathrm{~A} / \mathrm{V}^{2}$. The inverter has $(W / L)_{n}=1.5$ and $(W / L)_{p}=3$, and the total capacitance at the inverter output node is 10 fF . Also, find the theoretical maximum frequency at which this inverter can be operated.
14.52 Find the propagation delay for a minimum-size inverter for which $k_{n}^{\prime}=4 k_{p}^{\prime}=380 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $(W / L)_{n}=$ $(W / L)_{p}=0.27 \mu \mathrm{~m} / 0.18 \mu \mathrm{~m}, V_{D D}=1.8 \mathrm{~V}, V_{m}=-V_{q r}=0.5 \mathrm{~V}$, and the capacitance is roughly $4 \mathrm{fF} / \mu \mathrm{m}$ of device width plus 2 fF /device. There is an additional load capacitance of 5 fF . What does $t_{P}$ become if the design is changed to a matched one? Use the method of average current.14.53 A matched CMOS inverter fabricated in a process for which $C_{o s}=3.7 \mathrm{fF} / \mu \mathrm{m}^{2}, \mu_{n} C_{o s}=180 \mu \mathrm{~A} / \mathrm{V}^{2}, \mu_{p} C_{o s}=45 \mu \mathrm{~A} / \mathrm{V}^{2}$, $V_{t n}=-V_{t p}=0.7 \mathrm{~V}$, and $V_{D D}=3.3 \mathrm{~V}$, uses $W_{n}=0.75 \mu \mathrm{~m}$ and $L_{n}=L_{p}=0.5 \mu \mathrm{~m}$. The overlap capacitance and the effective drain-body capacitance per micrometer of gate width are 0.4 fF and 1.0 fF , respectively. The wiring capacitance is $C_{w}=2$ fF . If the inverter is driving another identical inverter, find $t_{P L H}, t_{P H L}$, and $t_{P}$. For how much additional capacitance load does the propagation delay increase by $50 \%$ ?

## Section 14.5: Transistor Sizing

14.54 An inverter whose equivalent load capacitance $C$ is composed of 15 fF contributed by the inverter transistors, and 45 fF contributed by the wiring and other external circuitry, has been found to have a propagation delay of 80 ps . By what factor must $(W / L)_{n}$ and $(W / L)_{p}$ be increased so as to reduce $t_{P}$ to 40 ps ? By what factor is the inverter area increased?

D *14.55 In this problem we investigate the effect of the selection of the ratio $W_{p} / W_{n}$ on the propagation delay of an inverter driving an identical inverter, as in Fig. 14.32. Assume all transistors have the same $L$.
(a) Noting that except for $C_{w}$ each of the capacitances in Eqs. (14.58) and (14.59) is proportional to the width of the relevant transistor, show that $C$ can be expressed as

$$
C=C_{n}\left(1+\frac{W_{p}}{W_{n}}\right)+C_{w}
$$

where $C_{n}$ is determined by the NMOS transistors.
(b) Using the equivalent resistances $R_{N}$ and $R_{P}$, show that for $(W / L)_{n}=1$,

$$
\begin{aligned}
& t_{P H L}=8.625 \times 10^{3} C \\
& t_{P L H}=\frac{20.7 \times 10^{3}}{W_{p} / W_{n}} C
\end{aligned}
$$

(c) Use the results of (a) and (b) to determine $t_{P}$ in the case $W_{p}=W_{n}$, in terms of $C_{n}$ and $C_{w}$.
(d) Use the results of (a) and (b) to determine $t_{P}$ in the matched case: that is, when $W_{p} / W_{n}$ is selected to yield $t_{P H L}=t_{P L H}$.
(e) Compare the $t_{P}$ values in (c) and (d) for the two extreme cases:
(i) $C_{w}=0$
(ii) $C_{w} \gg C_{n}$

What do you conclude about the selection of $W_{p} / W_{n}$ ?

D 14.56 Consider the CMOS gate shown in Fig. 14.9. Specify $W / L$ ratios for all transistors in terms of the ratios $n$ and $p$ of the basic inverter, such that the worst-case $t_{P H L}$ and $t_{P L H}$ of the gate are equal to those of the basic inverter.

D 14.57 Find appropriate sizes for the transistors used in the exclusive-OR circuit of Fig. 14.10(b). Assume that the basic inverter has $(W / L)_{n}=0.20 \mu \mathrm{~m} / 0.13 \mu \mathrm{~m}$ and $(W / L)_{p}=$ $0.40 \mu \mathrm{~m} / 0.13 \mu \mathrm{~m}$. What is the total area, including that of the required inverters?
14.58 Consider a four-input CMOS NAND gate for which the transient response is dominated by a fixed-size capacitance between the output node and ground. Compare the values of $t_{P L H}$ and $t_{P H L}$, obtained when the devices are sized as in Fig. 14.35, to the values obtained when all $n$-channel devices have $W / L=n$ and all $p$-channel devices have $W / L=p$.
14.59 Figure P14.59 shows two approaches to realizing the OR function of six input variables. The circuit in Fig. P14.59(b), though it uses additional transistors, has in fact less total area and lower propagation delay because it uses NOR gates with lower fan-in. Assuming that the transistors in both circuits are properly sized to provide each gate with a current-driving capability equal to that of the basic matched inverter, find the number of transistors and the total area of each circuit. Assume the basic inverter to have a $(W / L)_{n}$ ratio of $0.20 \mu \mathrm{~m} / 0.13 \mu \mathrm{~m}$ and a $(W / L)_{p}$ ratio of $0.40 \mu \mathrm{~m} / 0.13 \mu \mathrm{~m}$.
*14.60 Consider the two-input CMOS NOR gate of Fig. 14.7 whose transistors are properly sized so that the current-driving


Figure P14.59
capability in each direction is equal to that of a matched inverter. For $\left|V_{i}\right|=1 \mathrm{~V}$ and $V_{D D}=5 \mathrm{~V}$, find the gate threshold in the cases for which (a) input terminal $A$ is connected to ground and (b) the two input terminals are tied together. Neglect the body effect in $Q_{F B}$.
14.61 A chain of four inverters whose sizes are scaled by a factor $x$ is used to drive a load capacitance $C_{L}=1200 C$, where $C$ is the input capacitance of the standard inverter (which is the first in the chain).
(a) Without increasing the number of inverters in the chain, find the optimum value of $x$ that results in minimizing the overall delay $t_{P}$ and find the resulting value of $t_{P}$ in terms of the time constant $C R$, where $R$ is the output resistance of the standard inverter.
(b) If you are allowed to increase the number of inverters in the chain, what is the number of inverters and the value of $x$ that result in minimizing the total path delay $t_{P}$ ? What is the value of $t_{P}$ achieved?
14.62 The purpose of this problem is to find the values of $n$ and $x$ that result in minimum path delay $t_{P}$ for the inverter chain in Fig. 14.37(c).
(a) Show that

$$
t_{P}=\tau_{\text {total }}=(n-1) x R C+\frac{1}{x^{n-1}} R C_{L}
$$

(b) Differentiate the expression for $t_{P}$ in (a) relative to $x$ and set the derivative to zero. Thus show that the first condition for optimality is

$$
x^{*}=\frac{C_{L}}{C}
$$

(c) Differentiate the expression for $t_{P}$ in (a) relative to $n$ and set the derivative to zero. Thus show that the second condition for optimality is

$$
x^{*}\left(\frac{C}{C_{L}}\right)=\ln x
$$

(d) Combine the expressions in (b) and (c) to show that the value of $x$ for minimum overall delay is

$$
x=e
$$

## Section 14.6: Power Dissipation

14.63 An IC inverter fabricated in a $0.18-\mu \mathrm{m}$ CMOS process is found to have a load capacitance of 10 fF . If the inverter is operated from a $1.8-\mathrm{V}$ power supply, find the energy needed to charge and discharge the load capacitance. If the IC chip has 2 million of these inverters operating at an average switching frequency of 1 GHz , what is the power dissipated in the chip? What is the average current drawn from the power supply?
14.64 Consider a logic inverter of the type shown in Fig. 14.18. Let $V_{D D}=1 \mathrm{~V}$, and let a $5-\mathrm{fF}$ capacitance be connected between the output node and ground. If the inverter is switched at the rate of 2 GHz , determine the dynamic power dissipation. What is the average current drawn from the dc power supply?
14.65 In a particular logic-circuit technology, operating with a $3.3-\mathrm{V}$ supply, the basic inverter draws (from the supply) a current of $60 \mu \mathrm{~A}$ in one state and $0 \mu \mathrm{~A}$ in the other. When the inverter is switched at the rate of 100 MHz , the average supply current becomes $150 \mu \mathrm{~A}$. Estimate the equivalent capacitance at the output node of the inverter.
14.66 A collection of logic gates for which the static power dissipation is zero, and the dynamic power dissipation is 10 mW is operating at 50 MHz with a $5-\mathrm{V}$ supply. By what fraction could the power dissipation be reduced if operation at 3.3 V were possible? If the frequency of operation is reduced by the same factor as the supply voltage (i.e., 3.3/5), what additional power can be saved?
14.67 A particular logic gate has $t_{P L H}$ and $t_{P H L}$ of 30 ns and 50 ns , respectively, and dissipates 1 mW with output low and 0.6 mW with output high. Calculate the corresponding delay-power product (under the assumption of a $50 \%$ duty-cycle signal and neglecting dynamic power dissipation).

D *14.68 We wish to investigate the design of the inverter shown in Fig. 14.17(a). In particular, we wish to determine the value for $R$. Selection of a suitable value for $R$ is determined by two considerations: propagation delay and power dissipation.
(a) Show that if $v_{t}$ changes instantaneously from high to low and assuming that the switch opens instantaneously, the output voltage obtained across a load capacitance $C$ will be

$$
v_{O}(t)=V_{O H}-\left(V_{O H}-V_{O L}\right) e^{-t / \tau_{1}}
$$

where $\tau_{1}=C R$. Hence show that the time required for $v_{O}(t)$ to reach the $50 \%$ point, $\frac{1}{2}\left(V_{O H}+V_{O L}\right)$, is

$$
t_{P L H}=0.69 C R
$$

(b) Following a steady state, if $v_{t}$ goes high and assuming that the switch closes immediately and has the equivalent circuit in Fig. 14.17(c), show that the output falls exponentially according to

$$
v_{O}(t)=V_{O L}+\left(V_{O H}-V_{O L}\right) e^{-t / \tau_{2}}
$$

where $\tau_{2}=C\left(R \| R_{s m}\right) \simeq C R_{s m}$ for $R_{s m} \ll R$. Hence show that the time for $v_{O}(t)$ to reach the $50 \%$ point is

$$
t_{P H L}=0.69 C R_{s m}
$$

(c) Use the results of (a) and (b) to obtain the inverter propagation delay, defined as the average of $t_{P L H}$ and $t_{P H L}$ as

$$
t_{P} \simeq 0.35 C R \quad \text { for } R_{s m} \ll R
$$

(d) Show that for an inverter that spends half the time in the logic-0 state and half the time in the logic-1 state, the average static power dissipation is

$$
P=\frac{1}{2} \frac{V_{D D}^{2}}{R}
$$

(e) Now that the trade-offs in selecting $R$ should be clear, show that, for $V_{D D}=5 \mathrm{~V}$ and $C=10 \mathrm{pF}$, to obtain a propagation delay no greater than 5 ns and a power dissipation no greater than $15 \mathrm{~mW}, R$ should be in a specific range. Find that range and select an appropriate value for $R$. Then determine the resulting values of $t_{P}$ and $P$.

D 14.69 A logic-circuit family with zero static power dissipation normally operates at $V_{D D}=2.5 \mathrm{~V}$. To reduce its dynamic power dissipation, operation at 1.8 V is considered. It is found, however, that the currents available to charge and discharge load capacitances also decrease. If current is (a) proportional to $V_{D D}$ or (b) proportional to $V_{D D}^{2}$, what reductions in maximum operating frequency do you expect in each case? What fractional change in delay-power product do you expect in each case?
14.70 In this problem we estimate the CMOS inverter power dissipation resulting from the current pulse that flows in $Q_{N}$ and $Q_{P}$ when the input pulse has finite rise and fall times. Refer to Fig. 14.39 and let $V_{i n}=-V_{i p}=0.5 \mathrm{~V}, V_{D D}=1.8 \mathrm{~V}$, and $k_{n}=k_{p}=450 \mu \mathrm{~A} / \mathrm{V}^{2}$. Let the input rising and falling edges be linear ramps with the 0 -to- $V_{D D}$ and $V_{D D}$-to-0 transitions taking

1 ns each. Find $I_{\text {peak }}$. To determine the energy drawn from the supply per transition, assume that the current pulse can be approximated by a triangle with a base corresponding to the time for the rising or falling edge to go from $V_{i}$ to $V_{D D}-V_{i}$, and the height equal to $I_{\text {peak }}$. Also, determine the power dissipation that results when the inverter is switched at 100 MHz .
# CHAPTER 15 

## Advanced Topics in Digital IntegratedCircuit Design

Introduction 1167
15.1 Implications of Technology Scaling: Issues in Deep-Submicron Design 1168
15.2 Digital IC Technologies, Logic-Circuit Families, and Design
Methodologies 1179
15.3 Pseudo-NMOS Logic Circuits 1183
15.4 Pass-Transistor Logic Circuits 1192
15.5 Dynamic MOS Logic Circuits 1208
15.6 Bipolar and BiCMOS Logic Circuits 1217

Summary 1226
Problems 1227
# IN THIS CHAPTER YOU WILL LEARN 

1. The implications of technology scaling (Moore's law) over more than 40 years and continuing, and some of the current challenges in the design of deep-submicron $(L<0.25 \mu \mathrm{~m})$ circuits.
2. How and why CMOS has become the dominant technology for digital IC design.
3. That by replacing the pull-up network (PUN) of a CMOS logic gate by a single PMOS transistor that is permanently on, considerable savings in transistor count and silicon area can be achieved in gates with high fan-in. The resulting circuits are known as pseudo-NMOS.
4. That a useful and conceptually simple form of MOS logic circuit, known as pass-transistor logic (PTL), utilizes MOS transistors as series switches in the signal path from input to output.
5. That a very effective switch for both analog and digital applications, known as transmission gate, is formed by connecting an NMOS and a PMOS transistor in parallel.
6. That eliminating the pull-up network and placing two complementary switches, operated by a clock signal, in series with the pull-down network of a CMOS gate results in an interesting and useful class of circuits known as dynamic logic.
7. How the BJT differential-pair configuration is used as a current switch to realize the fastest commercially available logic-circuit family: emitter-coupled logic (ECL).
8. How the MOSFET and the BJT are combined in BiCMOS circuits in ways that take advantage of the best attributes of each device.

## Introduction

In this chapter we study a number of advanced topics in digital logic-circuit design. We begin by taking a closer look at the implications of Moore's law. Specifically, over the past 45 years or so, the MOSFET dimensions have been reduced by a factor of 2 about every five years. This scaling has been accompanied by reductions in $V_{D D}$ and $V_{i}$. The opportunities provided and challenges posed by scaling are studied in Section 15.1. We then survey the field of digital IC technologies in order to place CMOS in proper perspective.

Standard CMOS logic, which we studied in Chapter 14, excels in almost every performance category: It is easy to design, has the maximum possible voltage swing, is
robust from a noise-immunity standpoint, dissipates no static power, and can be designed to provide equal high-to-low and low-to-high propagation delays. Its main disadvantage is the requirement of two transistors for each additional gate input, which for gates with high fan-in can make the chip area large and increase the total capacitance and, correspondingly, the propagation delay and the dynamic power dissipation. For this reason designers of digital integrated circuits have been searching for forms of CMOS logic circuits that can be used to supplement standard CMOS. This chapter presents three such forms that reduce the required number of transistors but incur other costs. These forms are not intended to replace standard CMOS, but are rather to be used in special applications for special purposes.

Pseudo-NMOS logic, studied in Section 15.3, replaces the pull-up network (PUN) in a CMOS logic gate by a single permanently "on" PMOS transistor. The reduction in transistor count and silicon area comes at the expense of static power dissipation. As well, the output low-level $V_{O L}$ becomes dependent on the transistors' $W / L$ ratios.

Pass-transistor logic (PTL), studied in Section 15.4, utilizes MOS transistors as switches in the series path from input to output. Though simple and attractive for special applications, PTL does not restore the signal level and thus requires the occasional use of standard CMOS inverters to avoid signal-level degradation, especially in long chains of switches.

The dynamic logic circuits studied in Section 15.5 dispense with the PUN and place two complementary switches in series with the PDN. The switches are operated by a clock, and the gate output is stored on the load capacitance. Here the reduction in transistor count is achieved at the expense of a more complex design that is less robust than static CMOS.

Although CMOS accounts for the vast majority of digital integrated circuits, there is a bipolar logic-circuit family that is still of some interest. This is emitter-coupled logic (ECL), which we study briefly in Section 15.6.1. Finally, in Section 15.6.2 we show how the MOSFET and the BJT can be combined in ways that take advantage of the best properties of each, resulting in what are known as BiCMOS circuits.

The sections of this chapter are almost independent modules, thus selected ones can be studied as they come up, and others may be deferred to a later time.

# 15.1 Implications of Technology Scaling: Issues in Deep-Submicron Design 

As mentioned in Chapter 5, and in a number of locations throughout the book, the minimum MOSFET channel length has been continually reduced over the past 50 years or so. In fact, a new CMOS fabrication technology has been introduced every 2 or 3 years, with the minimum allowable channel length reduced by about $30 \%$, that is, to 0.7 the value in the preceding generation. Thus, with every new technology generation, the device area has been reduced by a factor of $1 /(0.7 \times 0.7)$ or approximately 2 , allowing the fabrication of twice as many devices on a chip of the same area. This astounding phenomenon, predicted nearly 50 years ago by Gordon Moore, has become known as Moore's law. It is this ability to pack an exponentially increasing number of transistors on an IC chip that has resulted in the continuing reduction in the cost per logic function.

Figure 15.1 shows the exponential reduction in MOSFET channel length (by a factor of 2 every 5 years) over a 40 -year period, with the dots indicating some of the prominent technology generations, or nodes. Thus, we see the $10-\mu \mathrm{m}$ process of the early 1970s, the


Figure 15.1 The MOSFET channel length has been reduced by a factor of 2 about every 5 years. This phenomenon, known as Moore's law, is continuing.
submicron $(L<1 \mu \mathrm{~m})$ processes of the early 1990s, and the deep-submicron $(L<0.25 \mu \mathrm{~m})$ processes of the last decade, including the current $22-\mathrm{nm}$ process. A microprocessor chip fabricated in a $22-\mathrm{nm}$ CMOS process, clocked at 3.8 GHz and having 4.31 billion transistors, was announced in 2014. Deep-submicron (DSM) processes present the circuit designer with a host of new opportunities and challenges. It is our purpose in this section to briefly consider some of these.

# 15.1.1 Silicon Area 

We begin this section with a brief discussion of silicon area. In addition to minimizing power dissipation and propagation delay, an important objective in the design of digital VLSI circuits is the minimization of silicon area per logic gate. The smaller area requirement enables the fabrication of a larger number of gates per chip, which has economic and space advantages from a system-design standpoint. Area reduction occurs in three different ways: through advances in processing technology that enable the reduction of the minimum device size, through advances in circuit-design techniques, and through careful chip layout. In this book, our interest lies in circuit design, and we shall make frequent comments on the relationship between the design of a circuit and its silicon area. As a general rule, the simpler the circuit, the smaller the area required. As we have seen in Section 14.5, the circuit designer has to decide on device sizes. Choosing smaller devices has the obvious advantage of requiring smaller silicon area and at the same time reducing parasitic capacitances and thus increasing speed. Smaller devices, however, have lower current-driving capability, which tends to increase delay. Thus, as in all engineering design problems, there is a trade-off to be quantified and exercised in a manner that optimizes whatever aspect of the design is thought to be critical for the application at hand.

### 15.1.2 Scaling Implications

Table 15.1 provides a summary of the implications of scaling the device dimensions by a factor $1 / S$, where $S>1$. As well, we assume that $V_{D D}$ and $V_{i}$ are scaled by the same factor.
Table 15.1 Implications of Device and Voltage Scaling

|  | Parameter | Relationship | Scaling Factor |
| :--: | :--: | :--: | :--: |
| 1 | $W, L, t_{o s}$ |  | $1 / S$ |
| 2 | $V_{D D}, V_{i}$ |  | $1 / S$ |
| 3 | Area/Device | $W L$ | $1 / S^{2}$ |
| 4 | $C_{o s}$ | $\epsilon_{o s} / t_{o s}$ | S |
| 5 | $k_{u}^{\prime}, k_{p}^{\prime}$ | $\mu_{u} C_{o s}, \mu_{p} C_{o s}$ | S |
| 6 | $C_{\text {gate }}$ | $W L C_{o s}$ | $1 / S$ |
| 7 | $t_{P}$ (intrinsic) | $\alpha C / k^{\prime} V_{D D}$ | $1 / S$ |
| 8 | Energy/Switching cycle (intrinsic) | $C V_{D D}^{2}$ | $1 / S^{3}$ |
| 9 | $P_{\text {dyn }}$ | $f_{\max } C V_{D D}^{2}=\frac{C V_{D D}^{2}}{2 t_{P}}$ | $1 / S^{2}$ |
| 10 | Power density | $P_{\text {dyn }} /$ Device area | 1 |

Although the scaling of $V_{D D}$ has occurred for a number of technology nodes (e.g., from 5 V for the $0.5-\mu \mathrm{m}$ process down to 1.2 V for the $0.13-\mu \mathrm{m}$ process and 1 V for the $65-\mathrm{nm}$ process), $V_{i}$ has been reduced but not by the same factor. Thus the assumption in row 2 of Table 15.1 is not entirely correct. Nevertheless, our interest here is to gain a general appreciation for the effects of scaling.

Table 15.1 provides the relationships for the various transistor and inverter parameters in order to show how the resulting scale factors are obtained. We thus see that the device area scales by $1 / S^{2}$; the oxide capacitance $C_{o s}$, and the transconductance parameters $k_{u}^{\prime}$ and $k_{p}^{\prime}$ scale by $S$; and the MOSFET gate capacitance scales by $1 / S$. It is important to note that the component of the inverter propagation delay due to the transistor capacitances (i.e., excluding the wiring capacitance) scales by $1 / S$; this very useful result of scaling implies that the circuit can be operated at $S$ times the frequency; that is, the speed of operation increases by a factor $S$. Equally important, the dynamic power dissipation scales by $1 / S^{2}$. This, of course, is a major motivating factor behind the scaling of $V_{D D}$. Another motivating factor is the need to keep the electric fields in the MOSFETs within acceptable bounds.

Although the dynamic power dissipation is scaled by $1 / S^{2}$, the power per unit area remains unchanged. Nevertheless, for a number of reasons, as the size and complexity of digital IC chips continue to increase, so does their power dissipation. Indeed power dissipation has now become the number-one issue in IC design. The problem is further exacerbated by the static power dissipation, arising from both subthreshold conduction and diode leakage currents, that plagues deep-submicron CMOS devices. We will discuss this issue shortly.
# EXERCISES 

15.1 By what factor does the power-delay product $P D P$ change if an inverter is fabricated in a $0.13-\mu \mathrm{m}$ technology rather than a $0.25-\mu \mathrm{m}$ technology? Assume $S \simeq 2$.
Ans. $P D P$ decreases by a factor of 8 .
15.2 If $V_{D D}$ and $V_{i}$ are kept constant, which entries in Table 15.1 change and to what value? Ans. $t_{P}$ now scales by $1 / S^{3}$; the energy/switching cycle now scales by $1 / S$ only; $P_{\text {dyn }}$ now scales by $S$; and the power density now scales by $S^{7}$ (a major problem).

### 15.1.3 Velocity Saturation

The short channels of MOSFETs fabricated in deep-submicron processes give rise to physical phenomena not present in long-channel devices, and thus to changes in the MOSFET $i-v$ characteristics. The most important of these short-channel effects is velocity saturation. Here we refer to the drift velocity of electrons in the channel of an NMOS transistor (holes in PMOS) under the influence of the longitudinal electric field established by $v_{D S}$. In our derivation of the MOSFET $i-v$ characteristics in Section 5.1, we assumed that the velocity $v_{n}$ of the electrons in an $n$-channel device is given by

$$
v_{n}=\mu_{n} E
$$

where $E$ is the electric field given by

$$
E=\frac{v_{D S}}{L}
$$

The relationship in Eq. (15.1) applies as long as $E$ is below a critical value $E_{c r}$ that falls in the range $1 \mathrm{~V} / \mu \mathrm{m}$ to $5 \mathrm{~V} / \mu \mathrm{m}$. For $E>E_{c r}$, the drift velocity saturates at a value $v_{\text {sat }}$ of approximately $10^{7} \mathrm{~cm} / \mathrm{s}$. Figure 15.2 shows a sketch of $v_{n}$ versus $E$. Although the change from


Figure 15.2 The velocity of electrons in the channel of an NMOS transistor reaches a constant value $v_{\text {sat }} \simeq 10^{7}$ $\mathrm{cm} / \mathrm{s}$ when the electric field $E$ reaches a critical value $E_{c r}$. A similar situation occurs for $p$-channel devices.a linear to a constant $v$ is gradual, we shall assume for simplicity that $v$ saturates abruptly at $E=E_{c r}$.

The electric field $E$ in a short-channel MOSFET can easily exceed $E_{c r}$ even though $V_{D D}$ is low. If we denote the value of $v_{D S}$ at which velocity saturation occurs by $V_{D S \text { sat }}$, then from Eq. (15.2),

$$
E_{c r}=\frac{V_{D S \text { sat }}}{L}
$$

which when substituted in Eq. (15.1) provides

$$
v_{\text {sat }}=\mu_{n}\left(\frac{V_{D S \text { sat }}}{L}\right)
$$

or alternatively,

$$
V_{D S \text { sat }}=\left(\frac{L}{\mu_{n}}\right) v_{\text {sat }}
$$

Thus, $V_{D S \text { sat }}$ is a device parameter.

# EXERCISE 

15.3 Find $V_{D S \text { sat }}$ for an NMOS transistor fabricated in a $0.25-\mu \mathrm{m}$ CMOS process with $\mu_{n}=400 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$. Let $L=0.25 \mu \mathrm{~m}$ and assume $v_{\text {sat }}=10^{7} \mathrm{~cm} / \mathrm{s}$.
Ans. 0.63 V

The $i_{D}-v_{D S}$ Characteristics The $i_{D}-v_{D S}$ equations of the MOSFET can be modified to include velocity saturation as follows. Consider a long-channel NMOS transistor operating in the triode region with $v_{G S}$ set to a constant value $V_{G S}$. The drain current will be

$$
i_{D}=\mu_{n} C_{o s}\left(\frac{W}{L}\right) v_{D S}\left[\left(V_{G S}-V_{t}\right)-\frac{1}{2} v_{D S}\right]
$$

where we have for the time being neglected channel-length modulation. We know from our study in Section 5.1 that $i_{D}$ will saturate at

$$
v_{D S}=V_{O V}=V_{G S}-V_{t}
$$

and the saturation current will be

$$
i_{D}=\frac{1}{2} \mu_{n} C_{o s}\left(\frac{W}{L}\right)\left(V_{G S}-V_{t}\right)^{2}
$$


Figure 15.3 Velocity saturation causes the $i_{D}-v_{D S}$ characteristic to saturate at $V_{D S s a t}$. This early saturation results in a current $I_{D \text { sat }}$ that is lower than the value for a long-channel device.

This will also be the case in a short-channel device as long as the value of $v_{D S}$ in Eq. (15.7) is lower than $V_{D S s a t}$. That is, as long as

$$
V_{O V}<V_{D S s a t}
$$

the current $i_{D}$ will be given by Eqs. (15.6) and (15.8). If, on the other hand,

$$
V_{O V}>V_{D S s a t}
$$

then velocity saturation kicks in at $v_{D S}=V_{D S s a t}$ and $i_{D}$ saturates at a value $I_{D \text { sat }}$, as shown in Fig. 15.3. The value of $I_{D \text { sat }}$ can be obtained by substituting $v_{D S}=V_{D S s a t}$ in Eq. (15.6),

$$
I_{D \text { sat }}=\mu_{\alpha} C_{o x}\left(\frac{W}{L}\right) V_{D S s a t}\left(V_{G S}-V_{i}-\frac{1}{2} V_{D S s a t}\right)
$$

This expression can be simplified by utilizing Eq. (15.5) to obtain

$$
I_{D \text { sat }}=W C_{o x} v_{\text {sat }}\left(V_{G S}-V_{i}-\frac{1}{2} V_{D S s a t}\right)
$$

Replacing $V_{G S}$ in Eq. (15.9) with $v_{G S}$, and incorporating the channel-length modulation factor $\left(1+\lambda v_{D S}\right)$, we obtain a general expression for the drain current of an NMOS transistor operating in velocity saturation,

$$
i_{D}=\mu_{\alpha} C_{o x}\left(\frac{W}{L}\right) V_{D S s a t}\left(v_{G S}-V_{i}-\frac{1}{2} V_{D S s a t}\right)\left(1+\lambda v_{D S}\right)
$$


Figure 15.4 The $i_{D}-v_{D S}$ characteristics of a short-channel MOSFET. Note the three different regions of operation: triode, saturation, and velocity saturation.


Figure 15.5 The $i_{D}-v_{G S}$ characteristic of a short-channel NMOS transistor operating at $v_{D S}>V_{D S s a t}$. Observe the quadratic and the linear portions of the characteristic. Also note that in the absence of velocity saturation, the quadratic curve would continue as shown with the broken line.
which applies for

$$
v_{G S}-V_{t} \geq V_{D S \text { sat }} \quad \text { and } \quad v_{D S} \geq V_{D S \text { sat }}
$$

Figure 15.4 shows a set of $i_{D}-v_{D S}$ characteristic curves and clearly delineates the three regions of operation: triode, saturation, and velocity saturation.

Equation (15.11) indicates that in the velocity-saturation region, $i_{D}$ is linearly related to $v_{G S}$. This is a major change from the quadratic relationship that characterizes operation in the saturation region. Figure 15.5 makes this point clearer by presenting a graph for $i_{D}$ versus $v_{G S}$ of a short-channel device operating at $v_{D S}>V_{D S s a t}$. Observe that for $0<v_{G S}-V_{t} \leq V_{D S s a t}$, the MOSFET operates in the saturation region and $i_{D}$ is related to $v_{G S}$ by the familiar quadratic equation (Eq. 15.8). For $v_{G S}-V_{t} \geq V_{D S s a t}$, the transistor enters the velocity-saturation region and $i_{D}$ varies linearly with $v_{G S}$ (Eq. 15.11).
Short-channel PMOS transistors undergo velocity saturation at the same value of $v_{\text {sat }}$ (approximately $10^{7} \mathrm{~cm} / \mathrm{s}$ ), but the effects on the device characteristics are less pronounced than in the NMOS case. This is due to the lower values of $\mu_{p}$ and the correspondingly higher values of $E_{c r}$ and $V_{D S \text { sat }}$.

# Example 15.1 

Consider MOS transistors fabricated in a $0.25-\mu \mathrm{m}$ CMOS process for which $V_{D D}=2.5 \mathrm{~V}, V_{m}=-V_{t p}=$ $0.5 \mathrm{~V}, \mu_{n} C_{o s}=115 \mu \mathrm{~A} / \mathrm{V}^{2}, \mu_{p} C_{o s}=30 \mu \mathrm{~A} / \mathrm{V}^{2}, \lambda_{n}=0.06 \mathrm{~V}^{-1}$, and $\left|\lambda_{p}\right|=0.1 \mathrm{~V}^{-1}$. Let $L=0.25 \mu \mathrm{~m}$ and $(W / L)_{n}=(W / L)_{p}=1.5$. Measurements indicate that for the NMOS transistor, $V_{D S \text { sat }}=0.63 \mathrm{~V}$, and for the PMOS device, $\left|V_{D S s a t}\right|=1 \mathrm{~V}$. Calculate the drain current obtained in each of the NMOS and PMOS transistors for $\left|V_{G S}\right|=\left|V_{D S}\right|=V_{D D}$. Compare with the values that would have been obtained in the absence of velocity saturation. Also give the range of $v_{D S}$ for which $i_{D}$ is saturated, with and without velocity saturation.

## Solution

For the NMOS transistor, $V_{G S}=2.5 \mathrm{~V}$ results in $V_{G S}-V_{m}=2.5-0.5=2 \mathrm{~V}$, which is greater than $V_{D S \text { sat }}$. Also, $V_{D S}=2.5 \mathrm{~V}$ is greater than $V_{D S s a t}$; thus both conditions in Eq. (15.12) are satisfied, and the NMOS transistor will be operating in the velocity-saturation region, and thus $i_{D}$ is given by Eq. (15.11):

$$
i_{D}=115 \times 10^{-6} \times 1.5 \times 0.63 \times\left(2.5-0.5-\frac{1}{2} \times 0.63\right) \times(1+0.06 \times 2.5)=210.6 \mu \mathrm{~A}
$$

If velocity saturation were absent, the current would be

$$
\begin{aligned}
i_{D} & =\frac{1}{2}\left(\mu_{n} C_{o s}\right)\left(\frac{W}{L}\right)_{n}\left(v_{G S}-V_{m}\right)^{2}\left(1+\lambda v_{D S}\right) \\
& =\frac{1}{2} \times 115 \times 10^{-6} \times 1.5 \times(2.5-0.5)^{2} \times(1+0.06 \times 2.5) \\
& =396.8 \mu \mathrm{~A}
\end{aligned}
$$

Thus, velocity saturation reduces the current level by nearly $50 \%$ ! The saturation current, however, is obtained over a larger range of $v_{D S}$; specifically, for $v_{D S}=0.63 \mathrm{~V}$ to 2.5 V . (Of course, the current does not remain constant over this range because of channel-length modulation.) In the absence of velocity saturation, the current saturates at $V_{O V}=V_{G S}-V_{t}=2 \mathrm{~V}$, and thus the saturation current is obtained over the range $v_{D S}=2 \mathrm{~V}$ to 2.5 V .

For the PMOS transistor, we see that since $\left|V_{G S}\right|-\left|V_{t}\right|=2 \mathrm{~V}$ and $\left|V_{D S}\right|=2.5 \mathrm{~V}$ are both larger than $\left|V_{D S \text { sat }}\right|=1 \mathrm{~V}$ the device will be operating in velocity saturation, and $i_{D}$ can be obtained by adapting Eq. (15.11) as follows:

$$
\begin{aligned}
i_{D} & =\left(\mu_{p} C_{o s}\right)\left(\frac{W}{L}\right)_{p}\left|V_{D S s a t}\right|\left(\left|V_{G S}\right|-\left|V_{t p}\right|-\frac{1}{2}\left|V_{D S s a t}\right|\right)\left(1+\left|\lambda_{p}\right|\left|V_{D S}\right|\right) \\
& =30 \times 10^{-6} \times 1.5 \times 1 \times\left(2.5-0.5-\frac{1}{2} \times 1\right)(1+0.1 \times 2.5) \\
& =84.4 \mu \mathrm{~A}
\end{aligned}
$$
# Example 15.1 continued 

Without velocity saturation, we have

$$
\begin{aligned}
i_{D} & =\frac{1}{2}\left(\mu_{p} C_{o s}\right)\left(\frac{W}{L}\right)_{p}\left(\left|V_{D S}\right|-\left|V_{t p}\right|\right)^{2}\left(1+\left|\lambda_{p}\right|\left|V_{D S}\right|\right) \\
& =\frac{1}{2} \times 30 \times 10^{-6} \times 1.5 \times(2.5-0.5)^{2}(1+0.1 \times 2.5) \\
& =112.5 \mu \mathrm{~A}
\end{aligned}
$$

Thus velocity saturation reduces the current by $25 \%$ (which is less than in the case of the NMOS transistor), and the saturated current is obtained over the range $\left|V_{D S}\right|=1 \mathrm{~V}$ to 2.5 V . In the absence of velocity saturation, the saturated $i_{D}$ would have been obtained for $\left|V_{D S}\right|=2 \mathrm{~V}$ to 2.5 V .

## EXERCISE

15.4 Repeat the problem in Example 15.1 for transistors fabricated in a $0.13-\mu \mathrm{m}$ CMOS process for which $V_{D D}=1.2 \mathrm{~V}, V_{t n}=-V_{t p}=0.4 \mathrm{~V}, \mu_{n} C_{o s}=430 \mu \mathrm{~A} / \mathrm{V}^{2}, \mu_{p} C_{o s}=110 \mu \mathrm{~A} / \mathrm{V}^{2}, \lambda_{n}=\left|\lambda_{p}\right|=0.1 \mathrm{~V}^{-1}$. Let $L=0.13 \mu \mathrm{~m},(W / L)_{n}=(W / L)_{p}=1.5, V_{D S \text { sat }}(\mathrm{NMOS})=0.34 \mathrm{~V}$, and $V_{D S \text { sat }}(\mathrm{PMOS})=0.6 \mathrm{~V}$. Ans. NMOS: $I_{D}=154.7 \mu \mathrm{~A}$, compared to $231.2 \mu \mathrm{~A}$ without velocity saturation; saturation is obtained over the range $v_{D S}=0.34 \mathrm{~V}$ to 1.2 V , compared to $v_{D S}=0.8 \mathrm{~V}$ to 1.2 V in the absence of velocity saturation. PMOS: $I_{D}=55.4 \mu \mathrm{~A}$ compared to $59.1 \mu \mathrm{~A}$, and $\left|v_{D S}\right|=0.6 \mathrm{~V}$ to 1.2 V compared to 0.8 V to 1.2 V .

Effect on the Inverter Characteristics The VTC of the CMOS inverter can be derived using the modified $i_{D}-v_{D S}$ characteristics of the MOSFETs. The results, however, indicate relatively small changes from the VTC derived in Section 14.3 using the long-channel equations (see Rabaey et al., 2003, and Hodges et al., 2004), and we shall not pursue this subject here. The dynamic characteristics of the inverter, however, are significantly impacted by velocity saturation. This is because the current available to charge and discharge the equivalent load capacitance $C$ is substantially reduced.

A Remark on the MOSFET Model The model derived above for short-channel MOSFETs is an approximate one, intended to enable the circuit designer to perform hand analysis to gain insight into circuit operation. Also, the model parameter values are usually obtained from measured data by means of a numerical curve-fitting process. As a result, the model applies only over a restricted range of terminal voltages.

Modeling short-channel MOSFETs is an advanced topic that is beyond the scope of this book. Suffice it to say that sophisticated models have been developed and are utilized by circuit simulation programs such as SPICE (see Appendix B). Circuit simulation is an essential step
in the design of integrated circuits. However, it is not a substitute for initial hand analysis and design.

# 15.1.4 Subthreshold Conduction 

In our study of the NMOS transistor in Section 5.1, we assumed that current conduction between drain and source occurs only when $v_{G S}$ exceeds $V_{t}$. That is, we assumed that for $v_{G S}<V_{t}$ no current flows between drain and source. This, however, turns out not to be the case, especially for deep-submicron devices. Specifically, for $v_{G S}<V_{t}$ a small current $i_{D}$ flows. To be able to see this subthreshold conduction, we have redrawn the $i_{D}-v_{G S}$ graph of Fig. 15.5, utilizing a logarithmic scale for $i_{D}$, as shown in Fig. 15.6. Observe that at low values of $v_{G S}$, the relationship between $\log i_{D}$ and $v_{G S}$ is linear, indicating that $i_{D}$ varies exponentially with $v_{G S}$,

$$
i_{D}=I_{S} e^{v_{G S} / n V_{T}}
$$

where $I_{S}$ is a constant, $V_{T}=k T / q$ is the thermal voltage $\simeq 25 \mathrm{mV}$ at room temperature, and $n$ is a constant whose value falls in the range 1 to 2 , depending on the material and structure of the device. ${ }^{1}$

Subthreshold conduction has been put to good use in the design of very-low-power circuits such as those needed for electronic watches. Generally speaking, however, subthreshold conduction is a problem in digital IC design. This is so for two reasons.

1. The nonzero current that flows for $v_{G S}=0$ (see Fig. 15.6) causes the CMOS inverter to dissipate static power. To keep this off current as low as possible, $V_{t}$ of the MOSFET is kept relatively high. This indeed is the reason why $V_{t}$ has not been scaled by the same factor as that used for the channel length. Although the off current is low (10 pA to 100 pA ) and the power dissipation per inverter is small, the problem becomes serious in chips with a billion transistors!


Figure 15.6 The $i_{D}-v_{G S}$ characteristic of a short-channel MOSFET. To show the details of subthreshold conduction a logarithmic scale is needed for $i_{D}$.

[^0]
[^0]:    ${ }^{1}$ This relationship is reminiscent of the $i_{c}-v_{B E}$ relationship of a BJT (Chapter 6). This is no coincidence, for the subthreshold conduction in a MOSFET is due to the lateral bipolar transistor formed by the source and drain diffusions with the substrate acting as the base region (see Fig. 5.1).
2. The nonzero current of a normally off transistor can cause the discharge of capacitors in dynamic MOS circuits. As we shall see in Section 15.5 and in the next chapter, dynamic logic and memory circuits rely on charge storage on capacitors for their proper operation. Thus, subthreshold conduction can disrupt the operation of such circuits.

# EXERCISE 

15.5 (a) Refer to Fig. 15.6 and to Eq. (15.13). Show that the inverse of the slope of the straight line representing subthreshold conduction is given by $2.3 n V_{T} \mathrm{~V}$ per decade of current change.
(b) If measurements indicate $n=1.22$ and $i_{D}=100 \mathrm{nA}$ at $v_{G S}=0.21 \mathrm{~V}$, find $i_{D}$ at $v_{G S}=0$.
(c) For a chip having 500 million transistors, find the current drawn from the $1.2-\mathrm{V}$ supply $V_{D D}$ as a result of subthreshold conduction. Hence estimate the resulting power dissipation.
Ans. (b) $0.1 \mathrm{nA} ;$ (c) $50 \mathrm{~mA}, 60 \mathrm{~mW}$

### 15.1.5 Temperature, Voltage, and Process Variations

As we have seen in earlier chapters, temperature variations affect the $i-v$ characteristics of a transistor. Besides affecting the thermal voltage $V_{T}$ in subthreshold conduction, temperature variations impact the transistor threshold voltage $V_{t}$ and the mobility $\mu$. These effects, difficult to model in hand calculations, can have a significant impact on circuit performance, especially when a wide range of temperature environments is expected (we assume you would like your cell phone to work at the beach on a warm day, but also when your car breaks down on the way to a ski resort). Circuit simulators are usually equipped to model temperature effects, and designers should run their simulations at all extreme and expected temperatures.

Supply voltages also vary (e.g., to account for lower battery voltages during extended use), and it is common to require that circuits operate correctly for a range extending to at least $V_{D D} \pm 10 \%$. Again, this condition can easily be simulated.

Finally, an increasingly important issue in CMOS design is that of process variations. Variations in threshold voltage, both at a small scale (transistor-to-transistor), medium scale (die-to-die), or large scale (wafer-to-wafer) should be expected.

### 15.1.6 Wiring: The Interconnect

The logic gates on a digital IC chip are connected together by metal wires ${ }^{2}$ (see Appendix A). As well, the power-supply $V_{D D}$ and ground are distributed throughout the chip by metal wires. Technology scaling into the deep-submicron range has caused these wires to behave not simply as wires! Specifically, the narrow wires typical of deep-submicron technologies exhibit nonzero resistance. The result is an $I R$ drop on the $V_{D D}$ line resulting in somewhat

[^0]
[^0]:    ${ }^{2}$ These are strips of metal deposited on an insulating surface on top of the chip. In modern digital ICs, as many as eight layers of such wiring are utilized.


Figure 15.7 The power-supply line in a deep-submicron IC has nonzero resistance. The $I R$ drops along the $V_{D D}$ line cause the voltages delivered to various circuits to differ.


Figure 15.8 The interconnect (wire) between two circuit blocks, A and B, on an IC chip has finite resistance and a capacitance to ground.
different voltages being delivered to different parts of the chip, as shown in Fig. 15.7. This can have deleterious effects on the operation of the overall circuit.

Since chips fabricated in deep-submicron technologies can have hundreds of millions of gates, the wire connection between gates can be long. The resulting narrow and long interconnect lines have not only nonzero resistance but also capacitance to ground, as shown in Fig. 15.8. The resistance and capacitance of an interconnect line can cause a propagation delay approaching that of the logic gate itself. As well, the capacitance between adjacent wires can cause the signals on one wire to be coupled to the other, which can cause erroneous operation of logic circuits.

In short, the circuit designer of modern deep-submicron digital ICs has to concern herself not only with the logic-circuit design but also with the wiring or interconnect issues. Indeed, advanced textbooks on digital IC design devote entire chapters to this topic (see Rabaey et al., 2003, and Hodges et al., 2004). Our intent here is simply to point out that interconnect has become an important issue in digital IC design.

# 15.2 Digital IC Technologies, Logic-Circuit Families, and Design Methodologies 

In our study of digital circuits, we have thus far concentrated on CMOS. This is reasonable in view of its dominance. Nevertheless, we will now take a broader view and survey other available digital circuit technologies. Not only will this help place CMOS in its proper context, it will also motivate the study, in the remainder of this chapter, of a number of other useful logic-circuit types. As well, we will briefly consider the methods digital IC designers employ to produce complex chips containing billions of transistors.
# 15.2.1 Digital IC Technologies and Logic-Circuit Families 

The chart in Figure 15.9 shows the major IC technologies and logic-circuit families that are currently in use. The concept of a logic-circuit family perhaps needs a few words of explanation. The basic element of a logic-circuit family is the inverter. A family would include a variety of logic-circuit types made with the same technology, having a similar circuit structure, and exhibiting the same basic features. Each logic-circuit family offers a unique set of advantages and disadvantages. In the conventional style of designing systems, one selects an appropriate logic family (e.g., TTL, CMOS, or ECL) and attempts to implement as much of the system as possible using circuit modules (packages) that belong to this family. In this way, interconnection of the various packages is relatively straightforward. If, on the other hand, packages from more than one family are used, one has to design suitable interface circuits. The selection of a logic family is based on such considerations as logic flexibility, speed of operation, availability of complex functions, noise immunity, operating-temperature range, power dissipation, and cost. In the following, we make some brief remarks on each of the four technologies listed in the chart of Fig. 15.9.

CMOS Although shown as one of four possible technologies, this is not an indication of digital IC market share: CMOS technology is, by a very large margin, the most dominant of all the IC technologies available for digital circuit design. Although early microprocessors were made using NMOS logic (based on the inverter circuit in Fig. P14.28), CMOS has completely replaced NMOS. There are a number of reasons for this development, the most important of which is the much lower power dissipation of CMOS circuits. CMOS has also replaced bipolar as the technology of choice in digital system design and has made possible levels of integration (or circuit-packing densities) and a range of applications, neither of which would have been possible with bipolar technology. Furthermore, CMOS continues to advance, whereas there appear to be few innovations at the present time in bipolar digital circuits. Some of the reasons for CMOS displacing bipolar technology in digital applications are as follows.

1. CMOS logic circuits dissipate much less power than bipolar logic circuits and thus one can pack more CMOS circuits on a chip than is possible with bipolar circuits.
2. The high input impedance of the MOS transistor allows the designer to use charge storage as a means for the temporary storage of information in both logic and memory circuits. This technique cannot be used in bipolar circuits.


Figure 15.9 Digital IC technologies and logic-circuit families.
3. The feature size (i.e., minimum channel length) of the MOS transistor has decreased dramatically over the years, with some recently reported designs utilizing channel lengths as short as 22 nm . This permits very tight circuit packing and, correspondingly, very high levels of integration. A microprocessor chip reported in 2014 had 4.31 billion transistors.

Of the various forms of CMOS, complementary CMOS circuits, studied in Chapter 14, are the most widely used. They are available both as small-scale-integrated (SSI) circuit packages (containing 1-10 logic gates) and medium-scale-integrated (MSI) circuit packages (10-100 gates per chip) for assembling digital systems on printed-circuit boards. More significantly, complementary CMOS is used in very-large-scale-integrated (VLSI) logic (with millions of gates per chip) and memory-circuit design. In some applications, complementary CMOS is supplemented by one (or both) of two other MOS logic-circuit forms. These are pseudo-NMOS, so-named because of the similarity of its structure to NMOS logic, and pass-transistor logic, both of which will be studied in this chapter.

A fourth type of CMOS logic circuit utilizes dynamic techniques to obtain faster circuit operation, while keeping the power dissipation very low. Dynamic CMOS logic, which we shall study in Section 15.5, represents an area of growing importance. Lastly, CMOS technology is used in the design of memory chips, as will be detailed in Chapter 16.

Bipolar Two logic-circuit families based on the bipolar junction transistor are in some use at present: TTL and ECL. Transistor-transistor logic (TTL or $\mathrm{T}^{2} \mathrm{~L}$ ) was for many years the most widely used logic-circuit family. Its decline was precipitated by the advent of the VLSI era. TTL manufacturers, however, fought back with the introduction of low-power and high-speed versions. In these relatively newer versions, the higher speeds of operation are made possible by preventing the BJT from saturating and thus avoiding the slow turnoff process of a saturated bipolar transistor. These nonsaturating versions of TTL utilize the Schottky diode discussed in Section 4.7.1 and are called Schottky TTL or variations of this name. Despite all these efforts, TTL is no longer a significant logic-circuit family and will not be studied in this book. However, the interested reader can find significant amounts of material on TTL on the book's website.

The other bipolar logic-circuit family in present use is emitter-coupled logic (ECL). It is based on the current-switch implementation of the inverter shown in Fig. 14.19. The basic element of ECL is the differential BJT pair studied in Chapter 9. Because ECL is basically a current-steering logic, and, correspondingly, also called current-mode logic (CML), in which saturation is avoided, very high speeds of operation are possible. Indeed, of all the commercially available logic-circuit families, ECL is the fastest. ECL is also used in VLSI circuit design when very high operating speeds are required and the designer is willing to accept higher power dissipation and increased silicon area. As such, ECL is considered an important specialty technology and will be discussed, albeit very briefly, in Section 15.6. Again, significant amounts of material on ECL can be found on the book's website.

BiCMOS BiCMOS combines the high operating speeds possible with BJTs (because of their inherently higher transconductance) with the low power dissipation and other excellent characteristics of CMOS. Like CMOS, BiCMOS allows for the implementation of both analog and digital circuits on the same chip. At present, BiCMOS is used to great advantage in special applications, where its high performance as a high-speed capacitive-current driver justifies the

Figure 2.25 The Miller integrator with a large resistance $R_{F}$ connected in parallel with $C$ in order to provide negative feedback and hence finite gain at dc.
as opposed to the ideal function of $-1 / s C R$. The lower the value we select for $R_{F}$, the higher the corner frequency $\left(1 / C R_{F}\right)$ will be and the more nonideal the integrator becomes. Thus selecting a value for $R_{F}$ presents the designer with a trade-off between dc performance and signal performance. The effect of $R_{F}$ on integrator performance is investigated further in Example 2.5.

# Example 2.5 

Find the output produced by a Miller integrator in response to an input pulse of 1-V height and 1-ms width [Fig. 2.26(a)]. Let $R=10 \mathrm{k} \Omega$ and $C=10 \mathrm{nF}$. If the integrator capacitor is shunted by a $1-\mathrm{M} \Omega$ resistor, how will the response be modified? The op amp is specified to saturate at $\pm 13 \mathrm{~V}$.

## Solution

In response to a 1-V, 1-ms input pulse, the integrator output will be

$$
v_{o}(t)=-\frac{1}{C R} \int_{0}^{t} 1 d t, \quad 0 \leq t \leq 1 \mathrm{~ms}
$$

where we have assumed that the initial voltage on the integrator capacitor is 0 . For $C=10 \mathrm{nF}$ and $R=10 \mathrm{k} \Omega$, $C R=0.1 \mathrm{~ms}$, and

$$
v_{o}(t)=-10 t, \quad 0 \leq t \leq 1 \mathrm{~ms}
$$

which is the linear ramp shown in Fig. 2.26(b). It reaches a magnitude of -10 V at $t=1 \mathrm{~ms}$ and remains constant thereafter.

That the output is a linear ramp should also be obvious from the fact that the 1-V input pulse produces a constant current through the capacitor of $1 \mathrm{~V} / 10 \mathrm{k} \Omega=0.1 \mathrm{~mA}$. This constant current $I=0.1 \mathrm{~mA}$ supplies the capacitor with a charge $I t$, and thus the capacitor voltage changes linearly as $(I t / C)$, resulting in $v_{o}=-(I / C) t$. It is worth remembering that charging a capacitor with a constant current produces a linear voltage across it.


Figure 2.26 Waveforms for Example 2.5: (a) Input pulse. (b) Output linear ramp of ideal integrator with time constant of 0.1 ms . (c) Output exponential ramp with resistor $R_{F}$ connected across integrator capacitor.

Next consider the situation with resistor $R_{F}=1 \mathrm{M} \Omega$ connected across $C$. As before, the $1-\mathrm{V}$ pulse will provide a constant current $I=0.1 \mathrm{~mA}$. Now, however, this current is supplied to an STC network composed of $R_{F}$ in parallel with $C$. Thus, the output will be an exponential heading toward -100 V with
# Example 2.5 continued 

a time constant of $C R_{F}=10 \times 10^{-9} \times 1 \times 10^{6}=10 \mathrm{~ms}$,

$$
v_{O}(t)=-100\left(1-e^{-t / 10}\right), \quad 0 \leq t \leq 1 \mathrm{~ms}
$$

Of course, the exponential will be interrupted at the end of the pulse, that is, at $t=1 \mathrm{~ms}$, and the output will reach the value

$$
v_{O}(1 \mathrm{~ms})=-100\left(1-e^{-1 / 10}\right)=-9.5 \mathrm{~V}
$$

The output waveform is shown in Fig. 2.26(c), from which we see that including $R_{F}$ causes the ramp to be slightly rounded such that the output reaches only $-9.5 \mathrm{~V}, 0.5 \mathrm{~V}$ short of the ideal value of -10 V . Furthermore, for $t>1 \mathrm{~ms}$, the capacitor discharges through $R_{F}$ with the relatively long time constant of 10 ms . Finally, we note that op-amp saturation, specified to occur at $\pm 13 \mathrm{~V}$, has no effect on the operation of this circuit.

The preceding example hints at an important application of integrators, namely, their use in providing triangular waveforms in response to square-wave inputs. This application is explored in Exercise 2.18. Integrators have many other applications, including their use in the design of filters (Chapter 17).

### 2.5.3 The Op-Amp Differentiator

Interchanging the location of the capacitor and the resistor of the integrator circuit results in the circuit in Fig. 2.27(a), which performs the mathematical function of differentiation. To see how this comes about, let the input be the time-varying function $v_{I}(t)$, and note that the virtual ground at the inverting input terminal of the op amp causes $v_{I}(t)$ to appear in effect across the capacitor $C$. Thus the current through $C$ will be $C\left(d v_{I} / d t\right)$, and this current flows through the feedback resistor $R$ providing at the op-amp output a voltage $v_{O}(t)$,

$$
v_{O}(t)=-C R \frac{d v_{I}(t)}{d t}
$$

The frequency-domain transfer function of the differentiator circuit can be found by substituting in Eq. (2.24), $Z_{1}(s)=1 / s C$ and $Z_{2}(s)=R$ to obtain

$$
\frac{V_{o}(s)}{V_{i}(s)}=-s C R
$$

which for physical frequencies $s=j \omega$ yields

$$
\frac{V_{o}(j \omega)}{V_{i}(j \omega)}=-j \omega C R
$$

Thus the transfer function has magnitude

$$
\left|\frac{V_{o}}{V_{i}}\right|=\omega C R
$$
and phase

$$
\phi=-90^{\circ}
$$

The Bode plot of the magnitude response can be found from Eq. (2.34) by noting that for an octave increase in $\omega$, the magnitude doubles (increases by 6 dB ). Thus the plot is simply a straight line of slope +6 dB/octave (or, equivalently, +20 dB /decade) intersecting the $0-\mathrm{dB}$ line (where $\left|V_{o} / V_{i}\right|=1$ ) at $\omega=1 / C R$, where $C R$ is the differentiator time constant [see Fig. 2.27(b)].

The frequency response of the differentiator can be thought of as the response of an STC high-pass filter with a corner frequency at infinity (refer to Fig. 1.24). Finally, we should note that the very nature of a differentiator circuit causes it to be a "noise magnifier." This is due to the spike introduced at the output every time there is a sharp change in $v_{I}(t)$; such a change could be interference coupled electromagnetically ("picked up") from adjacent signal sources. For this reason and because they suffer from stability problems (Chapter 11), differentiator circuits are generally avoided in practice. When the circuit of Fig. 2.27(a) is used, it is usually necessary to connect a small-valued resistor in series with the capacitor. This modification, unfortunately, turns the circuit into a nonideal differentiator.

(a)

(b)

Figure 2.27 (a) A differentiator. (b) Frequency response of a differentiator with a time constant $C R$.
# EXERCISES 

2.18 Consider a symmetrical square wave of $20-\mathrm{V}$ peak-to-peak, 0 average, and 2-ms period applied to a Miller integrator. Find the value of the time constant $C R$ such that the triangular waveform at the output has a $20-\mathrm{V}$ peak-to-peak amplitude.
Ans. 0.5 ms
D2.19 Use an ideal op amp to design an inverting integrator with an input resistance of $10 \mathrm{k} \Omega$ and an integration time constant of $10^{-3} \mathrm{~s}$. What is the gain magnitude and phase angle of this circuit at 10 $\mathrm{rad} / \mathrm{s}$ and at $1 \mathrm{rad} / \mathrm{s}$ ? What is the frequency at which the gain magnitude is unity?
Ans. $R=10 \mathrm{k} \Omega, C=0.1 \mu \mathrm{~F}$; at $\omega=10 \mathrm{rad} / \mathrm{s}:\left|V_{o} / V_{i}\right|=100 \mathrm{~V} / \mathrm{V}$ and $\phi=+90^{\circ}$; at $\omega=1 \mathrm{rad} / \mathrm{s}$ : $\left|V_{o} / V_{i}\right|=1000 \mathrm{~V} / \mathrm{V}$ and $\phi=+90^{\circ} ; 1000 \mathrm{rad} / \mathrm{s}$
D2.20 Design a differentiator to have a time constant of $10^{-2} \mathrm{~s}$ and an input capacitance of $0.01 \mu \mathrm{~F}$. What is the gain magnitude and phase of this circuit at $10 \mathrm{rad} / \mathrm{s}$, and at $10^{7} \mathrm{rad} / \mathrm{s}$ ? In order to limit the high-frequency gain of the differentiator circuit to 100 , a resistor is added in series with the capacitor. Find the required resistor value.
Ans. $C=0.01 \mu \mathrm{~F} ; R=1 \mathrm{M} \Omega$; at $\omega=10 \mathrm{rad} / \mathrm{s}:\left|V_{o} / V_{i}\right|=0.1 \mathrm{~V} / \mathrm{V}$ and $\phi=-90^{\circ}$; at $\omega=1000 \mathrm{rad} / \mathrm{s}$ : $\left|V_{o} / V_{i}\right|=10 \mathrm{~V} / \mathrm{V}$ and $\phi=-90^{\circ} ; 10 \mathrm{k} \Omega$

### 2.6 DC Imperfections

Thus far we have considered the op amp to be ideal. The only exception has been a brief discussion of the effect of the op-amp finite gain $A$ on the closed-loop gain of the inverting and noninverting configurations. Although in many applications the assumption of an ideal op amp is not a bad one, a circuit designer has to be thoroughly familiar with the characteristics of practical op amps and the effects of such characteristics on the performance of op-amp circuits. Only then will the designer be able to use the op amp intelligently, especially if the application at hand is not a straightforward one. The nonideal properties of op amps will, of course, limit the range of operation of the circuits analyzed in the previous examples.

In this and the two sections that follow, we consider some of the important nonideal properties of the op amp. ${ }^{4}$ We do this by treating one nonideality at a time, beginning in this section with the dc problems to which op amps are susceptible.

### 2.6.1 Offset Voltage

Because op amps are direct-coupled devices with large gains at dc, they are prone to dc problems. The first such problem is the dc offset voltage. To understand this problem consider

[^0]
[^0]:    ${ }^{4}$ We should note that real op amps have nonideal effects additional to those discussed in this chapter. These include finite (nonzero) common-mode gain or, equivalently, noninfinite CMRR, noninfinite input resistance, and nonzero output resistance. The effect of these, however, on the performance of most of the closed-loop circuits studied here is not very significant, and their study will be postponed to later chapters (in particular, Chapters 9, 10, and 13).
the following conceptual experiment: If the two input terminals of the op amp are tied together and connected to ground, it will be found that despite the fact that $v_{b i}=0$, a finite dc voltage exists at the output. In fact, if the op amp has a high dc gain, the output will be at either the positive or negative saturation level. The op-amp output can be brought back to its ideal value of 0 V by connecting a dc voltage source of appropriate polarity and magnitude between the two input terminals of the op amp. This external source balances out the input offset voltage of the op amp. It follows that the input offset voltage $\left(V_{O S}\right)$ must be of equal magnitude and of opposite polarity to the voltage we applied externally.

The input offset voltage arises as a result of the unavoidable mismatches present in the input differential stage inside the op amp. In later chapters (in particular Chapters 9 and 13) we shall study this topic in detail. Here, however, our concern is to investigate the effect of $V_{O S}$ on the operation of closed-loop op-amp circuits. Toward that end, we note that general-purpose op amps exhibit $V_{O S}$ in the range of 1 mV to 5 mV . Also, the value of $V_{O S}$ depends on temperature. The op-amp data sheets usually specify typical and maximum values for $V_{O S}$ at room temperature as well as the temperature coefficient of $V_{O S}$ (usually in $\mu \mathrm{V} /{ }^{\circ} \mathrm{C}$ ). They do not, however, specify the polarity of $V_{O S}$ because the component mismatches that give rise to $V_{O S}$ are obviously not known a priori; different units of the same op-amp type may exhibit either a positive or a negative $V_{O S}$.

To analyze the effect of $V_{O S}$ on the operation of op-amp circuits, we need a circuit model for the op amp with input offset voltage. Such a model is shown in Fig. 2.28. It consists of a dc source of value $V_{O S}$ placed in series with the positive input lead of an offset-free op amp. The justification for this model follows from the description above.


Figure 2.28 Circuit model for an op amp with input offset voltage $V_{O S}$.

# EXERCISE 

2.21 Use the model of Fig. 2.28 to sketch the transfer characteristic $v_{O}$ versus $v_{b i}\left(v_{O} \equiv v_{3}\right.$ and $\left.v_{b i} \equiv v_{2}-v_{1}\right)$ of an op amp having an open-loop dc gain $A_{0}=10^{4} \mathrm{~V} / \mathrm{V}$, output saturation levels of $\pm 10 \mathrm{~V}$, and $V_{O S}$ of +5 mV .
Ans. See Fig. E2.21. Observe that true to its name, the input offset voltage causes an offset in the voltage-transfer characteristic; rather than passing through the origin it is now shifted to the left by $V_{O S}$.


Figure E2.21 Transfer characteristic of an op amp with $V_{o S}=5 \mathrm{mV}$.

Analysis of op-amp circuits to determine the effect of the op-amp $V_{O S}$ on their performance is straightforward: The input voltage signal source is short-circuited and the op amp is replaced with the model of Fig. 2.28. (Eliminating the input signal, done to simplify matters, is based on the principle of superposition.) Following this procedure, we find that both the inverting and the noninverting amplifier configurations result in the same circuit, that shown in Fig. 2.29, from which the output dc voltage due to $V_{O S}$ is found to be

$$
V_{O}=V_{O S}\left[1+\frac{R_{2}}{R_{1}}\right]
$$

This output dc voltage can have a large magnitude. For instance, a noninverting amplifier with a closed-loop gain of 1000 , when constructed from an op amp with a $5-\mathrm{mV}$ input offset voltage, will have a dc output voltage of +5 V or -5 V (depending on the polarity of $V_{O S}$ ) rather than the ideal value of 0 V . Now, when an input signal is applied to the amplifier, the corresponding signal output will be superimposed on the $5-\mathrm{V}$ dc. Obviously then, the


Figure 2.29 Evaluating the output dc offset voltage due to $V_{o S}$ in a closed-loop amplifier.


Figure 2.30 The output dc offset voltage of an op amp can be trimmed to zero by connecting a potentiometer to the two offset-nulling terminals. The wiper of the potentiometer is connected to the negative supply of the op amp.


Figure 2.31 (a) A capacitively coupled inverting amplifier. (b) The equivalent circuit for determining its dc output offset voltage $V_{o}$.
allowable signal swing at the output will be reduced. Even worse, if the signal to be amplified is dc, we would not know whether the output is due to $V_{o s}$ or to the signal!

Some op amps are provided with two additional terminals to which a specified circuit can be connected to trim to zero the output dc voltage due to $V_{o s}$. Figure 2.30 shows such an arrangement that is typically used with general-purpose op amps. A potentiometer is connected between the offset-nulling terminals with the wiper of the potentiometer connected to the op-amp negative supply. Moving the potentiometer wiper introduces an imbalance that counteracts the asymmetry present in the internal op-amp circuitry and that gives rise to $V_{o s}$. We shall return to this point in the context of our study of the internal circuitry of op amps in Chapter 13. It should be noted, however, that even though the dc output offset can be trimmed to zero, the problem remains of the variation (or drift) of $V_{o s}$ with temperature.

One way to overcome the dc offset problem is by capacitively coupling the amplifier. This, however, will be possible only in applications where the closed-loop amplifier is not required to amplify dc or very-low-frequency signals. Figure 2.31(a) shows a capacitively coupled amplifier. Because of its infinite impedance at dc, the coupling capacitor will cause the gain to be zero at dc. As a result, the equivalent circuit for determining the dc output voltage resulting from the op-amp input offset voltage $V_{o s}$ will be that shown in Fig. 2.31(b). Thus $V_{o s}$ sees in effect a unity-gain voltage follower, and the dc output voltage $V_{o}$ will be equal to $V_{o s}$ rather than $V_{o s}\left(1+R_{2} / R_{1}\right)$, which is the case without the coupling capacitor. As far as input signals are concerned, the coupling capacitor $C$ forms together with $R_{1}$ an STC high-pass circuit with a corner frequency of $\omega_{0}=1 / C R_{1}$. Thus the gain of the capacitively
coupled amplifier will fall off at the low-frequency end [from a magnitude of $\left(1+R_{2} / R_{1}\right)$ at high frequencies] and will be 3 dB down at $\omega_{0}$.

# EXERCISES 

2.22 Consider an inverting amplifier with a nominal gain of 1000 constructed from an op amp with an input offset voltage of 3 mV and with output saturation levels of $\pm 10 \mathrm{~V}$. (a) What is (approximately) the peak sine-wave input signal that can be applied without output clipping? (b) If the effect of $V_{O S}$ is nulled at room temperature $\left(25^{\circ} \mathrm{C}\right)$, how large an input can one now apply if: (i) the circuit is to operate at a constant temperature? (ii) the circuit is to operate at a temperature in the range $0^{\circ} \mathrm{C}$ to $75^{\circ} \mathrm{C}$ and the temperature coefficient of $V_{O S}$ is $10 \mu \mathrm{~V} /{ }^{\circ} \mathrm{C}$ ?
Ans. (a) 7 mV ; (b) $10 \mathrm{mV}, 9.5 \mathrm{mV}$
2.23 Consider the same amplifier as in Exercise 2.22-that is, an inverting amplifier with a nominal gain of 1000 constructed from an op amp with an input offset voltage of 3 mV and with output saturation levels of $\pm 10 \mathrm{~V}$-except here let the amplifier be capacitively coupled as in Fig. 2.31(a). (a) What is the dc offset voltage at the output, and what (approximately) is the peak sine-wave signal that can be applied at the input without output clipping? Is there a need for offset trimming? (b) If $R_{1}=1 \mathrm{k} \Omega$ and $R_{2}=1 \mathrm{M} \Omega$, find the value of the coupling capacitor $C_{1}$ that will ensure that the gain will be greater than 57 dB down to 100 Hz .
Ans. (a) $3 \mathrm{mV}, 10 \mathrm{mV}$, no need for offset trimming; (b) $1.6 \mu \mathrm{~F}$

### 2.6.2 Input Bias and Offset Currents

The second dc problem encountered in op amps is illustrated in Fig. 2.32. In order for the op amp to operate, its two input terminals have to be supplied with dc currents, termed the input bias currents. ${ }^{5}$ In Fig. 2.32 these two currents are represented by two current sources, $I_{B 1}$ and $I_{B 2}$, connected to the two input terminals. It should be emphasized that the input bias currents are independent of the fact that a real op amp has finite (though large) input resistance (not shown in Fig. 2.32). The op-amp manufacturer usually specifies the average value of $I_{B 1}$ and $I_{B 2}$ as well as their expected difference. The average value $I_{B}$ is called the input bias current,

$$
I_{B}=\frac{I_{B 1}+I_{B 2}}{2}
$$

and the difference is called the input offset current and is given by

$$
I_{O S}=\left|I_{B 1}-I_{B 2}\right|
$$

Typical values for general-purpose op amps that use bipolar transistors are $I_{B}=100 \mathrm{nA}$ and $I_{O S}=10 \mathrm{nA}$.

[^0]
[^0]:    ${ }^{5}$ This is the case for op amps constructed using bipolar junction transistors (BJTs). Those using MOSFETs in the first (input) stage do not draw an appreciable input bias current; nevertheless, the input terminals should have continuous dc paths to ground. More on this in later chapters.


Figure 2.32 The op-amp input bias currents represented by two current sources $I_{B 1}$ and $I_{B 2}$.


Figure 2.33 Analysis of the closed-loop amplifier, taking into account the input bias currents.

We now wish to find the dc output voltage of the closed-loop amplifier due to the input bias currents. To do this we ground the signal source and obtain the circuit shown in Fig. 2.33 for both the inverting and noninverting configurations. As shown in Fig. 2.33, the output dc voltage is given by

$$
V_{O}=I_{B 1} R_{2} \simeq I_{B} R_{2}
$$more complex process technology it requires. A very brief discussion of BiCMOS is provided in Section 15.6, and more material can be found on the website.

Gallium Arsenide (GaAs) The high carrier mobility in GaAs results in very high speeds of operation. This has been demonstrated in a number of digital IC chips utilizing GaAs technology. It should be pointed out, however, that GaAs remains an "emerging technology," one that appears to have great potential but has not yet achieved such potential commercially. As such, it will not be studied in this book. Nevertheless, considerable material on GaAs devices and circuits, including digital circuits, can be found on the book's website.

## THE INVISIBLE COMPUTER:

One may think that computer integrated circuits appear only in desktops, laptops, and mobile phones, but that is not the case! Virtually invisible to the casual observer is a vast number of computer chips called microcontrollers, which include a relatively high-speed processor (often of 8 bits, but increasingly 16 or 32 ), along with flash memory and flexible input/output circuitry. The input/output circuitry often includes A/D conversion. Microcontrollers operate within almost every modern appliance and computer peripheral: late-model automobiles include large numbers of networked microcontrollers for engine control, safety systems, stability, braking, and diagnostics. For example, in the 2012 Toyota Lexus there are about 100 such controllers.

# 15.2.2 Styles for Digital System Design 

The conventional approach to designing digital systems consists of assembling the system using standard IC packages of various levels of complexity (and hence integration). Many systems have been built this way using, for example, TTL, SSI, and MSI packages. The advent of VLSI, in addition to providing the system designer with more powerful off-the-shelf components such as microprocessors and memory chips, has made possible alternative design styles. One such alternative is to opt for implementing part or all of the system using one or more custom VLSI chips. However, custom IC design is usually economically justified only when the production volume is large (greater than about 100,000 parts).

An intermediate approach, known as semicustom design, utilizes gate-array chips. These are integrated circuits containing 100,000 or more unconnected logic gates. Their interconnection can be achieved by a final metallization step (performed at the IC fabrication facility) according to a pattern specified by the user to implement the user's particular functional need. A more recently available type of gate array, known as a field-programmable gate array (FPGA), can, as its name indicates, be programmed directly by the user. FPGAs provide a very convenient means for the digital system designer to implement complex logic functions in VLSI form without having to incur either the cost or the "turnaround time" inherent in custom and, to a lesser extent, in semicustom IC design.

### 15.2.3 Design Abstraction and Computer Aids

The design of very complex digital systems, whether on a single IC chip or using off-the-shelf components, is made possible by the use of different levels of design abstraction, and the
use of a variety of computer aids. To appreciate the concept of design abstraction, consider the process of designing a digital system using off-the-shelf packages of logic gates. The designer consults data sheets (in data books or on websites) to determine the input and output characteristics of the gates, their fan-in and fan-out limitations, and so on. In connecting the gates, the designer needs to adhere to a set of rules specified by the manufacturer in the data sheets. The designer does not need to consider, in a direct way, the circuit inside the gate package. In effect, the circuit has been abstracted in the form of a functional block that can be used as a component. This greatly simplifies system design. The digital IC designer follows a similar process. Circuit blocks are designed, characterized, and stored in a library as standard cells. These cells can then be used by the IC designer to assemble a larger subsystem (e.g., an adder or a multiplier), which in turn is characterized and stored as a functional block to be used in the design of an even larger system (e.g., an entire processor).

At every level of design abstraction, the need arises for simulation and other computer programs that help make the design process as automated as possible. Whereas SPICE is employed in circuit simulation, other software tools are utilized at other levels and in other phases of the design process. Although digital system design and design automation are outside the scope of this book, it is important that the reader appreciate the role of design abstraction and computer aids in digital design. They are what make it humanly possible to design a billion-transistor digital IC. Unfortunately, analog IC design does not lend itself to the same level of abstraction and automation. Each analog IC to a large extent has to be "handcrafted." As a result, the complexity and density of analog ICs remain much below what is possible in a digital IC.

Whatever approach or style is adopted in digital design, some familiarity with the various digital circuit technologies and design techniques is essential. Chapters 14, 15, and 16 aim to provide such a background.

# 15.3 Pseudo-NMOS Logic Circuits 

### 15.3.1 The Pseudo-NMOS Inverter

Figure 15.10 shows a modified form of the CMOS inverter. Here, only $Q_{N}$ is driven by the input voltage while the gate of $Q_{P}$ is grounded, and $Q_{P}$ acts as an active load for $Q_{N}$. Even before we examine the operation of this circuit in detail, an advantage over standard CMOS is obvious: Each input needs to be connected to the gate of only one transistor or, alternatively, only one additional transistor (an NMOS) will be needed for each additional gate input. Thus the area and delay penalties arising from increased fan-in in a standard CMOS will be reduced. This is indeed the motivation for exploring this modified inverter circuit. Note that we considered some aspects of this circuit earlier, in Example 14.3.

The inverter circuit of Fig. 15.10(a) resembles other forms of NMOS logic that consist of a driver transistor $\left(Q_{N}\right)$ and a load transistor (in this case, $Q_{P}$ ); hence the name pseudo-NMOS. For comparison purposes, we shall briefly mention two older forms of NMOS logic. The earliest form, popular in the mid-1970s, utilized an enhancement MOSFET for the load element, in a topology whose basic inverter is shown in Fig. 15.10(b). This inverter circuit was the subject of Problem 14.28. It can be shown that its disadvantages include a relatively small logic swing, small noise margins, and high static power dissipation. For these reasons, this logic-circuit technology is virtually obsolete. It was replaced in the late 1970s and early 1980s with depletion-load NMOS circuits, in which a depletion NMOS transistor (see Section 5.4.5) with its gate connected to its source is used as the load element. The topology of the basic depletion-load inverter is shown in Fig. 15.10(c).


Figure 15.10 (a) The pseudo-NMOS logic inverter. (b) The enhancement-load (or saturated-load) NMOS inverter. (c) The depletion-load NMOS inverter.

It was initially expected that the depletion NMOS with $V_{G S}=0$ would operate as a constant-current source and would thus provide an excellent load element. ${ }^{3}$ However, it was quickly realized that the body effect in the depletion transistor causes its operation to deviate considerably from that of a constant-current source. Nevertheless, depletion-load NMOS circuits feature significant improvements over their enhancement-load counterparts, enough to justify the extra processing step required to fabricate the depletion devices (namely, ion-implanting the channel). Although depletion-load NMOS has been virtually replaced by CMOS, one can still see some depletion-load circuits in specialized applications. We will not study depletion-load NMOS logic here (the interested reader can refer to the website of this book).

The pseudo-NMOS inverter that we are about to study is similar to depletion-load NMOS, but with rather improved characteristics. It also has the advantage of being directly compatible with standard CMOS circuits.

# 15.3.2 Static Characteristics 

The static characteristics of the pseudo-NMOS inverter can be derived in a manner similar to that used for standard CMOS. Toward that end, we note that the drain currents of $Q_{N}$ and $Q_{P}$ are given by

$$
\begin{aligned}
& i_{D N}=\frac{1}{2} k_{n}\left(v_{I}-V_{t}\right)^{2}, \quad \text { for } v_{O} \geq v_{I}-V_{t} \quad \text { (saturation) } \\
& i_{D N}=k_{n}\left[\left(v_{I}-V_{t}\right) v_{O}-\frac{1}{2} v_{O}^{2}\right] \quad \text { for } v_{O} \leq v_{I}-V_{t} \quad \text { (triode) }
\end{aligned}
$$

[^0]
[^0]:    ${ }^{3} \mathrm{~A}$ constant-current load provides a capacitor-charging current that does not diminish as $v_{O}$ rises toward $V_{D D}$, as is the case with a resistive load. Thus the value of $t_{P L H}$ obtained with a current-source load is significantly lower than that obtained with a resistive load (see Problem 15.12). Of course, a resistive load, such as in the circuit studied in Example 14.2, is simply out of the question because of the very large silicon area it would occupy (equivalent to that of thousands of transistors!).


Figure 15.11 Graphical construction to determine the VTC of the inverter in Fig. 15.10(a).

$$
\begin{aligned}
& i_{D P}=\frac{1}{2} k_{p}\left(V_{D D}-V_{t}\right)^{2}, \quad \text { for } v_{O} \leq V_{t} \quad \text { (saturation) } \\
& i_{D P}=k_{p}\left[\left(V_{D D}-V_{t}\right)\left(V_{D D}-v_{O}\right)-\frac{1}{2}\left(V_{D D}-v_{O}\right)^{2}\right], \quad \text { for } v_{O} \geq V_{t} \quad \text { (triode) }
\end{aligned}
$$

where we have assumed that $V_{t n}=-V_{t p}=V_{t}$, and have used $k_{n}=k_{n}^{\prime}(W / L)_{n}$ and $k_{p}=k_{p}^{\prime}(W / L)_{p}$ to simplify matters.

To obtain the voltage-transfer characteristic of the inverter, we superimpose the load curve represented by Eqs. (15.16) and (15.17) on the $i_{D}-v_{D S}$ characteristics of $Q_{N}$, which can be relabeled as $i_{D N}-v_{O}$ and drawn for various values of $v_{G S}=v_{I}$. Such a graphical construction is shown in Fig. 15.11, where, to keep the diagram simple, we show the $Q_{N}$ curves for only the two extreme values of $v_{I}$, namely, 0 and $V_{D D}$. Two observations follow:

1. The load curve represents a much lower saturation current (Eq. 15.16) than is represented by the corresponding curve for $Q_{N}$, namely, that for $v_{I}=V_{D D}$. This is a result of the fact that the pseudo-NMOS inverter is usually designed so that $k_{n}$ is greater than $k_{p}$ by a factor of 4 to 10 . As we will show shortly, this inverter is of the so-called ratioed type, ${ }^{4}$ and the ratio $r \equiv k_{n} / k_{p}$ determines all the breakpoints of the VTC, that is, $V_{O L}, V_{I L}, V_{H I}$, and so on, and thus determines the noise margins. Selection of a relatively high value for $r$ reduces $V_{O L}$ and widens the noise margins.
2. Although one tends to think of $Q_{P}$ as acting as a constant-current source, it actually operates in saturation for only a small range of $v_{O}$, namely, $v_{O} \leq V_{t}$. For the remainder of the $v_{O}$ range, $Q_{P}$ operates in the triode region.
Consider first the two extreme cases of $v_{I}$ : When $v_{I}=0, Q_{N}$ is cut off and $Q_{P}$ is operating in the triode region, though with zero current and zero drain-source voltage. Thus the operating point is that labeled A in Fig. 15.11, where $v_{O}=V_{O H}=V_{D D}$, the static current is zero, and the static power dissipation is zero. When $v_{I}=V_{D D}$, the inverter will operate at the point
[^0]
[^0]:    ${ }^{4}$ For the NMOS inverters such as that in Fig. 15.10(b), $V_{O L}$ depends on the ratio of the transconductance parameters of the devices, that is, on the ratio $\left(k^{\prime}(W / L)\right)_{A t o s e} /\left(k^{\prime}(W / L)\right)_{\text {load }}$. Such circuits are therefore known as ratioed logic circuits. Standard CMOS logic circuits do not have such a dependency and can therefore be called ratioless.
labeled E in Fig. 15.11. Observe that unlike standard CMOS, here $V_{O L}$ is not zero, an obvious disadvantage. Another disadvantage is that the gate conducts current $\left(I_{\text {stat }}\right)$ in the low-output state, and thus there will be static power dissipation $\left(P_{D}=I_{\text {stat }} \times V_{D D}\right)$.

# 15.3.3 Derivation of the VTC 

Figure 15.12 shows the VTC of the pseudo-NMOS inverter. As indicated, it has four distinct regions, labeled I through IV, corresponding to the different combinations of possible modes of operation of $Q_{N}$ and $Q_{P}$. The four regions, the corresponding transistor modes of operation, and the conditions that define the regions are listed in Table 15.2. We shall utilize the information


Figure 15.12 VTC for the pseudo-NMOS inverter. This curve is plotted for $V_{D D}=5 \mathrm{~V}, V_{m}=-V_{m}=1 \mathrm{~V}$, and $r=9$.
Table 15.2 Regions of Operation of the Pseudo-NMOS Inverter

| Region | Segment of VTC | $Q_{N}$ | $Q_{P}$ | Condition |
| :-- | :-- | :-- | :-- | :-- |
| I | AB | Cutoff | Triode | $v_{I}<V_{t}$ |
| II | BC | Saturation | Triode | $v_{O} \geq v_{I}-V_{t}$ |
| III | CD | Triode | Triode | $V_{t} \leq v_{O} \leq v_{I}-V_{t}$ |
| IV | DE | Triode | Saturation | $v_{O} \leq V_{t}$ |

in this table together with the device equations given in Eqs. (15.14) through (15.17) to derive expressions for the various segments of the VTC and in particular for the important parameters that characterize the static operation of the inverter.

# ■ Region I (segment AB): 

$$
v_{O}=V_{O H}=V_{D D}
$$

## Region II (segment BC):

Equating $i_{D N}$ from Eq. (15.14) and $i_{D P}$ from Eq. (15.17) together with substituting $k_{n}=$ $r k_{p}$, and with some manipulations, we obtain

$$
v_{O}=V_{t}+\sqrt{\left(V_{D D}-V_{t}\right)^{2}-r\left(v_{I}-V_{t}\right)^{2}}
$$

The value of $V_{I L}$ can be obtained by differentiating this equation and substituting $\partial v_{O} / \partial v_{I}=-1$ and $v_{I}=V_{I L}$ :

$$
V_{I L}=V_{t}+\frac{V_{D D}-V_{t}}{\sqrt{r(r+1)}}
$$

The threshold voltage $V_{M}$ is by definition the value of $v_{I}$ for which $v_{O}=v_{I}$,

$$
V_{M}=V_{t}+\frac{V_{D D}-V_{t}}{\sqrt{r+1}}
$$

Finally, the end point of the region II segment (point C ) can be found by substituting $v_{O}=v_{I}-V_{t}$ in Eq. (15.19), the condition for $Q_{N}$ leaving saturation and entering the triode region.

## Region III (segment CD)

This is a short segment that is not of great interest. Point D is characterized by $v_{O}=V_{t}$.

## Region IV (segment DE)

Equating $i_{D N}$ from Eq. (15.15) to $i_{D P}$ from Eq. (15.16) and substituting $k_{n}=r k_{p}$ results in

$$
v_{O}=\left(v_{I}-V_{t}\right)-\sqrt{\left(v_{I}-V_{t}\right)^{2}-\frac{1}{r}\left(V_{D D}-V_{t}\right)^{2}}
$$
The value of $V_{I H}$ can be determined by differentiating this equation and setting $\partial v_{O} / \partial v_{I}=$ -1 and $v_{I}=V_{I H}$,

$$
V_{I H}=V_{t}+\frac{2}{\sqrt{3 r}}\left(V_{D D}-V_{t}\right)
$$

The value of $V_{O L}$ can be found by substituting $v_{I}=V_{D D}$ into Eq. (15.22),

$$
V_{O L}=\left(V_{D D}-V_{t}\right)\left[1-\sqrt{1-\frac{1}{r}}\right]
$$

The static current conducted by the inverter in the low-output state is found from Eq. (15.16) as

$$
I_{\text {stat }}=\frac{1}{2} k_{p}\left(V_{D D}-V_{t}\right)^{2}
$$

Finally, we can use Eqs. (15.20) and (15.24) to determine $N M_{L}$ and Eqs. (15.18) and (15.23) to determine $N M_{H}$ :

$$
\begin{gathered}
N M_{L}=V_{t}-\left(V_{D D}-V_{t}\right)\left[1-\sqrt{1-\frac{1}{r}}-\frac{1}{\sqrt{r(r+1)}}\right] \\
N M_{H}=\left(V_{D D}-V_{t}\right)\left(1-\frac{2}{\sqrt{3 r}}\right)
\end{gathered}
$$

As a final observation, we note that since $V_{D D}$ and $V_{t}$ are determined by the process technology, the only design parameter for controlling the values of $V_{O L}$ and the noise margins is the ratio $r$.

# 15.3.4 Dynamic Operation 

Analysis of the inverter transient response to determine $t_{P L H}$ with the inverter loaded by a capacitance $C$ is identical to that of the complementary CMOS inverter. The capacitance will be charged by the current $i_{D P}$; we can determine an estimate for $t_{P L H}$ by using the average value of $i_{D P}$ over the range $v_{O}=0$ to $v_{O}=V_{D D} / 2$. The result is:

$$
t_{P L H}=\frac{\alpha_{p} C}{k_{p} V_{D D}}
$$

where

$$
\alpha_{p}=2 /\left[\frac{7}{4}-3\left(\frac{V_{t}}{V_{D D}}\right)+\left(\frac{V_{t}}{V_{D D}}\right)^{3}\right]
$$
The case for the capacitor discharge is somewhat different because the current $i_{D P}$ has to be subtracted from $i_{D N}$ to determine the discharge current. The result is

$$
t_{P H L} \simeq \frac{\alpha_{n} C}{k_{n} V_{D D}}
$$

where

$$
\alpha_{n}=2 /\left[1+\frac{3}{4}\left(1-\frac{1}{r}\right)-\left(3-\frac{1}{r}\right)\left(\frac{V_{i}}{V_{D D}}\right)+\left(\frac{V_{i}}{V_{D D}}\right)^{2}\right]
$$

which, for a large value of $r$, reduces to

$$
\alpha_{n} \simeq \alpha_{p}
$$

Although these are similar formulas to those for the standard CMOS inverter, the pseudo-NMOS inverter has a special problem: Since $k_{p}$ is $r$ times smaller than $k_{n}, t_{P L H}$ will be approximately $r$ times larger than $t_{P H L}$. Thus the circuit exhibits an asymmetrical delay performance. Recall, however, that for gates with large fan-in, pseudo-NMOS requires fewer transistors and thus $C$ can be smaller than in the corresponding standard CMOS gate.

# 15.3.5 Design 

The design involves selecting the ratio $r$ and the $W / L$ for one of the transistors. The value of $W / L$ for the other device can then be obtained using $r$. The design parameters of interest are $V_{O L}, N M_{L}, N M_{H}, I_{\text {stat }}, P_{D}, t_{P L H}$, and $t_{P H L}$. Important design considerations are as follows:

1. The ratio $r$ determines all the breakpoints of the VTC; the larger the value of $r$, the lower $V_{O L}$ is (Eq. 15.24) and the wider the noise margins are (Eqs. 15.26 and 15.27). However, a larger $r$ increases the asymmetry in the dynamic response and, for a given $(W / L)_{p}$, makes the silicon area larger. Thus, selecting a value for $r$ represents a compromise between noise margins on the one hand and silicon area and $t_{P}$ on the other. Usually, $r$ is selected in the range 4 to 10 .
2. Once $r$ has been determined, a value for $(W / L)_{p}$ or $(W / L)_{n}$ can be selected and the other determined. Here, one would select a small $(W / L)_{n}$ to keep the gate area small and thus obtain a small value for $C$. Similarly, a small $(W / L)_{p}$ keeps $I_{\text {stat }}$ and $P_{D}$ low. On the other hand, one would want to select larger $W / L$ ratios to obtain low $t_{P}$ and thus fast response. For usual (high-speed) applications, $(W / L)_{p}$ is selected so that $I_{\text {stat }}$ is in the range of $50 \mu \mathrm{~A}$ to $100 \mu \mathrm{~A}$, which for $V_{D D}=1.8 \mathrm{~V}$ results in $P_{D}$ in the range of $90 \mu \mathrm{~W}$ to $180 \mu \mathrm{~W}$.

### 15.3.6 Gate Circuits

Except for the load device, the pseudo-NMOS gate circuit is identical to the PDN of the complementary CMOS gate. Four-input, pseudo-NMOS NOR and NAND gates are shown in Fig. 15.13. Note that each requires five transistors compared to the eight used in standard CMOS. In pseudo-NMOS, NOR gates are preferred over NAND gates because the former do not utilize transistors in series and thus can be designed with minimum-size NMOS devices.


Figure 15.13 NOR and NAND gates of the pseudo-NMOS type.

# 15.3.7 Concluding Remarks 

Pseudo-NMOS is particularly suited for applications in which the output remains high most of the time. In such applications, the static power dissipation can be reasonably low (since the gate dissipates static power only in the low-output state). Further, the output transitions that matter would presumably be high-to-low ones, where the propagation delay can be made as short as necessary. A particular application of this type can be found in the design of address decoders for memory chips (Section 16.4) and in read-only memories (Section 16.5).

## Example 15.2

Consider a pseudo-NMOS inverter fabricated in a $0.25-\mu \mathrm{m}$ CMOS technology for which $\mu_{n} C_{o s}=$ $115 \mu \mathrm{~A} / \mathrm{V}^{2}, \mu_{p} C_{o s}=30 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{t n}=-V_{t p}=0.5 \mathrm{~V}$, and $V_{D D}=2.5 \mathrm{~V}$. Let the $W / L$ ratio of $Q_{P}$ be ( 0.25 $\mu \mathrm{m} / 0.25 \mu \mathrm{~m}$ ) and $r=9$. Find:
(a) $V_{O H}, V_{O L}, V_{I L}, V_{I H}, V_{M}, N M_{H}$, and $N M_{L}$
(b) $(W / L)_{n}$
(c) $I_{s t n}$ and $P_{D}$
(d) $t_{P L H}, t_{P H L}$, and $t_{P}$, assuming a total capacitance at the inverter output of 7 fF
# Solution 

(a) $V_{O H}=V_{D D}=2.5 \mathrm{~V}$
$V_{O L}$ is determined from Eq. (15.24) as

$$
V_{O L}=(2.5-0.5)\left[1-\sqrt{1-\frac{1}{9}}\right]=0.11 \mathrm{~V}
$$

$V_{I L}$ is determined from Eq. (15.20) as

$$
V_{I L}=0.5+\frac{2.5-0.5}{\sqrt{9(9+1)}}=0.71 \mathrm{~V}
$$

$V_{I H}$ is determined from Eq. (15.23) as

$$
V_{I H}=0.5+\frac{2}{\sqrt{3 \times 9}} \times(2.5-0.5)=1.27 \mathrm{~V}
$$

$V_{M}$ is determined from Eq. (15.21) as

$$
V_{M}=0.5+\frac{2.5-0.5}{\sqrt{9+1}}=1.13 \mathrm{~V}
$$

The noise margins can now be determined as

$$
\begin{aligned}
& N M_{H}=V_{O H}-V_{I H}=2.5-1.27=1.23 \mathrm{~V} \\
& N M_{L}=V_{I L}-V_{O L}=0.71-0.11=0.60 \mathrm{~V}
\end{aligned}
$$

Observe that the noise margins are not equal and that $N M_{L}$ is rather low.
(b) The $W / L$ ratio of $Q_{N}$ can be found from

$$
\begin{aligned}
& \frac{\mu_{n} C_{o s}(W / L)_{n}}{\mu_{p} C_{o s}(W / L)_{p}}=9 \\
& \frac{115 \times(W / L)_{n}}{30 \times 1}=9
\end{aligned}
$$

Thus,

$$
(W / L)_{n}=2.35
$$

(c) The dc current in the low-output state can be determined from Eq. (15.25) as

$$
I_{\text {stat }}=\frac{1}{2} \times 30 \times 1(2.5-0.5)^{2}=60 \mu \mathrm{~A}
$$

The static power dissipation can now be found from

$$
\begin{aligned}
P_{D} & =I_{\text {stat }} V_{D D} \\
& =60 \times 2.5=150 \mu \mathrm{~W}
\end{aligned}
$$# Example 15.2 continued 

(d) The low-to-high propagation delay can be found by using Eqs. (15.28) and (15.29):

$$
\begin{aligned}
\alpha_{p} & =1.68 \\
t_{P L H} & =\frac{1.68 \times 7 \times 10^{-15}}{30 \times 10^{-6} \times 1 \times 2.5}=0.16 \mathrm{~ns}
\end{aligned}
$$

The high-to-low propagation delay can be found by using Eqs. (15.30) and (15.31):

$$
\begin{aligned}
\alpha_{n} & =1.77 \\
t_{P H L} & =\frac{1.77 \times 7 \times 10^{-15}}{115 \times 10^{-6} \times 2.35 \times 2.5}=0.02 \mathrm{~ns}
\end{aligned}
$$

Now, the propagation delay can be determined, as

$$
t_{P}=\frac{1}{2}(0.16+0.02)=0.09 \mathrm{~ns}
$$

Although the propagation delay is considerably greater than that of a standard CMOS inverter, this is not an entirely fair comparison: Recall that the advantage of pseudo-NMOS occurs in gates with large fan-in, not in a single inverter.

## EXERCISES

15.6 While keeping $r$ unchanged, redesign the inverter circuit of Example 15.2 to lower its static power dissipation to half the value found. Find the $W / L$ ratios for the new design. Also find $t_{P L H}, t_{P H L}$, and $t_{P}$, assuming that $C$ remains unchanged. Would the noise margins change?
Ans. $(W / L)_{n}=1.18 ;(W / L)_{p}=0.5 ; 0.32 \mathrm{~ns} ; 0.04 \mathrm{~ns} ; 0.18 \mathrm{~ns}$; no
15.7 Redesign the inverter of Example 15.2 using $r=4$. Find $V_{O L}$ and the noise margins. If $(W / L)_{n}=0.375$ $\mu \mathrm{m} / 0.25 \mu \mathrm{~m}$, find $(W / L)_{p}, I_{\text {stat }}, P_{D}, t_{P L H}, t_{P H L}$, and $t_{P}$. Assume $C=7 \mathrm{fF}$.
Ans. $V_{O L}=0.27 \mathrm{~V} ; N M_{L}=0.68 \mathrm{~V} ; N M_{H}=0.85 \mathrm{~V} ;(W / L)_{p}=1.44 ; I_{\text {stat }}=86.3 \mu \mathrm{~A} ; P_{D}=0.22 \mathrm{~mW}$; $t_{P L H}=0.11 \mathrm{~ns} ; t_{P H L}=0.03 \mathrm{~ns} ; t_{P}=0.07 \mathrm{~ns}$

### 15.4 Pass-Transistor Logic Circuits

A conceptually simple approach for implementing logic functions utilizes series and parallel combinations of switches that are controlled by input logic variables to connect the input and output nodes (see Fig. 15.14). Each of the switches can be implemented either by a


Figure 15.14 Conceptual pass-transistor logic gates. (a) Two switches, controlled by the input variables $B$ and $C$, when connected in series in the path between the input node to which an input variable $A$ is applied and the output node (with an implied load to ground) realize the function $Y=A B C$. (b) When the two switches are connected in parallel, the function realized is $Y=A(B+C)$.


Figure 15.15 Two possible implementations of a voltage-controlled switch connecting nodes $A$ and $Y$ : (a) single NMOS transistor and (b) CMOS transmission gate.
single NMOS transistor [Fig. 15.15(a)] or by a pair of complementary MOS transistors connected in what is known as the CMOS transmission-gate configuration [Fig. 15.15(b)]. The result is a simple form of logic circuit that is particularly suited for some special logic functions and is frequently used in conjunction with standard CMOS logic to implement such functions efficiently: that is, with a lower total number of transistors than is possible with CMOS alone.

Because this form of logic utilizes MOS transistors in the series path from input to output, to pass or block signal transmission, it is known as pass-transistor logic (PTL). As mentioned earlier, CMOS transmission gates are frequently employed to implement the switches, giving this logic-circuit form the alternative name transmission-gate logic. The terms are used interchangeably independent of the actual implementation of the switches.

Though conceptually simple, pass-transistor logic circuits have to be designed with care. In the following, we shall study the basic principles of PTL circuit design and present examples of its application.

# 15.4.1 An Essential Design Requirement 

An essential requirement in the design of PTL circuits is ensuring that every circuit node has at all times a low-resistance path either to $V_{D D}$ or to ground. To appreciate this point, consider the situation depicted in Fig. 15.16(a): A switch $S_{1}$ (usually part of a larger PTL


Figure 15.16 A basic design requirement of PTL circuits is that every node have, at all times, a low-resistance path to either ground or $V_{D D}$. Such a path does not exist in (a) when $B$ is low and $S_{1}$ is open. It is provided in (b) through switch $S_{2}$.
network, not shown) is used to form the AND function of its controlling variable $B$ and the variable $A$ available at the output of a CMOS inverter. The output $Y$ of the PTL circuit is shown connected to the input of another inverter. Now, if $B$ is high, $S_{1}$ closes and $Y=A$. Node $Y$ will then be connected either to $V_{D D}$ (if $A$ is high) through $Q_{2}$ or to ground (if $A$ is low) through $Q_{1}$. But what happens when $B$ goes low and $S_{1}$ opens? Node $Y$ will now become a high-impedance node. If initially $v_{Y}$ was zero, it will remain so. However, if initially $v_{Y}$ was high at $V_{D D}$, this voltage will be maintained by the charge on the parasitic capacitance $C$, and $Y$ will not be a logic 0 as required of the AND function $Y=A B$.

The problem can be easily solved by establishing for node $Y$ a low-resistance path that is activated when $B$ goes low, as shown in Fig. 15.16(b). Here, another switch, $S_{2}$, controlled by $\bar{B}$, is connected between $Y$ and ground. When $B$ goes low, $S_{2}$ closes and establishes a low-resistance path between $Y$ and ground. The voltage $v_{Y}$ will then be 0 volts, the proper output of the AND function when $B$ is zero.

# 15.4.2 Operation with NMOS Transistors as Switches 

Implementing the switches in a PTL circuit with single NMOS transistors results in a simple circuit with small area and small node capacitances. These advantages, however, are obtained at the expense of serious shortcomings in both the static characteristics and the dynamic performance of the resulting circuits. To illustrate, consider the circuit shown in Fig. 15.17, where an NMOS transistor $Q$ is used to implement a switch connecting an input node with voltage $v_{I}$ and an output node. The total capacitance between the output node and ground is represented by capacitor $C$. The switch is shown in the closed state with the control signal applied to its gate being high at $V_{D D}$. We wish to analyze the operation of the circuit as the input voltage $v_{I}$ goes high (to $V_{D D}$ ) at time $t=0$. We assume that initially the output voltage $v_{O}$ is zero and capacitor $C$ is fully discharged. ${ }^{5}$

[^0]
[^0]:    ${ }^{5}$ Although the MOS transistor is symmetric and its drain and source are interchangeable, it is always useful to know which terminal is functioning as the source and which as the drain. The terminal with the higher voltage in an NMOS transistor is the drain. The opposite is true for the PMOS transistor.


Figure 15.17 Operation of the NMOS transistor as a switch in the implementation of PTL circuits. This analysis is for the case with the switch closed ( $v_{C}$ is high) and the input going high $\left(v_{I}=V_{D D}\right)$.

When $v_{I}$ goes high, the transistor operates in the saturation mode and delivers a current $i_{D}$ to charge the capacitor,

$$
i_{D}=\frac{1}{2} k_{\mathrm{e}}\left(V_{D D}-v_{O}-V_{t}\right)^{2}
$$

where $k_{\mathrm{e}}=k_{\mathrm{e}}^{\prime}(W / L)$, and $V_{t}$ is determined by the body effect since the source is at a voltage $v_{O}$ relative to the body (which, though not shown, is connected to ground); thus (see Eq. 5.30),

$$
V_{t}=V_{t 0}+\gamma\left(\sqrt{v_{O}+2 \phi_{f}}-\sqrt{2 \phi_{f}}\right)
$$

Thus, initially (at $t=0$ ), $V_{t}=V_{t 0}$ and the current $i_{D}$ is relatively large. However, as $C$ charges up and $v_{O}$ rises, $V_{t}$ increases (Eq. 15.34) and $i_{D}$ decreases. The latter effect is due to the increase both in $v_{O}$ and in $V_{t}$. It follows that the process of charging the capacitor will be relatively slow. More seriously, observe from Eq. (15.33) that $i_{D}$ reduces to zero when $v_{O}$ reaches $\left(V_{D D}-V_{t}\right)$. Thus the high output voltage $\left(V_{O H}\right)$ will not be equal to $V_{D D}$; rather, it will be lower by $V_{t}$, and to make matters worse, the value of $V_{t}$ can be as high as 1.5 to 2 times $V_{t 0}$ !

In addition to reducing the gate noise immunity, the low value of $V_{O H}$ (commonly referred to as a "poor 1") has another detrimental effect: Consider what happens when the output node is connected to the input of a standard CMOS inverter (as was the case in Fig. 15.16). The low value of $V_{O H}$ can cause $Q_{P}$ of the load inverter to conduct. Thus the inverter will have a finite static current and static power dissipation.

The propagation delay $t_{P L H}$ of the PTL gate of Fig. 15.17 can be determined as the time for $v_{O}$ to reach $V_{D D} / 2$. This can be calculated using techniques similar to those employed in the analysis of the CMOS inverter in Section 14.4, as will be illustrated shortly in an example.

Figure 15.18 shows the NMOS switch circuit when $v_{I}$ is brought down to 0 V . We assume that initially $v_{O}=V_{D D}$. Thus at $t=0+$, the transistor conducts and operates in the saturation region,

$$
i_{D}=\frac{1}{2} k_{\mathrm{e}}\left(V_{D D}-V_{t}\right)^{2}
$$

where we note that since the source is now at 0 V (note that the drain and source have interchanged roles), there will be no body effect, and $V_{t}$ remains constant at $V_{t 0}$. As $C$ discharges, $v_{O}$ decreases and the transistor enters the triode region at $v_{O}=V_{D D}-V_{t}$. Nevertheless, the capacitor discharge continues until $C$ is fully discharged and $v_{O}=0$. Thus, the NMOS transistor


Figure 15.18 Operation of the NMOS switch as the input goes low $\left(v_{t}=0 \mathrm{~V}\right)$. Note that the drain of an NMOS transistor is always higher in voltage than the source; correspondingly, the drain and source terminals interchange roles in comparison to the circuit in Fig. 15.17.
provides $V_{D L}=0$, or a "good 0 ." Again, the propagation delay $t_{P H L}$ can be determined using usual techniques, as illustrated by the following example.

# Example 15.3 

Consider the NMOS transistor switch in the circuits of Figs. 15.17 and 15.18 to be fabricated in a technology for which $\mu_{n} C_{o s}=50 \mu \mathrm{~A} / \mathrm{V}^{2}, \mu_{p} C_{o s}=20 \mu \mathrm{~A} / \mathrm{V}^{2},\left|V_{t 0}\right|=1 \mathrm{~V}, \gamma=0.5 \mathrm{~V}^{1 / 2}, 2 \phi_{f}=0.6 \mathrm{~V}$, and $V_{D D}=5 \mathrm{~V}$, where $\phi_{f}$ is a physical parameter. Let the transistor be of the minimum size for this technology, namely, $4 \mu \mathrm{~m} / 2 \mu \mathrm{~m}$, and assume that the total capacitance between the output node and ground is $C=50 \mathrm{fF}$.
(a) For the case with $v_{t}$ high (Fig. 15.17), find $V_{O H}$.
(b) If the output feeds a CMOS inverter whose $(W / L)_{p}=2.5(W / L)_{n}=10 \mu \mathrm{~m} / 2 \mu \mathrm{~m}$, find the static current of the inverter and its power dissipation when its input is at the value found in (a). Also find the inverter output voltage.
(c) Find $t_{P L H}$.
(d) For the case with $v_{t}$ going low (Fig. 15.18), find $t_{P H L}$.
(e) Find $t_{P}$.

## Solution

(a) Refer to Fig. 15.17. If $V_{O H}$ is the value of $v_{O}$ at which $Q$ stops conducting,

$$
V_{D D}-V_{O H}-V_{t}=0
$$

then,

$$
V_{O H}=V_{D D}-V_{t}
$$

where $V_{t}$ is the value of the threshold voltage at a source-body reverse bias equal to $V_{O H}$. Using Eq. (15.34), we have

$$
\begin{aligned}
V_{t} & =V_{t 0}+\gamma\left(\sqrt{V_{O H}+2 \phi_{f}}-\sqrt{2 \phi_{f}}\right) \\
& =V_{t 0}+\gamma\left(\sqrt{V_{D D}-V_{t}+2 \phi_{f}}-\sqrt{2 \phi_{f}}\right)
\end{aligned}
$$
Substituting $V_{t 0}=1, \gamma=0.5, V_{D D}=5$, and $2 \phi_{f}=0.6$, we obtain a quadratic equation in $V_{t}$ whose solution yields

$$
V_{t}=1.6 \mathrm{~V}
$$

Thus,

$$
V_{O H}=3.4 \mathrm{~V}
$$

Note that this represents a significant loss in signal amplitude.
(b) The load inverter will have an input signal of 3.4 V . Thus, its $Q_{P}$ will conduct a current of

$$
i_{D P}=\frac{1}{2} \times 20 \times \frac{10}{2}(5-3.4-1)^{2}=18 \mu \mathrm{~A}
$$

where we have assumed $Q_{P}$ to be operating in saturation, as we still expect $v_{O}$ of the inverter to be close to 0 V . Thus, the static power dissipation of the inverter will be

$$
P_{D}=V_{D D} i_{D P}=5 \times 18=90 \mu \mathrm{~W}
$$

The output voltage of the inverter can be found by noting that $Q_{N}$ will be operating in the triode region. Equating its current to that of $Q_{P}$ (i.e., $18 \mu \mathrm{~A}$ ) enables us to determine the output voltage to be 0.08 V .
(c) To determine $t_{P L H}$, refer to Fig. 15.17. We need to find the current $i_{D}$ at $t=0$ (where $v_{O}=0, V_{t}=V_{t 0}=$ 1 V ) and at $t=t_{P L H}$ (where $v_{O}=2.5 \mathrm{~V}, V_{t}$ to be determined), as follows:

$$
\begin{aligned}
i_{D}(0) & =\frac{1}{2} \times 50 \times \frac{4}{2} \times(5-1)^{2}=800 \mu \mathrm{~A} \\
V_{t}\left(\text { at } v_{O}\right. & =2.5 \mathrm{~V})=1+0.5(\sqrt{2.5+0.6}-\sqrt{0.6})=1.49 \mathrm{~V} \\
i_{D}\left(t_{P L H}\right) & =\frac{1}{2} \times 50 \times \frac{4}{2}(5-2.5-1.49)^{2}=50 \mu \mathrm{~A}
\end{aligned}
$$

We can now compute the average discharge current as

$$
\left.i_{D}\right|_{w}=\frac{800+50}{2}=425 \mu \mathrm{~A}
$$

and $t_{P L H}$ can be found as

$$
\begin{aligned}
t_{P L H} & =\frac{C\left(V_{D D} / 2\right)}{\left.i_{D}\right|_{w}} \\
& =\frac{50 \times 10^{-15} \times 2.5}{425 \times 10^{-6}}=0.29 \mathrm{~ns}
\end{aligned}
$$

(d) Refer to the circuit in Fig. 15.18. Observe that, here, $V_{t}$ remains constant at $V_{t 0}=1 \mathrm{~V}$. At $t=0, Q$ will be operating in saturation, and the drain current will be

$$
i_{D}(0)=\frac{1}{2} \times 50 \times \frac{4}{2}(5-1)^{2}=800 \mu \mathrm{~A}
$$
# Example 15.3 continued 

At $t=t_{P H L}, Q$ will be operating in the triode region, and thus

$$
\begin{aligned}
i_{D}\left(t_{P H L}\right) & =50 \times \frac{4}{2}\left[(5-1) \times 2.5-\frac{1}{2} \times 2.5^{2}\right] \\
& =688 \mu \mathrm{~A}
\end{aligned}
$$

Thus, the average discharge current is given by

$$
\left.i_{D}\right|_{s v}=\frac{1}{2}(800+688)=744 \mu \mathrm{~A}
$$

and $t_{P H L}$ can be determined as

$$
t_{P H L}=\frac{50 \times 10^{-15} \times 2.5}{744 \times 10^{-6}}=0.17 \mathrm{~ns}
$$

(e) $t_{P}=\frac{1}{2}\left(t_{P L H}+t_{P H L}\right)=\frac{1}{2}(0.29+0.17)=0.23 \mathrm{~ns}$

## EXERCISE

15.8 Let the NMOS transistor switch in Fig. 15.17 be fabricated in a $0.18-\mu \mathrm{m}$ CMOS process for which $V_{o 1}=0.5 \mathrm{~V}, \gamma=0.3 \mathrm{~V}^{1 / 2}, 2 \phi_{f}=0.85 \mathrm{~V}$, and $V_{D D}=1.8 \mathrm{~V}$. Find $V_{O H}$.
Ans. 1.15 V

### 15.4.3 Restoring the Value of $V_{O H}$ to $V_{D D}$

Example 15.3 illustrates clearly the problem of signal-level loss and its deleterious effect on the operation of the succeeding CMOS inverter. Some rather ingenious techniques have been developed to restore the output level to $V_{D D}$. We shall briefly discuss two such techniques. One is circuit based and the other is based on process technology.

The circuit-based approach is illustrated in Fig. 15.19. Here, $Q_{1}$ is a pass-transistor controlled by input $B$. The output node of the PTL network is connected to the input of a standard CMOS inverter formed by $Q_{N}$ and $Q_{P}$. A PMOS transistor $Q_{B}$, whose gate is controlled by the output voltage of the inverter, $v_{O 2}$, has been added to the circuit. Observe that in the event that the output of the PTL gate, $v_{O 1}$, is low (at ground), $v_{O 2}$ will be high (at $V_{D D}$ ), and $Q_{B}$ will be off. On the other hand, if $v_{O 1}$ is high but not quite equal to $V_{D D}$, the output


Figure 15.19 The use of transistor $Q_{R}$, connected in a feedback loop around the CMOS inverter, to restore the $V_{O H}$ level, produced by $Q_{1}$, to $V_{D D}$.
of the inverter will be low (as it should be) and $Q_{R}$ will turn on, supplying a current to charge $C$ up to $V_{D D}$. This process will stop when $v_{O 1}=V_{D D}$, that is, when the output voltage has been restored to its proper level. The "level-restoring" function performed by $Q_{R}$ is frequently employed in MOS digital circuit design. It should be noted that although the description of operation is relatively straightforward, the addition of $Q_{R}$ closes a "positive-feedback" loop around the CMOS inverter, and thus operation is more involved than it appears, especially during transients. Selection of a W/L ratio for $Q_{R}$ is also a somewhat involved process, although normally $k_{r}$ is selected to be much lower than $k_{n}$ (say a third or a fifth as large). Intuitively, this is appealing, for it implies that $Q_{R}$ will not play a major role in circuit operation, apart from restoring the level of $V_{O H}$ to $V_{D D}$, as explained above. Transistor $Q_{R}$ is said to be a "weak PMOS transistor." See Problem 15.35.

The other technique for correcting for the loss of the high-output signal level $\left(V_{O H}\right)$ is a technology-based solution. Specifically, recall that the loss in the value of $V_{O H}$ is equal to $V_{m}$. It follows that we can reduce the loss by using a lower value of $V_{m}$ for the NMOS switches, and we can eliminate the loss altogether by using devices for which $V_{m}=0$. These zero-threshold devices, which can be fabricated by using ion implantation to control the value of $V_{m}$, are known as natural devices. The problem of low-threshold devices, however, is the increased subthreshold conduction (Section 15.1.4) and the corresponding increase in static power dissipation.

# 15.4.4 The Use of CMOS Transmission Gates as Switches 

Great improvements in static and dynamic performance are obtained when the switches are implemented with CMOS transmission gates. The transmission gate utilizes a pair of complementary transistors connected in parallel. It acts as an excellent switch, providing bidirectional current flow, and it exhibits an on-resistance that remains almost constant for wide ranges of input voltage. These characteristics make the transmission gate not only an excellent switch in digital applications but also an excellent analog switch in such applications as data converters and switched-capacitor filters (Chapter 17).

Before we analyze the transmission-gate circuit, it is useful to reflect on its origin. Recall that an NMOS transistor transmits the $0-\mathrm{V}$ level to the output perfectly and thus produces a "good 0 ." It has difficulty, however, in passing the $V_{D D}$ level, with the result that $V_{O H}=V_{D D}-V_{t}$


Figure 15.20 The CMOS transmission gate and its circuit symbol.
(a "poor 1"). It can be shown (see Problems 15.25 and 15.31) that a PMOS transistor does exactly the opposite; that is, it passes the $V_{D D}$ level perfectly and thus produces a "good 1 " but has trouble passing the $0-\mathrm{V}$ level, thus producing a "poor 0 ." It is natural therefore to think that placing an NMOS and a PMOS transistor in parallel would produce good results in both the 0 and 1 cases.

Another way to describe the performance of the two transistor types is that the NMOS is good at pulling the output down to 0 V , while the PMOS is good at pulling the output up to $V_{D D}$. Interestingly, these are also the roles they play in the standard CMOS inverter.

Figure 15.20 shows the transmission gate together with its frequently used circuit symbol. The transmission gate is a bilateral switch that results in $v_{T}=v_{X}$ when $v_{C}$ is high $\left(V_{D D}\right)$. In terms of logic variables, its function is described by

$$
Y=X \quad \text { if } \quad C=1
$$

Figure 15.21(a) shows the transmission-gate switch in the "on" position with the input, $v_{I}$, rising to $V_{D D}$ at $t=0$. Assuming, as before, that initially the output voltage is zero, we see that $Q_{N}$ will be operating in saturation and providing a charging current of

$$
i_{D N}=\frac{1}{2} k_{u}\left(V_{D D}-v_{O}-V_{i n}\right)^{2}
$$

where, as in the case of the single NMOS switch, $V_{i n}$ is determined by the body effect,

$$
V_{i n}=V_{r 0}+\gamma\left(\sqrt{v_{O}+2 \phi_{f}}-\sqrt{2 \phi_{f}}\right)
$$

Transistor $Q_{N}$ will conduct a diminishing current that reduces to zero at $v_{O}=V_{D D}-V_{i n}$. Observe, however, that $Q_{P}$ operates with $V_{S G}=V_{D D}$ and is initially in saturation,

$$
i_{D P}=\frac{1}{2} k_{p}\left(V_{D D}-\left|V_{i p}\right|\right)^{2}
$$


Figure 15.21 Operation of the transmission gate as a switch in PTL circuits with (a) $v_{I}$ high and (b) $v_{I}$ low.
where, since the body of $Q_{P}$ is connected to $V_{D D},\left|V_{i p}\right|$ remains constant at the value $V_{t 0}$, assumed to be the same value as for the $n$-channel device. The total capacitor-charging current is the sum of $i_{D N}$ and $i_{D P}$. Now, $Q_{P}$ will enter the triode region at $v_{O}=\left|V_{i p}\right|$, but will continue to conduct until $C$ is fully charged and $v_{O}=V_{D H}=V_{D D}$. Thus, the $p$-channel device will provide the gate with a "good 1." The value of $t_{P L H}$ can be calculated using usual techniques, where we expect that as a result of the additional current available from the PMOS device, for the same value of $C, t_{P L H}$ will be lower than in the case of the single NMOS switch. Note, however, that adding the PMOS transistor increases the value of $C$.

When $v_{I}$ goes low, as shown in Fig. 15.21(b), $Q_{N}$ and $Q_{P}$ interchange roles. Analysis of the circuit in Fig. 15.21(b) will indicate that $Q_{P}$ will cease conduction when $v_{O}$ falls to $\left|V_{i p}\right|$, where $\left|V_{i p}\right|$ is given by

$$
\left|V_{i p}\right|=V_{t 0}+\gamma\left[\sqrt{V_{D D}-v_{O}+2 \phi_{f}}-\sqrt{2 \phi_{f}}\right]
$$

Transistor $Q_{N}$, however, continues to conduct until $C$ is fully discharged and $v_{O}=V_{O L}=0 \mathrm{~V}$, a "good 0 ."

We conclude that transmission gates provide far superior performance, both static and dynamic, than is possible with single NMOS switches. The price paid is increased circuit complexity, area, and capacitance.# EXERCISE 

15.9 The transmission gate of Fig. 15.21(a) and 15.21(b) is fabricated in a CMOS process technology for which $k_{u}^{\prime}=50 \mu \mathrm{~A} / \mathrm{V}^{2}, k_{p}^{\prime}=20 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{m}=\left|V_{i p}\right|, V_{i 0}=1 \mathrm{~V}, \gamma=0.5 \mathrm{~V}^{1 / 2}, 2 \phi_{f}=0.6 \mathrm{~V}$, and $V_{D D}=5 \mathrm{~V}$. Let $Q_{N}$ and $Q_{P}$ be of the minimum size possible with this process technology, $(W / L)_{u}=$ $(W / L)_{p}=4 \mu \mathrm{~m} / 2 \mu \mathrm{~m}$. The total capacitance at the output node is 70 fF . Utilize as many of the results of Example 15.3 as you need.
(a) What are the values of $V_{O H}$ and $V_{O L}$ ?
(b) For the situation in Fig. 15.21(a), find $i_{D N}(0), i_{D P}(0), i_{D N}\left(t_{P L H}\right), i_{D P}\left(t_{P L H}\right)$, and $t_{P L H}$.
(c) For the situation depicted in Fig. 15.21(b), find $i_{D N}(0), i_{D P}(0), i_{D N}\left(t_{P H L}\right), i_{D P}\left(t_{P H L}\right)$, and $t_{P H L}$. At what value of $v_{O}$ will $Q_{P}$ turn off?
(d) Find $t_{P}$.

Ans. (a) $5 \mathrm{~V}, 0 \mathrm{~V}$; (b) $800 \mu \mathrm{~A}, 320 \mu \mathrm{~A}, 50 \mu \mathrm{~A}, 275 \mu \mathrm{~A}, 0.24 \mathrm{~ns}$; (c) $800 \mu \mathrm{~A}, 320 \mu \mathrm{~A}, 688 \mu \mathrm{~A}, 20$ $\mu \mathrm{A}, 0.19 \mathrm{~ns}, 1.6 \mathrm{~V}$; (d) 0.22 ns

Equivalent Resistance of the Transmission Gate Although the transmission gate is capable of passing the full 1 and 0 levels to the load capacitance, it is not a perfect switch. In particular, the transmission gate has a finite on-resistance. It is useful for us to obtain an estimate for this resistance. It can, for instance, be used together with the load capacitance as an alternative means to determining propagation delay. This approach is particularly useful in situations involving a network of inverters and transmission gates, as we shall shortly see.

To obtain an estimate of the resistance of the transmission gate, we shall consider the situation in Fig. 15.21(a), where the transmission gate is on and is passing a high input $\left(V_{D D}\right)$ to the capacitor load. Transistor $Q_{N}$ operates in saturation until the output voltage $v_{O}$ reaches $\left(V_{D D}-V_{m}\right)$, at which time $Q_{N}$ turns off; thus,

$$
\begin{array}{lll}
i_{D N}=\frac{1}{2} k_{u}\left(V_{D D}-V_{m}-v_{O}\right)^{2} & \text { for } & v_{O} \leq V_{D D}-V_{m} \\
i_{D N}=0 & \text { for } & v_{O} \geq V_{D D}-V_{m}
\end{array}
$$

A gross estimate for the equivalent resistance of $Q_{N}$ can be obtained by dividing the voltage across it, $\left(V_{D D}-v_{O}\right)$, by $i_{D N}$, and neglecting the body effect, that is, assuming $V_{m}$ remains constant; thus,

$$
R_{N e q}=\frac{V_{D D}-v_{O}}{\frac{1}{2} k_{u}\left(V_{D D}-V_{m}-v_{O}\right)^{2}} \quad \text { for } \quad v_{O} \leq V_{D D}-V_{m}
$$

and

$$
R_{N e q}=\infty \quad \text { for } \quad v_{O} \geq V_{D D}-V_{m}
$$


Figure 15.22 Plot of the equivalent resistances of the two transistors of the transmission gate in Fig. 15.21(a) and the overall resistance $R_{T G}$ versus $v_{O}$. The data apply to the situation specified in Exercise 15.10.

Transistor $Q_{P}$ will operate in saturation until $v_{O}=\left|V_{i p}\right|$, after which it enters the triode region; thus,

$$
\begin{aligned}
& i_{D P}=\frac{1}{2} k_{p}\left(V_{D D}-\left|V_{i p}\right|\right)^{2} \quad \text { for } v_{O} \leq\left|V_{i p}\right| \\
& i_{D P}=k_{p}\left[\left(V_{D D}-\left|V_{i p}\right|\right)\left(V_{D D}-v_{O}\right)-\frac{1}{2}\left(V_{D D}-v_{O}\right)^{2}\right] \quad \text { for } v_{O} \geq\left|V_{i p}\right|
\end{aligned}
$$

A gross estimate for the resistance of $Q_{P}$ can be obtained by dividing the voltage across it, $\left(V_{D D}-v_{O}\right)$, by $i_{D P}$; thus,

$$
\begin{gathered}
R_{P \mathrm{eq}}=\frac{V_{D D}-v_{O}}{\frac{1}{2} k_{p}\left(V_{D D}-\left|V_{i p}\right|\right)^{2}} \quad \text { for } v_{O} \leq\left|V_{i p}\right| \\
R_{P \mathrm{eq}}=\frac{1}{k_{p}\left[V_{D D}-\left|V_{i p}\right|-\frac{1}{2}\left(V_{D D}-v_{O}\right)\right]} \quad \text { for } v_{O} \geq\left|V_{i p}\right|
\end{gathered}
$$

Finally, the equivalent resistance $R_{T G}$ of the transmission gate can be obtained as the parallel equivalent of $R_{N e q}$ and $R_{P e q}$,

$$
R_{T G}=R_{N e q} \| R_{P e q}
$$

Obviously, $R_{T G}$ is a function of the output voltage $v_{O}$. As an example, we show in Fig. 15.22 a plot for $R_{T G}$ for the transmission gate analyzed in Exercise 15.9. Observe that $R_{T G}$ remains relatively constant over the full range of $v_{O}$. The average value of $R_{T G}$ over the range $v_{O}=0$ to $V_{D D} / 2$ can be used to determine $t_{P L H}$, as illustrated in Exercise 15.10.
# EXERCISE 

15.10 For the transmission gate analyzed in Exercise 15.9, whose equivalent resistance for capacitor charging is plotted in Fig. 15.22, use the average resistance value over the range $v_{O}=0 \mathrm{~V}$ to 2.5 V to determine $t_{P L H}$. Compare the result to that obtained using average currents in Exercise 15.9. Note that from the graph, $R_{T G}=4.5 \mathrm{k} \Omega$ at $v_{O}=0 \mathrm{~V}$, and $R_{T G}=6.5 \mathrm{k} \Omega$ at $v_{O}=2.5 \mathrm{~V}$. Recall that $t_{P L H}=0.69 R C$. Ans. $t_{P L H}=0.27 \mathrm{~ns}$, very close to the value of 0.24 ns obtained in Exercise 15.9

The expression for $R_{T G}$ derived above applies only to the case of capacitor charging. A similar analysis can be performed for the case of capacitor discharge illustrated in Fig. 15.21(b). The resulting value of $R_{T G}$ is close to that obtained above (see Problem 15.38).

Similar to the empirical formulas for $R_{N}$ and $R_{P}$ of the CMOS inverter (Eqs. 14.56 and 14.57), there is a simple empirical formula for $R_{T G}$ that applies for both capacitor charging and discharging and for all modern submicron technologies (see Hodges et al., 2004), namely,

$$
R_{T G} \simeq \frac{12.5}{(W / L)_{n}} \mathrm{k} \Omega
$$

## EXERCISE

15.11 Use Eq. (15.49) to estimate the value of $R_{T G}$ for a transmission gate fabricated in a $0.18-\mu \mathrm{m}$ CMOS technology with $(W / L)_{n}=(W / L)_{p}=1.5$.
Ans. $8.3 \mathrm{k} \Omega$

Having an estimate of the resistance of the transmission gate enables us to calculate the propagation delay of a signal path containing one or more transmission gates. Figure 15.23(a) shows one such circuit. It consists of a transmission gate connecting the output of an inverter to the input of another. We are interested in finding the propagation delay from the input of the first inverter to the input of the second as we apply a negative-going step to the input of the first inverter.

Fig. 15.23(b) shows the equivalent circuit where $R_{P 1}$ is the equivalent resistance of $Q_{P 1}$, $R_{T G}$ is the equivalent resistance of the transmission gate, $C_{\text {out } 1}$ is the output capacitance of the driver inverter, $C_{T G 1}$ and $C_{T G 2}$ are the capacitances introduced by the transmission gate at its input and output, respectively, and $C_{\text {in } 2}$ is the input capacitance of the load inverter. Observe that the circuit takes the form of an $R C$ ladder network. A simple formula has been developed for calculating the delay of an arbitrarily long $R C$ ladder network such as that shown in Fig. 15.24 having three sections. Known as the Elmore delay formula, it gives for the ladder in Fig. 15.24

$$
t_{P}=0.69\left[C_{1} R_{1}+C_{2}\left(R_{1}+R_{2}\right)+C_{3}\left(R_{1}+R_{2}+R_{3}\right)\right]
$$

(a)

(b)

Figure 15.23 (a) A transmission gate connects the output of a CMOS inverter to the input of another. (b) Equivalent circuit for the purpose of analyzing the propagation delay of the circuit in (a).


Figure 15.24 A three-section $R C$ ladder network.

Applying the Elmore formula to the two-stage ladder in Fig. 15.23(b) gives

$$
t_{P}=0.69\left[\left(C_{\text {out } 1}+C_{T G 1}\right) R_{P 1}+\left(C_{\text {in } 2}+C_{T G 2}\right)\left(R_{P 1}+R_{T G}\right)\right]
$$

Finally, the factor 0.69 is usually dropped on the assumption that the input is a ramp rather than a step voltage.
# EXERCISE 

15.12 The circuit in Fig. 15.23 is fabricated in a $0.13-\mu \mathrm{m}$ CMOS technology; $Q_{P}$ of the first inverter has $W / L=2$, and both transistors of the transmission gate have $W / L=1$. The capacitances have been estimated to be $C_{\text {out } 1}=10 \mathrm{fF}, C_{T G 1}=C_{T G 2}=5 \mathrm{fF}$, and $C_{\text {in } 2}=10 \mathrm{fF}$. Use the empirical formulas to obtain the values of $R_{P 1}$ and $R_{T G}$. Then, determine an estimate for $t_{P}$ assuming a ramp input. Ans. $R_{P 1}=15 \mathrm{k} \Omega ; R_{T G}=12.5 \mathrm{k} \Omega ; t_{P}=0.64 \mathrm{~ns}$

### 15.4.5 Examples of Pass-Transistor Logic Circuits

We conclude this section by showing examples of PTL logic circuits. Figure 15.25 shows a PTL realization of a two-to-one multiplexer: Depending on the logic value of $C$, either $A$ or $B$ is connected to the output $Y$. The circuit realizes the Boolean function

$$
Y=C A+\bar{C} B
$$

Our second example is an efficient realization of the exclusive-OR (XOR) function. The circuit, shown in Fig. 15.26, utilizes four transistors in the transmission gates and another four for the two inverters needed to generate the complements $\bar{A}$ and $\bar{B}$, for a total of eight transistors. Note that 12 transistors are needed in the realization with standard CMOS.


Figure 15.25 Realization of a two-to-one multiplexer using pass-transistor logic.


Figure 15.26 Realization of the XOR function using pass-transistor logic.


Figure 15.27 An example of a pass-transistor logic gate utilizing both the input variables and their complements. This type of circuit is therefore known as complementary pass-transistor logic, or CPL. Note that both the output function and its complement are generated.

Our final PTL example is the circuit shown in Fig. 15.27. It uses NMOS switches with low or zero threshold. Observe that both the input variables and their complements are employed and that the circuit generates both the Boolean function and its complement. Thus this form of circuit is known as complementary pass-transistor logic (CPL). The circuit consists of two identical networks of pass transistors with the corresponding transistor gates controlled by the same signal $(B$ and $\bar{B})$. The inputs to the PTL, however, are complemented: $A$ and $B$ for the first network, and $\bar{A}$ and $\bar{B}$ for the second. The circuit shown realizes both the AND and NAND functions.
# EXERCISE 

15.13 Consider the circuit in Fig. 15.27, and for each case, find $Y$ and $\bar{Y}$. The input signals are changed as follows:
(a) The signals at terminals 5 and 6 are interchanged ( $\bar{B}$ applied to 5 and $B$ applied to 6 ). All the rest are the same.
(b) The signals at terminals 5 or 6 are interchanged as in (a), and the signals at 2 and 4 are changed to $\bar{A}$ and $A$, respectively. All the rest remain the same.
Ans. (a) $Y=A+B, \bar{Y}=\overline{A B}=\overline{A+B}$ (i.e., OR-NOR); (b) $Y=A \bar{B}+\bar{A} B, \bar{Y}=\overline{A B}+A B$ (i.e., XOR-XNOR)

### 15.4.6 A Final Remark

Although the use of zero-threshold devices solves the problem of the loss of signal levels when NMOS switches are used, the resulting circuits can be much more sensitive to noise and other effects, such as leakage currents resulting from subthreshold conduction.

## A 15.5 Dynamic MOS Logic Circuits

The logic circuits that we have studied thus far are of the static type. In a static logic circuit, every node has, at all times, a low-resistance path to $V_{O D}$ or ground. By the same token, the voltage of each node is well defined at all times, and no node is left floating. Static circuits do not need clocks (i.e., periodic timing signals) for their operation, although clocks may be present for other purposes. In contrast, the dynamic logic circuits we are about to discuss rely on the storage of signal voltages on parasitic capacitances at certain circuit nodes. Since charge will leak away with time, the circuits need to be periodically refreshed; thus the presence of a clock with a certain specified minimum frequency is essential.

To place dynamic logic-circuit techniques into perspective, let's take stock of the various styles we have studied for logic circuits. Standard CMOS excels in nearly every performance category: It is easy to design, has the maximum possible logic swing, is robust from a noise-immunity standpoint, dissipates no static power, and can be designed to provide equal low-to-high and high-to-low propagation delays. Its main disadvantage is the requirement of two transistors for each additional gate input, which for high fan-in gates can make the chip area large and increase the total capacitance and, correspondingly, the propagation delay and the dynamic power dissipation. Pseudo-NMOS reduces the number of required transistors at the expense of static power dissipation. Pass-transistor logic can result in simple small-area circuits but is limited to special applications and requires the use of CMOS inverters to restore signal levels, especially when the switches are simple NMOS transistors. The dynamic logic techniques studied in this section maintain the low device count of pseudo-NMOS while reducing the static power dissipation to zero. As will be seen, this is achieved at the expense of more complex, and less robust, design.
# 15.5.1 The Basic Principle 

Figure 15.28(a) shows the basic dynamic logic gate. It consists of a pull-down network (PDN) that realizes the logic function in exactly the same way as the PDN of a standard CMOS gate or a pseudo-NMOS gate. Here, however, we have two switches in series that are periodically operated by the clock signal $\phi$ whose waveform is shown in Fig. 15.28(b). When $\phi$ is low, $Q_{p}$ is turned on, and the circuit is said to be in the setup or precharge phase. When $\phi$ is high, $Q_{p}$ is off and $Q_{e}$ turns on, and the circuit is in the evaluation phase. Finally, note that $C_{L}$ denotes the total capacitance between the output node and ground.

During precharge, $Q_{p}$ conducts and charges capacitance $C_{L}$ so that at the end of the precharge interval, the voltage at $Y$ is equal to $V_{D D}$. Also during precharge, the inputs $A, B$, and $C$ are allowed to change and settle to their proper values. Observe that because $Q_{e}$ is off, no path to ground exists.

During the evaluation phase, $Q_{p}$ is off and $Q_{e}$ is turned on. Now, if the input combination is one that corresponds to a high output, the PDN does not conduct ( just as in a standard CMOS gate) and the output remains high at $V_{D D}$; thus $V_{D H}=V_{D D}$. Observe that no low-to-high propagation delay is required, thus $t_{P L H}=0$. On the other hand, if the combination of inputs is one that corresponds to a low output, the appropriate NMOS transistors in the PDN will conduct and establish a path between the output node and ground through the on transistor $Q_{e}$. Thus $C_{L}$ will be discharged through the PDN, and the voltage at the output node will reduce to $V_{O L}=0 \mathrm{~V}$. The high-to-low propagation delay $t_{P H L}$ can be calculated in exactly the same way as for a standard CMOS circuit, except that here we have an additional transistor, $Q_{e}$, in the series path to ground. Although this will increase the delay slightly, the increase will be more than offset by the reduced capacitance at the output node as a result of the absence of the PUN.

As an example, we show in Fig. 15.28(c) the circuit that realizes the function $Y=\overline{A+B C}$. Sizing of the PDN transistors often follows the same procedure employed in the design


Figure 15.28 (a) Basic structure of dynamic MOS logic circuits. (b) Waveform of the clock needed to operate the dynamic logic circuit. (c) An example circuit.
of static CMOS. For $Q_{p}$, we select a $W / L$ ratio large enough to ensure that $C_{L}$ will be fully charged during the precharge interval, but small enough so that the capacitance $C_{L}$ will not be increased significantly. This is a ratioless form of MOS logic, where the output levels do not depend on the transistors' $W / L$ ratios (unlike pseudo-NMOS, for instance).

# Example 15.4 

Consider the four-input, dynamic logic NAND gate shown in Fig. 15.29(a). Assume that the gate is fabricated in a $0.18-\mu \mathrm{m}$ CMOS technology for which $V_{D D}=1.8 \mathrm{~V}, V_{i}=0.5 \mathrm{~V}$, and $\mu_{u} C_{o s}=4 \mu_{p} C_{o s}=$ $300 \mu \mathrm{~A} / \mathrm{V}^{2}$. To keep $C_{L}$ small, NMOS devices with $W / L=0.27 \mu \mathrm{~m} / 0.18 \mu \mathrm{~m}$ are used (including transistor $Q_{e}$ ). The PMOS precharge transistor $Q_{p}$ has $W / L=0.54 \mu \mathrm{~m} / 0.18 \mu \mathrm{~m}$. The total capacitance $C_{L}$ is found to be 20 fF .
(a) Consider the precharge operation [Fig. 15.29(b)] with the gate of $Q_{p}$ at 0 V , and assume that at $t=0$, $C_{L}$ is fully discharged. Calculate the rise time of the output voltage, defined as the time for $v_{Y}$ to rise from $10 \%$ to $90 \%$ of the final voltage $V_{D D}$.
(b) For $A=B=C=D=1$, find the value of $t_{P H L}$.


Figure 15.29 Circuits for Example 15.4.
# Solution 

(a) From Fig. 15.29(b) we see that at $v_{Y}=0.1 V_{D D}=0.18 \mathrm{~V}, Q_{p}$ will be operating in the saturation region and $i_{D}$ will be

$$
\begin{aligned}
i_{D}\left(0.1 V_{D D}\right) & =\frac{1}{2} \mu_{p} C_{\mathrm{ss}}\left(\frac{W}{L}\right)_{p}\left(V_{D D}-\left|V_{\varphi}\right|\right)^{2} \\
& =\frac{1}{2} \times 75 \times \frac{0.54}{0.18}(1.8-0.5)^{2} \\
& =190.1 \mu \mathrm{~A}
\end{aligned}
$$

At $v_{Y}=0.9 V_{D D}=1.62 \mathrm{~V}, Q_{p}$ will be operating in the triode region; thus,

$$
\begin{aligned}
i_{D}\left(0.9 V_{D D}\right) & =\mu_{p} C_{\mathrm{ss}}\left(\frac{W}{L}\right)_{p}\left[\left(V_{D D}-\left|V_{\varphi}\right|\right)\left(V_{D D}-0.9 V_{D D}\right)-\frac{1}{2}\left(V_{D D}-0.9 V_{D D}\right)^{2}\right] \\
& =75 \times \frac{0.54}{0.18}\left[(1.8-0.5)(1.8-1.62)-\frac{1}{2}(1.8-1.62)^{2}\right] \\
& =49 \mu \mathrm{~A}
\end{aligned}
$$

Thus the average capacitor charging current is

$$
I_{\mathrm{av}}=\frac{1}{2}(190.1+49)=119.6 \mu \mathrm{~A}
$$

The rise time $t_{r}$ of $v_{Y}$ can now be determined from

$$
\begin{aligned}
t_{r} & =\frac{C \Delta v_{Y}}{I_{\mathrm{av}}} \\
& =\frac{C\left(0.9 V_{D D}-0.1 V_{D D}\right)}{I_{\mathrm{av}}}
\end{aligned}
$$

Thus,

$$
t_{r}=\frac{20 \times 10^{-15} \times 0.8 \times 1.8}{119.6 \times 10^{-6}}=0.24 \mathrm{~ns}
$$

(b) When $A=B=C=D=1$, all the NMOS transistors will be conducting during the evaluation phase. Replacing the five identical transistors with an equivalent device $Q_{\mathrm{eq}}$ with $(W / L)_{\mathrm{eq}}=\frac{1}{2}(W / L)=\frac{1}{3} \times 1.5=$ 0.3 , we obtain the equivalent circuit for the capacitor discharge, shown in Fig. 15.29(c). At $v_{Y}=V_{D D}$, $Q_{\text {eq }}$ will be operating in saturation; thus,

$$
\begin{aligned}
i_{D}\left(V_{D D}\right) & =\frac{1}{2}\left(\mu_{n} C_{\mathrm{ss}}\right)\left(\frac{W}{L}\right)_{\mathrm{eq}}\left(V_{D D}-V_{i}\right)^{2} \\
& =\frac{1}{2} \times 300 \times 0.3(1.8-0.5)^{2} \\
& =76.1 \mu \mathrm{~A}
\end{aligned}
$$# Example 15.4 continued 

At $v_{T}=V_{D D} / 2, Q_{o \mathrm{q}}$ will be operating in the triode region, thus,

$$
\begin{aligned}
i_{D}\left(V_{D D} / 2\right) & =\left(\mu_{w} C_{o s}\right)\left(\frac{W}{L}\right)_{o \mathrm{q}}\left[\left(V_{D D}-V_{i}\right) \frac{V_{D D}}{2}-\frac{1}{2}\left(\frac{V_{D D}}{2}\right)^{2}\right] \\
& =300 \times 0.3\left[(1.8-0.5)\left(\frac{1.8}{2}\right)-\frac{1}{2}\left(\frac{1.8}{2}\right)^{2}\right] \\
& =68.9 \mu \mathrm{~A}
\end{aligned}
$$

Thus the average capacitor-discharge current is

$$
I_{a v}=\frac{76.1+68.9}{2}=72.5 \mu \mathrm{~A}
$$

and $t_{P H L}$ can be found from

$$
\begin{aligned}
t_{P H L} & =\frac{C\left(V_{D D}-V_{D D} / 2\right)}{I_{a v}} \\
& =\frac{20 \times 10^{-15}(1.8-0.9)}{72.5 \times 10^{-6}}=0.25 \mathrm{~ns}
\end{aligned}
$$

## EXERCISE

15.14 In an attempt to reduce $t_{P H L}$ of the NAND gate in Example 15.4, the designer doubles the value of $W / L$ of each of the NMOS devices. If $C$ increases to 30 fF , what is the new value of $t_{P H L}$ ? Ans. 0.19 ns

### 15.5.2 Nonideal Effects

We now briefly consider various sources of nonideal operation of dynamic logic circuits.
Noise Margins Since, during the evaluation phase, the NMOS transistors begin to conduct for $v_{I}=V_{m}$,

$$
V_{I L} \simeq V_{I H} \simeq V_{m}
$$
## GRAND-SCALE GRAPHICS:

IC chips for specialized graphics processing achieve new levels of integration. Among recent announcements from Nividia is a graphics chip (GPU) incorporating 7.1 billion MOS transistors on a $551-\mathrm{mm}^{2}$ die in 28 -nm CMOS technology from Taiwan Semiconductor Manufacturing Company (TSMC). Besides gaming and graphics, live-streaming video and other applications abound.
and thus the noise margins will be

$$
\begin{aligned}
& N M_{L}=V_{I L}-V_{O L}=V_{m}-0=V_{m} \\
& N M_{H}=V_{O H}-V_{I H}=V_{D D}-V_{m}
\end{aligned}
$$

Thus the noise margins are far from equal, and $N M_{L}$ is rather low. Although $N M_{H}$ is high, other nonideal effects reduce its value, as we shall shortly see. At this time, however, observe that the output node is a high-impedance node and thus will be susceptible to noise pickup and other disturbances.

Output Voltage Decay due to Leakage Effects In the absence of a path to ground through the PDN, the output voltage will ideally remain high at $V_{D D}$. This, however, is based on the assumption that the charge on $C_{L}$ will remain intact. In practice, there will be leakage current that will cause $C_{L}$ to slowly discharge and $v_{Y}$ to decay. The principal source of leakage is the reverse current of the reverse-biased junction between the drain diffusion of transistors connected to the output node and the substrate. Such currents can be in the range of $10^{-12} \mathrm{~A}$ to $10^{-15} \mathrm{~A}$, and they increase rapidly with temperature (approximately doubling for every $10^{\circ} \mathrm{C}$ rise in temperature). Thus the circuit can malfunction if the clock is operating at a very low frequency and the output node is not "refreshed" periodically. This exact same point will be encountered when we study dynamic memory cells in Chapter 16.

Charge Sharing There is another and often more serious way for $C_{L}$ to lose some of its charge and thus cause $v_{Y}$ to fall significantly below $V_{D D}$. To see how this can happen, refer to Fig. 15.30(a), which shows only $Q_{1}$ and $Q_{2}$, the two top transistors of the PDN, together with the precharge transistor $Q_{p}$. Here, $C_{1}$ is the capacitance between the common node of $Q_{1}$ and $Q_{2}$ and ground. At the beginning of the evaluation phase, after $Q_{p}$ has turned off and with $C_{L}$ charged to $V_{D D}$ [Fig. 15.30(a)], we assume that $C_{1}$ is initially discharged and that the inputs are such that at the gate of $Q_{1}$ we have a high signal, whereas at the gate of $Q_{2}$ the signal is low. We can easily see that $Q_{1}$ will turn on and its drain current, $i_{D 1}$, will flow as indicated. Thus $i_{D 1}$ will discharge $C_{L}$ and charge $C_{1}$. Although eventually $i_{D 1}$ will reduce to zero, $C_{L}$ will have lost some of its charge, which will have been transferred to $C_{1}$. This phenomenon is known as charge sharing (see Problem 15.49).

We shall not pursue the problem of charge sharing any further here, except to point out a couple of the techniques usually employed to minimize its effect. One approach involves adding a $p$-channel device that continuously conducts a small current to replenish the charge lost by $C_{L}$, as shown in Fig. 15.30(b). This arrangement should remind us of pseudo-NMOS. Indeed, adding this transistor will cause the gate to dissipate static power. On the positive side, however, the added transistor will lower the impedance level of the output node and make it less susceptible to noise and will solve the leakage and charge-sharing problems. Another approach to solving the charge-sharing problem is to precharge the internal nodes: that is, to


Figure 15.30 (a) Charge sharing. (b) Adding a permanently turned-on transistor $Q_{L}$ solves the charge-sharing problem at the expense of static power dissipation.


Figure 15.31 Two single-input dynamic logic gates connected in cascade. With the input $A$ high, during the evaluation phase $C_{L 2}$ will partially discharge and the output at $Y_{2}$ will fall lower than $V_{D D}$, which can cause logic malfunction.
precharge capacitor $C_{1}$. The price paid in this case is increased circuit complexity and node capacitances.

Clock Feedthrough Another problem can arise when the PDN remains off during the evaluation phase. As $\phi$ rises and turns off $Q_{p}$, the output node $Y$ becomes a floating node. However, $Y$ is capacitively coupled to $\phi$ through $C_{g d}$ of $Q_{p}$, and hence the clock signal $\phi$ can cause a slight rise in output voltage.
Cascading Dynamic Logic Gates A serious problem arises if one attempts to cascade dynamic logic gates. Consider the situation depicted in Fig. 15.31, where two single-input dynamic gates are connected in cascade. During the precharge phase, $C_{L 1}$ and $C_{L 2}$ will be charged through $Q_{p 1}$ and $Q_{p 2}$, respectively. Thus, at the end of the precharge interval, $v_{Y 1}=V_{D D}$ and $v_{Y 2}=V_{D D}$. Now consider what happens in the evaluation phase for the case of high input $A$. Obviously, the correct result will be $Y_{1}$ low $\left(v_{Y 1}=0 \mathrm{~V}\right)$ and $Y_{2}$ high $\left(v_{Y 2}=V_{D D}\right)$. What happens, however, is somewhat different. As the evaluation phase begins, $Q_{1}$ turns on and $C_{L 1}$ begins to discharge. However, simultaneously, $Q_{2}$ turns on and $C_{L 2}$ also begins to discharge. Only when $v_{Y 1}$ drops below $V_{t w}$ will $Q_{2}$ turn off. Unfortunately, however, by that time, $C_{L 2}$ will have lost a significant amount of its charge, and $v_{Y 2}$ will be less than the expected value of $V_{D D}$. (Here it is important to note that in dynamic logic, once charge has been lost, it cannot be recovered.) This problem is sufficiently serious to make simple cascading an impractical proposition. As usual, however, the ingenuity of circuit designers has come to the rescue, and a number of schemes have been proposed to make cascading possible in dynamic logic circuits. We shall discuss one such scheme after considering Exercise 15.15 .

# EXERCISE 

15.15 To gain further insight into the cascading problem described above, let us determine the decrease in the output voltage $v_{Y 2}$ for the circuit in Fig. 15.31. Specifically, consider the circuit as the evaluation phase begins: At $t=0, v_{Y 1}=v_{Y 2}=V_{D D}$ and $v_{R}=v_{A}=V_{D D}$. Transistors $Q_{p 1}$ and $Q_{p 2}$ are cut off and can be removed from the equivalent circuit. Furthermore, for the purpose of this approximate analysis, we can replace the series combination of $Q_{1}$ and $Q_{c 1}$ with a single device having an appropriate $W / L$, and similarly for the combination of $Q_{2}$ and $Q_{c 2}$. The result is the approximate equivalent circuit in Fig. E15.15. We are interested in the operation of this circuit in the interval $\Delta t$ during which $v_{Y 1}$ falls from $V_{D D}$ to $V_{t}$, at which time $Q_{\text {eq } 2}$ turns off and $C_{L 2}$ stops discharging. Assume that the process technology has the parameter values specified in Example 15.4 and that for all NMOS transistors in the circuit of Fig. 15.31, $W / L=4 \mu \mathrm{~m} / 2 \mu \mathrm{~m}$ and $C_{L 1}=C_{L 2}=40 \mathrm{fF}$.


Figure E15.15
(a) Find $(W / L)_{\text {eq1 }}$ and $(W / L)_{\text {eq2 }}$.
(b) Find the values of $i_{D 1}$ at $v_{Y 1}=V_{D D}$ and at $v_{Y 1}=V_{t}$. Hence determine an average value for $i_{D 1}$.
(c) Use the average value of $i_{D 1}$ found in (b) to determine an estimate for the interval $\Delta t$.
(d) Find the average value of $i_{D 2}$ during $\Delta t$. To simplify matters, take the average to be the value of $i_{D 2}$ obtained when the gate voltage $v_{Y 1}$ is midway through its excursion (i.e., $v_{Y 1}=3 \mathrm{~V}$ ). (Hint: $Q_{\text {eq1 }}$ will remain in saturation.)
(e) Use the value of $\Delta t$ found in (c) together with the average value of $i_{D 2}$ determined in (d) to find an estimate of the reduction in $v_{Y 2}$ during $\Delta t$. Hence determine the final value of $v_{Y 2}$.
Ans. (a) 1, 1; (b) $400 \mu \mathrm{~A}$ and $175 \mu \mathrm{~A}$, for an average value of $288 \mu \mathrm{~A}$; (c) 0.56 ns ; (d) $100 \mu \mathrm{~A}$;
(e) $\Delta v_{Y 2}=1.4 \mathrm{~V}$, thus $v_{Y 2}$ decreases to 3.6 V

# 15.5.3 Domino CMOS Logic 

Domino CMOS logic is a form of dynamic logic that results in cascadable gates. Figure 15.32 shows the structure of the Domino CMOS logic gate. We observe that it is simply the basic dynamic logic gate of Fig. 15.28(a) with a static CMOS inverter connected to its output. Operation of the gate is straightforward. During precharge, $X$ will be raised to $V_{D D}$, and the gate output $Y$ will be at 0 V . During evaluation, depending on the combination of input variables, either $X$ will remain high and thus the output $Y$ will remain low $\left(t_{P H L}=0\right)$ or $X$ will be brought down to 0 V and the output $Y$ will rise to $V_{D D}$ ( $t_{P L H}$ finite). Thus, during evaluation, the output either remains low or makes only one low-to-high transition.

To see why Domino CMOS gates can be cascaded, consider the situation in Fig. 15.33(a), where we show two Domino gates connected in cascade. For simplicity, we show single-input gates. At the end of precharge, $X_{1}$ will be at $V_{D D}, Y_{1}$ will be at $0 \mathrm{~V}, X_{2}$ will be at $V_{D D}$, and $Y_{2}$ will be at 0 V . As in the preceding case, assume that $A$ is high at the beginning of evaluation. Thus, as $\phi$ goes up, capacitor $C_{L 1}$ will begin discharging, pulling $X_{1}$ down. Meanwhile, the low input at the gate of $Q_{2}$ keeps $Q_{2}$ off, and $C_{L 2}$ remains fully charged. When $v_{X 1}$ falls below the threshold voltage of inverter $I_{1}, Y_{1}$ will go up, turning $Q_{2}$ on, which in turn begins to discharge $C_{L 2}$ and pulls $X_{2}$ low. Eventually, $Y_{2}$ rises to $V_{D D}$.

From this description, we see that because the output of the Domino gate is low at the beginning of evaluation, no premature capacitor discharge will occur in the subsequent gate in


Figure 15.32 The Domino CMOS logic gate. The circuit consists of a dynamic MOS logic gate with a static CMOS inverter connected to the output. During evaluation, $Y$ either will remain low (at 0 V ) or will make one 0 -to-1 transition (to $V_{D D}$ ).


Figure 15.33 (a) Two single-input Domino CMOS logic gates connected in cascade. (b) Waveforms during the evaluation phase.
the cascade. As indicated in Fig. 15.33(b), output $Y_{1}$ will make a 0 -to-1 transition $t_{P L H}$ seconds after the rising edge of the clock. Subsequently, output $Y_{2}$ makes a 0 -to-1 transition after another $t_{P L H}$ interval. The propagation of the rising edge through a cascade of gates resembles contiguously placed dominoes falling over, each toppling the next, which is the origin of the name Domino CMOS logic. Domino CMOS logic finds application in the design of address decoders in memory chips, for example.

# 15.5.4 Concluding Remarks 

Dynamic logic presents many challenges to the circuit designer. Although it can provide high-speed operation, as well as considerable reduction in the chip-area requirement and zero (or little) static power dissipation, the circuits are prone to many nonideal effects, some of which have been discussed here. It should also be remembered that dynamic power dissipation is an important issue in dynamic logic. Another factor that should be considered is the "dead time" during precharge when the output of the circuit is not yet available.

### 15.6 Bipolar and BiCMOS Logic Circuits

As mentioned earlier, the use of the BJT in designing digital logic circuits has diminished considerably. At the present time, only one type of bipolar logic circuit is still in use, albeit
for specialized applications. This is emitter-coupled logic (ECL), which we very briefly study here. As well, we shall take a brief look at a digital circuit technology that combines bipolar and CMOS and is aptly named BiCMOS.

# 15.6.1 Emitter-Coupled Logic (ECL) 

Emitter-coupled logic (ECL) is the fastest logic-circuit family available for conventional logic-system design. ${ }^{6}$ High speed is achieved by operating all bipolar transistors out of saturation, thus avoiding storage-time delays, and by keeping the logic signal swings relatively small (about 0.8 V or less), thus reducing the time required to charge and discharge the various load and parasitic capacitances. Saturation in ECL is avoided by using the BJT differential pair as a current switch. The BJT differential pair was studied in Chapter 9, and we urge the reader to review the introduction given in Section 9.2 before proceeding with the study of ECL.

The Basic Principle Emitter-coupled logic is based on the use of the current-steering switch introduced in Section 14.2 (Fig. 14.19). Such a switch can be most conveniently realized using the differential pair shown in Fig. 15.34. The pair is biased with a constant-current source $I$, and one side is connected to a reference voltage $V_{R}$. As shown in Section 9.2, the current $I$ can be steered to either $Q_{1}$ or $Q_{2}$ under the control of the input signal $v_{I}$. Specifically, when $v_{I}$ is greater than $V_{R}$ by about $4 V_{T}(\simeq 100 \mathrm{mV})$, nearly all the current $I$ is conducted by $Q_{1}$, and thus for $\alpha_{1} \simeq 1, v_{O 1}=V_{C C}-I R_{C}$. Simultaneously, the current through $Q_{2}$ will be nearly zero, and thus $v_{O 2}=V_{C C}$. Conversely, when $v_{I}$ is lower than $V_{R}$ by about $4 V_{T}$, most of the current


Figure 15.34 The basic element of ECL is the differential pair. Here, $V_{R}$ is a reference voltage.

[^0]
[^0]:    ${ }^{6}$ Higher speeds of operation can be obtained with gallium arsenide (GaAs) circuits; these, however, are not available as off-the-shelf components for conventional digital system design. GaAs digital circuits are not covered in this book; however, a substantial amount of material on this subject can be found on the book's website.
$I$ will flow through $Q_{2}$ and the current through $Q_{1}$ will be nearly zero. Thus $v_{O 1}=V_{C C}$ and $v_{O 2}=V_{C C}-I R_{C}$.

The preceding description suggests that as a logic element, the differential pair realizes an inversion function at $v_{O 1}$ and simultaneously provides the complementary output signal at $v_{O 2}$. The output logic levels are $V_{O H}=V_{C C}$ and $V_{O L}=V_{C C}-I R_{C}$, and thus the output logic swing is $I R_{C}$. A number of additional remarks can be made concerning this circuit:

1. The differential nature of the circuit makes it less susceptible to picked-up noise. In particular, an interfering signal will tend to affect both sides of the differential pair similarly and thus will not result in current switching. This is the common-mode rejection property of the differential pair (see Section 9.2).
2. The current drawn from the power supply remains constant during switching. Thus, unlike CMOS (and TTL), no supply current spikes occur in ECL, eliminating an important source of noise in digital circuits. This is a definite advantage, especially since ECL is usually designed to operate with small signal swings and has correspondingly low noise margins.
3. The output signal levels are both referenced to $V_{C C}$ and thus can be made particularly stable by operating the circuit with $V_{C C}=0$ : in other words, by utilizing a negative power supply and connecting the $V_{C C}$ line to ground. In this case, $V_{O H}=0$ and $V_{O L}=-I R_{C}$
4. Some means must be provided to make the output signal levels compatible with those at the input so that one gate can drive another. Practical ECL gate circuits incorporate a level-shifting arrangement that serves to center the output signal levels on the value of $V_{R}$.
5. The availability of complementary outputs considerably simplifies logic design with ECL.

# EXERCISE 

15.16 For the circuit in Fig. 15.34, let $V_{C C}=0, I=4 \mathrm{~mA}, R_{C}=220 \Omega, V_{R}=-1.32 \mathrm{~V}$, and assume $\alpha \simeq 1$. Determine $V_{O H}$ and $V_{O L}$. By how much should the output levels be shifted so that the values of $V_{O H}$ and $V_{O L}$ become centered on $V_{R}$ ? What will the shifted values of $V_{O H}$ and $V_{O L}$ be? Ans. $0 ;-0.88 \mathrm{~V} ;-0.88 \mathrm{~V} ;-0.88 \mathrm{~V},-1.76 \mathrm{~V}$

The Basic Gate Circuit The basic gate circuit of a particular ECL logic-circuit family, known as ECL 10K, is shown in Fig. 15.35. The circuit consists of three parts. The network composed of $Q_{1}, D_{1}, D_{2}, R_{1}, R_{2}$, and $R_{3}$ generates a reference voltage $V_{R}$ whose value at room temperature is -1.32 V . It can be shown that the value of this reference voltage changes with temperature in a predetermined manner, keeping the noise margins almost constant. Also, the reference voltage $V_{R}$ is made relatively insensitive to variations in the power-supply voltage $V_{E E}$.


Figure 15.35 Basic circuit of the ECL 10K logic-gate family.
# EXERCISE 

15.17 Figure E15.17 shows the circuit that generates the reference voltage $V_{R}$. Assuming that the voltage drop across each of $D_{1}, D_{2}$, and the base-emitter junction of $Q_{1}$ is 0.75 V , calculate the value of $V_{R}$. Neglect the base current of $Q_{1}$.


Figure E15.17

Ans. -1.32 V

The second part, and the heart of the gate, is the differential amplifier formed by $Q_{R}$ and either $Q_{A}$ or $Q_{B}$. This differential amplifier is biased not by a constant-current source, as was done in the circuit of Fig. 15.34, but with a resistance $R_{E}$ connected to the negative supply $-V_{E E}$. Nevertheless, it can be shown that the current in $R_{E}$ remains approximately constant over the normal range of operation of the gate. One side of the differential amplifier consists of the reference transistor $Q_{R}$, whose base is connected to the reference voltage $V_{R}$. The other side consists of a number of transistors (two in the case shown), connected in parallel, with separated bases, each connected to a gate input. If the voltages applied to $A$ and $B$ are at the logic- 0 level, which is about 0.4 V below $V_{R}$, both $Q_{A}$ and $Q_{B}$ will be off and the current $I_{E}$ in $R_{E}$ will flow through the reference transistor $Q_{R}$. The resulting voltage drop across $R_{C 2}$ will cause the collector voltage of $Q_{R}$ to be low.

On the other hand, when the voltage applied to $A$ or $B$ is at the logic-1 level, which is about 0.4 V above $V_{R}$, transistor $Q_{A}$ or $Q_{B}$, or both, will be on and $Q_{R}$ will be off. Thus the current $I_{E}$ will flow through $Q_{A}$ or $Q_{B}$, or both, and an almost equal current will flow through $R_{C 1}$. The resulting voltage drop across $R_{C 1}$ will cause the collector voltage to drop. Meanwhile, since $Q_{R}$ is off, its collector voltage rises. We thus see that the voltage at the collector of $Q_{R}$ will be high if $A$ or $B$, or both, is high, and thus at the collector of $Q_{R}$, the OR logic function, $A+B$, is realized. On the other hand, the common collector of $Q_{A}$ and $Q_{B}$ will be high only when $A$ and $B$ are simultaneously low. Thus at the common collector of $Q_{A}$ and $Q_{B}$, the logic function$\overline{A B}=\overline{A+B}$ is realized. We therefore conclude that the two-input gate of Fig. 15.35 realizes the OR function and its complement, the NOR function. The availability of complementary outputs is an important advantage of ECL; it simplifies logic design and avoids the use of additional inverters with associated time delay.

It should be noted that the resistance connecting each of the gate input terminals to the negative supply enables the user to leave an unused input terminal open: An open input terminal will be pulled down to the negative supply voltage, and its associated transistor will be off.

# EXERCISE 

15.18 With input terminals $A$ and $B$ in Fig. 15.35 left open, find the current $I_{E}$ through $R_{E}$. Also find the voltages at the collector of $Q_{R}$ and at the common collector of the input transistors $Q_{A}$ and $Q_{B}$. Use $V_{R}=-1.32 \mathrm{~V}, V_{B E}$ of $Q_{R} \simeq 0.75 \mathrm{~V}$, and assume that $\beta$ of $Q_{R}$ is very high.
Ans. $4 \mathrm{~mA} ;-1 \mathrm{~V} ; 0 \mathrm{~V}$

The third part of the ECL gate circuit is composed of the two emitter followers, $Q_{2}$ and $Q_{3}$. The emitter followers do not have on-chip loads, since in many applications of high-speed logic circuits the gate output drives a transmission line terminated at the other end, as indicated in Fig. 15.36.

The emitter followers have two purposes: First, they shift the level of the output signals by one $V_{B E}$ drop. Thus, using the results of Exercise 15.18, we see that the output levels become approximately -1.75 V and -0.75 V . These shifted levels are centered approximately around the reference voltage ( $V_{R}=-1.32 \mathrm{~V}$ ), which means that one gate can drive another. This compatibility of logic levels at input and output is an essential requirement in the design of gate circuits.

The second function of the output emitter followers is to provide the gate with low output resistances and with the large output currents required for charging load capacitances. Since these large transient currents can cause spikes on the power-supply line, the collectors of the emitter followers are connected to a power-supply terminal $V_{C C 1}$ separate from that of the


Figure 15.36 The proper way to connect high-speed logic gates such as ECL. Properly terminating the transmission line connecting the two gates eliminates the "ringing" that would otherwise corrupt the logic signals.


Figure 15.37 The wired-OR capability of ECL.
differential amplifier and the reference-voltage circuit, $V_{C C 2}$. Here we note that the supply current of the differential amplifier and the reference circuit remains almost constant. The use of separate power-supply terminals prevents the coupling of power-supply spikes from the output circuit to the gate circuit and thus lessens the likelihood of false gate switching. Both $V_{C C 1}$ and $V_{C C 2}$ are of course connected to the same system ground, external to the chip.

The Wired-OR Capability The emitter-follower output stage of the ECL family allows an additional level of logic to be performed at very low cost by simply wiring the outputs of several gates in parallel. This is illustrated in Fig. 15.37, where the outputs of two gates are wired together. Note that the base-emitter diodes of the output followers realize an OR function: This wired-OR connection can be used to provide gates with high fan-in as well as to increase the flexibility of ECL in logic design.

Final Comments We have chosen to study ECL by focusing on a commercially available circuit family. A great deal of design optimization has been applied to create a very-high-performance family of SSI and MSI logic circuits. ECL and some of its variants are also used in VLSI circuit design. Applications include very-high-speed processors such as those used in supercomputers, as well as high-speed and high-frequency communication systems. When employed in VLSI design, current-source biasing is almost always utilized. Further, a variety of circuit configurations are employed (see Rabaey, 1996). The major disadvantage of ECL is its large static power dissipation, which limits its use to specialized applications where high speed of operation is of paramount interest.

# 15.6.2 BiCMOS Digital Circuits 

In this section, we provide an introduction to a VLSI circuit technology that combines bipolar and CMOS circuits on one IC chip. The aim is to combine the low-power, high-input impedance and wide noise margins of CMOS with the high current-driving capability of bipolar transistors. Specifically, CMOS, although a nearly ideal logic-circuit technology in many respects, has a limited current-driving capability. This is not a serious problem when the CMOS gate has to drive a few other CMOS gates. It becomes a serious issue, however, when relatively large capacitive loads (e.g., greater than 0.5 pF or so) are present. In such cases, one has to either resort to the use of elaborate CMOS buffer circuits (such as those discussed in Section 14.4.4) or face the usually unacceptable consequence of long propagation delays. On the other hand, we know that by virtue of its much larger transconductance, the BJT is capable of large output currents. We have seen a practical illustration of that in the emitter-follower
output stage of ECL. Indeed, the high current-driving capability contributes to making ECL two to five times faster than CMOS (under equivalent conditions) - of course, at the expense of high power dissipation. In summary, then, BiCMOS seeks to combine the best of the CMOS and bipolar technologies to obtain a class of circuits that is particularly useful when output currents that are higher than is possible with CMOS are needed. The price paid is a processing technology that is more complex, and hence more expensive, than CMOS.

The BiCMOS Inverter A variety of BiCMOS inverter circuits have been proposed and are in use. All of these are based on the use of $n p n$ transistors to increase the output current available from a CMOS inverter. This can be most simply achieved by cascading each of the $Q_{N}$ and $Q_{P}$ devices of the CMOS inverter with an $n p n$ transistor, as shown in Fig. 15.38(a). Observe that this circuit can be thought of as utilizing the pair of complementary composite MOS-BJT devices shown in Fig. 15.38(b). These composite devices ${ }^{7}$ retain the high input impedance of the MOS transistor while in effect multiplying its rather low $g_{m}$ by the $\beta$ of the BJT. It is also useful to observe that the output stage formed by $Q_{1}$ and $Q_{2}$ has what is known as the totem-pole configuration utilized by TTL. ${ }^{8}$

The circuit of Fig. 15.38(a) operates as follows: When $v_{I}$ is low, both $Q_{N}$ and $Q_{2}$ are off while $Q_{P}$ conducts and supplies $Q_{1}$ with base current, thus turning it on. Transistor $Q_{1}$ then provides a large output current to charge the load capacitance. The result is a very fast charging of the load capacitance and correspondingly a short low-to-high propagation delay, $t_{P L H}$. Transistor $Q_{1}$ turns off when $v_{O}$ reaches a value of about $V_{D D}-V_{B E 1}$, and thus the output high level is lower than $V_{D D}$, a disadvantage. When $v_{I}$ goes high, $Q_{P}$ and $Q_{1}$ turn off, and $Q_{N}$ turns on, providing its drain current into the base of $Q_{2}$. Transistor $Q_{2}$ then turns on and provides a large output current that quickly discharges the load capacitance. Here again the result is a short high-to-low propagation delay, $t_{P H L}$. On the negative side, $Q_{2}$ turns off when $v_{O}$ reaches a value of about $V_{B E 2}$, and thus the output low level is greater than zero, a disadvantage.

Thus, while the circuit of Fig. 15.38(a) features large output currents and short propagation delays, it has the disadvantage of reduced logic swing and, correspondingly, reduced noise margins. There is also another and perhaps more serious disadvantage, namely, the relatively long turn-off delays of $Q_{1}$ and $Q_{2}$ arising from the absence of circuit paths along which the base charge can be removed. This problem can be solved by adding a resistor between the base of each of $Q_{1}$ and $Q_{2}$ and ground, as shown in Fig. 15.38(c). Now when either $Q_{1}$ or $Q_{2}$ is turned off, its stored base charge is removed to ground through $R_{1}$ or $R_{2}$, respectively. Resistor $R_{2}$ provides an additional benefit: With $v_{I}$ high, and after $Q_{2}$ cuts off, $v_{O}$ continues to fall below $V_{B E 2}$, and the output node is pulled to ground through the series path of $Q_{N}$ and $R_{2}$. Thus $R_{2}$ functions as a pull-down resistor. The $Q_{N}-R_{2}$ path, however, is a high-impedance one with the result that pulling $v_{O}$ to ground is a rather slow process. Incorporating the resistor $R_{1}$, however, is disadvantageous from a static power-dissipation standpoint: When $v_{I}$ is low, a dc path exists between $V_{D D}$ and ground through the conducting $Q_{P}$ and $R_{1}$. Finally, it should be noted that $R_{1}$ and $R_{2}$ take some of the drain currents of $Q_{P}$ and $Q_{N}$ away from the bases of

[^0]
[^0]:    ${ }^{7}$ It is interesting to note that these composite devices were proposed as early as 1969 (see Lin et al., 1969).
    ${ }^{8}$ Refer to the book's website for a description of the basic TTL logic-gate circuit and its totem-pole output stage.


Figure 15.38 Development of the BiCMOS inverter circuit. (a) The basic concept is to use an additional bipolar transistor to increase the output current drive of each of $Q_{N}$ and $Q_{P}$ of the CMOS inverter. (b) The circuit in (a) can be thought of as utilizing these composite devices. (c) To reduce the turn-off times of $Q_{1}$ and $Q_{2}$, "bleeder resistors" $R_{1}$ and $R_{2}$ are added. (d) Implementation of the circuit in (c) using NMOS transistors to realize the resistors. (e) An improved version of the circuit in (c) obtained by connecting the lower end of $R_{1}$ to the output node.
$Q_{1}$ and $Q_{2}$ and thus slightly reduce the gate output current available to charge and discharge the load capacitance.

Figure 15.38(d) shows the way in which $R_{1}$ and $R_{2}$ are usually implemented. As indicated, NMOS devices $Q_{R 1}$ and $Q_{R 2}$ are used to realize $R_{1}$ and $R_{2}$. As an added innovation, these two transistors are made to conduct only when needed. Thus, $Q_{R 1}$ will conduct only when $v_{I}$ rises, at which time its drain current constitutes a reverse base current for $Q_{1}$, speeding up its turn-off. Similarly, $Q_{R 2}$ will conduct only when $v_{I}$ falls and $Q_{P}$ conducts, pulling the gate of $Q_{R 2}$ high. The drain current of $Q_{R 2}$ then constitutes a reverse base current for $Q_{2}$, speeding up its turn-off.

As a final circuit for the BiCMOS inverter, we show the so-called $R$-circuit in Fig. 15.38(e). This circuit differs from that in Fig. 15.38(c) in only one respect: Rather than returning $R_{1}$ to ground, we have connected $R_{1}$ to the output node of the inverter. This simple change has two benefits. First, the problem of static power dissipation is now solved. Second, $R_{1}$ now functions as a pull-up resistor, pulling the output node voltage up to $V_{D D}$ (through the conducting $Q_{P}$ ) after $Q_{1}$ has turned off. Thus, the $R$ circuit in Fig. 15.38(e) does in fact have output levels very close to $V_{D D}$ and ground.

Finally, note that despite the initial promise of BiCMOS, the added processing complexity has somewhat hindered the penetration of BiCMOS into digital IC design. Its use is currently limited to specialized applications, including radio-frequency (RF) circuits that employ an advanced bipolar technology known as silicon-germanium (SiGe).

# EXERCISE 

D15.19 The threshold voltage of the BiCMOS inverter of Fig. 15.38(e) is the value of $v_{I}$ at which both $Q_{N}$ and $Q_{P}$ are conducting equal currents and operating in the saturation region. At this value of $v_{I}, Q_{2}$ will be on, causing the voltage at the source of $Q_{N}$ to be approximately 0.7 V . It is required to design the circuit so that the threshold voltage is equal to $V_{D D} / 2$. For $V_{D D}=5 \mathrm{~V},\left|V_{t}\right|=0.6 \mathrm{~V}$, and assuming equal channel lengths for $Q_{N}$ and $Q_{P}$ and that $\mu_{n} \simeq 2.5 \mu_{p}$, find the required ratio of widths, $W_{p} / W_{n}$. Ans. 1

## Summary

- The third significant metric in digital IC design, along with speed of operation and power dissipation, is the size of the silicon area required for an inverter.
- Refer to Table 15.1 for the implications of scaling the dimensions of the MOSFET and $V_{D D}$ and $V_{t}$ by a factor $1 / S$.
- In devices with short channels ( $L<0.25 \mu \mathrm{~m}$ ) velocity saturation occurs. Its effect is that $i_{D}$ saturates early, and its value is lower than would be the case in long-channel devices (see Figs. 15.3, 15.4, and 15.5, and Eq. 15.11).
- Subthreshold conduction is increasingly becoming an important issue in CMOS circuits, leading to significant static power consumption.
- Predominantly because of its low power dissipation and because of its scalability, CMOS is by far the principal technology for digital IC design. This dominance is expected to continue for many years to come.
- Standard CMOS logic utilizes two transistors, an NMOS and a PMOS, for each input variable. Thus the circuit complexity, silicon area, and parasitic capacitance all increase with fan-in.
- To reduce the device count, two other forms of static CMOS, namely, pseudo-NMOS and pass-transistor logic (PTL), are employed in special applications as supplements to standard CMOS.
- Pseudo-NMOS utilizes the same PDN as in standard CMOS logic but replaces the PUN with a single PMOS transistor whose gate is grounded and thus is permanently on. Unlike standard CMOS, pseudo-NMOS is a ratioed form of logic in which $V_{O L}$ is determined by the ratio $r$ of $k_{e}$ to $k_{e}$. Normally, $r$ is selected in the range of 4 to 10 and its value determines the noise margins.
- Pseudo-NMOS has the disadvantage of dissipating static power when the output of the logic gate is low. Static power can be eliminated by turning the PMOS load on for only a brief interval, known as the precharge interval, to charge the capacitance at the output node to $V_{D D}$. Then the inputs are applied, and depending on the input combination, the output node either remains high or is discharged through the PDN. This is the essence of dynamic logic.
- Pass-transistor logic utilizes either single NMOS transistors or CMOS transmission gates to implement a network of switches that are controlled by the input logic variables. Switches implemented by single NMOS transistors, though simple, result in the reduction of $V_{O H}$ from $V_{D D}$ to $V_{D D}-V_{i}$.
- The CMOS transmission gate, composed of the parallel connection of an NMOS and a PMOS transistor, is a very effective switch in both analog and digital applications. It passes the entire input signal swing, 0 to $V_{D D}$. As well, it has an almost constant on-resistance over the full output range.
- A particular form of dynamic logic circuits, known as Domino logic, allows the cascading of dynamic logic gates.
- Emitter-coupled logic (ECL) is the fastest commercially available logic-circuit family. It achieves its high speed of operation by avoiding transistor saturation and by utilizing small logic-signal swings. Its high speed of operation is achieved at the expense of large power dissipation, which limits its application to highly specialized applications.
- The ECL gate provides two complementary outputs, realizing the OR and NOR functions. The outputs of ECL gates can be wired together to realize the OR function of the individual output variables.
- BiCMOS combines the low power and wide noise margins of CMOS with the high current-driving capability (and thus the short gate delays) of BJTs. However, the added processing complexity (over that required for CMOS) has limited its use to specialized applications.


## Section 15.1: Implications of Technology Scaling: Issues in Deep-Submicron Design

15.1 A chip with a certain area designed using the $5-\mu \mathrm{m}$ process of the late 1970s contains 20,000 transistors. What does Moore's law predict the number of transistors to be on a chip of equal area fabricated using the $32-\mathrm{nm}$ process of 2013?
15.2 Consider the scaling from a $0.13-\mu \mathrm{m}$ process to a $65-\mathrm{nm}$ process.
(a) Assuming $V_{D D}$ and $V_{i}$ are scaled by the same factor as the device dimensions $(S=2)$, find the factor by which $t_{P}$,
the maximum operating speed, $P_{\text {dyn }}$, power density, and $P D P$ decrease (or increase)?
(b) Repeat (a) for the situation in which $V_{D D}$ and $V_{i}$ remain unchanged.
15.3 For a $65-\mathrm{nm}$ technology, $V_{\text {DTest }}$ for minimum-length NMOS devices is measured to be 0.25 V and that for minimum-length PMOS devices 0.45 V . What do you estimate the effective values of $\mu_{n}$ and $\mu_{p}$ to be? Also find the values of $E_{c t}$ for both device polarities.
15.4 Consider NMOS and PMOS transistors with minimum channel length fabricated in a $0.13-\mu \mathrm{m}$ CMOS process. If the effective values of $\mu_{n}$ and $\mu_{p}$ are $350 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$ and

[^0]
[^0]:    534 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
$150 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$, respectively, find the expected values of $V_{D S s a t}$ for both device polarities.
15.5 (a) Show that for a short-channel NMOS transistor, the ratio of the current $I_{D s a t}$ obtained at $v_{G S}=V_{D D}$ to the current obtained if velocity saturation were absent is given by

$$
\frac{I_{D s a t}}{I_{D}}=\frac{2 V_{D S s a t}\left(V_{D D}-V_{i}-\frac{1}{2} V_{D S s a t}\right)}{\left(V_{D D}-V_{i}\right)^{2}}
$$

(b) Find the ratio in (a) for a transistor fabricated in a $65-\mathrm{nm}$ process with $L=65-\mathrm{nm}, V_{i}=0.35 \mathrm{~V}, V_{D S s a t}=0.25 \mathrm{~V}$, and $V_{D D}=1.0 \mathrm{~V}$.
15.6 (a) Consider a CMOS inverter fabricated in a deep-submicron technology utilizing transistors with the minimum allowed channel length and having an equivalent load capacitance $C$. Let $v_{I}$ rise instantaneously to $V_{D D}$ and assume that $Q_{P}$ turns off and $Q_{N}$ turns on immediately. Ignoring channel-length modulation, that is, $\lambda=0$, and assuming $Q_{N}$ operates in the velocity-saturation region, show that

$$
t_{P H L}=\frac{C V_{D D}}{2 I_{D s a t}}
$$

(b) Using the equivalent resistance of $Q_{N}$ show that

$$
t_{P H L}=0.69 C \frac{12.5 \times 10^{3}}{(W / L)_{n}}
$$

(c) If the formulas in (a) and (b) are to yield the same result, find $V_{D S s a t}$ for the NMOS transistor for a $0.13-\mu \mathrm{m}$ technology characterized by $V_{D D}=1.2 \mathrm{~V}, V_{i}=0.4 \mathrm{~V}$, and $\mu_{n} C_{o s}=325 \mu \mathrm{~A} / \mathrm{V}^{2}$.
D 15.7 (a) For a CMOS inverter fabricated in a deep-submicron technology with $L_{n}=L_{p}=$ the minimum allowed channel length, it is required to select $W_{p} / W_{n}$ so that $t_{P H L}=t_{P L H}$. This can be achieved by making $I_{D s a t}$ of $Q_{N}$ equal to $I_{D s a t}$ of $Q_{P}$ at $\left|v_{G S}\right|=V_{D D}$. Show that $W_{p} / W_{n}$ is given by

$$
\frac{W_{p}}{W_{n}}=\frac{\mu_{n}}{\mu_{p}} \frac{V_{D S s a t n}}{\left|V_{D S s a t p}\right|} \frac{V_{D D}-V_{m}-\frac{1}{2} V_{D S s a t n}}{V_{D D}-\left|V_{i p}\right|-\frac{1}{2}\left|V_{D S s a t p}\right|}
$$

(b) Find the required $W_{p} / W_{n}$ for a $65-\mathrm{nm}$ technology for which $\mu_{n} / \mu_{p}=4, V_{D D}=1.0 \mathrm{~V}, V_{m}=-V_{i p}=0.35 \mathrm{~V}, V_{D S s a t n}=0.25 \mathrm{~V}$, and $\left|V_{D S s a t p}\right|=0.45 \mathrm{~V}$.
D 15.8 The current $I_{S}$ in the subthreshold conduction Eq. (15.13) is proportional to $e^{-V_{I} / n V_{T}}$. If the threshold voltage of an NMOS transistor is reduced by 0.1 V , by what factor will
the static power dissipation increase? Assume $n=2$. Repeat for a reduction in $V_{i}$ by 0.2 V . What do you conclude about the selection of a value of $V_{i}$ in process design?
15.9 Measurements on a MOSFET operating in the subthreshold conduction region indicate that the current changes by a factor of 10 for every $80-\mathrm{mV}$ change in $v_{G S}$ and that $i_{D}=20 \mathrm{nA}$ at $v_{G S}=0.16 \mathrm{~V}$.
(a) Find the value of $i_{D}$ at $v_{G S}=0$.
(b) For a chip having 1 billion transistors, find the current drawn from the 1-V supply $V_{D D}$ as a result of subthreshold conduction. Hence, estimate the resulting static power dissipation.
15.10 An NMOS transistor with $k_{n}=0.4 \mathrm{~mA} / \mathrm{V}^{2}$ and a nominal $V_{i m}$ of 0.4 V is to operate in saturation at $I_{D}=0.2 \mathrm{~mA}$.
(a) If $V_{i m}$ can vary by as much as $\pm 10 \%$, what is the expected range of $I_{D}$ obtained?
(b) If the transistor is used to discharge a 100-fF load capacitance, what is the expected variation in delay time, assuming that the output voltage is to change by 0.1 V ?
15.11 An interconnect wire with a length $L$, a width $W$, and a thickness $T$ has a resistance $R$ given by

$$
R=\rho \frac{L}{A}=\frac{\rho L}{T W}
$$

where $\rho$ is the resistivity of the material of which the wire is made. The quantity $\rho / T$ is called the sheet resistance and has the dimension of ohms, although it is usually expressed as ohms/square or $\Omega / \square$ (refer to Fig. P15.11a).

(a)

(b)

Figure P15.11

[^0]
[^0]:    $\mathrm{III}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; $\mathrm{D}=$ design problem
(a) Find the resistance of an aluminum wire that is 5 mm long and $0.5 \mu \mathrm{~m}$ wide, if the sheet resistance is specified to be $27 \mathrm{~m} \Omega / \square$.
(b) If the wire capacitance to ground is $0.1 \mathrm{fF} / \mu \mathrm{m}$ length, what is the total wire capacitance?
(c) If we can model the wire very approximately as an RC circuit as shown in Fig. P15.11(b), find the delay time introduced by the wire. (Hint: $t_{\text {delay }}=0.69 R C$.) (P.S. Only a small fraction of the interconnect on an IC would be this long!)

## Section 15.3: Pseudo-NMOS Logic Circuits

15.12 The purpose of this problem is to compare the value of $t_{P L H}$ obtained with a resistive load [see Fig. P15.12(a)] to that obtained with a current-source load [see Fig. P15.12(b)]. For a fair comparison, let the current source $I=V_{D D} / R_{D}$, which is the initial current available to charge the capacitor in the case of a resistive load. Find $t_{P L H}$ for each case, and hence the percentage reduction obtained when a current-source load is used.
15.13 For a pseudo-NMOS inverter fabricated in a $0.13-\mu \mathrm{m}$ process and having $k_{n}=5 k_{p}=500 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{m}=-V_{M}=$ 0.4 V , and $V_{D D}=1.3 \mathrm{~V}$, find $V_{O H}, V_{O L}$, and $I_{s a t}$. Hence, find the static power dissipation in the low-output state.
15.14 For the pseudo-NMOS inverter specified in Problem 15.13 , find $V_{O L}, V_{I L}, V_{M}, V_{I H}, V_{O H}, N M_{L}$, and $N M_{H}$.
15.15 Find $t_{P L H}, t_{P H L}$, and $t_{P}$ for the pseudo-NMOS inverter specified in Problem 15.13 when loaded with $C=10 \mathrm{fF}$.
$\mathbf{D}^{*}$ 15.16 Design a pseudo-NMOS inverter that has equal capacitive charging and discharging currents at $v_{O}=V_{D D} / 4$ for use in a system with $V_{D D}=2.5 \mathrm{~V},\left|V_{i}\right|=0.5 \mathrm{~V}, k_{n}^{\prime}=$ $115 \mu \mathrm{~A} / \mathrm{V}^{2}, k_{p}^{\prime}=30 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $(W / L)_{n}=1.5$. What are the values of $(W / L)_{p}, V_{I L}, V_{I H}, V_{M}, V_{O H}, V_{O L}, N M_{H}$, and $N M_{L}$ ?
*15.17 Use Eq. (15.26) to find the value of $r$ for which $N M_{L}$ is maximized. What is the corresponding value of $N M_{L}$ for the case $V_{D D}=1.3 \mathrm{~V}$ and $V_{i}=0.4 \mathrm{~V}$ ? Show that $N M_{L}$ does not change very much with $r$ by evaluating $N M_{L}$ for $r=2,5$, and 10 .
15.18 For what value of $r$ does $N M_{H}$ of a pseudo-NMOS inverter become zero? Prepare a table of $N M_{H}$ and $N M_{L}$ versus $r$, for $r=2$ to 10 . Let $V_{D D}=1.3 \mathrm{~V}$ and $V_{i}=0.4 \mathrm{~V}$. Use your table and iteration to determine the value of $r$ that results in $N M_{L}=N M_{H}$. What is the resulting margin?

D 15.19 Design a pseudo-NMOS inverter that has $V_{O L}=$ 0.1 V . Let $V_{D D}=1.8 \mathrm{~V},\left|V_{i}\right|=0.5 \mathrm{~V}, k_{n}^{\prime}=4 k_{p}^{\prime}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $(W / L)_{n}=1$. What is the value of $(W / L)_{n}$ ? Calculate the values of $N M_{L}$ and the static power dissipation.

(a)

(b)

Figure P15.12

[^0]
[^0]:    ${ }^{\text {SIN }}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
$\mathbf{D} * 15.20$ It is required to design a minimum-area pseudo-NMOS inverter with equal high and low noise margins using a $1.3-\mathrm{V}$ supply and devices for which $\left|V_{t}\right|=$ $0.4 \mathrm{~V}, k_{n}=4 k_{p}^{\prime}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$, and the minimum-size device has $(W / L)=1$. Use $r=5.7$ and show that $N M_{L} \simeq N M_{H}$. Specify the values of $(W / L)_{n}$ and $(W / L)_{p}$. What is the static power dissipated in this gate? What is the ratio of propagation delays for low-to-high and high-to-low transitions? For an equivalent load capacitance of 100 fF , find $t_{P L H}, t_{P H L}$, and $t_{P}$. At what frequency of operation would the static and dynamic power levels be equal? Is this speed of operation possible in view of the $t_{P}$ value you found?
D 15.21 Sketch a pseudo-NMOS realization of the function $Y=\overline{A+B(C+D)}$.
D 15.22 Sketch a pseudo-NMOS realization of the exclusive-OR function $Y=A \bar{B}+\bar{A} B$.
D 15.23 Consider a four-input pseudo-NMOS NOR gate in which the NMOS devices have $(W / L)_{n}=1.5$. It is required to find $(W / L)_{p}$ so that the worst-case value of $V_{O L}$ is 0.1 V . Let $V_{D D}=1.3 \mathrm{~V},\left|V_{t}\right|=0.4 \mathrm{~V}$, and $k_{n}^{\prime}=4 k_{p}^{\prime}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$.
15.24 This problem investigates the effect of velocity saturation (Section 15.1.3) on the operation of a pseudo-NMOS inverter fabricated in a $0.13-\mu \mathrm{m}$ CMOS process for which $V_{D D}=1.3 \mathrm{~V}, V_{t}=0.4 \mathrm{~V}, k_{n}=5 k_{p}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $\left|V_{D S s a t p}\right|=0.6 \mathrm{~V}$. Consider the case with $v_{I}=V_{D D}$ and $v_{O}=$ $V_{O L}$. Note that $Q_{P}$ will be operating in the velocity-saturation region. Find its current $I_{D \text { sat }}$ and use it to determine $V_{O L}$.

## Section 15.4: Pass-Transistor-Logic Circuits

15.25 Recall that MOS transistors are symmetrical and that what distinguishes the source from the drain is their relative voltage levels: For NMOS, the terminal with the higher voltage is the drain; for PMOS, the terminal with the higher voltage is the source. For each of the circuits in Fig. P15.25, label the source and drain terminals and give the output voltage $V_{O}$ in terms of $V_{D D}, V_{s s}$, and $\left|V_{S p}\right|$. Note that $V_{s s}$ and $\left|V_{s p}\right|$ are determined by the body effect, and give expressions for their values. Note that $V_{O}$ is the value reached after the capacitor charging/discharging interval has come to an end.


Figure P15.25

[^0]
[^0]:    $\mathrm{D} \mid \mathrm{=}$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
15.26 Let the NMOS transistor switch in Fig. 15.17 be fabricated in a $0.13-\mu \mathrm{m}$ CMOS process for which $V_{t 0}=0.4 \mathrm{~V}$, $\gamma=0.2 \mathrm{~V}^{1 / 2}, 2 \phi_{f}=0.88 \mathrm{~V}$, and $V_{D D}=1.2 \mathrm{~V}$. Determine $V_{O H}$.
15.27 Consider the circuit in Fig. 15.17 with the NMOS transistor having $W / L=1.5$ and fabricated in a CMOS process for which $V_{t 0}=0.4 \mathrm{~V}, \gamma=0.2 \mathrm{~V}^{1 / 2}, 2 \phi_{f}=0.88 \mathrm{~V}, V_{D D}=1.2 \mathrm{~V}$, and $\mu_{n} C_{o s}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$. Find $t_{P L H}$ for the case $C=10 \mathrm{fF}$.
15.28 Consider the circuit in Fig. 15.18 with the NMOS transistor having $W / L=1.5$ and fabricated in a $0.13-\mu \mathrm{m}$ CMOS process for which $V_{t 0}=0.4 \mathrm{~V}, V_{D D}=1.2 \mathrm{~V}$, and $\mu_{n} C_{o s}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$. Determine $t_{P H L}$ for the case $C=10 \mathrm{fF}$.
15.29 Consider the case specified in Exercise 15.8. If the output of the switch is connected to the input of a CMOS inverter having $(W / L)_{p}=2(W / L)_{n}=0.54 \mu \mathrm{~m} / 0.18 \mu \mathrm{~m}$, find the static current of the inverter and its static power dissipation when the inverter input is at the value found in Exercise 15.8. Also find the inverter output voltage. Let $\mu_{n} C_{o s}=4 \mu_{p} C_{o s}=$ $300 \mu \mathrm{~A} / \mathrm{V}^{2}$.
15.30 An NMOS pass-transistor switch with $W / L=$ $1.2 \mu \mathrm{~m} / 0.8 \mu \mathrm{~m}$, used in a $3.3-\mathrm{V}$ system for which $V_{t 0}=0.8 \mathrm{~V}$, $\gamma=0.5 \mathrm{~V}^{1 / 2}, 2 \phi_{f}=0.6 \mathrm{~V}, \mu_{n} C_{o s}=3 \mu_{p} C_{o s}=75 \mu \mathrm{~A} / \mathrm{V}^{2}$, drives a $100-\mathrm{fF}$ load capacitance at the input of a matched standard CMOS inverter using $(W / L)_{n}=1.2 \mu \mathrm{~m} / 0.8 \mu \mathrm{~m}$. For the switch gate terminal at $V_{D D}$, evaluate the switch $V_{O H}$ and $V_{O L}$ for inputs at $V_{D D}$ and 0 V , respectively. For this value of $V_{O H}$, what inverter static current results? Estimate $t_{P L H}$ and $t_{P H L}$ for this arrangement as measured from the input to the output of the switch itself.
15.31 Figure P15.31 shows a PMOS transistor operating as a switch in the on position.
(a) If initially $v_{O}=0$ and at $t=0, v_{I}$ is raised to $V_{D D}$, what is the final value $V_{O H}$ reached at the output?


Figure P15.31
(b) If initially $v_{O}=V_{D D}$ and at $t=0, v_{I}$ is lowered to 0 V , what is the final value $V_{O L}$ reached at the output?
(c) For the situation in (a), find $t_{P L H}$ for $v_{O}$ to rise from 0 to $V_{D D} / 2$. Let $k_{p}=125 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{D D}=1.2 \mathrm{~V}$, and $\left|V_{t p}\right|=0.4 \mathrm{~V}$.
*15.32 A designer, beginning to experiment with the idea of pass-transistor logic, seizes upon what he sees as two good ideas:
(a) that a string of minimum-size single MOS transistors can do complex logic functions,
(b) but that there must always be a path between output and a supply terminal.

Correspondingly, he first considers two circuits (shown in Fig. P15.32). For each, express $Y$ as a function of $A$ and $B$. In each case, what can be said about general operation? About the logic levels at $Y$ ? About node $X$ ? Do either of these circuits look familiar? If in each case the terminal connected to $V_{D D}$ is instead connected to the output of a CMOS inverter whose input is connected to a signal $C$, what does the function $Y$ become?


Figure P15.32

[^0]
[^0]:    SIN = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem15.33 Consider the circuits in Fig. P15.32 with all PMOS transistors replaced with NMOS, and all NMOS by PMOS, and with ground and $V_{D D}$ connections interchanged. What do the output functions $Y$ become?
15.34 For the level-restoring circuit of Fig. 15.19, let $k_{n}^{\prime}=$ $3 k_{p}^{\prime}=75 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{D D}=3.3 \mathrm{~V},\left|V_{s 0}\right|=0.8 \mathrm{~V}, \gamma=0.5 \mathrm{~V}^{1 / 2}$, $2 \phi_{f}=0.6 \mathrm{~V},(W / L)_{1}=(W / L)_{n}=1.2 \mu \mathrm{~m} / 0.8 \mu \mathrm{~m},(W / L)_{p}=$ $3.6 \mu \mathrm{~m} / 0.8 \mu \mathrm{~m}$, and $C=20 \mathrm{fF}$. Also let $v_{B}=V_{D D}$. Now for $v_{A}$ rising to $V_{D D}$, and $Q_{1}$ charging $C$ and causing $v_{O 1}$ to rise, show that the value of $v_{O 1}$ that causes $v_{O 2}$ to drop by a threshold voltage below $V_{D D}$ (i.e., to 2.5 V ) so that $Q_{R}$ turns on, is approximately $V_{D D} / 2$ and thus occurs at $t \simeq t_{L H}$. What is the capacitor-charging current available at this time (i.e., just prior to $Q_{R}$ turning on)? What is it at $v_{O 1}=0$ ? What is the average current available for charging $C$ ? Estimate the time $t_{P L H}$. (Note that after $Q_{R}$ turns on, $v_{O 1}$ rises to $V_{D D}$.)

D*15.35 The purpose of this problem is to illustrate how $W / L$ of the level-restoring transistor $Q_{R}$ in the circuit of Fig. 15.19 is determined. For this purpose consider the circuit as specified in Problem 15.34 and let $v_{B}=V_{D D}$. Now, consider the situation when $v_{A}$ is brought down to 0 V and $Q_{1}$ conducts and begins to discharge $C$. The voltage $v_{O 1}$ will begin to drop from $V_{D D}$. Meanwhile, $v_{O 2}$ is still low and $Q_{R}$ is conducting (though at $t=0$, the current in $Q_{R}$ is zero). Calculate the discharge current at $t=0$. As $Q_{R}$ conducts, its current subtracts from the current of $Q_{1}$, reducing the current available to discharge $C$. Find the value of $v_{O 1}$ at which the inverter begins to switch. This is $V_{I H}=\frac{1}{5}\left(5 V_{D D}-2 V_{i}\right)$. Then, find the current that $Q_{1}$ conducts at this value of $v_{O 1}$. Choose $W / L$ for $Q_{R}$ so that the maximum current it conducts is limited to one-half the value of the current in $Q_{1}$. What is the $W / L$ you have chosen? Estimate $t_{P H L}$ as the time for $v_{O 1}$ to drop from $V_{D D}$ to $V_{I H}$.
15.36 The transmission gate in Fig. 15.21(a) and 15.21(b) is fabricated in a CMOS process technology for which $k_{n}^{\prime}=$
$4 k_{n}^{\prime}=500 \mu \mathrm{~A} / \mathrm{V}^{2},\left|V_{s 0}\right|=0.4 \mathrm{~V}, \gamma=0.2 \mathrm{~V}^{1 / 2}, 2 \phi_{f}=0.88 \mathrm{~V}$, and $V_{D D}=1.2 \mathrm{~V}$. Let $Q_{N}$ and $Q_{P}$ have $(W / L)_{n}=(W / L)_{p}=1.5$. The total capacitance at the output node is 15 fF .
(a) What are the values of $V_{O H}$ and $V_{O L}$ ?
(b) For the situation in Fig. 15.21(a), find $i_{D N}(0), i_{D P}(0)$, $i_{D N}\left(t_{P L H}\right), i_{D P}\left(t_{P L H}\right)$, and $t_{P L H}$.
(c) For the situation depicted in Fig. 15.21(b), find $i_{D N}(0)$, $i_{D P}(0), i_{D N}\left(t_{P H L}\right), i_{D P}\left(t_{P H L}\right)$, and $t_{P H L}$. At what value of $v_{O}$ will $Q_{P}$ turn off?
(d) Find $t_{P}$.
15.37 For the transmission gate specified in Problem 15.36, find $R_{T G}$ at $v_{O}=0$ and 0.6 V . Use the average of those values to determine $t_{P L H}$ for the situation in which $C=15 \mathrm{fF}$.
*15.38 Refer to the situation in Fig. 15.21(b). Derive expressions for $R_{N n q}, R_{P n q}$, and $R_{T G}$ following the approach used in Section 15.4.4 for the capacitor-charging case. Evaluate the value of $R_{T G}$ for $v_{O}=V_{D D}$ and $v_{O}=V_{D D} / 2$ for the process technology specified in Problem 15.36. Find the average value of $R_{T G}$ and use it to determine $t_{P H L}$ for the case $C=15 \mathrm{fF}$.
15.39 A transmission gate for which $(W / L) n=(W / L)_{p}=1.5$ is fabricated in a $0.13-\mu \mathrm{m}$ CMOS technology and used in a circuit for which $C=10 \mathrm{fF}$. Use Eq. (15.49) to obtain an estimate of $R_{T G}$ and hence of the propagation delay $t_{P}$.
15.40 Figure P15.40 shows a chain of transmission gates. This situation often occurs in circuits such as adders and multiplexers. Consider the case when all the transmission gates are turned on and a step voltage $V_{D D}$ is applied to the input. The propagation delay $t_{P}$ can be determined from the Elmore delay formula as follows:

$$
t_{P}=0.69 \sum_{k=0}^{n} k C R_{T G}
$$



Figure P15.40

[^0]
[^0]:    ${ }^{15.38}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
where $R_{T G}$ is the resistance of each transmission gate, $C$ is the capacitance between each node and ground, and $n$ is the number of transmission gates in the chain. Note that the sum of the series in this formula is given by

$$
t_{P}=0.69 C R_{T G} \frac{n(n+1)}{2}
$$

Now evaluate $t_{P}$ for the case of 16 transmission gates with $R_{T G}=10 \mathrm{k} \Omega$ and $C=10 \mathrm{fF}$. What does the value of $t_{P}$ become if the input is a ramp rather than a step function?

D 15.41 (a) Use the idea embodied in the exclusive-OR realization in Fig. 15.26 to realize $\bar{Y}=A B+\bar{A} \bar{B}$. That is, find a realization for $\bar{Y}$ using two transmission gates.
(b) Now combine the circuit obtained in (a) with the circuit in Fig. 15.26 to obtain a realization of the function $Z=$ $\bar{Y} C+Y \bar{C}$ where $C$ is a third input. Sketch the complete 12-transistor circuit realization of $Z$. Note that $Z$ is a three-input exclusive-OR.

D*15.42 Using the idea presented in Fig. 15.27, sketch a CPL circuit whose outputs are $Y=A \bar{B}+\bar{A} B$ and $\bar{Y}=A B+\bar{A} \bar{B}$.

D 15.43 Extend the CPL idea in Fig. 15.27 to three variables to form $Z=A B C$ and $\bar{Z}=\overline{A B C}=\bar{A}+\bar{B}+\bar{C}$.

## Section 15.5: Dynamic MOS Logic Circuits

D 15.44 Based on the basic dynamic logic circuit of Fig. 15.28, sketch complete circuits for NOT, NAND, and NOR gates, the latter two with two inputs, and a circuit for which $Y=\overline{A B+C D}$.
15.45 In this and the following problem, we investigate the dynamic operation of a two-input NAND gate realized in the dynamic logic form and fabricated in a CMOS process technology for which $k_{n}^{\prime}=4 k_{p}^{\prime}=500 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{m}=-V_{W}=$ 0.4 V , and $V_{D D}=1.2 \mathrm{~V}$. To keep $C_{L}$ small, minimum-size NMOS devices are used for which $W / L=1.5$ (this includes $Q_{v}$ ). The PMOS precharge transistor $Q_{p}$ has $W / L=3$. The capacitance $C_{L}$ is found to be 15 fF . Consider the precharge operation with the gate of $Q_{p}$ at 0 V , and assume that at $t=0$, $C_{L}$ is fully discharged. Calculate the rise time of the output voltage, defined as the time for $v_{Y}$ to rise from $10 \%$ to $90 \%$ of the final value of 1.2 V .
15.46 For the gate specified in Problem 15.45, evaluate the high-to-low propagation delay, $t_{P H L}$.
15.47 Consider a two-input NOR gate realized in the dynamic logic form illustrated in Fig. 15.28. Assume that the
gate is fabricated in a $0.13-\mu \mathrm{m}$ CMOS technology for which $V_{D D}=1.2 \mathrm{~V}, V_{s}=0.4 \mathrm{~V}$, and $\mu_{n} C_{o s}=4 \mu_{p} C_{o s}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$. The NMOS devices have $W / L=1.5$, and the PMOS transistor has $W / L=3$. The total capacitance at the output is found to be 15 fF . Calculate the rise time of $v_{O}$, from $0.1 V_{D D}$ to 0.9 $V_{D D}$, in the precharge interval. Also, calculate the worst-case value of $t_{P H L}$.
15.48 The leakage current in a dynamic logic gate causes the capacitor $C_{L}$ to discharge during the evaluation phase, even if the PDN is not conducting. For $C_{L}=10 \mathrm{fF}$, and $I_{\text {leakage }}=2 \times 10^{-12} \mathrm{~A}$, find the longest allowable evaluation time if the decay in output voltage is to be limited to 0.2 V . If the precharge interval is much shorter than the maximum allowable evaluation time, find the minimum clocking frequency required.
*15.49 In this problem, we wish to calculate the reduction in the output voltage of a dynamic logic gate as a result of charge redistribution. Refer to the circuit in Fig. 15.30(a), and assume that at $t=0-, v_{Y}=V_{D D}$, and $v_{C 1}=0$. At $t=0, \phi$ goes high and $Q_{P}$ turns off, and simultaneously the voltage at the gate of $Q_{1}$ goes high (to $V_{D D}$ ), turning $Q_{1}$ on. Transistor $Q_{1}$ will remain conducting until either the voltage at its source $\left(v_{C 1}\right)$ reaches $V_{D D}-V_{m}$ or until $v_{Y}=v_{C 1}$, whichever comes first. In both cases, the final value of $v_{Y}$ can be found using charge conservation: that is, by equating the charge gained by $C_{1}$ to the charge lost by $C_{L}$.
(a) Convince yourself that the first situation obtains when $\left|\Delta v_{Y}\right| \leq V_{m}$.
(b) For each of the two situations, derive an expression for $\Delta v_{Y}$.
(c) Find an expression for the maximum ratio $\left(C_{1} / C_{L}\right)$ for which $\left|\Delta v_{Y}\right| \leq V_{m}$.
(d) For $V_{m}=0.5 \mathrm{~V}, V_{D D}=1.8 \mathrm{~V}, C_{L}=15 \mathrm{fF}$, and neglecting the body effect in $Q_{1}$, find the drop in voltage at the output in the two cases: (a) $C_{1}=4 \mathrm{fF}$ and (b) $C_{1}=7.5 \mathrm{fF}$.
15.50 Solve the problem in Exercise 15.15 symbolically (rather than numerically). Refer to Fig. E15.15 and assume $Q_{\text {eq1 }}$ and $Q_{\text {eq2 }}$ to be identical with threshold voltages $V_{m}=$ $0.2 V_{D D}$ and transconductance parameters $k_{n}$. Also, let $C_{L 1}=$ $C_{L 2}$. Derive an expression for the drop in the output voltage, $\Delta v_{Y 2}$.
15.51 For the four-input dynamic logic NAND gate analyzed in Example 15.4, estimate the maximum clocking frequency allowed.

[^0]
[^0]:    15.45 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
## Section 15.6: Bipolar and BiCMOS Logic Circuits

15.52 For the circuit in Fig. 15.34, let $V_{C C}=0 \mathrm{~V}, I=1 \mathrm{~mA}$, and $V_{B}=-1 \mathrm{~V}$. Find $R_{C}$ to obtain an output voltage swing of 0.4 V . By how much should the output levels be shifted so that the values of $V_{O H}$ and $V_{O L}$ become centered on $V_{B}$ ? What will the shifted values of $V_{O H}$ and $V_{O L}$ be?
15.53 In Fig. P15.53(a), the ECL gate discussed in the text, only the input $A$ is shown (the other input $B$ is assumed to be left open and thus deactivated). Figure P15.53(b) shows that OR transfer characteristic: that is, $v_{O R}$ versus $v_{I}$. Determine the parameters of the transfer characteristic: that is, $V_{I L}, V_{I H}$, $V_{O L}$, and $V_{O H}$. Define $V_{I L}$ as the value of $v_{I}$ for which $Q_{R}$ conducts $99 \%$ of $I_{E}$ and $Q_{A}$ conducts $1 \%$ of $I_{E}$. Conversely, define $V_{I H}$ as the value of $v_{I}$ for which $Q_{A}$ conducts $99 \%$ of $I_{E}$ and $Q_{R}$ conducts $1 \%$ of $I_{E}$. Also, determine the width of the transition region (i.e., $V_{I H}-V_{I L}$ ) and the noise margins $N M_{H}$ and $N M_{L}$. Assume that at an emitter current of 1 mA the transistor $V_{B E}=0.75 \mathrm{~V}$ and $\beta_{2}=100$.

D 15.54 For the ECL circuit in Fig. P15.54, the transistors exhibit $V_{B E}$ of 0.75 V at an emitter current $I$ and have very high $\beta$.
(a) Find $V_{O H}$ and $V_{O L}$.

(a)
(b) For the input at $B$ that is sufficiently negative for $Q_{B}$ to be cut off, what voltage at $A$ causes a current of $I / 2$ to flow in $Q_{R}$ ?
(c) Repeat (b) for a current in $Q_{R}$ of 0.991 . Define this value of $v_{A}$ as $V_{I L}$.
(d) Repeat (c) for a current in $Q_{R}$ of 0.011 . Define this value of $v_{A}$ as $V_{I H}$.
(e) Use the results of (c) and (d) to specify $V_{I L}$ and $V_{I H}$.
(f) Find $N M_{H}$ and $N M_{L}$.
(g) Find the value of $I R$ that makes the noise margins equal to the width of the transition region, $V_{I H}-V_{I L}$.
(h) Using the $I R$ value obtained in (g), give numerical values for $V_{O H}, V_{O L}, V_{I H}, V_{I L}$, and $V_{R}$ for this ECL gate.
15.55 For the ECL gate in Fig. 15.35, calculate an approximate value for the power dissipated in the circuit under the conditions that all inputs are low and that the emitters of the output followers are left open. Assume that the reference circuit supplies four identical gates, and hence only a quarter of the power dissipated in the reference circuit should be attributed to a single gate.

D*15.56 Using the logic and circuit flexibility of ECL indicated by Figs. 15.35 and 15.37, sketch an ECL logic circuit that realizes the exclusive-OR function, $Y=\bar{A} B+A \bar{B}$. Give a logic diagram (as opposed to a circuit diagram).

(b)

Figure P15.53

[^0]
[^0]:    ${ }^{\text {TIE }}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem


Figure P15.54
*15.57 For the circuit in Fig. P15.57, let the levels of the inputs $A, B, C$, and $D$ be 0 and +5 V . For all inputs low at 0 V , what is the voltage at $E$ ? If $A$ and $C$ are raised to +5 V ,


Figure P15.57
what is the voltage at $E$ ? Assume $\left|V_{B E}\right|=0.7 \mathrm{~V}$ and $\beta=50$. Express $E$ as a logic function of $A, B, C$, and $D$.
15.58 Consider the conceptual BiCMOS circuit of Fig. 15.38(a), for the conditions that $V_{D D}=5 \mathrm{~V},\left|V_{t}\right|=1 \mathrm{~V}$, $V_{B E}=0.7 \mathrm{~V}, \beta=100, k_{a}^{\prime}=2.5 k_{p}=100 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $(W / L)_{n}=$ $2 \mu \mathrm{~m} / 1 \mu \mathrm{~m}$. For $v_{I}=v_{O}=V_{D D} / 2$, find $(W / L)_{p}$ so that $I_{E Q 1}=I_{E Q 2}$. What is this totem-pole transient current?
15.59 Consider the conceptual BiCMOS circuit of Fig. 15.38(a) for the conditions stated in Problem 15.58. What is the threshold voltage of the inverter if both $Q_{N}$ and $Q_{P}$ have $W / L=2 \mu \mathrm{~m} / 1 \mu \mathrm{~m}$ ? What totem-pole current flows at $v_{I}$ equal to the threshold voltage?
$\mathbf{D}^{* 15.60}$ Consider the choice of values for $R_{1}$ and $R_{2}$ in the circuit of Fig. 15.38(c). Let the inverter be specified as in Problem 15.58 with the MOSFETs matched and $(W / L)_{P}=$ $2.5(W / L)_{n}$. An important consideration in making this choice is that the loss of base drive current will be limited. This loss becomes particularly acute when the current through $Q_{N}$ and $Q_{P}$ becomes small. This in turn happens near the end of the output signal swing when the associated MOS device is deeply in triode operation (say at $\left|v_{D S}\right|=\left|V_{t}\right| / 3$ ). Determine values for $R_{1}$ and $R_{2}$ so that the loss in base current is limited to $50 \%$. What is the ratio $R_{1} / R_{2}$ ? Repeat for a $20 \%$ loss in base drive.

D 15.61 Sketch the circuit of a BiCMOS two-input NOR gate based on the $R$-circuit of Fig. 15.38(e).

[^0]
[^0]:    $\mathbf{S I N}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; $D=$ design problem
# CHAPTER 16 

## Memory Circuits

Introduction 1237
16.1 Latches and Flip-Flops 1238
16.2 Semiconductor Memories: Types and Architectures 1249
16.3 Random-Access Memory (RAM) Cells 1253
16.4 Sense Amplifiers and Address Decoders 1262
16.5 Read-Only Memory (ROM) 1276
16.6 CMOS Image Sensors 1281

Summary 1282
Problems 1283
# IN THIS CHAPTER YOU WILL LEARN 

1. How the basic bistable circuit, the latch, is realized by connecting two inverters in a positive-feedback loop.
2. How to augment the latch to obtain different types of flip-flops that are useful building blocks for digital systems.
3. How CMOS is particularly suited for the efficient implementation of a particular type of flip-flop, the $D$ flip-flop.
4. How memory chips that contain as many as 4 gigabits are organized, as well as their various types and the terminology used to describe them.
5. The analysis and design of the six-transistor circuit that is almost universally used to implement the storage cell in static random-access memory (SRAM) and the one-transistor circuit that is equally universal in the implementation of the storage cell in dynamic random-access memory (DRAM).
6. Interesting circuit techniques for accessing a particular storage cell in a memory chip and for amplifying the signal readout from the cell.
7. How various types of read-only memory (ROM) are designed, programmed, erased, and reprogrammed.
8. How the basic image-capturing element works in digital cameras (including smartphone cameras).

## Introduction

The logic circuits studied in Chapters 14 and 15 are called combinational circuits. Their output depends only on the present value of the input. Thus these circuits do not have memory. Memory is a very important part of digital systems. Its availability in digital computers allows for storing programs and data. Furthermore, it is important for temporary storage of the output produced by a combinational circuit for use at a later time in the operation of a digital system.

Logic circuits that incorporate memory are called sequential circuits; that is, their output depends not only on the present value of the input but also on the input's previous values. Such circuits require a timing generator (a clock) for their operation.

There are basically two approaches for providing memory to a digital circuit. The first relies on the application of positive feedback that, as will be seen shortly, can be arranged
to provide a circuit with two stable states. Such a bistable circuit can then be used to store one bit of information: One stable state would correspond to a stored 0 , and the other to a stored 1. A bistable circuit can remain in either state indefinitely, and thus it belongs to the category of static sequential circuits. The other approach to realizing memory utilizes the storage of charge on a capacitor: When the capacitor is charged, it would be regarded as storing a 1 ; when it is discharged, it would be storing a 0 . Since the inevitable leakage effects will cause the capacitor to discharge, such a form of memory requires the periodic recharging of the capacitor, a process known as refresh. Thus, like dynamic logic (Section 15.5), memory based on charge storage is known as dynamic memory and the corresponding sequential circuits as dynamic sequential circuits.

This chapter is concerned with the study of memory circuits. We begin in Section 16.1 with the basic bistable circuit, the latch, and its application in flip-flops, an important class of building blocks for digital systems. After an overview of memory-chip types, organization, and nomenclature in Section 16.2, we study the circuit of the static memory cell (SRAM) and that of the dynamic memory cell (DRAM) in Section 16.3. Besides the array of storage cells, memory chips require circuits for selecting and accessing a particular cell in the array (address decoders) and for amplifying the signal that is retrieved from a particular cell (sense amplifiers). A sampling of these peripheral circuits is presented in Section 16.4. An important class of memories, the read-only memory (ROM) is presented in Section 16.5. The chapter concludes with a brief look at a very important system component, the CMOS image sensor. Having a structure very similar to that of a memory array, the image sensor is the basic image-capturing element in digital cameras (including smartphone cameras).

# 16.1 Latches and Flip-Flops 

In this section, we shall study the basic memory element, the latch, and consider a sampling of its applications. Both static and dynamic circuits will be considered.

### 16.1.1 The Latch

The basic memory element, the latch, is shown in Fig. 16.1(a). It consists of two cross-coupled logic inverters, $\mathrm{G}_{1}$ and $\mathrm{G}_{2}$. The inverters form a positive-feedback loop. To investigate the operation of the latch we break the feedback loop at the input of one of the inverters, say $\mathrm{G}_{1}$, and apply an input signal, $v_{W}$, as shown in Fig. 16.1(b). Assuming that the input impedance of $\mathrm{G}_{1}$ is large, breaking the feedback loop will not change the loop voltage-transfer characteristic, which can be determined from the circuit of Fig. 16.1(b) by plotting $v_{Z}$ versus $v_{W}$. This is the voltage-transfer characteristic of two cascaded inverters and thus takes the shape shown in Fig. 16.1(c). Observe that the transfer characteristic consists of three segments, with the middle segment corresponding to the transition region of the inverters.

Also shown in Fig. 16.1(c) is a straight line with unity slope. This straight line represents the relationship $v_{W}=v_{Z}$ that is realized by reconnecting $Z$ to $W$ to close the feedback loop and thus to return it to its original form. As indicated, the straight line intersects the loop transfer curve at three points, A, B, and C. Thus any of these three points can serve as the operating point for the latch. We shall now show that while points A and C are stable operating points in the sense that the circuit can remain at either one indefinitely, point B is an unstable operating point; the latch cannot operate at B for any significant period of time.


Figure 16.1 (a) Basic latch. (b) The latch with the feedback loop opened. (c) Determining the operating point(s) of the latch.

The reason point B is unstable can be seen by considering the latch circuit in Fig. 16.1(a) to be operating at point B , and taking account of the electrical interference (or noise) that is inevitably present in any circuit. Let the voltage $v_{W}$ increase by a small increment $v_{w}$. The voltage at $X$ will increase (in magnitude) by a larger increment, equal to the product of $v_{w}$ and the incremental gain of $\mathrm{G}_{1}$ at point B . The resulting signal $v_{s}$ is applied to $\mathrm{G}_{2}$ and gives rise to an even larger signal at node $Z$. The voltage $v_{z}$ is related to the original increment $v_{w}$ by the loop gain at point B , which is the slope of the curve of $v_{Z}$ versus $v_{W}$ at point B . This gain is usually much greater than unity. Since $v_{z}$ is coupled to the input of $\mathrm{G}_{1}$, it becomes the new value of $v_{W}$ and is further amplified by the loop gain. This regenerative process continues, shifting the operating point from B upward to point C, as illustrated in Fig. 16.2. Since at C the loop gain is zero (or almost zero), no regeneration can take place.

In the description above, we assumed arbitrarily an initial positive voltage increment at $W$. Had we instead assumed a negative voltage increment, we would have seen that the operating point moves downward from B to A. Again, since at point A the slope of the transfer curve is zero (or almost zero), no regeneration can take place. In fact, for regeneration to occur, the loop gain must be greater than unity, which is the case at point B.

The discussion above leads us to conclude that the latch has two stable operating points, A and C. At point $\mathrm{C}, v_{W}$ is high, $v_{X}$ is low, $v_{Y}$ is low, and $v_{Z}$ is high. The reverse is true at point A. If we consider $X$ and $Z$ as the latch outputs, we see that in one of the stable states (say that corresponding to operating point A), $v_{X}$ is high (at $V_{O H}$ ) and $v_{Z}$ is low (at $V_{O L}$ ). In the other state (corresponding to operating point C ), $v_{X}$ is low (at $V_{O L}$ ) and $v_{Z}$ is high (at $V_{O H}$ ). Thus the latch is a bistable circuit having two complementary outputs. The stable state in which the latch operates depends on the external excitation that forces it to the particular state. The latch then memorizes this external action by staying indefinitely in the acquired state. As a memory element the latch is capable of storing one bit of information. For instance, we can arbitrarily designate the state in which $v_{X}$ is high and $v_{Z}$ is low as corresponding to a stored logic 1. The other complementary state then is designated by a stored logic 0 . Finally, we note that the latch circuit described is of the static variety.


Figure 16.2 Point B is an unstable operating point for the latch: A small positive increment $v_{w}$ gets amplified around the loop and causes the operating point to shift to the stable operating point C . Had $v_{w}$ been negative, the operating point would have shifted to the other stable point, A.

It now remains to devise a mechanism by which the latch can be triggered to change state. The latch together with the triggering circuitry forms a flip-flop. This will be discussed next. Analog bistable circuits utilizing op amps will be presented in Chapter 18.

# 16.1.2 The SR Flip-Flop 

The simplest type of flip-flop is the set/reset (SR) flip-flop shown in Fig. 16.3(a). It is formed by cross-coupling two NOR gates, and thus it incorporates a latch. The second inputs of $\mathrm{G}_{1}$ and $\mathrm{G}_{2}$ together serve as the trigger inputs of the flip-flop. These two inputs are labeled $S$ (for set) and $R$ (for reset). The outputs are labeled $Q$ and $\bar{Q}$, emphasizing their complementarity. The flip-flop is considered to be set (i.e., storing a logic 1) when $Q$ is high and $\bar{Q}$ is low. When the flip-flop is in the other state ( $Q$ low, $\bar{Q}$ high), it is considered to be reset (storing a logic 0 ).

In the rest or memory state (i.e., when we do not wish to change the state of the flip-flop), both the $S$ and $R$ inputs should be low. Consider the case when the flip-flop is storing a logic 0 . Since $Q$ will be low, both inputs to the NOR gate $\mathrm{G}_{2}$ will be low. Its output will therefore be high. This high is applied to the input of $\mathrm{G}_{1}$, causing its output $Q$ to be low, satisfying the original assumption. To set the flip-flop we raise $S$ to the logic-1 level while leaving $R$ at 0 .

## FLIP-FLOP FACT:

In 1918 William H. Eccles and Frank W. Jordan, while working at City and Guilds Technical College in London, filed the first patent for an electronic bistable element, the bellwether of the digital electronic age. The initial design captured the idea of a closed positive-feedback loop involving two inverting direct-coupled amplifiers, along with "gating" to allow signals to be injected. While the first designs used vacuum tubes, the same structure was extended to bipolar and MOS transistors as those technologies became commercially available. The Eccles-Jordan flip-flop remains, nearly a century later, as an enormous milestone in digital computing.

(a)

(b)

Figure 16.3 (a) The set/reset (SR) flip-flop and (b) its truth table.

The 1 at the $S$ terminal will force the output of $\mathrm{G}_{2}, \bar{Q}$, to 0 . Thus the two inputs to $\mathrm{G}_{1}$ will be 0 and its output $Q$ will go to 1 . Now even if $S$ returns to 0 , the $Q=1$ signal fed to the input of $\mathrm{G}_{2}$ will keep $\bar{Q}=0$, and the flip-flop will remain in the newly acquired set state. Note that if we raise $S$ to 1 again (with $R$ remaining at 0 ), no change will occur. To reset the flip-flop we need to raise $R$ to 1 while leaving $S=0$. We can readily show that this forces the flip-flop into the reset state $(Q=0, \bar{Q}=1)$ and that the flip-flop remains in this state even after $R$ has returned to 0 . It should be observed that the trigger signal merely starts the regenerative action of the positive-feedback loop of the latch.

Finally, we inquire into what happens if both $S$ and $R$ are simultaneously raised to 1 . The two NOR gates will cause both $Q$ and $\bar{Q}$ to become 0 (note that in this case the complementary labeling of these two variables is incorrect). However, if $R$ and $S$ return to the rest state $(R=S=0)$ simultaneously, the state of the flip-flop will be undefined. In other words, it will be impossible to predict the final state of the flip-flop. For this reason, this input combination is usually disallowed (i.e., not used). Note, however, that this situation arises only in the idealized case, when both $R$ and $S$ return to 0 precisely simultaneously. In actual practice one of the two will return to 0 first, and the final state will be determined by the input that remains high longest.

The operation of the flip-flop is summarized by the truth table in Fig. 16.3(b), where $Q_{n}$ denotes the value of $Q$ at time $t_{n}$ just before the application of the $R$ and $S$ signals, and $Q_{n+1}$ denotes the value of $Q$ at time $t_{n+1}$ after the application of the input signals.

Rather than using two NOR gates, one can also implement an SR flip-flop by cross-coupling two NAND gates, in which case the set and reset functions are active when low (see Problem 16.3).

# 16.1.3 CMOS Implementation of SR Flip-Flops 

The SR flip-flop of Fig. 16.3 can be directly implemented in CMOS by simply replacing each of the NOR gates by its CMOS circuit realization. We encourage the reader to sketch the resulting circuit (see Problem 16.2). Although the CMOS circuit thus obtained works well, it is somewhat complex. As an alternative, we consider a simplified circuit that furthermore implements additional logic. Specifically, Fig. 16.4 shows a clocked version of an SR flip-flop. Since the clock inputs form AND functions with the set and reset inputs, the flip-flop can be set or reset only when the clock $\phi$ is high. Observe that although the two cross-coupled inverters at the heart of the flip-flop are of the standard CMOS type, only NMOS transistors are used for the set-reset circuitry. Nevertheless, since there is no conducting path between $V_{D D}$ and ground (except during switching), the circuit does not dissipate any static power.

Except for the addition of clocking, the SR flip-flop of Fig. 16.4 operates in exactly the same way as its logic antecedent in Fig. 16.3: To illustrate, consider what happens when the

Figure 16.4 CMOS implementation of a clocked SR flip-flop. The clock signal is denoted by $\phi$.
flip-flop is in the reset state $\left(Q=0, \bar{Q}=1, v_{Q}=0, v_{\bar{Q}}=V_{D D}\right)$, and assume that we wish to set it. To do so, we arrange for a high $\left(V_{D D}\right)$ signal to appear on the $S$ input while $R$ is held low at 0 V . Then, when the clock $\phi$ goes high, both $Q_{5}$ and $Q_{6}$ will conduct, pulling the voltage $v_{\bar{Q}}$ down. If $v_{\bar{Q}}$ goes below the threshold $V_{M}$ of the $\left(Q_{3}, Q_{4}\right)$ inverter, the inverter will switch states (or at least begin to switch states), and its output $v_{Q}$ will rise. This increase in $v_{Q}$ is fed back to the input of the $\left(Q_{1}, Q_{2}\right)$ inverter, causing its output $v_{\bar{Q}}$ to go down even further; the regeneration process, characteristic of the positive-feedback latch, is now in progress.

The preceding description of flip-flop switching is predicated on two assumptions:

1. Transistors $Q_{5}$ and $Q_{6}$ supply sufficient current to pull the node $\bar{Q}$ down to a voltage at least slightly below the threshold of the $\left(Q_{3}, Q_{4}\right)$ inverter. This is essential for the regenerative process to begin. Without this initial trigger, the flip-flop will fail to switch. In Example 16.1, we shall investigate the minimum W/L ratios that $Q_{5}$ and $Q_{6}$ must have to meet this requirement.
2. The set signal remains high for an interval long enough to cause regeneration to take over the switching process. An estimate of the minimum width required for the set pulse can be obtained as the sum of the interval during which $v_{\bar{Q}}$ is reduced from $V_{D D}$ to $V_{D D} / 2$, and the interval for the voltage $v_{Q}$ to respond and rise to $V_{D D} / 2$. This point also will be illustrated in Example 16.1.

Finally, note that the symmetry of the circuit indicates that all the preceding remarks apply equally well to the reset process.

# Example 16.1 

The CMOS SR flip-flop in Fig. 16.4 is fabricated in a $0.18-\mu \mathrm{m}$ process for which $\mu_{u} C_{o s}=4 \mu_{p} C_{o s}=$ $300 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{m}=\left|V_{q r}\right|=0.5 \mathrm{~V}$, and $V_{D D}=1.8 \mathrm{~V}$. The inverters have $(W / L)_{u}=0.27 \mu \mathrm{~m} / 0.18 \mu \mathrm{~m}$ and $(W / L)_{p}=4(W / L)_{u}$. The four NMOS transistors in the set-reset circuit have equal $W / L$ ratios.
(a) Determine the minimum value required for this ratio to ensure that the flip-flop will switch.
(b) Also, determine the minimum width the set pulse must have for the case in which the W/L ratio of each of the four transistors in the set-reset circuit is selected at twice the minimum value found in (a). Assume that the total capacitance between each of the $Q$ and $\bar{Q}$ nodes and ground is 20 fF .

# Solution 

(a) Figure 16.5(a) shows the relevant portion of the circuit for our present purposes. Observe that since the circuit is in the reset state and regeneration has not yet begun, we assume that $v_{Q}=0$ and thus $Q_{2}$ will be conducting. The circuit is in effect a pseudo-NMOS gate, and our task is to select the $W / L$ ratios for $Q_{5}$ and $Q_{6}$ so that $V_{D L}$ of this inverter is lower than $V_{D D} / 2$ (the threshold of the $Q_{5}, Q_{4}$ inverter whose $Q_{N}$ and $Q_{P}$ are matched). The minimum required $W / L$ for $Q_{5}$ and $Q_{6}$ can be found by equating the current supplied by $Q_{5}$ and $Q_{6}$ to the current supplied by $Q_{2}$ at $v_{\bar{Q}}=V_{D D} / 2$. To simplify matters, we assume that the series connection of $Q_{5}$ and $Q_{6}$ is equivalent to a single transistor whose $W / L$ is half the $W / L$ of each of $Q_{5}$ and $Q_{6}$ [Fig. 16.5(b)]. Now, since at $v_{\bar{Q}}=V_{D D} / 2=0.9 \mathrm{~V}$ and $\left|V_{i}\right|=0.5 \mathrm{~V}$, both this equivalent transistor and $Q_{2}$ will be operating in the triode region, we can write

$$
\begin{gathered}
I_{D e q}=I_{D 2} \\
300 \times \frac{1}{2}\left(\frac{W}{L}\right)_{5}\left[(1.8-0.5)\left(\frac{1.8}{2}\right)-\frac{1}{2}\left(\frac{1.8}{2}\right)^{2}\right] \\
=75 \times \frac{1.08}{0.18}\left[(1.8-0.5)\left(\frac{1.8}{2}\right)-\frac{1}{2}\left(\frac{1.8}{2}\right)^{2}\right]
\end{gathered}
$$


(a)

(b)

Figure 16.5 (a) The relevant portion of the flip-flop circuit of Fig. 16.4 for determining the minimum W/L ratios of $Q_{5}$ and $Q_{6}$ needed to ensure that the flip-flop will switch. (b) The circuit in (a) with $Q_{5}$ and $Q_{6}$ replaced with their equivalent transistor $Q_{\mathrm{eq}}$, at the point of switching.
# Example 16.1 continued 

which yields

$$
\left(\frac{W}{L}\right)_{5}=\frac{0.54 \mu \mathrm{~m}}{0.18 \mu \mathrm{~m}}
$$

and thus

$$
\left(\frac{W}{L}\right)_{6}=\frac{0.54 \mu \mathrm{~m}}{0.18 \mu \mathrm{~m}}
$$

(b) The value calculated for $(W / L)_{5}$ and $(W / L)_{6}$ is the absolute minimum needed for switching to occur. To guarantee that the flip-flop will switch, the value selected for $(W / L)_{5}$ and $(W / L)_{6}$ is usually somewhat larger than the minimum. Selecting a value twice the minimum,

$$
(W / L)_{5}=(W / L)_{6}=1.08 \mu \mathrm{~m} / 0.18 \mu \mathrm{~m}
$$

The minimum required width of the set pulse is composed of two components: the time for $v_{\bar{Q}}$ in the circuit of Fig. 16.5(a) to fall from $V_{D D}$ to $V_{D D} / 2$, where $V_{D D} / 2$ is the threshold voltage of the inverter formed by $Q_{3}$ and $Q_{4}$ in Fig. 16.4, and the time for the output of the $Q_{3}-Q_{4}$ inverter to rise from 0 to $V_{D D} / 2$. At the end of the second time interval, the feedback signal will have traveled around the feedback loop, and regeneration can continue without the presence of the set pulse. We will denote the first component $t_{P H L}$ and the second $t_{P L H}$, and will calculate their values as follows.

To determine $t_{P H L}$ refer to the circuit in Fig. 16.6 and note that the capacitor discharge current $i_{C}$ is the difference between the current of the equivalent transistor $Q_{e q}$ and the current of $Q_{2}$,

$$
i_{C}=i_{D e q}-i_{D 2}
$$

To determine the average discharge current $i_{C}$, we calculate $i_{D e q}$ and $i_{D 2}$ at $t=0$ and $t=t_{P H L}$. At $t=0$, $v_{\bar{Q}}=V_{D D}$, thus $Q_{2}$ is off,

$$
i_{D 2}(0)=0
$$

and $Q_{e q}$ is in saturation,

$$
\begin{aligned}
i_{D e q} & =\frac{1}{2} \times 300 \times \frac{1}{2} \times \frac{1.08}{0.18} \times(1.8-0.5)^{2} \\
& =760.5 \mu \mathrm{~A}
\end{aligned}
$$

Thus,

$$
i_{C}(0)=760.5-0=760.5 \mu \mathrm{~A}
$$


Figure 16.6 Determining the time $t_{P H L}$ for $v_{\bar{Q}}$ to fall from $V_{D D}$ to $V_{D D} / 2$.

At $t=t_{P H L}, v_{\bar{Q}}=V_{D D} / 2$, thus both $Q_{2}$ and $Q_{\text {eq }}$ will be in the triode region,

$$
\begin{aligned}
i_{D 2}\left(t_{P H L}\right) & =75 \times \frac{1.08}{0.18} \times\left[(1.8-0.5)\left(\frac{1.8}{2}\right)-0.5\left(\frac{1.8}{2}\right)^{2}\right] \\
& =344.25 \mu \mathrm{~A}
\end{aligned}
$$

and

$$
\begin{aligned}
i_{D \mathrm{eq}}\left(t_{P H L}\right) & =300 \times \frac{1}{2} \times \frac{1.08}{0.18}\left[(1.8-0.5)\left(\frac{1.8}{2}\right)-0.5\left(\frac{1.8}{2}\right)^{2}\right] \\
& =688.5 \mu \mathrm{~A}
\end{aligned}
$$

Thus,

$$
i_{C}\left(t_{P H L}\right)=688.5-344.25=344.25 \mu \mathrm{~A}
$$

and the average value of $i_{C}$ over the interval $t=0$ to $t=t_{P H L}$ is

$$
\begin{aligned}
\left.i_{C}\right|_{o} & =\frac{i_{C}(0)+i_{C}\left(t_{P H L}\right)}{2} \\
& =\frac{760.5+344.25}{2}=552.4 \mu \mathrm{~A}
\end{aligned}
$$
# Example 16.1 continued 

We now can calculate $t_{P H L}$ as

$$
t_{P H L}=\frac{C\left(V_{D D} / 2\right)}{i_{C} \mid{ }_{\text {av }}}=\frac{20 \times 10^{-15} \times 0.9}{552.4 \times 10^{-6}}=32.6 \mathrm{ps}
$$

Next we consider the time $t_{P H L}$ for the output of the $Q_{3}-Q_{4}$ inverter, $v_{Q}$, to rise from 0 to $V_{D D} / 2$. The value of $t_{P L H}$ can be calculated using the propagation-delay formula derived in Chapter 14 (Eq. 14.52), which is also listed in Table 14.2, namely,

$$
t_{P L H}=\frac{\alpha_{p} C}{k_{p}(W / L)_{p} V_{D D}}
$$

where

$$
\alpha_{p}=2 /\left[\frac{7}{4}-\frac{3\left|V_{t p}\right|}{V_{D D}}+\left(\frac{\left|V_{t p}\right|}{V_{D D}}\right)^{2}\right]
$$

Substituting numerical values we obtain,

$$
\alpha_{p}=\frac{2}{1.75-\frac{3 \times 0.5}{1.8}+\left(\frac{0.5}{1.8}\right)^{2}}=2.01
$$

and

$$
t_{P L H}=\frac{2.01 \times 20 \times 10^{-15}}{75 \times 10^{-6} \times(1.08 / 0.18) \times 1.8}=49.7 \mathrm{ps}
$$

Finally, the minimum required width of the set pulse can be calculated as

$$
T_{\min }=t_{P H L}+t_{P L H}=82.3 \mathrm{ps}
$$

## EXERCISE

16.1 For the SR flip-flop specified in Example 16.1, find the minimum $W / L$ for both $Q_{5}$ and $Q_{6}$ so that switching is achieved when inputs $S$ and $\phi$ are at $\left(V_{D D} / 2\right)$.
Ans. 28.7
# 16.1.4 A Simpler CMOS Implementation of the Clocked SR Flip-Flop 

A simpler implementation of a clocked SR flip-flop is shown in Fig. 16.7. Here, pass-transistor logic is employed to implement the clocked set-reset functions. This circuit is very popular in the design of static random-access memory (SRAM) chips, where it is used as the basic memory cell (Section 16.4.1).

### 16.1.5 D Flip-Flop Circuits

A variety of flip-flop types exist and can be synthesized using logic gates. CMOS circuit implementations can be obtained by simply replacing the gates with their CMOS circuit realizations. This approach, however, usually results in rather complex circuits. In many cases, simpler circuits can be found by taking a circuit-design viewpoint, rather than a logic-design one. To illustrate this point, we shall consider the CMOS implementation of a very important type of flip-flop, the data, or D, flip-flop.

The D flip-flop is shown in block diagram form in Fig. 16.8. It has two inputs, the data input $D$ and the clock input $\phi$. The complementary outputs are labeled $Q$ and $\bar{Q}$. When the clock is low, the flip-flop is in the memory, or rest, state; signal changes on the $D$ input line have no effect on the state of the flip-flop. As the clock goes high, the flip-flop acquires the logic level that existed on the $D$ line just before the rising edge of the clock. Such a flip-flop is said to be edge triggered. Some implementations of the D flip-flop include direct set and reset inputs that override the clocked operation just described.


Figure 16.7 A simpler CMOS implementation of the clocked SR flip-flop. This circuit is popular as the basic cell in the design of static random-access memory (SRAM) chips.


Figure 16.8 A block diagram representation of the D flip-flop.


Figure 16.9 A simple implementation of the D flip-flop. The circuit in (a) utilizes the two-phase nonoverlapping clock whose waveforms are shown in (b).

A simple implementation of the D flip-flop is shown in Fig. 16.9. The circuit consists of two inverters connected in a positive-feedback loop, just as in the static latch of Fig. 16.1(a), except that here the loop is closed for only part of the time. Specifically, the loop is closed when the clock is low $(\phi=0, \bar{\phi}=1)$. The input $D$ is connected to the flip-flop through a switch that closes when the clock is high. Operation is straightforward: When $\phi$ is high, the loop is opened, and the input $D$ is connected to the input of inverter $\mathrm{G}_{1}$. The capacitance at the input node of $\mathrm{G}_{1}$ is charged to the value of $D$, and the capacitance at the input node of $\mathrm{G}_{2}$ is charged to the value of $\bar{D}$. Then, when the clock goes low, the input line is isolated from the flip-flop, the feedback loop is closed, and the latch acquires the state corresponding to the value of $D$ just before $\phi$ went down, providing an output $Q=D$.

From the preceding, we observe that the circuit in Fig. 16.9 combines the positive-feedback technique of static bistable circuits and the charge-storage technique of dynamic circuits. It is important to note that the proper operation of this circuit, and of many circuits that use clocks, is predicated on the assumption that $\phi$ and $\bar{\phi}$ will not be simultaneously high at any time. This condition is defined by referring to the two clock phases as being nonoverlapping.

An inherent drawback of the D flip-flop implementation of Fig. 16.9 is that during $\phi$, the output of the flip-flop simply follows the signal on the $D$ input line. This can cause problems in certain logic-design situations. The problem is solved very effectively by using the master-slave configuration shown in Fig. 16.10(a). Before discussing its circuit operation, we note that although the switches are shown implemented with single NMOS transistors, CMOS transmission gates are employed in many applications. We are simply using the single MOS transistor as a "shorthand notation" for a series switch.

The master-slave circuit consists of a pair of circuits of the type shown in Fig. 16.9, operated with alternate clock phases. Here, to emphasize that the two clock phases must be nonoverlapping, we denote them $\phi_{1}$ and $\phi_{2}$, and clearly show the nonoverlap interval in the waveforms of Fig. 16.10(b). Operation of the circuit is as follows:

1. When $\phi_{1}$ is high and $\phi_{2}$ is low, the input is connected to the master latch, whose feedback loop is opened, while the slave latch is isolated. Thus, the output $Q$ remains at the value stored previously in the slave latch, whose loop is now closed. The node capacitances of the master latch are charged to the appropriate voltages corresponding to the present value of $D$.
2. When $\phi_{1}$ goes low, the master latch is isolated from the input data line. Then, when $\phi_{2}$ goes high, the feedback loop of the master latch is closed, locking in the value of $D$. Further, its output is connected to the slave latch, whose feedback loop is now


Figure 16.10 (a) A master-slave D flip-flop. The switches can be, and usually are, implemented with CMOS transmission gates. (b) Waveforms of the two-phase nonoverlapping clock required.
open. The node capacitances in the slave are appropriately charged so that when $\phi_{1}$ goes high again, the slave latch locks in the new value of $D$ and provides it at the output, $Q=D$.

From this description, we note that at the positive transition of clock $\phi_{2}$ the output $Q$ adopts the value of $D$ that existed on the $D$ line at the end of the preceding clock phase, $\phi_{1}$. This output value remains constant for one clock period. Finally, note that during the nonoverlap interval both latches have their feedback loops open, and we are relying on the node capacitances to maintain most of their charge. It follows that the nonoverlap interval should be kept reasonably short (perhaps one-tenth or less of the clock period, and of the order of 1 ns or so in current practice).

# 16.2 Semiconductor Memories: Types and Architectures 

A computer system, whether a large machine or a microcomputer, requires memory for storing data and program instructions. Furthermore, within a given computer system there usually are various types of memory utilizing a variety of technologies and having different access
times. Broadly speaking, computer memory can be divided into two types: main memory and mass-storage memory. The main memory is usually the most rapidly accessible memory and the one from which most, often all, instructions in programs are executed. The main memory is usually of the random-access type. A random-access memory (RAM) is one in which the time required for storing (writing) information and for retrieving (reading) information is independent of the physical location (within the memory) in which the information is stored.

Random-access memories should be contrasted with serial or sequential memories, such as disks and tapes, from which data are available only in the sequence in which the data were originally stored. Thus, in a serial memory the time to access particular information depends on the memory location in which the required information is stored, and the average access time is longer than the access time of random-access memory. In a computer system, serial memory is used for mass storage. Items not frequently accessed, such as large parts of the computer operating system, are usually stored in a moving-surface memory such as magnetic disk.

Another important classification of memory relates to whether it is a read/write or a read-only memory. Read/write (R/W) memory permits data to be stored and retrieved at comparable speeds. Computer systems require random-access read/write memory for data and program storage.

Read-only memories (ROM) permit reading at the same high speeds as R/W memories (or perhaps higher) but restrict the writing operation. ROMs can be used to store a microprocessor operating-system program. They are also employed in operations that require table lookup, such as finding the values of mathematical functions. A popular application of ROMs is their use in video game cartridges. It should be noted that read-only memory is usually of the random-access type. Nevertheless, in the digital circuit jargon, the acronym RAM usually refers to read/write, random-access memory, while ROM is used for read-only memory.

The regular structure of memory circuits has made them an ideal application for the design of circuits of the very-large-scale integrated (VLSI) type. Indeed, at any moment, memory chips represent the state of the art in packing density and hence integration level. Beginning with the introduction of the 1-Kbit chip in 1970, memory-chip density has quadrupled about every 3 years. At the present time (2013), chips containing $4 \mathrm{Gbit}^{1}$ are available. In this and the next two sections, we shall study some of the basic circuits employed in VLSI RAM chips. Read-only memory circuits are studied in Section 16.5.

# 16.2.1 Memory-Chip Organization 

The bits on a memory chip are addressable either individually or in groups of 4 to 16 . As an example, a 64 -Mbit chip in which all bits are individually addressable is said to be organized as 64 M words $\times 1$ bit (or simply $64 \mathrm{M} \times 1$ ). Such a chip needs a 26 -bit address $\left(2^{26}=\right.$ $67,108,864=64 \mathrm{M}$ ). On the other hand, the 64 -Mbit chip can be organized as 16 M words $\times 4$ bits $(16 \mathrm{M} \times 4)$, in which case a 24 -bit address is required. For simplicity we shall assume in our subsequent discussion that all the bits on a memory chip are individually addressable.

The bulk of the memory chip consists of the cells in which the bits are stored. Each memory cell is an electronic circuit capable of storing one bit. We shall study memory-cell circuits in Section 16.3. For reasons that will become clear shortly, it is desirable to physically organize

[^0]
[^0]:    ${ }^{1}$ The capacity of a memory chip to hold binary information as binary digits (or bits) is measured in kilobit (Kbit), megabit (Mbit), and gigabit (Gbit) units, where $1 \mathrm{Kbit}=1024$ bits, $1 \mathrm{Mbit}=1024 \times 1024=$ $1,048,576$ bits, and $1 \mathrm{Gbit}=1024^{3}$ bits. Thus a 64 -Mbit chip contains $67,108,864$ bits of memory.


Figure 16.11 A $2^{M+N}$-bit memory chip organized as an array of $2^{M}$ rows $\times 2^{N}$ columns.
the storage cells on a chip in a square or a nearly square matrix. Figure 16.11 illustrates such an organization. The cell matrix has $2^{M}$ rows and $2^{N}$ columns, for a total storage capacity of $2^{M+N}$. For example, a 1M-bit square matrix would have 1024 rows and 1024 columns $(M=N=10)$. Each cell in the array is connected to one of the $2^{M}$ row lines, known rather loosely, but universally, as word lines, and to one of the $2^{N}$ column lines, known as digit lines or, more commonly, bit lines. A particular cell is selected for reading or writing by activating its word line and its bit line.

Activating one of the $2^{M}$ word lines is performed by the row decoder, a combinational logic circuit that selects (raises the voltage of) the particular word line whose $M$-bit address is applied to the decoder input. The address bits are denoted $A_{0}, A_{1}, \ldots, A_{M-1}$. When the $K$ th word line is activated for, say, a read operation, all $2^{N}$ cells in row $K$ will provide their contents to their respective bit lines. Thus, if the cell in column $L$ (Fig. 16.11) is storing a 1, the voltage of bit-line number $L$ will be raised, usually by a small voltage, say 0.1 V to 0.2 V . The readout voltage is small because the cell is small, a deliberate design decision, since the number of cells is very large. The small readout signal is applied to a sense amplifier connected to the bit line. As Fig. 16.11 indicates, there is a sense amplifier for every bit line. The sense amplifierprovides a full-swing digital signal (from 0 to $V_{D D}$ ) at its output. This signal, together with the output signals from all the other cells in the selected row, is then delivered to the column decoder. The column decoder selects the signal of the particular column whose $N$-bit address is applied to the decoder input (the address bits are denoted $A_{M}, A_{M+1}, \ldots, A_{M+N-1}$ ) and causes this signal to appear on the chip input/output (I/O) data line.

A write operation proceeds in a similar manner: The data bit to be stored (1 or 0 ) is applied to the I/O line. The cell in which the data bit is to be stored is selected through the combination of its row address and its column address. The sense amplifier of the selected column acts as a driver to write the applied signal into the selected cell. Circuits for sense amplifiers and address decoders will be studied in Section 16.4.

Before leaving the topic of memory organization (or memory-chip architecture), we wish to mention a relatively recent innovation in organization dictated by the exponential increase in chip density. To appreciate the need for a change, note that as the number of cells in the array increases, the physical lengths of the word lines and the bit lines increase. This has occurred even though for each new generation of memory chips, the transistor size has decreased (currently, CMOS process technologies with 22-nm feature size are utilized). The net increase in word-line and bit-line lengths increases their total resistance and capacitance, and thus slows down their transient response. That is, as the lines lengthen, the exponential rise of the voltage of the word line becomes slower, and it takes longer for the cells to be activated. This problem has been solved by partitioning the memory chip into a number of blocks. Each of the blocks has an organization identical to that in Fig. 16.11. The row and column addresses are broadcast to all blocks, but the data selected come from only one of the blocks. Block selection is achieved by using an appropriate number of the address bits as a block address. Such an architecture can be thought of as three-dimensional: rows, columns, and blocks.

# 16.2.2 Memory-Chip Timing 

The memory access time is the time between the initiation of a read operation and the appearance of the output data. The memory cycle time is the minimum time allowed between two consecutive memory operations. To be on the conservative side, a memory operation is usually taken to include both read and write (in the same location). MOS memories have access and cycle times in the range of a few to a few hundred nanoseconds.

## EXERCISES

16.2 A 4-Mbit memory chip is partitioned into 32 blocks, with each block having 1024 rows and 128 columns. Give the number of bits required for the row address, column address, and block address. Ans. 10; 7; 5
16.3 The word lines in a particular MOS memory chip are fabricated using polysilicon (see Appendix A). The resistance of each word line is estimated to be $5 \mathrm{k} \Omega$, and the total capacitance between the line and ground is 2 pF . Find the time for the voltage on the word line to reach $V_{D D} / 2$, assuming that the line is driven by a voltage $V_{D D}$ provided by a low-impedance inverter. (Note: The line is actually a distributed network that we are approximating by means of a lumped circuit consisting of a single resistor and a single capacitor.)
Ans. 6.9 ns
# 16.3 Random-Access Memory (RAM) Cells 

As mentioned in Section 16.2, the major part of the memory chip is taken up by the storage cells. It follows that to be able to pack a large number of bits on a chip, it is imperative that the cell be reduced to the smallest size possible. The power dissipation per cell should be minimized also. Thus, many of the flip-flop circuits studied in Section 16.1 are too complex to be suitable for implementing the storage cells in a RAM chip.

There are basically two types of MOS RAM: static and dynamic. Static RAMs (called SRAMs for short) utilize static latches as the storage cells. Dynamic RAMs (called DRAMs), on the other hand, store the binary data on capacitors, resulting in further reduction in cell area, but at the expense of more complex read and write circuitry. In particular, while static RAMs can hold their stored data indefinitely, provided the power supply remains on, dynamic RAMs require periodic refreshing to regenerate the data stored on capacitors. This is because the storage capacitors will discharge, though slowly, as a result of the leakage currents inevitably present. By virtue of their smaller cell size, dynamic memory chips are usually four times as dense as their contemporary static chips. Thus while the state of the art in 2013 is a 4 -Gbit DRAM chip, the highest-density SRAM chip has 1-Gbit capacity. Both static and dynamic RAMs are volatile; that is, they require the continuous presence of a power supply. By contrast, most ROMs are of the nonvolatile type, as we shall see in Section 16.5. In the following subsections, we shall study basic SRAM and DRAM storage cells.

### 16.3.1 Static Memory (SRAM) Cell

Figure 16.12 shows a typical static memory cell in CMOS technology. The circuit, which we encountered in Section 16.1, is a flip-flop comprising two cross-coupled inverters and two access transistors, $Q_{5}$ and $Q_{6}$. The access transistors are turned on when the word line is selected and its voltage raised to $V_{D D}$, and they connect the flip-flop to the column (bit or $B$ ) line and column (bit or $\bar{B}$ ) line. Note that although in principle only the $B$ or the $\bar{B}$ line suffices, most often both are utilized, as shown in Fig. 16.12. This practice both provides a


Figure 16.12 A CMOS SRAM memory cell.


Figure 16.13 Relevant parts of the SRAM cell circuit during a read operation when the cell is storing a logic 1 . Note that initially $v_{Q}=V_{D D}$ and $v_{\bar{Q}}=0$. Also note that the $B$ and $\bar{B}$ lines are precharged to a voltage $V_{D D}$.
differential data path between the cell and the memory-chip output and increases the circuit reliability. The access transistors act as transmission gates allowing bidirectional current flow between the flip-flop and the $B$ and $\bar{B}$ lines. Finally, we note that this circuit is known as the six-transistor or 6 T cell.

The Read Operation Consider first a read operation, and assume that the cell is storing a 1. In this case, $Q$ will be high at $V_{D D}$, and $\bar{Q}$ will be low at 0 V . Before the read operation begins, the $B$ and $\bar{B}$ lines are raised to a voltage in the range $V_{D D} / 2$ to $V_{D D}$. This process, known as precharging, is performed using circuits we shall discuss in Section 16.4 in conjunction with the study of sense amplifiers. To simplify matters, we shall assume here that the precharge voltage of $B$ and $\bar{B}$ is $V_{D D}$.

When the word line is selected and the access transistors $Q_{5}$ and $Q_{6}$ are turned on, examination of the circuit reveals that the only portion that will be conducting is that shown in Fig. 16.13. Noting that the initial value of $v_{\bar{Q}}$ is 0 V , we can see that current will flow from the $\bar{B}$ line (actually, from the $\bar{B}$-line capacitance $C_{\bar{B}}$ ) through $Q_{5}$ and into capacitor $C_{\bar{Q}}$, which is the small equivalent capacitance between the $\bar{Q}$ node and ground. This current charges $C_{\bar{Q}}$ and thus $v_{\bar{Q}}$ rises and $Q_{1}$ conducts, sinking some of the current supplied by $Q_{5}$. Equilibrium will be reached when $C_{\bar{Q}}$ is charged to a voltage $V_{\bar{Q}}$ at which $I_{1}$ equals $I_{5}$, and no current flows through $C_{\bar{Q}}$. Here it is extremely important to note that to avoid changing the state of the flip-flop, that is, for our read operation to be nondestructive, $V_{\bar{Q}}$ must not exceed the threshold voltage of the inverter $Q_{3}-Q_{4}$. In fact, SRAM designers usually impose a more stringent requirement on the value of $V_{\bar{Q}}$, namely, that it should be lower than the threshold voltage of $Q_{3}, V_{m}$. Thus, the design problem we shall now solve is as follows: Determine the ratio of $(W / L)_{5} /(W / L)_{1}$ so that $V_{\bar{Q}} \leq V_{m}$.

Noting that $Q_{5}$ will be operating in saturation and neglecting, for simplicity, the body effect, we can write

$$
I_{5}=\frac{1}{2}\left(\mu_{a} C_{o s}\right)\left(\frac{W}{L}\right)_{5}\left(V_{D D}-V_{m}-V_{\bar{Q}}\right)^{2}
$$

Transistor $Q_{1}$ will be operating in the triode region, and its current $I_{1}$ can be written as

$$
I_{1}=\left(\mu_{a} C_{o s}\right)\left(\frac{W}{L}\right)_{1}\left[\left(V_{D D}-V_{m}\right) V_{\bar{Q}}-\frac{1}{2} V_{\bar{Q}}^{2}\right]
$$


Figure 16.14 The normalized value of $V_{\mathcal{Q}}$ versus the ratio $(W / L)_{n} /(W / L)_{1}$ for the circuit in Fig. 16.13. This graph can be used to determine the maximum value permitted for $(W / L)_{5} /(W / L)_{1}$ so that $V_{\mathcal{Q}}$ is kept below a desired level.

Equating $I_{5}$ and $I_{1}$ gives a quadratic equation in $V_{\mathcal{Q}}$, which can be solved to obtain

$$
\frac{V_{\mathcal{Q}}}{V_{D D}-V_{m}}=1-1 / \sqrt{1+\frac{(W / L)_{5}}{(W / L)_{1}}}
$$

This is an attractive relationship, since it provides $V_{\mathcal{Q}}$ in normalized form and thus always applies, independent of the process technology utilized. Figure 16.14 shows a universal plot of $\left[V_{\mathcal{Q}} /\left(V_{D D}-V_{m}\right)\right]$ versus $(W / L)_{5} /(W / L)_{1}$. For a given process technology, $V_{D D}$ and $V_{m}$ are determined, and the plot in Fig. 16.14 can be used to determine the maximum value permitted for $(W / L)_{5} /(W / L)_{1}$ while keeping $V_{\mathcal{Q}}$ below a desired value. Alternatively, we can derive a formula for this purpose. For instance, if $V_{\mathcal{Q}}$ is to be kept below $V_{m}$, the ratio of $(W / L)_{5}$ to $(W / L)_{1}$ must be kept below the value obtained from Eq. (16.3), that is,

$$
\frac{(W / L)_{5}}{(W / L)_{1}} \leq \frac{1}{\left(1-\frac{V_{m}}{V_{D D}-V_{m}}\right)^{2}}-1
$$

This is an important design constraint that can be expressed in a slightly more general form by replacing $(W / L)_{5}$ with $(W / L)_{n}$, where the subscript $a$ denotes access transistors $Q_{5}$ and $Q_{6}$, and $(W / L)_{1}$ with $(W / L)_{n}$, which is the $W / L$ ratio of $Q_{N}$ in each of the two inverters; thus,

$$
\frac{(W / L)_{a}}{(W / L)_{n}} \leq \frac{1}{\left(1-\frac{V_{m}}{V_{D D}-V_{m}}\right)^{2}}-1
$$
# EXERCISE 

16.4 Find the maximum allowable $W / L$ for the access transistors of the SRAM cell in Fig. 16.12 so that in a read operation, the voltages at $Q$ and $\bar{Q}$ do not change by more than $\left|V_{t}\right|$. Assume that the SRAM is fabricated in a $0.18-\mu \mathrm{m}$ technology for which $V_{D D}=1.8 \mathrm{~V}, V_{m}=\left|V_{g t}\right|=0.5 \mathrm{~V}$ and that $(W / L)_{n}=1.5$. Ans. $(W / L)_{n} \leq 2.5$

Having determined the constraint imposed by the read operation on the W/L ratios of the access transistors, we now return to the circuit in Fig. 16.13, and show in Fig. 16.15 the voltage waveforms at various nodes during a read-1 operation. Observe that as we have already discussed, $v_{\bar{Q}}$ rises from zero to a voltage $V_{\bar{Q}} \leq V_{m}$. Correspondingly, the change in $v_{Q}$ will be very small, justifying the assumption implicit in the analysis above that $v_{Q}$ remains constant at $V_{D D}$. Most important, note that the voltage of the $\bar{B}$ line, $v_{\bar{B}}$, decreases by a small amount $\Delta V$. This is a result of the discharge of the capacitance of the $\bar{B}$ line, $C_{\bar{B}}$, by the current $I_{S}$. Assuming that $I_{S}$ reaches its equilibrium value in Eq. (16.1) relatively quickly, capacitor $C_{\bar{B}}$ is in effect discharged by a constant current $I_{S}$ and the change in its voltage, $\Delta V$, obtained in a time interval $\Delta t$, can be found by writing a charge-balance equation,

$$
I_{S} \Delta t=C_{\bar{B}} \Delta V
$$

Thus,

$$
\Delta V=\frac{I_{S} \Delta t}{C_{\bar{B}}}
$$





Figure 16.15 Voltage waveforms at various nodes in the SRAM cell during a read-1 operation.
Here we note that $C_{\bar{B}}$ is usually relatively large $(1-2 \mathrm{pF})$ because a large number of cells are connected to the $\bar{B}$ line. The incremental change $\Delta V$ is therefore rather small $(0.1-0.2 \mathrm{~V})$, necessitating the use of a sense amplifier. If the sense amplifier requires a minimum decrement $\Delta V$ in $v_{\bar{B}}$ to detect the presence of a " 1 ," then the read delay time can be found from Eq. (16.6) as

$$
\Delta t=\frac{C_{\bar{B}} \Delta V}{I_{5}}
$$

This equation indicates the need for a relatively large $I_{5}$ to reduce the delay time $\Delta t$. A large $I_{5}$, however, implies selecting $(W / L)_{o}$ near the upper bound given by Eq. (16.5), which in turn means an increase in the silicon area occupied by the access transistors and hence the cell area, an interesting design trade-off.

# EXERCISE 

16.5 For the SRAM cell considered in Exercise 16.4 whose $(W / L)_{o}=1.5$ and $(W / L)_{o} \leq 2.5$, use Eq. (16.7) to determine the read delay $\Delta t$ in two cases: (a) $(W / L)_{o}=2.5$ and (b) $(W / L)_{o}=1.5$. Let $\mu_{n} C_{o s}=300 \mu \mathrm{~A} / \mathrm{V}^{2}$. In both cases, assume that $C_{\bar{B}}=2 \mathrm{pF}$ and that the sense amplifier requires a $\Delta V$ of minimum magnitude of 0.2 V . (Hint: Use Eq. 16.1 to determine $I_{5}$, and Eq. 16.3 to determine $V_{\bar{Q}}$.) Ans. $1.7 \mathrm{~ns} ; 2.1 \mathrm{~ns}$

We conclude our discussion of the read operation with two remarks:

1. Although we considered only the read-1 operation, the read-0 operation is identical; it involves $Q_{3}$ and $Q_{6}$ with the analysis resulting in an upper bound on $(W / L)_{6} /(W / L)_{3}$ equal to that we have found for $(W / L)_{5} /(W / L)_{3}$. This, of course, is entirely expected, since the circuit is symmetrical. The read-0 operation results in a decrement $\Delta V$ in the voltage of the $B$ line, which is interpreted by the sense amplifier as a stored 0 .
2. The component $\Delta t$ of the read delay is relatively large because $C_{B}$ and $C_{\bar{B}}$ are relatively large (in the picofarad range). Also, $\Delta t$ is not the only component of the read delay; another significant component is due to the finite rise time of the voltage on the word line. Indeed, even the calculation of $\Delta t$ is optimistic, since the word line will have only reached a voltage lower than $V_{D D}$ when the process of discharging $C_{\bar{B}}$ takes place. As will be seen shortly, the write operation is faster.

The Write Operation We next consider the write operation. Let the SRAM cell of Fig. 16.12 be storing a logic 1 , thus $V_{Q}=V_{D D}$ and $V_{\bar{Q}}=0 \mathrm{~V}$, and assume that we wish to write a 0 ; that is, we wish to have the flip-flop switch states. To write a zero, the $B$ line is lowered to 0 V , and the $\bar{B}$ line is raised to $V_{D D}$ and, of course, the cell is selected by raising the word line to $V_{D D}$. The objective now is to pull node $Q$ down and node $\bar{Q}$ up and have the voltage of at least one of these two nodes pass by the inverter threshold voltage. Thus, if $v_{Q}$ decreases below the threshold voltage of inverter $Q_{1}-Q_{2}$, the regenerative action of the latch will start and the flip-flop will switch to the stored-0 state. Alternatively, or in addition, if we manage to raise $v_{\bar{Q}}$ above the threshold voltage of the $Q_{3}-Q_{4}$ inverter, the regenerative action


Figure 16.16 Relevant parts of the 6T SRAM circuit of Fig. 16.12 during the process of writing a 0 . It is assumed that the cell is originally storing a 1 and thus initially $v_{Q}=V_{D D}$ and $v_{\ddot{Q}}=0 \mathrm{~V}$.
will be engaged and the latch will eventually switch state. Either one of the two actions is sufficient to engage the regenerative mechanism of the latch.

Figure 16.16 shows the relevant parts of the SRAM circuit during the interval when $v_{\ddot{Q}}$ is being pulled up [Fig. 16.16(a)] and $v_{Q}$ is being pulled down [Fig. 16.16(b)]. Since toggling (i.e., state change) has not yet taken place, we assume that the voltage feeding the gate of $Q_{1}$ is still equal to $V_{D D}$ and the voltage at the gate of $Q_{4}$ is still equal to 0 V . These voltages will of course be changing as $v_{\ddot{Q}}$ goes up and $v_{Q}$ goes down, but this assumption is nevertheless reasonable for approximate hand analysis.

Consider first the circuit in Fig. 16.16(a). This is the same circuit we analyzed in detail in the study of the read operation above. Recall that to make the read process nondestructive, we imposed an upper bound on $(W / L)_{5}$. That upper bound ensured that $v_{\ddot{Q}}$ will not rise above $V_{i n}$. Thus, this circuit is not capable of raising $v_{\ddot{Q}}$ to the point that it can start the regenerative action. We must therefore rely solely on the circuit of Fig. 16.16(b). That is, our write-0 operation will be accomplished by pulling node $Q$ down in order to initiate the regenerative action of the latch. To ensure that the latch will in fact switch state, SRAM designers impose a more stringent requirement on the voltage $v_{Q}$, namely, that it must fall below not just $V_{M}$ of the $Q_{1}-Q_{2}$ inverter but below $V_{i n}$ of $Q_{1}$.

Let's now look more closely at the circuit of Fig. 16.16(b). Initially, $v_{Q}$ is at $V_{D D}$. However, as $Q_{6}$ turns on, $I_{6}$ quickly discharges the small capacitance $C_{Q}$, and $v_{Q}$ begins to fall. This will enable $Q_{4}$ to conduct, and equilibrium is reached when $I_{4}=I_{6}$. To ensure toggling, we design the circuit so that this equilibrium occurs at a value of $v_{Q}$ less than $V_{i n}$. At such a value $V_{Q}, Q_{4}$ will be operating in saturation (or at least at the edge of saturation) and $Q_{6}$ will be operating in the triode region, thus

$$
I_{4}=\frac{1}{2}\left(\mu_{p} C_{o s}\right)\left(\frac{W}{L}\right)_{4}\left(V_{D D}-\left|V_{i p}\right|\right)^{2}
$$

and

$$
I_{6}=\left(\mu_{n} C_{o s}\right)\left(\frac{W}{L}\right)_{6}\left[\left(V_{D D}-V_{i n}\right) V_{Q}-\frac{1}{2} V_{Q}^{2}\right]
$$


Figure 16.17 The normalized value of $V_{Q}$ versus the ratio $(W / L)_{d} /(W / L)_{6}$ for the circuit in Fig. 16.16(b). The graph applies for process technologies for which $\mu_{u} \simeq 4 \mu_{p}$. It can be used to determine the maximum $(W / L)_{d} /(W / L)_{6}$ for which $V_{Q}$ is guaranteed to fall below a desired value.

Substituting $\left|V_{m}\right|=V_{m}$, which is usually the case, and equating $I_{4}$ and $I_{6}$ results in a quadratic equation in $V_{Q}$ whose solution is

$$
\frac{V_{Q}}{V_{D D}-V_{m}}=1-\sqrt{1-\left(\frac{\mu_{p}}{\mu_{u}}\right) \frac{(W / L)_{4}}{(W / L)_{6}}}
$$

This relationship is not as convenient as that in Eq. (16.3) because the right-hand side includes a process-dependent quantity, namely, $\mu_{p} / \mu_{u}$. Thus we do not have a universally applicable relationship. Nevertheless, for a number of CMOS process technologies, including the $0.25-\mu \mathrm{m}$, the $0.18-\mu \mathrm{m}$, and the $0.13-\mu \mathrm{m}$ processes, $\mu_{u} / \mu_{p} \simeq 4$. Thus, upon substituting $\mu_{p} / \mu_{u}=0.25$ in Eq. (16.10), we obtain the semiuniversal graph shown in Fig. 16.17. We can use this graph to determine the maximum allowable value of the ratio $(W / L)_{4} /(W / L)_{6}$ that will ensure a value of $V_{Q} \leq V_{m}$ for given process parameters $V_{D D}$ and $V_{m}$. Alternatively, substituting $V_{Q}=V_{m},(W / L)_{4}=(W / L)_{p}$, and $(W / L)_{6}=(W / L)_{u}$, we can obtain the upper bound analytically as

$$
\frac{(W / L)_{p}}{(W / L)_{u}} \leq\left(\frac{\mu_{u}}{\mu_{p}}\right)\left[1-\left(1-\frac{V_{m}}{V_{D D}-V_{m}}\right)^{2}\right]
$$

Observe that this relationship provides an upper bound on $(W / L)_{p}$ in terms of $(W / L)_{u}$ and that the relationship in Eq. (16.5) provides an upper bound on $(W / L)_{u}$ in terms of $(W / L)_{u}$. Thus, the two relationships can be used together to design the SRAM cell.
# EXERCISE 

D16.6 For the SRAM cell considered in Exercise 16.4, where $(W / L)_{n}=1.5$ and $(W / L)_{n} \leq 2.5$, use Eq. (16.11) to find the maximum allowable value of $(W / L)_{p}$. Recall that for this $0.18-\mu \mathrm{m}$ process, $\mu_{n} \simeq 4 \mu_{p}$. For all transistors having $L=0.18 \mu \mathrm{~m}$, find $W_{n}, W_{p}$, and $W_{o}$ that result in a minimum-area cell. Assume that the minimum allowable width is $0.18 \mu \mathrm{~m}$.
Ans. $(W / L)_{p} \leq 2.5(W / L)_{n}$, thus $(W / L)_{p} \leq 6.25$; for minimum area, select $W_{n}=W_{p}=W_{o}=0.18 \mu \mathrm{~m}$.

We conclude our study of the write process by noting that it is fast because it does not require discharging the large capacitance of the bit lines. The voltages of the $B$ and $\bar{B}$ lines are driven to their required values of 0 or $V_{D D}$ by powerful driver circuits and thus achieve their desired voltages very quickly. The write delay is determined roughly by the time for the regenerating signal to propagate around the feedback loop of the latch; thus it is about twice the propagation delay of the inverter. Of course, the write cycle time is still lengthened by the word-line delay.

### 16.3.2 Dynamic Memory (DRAM) Cell

Although a variety of DRAM storage cells have been proposed over the years, a particular cell, shown in Fig. 16.18, has become the industry standard. The cell consists of a single $n$-channel MOSFET, known as the access transistor, and a storage capacitor $C_{S}$. The cell is appropriately known as the one-transistor cell. ${ }^{2}$ The gate of the transistor is connected to the word line, and its source (drain) is connected to the bit line. Observe that only one bit line is used in DRAMs, whereas in SRAMs both the bit and bit lines are utilized. The DRAM cell stores its bit of information as charge on the cell capacitor $C_{S}$. When the cell is storing a 1 , the capacitor is charged to $V_{D D}$; when a 0 is stored, the capacitor is discharged to zero volts.


Figure 16.18 The one-transistor dynamic RAM (DRAM) cell.

[^0]
[^0]:    ${ }^{2}$ The name was originally used to distinguish this cell from earlier ones utilizing three transistors.


Figure 16.19 When the voltage of the selected word line is raised, the transistor conducts, thus connecting the storage capacitor $C_{S}$ to the bit-line capacitor $C_{B}$.

Some explanation is needed to appreciate how the capacitor can be charged to the full supply voltage $V_{D D}$. Consider a write-1 operation. The word line is at $V_{D D}$ and the bit line is at $V_{D D}$ and the transistor is conducting, charging $C_{S}$. The transistor will cease conduction when the voltage on $C_{S}$ reaches $\left(V_{D D}-V_{i}\right)$. This is the same problem we encountered with pass-transistor logic (PTL) in Section 15.4. The problem is overcome in DRAM design by boosting the word line to a voltage equal to $V_{D D}+V_{i}$. In this case the capacitor voltage for a stored 1 will be equal to the full $V_{D D}$. However, because of leakage effects, the capacitor charge will leak off, and hence the cell must be refreshed periodically. During refresh, the cell content is read and the data bit is rewritten, thus restoring the capacitor voltage to its proper value. Typically, the refresh operation must be performed every 5 ms to 10 ms .

Let us now consider the DRAM operation in more detail. As in the static RAM, the row decoder selects a particular row by raising the voltage of its word line. This causes all the access transistors in the selected row to become conductive, thereby connecting the storage capacitors of all the cells in the selected row to their respective bit lines. Thus the cell capacitor $C_{S}$ is connected in parallel with the bit-line capacitance $C_{B}$, as indicated in Fig. 16.19. Here, it should be noted that $C_{S}$ is typically 20 fF to 30 fF , whereas $C_{B}$ is 10 times larger. Now, if the operation is a read, the bit line is precharged to $V_{D D} / 2$. To find the change in the voltage on the bit line resulting from connecting a cell capacitor $C_{S}$ to it, let the initial voltage on the cell capacitor be $V_{C S}\left(V_{C S}=V_{D D}\right.$ when a 1 is stored, and $V_{C S}=0 \mathrm{~V}$ when a 0 is stored). Using charge conservation, we can write

$$
C_{S} V_{C S}+C_{B} \frac{V_{D D}}{2}=\left(C_{B}+C_{S}\right)\left(\frac{V_{D D}}{2}+\Delta V\right)
$$

from which we can obtain for $\Delta V$

$$
\Delta V=\frac{C_{S}}{C_{B}+C_{S}}\left(V_{C S}-\frac{V_{D D}}{2}\right)
$$

and since $C_{B} \gg C_{S}$,

$$
\Delta V \simeq \frac{C_{S}}{C_{B}}\left(V_{C S}-\frac{V_{D D}}{2}\right)
$$

Now, if the cell is storing a $1, V_{C S}=V_{D D}$, and

$$
\Delta V(1) \simeq \frac{C_{S}}{C_{B}}\left(\frac{V_{D D}}{2}\right)
$$

whereas if the cell is storing a $0, V_{C S}=0$, and

$$
\Delta V(0) \simeq-\frac{C_{S}}{C_{B}}\left(\frac{V_{D D}}{2}\right)
$$Since usually $C_{B}$ is much greater than $C_{S}$, these readout voltages are very small. For example, for $C_{B}=10 C_{S}, V_{D D}=1.8 \mathrm{~V}, \Delta V(0)$ will be about -90 mV , and $\Delta V(1)$ will be +90 mV . This is a best-case scenario, for the 1 level in the cell might very well be below $V_{D D}$. Furthermore, in modern memory chips, $V_{D D}$ is 1.2 V or even lower. In any case, we see that a stored 1 in the cell results in a small positive increment in the bit-line voltage, whereas a stored zero results in a small negative increment. Observe also that the readout process is destructive, since the resulting voltage across $C_{S}$ will no longer be $V_{D D}$ or 0 .

The change of voltage on the bit line is detected and amplified by the column sense amplifier, causing the bit line to be driven to the full-scale value ( 0 or $V_{D D}$ ) of the detected signal. This amplified signal is then impressed on the storage capacitor, thus restoring its signal to the proper level ( $V_{D D}$ or 0 ). In this way, all the cells in the selected row are refreshed. Simultaneously, the signal at the output of the sense amplifier of the selected column is fed to the data-output line of the chip through the action of the column decoder.

The write operation proceeds similarly to the read operation, except that the data bit to be written, which is impressed on the data-input line, is applied by the column decoder to the selected bit line. Thus, if the data bit to be written is a 1 , the $B$-line voltage is raised to $V_{D D}$ (i.e., $C_{B}$ is charged to $V_{D D}$ ). When the access transistor of the particular cell is turned on, its capacitor $C_{S}$ will be charged to $V_{D D}$; thus a 1 is written in the cell. Simultaneously, all the other cells in the selected row are simply refreshed.

Although the read and write operations result in automatic refreshing of all the cells in the selected row, provision must be made for the periodic refreshing of the entire memory, typically every 5 ms to 10 ms , as specified for the particular chip. The refresh operation is carried out in a burst mode, one row at a time. During refresh, the chip will not be available for read or write operations. This is not a serious matter, however, since the interval required to refresh the entire chip is typically less than $2 \%$ of the time between refresh cycles. In other words, the memory chip is available for normal operation more than $98 \%$ of the time.

# EXERCISES 

16.7 In a particular dynamic memory chip, $C_{S}=30 \mathrm{fF}, C_{B}=0.3 \mathrm{pF}$, and $V_{D D}=1.2 \mathrm{~V}$. Find the output readout voltage for a stored 1 and a stored 0 . Recall that in a read operation, the bit lines are precharged to $V_{D D} / 2$.
Ans. $60 \mathrm{mV} ;-60 \mathrm{mV}$
16.8 A 64-Mbit DRAM chip fabricated in a $0.4-\mu \mathrm{m}$ CMOS technology requires $2 \mu \mathrm{~m}^{2}$ per cell. If the storage array is square, estimate its dimensions. Further, if the peripheral circuitry (e.g., sense amplifiers, decoders) adds about $30 \%$ to the chip area, estimate the dimensions of the resulting chip.
Ans. $11.6 \mathrm{~mm} \times 11.6 \mathrm{~mm} ; 13.2 \mathrm{~mm} \times 13.2 \mathrm{~mm}$

### 16.4 Sense Amplifiers and Address Decoders

Having studied the circuits commonly used to implement the storage cells in SRAMs and DRAMs, we now consider some of the other important circuit blocks in a memory chip. The design of these circuits, commonly referred to as the memory peripheral circuits,
presents exciting challenges and opportunities to integrated-circuit designers: Improving the performance of peripheral circuits can result in denser and faster memory chips that dissipate less power.

# 16.4.1 The Sense Amplifier 

Next to the storage cells, the sense amplifier is the most critical component in a memory chip. Sense amplifiers are essential to the proper operation of DRAMs, and their use in SRAMs results in speed and area improvements.

A variety of sense-amplifier designs are in use, some of which closely resemble the active-load MOS differential amplifier studied in Chapter 9. Here, we first describe a differential sense amplifier that employs positive feedback. Because the circuit is differential, it can be employed directly in SRAMs, where the SRAM cell utilizes both the $B$ and $\bar{B}$ lines. On the other hand, the one-transistor DRAM circuit we studied in Section 16.3.2 is a single-ended circuit, utilizing one bit line only. The DRAM circuit, however, can be made to resemble a differential signal source through the use of the "dummy-cell" technique, which we shall discuss shortly. Therefore, we shall assume that the memory cell whose output is to be amplified develops a difference output voltage between the $B$ and $\bar{B}$ lines. This signal, which can range from 20 mV to 500 mV depending on the memory type and cell design, will be applied to the input terminals of the sense amplifier. The sense amplifier in turn responds by providing a full-swing ( 0 to $V_{D D}$ ) signal at its output terminals. The particular amplifier circuit we shall discuss here has a rather unusual property: Its output and input terminals are the same!

A Sense Amplifier with Positive Feedback Figure 16.20 shows the sense amplifier together with some of the other column circuitry of a RAM chip. Note that the sense amplifier is nothing but the familiar latch formed by cross-coupling two CMOS inverters: One inverter is implemented by transistors $Q_{1}$ and $Q_{2}$, and the other by transistors $Q_{3}$ and $Q_{4}$. Transistors $Q_{5}$ and $Q_{6}$ act as switches that connect the sense amplifier to ground and $V_{D D}$ only when data-sensing action is required. Otherwise, $\phi_{s}$ is low and the sense amplifier is turned off. This conserves power, an important consideration because usually there is one sense amplifier per column, resulting in thousands of sense amplifiers per chip. Note, again, that terminals $x$ and $y$ are both the input and the output terminals of the amplifier. As indicated, these I/O terminals are connected to the $B$ and $\bar{B}$ lines. The amplifier is required to detect a small signal appearing between $B$ and $\bar{B}$, and to amplify it to provide a full-swing signal at $B$ and $\bar{B}$. For instance, if during a read operation, the cell has a stored 1 , then a small positive voltage will develop between $B$ and $\bar{B}$, with $v_{B}$ higher than $v_{\bar{B}}$. The amplifier will then cause $v_{B}$ to rise to $V_{D D}$ and $v_{\bar{B}}$ to fall to 0 V . This 1 output is then directed to the chip I/O pin by the column decoder (not shown) and at the same time is used to rewrite a 1 in the DRAM cell, thus performing the restore operation that is required because the DRAM readout process is destructive.

Figure 16.20 also shows the precharge and equalization circuit. Operation of this circuit is straightforward: When $\phi_{p}$ goes high (to $V_{D D}$ ) prior to a read operation, all three transistors conduct. While $Q_{8}$ and $Q_{9}$ precharge the $\bar{B}$ and $B$ lines to $V_{D D} / 2$, transistor $Q_{7}$ helps speed up this process by equalizing the initial voltages on the two lines. This equalization is critical to the proper operation of the sense amplifier. Any voltage difference present between $B$ and $\bar{B}$ prior to commencement of the read operation can result in erroneous interpretation by the sense amplifier of its input signal. In Fig. 16.20, we show only one of the cells in this particular column, namely, the cell whose word line is activated. The cell can be either an SRAM or a


Figure 16.20 A differential sense amplifier connected to the bit lines of a particular column. This arrangement can be used directly for SRAMs (which utilize both the $B$ and $\bar{B}$ lines). DRAMs can be turned into differential circuits by using the "dummy-cell" arrangement shown later (Fig. 16.22).

DRAM cell. All other cells in this column will not be connected to the $B$ and $\bar{B}$ lines (because their word lines will remain low).

Let us now consider the sequence of events during a read operation:

1. The precharge and equalization circuit is activated by raising the control signal $\phi_{p}$. This will cause the $B$ and $\bar{B}$ lines to be at equal voltages, equal to $V_{D D} / 2$. The clock $\phi_{p}$ then goes low, and the $B$ and $\bar{B}$ lines are left to float for a brief interval.
2. The word line goes up, connecting the cell to the $B$ and $\bar{B}$ lines. A voltage then develops between $B$ and $\bar{B}$, with $v_{B}$ higher than $v_{\bar{B}}$ if the accessed cell is storing a 1 , or $v_{B}$ lower than $v_{\bar{B}}$ if the cell is storing a 0 . To keep the cell area small, and to


Figure 16.21 Waveforms of $v_{B}$ before and after the activation of the sense amplifier. In a read-1 operation, the sense amplifier causes the initial small increment $\Delta V(1)$ to grow exponentially to $V_{D D}$. In a read- 0 operation, the negative $\Delta V(0)$ grows to 0 . Complementary signal waveforms develop on the $\bar{B}$ line.
facilitate operation at higher speeds, the readout signal, which the cell is required to provide between $B$ and $\bar{B}$, is kept small (typically, $20-500 \mathrm{mV}$ ).
3. Once an adequate difference voltage signal between $B$ and $\bar{B}$ has been developed by the storage cell, the sense amplifier is turned on by connecting it to ground and $V_{D D}$ through $Q_{S}$ and $Q_{6}$, activated by raising the sense-control signal $\phi_{s}$. Because initially the input terminals of the inverters are at $V_{D D} / 2$, the inverters will be operating in their transition region, where the gain is high (Section 14.3). It follows that initially the latch will be operating at its unstable equilibrium point. Thus, depending on the signal between the input terminals, the latch will quickly move to one of its two stable equilibrium points (refer to the description of the latch operation in Section 16.1). This is achieved by the regenerative action, inherent in positive feedback. Figure 16.21 clearly illustrates this point by showing the waveforms of the signal on the bit line for both a read- 1 and a read- 0 operation. Observe that once activated, the sense amplifier causes the small initial difference, $\Delta V(1)$ or $\Delta V(0)$, provided by the cell, to grow exponentially to either $V_{D D}$ (for a read-1 operation) or 0 (for a read- 0 operation). The waveforms of the signal on the $\bar{B}$ line will be complementary to those shown in Fig. 16.21 for the $B$ line. In the following, we quantify the process of exponential growth of $v_{B}$ and $v_{\bar{B}}$.

A Closer Look at the Operation of the Sense Amplifier Developing a precise expression for the output signal of the sense amplifier shown in Fig. 16.20 is a rather complex task requiring the use of large-signal (and thus nonlinear) models of the inverter voltage-transfer characteristic, as well as taking the positive feedback into account. We will not do this here; rather, we shall consider the operation in a semiquantitative way.

Recall that at the time the sense amplifier is activated, each of its two inverters is operating in the transition region near $V_{D D} / 2$. Thus, for small-signal operation, each inverter can be modeled using $g_{m n}$ and $g_{m p}$, the transconductances of $Q_{N}$ and $Q_{P}$, respectively, evaluated at an input bias of $V_{D D} / 2$. Specifically, a small-signal $v_{i}$ superimposed on $V_{D D} / 2$ at the input of one of the inverters gives rise to an inverter output current signal of $\left(g_{m n}+g_{m p}\right) v_{i} \equiv G_{m} v_{i}$. This output current is delivered to one of the capacitors, $C_{B}$ or $C_{\bar{B}}$. The voltage thus developed across the capacitor is then fed back to the other inverter and is multiplied by its $G_{m}$, which gives rise
to an output current feeding the other capacitor, and so on, in a regenerative process. The positive feedback in this loop will mean that the signal around the loop, and thus $v_{B}$ and $v_{\bar{B}}$, will rise or decay exponentially (see Fig. 16.21) with a time constant of $\left(C_{B} / G_{m}\right)$ [or $\left(C_{\bar{B}} / G_{m}\right)$, since we have been assuming $C_{B}=C_{\bar{B}}$ ]. Thus, for example, in a read-1 operation we obtain

$$
v_{B}=\frac{V_{D D}}{2}+\Delta V(1) e^{\left(G_{m} / C_{B}\right) t}, \quad v_{B} \leq V_{D D}
$$

whereas in a read-0 operation,

$$
v_{B}=\frac{V_{D D}}{2}-\Delta V(0) e^{\left(G_{m} / C_{B}\right) t}, \quad v_{B} \geq 0
$$

Because these expressions have been derived assuming small-signal operation, they describe the exponential growth (decay) of $v_{B}$ reasonably accurately only for values close to $V_{D D} / 2$. Nevertheless, they can be used to obtain a reasonable estimate of the time required to develop a particular signal level on the bit line.

# Example 16.2 

Consider the sense-amplifier circuit of Fig. 16.20 during the reading of a 1. Assume that the storage cell provides a voltage increment on the $B$ line of $\Delta V(1)=0.1 \mathrm{~V}$. If the NMOS devices in the amplifiers have $(W / L)_{n}=0.54 \mu \mathrm{~m} / 0.18 \mu \mathrm{~m}$ and the PMOS devices have $(W / L)_{p}=2.16 \mu \mathrm{~m} / 0.18 \mu \mathrm{~m}$, and assuming that $V_{D D}=1.8 \mathrm{~V}, V_{m}=\left|V_{w}\right|=0.5 \mathrm{~V}$, and $\mu_{n} C_{o s}=4 \mu_{p} C_{o s}=300 \mu \mathrm{~A} / \mathrm{V}^{2}$, find the time required for $v_{B}$ to reach $0.9 V_{D D}$. Assume $C_{B}=1 \mathrm{pF}$.

## Solution

First, we determine the transconductances $g_{m n}$ and $g_{m p}$

$$
\begin{aligned}
g_{m n} & =\mu_{n} C_{o s}\left(\frac{W}{L}\right)_{n}\left(V_{G S}-V_{i}\right) \\
& =300 \times \frac{0.54}{0.18}(0.9-0.5) \\
& =0.36 \mathrm{~mA} / \mathrm{V} \\
g_{m p} & =\mu_{p} C_{o s}\left(\frac{W}{L}\right)_{p}\left(V_{G S}-\left|V_{i}\right|\right) \\
& =75 \times \frac{2.16}{0.18}(0.9-0.5)=0.36 \mathrm{~mA} / \mathrm{V}
\end{aligned}
$$

Thus, the inverter $G_{m}$ is

$$
G_{m}=g_{m n}+g_{m p}=0.72 \mathrm{~mA} / \mathrm{V}
$$

and the time constant $\tau$ for the exponential growth of $v_{B}$ will be

$$
\tau \equiv \frac{C_{B}}{G_{m}}=\frac{1 \times 10^{-12}}{0.72 \times 10^{-3}}=1.4 \mathrm{~ns}
$$
Now, the time, $\Delta t$, for $v_{B}$ to reach $0.9 V_{D D}$ can be determined from

$$
0.9 \times 1.8=0.9+0.1 e^{\Delta t / 1.4}
$$

resulting in

$$
\Delta t=2.8 \mathrm{~ns}
$$

Obtaining Differential Operation in Dynamic RAMs The sense amplifier described earlier responds to difference signals appearing between the bit lines. Thus, it is capable of rejecting interference signals that are common to both lines, such as those caused by capacitive coupling from the word lines. For this common-mode rejection to be effective, great care has to be taken to match both sides of the amplifier, taking into account the circuits that feed each side. This is an important consideration in any attempt to make the inherently single-ended output of the DRAM cell appear differential. We shall now discuss an ingenious scheme for accomplishing this task. Although the technique has been around for many years (see the first edition of this book, published in 1982), it is still in use today. The method is illustrated in Fig. 16.22.

Basically, each bit line is split into two identical halves. Each half-line is connected to half the cells in the column and to an additional cell, known as a dummy cell, having a storage


Figure 16.22 An arrangement for obtaining differential operation from the single-ended DRAM cell. Note the dummy cells at the far right and far left.
capacitor $C_{D}=C_{S}$. When a word line on the left side is selected for reading, the dummy cell on the right side (controlled by $\bar{\phi}_{D}$ ) is also selected, and vice versa; that is, when a word line on the right side is selected, the dummy cell on the left (controlled by $\phi_{D}$ ) is also selected. In effect, then, the dummy cell serves as the other half of a differential DRAM cell. When the left-half bit line is in operation, the right-half bit line acts as its complement (or $\bar{B}$ line) and vice versa.

Operation of the circuit in Fig. 16.22 is as follows: The two halves of the line are precharged to $V_{D D} / 2$ and their voltages are equalized. At the same time, the capacitors of the two dummy cells are precharged to $V_{D D} / 2$. Then a word line is selected, and the dummy cell on the other side is enabled (with $\phi_{D}$ or $\bar{\phi}_{D}$ raised to $V_{D D}$ ). Thus the half-line connected to the selected cell will develop a voltage increment (around $V_{D D} / 2$ ) of $\Delta V(1)$ or $\Delta V(0)$ depending on whether a 1 or a 0 is stored in the cell. Meanwhile, the other half of the line will have its voltage held equal to that of $C_{D}$ (i.e., $V_{D D} / 2$ ). The result is a differential signal of $\Delta V(1)$ or $\Delta V(0)$ that the sense amplifier detects and amplifies when it is enabled. As usual, by the end of the regenerative process, the amplifier will cause the voltage on one half of the line to become $V_{D D}$ and that on the other half to become 0 .

# EXERCISES 

16.9 It is required to reduce the time $\Delta t$ of the sense-amplifier circuit in Example 16.2 by a factor of 2 by increasing $g_{m}$ of the transistors (while retaining the matched design of each inverter). What must the $W / L$ ratios of the $n$ - and $p$-channel devices become?
Ans. $(W / L)_{n}=6 ;(W / L)_{p}=24$
16.10 If in the sense amplifier of Example 16.2, the signal available from the cell is only half as large (i.e., only 50 mV ), what will $\Delta t$ become?
Ans. 3.7 ns , an increase of $32 \%$

Alternative Precharging Arrangements If it is desired to precharge the $B$ and $\bar{B}$ lines to $V_{D D}$, the arrangement in Fig. 16.23(a) can be utilized. Here precharging and equalization occur when $\bar{\phi}_{p}$ is low. Then, just prior to the activation of the word line, $\bar{\phi}_{p}$ goes high. Another precharging arrangement using diode-connected NMOS transistors is shown in Fig. 16.23(b). In this case, the $B$ and $\bar{B}$ lines are charged to $\left(V_{D D}-V_{t}\right)$, and $Q_{7}$ equalizes their voltages.

An Alternative Sense Amplifier Another popular implementation of the sense amplifier is the differential MOS amplifier with a current-mirror load, studied in detail in Section 9.5. Here, we present a brief overview of the operation of this versatile circuit as a sense amplifier.

The amplifier circuit is shown in Fig. 16.24 fed from the bit and bit lines (voltages $v_{B}$ and $v_{\bar{B}}$ ). Transistors $Q_{1}$ and $Q_{2}$ are connected in the differential-pair configuration and are biased by a constant current $I$ supplied by current source $Q_{3}$. Transistors $Q_{3}$ and $Q_{4}$ form a current mirror, which acts as the load circuit for the amplifying transistors $Q_{1}$ and $Q_{2}$. The differential nature of the amplifier aids significantly in its effectiveness as a sense amplifier: It rejects noise or interference signals that are coupled equally to the $B$ and $\bar{B}$ lines, and amplifies only


Figure 16.23 Two alternative arrangements for precharging the bit lines: (a) The $B$ and $\bar{B}$ lines are precharged to $V_{D D}$; (b) the $B$ and $\bar{B}$ lines are charged to $\left(V_{D D}-V_{i}\right)$.
the small difference signals that appear between $B$ and $\bar{B}$ as a result of the read operation of a cell connected to the $B$ and $\bar{B}$ lines.

The amplifier is designed so that in normal small-signal operation, all transistors operate in the saturation region. Figure 16.24(b) shows the amplifier in its equilibrium state with $v_{B}=v_{\bar{B}}=V_{D D}-V_{i}$. Note that we have assumed that the $B$ and $\bar{B}$ lines are precharged to $\left(V_{D D}-V_{i}\right)$ using the circuit in Fig. 16.23(b). It turns out that this voltage is particularly convenient for the operation of this amplifier type as a sense amplifier. As indicated in Fig. 16.24(b), the bias current $I$ divides equally between $Q_{1}$ and $Q_{2}$; thus each conducts a current $I / 2$. The current of $Q_{1}$ is fed to the input side of the current mirror, transistor $Q_{3}$; thus the mirror provides an equal output current $I / 2$ in the drain of $Q_{4}$. At the output node, we see that we have two equal and opposite currents, leaving a zero current to flow into the load capacitor. Thus, in an ideal situation of perfect matching, $v_{O}$ will be equal to the voltage at the drain of $Q_{1}$.


Figure 16.24 The currrent-mirror-loaded MOS differential amplifier as a sense amplifier.


Figure 16.24 continued

Next consider the situation when the $B$ line shows an incremental voltage $\Delta V$ above the voltage of the $\bar{B}$ line. As shown in Fig. 16.24(c), if $\Delta V$ is sufficiently large, $Q_{2}$ will turn off and all the bias current $I$ will flow through $Q_{1}$ and on to $Q_{3}$. Thus the mirror output current becomes $I$ and flows through the amplifier output terminal to the equivalent output capacitance $C$. Thus $C$ will charge to $V_{D D}$ in time $\Delta t$,

$$
\Delta t=\frac{C V_{D D}}{I}
$$

The complementary situation when $v_{\bar{B}}$ exceeds $v_{B}$ by $\Delta V$ is illustrated in Fig. 16.24(d). Here $Q_{1}, Q_{3}$, and $Q_{4}$ are turned off, and $Q_{2}$ conducts all the current $I$. Thus capacitor $C$ is discharged to ground by a constant current $I$.

An important question to answer before leaving this amplifier circuit is how large is $\Delta V$ that causes the current $I$ to switch from one side of the differential pair to the other? The answer is given in Section 9.5 (see Fig. 9.6), namely,

$$
\Delta V=\sqrt{2} V_{O V}
$$

where $V_{O V}$ is the overdrive voltage at which $Q_{1}$ and $Q_{2}$ are operating in equilibrium, that is,

$$
\frac{I}{2}=\frac{1}{2}\left(\mu_{n} C_{o s}\right)\left(\frac{W}{L}\right)_{1,2} V_{O V}^{2}
$$

Finally, we note that this sense amplifier dissipates static power given by

$$
P=V_{D D} I
$$

Observe that increasing $I$ reduces the time $\Delta t$ in Eq. (16.18) at the expense of increased power dissipation.
# EXERCISE 

D16.11 It is required to design the sense amplifier in Fig. 16.24 to detect an input signal $\Delta V=100 \mathrm{mV}$ and to provide a full output in 0.5 ns . If $C=50 \mathrm{fF}$ and $V_{D D}=1.8 \mathrm{~V}$, find the required current $I$ and the power dissipation.
Ans. $180 \mu \mathrm{~A} ; 324 \mu \mathrm{~W}$

### 16.4.2 The Row-Address Decoder

As described in Section 16.2, the row-address decoder is required to select one of the $2^{M}$ word lines in response to an $M$-bit address input. As an example, consider the case $M=3$ and denote the three address bits $A_{0}, A_{1}$, and $A_{2}$, and the eight word lines $W_{0}, W_{1}, \ldots, W_{7}$. Conventionally, word line $W_{0}$ will be high when $A_{0}=0, A_{1}=0$, and $A_{2}=0$; thus we can express $W_{0}$ as a Boolean function of $A_{0}, A_{1}$, and $A_{2}$,

$$
W_{0}=\bar{A}_{0} \bar{A}_{1} \bar{A}_{2}=\overline{A_{0}+A_{1}+A_{2}}
$$

Thus the selection of $W_{0}$ can be accomplished by a three-input NOR gate whose three inputs are connected to $A_{0}, A_{1}$, and $A_{2}$ and whose output is connected to word line 0 . Word line $W_{3}$ will be high when $A_{0}=1, A_{1}=1$, and $A_{2}=0$; thus,

$$
W_{3}=A_{0} A_{1} \bar{A}_{2}=\overline{\bar{A}_{0}+\bar{A}_{1}+A_{2}}
$$

Thus the selection of $W_{3}$ can be realized by a three-input NOR gate whose three inputs are connected to $\bar{A}_{0}, \bar{A}_{1}$, and $A_{2}$, and whose output is connected to word line 3 . We can thus see that this address decoder can be realized by eight three-input NOR gates. Each NOR gate is fed with the appropriate combination of address bits and their complements, corresponding to the word line to which its output is connected.

A simple approach to realizing these NOR functions is provided by the matrix structure shown in Fig. 16.25. The circuit shown is a dynamic one (Section 15.5). Attached to each row line is a $p$-channel device that is activated, prior to the decoding process, using the precharge control signal $\phi_{P}$. During precharge ( $\phi_{P}$ low), all the word lines are pulled high to $V_{D D}$. It is assumed that at this time the address input bits have not yet been applied and all the inputs are low; hence there is no need for the circuit to include the evaluation transistor utilized in dynamic logic gates. Then, the decoding operation begins when the address bits and their complements are applied. Observe that the NMOS transistors are placed so that the word lines not selected will be discharged. For any input combination, only one word line will not be discharged, and thus its voltage remains high at $V_{D D}$. For instance, row 0 will be high only when $A_{0}=0, A_{1}=0$, and $A_{2}=0$; this is the only combination that will result in all three transistors connected to row 0 being cut off. Similarly, row 3 has transistors connected to $\bar{A}_{0}, \bar{A}_{1}$, and $A_{2}$, and thus it will be high when $A_{0}=1, A_{1}=1, A_{2}=0$, and so on. After the decoder outputs have stabilized, the output lines are connected to the word lines of the array, usually via clock-controlled transmission gates. This decoder is known as a NOR decoder. Observe that because of the precharge operation, the decoder circuit does not dissipate static power.

Figure 16.25 A NOR address decoder in array form. One out of eight lines (row lines) is selected using a 3-bit address.

# EXERCISE 

16.12 How many transistors are needed for a NOR row decoder with an $M$-bit address?

Ans. $M 2^{M} \mathrm{NMOS}+2^{M} \mathrm{PMOS}=2^{M}(M+1)$
# 16.4.3 The Column-Address Decoder 

From the description in Section 16.2, the function of the column-address decoder is to connect one of the $2^{N}$ bit lines to the data I/O line of the chip. As such, it is a multiplexer and can be implemented using pass-transistor logic (Section 15.4) as shown in Fig. 16.26. Here, each bit line is connected to the data I/O line through an NMOS transistor. The gates of the pass transistors are controlled by $2^{N}$ lines, one of which is selected by a NOR decoder similar to


Figure 16.26 A column decoder realized by a combination of a NOR decoder and a pass-transistor multiplexer.


Figure 16.27 A tree column decoder. Note that the colored path shows the transistors that are conducting when $A_{0}=1, A_{1}=0$, and $A_{2}=1$, the address that results in connecting $B_{3}$ to the data line.
that used for decoding the row address. Finally, note that better performance can be obtained by utilizing transmission gates in place of NMOS transistors (Section 15.4). In such a case, however, the decoder needs to provide complementary output signals.

An alternative implementation of the column decoder that uses a smaller number of transistors (but at the expense of slower speed of operation) is shown in Fig. 16.27. This circuit, known as a tree decoder, has a simple structure of pass transistors. Unfortunately, since a relatively large number of transistors can exist in the signal path, the resistance of the bit lines increases, and the speed decreases correspondingly.

# EXERCISE 

16.13 How many transistors are needed for a tree decoder when there are $2^{N}$ bit lines?

Ans. $2\left(2^{N}-1\right)$

### 16.4.4 Pulse-Generation Circuits

Memory chips require a large number of pulse signals, sometimes with intricate timing relationships among them. It is not our purpose here to study this important subject; rather, we present two simple circuits that find widespread applicability in memory-chip timing as well as in other digital system components, such as microprocessors.

The Ring Oscillator The ring oscillator is formed by connecting an odd number of inverters in a loop. Although usually at least five inverters are used, we illustrate the principle of operation using a ring of three inverters, as shown in Fig. 16.28(a). Figure 16.28(b) shows the waveforms obtained at the outputs of the three inverters. These waveforms are idealized in the sense that their edges have zero rise and fall times. Nevertheless, they will serve to explain the circuit operation.

Observe that a rising edge at node 1 propagates through gates 1,2 , and 3 to return inverted after a delay of $3 t_{p}$. This falling edge then propagates, and returns with the original (rising) polarity after another $3 t_{p}$ interval. It follows that the circuit oscillates with a period of $6 t_{p}$ or correspondingly with frequency $1 / 6 t_{p}$. In general, a ring with $N$ inverters (where $N$ must be odd) will oscillate with a period of $2 N t_{p}$ and frequency $1 / 2 N t_{p}$.

As a final remark, we note that the ring oscillator provides a relatively simple means for measuring the inverter propagation delay.

### 16.14 Find the frequency of oscillation of a ring of five inverters if the inverter propagation delay is specified to be 1 ns . <br> Ans. 100 MHz


Figure 16.28 (a) A ring oscillator formed by connecting three inverters in cascade. (Normally at least five inverters are used.) (b) The resulting waveform. Observe that the circuit oscillates with frequency $1 / 6 t_{p}$.

(b)

Figure 16.29 (a) A one-shot or monostable circuit. Utilizing a delay circuit with a delay $T$ and an XOR gate, this circuit provides an output pulse of width $T$. (b) The delay circuit can be implemented as the cascade of $N$ inverters where $N$ is even, in which case $T=N t_{p}$.

A One-Shot or Monostable Multivibrator Circuit The one-shot or monostable multivibrator circuit provides, when triggered, a single output pulse with a predetermined width. ${ }^{3}$ A variety of circuits exist for implementing the one-shot function, and some using op amps will be studied in Section 18.6. Here, in Fig. 16.29(a), we show a circuit commonly

[^0]
[^0]:    ${ }^{3}$ The name "monostable" arises because this class of circuits has one stable state, which is the quiescent state. When a trigger is applied, the circuit moves to its quasi-stable state and stays in it for a predetermined length of time (the width of the output pulse). It then switches back automatically to the stable state.
used in digital IC design. The circuit utilizes an exclusive-OR (XOR) gate together with a delay circuit. Recalling that the XOR gate provides a high output only when its two inputs are dissimilar, we see that prior to the arrival of the input positive step, the output will be low. When the input goes high, only the $B$ input of the XOR will be high and thus its output will go high. The high input will reach input $A$ of the XOR $T$ seconds later, at which time both inputs of the XOR will be high and thus its output will go low. We thus see that the circuit produces an output pulse with a duration $T$ equal to the delay of the delay block for each transition of the input signal. The delay block can be implemented by connecting an even number of inverters in cascade as shown in Fig. 16.29(b).

# 16.5 Read-Only Memory (ROM) 

As mentioned in Section 16.2, read-only memory (ROM) is memory that contains fixed data patterns. It is used in a variety of digital system applications. Currently, a very popular application is the use of ROM in microprocessor systems to store the instructions of the system's basic operating program. ROM is particularly suited for such an application because it is nonvolatile; that is, it retains its contents when the power supply is switched off.

A ROM can be viewed as a combinational logic circuit for which the input is the collection of address bits of the ROM and the output is the set of data bits retrieved from the addressed location. This viewpoint leads to the application of ROMs in code conversion-that is, in changing the code of the signal from one system (say, binary) to another. Code conversion is employed, for instance, in secure communication systems, where the process is known as scrambling. It consists of feeding the code of the data to be transmitted to a ROM that provides corresponding bits in a (supposedly) secret code. The reverse process, which also uses a ROM, is applied at the receiving end.

In this section we will study various types of read-only memory. These include fixed ROM, which we refer to simply as ROM, programmable ROM (PROM), erasable programmable ROM (EPROM), and flash memory.

### 16.5.1 A MOS ROM

Figure 16.30 shows a simplified 32-bit (or 8 -word $\times 4$-bit) MOS ROM. As indicated, the memory consists of an array of $n$-channel MOSFETs whose gates are connected to the word lines, whose sources are grounded, and whose drains are connected to the bit lines. Each bit line is connected to the power supply via a PMOS load transistor, in the manner of pseudo-NMOS logic (Section 15.3). An NMOS transistor exists in a particular cell if the cell is storing a 0 ; a cell storing a 1 has no MOSFET. This ROM can be thought of as 8 words of 4 bits each. The row decoder selects one of the 8 words by raising the voltage of the corresponding word line. The cell transistors connected to this word line will then conduct, thus pulling the voltage of the bit lines (to which transistors in the selected row are connected) down from $V_{D D}$ to a voltage close to ground voltage (the logic- 0 level). The bit lines that correspond to cells (of the selected word) without transistors (i.e., the cells that are storing a logic 1) will remain at the power-supply voltage (logic 1) because of the action of the pull-up PMOS load devices. In this way, the bits of the addressed word can be read.

A disadvantage of the ROM circuit in Fig. 16.30 is that it dissipates static power. Specifically, when a word is selected, the transistors in this particular row will conduct static current that is supplied by the PMOS load transistors. Static power dissipation can


Figure 16.30 A simple MOS ROM organized as 8 words $\times 4$ bits.
be eliminated by a simple change. Rather than grounding the gate terminals of the PMOS transistors, we can connect them to a precharge line $\phi$ that is normally high. Just before a read operation, $\phi$ is lowered and the bit lines are precharged to $V_{D D}$ through the PMOS transistors. The precharge signal $\phi$ then goes high, and the word line is selected. The bit lines that have transistors in the selected word are then discharged, thus indicating stored zeros, whereas those lines for which no transistor is present remain at $V_{D D}$, indicating stored ones.

# EXERCISE 

16.15 The purpose of this exercise is to estimate the various delay times involved in the operation of a ROM. Consider the ROM in Fig. 16.30 with the gates of the PMOS devices disconnected from ground and connected to a precharge control signal $\phi$. Let all the NMOS devices have $W / L=6$ $\mu \mathrm{m} / 2 \mu \mathrm{~m}$ and all the PMOS devices have $W / L=24 \mu \mathrm{~m} / 2 \mu \mathrm{~m}$. Assume that $\mu_{u} C_{o s}=50 \mu \mathrm{~A} / \mathrm{V}^{2}$, $\mu_{u} C_{o s}=20 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{m}=-V_{w}=1 \mathrm{~V}$, and $V_{D D}=5 \mathrm{~V}$.
(a) During the precharge interval, $\phi$ is lowered to 0 V . Estimate the time required to charge a bit line from 0 V to 5 V . Use, as an average charging current, the current supplied by a PMOS transistor at a bit-line voltage halfway through the $0-\mathrm{V}$ to $5-\mathrm{V}$ excursion (i.e., 2.5 V ). The bit-line capacitance is 2 pF . Note that all NMOS transistors are cut off at this time.
(b) After completion of the precharge interval and the return of $\phi$ to $V_{D D}$, the row decoder raises the voltage of the selected word line. Because of the finite resistance and capacitance of the word line, the voltage rises exponentially toward $V_{D D}$. If the resistance of each of the polysilicon word lines is $3 \mathrm{k} \Omega$ and the capacitance between the word line and ground is 3 pF , what is the ( $10 \%$ to $90 \%$ ) rise time of the word-line voltage? What is the voltage reached at the end of one time constant?
(c) We account for the exponential rise of the word-line voltage by approximating the word-line voltage by a step equal to the voltage reached in one time constant. Find the interval $\Delta t$ required for an NMOS transistor to discharge the bit line and lower its voltage by 0.5 V . (It is assumed that the sense amplifier needs a $0.5-\mathrm{V}$ change at its input to detect a low bit value.)
Ans. (a) 6.1 ns ; (b) 19.8 ns, 3.16 V ; (c) 2.9 ns

### 16.5.2 Mask-Programmable ROMs

The data stored in the ROMs discussed thus far is determined at the time of fabrication, according to the user's specifications. However, to avoid having to custom-design each ROM from scratch (which would be extremely costly), ROMs are manufactured using a process known as mask programming. As explained in Appendix A, integrated circuits are fabricated on a wafer of silicon using a sequence of processing steps that include photomasking, etching, and diffusion. In this way, a pattern of junctions and interconnections is created on the surface of the wafer. One of the final steps in the fabrication process consists of coating the surface of the wafer with a layer of aluminum and then selectively (using a mask) etching away portions of the aluminum, leaving aluminum only where interconnections are desired. This last step can be used to program (i.e., to store a desired pattern in) a ROM. For instance, if the ROM is made of MOS transistors as in Fig. 16.30, MOSFETs can be included at all bit locations, but only the gates of those transistors where 0 s are to be stored are connected to the word lines;
the gates of transistors where 1 s are to be stored are not connected. This pattern is determined by the mask, which is produced according to the user's specifications.

The economic advantages of the mask programming process should be obvious: All ROMs are fabricated similarly; customization occurs only during one of the final steps in fabrication.

# 16.5.3 Programmable ROMs (PROMs, EPROMs, and Flash) 

PROMs are ROMs that can be programmed by the user, but only once. A typical arrangement employed in BJT PROMs involves using polysilicon fuses to connect the emitter of each BJT to the corresponding digit line. Depending on the desired content of a ROM cell, the fuse can be either left intact or blown out using a large current. The programming process is obviously irreversible.

An erasable programmable ROM, or EPROM, is a ROM that can be erased and reprogrammed as many times as the user wishes. It is therefore the most versatile type of read-only memory. It should be noted, however, that the process of erasure and reprogramming is time consuming and is intended to be performed only infrequently.

State-of-the-art EPROMs use variants of the memory cell whose cross section is shown in Fig. 16.31(a). The cell is basically an enhancement-type $n$-channel MOSFET with two gates made of polysilicon material. ${ }^{4}$ One of the gates is not electrically connected to any other part of the circuit; rather, it is left floating and is appropriately called a floating gate. The other gate, called a select gate, functions in the same manner as the gate of a regular enhancement MOSFET.

The MOS transistor of Fig. 16.31(a) is known as a floating-gate transistor and is given the circuit symbol shown in Fig. 16.31(b). In this symbol the broken line denotes the floating gate. The memory cell is known as the stacked-gate cell.

Let us now examine the operation of the floating-gate transistor. Before the cell is programmed (we will shortly explain what this means), no charge exists on the floating gate and the device operates as a regular $n$-channel enhancement MOSFET. It thus exhibits the $i_{D}-v_{G S}$ characteristic shown as curve (a) in Fig. 16.32. Note that in this case the threshold voltage $\left(V_{t}\right)$ is rather low. This state of the transistor is known as the not-programmed state.


Figure 16.31 (a) Cross section and (b) circuit symbol of the floating-gate transistor used as an EPROM cell.

[^0]
[^0]:    ${ }^{4}$ See Appendix A for a description of silicon-gate technology.


Figure 16.32 Illustrating the shift in the $i_{D}-v_{G S}$ characteristic of a floating-gate transistor as a result of programming.


Figure 16.33 The floating-gate transistor during programming.

It is one of two states in which the floating-gate transistor can exist. Let us arbitrarily take the not-programmed state to represent a stored 1 . That is, a floating-gate transistor whose $i_{D}-v_{G S}$ characteristic is that shown as curve (a) in Fig. 16.32 will be said to be storing a 1.

To program the floating-gate transistor, a large voltage $(16-20 \mathrm{~V})$ is applied between its drain and source. Simultaneously, a large voltage (about 25 V ) is applied to its select gate. Figure 16.33 shows the floating-gate MOSFET during programming. In the absence of any charge on the floating gate, the device behaves as a regular $n$-channel enhancement MOSFET: An $n$-type inversion layer (channel) is created at the wafer surface as a result of the large positive voltage applied to the select gate. Because of the large positive voltage at the drain, the channel has a tapered shape.

The drain-to-source voltage accelerates electrons through the channel. As these electrons reach the drain end of the channel, they acquire high kinetic energy and are referred to as hot electrons. The large positive voltage on the select gate (greater than the drain voltage) establishes an electric field in the insulating oxide. This electric field attracts the hot electrons and accelerates them (through the oxide) toward the floating gate. In this way the floating gate is charged, and the charge that accumulates on it becomes trapped.
Fortunately, the process of charging the floating gate is self-limiting. The negative charge that accumulates on the floating gate reduces the strength of the electric field in the oxide to the point that it eventually becomes incapable of accelerating any more of the hot electrons.

Let us now inquire about the effect of the floating gate's negative charge on the operation of the transistor. The negative charge trapped on the floating gate will cause electrons to be repelled from the surface of the substrate. This implies that to form a channel, the positive voltage that has to be applied to the select gate will have to be greater than that required when the floating gate is not charged. In other words, the threshold voltage $V_{t}$ of the programmed transistor will be higher than that of the not-programmed device. In fact, programming causes the $i_{D}-v_{G S}$ characteristic to shift to the curve labeled (b) in Fig. 16.32. In this state, known as the programmed state, the cell is said to be storing a 0 .

Once programmed, the floating-gate device retains its shifted $i-v$ characteristic (curve $b$ ) even when the power supply is turned off. In fact, extrapolated experimental results indicate that the device can remain in the programmed state for as long as 100 years!

Reading the content of the stacked-gate cell is easy: A voltage $V_{G S}$ somewhere between the low and high threshold values (see Fig. 16.32) is applied to the selected gate. While a programmed device (one that is storing a 0 ) will not conduct, a not-programmed device (one that is storing a 1) will conduct heavily.

To return the floating-gate MOSFET to its not-programmed state, the charge stored on the floating gate has to be returned to the substrate. This erasure process can be accomplished by illuminating the cell with ultraviolet light of the correct wavelength ( $2537 \AA$ ) for a specified duration. The ultraviolet light imparts sufficient photon energy to the trapped electrons to allow them to overcome the inherent energy barrier, and thus be transported through the oxide, back to the substrate. To allow this erasure process, the EPROM package contains a quartz window. Finally, it should be noted that the device is extremely durable, and can be erased and programmed many times.

A more versatile programmable ROM is the electrically erasable PROM (or EEPROM). As the name implies, an EEPROM can be erased and reprogrammed electrically without the need for ultraviolet illumination. EEPROMs utilize a variant of the floating-gate MOSFET. An important class of EEPROMs using a floating-gate variant and implementing block erasure are referred to as flash memories. The name "flash" arises because many rows can be erased "in a flash," certainly very rapidly in comparison to the lengthy process of erasing by means of ultraviolet light. Flash memories have virtually replaced the EPROM variety and are currently (2014) very popular.

# 16.6 CMOS Image Sensors 

We conclude this chapter by presenting a very important functional block whose overall structure is very similar to that of a memory array: The CMOS image sensor is the basic image-capturing element in digital cameras (including smartphone cameras).

An image consists of a two-dimensional array of pixels, where each pixel indicates light intensity at its location in the array. A CMOS image sensor consists of a two-dimensional array of pixel circuits, where each pixel circuit measures light intensity and is usually a few square microns in size. Pixel circuits are accessed through a set of horizontal row-access lines, analogous to the word lines in memory arrays, and intensities are read out through a set of vertical lines, analogous to the bit lines in a memory array. However, here the vertical lines carry analog signals.

A pixel circuit, called an active pixel sensor (APS), is shown in Fig. 16.34. Prior to an image capture, transistor $Q_{P}$ resets the interval node X to a high voltage. The photodiode D

Figure 2.34 Reducing the effect of the input bias currents by introducing a resistor $R_{3}$.

This obviously places an upper limit on the value of $R_{2}$. Fortunately, however, a technique exists for reducing the value of the output dc voltage due to the input bias currents. The method consists of introducing a resistance $R_{3}$ in series with the noninverting input lead, as shown in Fig. 2.34. From a signal point of view, $R_{3}$ has a negligible effect (ideally no effect). The appropriate value for $R_{3}$ can be determined by analyzing the circuit in Fig. 2.34, where analysis details are shown, and the output voltage is given by

$$
V_{O}=-I_{B 2} R_{3}+R_{2}\left(I_{B 1}-I_{B 2} R_{3} / R_{1}\right)
$$

Consider first the case $I_{B 1}=I_{B 2}=I_{B}$, which results in

$$
V_{O}=I_{B}\left[R_{2}-R_{3}\left(1+R_{2} / R_{1}\right)\right]
$$

Thus we can reduce $V_{O}$ to zero by selecting $R_{3}$ such that

$$
R_{3}=\frac{R_{2}}{1+R_{2} / R_{1}}=\frac{R_{1} R_{2}}{R_{1}+R_{2}}
$$

That is, $R_{3}$ should be made equal to the parallel equivalent of $R_{1}$ and $R_{2}$.
Having selected $R_{3}$ as above, let us evaluate the effect of a finite offset current $I_{O S}$. Let $I_{B 1}=I_{B}+I_{O S} / 2$ and $I_{B 2}=I_{B}-I_{O S} / 2$, and substitute in Eq. (2.38). The result is

$$
V_{O}=I_{O S} R_{2}
$$

which is usually about an order of magnitude smaller than the value obtained without $R_{3}$ (Eq. 2.37). We conclude that to minimize the effect of the input bias currents, one should place in the positive lead a resistance equal to the equivalant dc resistance seen by the inverting terminal. We emphasize the word $d c$ in the last statement; note that if the amplifier is ac-coupled, we should select $R_{3}=R_{2}$, as shown in Fig. 2.35.


Figure 2.35 In an ac-coupled amplifier the dc resistance seen by the inverting terminal is $R_{2}$; hence $R_{3}$ is chosen equal to $R_{2}$.


Figure 2.36 Illustrating the need for a continuous dc path for each of the op-amp input terminals. Specifically, note that the amplifier will not work without resistor $R_{3}$.

While we are on the subject of ac-coupled amplifiers, we should note that one must always provide a continuous dc path between each of the input terminals of the op amp and ground. This is the case no matter how small $I_{R}$ is. For this reason the ac-coupled noninverting amplifier of Fig. 2.36 will not work without the resistance $R_{3}$ to ground. Unfortunately, including $R_{3}$ lowers considerably the input resistance of the closed-loop amplifier.

# EXERCISE 

2.24 Consider an inverting amplifier circuit designed using an op amp and two resistors, $R_{1}=10 \mathrm{k} \Omega$ and $R_{2}=1 \mathrm{M} \Omega$. If the op amp is specified to have an input bias current of 100 nA and an input offset current of 10 nA , find the output dc offset voltage resulting and the value of a resistor $R_{3}$ to be placed in series with the positive input lead in order to minimize the output offset voltage. What is the new value of $V_{O}$ ?
Ans. $0.1 \mathrm{~V} ; 9.9 \mathrm{k} \Omega(\simeq 10 \mathrm{k} \Omega) ; 0.01 \mathrm{~V}$

### 2.6.3 Effect of $V_{O S}$ and $I_{O S}$ on the Operation of the Inverting Integrator

Our discussion of the inverting integrator circuit in Section 2.5.2 mentioned the susceptibility of this circuit to saturation in the presence of small dc voltages or currents. It behooves us therefore to consider the effect of the op-amp dc offsets on its operation. As will be seen, these effects can be quite dramatic.


Figure 2.37 Determining the effect of the op-amp input offset voltage $V_{O S}$ on the Miller integrator circuit. Note that since the output rises with time, the op amp eventually saturates.

To see the effect of the input dc offset voltage $V_{O S}$, consider the integrator circuit in Fig. 2.37, where for simplicity we have short-circuited the input signal source. Analysis of the circuit is straightforward and is shown in Fig. 2.37. Assuming for simplicity that at time $t=0$ the voltage across the capacitor is zero, the output voltage as a function of time is given by

$$
v_{O}=V_{O S}+\frac{V_{O S}}{C R} t
$$

Thus $v_{O}$ increases linearly with time until the op amp saturates-clearly an unacceptable situation! As should be expected, the dc input offset current $I_{O S}$ produces a similar problem. Figure 2.38 illustrates the situation. Observe that we have added a resistance $R$ in the op-amp positive-input lead in order to keep the input bias current $I_{B}$ from flowing through $C$. Nevertheless, the offset current $I_{O S}$ will flow through $C$ and cause $v_{O}$ to ramp linearly with time until the op amp saturates.

As mentioned in Section 2.5.2 the dc problem of the integrator circuit can be alleviated by connecting a resistor $R_{F}$ across the integrator capacitor $C$, as shown in Fig. 2.25. Such a resistor provides a dc path through which the dc currents $\left(V_{O S} / R\right)$ and $I_{O S}$ can flow (assuming a resistance equal to $R \| R_{F}$ is connected in the positive op-amp lead), with the result that $v_{O}$ will now have a dc component $\left[V_{O S}\left(1+R_{F} / R\right)+I_{O S} R_{F}\right]$ instead of rising linearly. To keep the dc offset at the output small, one would select a low value for $R_{F}$. Unfortunately, however, the lower the value of $R_{F}$, the less ideal the integrator circuit becomes.



Figure 2.38 Effect of the op-amp input bias and offset currents on the performance of the Miller integrator circuit.
# EXERCISE 

2.25 Consider a Miller integrator with a time constant of 1 ms and an input resistance of $10 \mathrm{k} \Omega$. Let the op amp have $V_{O S}=2 \mathrm{mV}$ and output saturation voltages of $\pm 12 \mathrm{~V}$. (a) Assuming that when the power supply is turned on the capacitor voltage is zero, how long does it take for the amplifier to saturate? (b) Select the largest possible value for a feedback resistor $R_{F}$ so that at least $\pm 10 \mathrm{~V}$ of output signal swing remains available. What is the corner frequency of the resulting STC network?
Ans. (a) 6 s ; (b) $10 \mathrm{M} \Omega, 0.16 \mathrm{~Hz}$

### 2.7 Effect of Finite Open-Loop Gain and Bandwidth on Circuit Performance

### 2.7.1 Frequency Dependence of the Open-Loop Gain

The differential open-loop gain $A$ of an op amp is not infinite; rather, it is finite and decreases with frequency. Figure 2.39 shows a plot for $|A|$, with the numbers typical of some commercially available general-purpose op amps (such as the popular 741-type op amp, available from many semiconductor manufacturers; its internal circuit is studied in Chapter 13).


Figure 2.39 Open-loop gain of a typical general-purpose, internally compensated op amp.
Note that although the gain is quite high at dc and low frequencies, it starts to fall off at a rather low frequency ( 10 Hz in our example). The uniform $-20-\mathrm{dB} /$ decade gain rolloff shown is typical of internally compensated op amps. These are units that have a network (usually a single capacitor) included within the same IC chip whose function is to cause the op-amp gain to have the single-time-constant (STC) low-pass response shown. This process of modifying the open-loop gain is termed frequency compensation, and its purpose is to ensure that op-amp circuits will be stable (as opposed to oscillatory). The subject of stability of op-amp circuits-or, more generally, of feedback amplifiers-will be studied in Chapter 11.

By analogy to the response of low-pass STC circuits (see Section 1.6 and, for more detail, Appendix E), the gain $A(s)$ of an internally compensated op amp may be expressed as

$$
A(s)=\frac{A_{0}}{1+s / \omega_{b}}
$$

which for physical frequencies, $s=j \omega$, becomes

$$
A(j \omega)=\frac{A_{0}}{1+j \omega / \omega_{b}}
$$

where $A_{0}$ denotes the dc gain and $\omega_{b}$ is the $3-\mathrm{dB}$ frequency (corner frequency or "break" frequency). For the example shown in Fig. 2.39, $A_{0}=10^{5}$ and $\omega_{b}=2 \pi \times 10 \mathrm{rad} / \mathrm{s}$. For frequencies $\omega \gg \omega_{b}$ (about 10 times and higher) Eq. (2.43) may be approximated by

$$
A(j \omega) \simeq \frac{A_{0} \omega_{b}}{j \omega}
$$

Thus,

$$
|A(j \omega)|=\frac{A_{0} \omega_{b}}{\omega}
$$

from which it can be seen that the gain $|A|$ reaches unity $(0 \mathrm{~dB})$ at a frequency denoted by $\omega_{s}$ and given by

$$
\omega_{s}=A_{0} \omega_{b}
$$

Substituting in Eq. (2.44) gives

$$
A(j \omega) \simeq \frac{\omega_{s}}{j \omega}
$$

The frequency $f_{i}=\omega_{s} / 2 \pi$ is usually specified on the data sheets of commercially available op amps and is known as the unity-gain bandwidth. ${ }^{6}$ Also note that for $\omega \gg \omega_{b}$ the open-loop gain in Eq. (2.42) becomes

$$
A(s) \simeq \frac{\omega_{s}}{s}
$$

[^0]
[^0]:    ${ }^{6}$ Since $f_{i}$ is the product of the dc gain $A_{0}$ and the $3-\mathrm{dB}$ bandwidth $f_{b}$ (where $f_{b}=\omega_{b} / 2 \pi$ ), it is also known as the gain-bandwidth product (GB). The reader is cautioned, however, that in some amplifiers (those that do not have an STC response), the unity-gain frequency and the gain-bandwidth product are not equal.
The gain magnitude can be obtained from Eq. (2.47) as

$$
|A(j \omega)| \simeq \frac{\omega_{i}}{\omega}=\frac{f_{i}}{f}
$$

Thus if $f_{i}$ is known ( $10^{6} \mathrm{~Hz}$ in our example), one can easily determine the magnitude of the op-amp gain at a given frequency $f$. Furthermore, observe that this relationship correlates with the Bode plot in Fig. 2.39. Specifically, for $f \gg f_{b}$, doubling $f$ (an octave increase) results in halving the gain (a $6-\mathrm{dB}$ reduction). Similarly, increasing $f$ by a factor of 10 (a decade increase) results in reducing $|A|$ by a factor of $10(20 \mathrm{~dB})$.

As a matter of practical importance, we note that the production spread in the value of $f_{i}$ between op-amp units of the same type is usually much smaller than that observed for $A_{0}$ and $f_{b}$. For this reason $f_{i}$ is preferred as a specification parameter. Finally, it should be mentioned that an op amp having this uniform $-6-\mathrm{dB} /$ octave (or equivalently $-20-\mathrm{dB} /$ decade) gain rolloff is said to have a single-pole model. Also, since this single pole dominates the amplifier frequency response, it is called a dominant pole. For more on poles (and zeros), the reader may wish to consult Appendix F.

# EXERCISE 

2.26 An internally compensated op amp is specified to have an open-loop dc gain of 106 dB and a unity-gain bandwidth of 3 MHz . Find $f_{b}$ and the open-loop gain (in dB ) at $f_{b}, 300 \mathrm{~Hz}, 3 \mathrm{kHz}, 12 \mathrm{kHz}$, and 60 kHz . Ans. $15 \mathrm{~Hz} ; 103 \mathrm{~dB} ; 80 \mathrm{~dB} ; 60 \mathrm{~dB} ; 48 \mathrm{~dB} ; 34 \mathrm{~dB}$

### 2.7.2 Frequency Response of Closed-Loop Amplifiers

We next consider the effect of limited op-amp gain and bandwidth on the closed-loop transfer functions of the two basic configurations: the inverting circuit of Fig. 2.5 and the noninverting circuit of Fig. 2.12. The closed-loop gain of the inverting amplifier, assuming a finite op-amp open-loop gain $A$, was derived in Section 2.2 and given in Eq. (2.5), which we repeat here as

$$
\frac{V_{o}}{V_{i}}=\frac{-R_{2} / R_{1}}{1+\left(1+R_{2} / R_{1}\right) / A}
$$

Substituting for $A$ from Eq. (2.42) and using Eq. (2.46) gives

$$
\frac{V_{o}(s)}{V_{i}(s)}=\frac{-R_{2} / R_{1}}{1+\frac{1}{A_{0}}\left(1+\frac{R_{2}}{R_{1}}\right)+\frac{s}{\omega_{i} /\left(1+R_{2} / R_{1}\right)}}
$$

For $A_{0} \gg 1+R_{2} / R_{1}$, which is usually the case,

$$
\frac{V_{o}(s)}{V_{i}(s)} \simeq \frac{-R_{2} / R_{1}}{1+\frac{s}{\omega_{i} /\left(1+R_{2} / R_{1}\right)}}
$$
which is of the same form as that for a low-pass STC network (see Table 1.2, page 36). Thus the inverting amplifier has an STC low-pass response with a dc gain of magnitude equal to $R_{2} / R_{1}$. The closed-loop gain rolls off at a uniform $-20-\mathrm{dB} /$ decade slope with a corner frequency (3-dB frequency) given by

$$
\omega_{3 \mathrm{~dB}}=\frac{\omega_{i}}{1+R_{2} / R_{1}}
$$

Similarly, analysis of the noninverting amplifier of Fig. 2.12, assuming a finite open-loop gain $A$, yields the closed-loop transfer function

$$
\frac{V_{o}}{V_{i}}=\frac{1+R_{2} / R_{1}}{1+\left(1+R_{2} / R_{1}\right) / A}
$$

Substituting for $A$ from Eq. (2.42) and making the approximation $A_{0} \gg 1+R_{2} / R_{1}$ results in

$$
\frac{V_{o}(s)}{V_{i}(s)} \simeq \frac{1+R_{2} / R_{1}}{1+\frac{s}{\omega_{i} /\left(1+R_{2} / R_{1}\right)}}
$$

Thus the noninverting amplifier has an STC low-pass response with a dc gain of $\left(1+R_{2} / R_{1}\right)$ and a 3-dB frequency given also by Eq. (2.53).

# Example 2.6 

Consider an op amp with $f_{i}=1 \mathrm{MHz}$. Find the 3-dB frequency of closed-loop amplifiers with nominal gains of $+1000,+100,+10,+1,-1,-10,-100$, and -1000 . Sketch the magnitude frequency response for the amplifiers with closed-loop gains of +10 and -10 .

## Solution

We use Eq. (2.53) to obtain the results given in the following table.

| Closed-Loop Gain | $\boldsymbol{R}_{\mathbf{2}} / \boldsymbol{R}_{\mathbf{1}}$ | $\boldsymbol{f}_{\mathbf{3} \mathrm{dB}}=\boldsymbol{f}_{\mathbf{1}} /\left(\mathbf{1}+\boldsymbol{R}_{\mathbf{2}} / \boldsymbol{R}_{\mathbf{1}}\right)$ |
| :--: | :--: | :--: |
| +1000 | 999 | 1 kHz |
| +100 | 99 | 10 kHz |
| +10 | 9 | 100 kHz |
| +1 | 0 | 1 MHz |
| -1 | 1 | 0.5 MHz |
| -10 | 10 | 90.9 kHz |
| -100 | 100 | 9.9 kHz |
| -1000 | 1000 | $\simeq 1 \mathrm{kHz}$ |

Figure 2.40 shows the frequency response for the amplifier whose nominal dc gain is $+10(20 \mathrm{~dB})$, and Fig. 2.41 shows the frequency response for the -10 (also 20 dB ) case. An interesting observation follows
from the table above: The unity-gain inverting amplifier has a 3-dB frequency of $f_{i} / 2$ as compared to $f_{i}$ for the unity-gain noninverting amplifier (the unity-gain voltage follower).


Figure 2.40 Frequency response of an amplifier with a nominal gain of $+10 \mathrm{~V} / \mathrm{V}$.


Figure 2.41 Frequency response of an amplifier with a nominal gain of $-10 \mathrm{~V} / \mathrm{V}$.

The table in Example 2.6 above clearly illustrates the trade-off between gain and bandwidth: For a given op amp, the lower the closed-loop gain required, the wider the bandwidth achieved. Indeed, the noninverting configuration exhibits a constant gain-bandwidth product equal to $f_{i}$ of the op amp. An interpretation of these results in terms of feedback theory will be given in Chapter 11.
# EXERCISES 

2.27 An internally compensated op amp has a dc open-loop gain of $10^{6} \mathrm{~V} / \mathrm{V}$ and an open-loop gain of 40 dB at 10 kHz . Estimate its 3-dB frequency, its unity-gain frequency, its gain-bandwidth product, and its expected gain at 1 kHz .
Ans. $1 \mathrm{~Hz} ; 1 \mathrm{MHz} ; 1 \mathrm{MHz} ; 60 \mathrm{~dB}$
2.28 An op amp having a $106-\mathrm{dB}$ gain at dc and a single-pole frequency response with $f_{i}=2 \mathrm{MHz}$ is used to design a noninverting amplifier with nominal dc gain of 100 . Find the 3-dB frequency of the closed-loop gain.
Ans. 20 kHz

### 2.8 Large-Signal Operation of Op Amps

In this section, we study the limitations on the performance of op-amp circuits when large output signals are present.

### 2.8.1 Output Voltage Saturation

Similar to all other amplifiers, op amps operate linearly over a limited range of output voltages. Specifically, the op-amp output saturates in the manner shown in Fig. 1.14 with $L_{+}$and $L_{-}$ within 1 V or so of the positive and negative power supplies, respectively. Thus, an op amp that is operating from $\pm 15-\mathrm{V}$ supplies will saturate when the output voltage reaches about +13 V in the positive direction and -13 V in the negative direction. For this particular op amp the rated output voltage is said to be $\pm 13 \mathrm{~V}$. To avoid clipping off the peaks of the output waveform, and the resulting waveform distortion, the input signal must be kept correspondingly small.

### 2.8.2 Output Current Limits

Another limitation on the operation of op amps is that their output current is limited to a specified maximum. For instance, the popular 741 op amp is specified to have a maximum output current of $\pm 20 \mathrm{~mA}$. Thus, in designing closed-loop circuits utilizing the 741 , the designer has to ensure that under no condition will the op amp be required to supply an output current, in either direction, exceeding 20 mA . This, of course, has to include both the current in the feedback circuit as well as the current supplied to a load resistor. If the circuit requires a larger current, the op-amp output voltage will saturate at the level corresponding to the maximum allowed output current.
# Example 2.7 

Consider the noninverting amplifier circuit shown in Fig. 2.42. As shown, the circuit is designed for a nominal gain $\left(1+R_{2} / R_{1}\right)=10 \mathrm{~V} / \mathrm{V}$. It is fed with a low-frequency sine-wave signal of peak voltage $V_{p}$ and is connected to a load resistor $R_{L}$. The op amp is specified to have output saturation voltages of $\pm 13 \mathrm{~V}$ and output current limits of $\pm 20 \mathrm{~mA}$.
(a) For $V_{p}=1 \mathrm{~V}$ and $R_{L}=1 \mathrm{k} \Omega$, specify the signal resulting at the output of the amplifier.
(b) For $V_{p}=1.5 \mathrm{~V}$ and $R_{L}=1 \mathrm{k} \Omega$, specify the signal resulting at the output of the amplifier.
(c) For $R_{L}=1 \mathrm{k} \Omega$, what is the maximum value of $V_{p}$ for which an undistorted sine-wave output is obtained?
(d) For $V_{p}=1 \mathrm{~V}$, what is the lowest value of $R_{L}$ for which an undistorted sine-wave output is obtained?


Figure 2.42 (a) A noninverting amplifier with a nominal gain of $10 \mathrm{~V} / \mathrm{V}$ designed using an op amp that saturates at $\pm 13-\mathrm{V}$ output voltage and has $\pm 20-\mathrm{mA}$ output current limits. (b) When the input sine wave has a peak of 1.5 V , the output is clipped off at $\pm 13 \mathrm{~V}$.

## Solution

(a) For $V_{p}=1 \mathrm{~V}$ and $R_{L}=1 \mathrm{k} \Omega$, the output will be a sine wave with peak value of 10 V . This is lower than output saturation levels of $\pm 13 \mathrm{~V}$, and thus the amplifier is not limited that way. Also, when the output is at its peak $(10 \mathrm{~V})$, the current in the load will be $10 \mathrm{~V} / 1 \mathrm{k} \Omega=10 \mathrm{~mA}$, and the current in the feedback network will be $10 \mathrm{~V} /(9+1) \mathrm{k} \Omega=1 \mathrm{~mA}$, for a total op-amp output current of 11 mA , well under its limit of 20 mA .
(b) Now if $V_{p}$ is increased to 1.5 V , ideally the output would be a sine wave of $15-\mathrm{V}$ peak. The op amp, however, will saturate at $\pm 13 \mathrm{~V}$, thus clipping the sine-wave output at these levels. Let's next check on the op-amp output current: At $13-\mathrm{V}$ output and $R_{L}=1 \mathrm{k} \Omega, i_{L}=13 \mathrm{~mA}$ and $i_{F}=1.3 \mathrm{~mA}$; thus $i_{O}=14.3 \mathrm{~mA}$, again under the $20-\mathrm{mA}$ limit. Thus the output will be a sine wave with its peaks clipped off at $\pm 13 \mathrm{~V}$, as shown in Fig. 2.42(b).
(c) For $R_{L}=1 \mathrm{k} \Omega$, the maximum value of $V_{p}$ for undistorted sine-wave output is 1.3 V . The output will be a $13-\mathrm{V}$ peak sine wave, and the op-amp output current at the peaks will be 14.3 mA .

Figure 16.34 Pixel circuit in a CMOS image sensor.
is thus reverse biased, and its current $I_{D}$ is essentially proportional to light intensity. Over the sensing interval $T$, the discharge of the parasitic capacitor $C$ by current $I_{D}$ causes a voltage drop $\Delta V$ to occur at X . This voltage change is then read out onto the column line by activating a source follower $Q_{N 1}$ and a current source (not shown, connected to the column line) and a switch $Q_{N 2}$. The resulting analog signal on the column line is then fed to an analog-to-digital converter (ADC) to provide a digital number corresponding to the light intensity of this pixel. The digital data thus produced can be used for further digital processing of the captured image.

# BLINDING FLASH: 

Since its invention in 1980 by Toshiba, flash memory based on the floating-gate MOS transistor has expanded into every possible field of computing. Because of its nonvolatility, flash memory has become largely responsible for the dominance of mobile digital devices. Increasingly, flash-based solid-state drives (SSDs) are overtaking hard disk drives in enterprise memory systems. SSDs of more than 1 terabyte with no moving parts are becoming available for a few hundred dollars in technologies as small as 20 nm . In many applications, high data rates of up to $12 \mathrm{~Gb} / \mathrm{s}$ allow total replacement of volatile DRAMs in handheld devices. At the other end of the scale, flash-filled USB drives with gigabyte capacities have effectively replaced the need for DVDs in today's laptops.

## Summary

- Flip-flops employ one or more latches. The basic static latch is a bistable circuit implemented using two inverters connected in a positive-feedback loop. The latch can remain in either stable state indefinitely.
- As an alternative to the positive-feedback approach, memory can be provided through the use of charge storage. A number of CMOS flip-flops are realized this way, including some master-slave D flip-flops.
- A random-access memory (RAM) is one in which the time required for storing (writing) information and for retrieving (reading) information is independent of the physical location (within the memory) at which the information is stored.
- The major part of a memory chip consists of the cells in which the bits are stored and that are typically organized in a square matrix. A cell is selected for reading or writing by
activating its row, via the row-address decoder, and its column, via the column-address decoder. The sense amplifier detects the content of the selected cell and provides a full-swing version of it to the data-output terminal of the chip.

- There are two kinds of MOS RAM: static and dynamic. Static RAMs (SRAMs) employ flip-flops as the storage cells. In a dynamic RAM (DRAM), data is stored on a capacitor and thus must be periodically refreshed. DRAM chips provide the highest possible storage capacity for a given chip area.
- Two circuits have emerged as the near-universal choice in implementing the storage cell: the six-transistor SRAM cell and the one-transistor DRAM cell.
- Although sense amplifiers are utilized in SRAMs to speed up operation, they are essential in DRAMs. A particular type of sense amplifier is a differential circuit that employs positive feedback to obtain an output signal that grows exponentially toward either $V_{D D}$ or 0 .
- Read-only memory (ROM) contains fixed data patterns that are stored at the time of fabrication and cannot be changed by the user. On the other hand, the contents of an erasable programmable ROM (EPROM) can be changed by the user. The erasure and reprogramming is a time-consuming process and is performed only infrequently.
- Some EPROMS utilize floating-gate MOSFETs as the storage cells. The cell is programmed by applying (to the selected gate) a high voltage, which in effect changes the threshold voltage of the MOSFET. Erasure is achieved by illuminating the chip by ultraviolet light. Even more versatile, EEPROMs can be erased and reprogrammed electrically. These are called flash memories and are currently in widespread use.
- CMOS image sensors are organized in arrays very similar to those used in memories. Each pixel circuit measures the light intensity at its pixel and provides this information on its column line in analog form, which is converted into a digital signal by means of an analog-to-digital converter (ADC).


## Section 16.1: Latches and Flip-Flops

16.1 Consider the latch of Fig. 16.1 with the two inverters identical and each characterized by $V_{O L}=0 \mathrm{~V}, V_{O H}=5 \mathrm{~V}$, $V_{I L}=2 \mathrm{~V}$, and $V_{I H}=3 \mathrm{~V}$. Let the transfer characteristic of each inverter be approximated by three straight-line segments. Sketch the transfer characteristic of the feedback loop of the latch and give the coordinates of points A, B, and C [refer to Fig. 16.1(b)]. What is the gain at C? What is the width of the transition region?

D 16.2 Sketch the standard CMOS circuit implementation of the SR flip-flop shown in Fig. 16.3.

D 16.3 Sketch the logic-gate implementation of an SR flip-flop utilizing two cross-coupled NAND gates. Clearly label the output terminals and the input trigger terminals. Provide the truth table and describe the operation.

D 16.4 For the SR flip-flop of Fig. 16.4, show that if each of the two inverters utilizes matched transistors, that is, $(W / L)_{p}=$ $\left(\mu_{n} / \mu_{n}\right)(W / L)_{n}$, then the minimum $W / L$ that each of $Q_{S}-Q_{8}$ must have so that switching occurs is $2(W / L)_{n}$. Give the sizes of all eight transistors if the flip-flop is fabricated in a $0.13-\mu \mathrm{m}$ process for which $\mu_{n}=4 \mu_{p}$. Use the minimum channel length for all transistors and the minimum size $(W / L=1)$ for $Q_{1}$ and $Q_{3}$.

D 16.5 Repeat part (a) of the problem in Example 16.1 for the case of inverters that do not use matched $Q_{N}$ and $Q_{P}$. Rather, assume that each of the inverters uses $(W / L)_{p}=(W / L)_{n}=$ $0.27 \mu \mathrm{~m} / 0.18 \mu \mathrm{~m}$. Find the threshold voltage of each inverter. Then determine the value required for the $W / L$ of each of $Q_{S}$ to $Q_{8}$ so that the flip-flop switches. (Hint: Refer to Table 14.2.)

D 16.6 In this problem we investigate the effect of velocity saturation (Section 15.1.3) on the design of the SR flip-flop in Example 16.1. Specifically, answer part (a) of the question

[^0]
[^0]:    $\mathrm{SHM}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
in Example 16.1, taking into account the fact that for this technology, $V_{D S s a t}$ for $n$-channel devices is 0.6 V and $\left|V_{D S s a t}\right|$ for $p$-channel devices is 1 V . Assume $\lambda_{n}=\left|\lambda_{p}\right|=0.1 \mathrm{~V}^{-1}$. What is the minimum required value for $(W / L)_{S}$ and for $(W / L)_{b}$ ? Comment on this value relative to that found in Example 16.1. (Hint: Refer to Eq. 15.11.)

D 16.7 The CMOS SR flip-flop in Fig. 16.4 is fabricated in a $0.13-\mu \mathrm{m}$ process for which $\mu_{n} C_{e o}=4 \mu_{p} C_{e s}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$, $V_{t o}=\left|V_{t p}\right|=0.4 \mathrm{~V}$, and $V_{D D}=1.2 \mathrm{~V}$. The inverters have $(W / L)_{n}=0.2 \mu \mathrm{~m} / 0.13 \mu \mathrm{~m}$ and $(W / L)_{p}=0.8 \mu \mathrm{~m} / 0.13 \mu \mathrm{~m}$. The four NMOS transistors in the set-reset circuit have equal $W / L$ ratios.
(a) Determine the minimum value required for this ratio to ensure that the flip-flop will switch.
(b) If a ratio twice the minimum is selected, determine the minimum required width of the set and reset pulses to ensure switching. Assume that the total capacitance between each of the $Q$ and $\bar{Q}$ nodes and ground is 15 fF .

D 16.8 The clocked SR flip-flop in Fig. 16.4 is not a fully complementary CMOS circuit. Sketch the fully complementary version by augmenting the circuit with the PUN corresponding to the PDN comprising $Q_{S}, Q_{b}, Q_{1}$, and $Q_{8}$. Note that the fully complementary circuit utilizes 12 transistors. Although the circuit is more complex, it switches faster.

D 16.9 Consider another possibility for the circuit in Fig. 16.7: Relabel the $R$ input as $\bar{S}$ and the $S$ input as $\bar{R}$. Let $\bar{S}$ and $\bar{R}$ normally rest at $V_{D D}$. Let the flip-flop be storing a 0 ; thus $V_{Q}=0 \mathrm{~V}$ and $V_{\bar{Q}}=V_{D D}$. To set the flip-flop, the $\bar{S}$ terminal is lowered to 0 V and the clock $\phi$ is raised to $V_{D D}$. The relevant part of the circuit is then transistors $Q_{S}$ and $Q_{2}$. For the flip-flop to switch, the voltage at $\bar{Q}$ must be lowered to $V_{D D} / 2$. What is the minimum required $W / L$ for $Q_{S}$ in terms of $(W / L)_{2}$ and $\left(\mu_{n} / \mu_{p}\right)$ ? Assume $V_{t o}=\left|V_{t p}\right|$.
*16.10 Figure P16.10 shows a commonly used circuit of a D flip-flop that is triggered by the negative-going edge of the clock $\phi$.
(a) For $\phi$ high, what are the values of $\bar{Q}$ and $Q$ in terms of $D$ ? Which transistors are conducting?
(b) If $D$ is high and $\phi$ goes low, which transistors conduct and what signals appear at $\bar{Q}$ and at $Q$ ? Describe the circuit operation.
(c) Repeat (b) for $D$ low with the clock $\phi$ going low.
(d) Does the operation of this circuit rely on charge storage?


Figure P16.10

## Section 16.2: Semiconductor Memories: Types and Architectures

16.11 How many cells does a 4-Gbit RAM have?
16.12 A 4-Gbit memory chip is organized as 256 M words $\times$ 16 bits. How many bits does the word address need?
16.13 A particular 1-M-bit-square memory array has its peripheral circuits reorganized to allow for the readout of a 16-bit word. How many address bits will the new design need?
16.14 For the memory chip described in Problem 16.13, how many word lines must be supplied by the row decoder? How many sense amplifiers/drivers would a straightforward implementation require? If the chip power dissipation is 500 mW with a $5-\mathrm{V}$ supply for continuous operation with a 20-ns cycle time, and all the power loss is dynamic, estimate the total capacitance of all logic activated in any one cycle. If we assume that $90 \%$ of this power loss occurs in array access, and that the major capacitance contributor will be the bit line itself, calculate the capacitance per bit line and per bit for this design. (Recall from Problem 16.13 that 16 bit lines are selected simultaneously.) If closer manufacturing control allows the memory array to operate at 3 V , how much larger a memory array can be designed in the same technology at about the same power level?
16.15 A 1.5-V, 1-Gbit dynamic RAM (called DRAM) by Hitachi uses a $0.16-\mu \mathrm{m}$ process with a cell size of $0.38 \times$ $0.76 \mu \mathrm{~m}^{2}$ in a $19 \times 38 \mathrm{~mm}^{2}$ chip. What fraction of the chip is occupied by the I/O connections, peripheral circuits, and interconnect?
## Section 16.3: Random-Access Memory (RAM) Cells

16.16 Repeat Exercise 16.4 for an SRAM fabricated in a $0.25-\mu \mathrm{m}$ CMOS process for which $V_{D D}=2.5 \mathrm{~V}$ and $V_{i}=$ 0.5 V .
16.17 Repeat Exercise 16.4 for an SRAM fabricated in a $0.13-\mu \mathrm{m}$ CMOS process for which $V_{D D}=1.2 \mathrm{~V}$ and $V_{i}=0.4 \mathrm{~V}$.
16.18 Locate on the graph of Fig. 16.14 the points A, B, and C that correspond to the following three process technologies:
(a) $0.25-\mu \mathrm{m}: V_{D D}=2.5 \mathrm{~V}$ and $V_{i}=0.5 \mathrm{~V}$
(b) $0.18-\mu \mathrm{m}: V_{D D}=1.8 \mathrm{~V}$ and $V_{i}=0.5 \mathrm{~V}$
(c) $0.13-\mu \mathrm{m}: V_{D D}=1.2 \mathrm{~V}$ and $V_{i}=0.4 \mathrm{~V}$

In each case, impose the condition that in a read-1 operation $V_{\bar{Q}}=V_{i}$.

D 16.19 Find the maximum allowable $W / L$ for the access transistors of the SRAM cell in Fig. 16.12 so that in the read operation, the voltages at $Q$ and $\bar{Q}$ do not change by more than $\left|V_{i}\right|$. Assume that the SRAM is fabricated in a $0.13-\mu \mathrm{m}$ technology for which $V_{D D}=1.2 \mathrm{~V}$ and $V_{m}=\left|V_{s p}\right|=0.4 \mathrm{~V}$, and $(W / L)_{n}=1.5$. Find $V_{\bar{Q}}$ and $I_{5}$ that result in each of the following cases:
(i) $(W / L)_{n}=\frac{1}{3}$ the maximum allowed
(ii) $(W / L)_{n}=\frac{2}{3}$ the maximum allowed
(iii) $(W / L)_{n}=$ the maximum allowed

Assume $\mu_{n} C_{e x}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$. Which one of the three designs results in the shortest read delay?

D 16.20 Consider a 6 T SRAM cell fabricated in a $0.18-\mu \mathrm{m}$ CMOS process for which $V_{m}=\left|V_{s p}\right|=0.5 \mathrm{~V}$ and $V_{D D}=1.8 \mathrm{~V}$. If during a read-1 operation it is required that $V_{\bar{Q}}$ not exceed 0.2 V , use the graph in Fig. 16.14 to determine the maximum allowable value of the ratio $(W / L)_{5} /(W / L)_{1}$. For $L_{1}=L_{5}=0.18 \mu \mathrm{~m}$, select values for $W_{1}$ and $W_{5}$ that minimize the combined areas of $Q_{1}$ and $Q_{5}$. Assume that the minimum width allowed is $0.18 \mu \mathrm{~m}$.
16.21 Consider the read operation of the 6 T SRAM cell of Fig. 16.12 when it is storing a 0 , that is, $V_{\bar{Q}}=0 \mathrm{~V}$, and $V_{\bar{Q}}=V_{D D}$. Assume that the bit lines are precharged to $V_{D D}$ before the word-line voltage is raised to $V_{D D}$. Sketch the relevant part of the circuit and describe the operation. Show
that the analysis parallels that presented in the text for the read-1 operation.
*16.22 Refer to the circuit in Fig. 16.13 and find the maximum ratio $(W / L)_{5} /(W / L)_{1}$ for $V_{\bar{Q}} \leq V_{i}$, this time taking into account the velocity-saturation effect (Section 15.1.3, Eq. 15.11). The SRAM is fabricated in a $0.18-\mu \mathrm{m}$ CMOS process for which $V_{D D}=1.8 \mathrm{~V}, V_{i}=0.5 \mathrm{~V}$, and for the $n$-channel devices $V_{D S r a t}=0.6 \mathrm{~V}$. Compare to the value obtained without accounting for velocity saturation. (Hint: Convince yourself that for this situation only $Q_{5}$ will be operating in velocity saturation.)

D *16.23 For the 6T SRAM of Fig. 16.12, fabricated in a $0.13-\mu \mathrm{m}$ CMOS process for which $V_{D D}=1.2 \mathrm{~V}, V_{t h}=0.4 \mathrm{~V}$, $2 \phi_{l}=0.88 \mathrm{~V}$, and $\gamma=0.2 \mathrm{~V}^{1 / 2}$, find the maximum ratio $(W / L)_{5} /(W / L)_{1}$ for which $V_{\bar{Q}} \leq V_{t 0}$ during a read-1 operation (Fig. 16.13). Then, take into account the body effect in $Q_{5}$ and compare this result to the value obtained without accounting for the body effect.

D 16.24 A 6T SRAM cell is fabricated in a $0.13-\mu \mathrm{m}$ CMOS process for which $V_{D D}=1.2 \mathrm{~V}, V_{i}=0.4 \mathrm{~V}$, and $\mu_{n} C_{e x}=$ $500 \mu \mathrm{~A} / \mathrm{V}^{2}$. The inverters utilize $(W / L)_{n}=1$. Each of the bit lines has a $2-\mathrm{pF}$ capacitance to ground. The sense amplifier requires a minimum of $0.2-\mathrm{V}$ input for reliable and fast operation.
(a) Find the upper bound on $W / L$ for each of the access transistors so that $V_{\bar{Q}}$ and $V_{\bar{Q}}$ do not change by more than $V_{i}$ volts during the read operation.
(b) Find the delay time $\Delta t$ encountered in the read operation if the cell design utilizes minimum-size access transistors.
(c) Find the delay time $\Delta t$ if the design utilizes the maximum allowable size for the access transistors.
16.25 Consider the operation of writing a 1 into a 6 T SRAM cell that is originally storing a 0 . Sketch the relevant part of the circuit and explain the operation. Without doing detailed analysis, show that the analysis would lead to results identical to those obtained in the text for the write-0 operation.

D 16.26 For a 6T SRAM cell fabricated in a $0.13-\mu \mathrm{m}$ CMOS process, find the maximum permitted value of $(W / L)_{p}$ in terms of $(W / L)_{p}$ of the access transistors. Assume $V_{D D}=1.2 \mathrm{~V}$, $V_{m}=\left|V_{s p}\right|=0.4 \mathrm{~V}$, and $\mu_{n}=4 \mu_{p}$.
D 16.27 For a 6T SRAM cell fabricated in a $0.25-\mu \mathrm{m}$ CMOS process, find the maximum permitted value of $(W / L)_{p}$ in terms

[^0]
[^0]:    ${ }^{1}$ IN = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
of $(W / L)_{n}$ of the access transistors. Assume $V_{D D}=2.5 \mathrm{~V}$, $V_{m}=\left|V_{q r}\right|=0.5 \mathrm{~V}$, and $\mu_{u} \simeq 4 \mu_{g}$.
16.28 Locate on the graph in Fig. 16.17 the points A, B, and C corresponding to the following three CMOS fabrication processes:
(a) $0.25-\mu \mathrm{m}: V_{D D}=2.5 \mathrm{~V}, V_{m}=\left|V_{q r}\right|=0.5 \mathrm{~V}$
(b) $0.18-\mu \mathrm{m}: V_{D D}=1.8 \mathrm{~V}, V_{m}=\left|V_{q r}\right|=0.5 \mathrm{~V}$
(c) $0.13-\mu \mathrm{m}: V_{D D}=1.2 \mathrm{~V}, V_{m}=\left|V_{q r}\right|=0.4 \mathrm{~V}$

For all three, $\mu_{u} \simeq 4 \mu_{g}$. In each case, $V_{Q}$ is to be limited to a maximum value of $V_{m}$.

D 16.29 Design a minimum-size 6T SRAM cell in a $0.13-\mu \mathrm{m}$ process for which $V_{D D}=1.2 \mathrm{~V}$ and $V_{m}=\left|V_{q r}\right|=$ 0.4 V . All transistors are to have equal $L=0.13 \mu \mathrm{~m}$. Assume that the minimum width allowed is $0.13 \mu \mathrm{~m}$. Verify that your minimum-size cell meets the constraints in Eqs. (16.5) and (16.11).
16.30 For a particular DRAM design, the cell capacitance $C_{S}=35 \mathrm{fF}$ and $V_{D D}=1.2 \mathrm{~V}$. Each cell represents a capacitive load on the bit line of 0.8 fF . Assume a $20-\mathrm{fF}$ capacitance for the sense amplifier and other circuitry attached to the bit line. What is the maximum number of cells that can be attached to a bit line while ensuring a minimum bit-line signal of 25 mV ? How many bits of row addressing can be used? If the sense-amplifier gain is increased by a factor of 4 , how many word-line address bits can be accommodated?
16.31 For a DRAM available for regular use $98 \%$ of the time, having a row-to-column ratio of 2 to 1 , a cycle time of 10 ns , and a refresh cycle of 10 ms , estimate the total memory capacity.
16.32 In a particular dynamic memory chip, $C_{S}=30 \mathrm{fF}$, the bit-line capacitance per cell is 0.5 fF , and bit-line control circuitry involves 12 fF . For a 1-Mbit-square array, what bit-line signals result when a stored 1 is read? When a stored 0 is read? Assume that $V_{D D}=1.2 \mathrm{~V}$.
16.33 For a DRAM cell utilizing a capacitance of 30 fF , refresh is required within 12 ms . If a signal loss on the capacitor of 0.2 V can be tolerated, what is the largest acceptable leakage current present at the cell?

## Section 16.4: Sense Amplifiers and Address Decoders

D 16.34 Consider the operation of the differential sense amplifier of Fig. 16.20 following the rise of the sense control
signal $\phi_{s}$. Assume that a balanced differential signal of 0.1 V is established between the bit lines, each of which has a 1 pF capacitance. For $V_{D D}=1.2 \mathrm{~V}$, what value of $G_{m}$ of each of the inverters in the amplifier is required to cause the outputs to reach $0.1 V_{D D}$ and $0.9 V_{D D}$ [from initial values of $0.5 V_{D D}-(0.1 / 2)$ and $0.5 V_{D D}+(0.1 / 2)$ volts, respectively] in 2 ns ? If for the matched inverters, $\left|V_{i}\right|=0.4 \mathrm{~V}$ and $k_{n}^{\prime}=4 k_{p}^{\prime}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$, what are the device widths required? If the input signal is 0.2 V , what does the amplifier response time become?
16.35 A particular version of the regenerative sense amplifier of Fig. 16.20 in a $0.13-\mu \mathrm{m}$ technology uses transistors for which $\left|V_{i}\right|=0.4 \mathrm{~V}, k_{n}^{\prime}=4 k_{p}^{\prime}=500 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{D D}=1.2 \mathrm{~V}$, with $(W / L)_{n}=0.26 \mu \mathrm{~m} / 0.13 \mu \mathrm{~m}$ and $(W / L)_{p}=1.04 \mu \mathrm{~m} / 0.13 \mu \mathrm{~m}$. For each inverter, find the value of $G_{m}$. For a bit-line capacitance of 0.4 pF , and a delay until an output of $0.9 V_{D D}$ is reached of 1 ns , find the initial difference voltage required between the two bit lines. If the time can be relaxed by 1 ns , what input signal can be handled? With the increased delay time and with the input signal at the original level, by what percentage can the bit-line capacitance, and correspondingly the bit-line length, be increased? If the delay time required for the bit-line capacitances to charge by the constant current available from the storage cell, and thus develop the difference-voltage signal needed by the sense amplifier, was 2 ns , what does it increase to when longer lines are used?

D 16.36 (a) For the sense amplifier of Fig. 16.20, show that the time required for the bit lines to reach $0.9 V_{D D}$ and $0.1 V_{D D}$ is given by $t_{d}=\left(C_{B} / G_{m}\right) \ln \left(0.8 V_{D D} / \Delta V\right)$, where $\Delta V$ is the initial difference voltage between the two bit lines. (b) If the response time of the sense amplifier is to be reduced to one-half the value of an original design, by what factor must the width of all transistors be increased?
(c) If for a particular design, $V_{D D}=1.2 \mathrm{~V}$ and $\Delta V=0.2 \mathrm{~V}$, find the factor by which the widths of all transistors must be increased so that $\Delta V$ is reduced by a factor of 2 , while keeping $t_{d}$ unchanged?

D 16.37 It is required to design a sense amplifier of the type shown in Fig. 16.20 to operate with a DRAM using the dummy-cell technique illustrated in Fig. 16.22. The DRAM cell provides readout voltages of -100 mV when a 0 is stored and +40 mV when a 1 is stored. The sense amplifier is required to provide a differential output voltage of 1 V in at most 2 ns . Find the $W / L$ ratios of the transistors in the amplifier matched inverters, assuming that the processing technology is characterized by $k_{n}^{\prime}=4 k_{p}^{\prime}=300 \mu \mathrm{~A} / \mathrm{V}^{2},\left|V_{i}\right|=0.5 \mathrm{~V}$, and $V_{D D}=1.8 \mathrm{~V}$. The capacitance of each half-bit line is 0.5 pF .

[^0]
[^0]:    164 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
What will be the amplifier response time when a 0 is read? When a 1 is read?

D 16.38 It is required to design the sense amplifier of Fig. 16.24 to detect an input signal of 140 mV and provide a full output in 0.5 ns . If $C=50 \mathrm{fF}$ and $V_{D D}=1.2 \mathrm{~V}$, find the required current $I$ and the power dissipation.

D 16.39 Consider the sense amplifier in Fig. 16.24 in the equilibrium condition shown in part (b) of the figure. Let $V_{D D}=1.2 \mathrm{~V}$ and $V_{i}=0.4 \mathrm{~V}$.
(a) If $Q_{1}$ and $Q_{2}$ are to operate at the edge of saturation, what is the dc voltage at the drain of $Q_{1}$ ?
(b) If the switching voltage $\Delta V$ is to be about 140 mV , at what overdrive voltage $V_{O V}$ should $Q_{1}$ and $Q_{2}$ be operated in equilibrium? What dc voltage should appear at the common-source terminals of $Q_{1}$ and $Q_{2}$ ?
(c) If the delay component $\Delta t$ given by Eq. (16.18) is to be 0.5 ns , what current $I$ is needed if $C=55 \mathrm{fF}$ ?
(d) Find the $W / L$ required for each of $Q_{1}$ to $Q_{4}$ for $\mu_{n} C_{o s}=$ $4 \mu_{p} C_{o s}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$.
(e) If $Q_{5}$ is to operate at the same overdrive voltage as $Q_{1}$ and $Q_{2}$, find its required $W / L$ and the value of the reference voltage $V_{R}$,
16.40 Consider a 1024-row NOR decoder. To how many address bits does this correspond? How many output lines does the decoder have? How many input lines does the NOR array require? How many NMOS and PMOS transistors does such a design need?
16.41 For the column decoder shown in Fig. 16.26, how many column-address bits are needed in a 1-Mbit-square array? How many NMOS pass transistors are needed in the multiplexer? How many NMOS transistors are needed in the NOR decoder? How many PMOS transistors? What is the total number of NMOS and PMOS transistors needed?
16.42 Consider the use of the tree column decoder shown in Fig. 16.27 for application with a square 1-Mbit array. How many address bits are involved? How many levels of pass gates are used? How many pass transistors are there in total?
16.43 Consider a ring oscillator consisting of five inverters, each having $t_{P L H}=3 \mathrm{~ns}$ and $t_{P H L}=2 \mathrm{~ns}$. Sketch one of the output waveforms, and specify its frequency and the percentage of the cycle during which the output is high.
16.44 A ring-of-nine oscillator is found to operate at 20 MHz . Find the propagation delay of the inverter.

D 16.45 Design the one-shot circuit of Fig. 16.29 to provide an output pulse of 10 -ns width. If the inverters available have $t_{P}=2.5 \mathrm{~ns}$ delay, how many inverters do you need for the delay circuit?

## Section 16.5: Read-Only Memory (ROM)

16.46 Give the eight words stored in the ROM of Fig. 16.30.

D 16.47 Design the bit pattern to be stored in a $(16 \times 4)$ ROM that provides the 4-bit product of two 2-bit variables. Give a circuit implementation of the ROM array using a form similar to that of Fig. 16.30.
16.48 Consider a dynamic version of the ROM in Fig. 16.30 in which the gates of the PMOS devices are connected to a precharge control signal $\phi$. Let all the NMOS devices have $W / L=3 \mu \mathrm{~m} / 1.2 \mu \mathrm{~m}$ and all the PMOS devices have $W / L=12$ $\mu \mathrm{m} / 1.2 \mu \mathrm{~m}$. Assume $k_{a}^{\prime}=3 k_{p}^{\prime}=90 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{m}=-V_{s p}=1 \mathrm{~V}$, and $V_{D D}=5 \mathrm{~V}$.
(a) During the precharge interval, $\phi$ is lowered to 0 V . Estimate the time required to charge a bit line from 0 to 5 V . Use as an average charging current the current supplied by a PMOS transistor at a bit-line voltage halfway through the excursion of 0 to 5 V (i.e., 2.5 V ). The bit-line capacitance is 1 pF . Note that all NMOS transistors are cut off at this time.
(b) After the precharge interval is completed and $\phi$ returns to $V_{D D}$, the row decoder raises the voltage of the selected word line. Because of the finite resistance and capacitance of the word line, the voltage rises exponentially toward $V_{D D}$. If the resistance of each of the polysilicon word lines is $5 \mathrm{k} \Omega$ and the capacitance between the word line and ground is 2 pF , what is the $(10 \%$ to $90 \%$ ) rise time of the word-line voltage? What is the voltage reached at the end of one time constant?
(c) If we approximate the exponential rise of the word-line voltage by a step equal to the voltage reached in one time constant, find the interval $\Delta t$ required for an NMOS transistor to discharge the bit line and lower its voltage by 1 V .

## Section 16.6: CMOS Image Sensors

16.49 Consider the pixel circuit in Fig. 16.34. If the capacitance $C$ at the storage node X is 25 fF and if $Q_{P}$ resets the node voltage to $V_{D D}$, how much electron charge is accumulated onto the capacitance when the voltage drops by 1 V ? Also give the number of electrons this represents. (Recall that the magnitude of the electron charge is $\left.1.6 \times 10^{-19} \mathrm{C}\right)$.

[^0]
[^0]:    $S I R I=$ Multisim/PSpice; * = difficult problem; ** = more difficult; ${ }^{* * *}=$ very challenging; $\mathrm{D}=$ design problem
# PART IV 

## Filters and Oscillators

CHAPTER 17
Filters and Tuned Amplifiers 1290
CHAPTER 18
Signal Generators and Waveform-Shaping Circuits 1378
n Part IV we study an important class of analog circuits: filters and oscillators. Both topics have in common an application or system orientation. They provide dramatic and powerful illustration of the application of both negative and positive feedback. While the filters studied here are linear circuits, the design of oscillators makes use of both linear and nonlinear techniques.

Chapter 17 deals with the design of filters, which are important building blocks of communication and instrumentation systems. Filter design is one of the rare areas of engineering for which a complete design theory exists, starting from specification and culminating in an actual working circuit. The material presented should allow the reader to perform such a complete design process.

Chapter 17 covers most of the design methods and realization technologies currently in use for analog filters. In this respect, we should note that even though more and more signal processing is now performed digitally, analog filters are still needed. This is because most systems have to interface with the physical world, which is analog in nature. Such an interface, at a minimum, consists of an amplifier and an analog filter.

In the design of electronic systems, the need usually arises for signals of various waveforms-sinusoidal, pulse, square-wave, and so on. The generation of such signals is the subject of Chapter 18. It will be seen that some of the circuits utilized in waveform generation employ an op-amp version of the basic memory element studied in Chapter 16, the bistable multivibrator or latch.

The study of filters and oscillators relies on a thorough familiarity with basic feedback concepts, including the effect of feedback on the amplifier poles (Chapter 11), and with op-amp circuit applications (Chapter 2). As well, we assume knowledge of basic s-plane concepts including transfer functions (Chapter 1 and Appendix E), and poles, zeros, and Bode plots (Appendix F).
# CHAPTER 17 

## Filters and Tuned Amplifiers

Introduction 1291
17.1 Filter Transmission, Types, and Specification 1292
17.2 The Filter Transfer Function 1296
17.3 Butterworth and Chebyshev Filters 1300
17.4 First-Order and Second-Order Filter Functions 1307
17.5 The Second-Order LCR Resonator 1316
17.6 Second-Order Active Filters Based on Inductor Replacement 1322
17.7 Second-Order Active Filters Based on the Two-Integrator-Loop Topology 1330
17.8 Single-Amplifier Biquadratic Active Filters 1336
17.9 Sensitivity 1344
17.10 Transconductance-C Filters 1347
17.11 Switched-Capacitor Filters 1354
17.12 Tuned Amplifiers 1359

Summary 1368
Problems 1369
# IN THIS CHAPTER YOU WILL LEARN 

1. How filters are characterized by their signal-transmission properties and how they are classified into different types based on the relative location of their passband(s) and stopband(s).
2. How filters are specified and how to obtain a filter transfer function that meets the given specifications, including the use of popular special functions such as the Butterworth and the Chebyshev.
3. The various first-order and second-order filter functions and their realization using op amps and RC circuits.
4. The basic second-order LCR resonator and how it can be used to realize the various second-order filter functions.
5. The best op amp-RC circuit for realizing an inductance and how it can be used as the basis for realizing the various second-order filter functions.
6. That connecting two op-amp integrators, one inverting and one noninverting, in a feedback loop realizes a second-order resonance circuit and can be used to obtain circuit realizations of the various second-order filter functions.
7. How second-order filter functions can be realized using a single op amp and an RC circuit, and the performance limitations of these minimal realizations.
8. How the powerful concept of circuit sensitivity can be applied to assess the performance of filter circuits in the face of finite component tolerances.
9. How transconductors and capacitors can be used to design high-frequency filters in CMOS technology.
10. The basis for the most popular approach to the realization of filter functions in IC form; the switched-capacitor technique.
11. The design of tuned transistor amplifiers for radio-frequency (RF) applications.

## Introduction

In this chapter, we study the design of an important building block of communications and instrumentation systems, the electronic filter. Filter design is one of the very few areas of engineering for which a complete design theory exists, starting from specification and endingwith a circuit realization. A detailed study of filter design requires an entire book, and indeed such textbooks exist. In the limited space available here, we shall concentrate on a selection of topics that provide an introduction to the subject as well as a useful arsenal of filter circuits and design methods.

The oldest technology for realizing filters makes use of inductors and capacitors, and the resulting circuits are called passive LC filters. Such filters work well at high frequencies; however, in low-frequency applications ( dc to 100 kHz ) the required inductors are large and physically bulky, and their characteristics are quite nonideal. Furthermore, such inductors are impossible to fabricate in monolithic form and are incompatible with any of the modern techniques for assembling electronic systems. Therefore, there has been considerable interest in finding filter realizations that do not require inductors. Of the various possible types of inductorless filters, we shall study active-RC filters, transconductance-C filters, and switched-capacitor filters.

Active-RC filters utilize op amps together with resistors and capacitors and are fabricated using discrete, hybrid thick-film or hybrid thin-film circuit technologies. However, for large-volume production, such technologies do not yield the economies achieved by monolithic (IC) fabrication. At the present time, there are two popular approaches for realizing fully integrated filters: the transconductance-C approach, which is particularly suited for high-frequency applications, and the switched-capacitor approach, which is used for audio-frequency applications. We shall study both methods.

The last topic studied in this chapter is the tuned amplifier commonly employed in the design of radio and TV receivers. Although tuned amplifiers are in effect bandpass filters, they are studied separately because their design is based on somewhat different techniques.

The material in this chapter requires a thorough familiarity with op-amp circuit applications. Thus the study of Chapter 2 is a prerequisite.

# 17.1 Filter Transmission, Types, and Specification 

### 17.1.1 Filter Transmission

The filters we are about to study are linear circuits that can be represented by the general two-port network shown in Fig. 17.1. The filter transfer function $T(s)$ is the ratio of the output voltage $V_{o}(s)$ to the input voltage $V_{i}(s)$,

$$
T(s) \equiv \frac{V_{o}(s)}{V_{i}(s)}
$$

The filter transmission is found by evaluating $T(s)$ for physical frequencies, $s=j \omega$, and can be expressed in terms of its magnitude and phase as

$$
T(j \omega)=|T(j \omega)| e^{j \phi(\omega)}
$$

The magnitude of transmission is often expressed in decibels in terms of the gain function

$$
G(\omega) \equiv 20 \log |T(j \omega)| \cdot \mathrm{dB}
$$

or, alternatively, in terms of the attenuation function

$$
A(\omega) \equiv-20 \log |T(j \omega)| \cdot \mathrm{dB}
$$


Figure 17.1 The filters studied in this chapter are linear circuits represented by the general two-port network shown. The filter transfer function $T(s) \equiv V_{o}(s) / V_{i}(s)$.

A filter shapes the frequency spectrum of the input signal, $\left|V_{i}(j \omega)\right|$, according to the magnitude of the transfer function $|T(j \omega)|$, thus providing an output $V_{o}(j \omega)$ with a spectrum

$$
\left|V_{o}(j \omega)\right|=|T(j \omega)|\left|V_{i}(j \omega)\right|
$$

Also, the phase characteristics of the signal are modified as it passes through the filter according to the filter phase function $\phi(\omega)$.

# 17.1.2 Filter Types 

We are specifically interested here in filters that perform a frequency-selection function: passing signals whose frequency spectrum lies within a specified range, and stopping signals whose frequency spectrum falls outside this range. Such a filter has ideally a frequency band (or bands) over which the magnitude of transmission is unity (the filter passband) and a frequency band (or bands) over which the transmission is zero (the filter stopband). Figure 17.2 depicts the ideal transmission characteristics of the four major filter types: low-pass (LP) in Fig. 17.2(a), high-pass (HP) in Fig. 17.2(b), bandpass (BP) in Fig. 17.2(c), and bandstop (BS) or band-reject in Fig. 17.2(d). These idealized characteristics, by virtue of their vertical edges, are known as brick-wall responses.

### 17.1.3 Filter Specification

The filter-design process begins with the filter user specifying the transmission characteristics required of the filter. Such a specification cannot be of the form shown in Fig. 17.2 because physical circuits cannot realize these idealized characteristics. Figure 17.3 shows realistic specifications for the transmission characteristics of a low-pass filter. Observe that since a physical circuit cannot provide constant transmission at all passband frequencies, the specifications allow for deviation of the passband transmission from the ideal 0 dB , but place an upper bound, $A_{\max }(\mathrm{dB})$, on this deviation. Depending on the application, $A_{\max }$ typically ranges from 0.05 dB to 3 dB . Also, since a physical circuit cannot provide zero transmission at all stopband frequencies, the specifications in Fig. 17.3 allow for some transmission over the stopband. However, the specifications require the stopband signals to be attenuated by at least $A_{\min }(\mathrm{dB})$ relative to the passband signals. Depending on the filter application, $A_{\min }$ can range from 20 dB to 100 dB .

Since the transmission of a physical circuit cannot change abruptly at the edge of the passband, the specifications of Fig. 17.3 provide for a band of frequencies over which the attenuation increases from near 0 dB to $A_{\min }$. This transition band extends from the passband edge $\omega_{p}$ to the stopband edge $\omega_{s}$. The ratio $\omega_{s} / \omega_{p}$ is usually used as a measure of the sharpness of the low-pass filter response and is called the selectivity factor. Finally, observe that for convenience the passband transmission is specified to be 0 dB . The final filter, however, can be given a passband gain, if desired, without changing its selectivity characteristics.


Figure 17.2 Ideal transmission characteristics of the four major filter types: (a) low-pass (LP), (b) high-pass (HP), (c) bandpass (BP), and (d) bandstop (BS).


Figure 17.3 Specification of the transmission characteristics of a low-pass filter. The magnitude response of a filter that just meets specifications is also shown.
## A BRIEF HISTORY OF ANALOG FILTERS:

Driven by the needs of the emerging telephone system in the early part of the twentieth century, the earliest analog filters utilized inductors (coils) and capacitors and were designed using ad hoc methods. It was not until the 1940s that a design theory for passive LC filters was developed. This filter synthesis method, however, required extensive computation and had to await the emergence of the digital computer and its widespread use in the 1950s and the 1960s to become adopted, further developed, and utilized.

The invention of the transistor and the IC resulted in new ways of assembling electronic circuits, which were, however, incompatible with the bulky and heavy inductors used in audio-frequency LC filters. The search for inductorless filters thus began and was greatly influenced by the emergence of the IC op amp in the late 1960s and its availability at low cost. Extensive research in the 1960s and 1970s resulted in a large repertoire of op amp-RC filters, the best of which are studied in this chapter.

No sooner had op amp-RC filters become a mature and reliable technology than the need arose for analog filters that could be fully integrated. Multiple approaches were proposed in the late 1970s, but the switched-capacitor circuit has become the technology of choice for low-frequency applications, mostly because of its compatibility with CMOS. For higher-frequency applications approaching the gigahertz range, needed for the burgeoning mobile communications market, two approaches have gained momentum: transconductance-C and active-LC. The latter uses actual physical inductors (in the nanohenry range) fabricated on the IC chip.

To summarize, the transmission of a low-pass filter is specified by four parameters:

1. The passband edge $\omega_{p}$
2. The maximum allowed variation in passband transmission $A_{\max }$
3. The stopband edge $\omega_{s}$
4. The minimum required stopband attenuation $A_{\min }$

The more tightly one specifies a filter-that is, lower $A_{\max }$, higher $A_{\min }$, and/or a selectivity ratio $\omega_{s} / \omega_{p}$ closer to unity-the closer the response of the resulting filter will be to the ideal. However, the resulting filter circuit will be of higher order and thus more complex and expensive.

In addition to the magnitude of transmission, the phase response of the filter is of interest in some applications. The filter-design problem, however, is considerably complicated when both magnitude and phase are to be specified.

Once the filter specifications have been decided upon, the next step in the design is to find a transfer function whose magnitude meets the specification. To meet specification, the magnitude-response curve must lie in the unshaded area in Fig. 17.3. The curve shown in the figure is for a filter that just meets specifications. Observe that for this particular filter, the magnitude response ripples throughout the passband, and the ripple peaks are all equal. Since the peak ripple is equal to $A_{\max }$ it is usual to refer to $A_{\max }$ as the passband ripple and to $\omega_{p}$ as the ripple bandwidth. The particular filter response shows ripples also in the stopband, again with the ripple peaks all equal and of such a value that the minimum stopband attenuation achieved is equal to the specified value, $A_{\min }$. Thus this particular response is said to be equiripple in both the passband and the stopband.

The process of obtaining a transfer function that meets given specifications is known as filter approximation. Filter approximation is usually performed using computer programs (Snelgrove, 1982; Ouslis and Sedra, 1995) or filter-design tables (Zverev, 1967). In simpler


Figure 17.4 Transmission specifications for a bandpass filter. The magnitude response of a filter that just meets specifications is also shown. Note that this particular filter has a monotonically decreasing transmission in the passband on both sides of the peak frequency.
cases, filter approximation can be performed using closed-form expressions, as will be seen in Section 17.3.

Finally, Fig. 17.4 shows transmission specifications for a bandpass filter and the response of a filter that meets these specifications. For this example we have chosen an approximation function that does not ripple in the passband; rather, the transmission decreases monotonically on both sides of the center frequency, attaining the maximum allowable deviation at the two edges of the passband.

# EXERCISES 

17.1 Find approximate values of attenuation (in dB ) corresponding to filter transmissions of $1,0.99,0.9$, $0.8,0.7,0.5,0.1,0$.
Ans. $0,0.1,1,2,3,6,20, \infty(\mathrm{~dB})$
17.2 If the magnitude of passband transmission is to remain constant to within $\pm 5 \%$, and if the stopband transmission is to be no greater than $1 \%$ of the passband transmission, find $A_{\text {max }}$ and $A_{\text {min }}$. Ans. $0.9 \mathrm{~dB} ; 40 \mathrm{~dB}$

### 17.2 The Filter Transfer Function

The filter transfer function $T(s)$ can be written as the ratio of two polynomials as

$$
T(s)=\frac{a_{M} s^{M}+a_{M-1} s^{M-1}+\cdots+a_{0}}{s^{N}+b_{N-1} s^{N-1}+\cdots+b_{0}}
$$
The degree of the denominator, $N$, is the filter order. For the filter circuit to be stable, the degree of the numerator must be less than or equal to that of the denominator: $M \leq N$. The numerator and denominator coefficients, $a_{0}, a_{1}, \ldots, a_{M}$ and $b_{0}, b_{1}, \ldots, b_{N-1}$, are real numbers. The polynomials in the numerator and denominator can be factored, and $T(s)$ can be expressed in the form

$$
T(s)=\frac{a_{M}\left(s-z_{1}\right)\left(s-z_{2}\right) \cdots\left(s-z_{M}\right)}{\left(s-p_{1}\right)\left(s-p_{2}\right) \cdots\left(s-p_{N}\right)}
$$

The numerator roots, $z_{1}, z_{2}, \ldots, z_{M}$, are the transfer function zeros, or transmission zeros; and the denominator roots, $p_{1}, p_{2}, \ldots, p_{N}$, are the transfer function poles, or the natural modes. ${ }^{1}$ Each transmission zero or pole can be either a real or a complex number. Complex zeros and poles, however, must occur in conjugate pairs. Thus, if $-1+j 2$ happens to be a zero, then $-1-j 2$ also must be a zero.

Since in the filter stopband the transmission is required to be zero or small, the filter transmission zeros are usually placed on the $j \omega$ axis at stopband frequencies. This indeed is the case for the filter whose transmission function is sketched in Fig. 17.3. This particular filter can be seen to have zero transmission (infinite attenuation) at two stopband frequencies: $\omega_{l 1}$ and $\omega_{l 2}$. The filter then must have transmission zeros at $s=+j \omega_{l 1}$ and $s=+j \omega_{l 2}$. However, since complex zeros occur in conjugate pairs, there must also be transmission zeros at $s=$ $-j \omega_{l 1}$ and $s=-j \omega_{l 2}$. Thus the numerator polynomial of this filter will have the factors $\left(s+j \omega_{l 1}\right)\left(s-j \omega_{l 1}\right)\left(s+j \omega_{l 2}\right)\left(s-j \omega_{l 2}\right)$, which can be written as $\left(s^{2}+\omega_{l 1}^{2}\right)\left(s^{2}+\omega_{l 2}^{2}\right)$. For $s=j \omega$ (physical frequencies) the numerator becomes $\left(-\omega^{2}+\omega_{l 1}^{2}\right)\left(-\omega^{2}+\omega_{l 2}^{2}\right)$, which indeed is zero at $\omega=\omega_{l 1}$ and $\omega=\omega_{l 2}$.

Continuing with the example in Fig. 17.3, we observe that the transmission decreases toward zero as $\omega$ approaches $\infty$. Thus the filter must have one or more transmission zeros at $s=\infty$. In general, the number of transmission zeros at $s=\infty$ is the difference between the degree of the numerator polynomial, $M$, and the degree of the denominator polynomial, $N$, of the transfer function in Eq. (17.6). This is because as $s$ approaches $\infty, T(s)$ approaches $a_{M} / s^{N-M}$ and thus is said to have $N-M$ zeros at $s=\infty$.

For a filter circuit to be stable, all its poles must lie in the left half of the $s$ plane, and thus $p_{1}$, $p_{2}, \ldots, p_{N}$ must all have negative real parts. Figure 17.5 shows typical pole and zero locations for the low-pass filter whose transmission function is depicted in Fig. 17.3. We have assumed that this filter is of fifth order $(N=5)$. It has two pairs of complex-conjugate poles and one real-axis pole, for a total of five poles. All the poles lie in the vicinity of the passband, which is what gives the filter its high transmission at passband frequencies. The five transmission zeros are at $s= \pm j \omega_{l 1}, s= \pm j \omega_{l 2}$, and $s=\infty$. Thus, the transfer function for this filter is of the form

$$
T(s)=\frac{a_{4}\left(s^{2}+\omega_{l 1}^{2}\right)\left(s^{2}+\omega_{l 2}^{2}\right)}{s^{5}+b_{4} s^{4}+b_{3} s^{3}+b_{2} s^{2}+b_{1} s+b_{0}}
$$

As another example, consider the bandpass filter whose magnitude response is shown in Fig. 17.4. This filter has transmission zeros at $s= \pm j \omega_{l 1}$ and $s= \pm j \omega_{l 2}$. It also has one or more zeros at $s=0$ and one or more zeros at $s=\infty$ (because the transmission decreases toward 0 as $\omega$ approaches 0 and $\infty$ ). Assuming that only one zero exists at each of $s=0$ and $s=\infty$,

[^0]
[^0]:    ${ }^{1}$ Throughout this chapter, we use the names poles and natural modes interchangeably.


Figure 17.5 Pole-zero pattern for the low-pass filter whose transmission is sketched in Fig. 17.3. This is a fifth-order filter $(N=5)$.


Figure 17.6 Pole-zero pattern for the bandpass filter whose transmission function is shown in Fig. 17.4. This is a sixth-order filter $(N=6)$.
the filter must be of sixth order, and its transfer function takes the form

$$
T(s)=\frac{a_{5} s\left(s^{2}+\omega_{t 1}^{2}\right)\left(s^{2}+\omega_{t 2}^{2}\right)}{s^{6}+b_{5} s^{5}+\ldots+b_{0}}
$$

A typical pole-zero plot for such a filter is shown in Fig. 17.6.
As a third and final example, consider the low-pass filter whose transmission function is depicted in Fig. 17.7(a). We observe that in this case there are no finite values of $\omega$ at which the transmission is zero. Thus it is possible that all the transmission zeros of this filter are at


Figure 17.7 (a) Transmission characteristics of a fifth-order low-pass filter having all transmission zeros at infinity. (b) Pole-zero pattern for the filter in (a).
$s=\infty$. If this is the case, the filter transfer function takes the form

$$
T(s)=\frac{a_{0}}{s^{N}+b_{N-1} s^{N-1}+\ldots+b_{0}}
$$

Such a filter is known as an all-pole filter. Typical pole-zero locations for a fifth-order all-pole low-pass filter are shown in Fig. 17.7(b).

Almost all the filters studied in this chapter have all their transmission zeros on the $j \omega$ axis, in the filter stopband(s), including ${ }^{2} \omega=0$ and $\omega=\infty$. Also, to obtain high selectivity, all the natural modes will be complex conjugate (except for the case of odd-order filters, where one natural mode must be on the real axis). Finally we note that the more selective the required filter response is, the higher its order must be, and the closer its natural modes are to the $j \omega$ axis.

# EXERCISES 

17.3 A second-order filter has its poles at $s=-(1 / 2) \pm j(\sqrt{3} / 2)$. The transmission is zero at $\omega=2 \mathrm{rad} / \mathrm{s}$ and is unity at dc $(\omega=0)$. Find the transfer function.
Ans. $T(s)=\frac{1}{4} \frac{s^{2}+4}{s^{2}+s+1}$

[^0]
[^0]:    ${ }^{2}$ Obviously, a low-pass filter should not have a transmission zero at $\omega=0$, and, similarly, a high-pass filter should not have a transmission zero at $\omega=\infty$.
17.4 A fourth-order filter has zero transmission at $\omega=0, \omega=2 \mathrm{rad} / \mathrm{s}$, and $\omega=\infty$. The natural modes are $-0.1 \pm j 0.8$ and $-0.1 \pm j 1.2$. Find $T(s)$.
Ans. $T(s)=\frac{a_{3} s\left(s^{2}+4\right)}{\left(s^{2}+0.2 s+0.65\right)\left(s^{2}+0.2 s+1.45\right)}$
17.5 Find the transfer function $T(s)$ of a third-order all-pole low-pass filter whose poles are at a radial distance of $1 \mathrm{rad} / \mathrm{s}$ from the origin and whose complex poles are at $30^{\circ}$ angles from the $j \omega$ axis. The dc gain is unity. Show that $|T(j \omega)|=1 / \sqrt{1+\omega^{k}}$. Find $\omega_{3 \mathrm{~dB}}$ and the attenuation at $\omega=3 \mathrm{rad} / \mathrm{s}$. Ans. $T(s)=1 /(s+1)\left(s^{2}+s+1\right) ; 1 \mathrm{rad} / \mathrm{s} ; 28.6 \mathrm{~dB}$

# 17.3 Butterworth and Chebyshev Filters 

In this section, we present two functions that are frequently used in approximating the transmission characteristics of low-pass filters; that is, in obtaining a transfer function $T(s)$ whose magnitude $|T(j \omega)|$ meets given low-pass filter specifications. Closed-form expressions are available for the parameters of these functions, and thus one can use them in filter design without the need for computers or filter-design tables. Their utility, however, is limited to relatively simple applications.

Although in this section we discuss the design of low-pass filters only, the approximation functions presented can be applied to the design of other filter types through the use of frequency transformations (see Sedra and Brackett, 1978).

### 17.3.1 The Butterworth Filter

Figure 17.8 shows a sketch of the magnitude response of a Butterworth ${ }^{3}$ filter. This filter exhibits a monotonically decreasing transmission with all the transmission zeros at $\omega=\infty$, making it an all-pole filter. The magnitude function for an Nth-order Butterworth filter with a passband edge $\omega_{p}$ is given by

$$
|T(j \omega)|=\frac{1}{\sqrt{1+\epsilon^{2}\left(\frac{\omega}{\omega_{p}}\right)^{2 N}}}
$$

At $\omega=\omega_{p}$,

$$
\left|T\left(j \omega_{p}\right)\right|=\frac{1}{\sqrt{1+\epsilon^{2}}}
$$

Thus, the parameter $\epsilon$ determines the maximum variation in passband transmission, $A_{\max }$, according to

$$
A_{\max }=20 \log \sqrt{1+\epsilon^{2}}
$$

[^0]
[^0]:    ${ }^{3}$ The Butterworth filter approximation is named after S. Butterworth, a British engineer who in 1930 was among the first to employ it.


Figure 17.8 The magnitude response of a Butterworth filter.


Figure 17.9 Magnitude response for Butterworth filters of various order with $\epsilon=1$. Note that as the order increases, the response approaches the ideal brick-wall type of transmission.

Conversely, given $A_{\max }$, the value of $\epsilon$ can be determined from

$$
\epsilon=\sqrt{10^{A_{\max } / 10}-1}
$$

Observe that in the Butterworth response the maximum deviation in passband transmission (from the ideal value of unity) occurs at the passband edge only. It can be shown that the

Figure 17.10 Graphical construction for determining the poles of a Butterworth filter of order $N$. All the poles lie in the left half of the $s$ plane on a circle of radius $\omega_{0}=\omega_{p}(1 / \epsilon)^{1 / 2}$, where $\epsilon$ is the passband deviation parameter $\left(\epsilon=\sqrt{10^{4 \max 10}-1}\right)$ : (a) the general case; (b) $N=2$; (c) $N=3$; (d) $N=4$.
first $2 N-1$ derivatives of $|T|$ relative to $\omega$ are zero at $\omega=0$ (see Van Valkenburg, 1980). This property makes the Butterworth response very flat near $\omega=0$ and results in the name maximally flat response. The degree of passband flatness increases as the order $N$ is increased, as can be seen from Fig. 17.9. This figure indicates also that, as should be expected, as the order $N$ is increased, the filter response approaches the ideal brick-wall type of response.
At the edge of the stopband, $\omega=\omega_{s}$, the attenuation of the Butterworth filter can be obtained by substituting $\omega=\omega_{s}$ in Eq. (17.11). The result is given by

$$
\begin{aligned}
A\left(\omega_{s}\right) & =-20 \log \left[1 / \sqrt{1+\epsilon^{2}\left(\omega_{s} / \omega_{p}\right)^{2 N}}\right] \\
& =10 \log \left[1+\epsilon^{2}\left(\omega_{s} / \omega_{p}\right)^{2 N}\right]
\end{aligned}
$$

This equation can be used to determine the filter order required, which is the lowest integer value of $N$ that yields $A\left(\omega_{s}\right) \geq A_{\min }$.

The natural modes of an $N$ th-order Butterworth filter can be determined from the graphical construction shown in Fig. 17.10(a). Observe that the natural modes lie on a circle of radius $\omega_{p}(1 / \epsilon)^{1 / N}$ and are spaced by equal angles of $\pi / N$, with the first mode at an angle $\pi / 2 N$ from the $+j \omega$ axis. Since the natural modes all have equal radial distance from the origin, they all have the same frequency $\omega_{0}=\omega_{p}(1 / \epsilon)^{1 / N}$. See Fig. 17.10(b), (c), and (d) for the natural modes of Butterworth filters of order $N=2,3$, and 4 , respectively. Once the $N$ natural modes $p_{1}$, $p_{2}, \ldots, p_{N}$ have been found, the transfer function can be written as

$$
T(s)=\frac{K \omega_{0}^{N}}{\left(s-p_{1}\right)\left(s-p_{2}\right) \cdots\left(s-p_{N}\right)}
$$

where $K$ is a constant equal to the required dc gain of the filter.
To summarize, to find a Butterworth transfer function that meets transmission specifications of the form in Fig. 17.3 we perform the following procedure:

1. Determine $\epsilon$ from Eq. (17.14).
2. Use Eq. (17.15) to determine the required filter order as the lowest integer value of $N$ that results in $A\left(\omega_{s}\right) \geq A_{\min }$.
3. Use Fig. 17.10(a) to determine the $N$ natural modes.
4. Use Eq. (17.16) to determine $T(s)$

# Example 17.1 

Find the Butterworth transfer function that meets the following low-pass filter specifications: $f_{p}=10 \mathrm{kHz}$, $A_{\max }=1 \mathrm{~dB}, f_{s}=15 \mathrm{kHz}, A_{\min }=25 \mathrm{~dB}$, dc gain $=1$.

## Solution

Substituting $A_{\max }=1 \mathrm{~dB}$ into Eq. (17.14) yields $\epsilon=0.5088$. Equation (17.15) is then used to determine the filter order by trying various values for $N$. We find that $N=8$ yields $A\left(\omega_{s}\right)=22.3 \mathrm{~dB}$ and $N=9$ gives 25.8 dB . We thus select $N=9$.

Figure 17.11 shows the graphical construction for determining the poles. The poles all have the same frequency $\omega_{0}=\omega_{p}(1 / \epsilon)^{1 / N}=2 \pi \times 10 \times 10^{3}(1 / 0.5088)^{1 / 9}=6.773 \times 10^{4} \mathrm{rad} / \mathrm{s}$. The first pole $p_{1}$ is given by

$$
p_{1}=\omega_{0}\left(-\cos 80^{\circ}+j \sin 80^{\circ}\right)=\omega_{0}(-0.1736+j 0.9848)
$$
# Example 17.1 continued 

Combining $p_{1}$ with its complex conjugate $p_{9}$ yields the factor $\left(s^{2}+s 0.3472 \omega_{0}+\omega_{0}^{2}\right)$ in the denominator of the transfer function. The same can be done for the other complex poles, and the complete transfer function is obtained using Eq. (17.16),

$$
\begin{aligned}
T(s)= & \frac{\omega_{0}^{9}}{\left(s+\omega_{0}\right)\left(s^{2}+s 1.8794 \omega_{0}+\omega_{0}^{2}\right)\left(s^{2}+s 1.5321 \omega_{0}+\omega_{0}^{2}\right)} \\
& \times \frac{1}{\left(s^{2}+s \omega_{0}+\omega_{0}^{2}\right)\left(s^{2}+s 0.3472 \omega_{0}+\omega_{0}^{2}\right)}
\end{aligned}
$$

### 17.3.2 The Chebyshev Filter

Figure 17.12 shows representative transmission functions for Chebyshev ${ }^{4}$ filters of even and odd orders. The Chebyshev filter exhibits an equiripple response in the passband and a monotonically decreasing transmission in the stopband. While the odd-order filter has $|T(0)|=1$, the even-order filter exhibits its maximum magnitude deviation at $\omega=0$. In both cases the total number of passband maxima and minima equals the order of the filter, $N$.


Figure 17.11 Poles of the ninth-order Butterworth filter of Example 17.1.

[^0]
[^0]:    ${ }^{4}$ Named after the Russian mathematician P. L. Chebyshev, who in 1899 used these functions in studying the construction of steam engines.


Figure 17.12 Sketches of the transmission characteristics of representative (a) even-order and (b) odd-order Chebyshev filters.

All the transmission zeros of the Chebyshev filter are at $\omega=\infty$, making it an all-pole filter.

The magnitude of the transfer function of an Nth-order Chebyshev filter with a passband edge (ripple bandwidth) $\omega_{p}$ is given by

$$
|T(j \omega)|=\frac{1}{\sqrt{1+\epsilon^{2} \cos ^{2}\left[N \cos ^{-1}\left(\omega / \omega_{p}\right)\right]}}
$$

for $\omega \leq \omega_{p}$
and

$$
|T(j \omega)|=\frac{1}{\sqrt{1+\epsilon^{2} \cosh ^{2}\left[N \cosh ^{-1}\left(\omega / \omega_{p}\right)\right]}}
$$

for $\omega \geq \omega_{p}$
At the passband edge, $\omega=\omega_{p}$, the magnitude function is given by

$$
\left|T\left(j \omega_{p}\right)\right|=\frac{1}{\sqrt{1+\epsilon^{2}}}
$$

Thus, the parameter $\epsilon$ determines the passband ripple according to

$$
A_{\max }=10 \log \left(1+\epsilon^{2}\right)
$$

Conversely, given $A_{\max }$, the value of $\epsilon$ is determined from

$$
\epsilon=\sqrt{10^{A_{\max } / 10}-1}
$$

The attenuation achieved by the Chebyshev filter at the stopband edge $\left(\omega=\omega_{s}\right)$ is found using Eq. (17.19) as

$$
A\left(\omega_{s}\right)=10 \log \left[1+\epsilon^{2} \cosh ^{2}\left(N \cosh ^{-1}\left(\omega_{s} / \omega_{p}\right)\right)\right]
$$
With the aid of a calculator, this equation can be used to determine the order $N$ required to obtain a specified $A_{\min }$ by finding the lowest integer value of $N$ that yields $A\left(\omega_{c}\right) \geq A_{\min }$. As in the case of the Butterworth filter, increasing the order $N$ of the Chebyshev filter causes its magnitude function to approach the ideal brick-wall low-pass response.

The poles of the Chebyshev filter are given by

$$
\begin{aligned}
p_{k}= & -\omega_{p} \sin \left(\frac{2 k-1}{N} \frac{\pi}{2}\right) \sinh \left(\frac{1}{N} \sinh ^{-1} \frac{1}{\epsilon}\right) \\
& +j \omega_{p} \cos \left(\frac{2 k-1}{N} \frac{\pi}{2}\right) \cosh \left(\frac{1}{N} \sinh ^{-1} \frac{1}{\epsilon}\right) \quad k=1,2, \ldots, N
\end{aligned}
$$

Finally, the transfer function of the Chebyshev filter can be written as

$$
T(s)=\frac{K \omega_{p}^{N}}{\epsilon 2^{N-1}\left(s-p_{1}\right)\left(s-p_{2}\right) \cdots\left(s-p_{N}\right)}
$$

where $K$ is the dc gain that the filter is required to have.
To summarize, given low-pass transmission specifications of the type shown in Fig. 17.3, the transfer function of a Chebyshev filter that meets these specifications can be found as follows:

1. Determine $\epsilon$ from Eq. (17.21).
2. Use Eq. (17.22) to determine the order required.
3. Determine the poles using Eq. (17.23).
4. Determine the transfer function using Eq. (17.24).

The Chebyshev filter provides a more efficient approximation than the Butterworth filter. Thus, for the same order and the same $A_{\max }$, the Chebyshev filter provides greater stopband attenuation than the Butterworth filter. Alternatively, to meet identical specifications, one requires a lower order for the Chebyshev than for the Butterworth filter. This point will be illustrated by the following example.

# Example 17.2 

Find the Chebyshev transfer function that meets the same low-pass filter specifications given in Example 17.1: namely, $f_{p}=10 \mathrm{kHz}, A_{\max }=1 \mathrm{~dB}, f_{s}=15 \mathrm{kHz}, A_{\min }=25 \mathrm{~dB}$, dc gain $=1$.

## Solution

Substituting $A_{\max }=1 \mathrm{~dB}$ into Eq. (17.21) yields $\epsilon=0.5088$. By trying various values for $N$ in Eq. (17.22) we find that $N=4$ yields $A\left(\omega_{c}\right)=21.6 \mathrm{~dB}$ and $N=5$ provides 29.9 dB . We thus select $N=5$. Recall that we required a ninth-order Butterworth filter to meet the same specifications in Example 17.1.

The poles are obtained by substituting in Eq. (17.23) as

$$
\begin{aligned}
p_{1}, p_{5} & =\omega_{p}(-0.0895 \pm j 0.9901) \\
p_{2}, p_{4} & =\omega_{p}(-0.2342 \pm j 0.6119) \\
p_{5} & =\omega_{p}(-0.2895)
\end{aligned}
$$
The transfer function is obtained by substituting these values in Eq. (17.24) as

$$
\begin{aligned}
T(s)= & \frac{\omega_{p}^{5}}{8.1408\left(s+0.2895 \omega_{p}\right)\left(s^{2}+s 0.4684 \omega_{p}+0.4293 \omega_{p}^{2}\right)} \\
& \times \frac{1}{s^{2}+s 0.1789 \omega_{p}+0.9883 \omega_{p}^{2}}
\end{aligned}
$$

where $\omega_{p}=2 \pi \times 10^{4} \mathrm{rad} / \mathrm{s}$.

# EXERCISES 

D17.6 Determine the order $N$ of a Butterworth filter for which $A_{\max }=1 \mathrm{~dB}, \omega_{r} / \omega_{p}=1.5$, and $A_{\min }=30 \mathrm{~dB}$. What is the actual value of minimum stopband attenuation realized? If $A_{\min }$ is to be exactly 30 dB , to what value can $A_{\max }$ be reduced?
Ans. $N=11 ; A_{\min }=32.87 \mathrm{~dB} ; 0.54 \mathrm{~dB}$
17.7 Find the natural modes and the transfer function of a Butterworth filter with $\omega_{p}=1 \mathrm{rad} / \mathrm{s}, A_{\max }=3 \mathrm{~dB}$ $(\epsilon \simeq 1)$, and $N=3$.
Ans. $-0.5 \pm j \sqrt{3} / 2$ and $-1 ; T(s)=1 /(s+1)\left(s^{2}+s+1\right)$
17.8 Observe that Eq. (17.18) can be used to find the frequencies in the passband at which $|T|$ is at its peaks and at its valleys. (The peaks are reached when the $\cos ^{2}[$ ] term is zero, and the valleys correspond to the $\cos ^{2}[$ ] term equal to unity.) Find these frequencies for a fifth-order filter.
Ans. Peaks at $\omega=0,0.59 \omega_{p}$, and $0.95 \omega_{p}$; the valleys at $\omega=0.31 \omega_{p}$ and $0.81 \omega_{p}$
D17.9 Find the attenuation provided at $\omega=2 \omega_{p}$ by a seventh-order Chebyshev filter with a $0.5-\mathrm{dB}$ passband ripple. If the passband ripple is allowed to increase to 1 dB , by how much does the stopband attenuation increase?
Ans. $64.9 \mathrm{~dB} ; 3.3 \mathrm{~dB}$
D17.10 It is required to design a low-pass filter having $f_{p}=1 \mathrm{kHz}, A_{\max }=1 \mathrm{~dB}, f_{s}=1.5 \mathrm{kHz}, A_{\min }=50 \mathrm{~dB}$.
(a) Find the required order of a Chebyshev filter. What is the excess stopband attenuation obtained?
(b) Repeat for a Butterworth filter.

Ans. (a) $N=8,5 \mathrm{~dB}$; (b) $N=16,0.5 \mathrm{~dB}$

### 17.4 First-Order and Second-Order Filter Functions

In this section, we shall study the simplest filter transfer functions, those of first and second order. These functions are useful in their own right in the design of simple filters. First- and second-order filters can also be cascaded to realize a high-order filter. Cascade design is in fact one of the most popular methods for the design of active filters (those utilizing op amps and
RC circuits). Because the filter poles occur in complex-conjugate pairs, a high-order transfer function $T(s)$ is factored into the product of second-order functions. If $T(s)$ is odd, there will also be a first-order function in the factorization. Each of the second-order functions [and the first-order function when $T(s)$ is odd] is then realized using one of the op amp-RC circuits that will be studied in this chapter, and the resulting blocks are placed in cascade. If the output of each block is taken at the output terminal of an op amp where the impedance level is low (ideally zero), cascading does not change the transfer functions of the individual blocks. Thus the overall transfer function of the cascade is simply the product of the transfer functions of the individual blocks, which is the original $T(s)$.

# 17.4.1 First-Order Filters 

The general first-order transfer function is given by

$$
T(s)=\frac{a_{1} s+a_{0}}{s+\omega_{0}}
$$

This bilinear transfer function characterizes a first-order filter with a pole at $s=-\omega_{0}$, a transmission zero at $s=-a_{0} / a_{1}$, and a high-frequency gain that approaches $a_{1}$. The numerator coefficients, $a_{0}$ and $a_{1}$, determine the type of filter (e.g., low pass, high pass, etc.). Some special cases together with passive (RC) and active (op amp-RC) realizations are shown in Fig. 17.13. ${ }^{5}$ Note that the active realizations provide considerably more versatility than their passive counterparts; in many cases the gain can be set to a desired value, and some transfer function parameters can be adjusted without affecting others. The output impedance of the active circuit is also very low, making cascading easily possible. The op amp, however, limits the high-frequency operation of the active circuits.

An important special case of the first-order filter function is the all-pass filter shown in Fig. 17.14. Here, the transmission zero and the pole are symmetrically located relative to the $j \omega$ axis. (They are said to display mirror-image symmetry with respect to the $j \omega$ axis.) Observe that although the transmission of the all-pass filter is (ideally) constant at all frequencies, its phase shows frequency selectivity. All-pass filters are used as phase shifters and in systems that require phase shaping (e.g., in the design of circuits called delay equalizers, which cause the overall time delay of a transmission system to be constant with frequency).

## EXERCISES

D17.11 Using $R_{1}=10 \mathrm{k} \Omega$, design the op amp-RC circuit of Fig. 17.13(b) to realize a high-pass filter with a corner frequency of $10^{4} \mathrm{rad} / \mathrm{s}$ and a high-frequency gain of 10 .
Ans. $R_{2}=100 \mathrm{k} \Omega ; C=0.01 \mu \mathrm{~F}$
D17.12 Design the op amp-RC circuit of Fig. 17.14 to realize an all-pass filter with a $90^{\circ}$ phase shift at $10^{3} \mathrm{rad} / \mathrm{s}$. Select suitable component values.
Ans. Possible choices: $R=R_{1}=R_{2}=10 \mathrm{k} \Omega ; C=0.1 \mu \mathrm{~F}$

[^0]
[^0]:    ${ }^{5}$ This figure contains a wealth of information about first-order filters; we recommend that the reader study it carefully.


Figure 17.13 First-order filters.


Figure 17.14 First-order all-pass filter.
# 17.4.2 Second-Order Filter Functions 

The general second-order (or biquadratic) filter transfer function is usually expressed in the standard form

$$
T(s)=\frac{a_{2} s^{2}+a_{1} s+a_{0}}{s^{2}+\left(\omega_{0} / Q\right) s+\omega_{0}^{2}}
$$

where $\omega_{0}$ and $Q$ determine the natural modes (poles) according to

$$
p_{1}, p_{2}=-\frac{\omega_{0}}{2 Q} \pm j \omega_{0} \sqrt{1-\left(1 / 4 Q^{2}\right)}
$$

We are usually interested in the case of complex-conjugate natural modes, obtained for $Q>0.5$. Figure 17.15 shows the location of the pair of complex-conjugate poles in the $s$ plane. Observe that the radial distance of the natural modes (from the origin) is equal to $\omega_{0}$, which is known as the pole frequency. The parameter $Q$ determines the distance of the poles from the $j \omega$ axis: the higher the value of $Q$, the closer the poles are to the $j \omega$ axis, and the more selective the filter response becomes. An infinite value for $Q$ locates the poles on the $j \omega$ axis and can yield sustained oscillations in the circuit realization. A negative value of $Q$ implies that the poles are in the right half of the $s$ plane, which certainly produces oscillations. The parameter $Q$ is called the pole quality factor, or simply pole $Q$.

The transmission zeros of the second-order filter are determined by the numerator coefficients, $a_{0}, a_{1}$, and $a_{2}$. It follows that the numerator coefficients determine the type of second-order filter function (i.e., LP, HP, etc.). Seven special cases of interest are illustrated in Fig. 17.16. For each case we give the transfer function, the $s$-plane locations of the transfer function singularities, and the magnitude response. Circuit realizations for the various second-order filter functions will be given in subsequent sections.

All seven special second-order filters have a pair of complex-conjugate natural modes characterized by a frequency $\omega_{0}$ and a quality factor $Q$.

In the low-pass (LP) case, shown in Fig. 17.16(a), the two transmission zeros are at $s=\infty$. The magnitude response can exhibit a peak with the details indicated. It can be shown that the peak occurs only for $Q>1 / \sqrt{2}$. The response obtained for $Q=1 / \sqrt{2}$ is the Butterworth, or maximally flat, response.

The high-pass (HP) function shown in Fig. 17.16(b) has both transmission zeros at $s=0$ (dc). The magnitude response shows a peak for $Q>1 / \sqrt{2}$, with the details of the response as indicated. Observe the duality between the LP and HP responses.

Next consider the bandpass (BP) filter function shown in Fig. 17.16(c). Here, one transmission zero is at $s=0(\mathrm{dc})$, and the other is at $s=\infty$. The magnitude response peaks at $\omega=\omega_{0}$. Thus the center frequency of the bandpass filter is equal to the pole frequency $\omega_{0}$. The


Figure 17.15 Definition of the parameters $\omega_{0}$ and $Q$ of a pair of complex-conjugate poles.selectivity of the second-order bandpass filter is usually measured by its 3-dB bandwidth. This is the difference between the two frequencies $\omega_{1}$ and $\omega_{2}$ at which the magnitude response is 3 dB below its maximum value (at $\omega_{0}$ ). It can be shown that

$$
\omega_{1}, \omega_{2}=\omega_{0} \sqrt{1+\left(1 / 4 Q^{2}\right)} \pm \frac{\omega_{0}}{2 Q}
$$

Thus,

$$
B W \equiv \omega_{2}-\omega_{1}=\omega_{0} / Q
$$

Observe that as $Q$ increases, the bandwidth decreases and the bandpass filter becomes more selective.

If the transmission zeros are located on the $j \omega$ axis, at the complex-conjugate locations $\pm j \omega_{n}$, then the magnitude response exhibits zero transmission at $\omega=\omega_{n}$. Thus a notch in the magnitude response occurs at $\omega=\omega_{n}$, and $\omega_{n}$ is known as the notch frequency. Three cases of the second-order notch filter are possible: the regular notch, obtained when $\omega_{n}=\omega_{0}$ [Fig. 17.16(d)]; the low-pass notch, obtained when $\omega_{n}>\omega_{0}$ [Fig. 17.16(e)]; and the high-pass notch, obtained when $\omega_{n}<\omega_{0}$ [Fig. 17.16(f)]. The reader is urged to verify the response details given in these figures (a rather tedious task, though!). Observe that in all notch cases, the transmission at dc and at $s=\infty$ is finite. This is so because there are no transmission zeros at either $s=0$ or $s=\infty$.

The last special case of interest is the all-pass (AP) filter whose characteristics are illustrated in Fig. 17.16(g). Here the two transmission zeros are in the right half of the $s$ plane, at the mirror-image locations of the poles. (This is the case for all-pass functions of any order.) The magnitude response of the all-pass function is constant over all frequencies; the flat gain, as it is called, is in our case equal to $\left|a_{2}\right|$. The frequency selectivity of the all-pass function is in its phase response.

# EXERCISES 

17.13 For a maximally flat second-order low-pass filter $(Q=1 / \sqrt{2})$, show that at $\omega=\omega_{0}$ the magnitude response is 3 dB below the value at dc.
17.14 Give the transfer function of a second-order bandpass filter with a center frequency of $10^{5} \mathrm{rad} / \mathrm{s}$, a center-frequency gain of 10 , and a 3-dB bandwidth of $10^{3} \mathrm{rad} / \mathrm{s}$.
Ans. $T(s)=\frac{10^{4} s}{s^{2}+10^{3} s+10^{10}}$
17.15 (a) For the second-order notch function with $\omega_{n}=\omega_{0}$, show that for the attenuation to be greater than $A \mathrm{~dB}$ over a frequency band $B W_{n}$, the value of $Q$ is given by

$$
Q \leq \frac{\omega_{0}}{B W_{n} \sqrt{10^{A / 10}-1}}
$$

(Hint: First, show that any two frequencies, $\omega_{1}$ and $\omega_{2}$, at which $|T|$ is the same are related by $\omega_{1} \omega_{2}=$ $\omega_{0}^{2}$.)
(b) Use the result of (a) to show that the 3-dB bandwidth is $\omega_{0} / Q$, as indicated in Fig. 17.16(d).
17.16 Consider a low-pass notch with $\omega_{0}=1 \mathrm{rad} / \mathrm{s}, Q=10, \omega_{n}=1.2 \mathrm{rad} / \mathrm{s}$, and a dc gain of unity. Find the frequency and magnitude of the transmission peak. Also find the high-frequency transmission. Ans. $0.986 \mathrm{rad} / \mathrm{s} ; 3.17 ; 0.69$


Figure 17.16 Second-order filtering functions.
| (d) Notch |  |
| :--: | :--: |
| $T(s)=a_{2} \frac{s^{2}+\omega_{0}^{2}}{s^{2}+s \frac{\omega_{0}}{Q}+\omega_{0}^{2}}$ <br> DC gain $=$ <br> High-frequency gain $=a_{2}$ |  |
| (e) Low-pass notch (LPN) |  |
| $T(s)=a_{2} \frac{s^{2}+\omega_{2}^{2}}{s^{2}+s \frac{\omega_{0}}{Q}+\omega_{0}^{2}}$ <br> $\omega_{0} \geq \omega_{0}$ <br> DC gain $=a_{2} \frac{\omega_{0}^{2}}{\omega_{0}^{2}}$ <br> High-frequency gain $=a_{2}$ |  |
| (f) High-pass notch (HPN) |  |
| $T(s)=a_{2} \frac{s^{2}+\omega_{0}^{2}}{s^{2}+s \frac{\omega_{0}}{Q}+\omega_{0}^{2}}$ <br> $\omega_{0} \leq \omega_{0}$ <br> DC gain $=a_{2} \frac{\omega_{0}^{2}}{\omega_{0}^{2}}$ <br> High-frequency gain $=a_{2}$ |  |

Figure 17.16 continued
(g) All pass (AP)

$T(x)=a_{2} \frac{x^{2}-x \frac{m_{0}}{Q}+m_{0}^{2}}{x^{2}+x \frac{m_{0}}{Q}+m_{0}^{2}}$
Flat gain $=a_{2}$


Figure 17.16 continued
# 17.5 The Second-Order LCR Resonator 

In this section we shall study the second-order LCR resonator shown in Fig. 17.17(a). The use of this resonator to derive circuit realizations for the various second-order filter functions will be demonstrated. It will be shown in the next section that replacing the inductor $L$ by a simulated inductance obtained using an op amp-RC circuit results in an op amp-RC resonator. The latter forms the basis of an important class of active-RC filters to be studied in Section 17.6.

### 17.5.1 The Resonator Natural Modes

The natural modes or poles of the parallel resonance circuit of Fig. 17.17(a) can be determined by applying an excitation that does not change the natural structure of the circuit. Two possible ways of exciting the circuit are shown in Fig. 17.17(b) and (c). In Fig. 17.17(b) the resonator is excited with a current source $I$ connected in parallel. Since, as far as the natural response of a circuit is concerned, an independent ideal current source is equivalent to an open circuit, the excitation of Fig. 17.17(b) does not alter the natural structure of the resonator. Thus the circuit in Fig. 17.17(b) can be used to determine the natural modes of the resonator by simply finding the poles of any response function. We can for instance take the voltage $V_{o}$ across the resonator as the response and thus obtain the response function $V_{o} / I=Z$, where $Z$ is the impedance of the parallel resonance circuit. However, because of the parallel structure of the circuit it is more convenient to work in terms of the admittance $Y$; thus,

$$
\begin{aligned}
\frac{V_{o}}{I} & =\frac{1}{Y}=\frac{1}{(1 / s L)+s C+(1 / R)} \\
& =\frac{s / C}{s^{2}+s(1 / C R)+(1 / L C)}
\end{aligned}
$$

Equating the denominator to the standard form $\left[s^{2}+s\left(\omega_{0} / Q\right)+\omega_{0}^{2}\right]$ leads to

$$
\omega_{0}^{2}=1 / L C
$$

and

$$
\omega_{0} / Q=1 / C R
$$



Figure 17.17 (a) The second-order parallel LCR resonator. (b, c) Two ways of exciting the resonator of (a) without changing its natural structure; resonator poles are those poles of $V_{o} / I$ and $V_{o} / V_{i}$.
Thus,

$$
\begin{aligned}
& \omega_{0}=1 / \sqrt{L C} \\
& Q=\omega_{0} C R
\end{aligned}
$$

These expressions should be familiar to the reader from studies of parallel resonance circuits in introductory courses on circuit theory.

An alternative way of exciting the parallel LCR resonator for the purpose of determining its natural modes is shown in Fig. 17.17(c). Here, node $x$ of inductor $L$ has been disconnected from ground and connected to an ideal voltage source $V_{i}$. Now, since as far as the natural response of a circuit is concerned, an ideal independent voltage source is equivalent to a short circuit, the excitation of Fig. 17.17(c) does not alter the natural structure of the resonator. Thus we can use the circuit in Fig. 17.17(c) to determine the natural modes of the resonator. These are the poles of any response function. For instance, we can select $V_{o}$ as the response variable and find the transfer function $V_{o} / V_{i}$. The reader can easily verify that this will lead to the natural modes determined earlier.

In a design problem, we will be given $\omega_{0}$ and $Q$ and will be asked to determine $L, C$, and $R$. Equations (17.34) and (17.35) are two equations in the three unknowns. The one available degree of freedom can be utilized to set the impedance level of the circuit to a value that results in practical component values.

# 17.5.2 Realization of Transmission Zeros 

Having selected the component values of the LCR resonator to realize a given pair of complex-conjugate natural modes, we now consider the use of the resonator to realize a desired filter type (e.g., LP, HP, etc.). Specifically, we wish to find out where to inject the input voltage signal $V_{i}$ so that the transfer function $V_{o} / V_{i}$ is the desired one. Toward that end, note that in the resonator circuit in Fig. 17.17(a), any of the nodes labeled $x, y$, or $z$ can be disconnected from ground and connected to $V_{i}$ without altering the circuit's natural modes. When this is done, the circuit takes the form of a voltage divider, as shown in Fig. 17.18(a). Thus the transfer function realized is

$$
T(s)=\frac{V_{o}(s)}{V_{i}(s)}=\frac{Z_{2}(s)}{Z_{1}(s)+Z_{2}(s)}
$$

We observe that the transmission zeros are the values of $s$ at which $Z_{2}(s)$ is zero, provided $Z_{1}(s)$ is not simultaneously zero, and the values of $s$ at which $Z_{1}(s)$ is infinite, provided $Z_{2}(s)$ is not simultaneously infinite. This statement makes physical sense: The output will be zero either when $Z_{2}(s)$ behaves as a short circuit or when $Z_{1}(s)$ behaves as an open circuit. If there is a value of $s$ at which both $Z_{1}$ and $Z_{2}$ are zero, then $V_{o} / V_{i}$ will be finite and no transmission zero is obtained. Similarly, if there is a value of $s$ at which both $Z_{1}$ and $Z_{2}$ are infinite, then $V_{o} / V_{i}$ will be finite and no transmission zero is realized.

### 17.5.3 Realization of the Low-Pass Function

Using the scheme just outlined, we see that to realize a low-pass function, node $x$ is disconnected from ground and connected to $V_{i}$, as shown in Fig. 17.18(b). The transmission zeros of this circuit will be at the value of $s$ for which the series impedance becomes


Figure 17.18 Realization of various second-order filter functions using the LCR resonator of Fig. 17.17(b): (a) general structure, (b) LP, (c) $\mathrm{HP}_{\mathrm{r}}$ (d) BP, (e) notch at $\omega_{0}$, (f) general notch, (g) LPN $\left(\omega_{n} \geq \omega_{0}\right)$, (h) LPN as $s \rightarrow \infty$, (i) $\operatorname{HPN}\left(\omega_{n}<\omega_{0}\right)$.
infinite ( $s L$ becomes infinite at $s=\infty$ ) and the value of $s$ at which the shunt impedance becomes zero $(1 /[s C+(1 / R)]$ becomes zero at $s=\infty)$. Thus this circuit has two transmission zeros at $s=\infty$, as a second-order LP is supposed to. The transfer function can be written either by inspection or by using the voltage divider rule. Following the latter approach, we obtain

$$
\begin{aligned}
T(s) \equiv \frac{V_{o}}{V_{i}} & =\frac{Z_{2}}{Z_{1}+Z_{2}}=\frac{Y_{1}}{Y_{1}+Y_{2}}=\frac{1 / s L}{(1 / s L)+s C+(1 / R)} \\
& =\frac{1 / L C}{s^{2}+s(1 / C R)+(1 / L C)}
\end{aligned}
$$

# 17.5.4 Realization of the High-Pass Function 

To realize the second-order high-pass function, node $y$ is disconnected from ground and connected to $V_{i}$, as shown in Fig. 17.18(c). Here the series capacitor introduces a transmission zero at $s=0$ (dc), and the shunt inductor introduces another transmission zero at $s=0$ (dc). Thus, by inspection, the transfer function may be written as

$$
T(s) \equiv \frac{V_{o}}{V_{i}}=\frac{a_{2} s^{2}}{s^{2}+s\left(\omega_{0} / Q\right)+\omega_{0}^{2}}
$$

where $\omega_{0}$ and $Q$ are the natural mode parameters given by Eqs. (17.34) and (17.35) and $a_{2}$ is the high-frequency transmission. The value of $a_{2}$ can be determined from the circuit by observing that as $s$ approaches $\infty$, the capacitor approaches a short circuit and $V_{o}$ approaches $V_{i}$, resulting in $a_{2}=1$.

### 17.5.5 Realization of the Bandpass Function

The bandpass function is realized by disconnecting node $z$ from ground and connecting it to $V_{i}$, as shown in Fig. 17.18(d). Here the series impedance is resistive and thus does not introduce any transmission zeros. These are obtained as follows: One zero at $s=0$ is realized by the shunt inductor, and one zero at $s=\infty$ is realized by the shunt capacitor. At the center frequency $\omega_{0}$, the parallel LC-tuned circuit exhibits an infinite impedance, and thus no current flows in the circuit. It follows that at $\omega=\omega_{0}, V_{o}=V_{i}$. In other words, the center-frequency gain of the bandpass filter is unity. Its transfer function can be obtained as follows:

$$
\begin{aligned}
T(s) & =\frac{Y_{R}}{Y_{R}+Y_{L}+Y_{C}}=\frac{1 / R}{(1 / R)+(1 / s L)+s C} \\
& =\frac{s(1 / C R)}{s^{2}+s(1 / C R)+(1 / L C)}
\end{aligned}
$$

### 17.5.6 Realization of the Notch Functions

To obtain a pair of transmission zeros on the $j \omega$ axis, we use a parallel resonance circuit in the series arm, as shown in Fig. 17.18(e). Observe that this circuit is obtained by disconnecting both nodes $x$ and $y$ from ground and connecting them together to $V_{i}$. The impedance of the LC circuit becomes infinite at $\omega=\omega_{0}=1 / \sqrt{L C}$, thus causing zero transmission at this frequency. The shunt impedance is resistive and thus does not introduce transmission zeros. It follows
that the circuit in Fig. 17.18(e) will realize the notch transfer function

$$
T(s)=a_{2} \frac{s^{2}+\omega_{0}^{2}}{s^{2}+s\left(\omega_{0} / Q\right)+\omega_{0}^{2}}
$$

The value of the high-frequency gain $a_{2}$ can be found from the circuit to be unity.
To obtain a notch-filter realization in which the notch frequency $\omega_{n}$ is arbitrarily placed relative to $\omega_{0}$, we adopt a variation on the scheme above. We still use a parallel LC circuit in the series branch, as shown in Fig. 17.18(f), where $L_{1}$ and $C_{1}$ are selected so that

$$
L_{1} C_{1}=1 / \omega_{n}^{2}
$$

Thus the $L_{1} C_{1}$ tank circuit will introduce a pair of transmission zeros at $\pm j \omega_{n}$, provided the $L_{2} C_{2}$ tank is not resonant at $\omega_{n}$. Apart from this restriction, the values of $L_{2}$ and $C_{2}$ must be selected to ensure that the natural modes have not been altered; thus,

$$
\begin{gathered}
C_{1}+C_{2}=C \\
L_{1} \| L_{2}=L
\end{gathered}
$$

In other words, when $V_{i}$ is replaced by a short circuit, the circuit should reduce to the original LCR resonator. Another way of thinking about the circuit of Fig. 17.18(f) is that it is obtained from the original LCR resonator by lifting part of $L$ and part of $C$ off ground and connecting them to $V_{i}$.

It should be noted that in the circuit of Fig. 17.18(f), $L_{2}$ does not introduce a zero at $s=0$ because at $s=0$, the $L_{1} C_{1}$ circuit also has a zero. In fact, at $s=0$ the circuit reduces to an inductive voltage divider with the dc transmission being $L_{2} /\left(L_{1}+L_{2}\right)$. Similar comments can be made about $C_{2}$ and the fact that it does not introduce a zero at $s=\infty$ and that the transmission at $s=\infty$ is $C_{1} /\left(C_{1}+C_{2}\right)$.

The LPN and HPN filter realizations are special cases of the general notch circuit of Fig. 17.18(f). Specifically, for the LPN,

$$
\omega_{n}>\omega_{0}
$$

and thus

$$
L_{1} C_{1}<\left(L_{1} \| L_{2}\right)\left(C_{1}+C_{2}\right)
$$

This condition can be satisfied with $L_{2}$ eliminated (i.e., $L_{2}=\infty$ and $L_{1}=L$ ), resulting in the LPN circuit in Fig. 17.18(g). The transfer function can be written by inspection as

$$
T(s) \equiv \frac{V_{o}}{V_{i}}=a_{2} \frac{s^{2}+\omega_{n}^{2}}{s^{2}+s\left(\omega_{0} / Q\right)+\omega_{0}^{2}}
$$

where $\omega_{n}^{2}=1 / L C_{1}, \omega_{0}^{2}=1 / L\left(C_{1}+C_{2}\right), \omega_{0} / Q=1 / C R$, and $a_{2}$ is the high-frequency gain. From the circuit we see that as $s \rightarrow \infty$, the circuit reduces to that in Fig. 17.18(h), for which

$$
\frac{V_{o}}{V_{i}}=\frac{C_{1}}{C_{1}+C_{2}}
$$
Thus,

$$
a_{2}=\frac{C_{1}}{C_{1}+C_{2}}
$$

To obtain an HPN realization we start with the circuit of Fig. 17.18(f) and use the fact that $\omega_{n}<\omega_{0}$ to obtain

$$
L_{1} C_{1}>\left(L_{1} \| L_{2}\right)\left(C_{1}+C_{2}\right)
$$

which can be satisfied while selecting $C_{2}=0$ (i.e., $C_{1}=C$ ). Thus we obtain the reduced circuit shown in Fig. 17.18(i). Observe that as $s \rightarrow \infty, V_{o}$ approaches $V_{i}$ and thus the high-frequency gain is unity. Thus, the transfer function can be expressed as

$$
T(s) \equiv \frac{V_{o}}{V_{i}}=\frac{s^{2}+\left(1 / L_{1} C\right)}{s^{2}+s(1 / C R)+\left[1 /\left(L_{1} \| L_{2}\right) C\right]}
$$

# 17.5.7 Realization of the All-Pass Function 

The all-pass transfer function

$$
T(s)=\frac{s^{2}-s\left(\omega_{0} / Q\right)+\omega_{0}^{2}}{s^{2}+s\left(\omega_{0} / Q\right)+\omega_{0}^{2}}
$$

can be written as

$$
T(s)=1-\frac{s 2\left(\omega_{0} / Q\right)}{s^{2}+s\left(\omega_{0} / Q\right)+\omega_{0}^{2}}
$$

The second term on the right-hand side is a bandpass function with a center-frequency gain of 2. We already have a bandpass circuit (Fig. 17.18d), but with a center-frequency gain of unity. We shall therefore attempt an all-pass realization with a flat gain of 0.5 , that is,

$$
T(s)=0.5-\frac{s\left(\omega_{0} / Q\right)}{s^{2}+s\left(\omega_{0} / Q\right)+\omega_{0}^{2}}
$$

This function can be realized using a voltage divider with a transmission ratio of 0.5 together with the bandpass circuit of Fig. 17.18(d). To effect the subtraction, the output of the all-pass circuit is taken between the output terminal of the voltage divider and that of the bandpass filter, as shown in Fig. 17.19. Unfortunately this circuit has the disadvantage of lacking a common ground terminal between the input and the output. An op amp-RC realization of the all-pass function will be presented in the next section.


Figure 17.19 Realization of the second-order all-pass transfer function using a voltage divider and an LCR resonator.# EXERCISES 

17.17 Use the circuit of Fig. 17.18(b) to realize a second-order low-pass function of the maximally flat type with a $3-\mathrm{dB}$ frequency of 100 kHz .
Ans. Selecting $R=1 \mathrm{k} \Omega$, we obtain $C=1125 \mathrm{pF}$ and $L=2.25 \mathrm{mH}$.
17.18 Use the circuit of Fig. 17.18(e) to design a notch filter to eliminate a bothersome power-supply hum at a $60-\mathrm{Hz}$ frequency. The filter is to have a $3-\mathrm{dB}$ bandwidth of 10 Hz (i.e., the attenuation is greater than 3 dB over a $10-\mathrm{Hz}$ band around the $60-\mathrm{Hz}$ center frequency; see Exercise 17.15 and Fig. 17.16d). Use $R=10 \mathrm{k} \Omega$.
Ans. $C=1.6 \mu \mathrm{~F}$ and $L=4.42 \mathrm{H}$ (Note the large inductor required. This is why passive filters are not practical in low-frequency applications.)

### 17.6 Second-Order Active Filters Based on Inductor Replacement

In this section, we study a family of op amp-RC circuits that realize the various second-order filter functions. The circuits are based on an op amp-RC resonator obtained by replacing the inductor $L$ in the LCR resonator with an op amp-RC circuit that has an inductive input impedance.

### 17.6.1 The Antoniou Inductance-Simulation Circuit

Over the years, many op amp-RC circuits have been proposed for simulating the operation of an inductor. Of these, one circuit invented by A. Antoniou ${ }^{6}$ (see Antoniou, 1969) has proved to be the "best." By "best" we mean that the operation of the circuit is very tolerant of the nonideal properties of the op amps, in particular their finite gain and bandwidth. Figure 17.20(a) shows the Antoniou inductance-simulation circuit. If the circuit is fed at its input (node 1) with a voltage source $V_{1}$ and the input current is denoted $I_{1}$, then for ideal op amps the input impedance can be shown to be

$$
Z_{\mathrm{in}} \equiv V_{1} / I_{1}=s C_{4} R_{1} R_{3} R_{5} / R_{2}
$$

which is that of an inductance $L$ given by

$$
L=C_{4} R_{1} R_{3} R_{5} / R_{2}
$$

Figure 17.20(b) shows the analysis of the circuit assuming that the op amps are ideal and thus that a virtual short circuit appears between the two input terminals of each op amp, and assuming also that the input currents of the op amps are zero. The analysis begins at node 1 , which is assumed to be fed by a voltage source $V_{1}$, and proceeds step by step, with the order of the steps indicated by the circled numbers. The result of the analysis is the expression shown for the input current $I_{1}$ from which $Z_{\text {in }}$ is found.

[^0]
[^0]:    ${ }^{6}$ Andreas Antoniou is a Canadian academic, currently (2014) a professor emeritus of electrical and computer engineering at the University of Victoria, Victoria, British Columbia.


Figure 17.20 (a) The Antoniou inductance-simulation circuit. (b) Analysis of the circuit assuming ideal op amps. The order of the analysis steps is indicated by the circled numbers.

The design of this circuit is usually based on selecting $R_{1}=R_{2}=R_{3}=R_{5}=R$ and $C_{4}=C$, which leads to $L=C R^{2}$. Convenient values are then selected for $C$ and $R$ to yield the desired inductance value $L$. More details on this circuit and the effect of the nonidealities of the op amps on its performance can be found in Sedra and Brackett (1978).

# 17.6.2 The Op Amp-RC Resonator 

Figure 17.21(a) shows the LCR resonator we studied in detail in Section 17.5. Replacing the inductor $L$ with a simulated inductance realized by the Antoniou circuit of Fig. 17.20(a) results in the op amp-RC resonator of Fig. 17.21(b). (Ignore for the moment the additional amplifier


Figure 17.21 (a) An LCR resonator. (b) An op amp-RC resonator obtained by replacing the inductor $L$ in the LCR resonator of (a) with a simulated inductance realized by the Antoniou circuit of Fig. 17.20(a). (c) Implementation of the buffer amplifier $K$.
drawn with broken lines.) The circuit of Fig. 17.21(b) is a second-order resonator having a pole frequency

$$
\omega_{0}=1 / \sqrt{L C_{6}}=1 / \sqrt{C_{4} C_{6} R_{1} R_{3} R_{5} / R_{2}}
$$

where we have used the expression for $L$ given in Eq. (17.50). The pole $Q$ factor can be obtained using the expression in Eq. (17.35) with $C=C_{6}$ and $R=R_{6}$; thus, $Q=\omega_{0} C_{6} R_{6}$.
Replacing $\omega_{0}$ by the expression in Eq. (17.51) gives

$$
Q=\omega_{0} C_{6} R_{6}=R_{6} \sqrt{\frac{C_{6}}{C_{4}} \frac{R_{2}}{R_{1} R_{3} R_{5}}}
$$

Usually one selects $C_{4}=C_{6}=C$ and $R_{1}=R_{2}=R_{3}=R_{5}=R$, which results in

$$
\begin{aligned}
\omega_{0} & =1 / C R \\
Q & =R_{6} / R
\end{aligned}
$$

Thus, if we select a practically convenient value for $C$, we can use Eq. (17.53) to determine the value of $R$ to realize a given $\omega_{0}$, and then use Eq. (17.54) to determine the value of $R_{6}$ to realize a given $Q$.

# 17.6.3 Realization of the Various Filter Types 

The op amp-RC resonator of Fig. 17.21(b) can be used to generate circuit realizations for the various second-order filter functions by following the approach described in detail in Section 17.5 in connection with the LCR resonator. Thus to obtain a bandpass function, we disconnect node $z$ from ground and connect it to the signal source $V_{i}$. A high-pass function is obtained by injecting $V_{i}$ to node $y$. To realize a low-pass function using the LCR resonator, the inductor terminal $x$ is disconnected from ground and connected to $V_{i}$. The corresponding node in the active resonator is the node at which $R_{5}$ is connected to ground, ${ }^{7}$ labeled as node $x$ in Fig. 17.21(b). A regular notch function $\left(\omega_{n}=\omega_{0}\right)$ is obtained by feeding $V_{i}$ to nodes $x$ and $y$. In all cases the output can be taken as the voltage across the resonance circuit, $V_{r}$. However, this is not a convenient node to use as the filter output terminal because connecting a load there would change the filter characteristics. The problem can be solved easily by utilizing a buffer amplifier. This is the amplifier of gain $K$, drawn with broken lines in Fig. 17.21(b). Figure 17.21(c) shows how this amplifier can be simply implemented using an op amp connected in the noninverting configuration. Note that not only does the amplifier $K$ buffer the output of the filter, but it also allows the designer to set the filter gain to any desired value by appropriately selecting the value of $K$.

Figure 17.22 shows the various second-order filter circuits obtained from the resonator of Fig. 17.21(b). The transfer functions and design equations for these circuits are given in Table 17.1. Note that the transfer functions can be written by analogy to those of the LCR resonator. We have already commented on the LP, HP, BP, and regular-notch circuits given in Fig. 17.22(a) to (d). The LPN and HPN circuits in Fig. 17.22(e) and (f) are obtained by direct analogy to their LCR counterparts in Fig. 17.18(g) and (i), respectively. The all-pass circuit in Fig. 17.22(g), however, deserves some explanation.

### 17.6.4 The All-Pass Circuit

From Eq. (17.48) we see that an all-pass function with a flat gain of unity can be written as

$$
\mathrm{AP}=1-(\mathrm{BP} \text { with a center-frequency gain of } 2)
$$

Two circuits whose transfer functions are related in this fashion (i.e., the transfer function of one is equal to unity minus the transfer function of the other) are said to be

[^0]
[^0]:    ${ }^{7}$ This point might not be obvious! The reader, however, can show by direct analysis that when $V_{i}$ is fed to this node, the function $V_{i} / V_{i}$ is indeed low pass.


Figure 17.22 Realizations for the various second-order filter functions using the op amp-RC resonator of Fig. 17.21(b): (a) LP, (b) HP, (c) BP. The circuits are based on the LCR circuit in Fig. 17.18. Design considerations are given in Table 17.1.


Figure 17.22 continued (d) Notch at $\omega_{0}$; (e) LPN, $\omega_{n} \geq \omega_{0}$; (f) HPN, $\omega_{n} \leq \omega_{0}$.

(g) All-pass

Figure 17.22 continued (g) All pass.

Table 17.1 Design Data for the Circuits of Fig. 17.22

| Circuit | Transfer Function and Other Parameters | Design Equations |
| :--: | :--: | :--: |
| Resonator <br> Fig. 17.21(b) | $\begin{aligned} & \omega_{0}=1 / \sqrt{C_{4} C_{6} R_{1} R_{3} R_{5} / R_{2}} \\ & Q=R_{6} \sqrt{\frac{C_{6}}{C_{4}} \frac{R_{3}}{R_{1} R_{3} R_{5}}} \end{aligned}$ | $\begin{aligned} & C_{4}=C_{6}=C \text { (practical value) } \\ & R_{1}=R_{2}=R_{3}=R_{5}=1 / \omega_{0} C \\ & R_{6}=Q / \omega_{0} C \end{aligned}$ |
| Low-pass (LP) <br> Fig. 17.22(a) | $T(s)=\frac{K R_{3} / C_{4} C_{6} R_{1} R_{3} R_{5}}{s^{2}+s \frac{1}{C_{6} R_{6}}+\frac{R_{2}}{C_{4} C_{6} R_{1} R_{3} R_{5}}} \quad K=\mathrm{DC} \text { gain }$ |  |
| High-pass (HP) <br> Fig. 17.22(b) | $T(s)=\frac{K s^{2}}{s^{2}+s \frac{1}{C_{6} R_{6}}+\frac{R_{2}}{C_{4} C_{6} R_{1} R_{3} R_{5}}} \quad K=$ High-frequency gain |  |
| Bandpass (BP) <br> Fig. 17.22(c) | $T(s)=\frac{K s / C_{6} R_{6}}{s^{2}+s \frac{1}{C_{6} R_{6}}+\frac{R_{2}}{C_{4} C_{6} R_{1} R_{3} R_{5}}} \quad K=$ Center-frequency gain |  |
| Regular notch ( N ) <br> Fig. 17.22(d) | $T(s)=\frac{K\left[s^{2}+\left(R_{2} / C_{4} C_{6} R_{1} R_{3} R_{5}\right)\right]}{s^{2}+s \frac{1}{C_{6} R_{6}}+\frac{R_{2}}{C_{4} C_{6} R_{1} R_{3} R_{5}}} \quad K=$ Low- and high-frequency gain |  |

complementary. ${ }^{8}$ Thus the all-pass circuit with unity flat gain is the complement of the bandpass circuit with a center-frequency gain of 2 . A simple procedure exists for obtaining the complement of a given linear circuit: Disconnect all the circuit nodes that are connected to ground and connect them to $V_{i}$, and disconnect all the nodes that are connected to $V_{i}$ and connect them to ground. That is, interchanging input and ground in a linear circuit generates a circuit whose transfer function is the complement of that of the original circuit.

Returning to the problem at hand, we first use the circuit of Fig. 17.22(c) to realize a BP with a gain of 2 by simply selecting $K=2$ and implementing the buffer amplifier with the circuit of Fig. 17.21(c) with $r_{1}=r_{2}$. We then interchange input and ground and thus obtain the all-pass circuit of Fig. 17.22(g).

Finally, in addition to being simple to design, the circuits in Fig. 17.22 exhibit excellent performance. They can be used on their own to realize second-order filter functions, or they can be cascaded to implement high-order filters.

[^0]
[^0]:    ${ }^{8}$ More about complementary circuits will be presented later in conjunction with Fig. 17.31.
# EXERCISES 

D17.19 Use the circuit of Fig. 17.22(c) to design a second-order bandpass filter with a center frequency of 10 kHz , a 3-dB bandwidth of 500 Hz , and a center-frequency gain of 10 . Use $C=1.2 \mathrm{nF}$. Ans. $\quad R_{1}=R_{2}=R_{3}=R_{5}=13.26 \mathrm{k} \Omega ; R_{6}=265 \mathrm{k} \Omega ; C_{4}=C_{6}=1.2 \mathrm{nF} ; K=10, r_{1}=10 \mathrm{k} \Omega$, $r_{2}=90 \mathrm{k} \Omega$
D17.20 Realize the Chebyshev filter of Example 17.2, whose transfer function is given in Eq. (17.25), as the cascade connection of three circuits: two of the type shown in Fig. 17.22(a) and one first-order op amp-RC circuit of the type shown in Fig. 17.13(a). Note that you can make the dc gain of all sections equal to unity. Do so. Use as many $10-\mathrm{k} \Omega$ resistors as possible.
Ans. First-order section: $R_{1}=R_{2}=10 \mathrm{k} \Omega, C=5.5 \mathrm{nF}$; second-order section with $\omega_{0}=4.117 \times$ $10^{4} \mathrm{rad} / \mathrm{s}$ and $Q=1.4: R_{1}=R_{2}=R_{3}=R_{5}=10 \mathrm{k} \Omega, R_{6}=14 \mathrm{k} \Omega, C_{4}=C_{6}=2.43 \mathrm{nF}, r_{1}=\infty, r_{2}=0$; second-order section with $\omega_{0}=6.246 \times 10^{4} \mathrm{rad} / \mathrm{s}$ and $Q=5.56: R_{1}=R_{2}=R_{3}=R_{5}=10 \mathrm{k} \Omega$, $R_{6}=55.6 \mathrm{k} \Omega, C_{4}=C_{6}=1.6 \mathrm{nF}, r_{1}=\infty, r_{2}=0$

### 17.7 Second-Order Active Filters Based on the Two-Integrator-Loop Topology

In this section, we study another family of op amp-RC circuits that realize second-order filter functions. The circuits are based on the use of two integrators connected in cascade in an overall feedback loop and are thus known as two-integrator-loop circuits.

### 17.7.1 Derivation of the Two-Integrator-Loop Biquad

To derive the two-integrator-loop biquadratic circuit, or biquad as it is commonly known, ${ }^{9}$ consider the second-order high-pass transfer function

$$
\frac{V_{\mathrm{hp}}}{V_{i}}=\frac{K s^{2}}{s^{2}+s\left(\omega_{0} / Q\right)+\omega_{0}^{2}}
$$

where $K$ is the high-frequency gain. Cross-multiplying Eq. (17.56) and dividing both sides of the resulting equation by $s^{2}$ (to get all the terms involving $s$ in the form $1 / s$, which is the transfer function of an integrator) gives

$$
V_{\mathrm{hp}}+\frac{1}{Q}\left(\frac{\omega_{0}}{s} V_{\mathrm{hp}}\right)+\left(\frac{\omega_{0}^{2}}{s^{2}} V_{\mathrm{hp}}\right)=K V_{i}
$$

In this equation we observe that the signal $\left(\omega_{0} / s\right) V_{\mathrm{hp}}$ can be obtained by passing $V_{\mathrm{hp}}$ through an integrator with a time constant equal to $1 / \omega_{0}$. Furthermore, passing the resulting signal through

[^0]
[^0]:    ${ }^{9}$ The name biquad stems from the fact that this circuit in its most general form is capable of realizing a biquadratic transfer function, that is, one that is the ratio of two quadratic polynomials.
another identical integrator results in the third signal involving $V_{\mathrm{hp}}$ in Eq. (17.57)—namely, $\left(\omega_{0}^{2} / s^{2}\right) V_{\mathrm{hp}}$. Figure 17.23(a) shows a block diagram for such a two-integrator arrangement. Note that in anticipation of the use of the inverting op-amp Miller integrator circuit (Section 2.5.2) to implement each integrator, the integrator blocks in Fig. 17.23(a) have been assigned negative signs.

The problem still remains, however, of how to form $V_{\mathrm{hp}}$, the input signal feeding the two cascaded integrators. Toward that end, we rearrange Eq. (17.57), expressing $V_{\mathrm{hp}}$ in terms of its single- and double-integrated versions and of $V_{i}$ as

$$
V_{\mathrm{hp}}=K V_{i}-\frac{1}{Q} \frac{\omega_{0}}{s} V_{\mathrm{hp}}-\frac{\omega_{0}^{2}}{s^{2}} V_{\mathrm{hp}}
$$

which suggests that $V_{\mathrm{hp}}$ can be obtained by using the weighted summer of Fig. 17.23(b). Now it should be easy to see that a complete block diagram realization can be obtained by combining the integrator blocks of Fig. 17.23(a) with the summer block of Fig. 17.23(b), as shown in Fig. 17.23(c).

In the realization of Fig. 17.23(c), $V_{\mathrm{hp}}$, obtained at the output of the summer, realizes the high-pass transfer function $T_{\mathrm{hp}} \equiv V_{\mathrm{hp}} / V_{i}$ of Eq. (17.56). The signal at the output of the first integrator is $-\left(\omega_{0} / s\right) V_{\mathrm{hp}}$, which is a bandpass function,

$$
\frac{\left(-\omega_{0} / s\right) V_{\mathrm{hp}}}{V_{i}}=-\frac{K \omega_{0} s}{s^{2}+s\left(\omega_{0} / Q\right)+\omega_{0}^{2}}=T_{\mathrm{hp}}(s)
$$


(a)

(b)

(c)

Figure 17.23 Derivation of a block diagram realization of the two-integrator-loop biquad.Therefore the signal at the output of the first integrator is labeled $V_{\mathrm{hp}}$. Note that the center-frequency gain of the bandpass filter realized is equal to $-K Q$.

In a similar fashion, we can show that the transfer function realized at the output of the second integrator is the low-pass function,

$$
\frac{\left(\omega_{0}^{2} / s^{2}\right) V_{\mathrm{hp}}}{V_{i}}=\frac{K \omega_{0}^{2}}{s^{2}+s\left(\omega_{0} / Q\right)+\omega_{0}^{2}}=T_{\mathrm{hp}}(s)
$$

Thus the output of the second integrator is labeled $V_{\mathrm{lp}}$. Note that the dc gain of the low-pass filter realized is equal to $K$.

We conclude that the two-integrator-loop biquad shown in block diagram form in Fig. 17.23(c) realizes the three basic second-order filtering functions, LP, BP, and HP, simultaneously. This versatility has made the circuit very popular and has given it the name universal active filter.

# 17.7.2 Circuit Implementation 

To obtain an op-amp circuit implementation of the two-integrator-loop biquad of Fig. 17.23(c), we replace each integrator with a Miller integrator circuit having $C R=1 / \omega_{0}$, and we replace the summer block with an op-amp summing circuit that is capable of assigning both positive and negative weights to its inputs. The resulting circuit, known as the Kerwin-Huelsman-Newcomb or KHN biquad, after its inventors, is shown in Fig. 17.24(a). Given values for $\omega_{0}, Q$, and $K$, the design of the circuit is straightforward: We select suitably practical values for the components $C$ and $R$ of the integrators so that $C R=1 / \omega_{0}$. To determine the values of the resistors associated with the summer, we first use superposition to express the output of the summer $V_{\mathrm{hp}}$ in terms of its inputs, $V_{i}, V_{\mathrm{hp}}$, and $V_{\mathrm{lp}}$ as

$$
V_{\mathrm{hp}}=V_{i} \frac{R_{3}}{R_{2}+R_{3}}\left(1+\frac{R_{f}}{R_{1}}\right)+V_{\mathrm{hp}} \frac{R_{2}}{R_{2}+R_{3}}\left(1+\frac{R_{f}}{R_{1}}\right)-V_{\mathrm{lp}} \frac{R_{f}}{R_{1}}
$$

Substituting $V_{\mathrm{hp}}=-\left(\omega_{0} / s\right) V_{\mathrm{hp}}$ and $V_{\mathrm{lp}}=\left(\omega_{0}^{2} / s^{2}\right) V_{\mathrm{hp}}$ gives

$$
V_{\mathrm{hp}}=\frac{R_{3}}{R_{2}+R_{3}}\left(1+\frac{R_{f}}{R_{1}}\right) V_{i}+\frac{R_{2}}{R_{2}+R_{3}}\left(1+\frac{R_{f}}{R_{1}}\right)\left(-\frac{\omega_{0}}{s} V_{\mathrm{hp}}\right)-\frac{R_{f}}{R_{1}}\left(\frac{\omega_{0}^{2}}{s^{2}} V_{\mathrm{hp}}\right)
$$

Equating the last right-hand-side terms of Eqs. (17.61) and (17.58) gives

$$
R_{f} / R_{1}=1
$$

which implies that we can select arbitrary but practically convenient equal values for $R_{1}$ and $R_{f}$. Then, equating the second-to-last terms on the right-hand side of Eqs. (17.61) and (17.58) and setting $R_{1}=R_{f}$ yields the ratio $R_{3} / R_{2}$ required to realize a given $Q$ as

$$
R_{3} / R_{2}=2 Q-1
$$

Thus an arbitrary but convenient value can be selected for either $R_{2}$ or $R_{3}$, and the value of the other resistance can be determined using Eq. (17.63). Finally, equating the coefficients of $V_{i}$ in Eqs. (17.61) and (17.58) and substituting $R_{f}=R_{1}$ and for $R_{3} / R_{2}$ from Eq. (17.63) results in

$$
K=2-(1 / Q)
$$


Figure 17.24 (a) The KHN biquad circuit, obtained as a direct implementation of the block diagram of Fig. 17.23(c). The three basic filtering functions, HP, BP, and LP, are simultaneously realized. (b) To obtain notch and all-pass functions, the three outputs are summed with appropriate weights using this op-amp summer.

Thus the gain parameter $K$ is fixed to this value.
The KHN biquad can be used to realize notch and all-pass functions by summing weighted versions of the three outputs, LP, BP, and HP. Such an op-amp summer is shown in Fig. 17.24(b); for this summer we can write

$$
\begin{aligned}
V_{o} & =-\left(\frac{R_{F}}{R_{H}} V_{\mathrm{bp}}+\frac{R_{F}}{R_{B}} V_{\mathrm{bp}}+\frac{R_{F}}{R_{L}} V_{\mathrm{lp}}\right) \\
& =-V_{i}\left(\frac{R_{F}}{R_{H}} T_{\mathrm{bp}}+\frac{R_{F}}{R_{B}} T_{\mathrm{bp}}+\frac{R_{F}}{R_{L}} T_{\mathrm{lp}}\right)
\end{aligned}
$$

Substituting for $T_{\mathrm{bp}}, T_{\mathrm{bp}}$, and $T_{\mathrm{lp}}$ from Eqs. (17.56), (17.59), and (17.60), respectively, gives the overall transfer function

$$
\frac{V_{o}}{V_{i}}=-K \frac{\left(R_{F} / R_{H}\right) s^{2}-s\left(R_{F} / R_{B}\right) \omega_{0}+\left(R_{F} / R_{L}\right) \omega_{0}^{2}}{s^{2}+s\left(\omega_{0} / Q\right)+\omega_{0}^{2}}
$$

from which we can see that different transmission zeros can be obtained by the appropriate selection of the values of the summing resistors. For instance, a notch is obtained by selecting $R_{B}=\infty$ and

$$
\frac{R_{H}}{R_{L}}=\left(\frac{\omega_{o}}{\omega_{0}}\right)^{2}
$$
# 17.7.3 An Alternative Two-Integrator-Loop Biquad Circuit 

An alternative two-integrator-loop biquad circuit in which all three op amps are used in a single-ended mode can be developed as follows: Rather than using the input summer to add signals with positive and negative coefficients, we can introduce an additional inverter, as shown in Fig. 17.25(a). Now all the coefficients of the summer have the same sign, and we can dispense with the summing amplifier altogether and perform the summation at the virtual-ground input of the first integrator. Observe that the summing weights of $1,1 / Q$, and $K$ are realized by using resistances of $R, Q R$, and $R / K$, respectively. The resulting circuit is shown in Fig. 17.25(b), from which we observe that the high-pass function is no longer available! This is the price paid for obtaining a circuit that utilizes all op amps in a single-ended mode. The circuit of Fig. 17.25(b) is known as the Tow-Thomas biquad, after its originators.

Rather than using a fourth op amp to realize the finite transmission zeros required for the notch and all-pass functions, as was done with the KHN biquad, an economical feedforward scheme can be employed with the Tow-Thomas circuit. Specifically, the virtual ground available at the input of each of the three op amps in the Tow-Thomas circuit permits the input signal to be fed to all three op amps, as shown in Fig. 17.26. If $V_{o}$ is taken at the output of the damped integrator, straightforward analysis yields the filter transfer function

$$
\frac{V_{o}}{V_{i}}=-\frac{s^{2}\left(\frac{C_{1}}{C}\right)+s \frac{1}{C}\left(\frac{1}{R_{1}}-\frac{r}{R R_{2}}\right)+\frac{1}{C^{2} R R_{2}}}{s^{2}+s \frac{1}{Q C R}+\frac{1}{C^{2} R^{2}}}
$$

which can be used to obtain the design data given in Table 17.2.


Figure 17.25 (a) Derivation of an alternative two-integrator-loop biquad in which all op amps are used in a single-ended fashion. (b) The resulting circuit, known as the Tow-Thomas biquad.


Figure 17.26 The Tow-Thomas biquad with feedforward. The transfer function of Eq. (17.68) is realized by feeding the input signal through appropriate components to the inputs of the three op amps. This circuit can realize all special second-order functions. The design equations are given in Table 17.2.

| Table 17.2 | Design Data for the Circuit in Fig. 17.26 |
| :-- | :-- |
| All cases | $C=$ arbitrary, $R=1 / \omega_{0} C, r=$ arbitrary |
| LP | $C_{1}=0, R_{1}=\infty, R_{2}=R / \mathrm{dc}$ gain, $R_{3}=\infty$ |
| Positive BP | $C_{1}=0, R_{1}=\infty, R_{2}=\infty, R_{3}=Q r /$ center-frequency gain |
| Negative BP | $C_{1}=0, R_{1}=Q R /$ center-frequency gain, $R_{2}=\infty, R_{3}=\infty$ |
| HP | $C_{1}=C \times$ high-frequency gain, $R_{1}=\infty, R_{2}=\infty, R_{3}=\infty$ |
| Notch <br> (all types) | $C_{1}=C \times$ high-frequency gain, $R_{1}=\infty$, <br> $R_{2}=R\left(\omega_{0} / \omega_{a}\right)^{2} /$ high-frequency gain, $R_{3}=\infty$ |
| AP | $C_{1}=C \times$ flat gain, $R_{1}=\infty, R_{2}=R /$ gain, $R_{3}=Q r /$ gain |

# 17.7.4 Final Remarks 

Two-integrator-loop biquads are extremely versatile and easy to design. However, their performance is adversely affected by the finite bandwidth of the op amps. Special techniques exist for compensating the circuit for such effects (see the SPICE simulation example on the website, and Sedra and Brackett, 1978).

## EXERCISES

D17.21 Design the KHN circuit to realize a high-pass function with $f_{0}=10 \mathrm{kHz}$ and $Q=2$. Choose $C=1 \mathrm{nF}$. What is the value of high-frequency gain obtained? What is the center-frequency gain of the bandpass function that is simultaneously available at the output of the first integrator? Ans. $R=15.9 \mathrm{k} \Omega ; R_{1}=R_{f}=R_{2}=10 \mathrm{k} \Omega$ (arbitrary); $R_{3}=30 \mathrm{k} \Omega ; 1.5 ; 3$
D17.22 Use the KHN circuit together with an output summing amplifier to design a low-pass notch filter with $f_{0}=5 \mathrm{kHz}, f_{n}=8 \mathrm{kHz}, Q=5$, and a dc gain of 3 . Select $C=1 \mathrm{nF}$ and $R_{L}=10 \mathrm{k} \Omega$.
Ans. $R=31.83 \mathrm{k} \Omega ; R_{1}=R_{f}=R_{2}=10 \mathrm{k} \Omega$ (arbitrary); $R_{3}=90 \mathrm{k} \Omega ; R_{H}=25.6 \mathrm{k} \Omega ; R_{F}=16.7 \mathrm{k} \Omega$; $R_{B}=\infty$
D17.23 Use the Tow-Thomas biquad [Fig. 17.25(b)] to design a second-order bandpass filter with $f_{0}=$ $10 \mathrm{kHz}, Q=20$, and unity center-frequency gain. If $R=10 \mathrm{k} \Omega$, give the values of $C, R_{d}$, and $R_{g}$. Ans. $1.59 \mathrm{nF} ; 200 \mathrm{k} \Omega ; 200 \mathrm{k} \Omega$
D17.24 Use the data of Table 17.2 to design the biquad circuit of Fig. 17.26 to realize an all-pass filter with $\omega_{0}=10^{4} \mathrm{rad} / \mathrm{s}, Q=5$, and flat gain $=1$. Use $C=10 \mathrm{nF}$ and $r=10 \mathrm{k} \Omega$.
Ans. $R=10 \mathrm{k} \Omega ; Q$-determining resistor $=50 \mathrm{k} \Omega ; C_{1}=10 \mathrm{nF} ; R_{1}=\infty ; R_{2}=10 \mathrm{k} \Omega ; R_{3}=50 \mathrm{k} \Omega$

# 17.8 Single-Amplifier Biquadratic Active Filters 

The op amp-RC biquadratic circuits studied in the two preceding sections provide good performance, are versatile, and are easy to design and to adjust (tune) after final assembly. Unfortunately, however, they are not economic in their use of op amps, requiring three or four amplifiers per second-order section. This can be a problem, especially in applications that call for conservation of power-supply current: for instance, in a battery-operated instrument. In this section we shall study a class of second-order filter circuits that requires only one op amp per biquad. These minimal realizations, however, suffer a greater dependence on the limited gain and bandwidth of the op amp and can also be more sensitive to the unavoidable tolerances in the values of resistors and capacitors than the multiple-op-amp biquads of the preceding sections. The single-amplifier biquads (SABs) are therefore limited to the less stringent filter specifications-for example, pole $Q$ factors less than about 10 .

The synthesis of SAB circuits is based on the use of feedback to move the poles of an RC circuit from the negative real axis, where they naturally lie, to the complex-conjugate locations required to provide selective filter response. The synthesis of SABs follows a two-step process:

1. Synthesis of a feedback loop that realizes a pair of complex-conjugate poles characterized by a frequency $\omega_{0}$ and a $Q$ factor $Q$.
2. Injecting the input signal in a way that realizes the desired transmission zeros.

### 17.8.1 Synthesis of the Feedback Loop

Consider the circuit shown in Fig. 17.27(a), which consists of a two-port RC network $n$ placed in the negative-feedback path of an op amp. We shall assume that, except for having a finite gain $A$, the op amp is ideal. We shall denote by $t(s)$ the open-circuit voltage-transfer function of the RC network $n$, where the definition of $t(s)$ is illustrated in Fig. 17.27(b). The transfer function $t(s)$ can in general be written as the ratio of two polynomials $N(s)$ and $D(s)$ :

$$
t(s)=\frac{N(s)}{D(s)}
$$


Figure 17.27 (a) Feedback loop obtained by placing a two-port RC network $n$ in the feedback path of an op amp. (b) Definition of the open-circuit transfer function $t(s)$ of the RC network.

The roots of $N(s)$ are the transmission zeros of the RC network, and the roots of $D(s)$ are its poles. Study of circuit theory shows that while the poles of an RC network are restricted to lie on the negative real axis, the zeros can in general lie anywhere in the $s$ plane.

The loop gain $L(s)$ of the feedback circuit in Fig. 17.27(a) can be determined using the method of Section 11.3.3. It is simply the product of the op-amp gain $A$ and the transfer function $t(s)$,

$$
L(s)=A t(s)=\frac{A N(s)}{D(s)}
$$

Substituting for $L(s)$ into the characteristic equation

$$
1+L(s)=0
$$

results in the poles $s_{P}$ of the closed-loop circuit obtained as solutions to the equation

$$
t\left(s_{P}\right)=-\frac{1}{A}
$$

In the ideal case, $A=\infty$ and the poles are obtained from

$$
N\left(s_{P}\right)=0
$$

That is, the filter poles are identical to the zeros of the RC network.
Since our objective is to realize a pair of complex-conjugate poles, we should select an RC network that can have complex-conjugate transmission zeros. The simplest such networks are the bridged-T networks shown in Fig. 17.28 together with their transfer functions $t(s)$ from $b$ to $a$, with $a$ open-circuited. As an example, consider the circuit generated by placing the bridged-T network of Fig. 17.28(a) in the negative-feedback path of an op amp, as shown in Fig. 17.29. The pole polynomial of the active-filter circuit will be equal to the numerator polynomial of the bridged-T network; thus,

$$
s^{2}+s \frac{\omega_{0}}{Q}+\omega_{0}^{2}=s^{2}+s\left(\frac{1}{C_{1}}+\frac{1}{C_{2}}\right) \frac{1}{R_{3}}+\frac{1}{C_{1} C_{2} R_{3} R_{4}}
$$


$$
t(s)=\frac{s^{2}+s\left(\frac{1}{C_{1}}+\frac{1}{C_{2}}\right) \frac{1}{R_{3}}+\frac{1}{C_{1} C_{2} R_{3} R_{4}}}{s^{2}+s\left(\frac{1}{C_{1} R_{3}}+\frac{1}{C_{2} R_{3}}+\frac{1}{C_{1} R_{4}}\right)+\frac{1}{C_{1} C_{2} R_{3} R_{4}}}
$$

(a)


$$
t(s)=\frac{s^{2}+s\left(\frac{1}{R_{1}}+\frac{1}{R_{2}}\right) \frac{1}{C_{4}}+\frac{1}{C_{3} C_{4} R_{1} R_{2}}}{s^{2}+s\left(\frac{1}{C_{4} R_{1}}+\frac{1}{C_{4} R_{2}}+\frac{1}{C_{3} R_{2}}\right)+\frac{1}{C_{3} C_{4} R_{1} R_{2}}}
$$

(b)

Figure 17.28 Two RC networks (called bridged-T networks) that can have complex transmission zeros. The transfer functions given are from $b$ to $a$, with $a$ open-circuited.


Figure 17.29 An active-filter feedback loop generated using the bridged-T network of Fig. 17.28(a).
which enables us to obtain $\omega_{0}$ and $Q$ as

$$
\begin{aligned}
& \omega_{0}=\frac{1}{\sqrt{C_{1} C_{2} R_{3} R_{4}}} \\
& Q=\left[\frac{\sqrt{C_{1} C_{2} R_{3} R_{4}}}{R_{3}}\left(\frac{1}{C_{1}}+\frac{1}{C_{2}}\right)\right]^{-1}
\end{aligned}
$$

If we are designing this circuit, $\omega_{0}$ and $Q$ are given and Eqs. (17.73) and (17.74) can be used to determine $C_{1}, C_{2}, R_{3}$, and $R_{4}$. It follows that there are two degrees of freedom. Let us
exhaust one of these by selecting $C_{1}=C_{2}=C$. Let us also denote $R_{3}=R$ and $R_{4}=R / m$. By substituting in Eqs. (17.73) and (17.74), and with some manipulation, we obtain

$$
\begin{aligned}
m & =4 Q^{2} \\
C R & =\frac{2 Q}{\omega_{0}}
\end{aligned}
$$

Thus if we are given the value of $Q$, Eq. (17.75) can be used to determine the ratio of the two resistances $R_{3}$ and $R_{4}$. Then the given values of $\omega_{0}$ and $Q$ can be substituted in Eq. (17.76) to determine the time constant $C R$. There remains one degree of freedom-the value of $C$ or $R$ can be arbitrarily chosen. In an actual design, this value, which sets the impedance level of the circuit, should be chosen so that the resulting component values are practical.

# EXERCISES 

D17.25 Design the circuit of Fig. 17.29 to realize a pair of poles with $\omega_{0}=10^{4} \mathrm{rad} / \mathrm{s}$ and $Q=1$. Select $C_{1}=C_{2}=1 \mathrm{nF}$.
Ans. $R_{3}=200 \mathrm{k} \Omega ; R_{4}=50 \mathrm{k} \Omega$
17.26 For the circuit designed in Exercise 17.25, find the location of the poles of the RC network in the feedback loop.
Ans. $-0.382 \times 10^{4}$ and $-2.618 \times 10^{4} \mathrm{rad} / \mathrm{s}$

### 17.8.2 Injecting the Input Signal

Having synthesized a feedback loop that realizes a given pair of poles, we now consider connecting the input signal source to the circuit. We wish to do this, of course, without altering the poles.

Since, for the purpose of finding the poles of a circuit, an ideal voltage source is equivalent to a short circuit, it follows that any circuit node that is connected to ground can instead be connected to the input voltage source without causing the poles to change. Thus the method of injecting the input voltage signal into the feedback loop is simply to disconnect a component (or several components) that is (are) connected to ground and connect it (them) to the input source. Depending on the component(s) through which the input signal is injected, different transmission zeros are obtained. This is, of course, the same method we used in Section 17.5 with the LCR resonator and in Section 17.6 with the biquads based on the LCR resonator.

As an example, consider the feedback loop of Fig. 17.29. Here we have two grounded nodes (one terminal of $R_{4}$ and the positive input terminal of the op amp) that can serve for injecting the input signal. Figure 17.30(a) shows the circuit with the input signal injected through part of the resistance $R_{4}$. Note that the two resistances $R_{4} / \alpha$ and $R_{4} /(1-\alpha)$ have a parallel equivalent of $R_{4}$.

Analysis of the circuit to determine its voltage-transfer function $T(s) \equiv V_{o}(s) / V_{i}(s)$ is illustrated in Fig. 17.30(b). Note that we have assumed the op amp to be ideal and have


Figure 17.30 (a) The feedback loop of Fig. 17.29 with the input signal injected through part of resistance $R_{4}$. This circuit realizes the bandpass function. (b) Analysis of the circuit in (a) to determine its voltage transfer function $T(s)$ with the order of the analysis steps indicated by the circled numbers.
indicated the order of the analysis steps by the circled numbers. The final step, number 9, consists of writing a node equation at X and substituting for $V_{x}$ by the value determined in step 5. The result is the transfer function

$$
\frac{V_{o}}{V_{i}}=\frac{-s\left(\alpha / C_{1} R_{4}\right)}{s^{2}+s\left(\frac{1}{C_{1}}+\frac{1}{C_{2}}\right) \frac{1}{R_{3}}+\frac{1}{C_{1} C_{2} R_{3} R_{4}}}
$$

We recognize this as a bandpass function whose center-frequency gain can be controlled by the value of $\alpha$. As expected, the denominator polynomial is identical to the numerator polynomial of $t(s)$ given in Fig. 17.28(a).
# EXERCISE 

17.27 Use the component values obtained in Exercise 17.25 to design the bandpass circuit of Fig. 17.30(a). Determine the values of $\left(R_{a} / \alpha\right)$ and $R_{a} /(1-\alpha)$ to obtain a center-frequency gain of unity. Ans. $100 \mathrm{k} \Omega ; 100 \mathrm{k} \Omega$

### 17.8.3 Generation of Equivalent Feedback Loops

The complementary transformation of feedback loops is based on the property of linear networks illustrated in Fig. 17.31 for the two-port (three-terminal) network $n$. In Fig. 17.31(a), terminal $c$ is grounded and a signal $V_{b}$ is applied to terminal $b$. The transfer function from $b$ to $a$ with $c$ grounded is denoted $t$. Then, in Fig. 17.31(b), terminal $b$ is grounded and the input signal is applied to terminal $c$. The transfer function from $c$ to $a$ with $b$ grounded can be shown to be the complement of $t$-that is, $1-t$. (Recall that we used this property in generating a circuit realization for the all-pass function in Section 17.6.)

Application of the complementary transformation to a feedback loop to generate an equivalent feedback loop is a two-step process:

1. Nodes of the feedback network and any of the op-amp inputs that are connected to ground should be disconnected from ground and connected to the op-amp output. Conversely, those nodes that were connected to the op-amp output should be now connected to ground. That is, we simply interchange the op-amp output terminal with ground.
2. The two input terminals of the op amp should be interchanged.

The feedback loop generated by this transformation has the same characteristic equation, and hence the same poles, as the original loop.


Figure 17.31 Interchanging input and ground results in the complement of the transfer function.

Figure 17.32 Application of the complementary transformation to the feedback loop in (a) results in the equivalent loop (same poles) shown in (b).

To illustrate, we show in Fig. 17.32(a) the feedback loop formed by connecting a two-port RC network in the negative-feedback path of an op amp. Application of the complementary transformation to this loop results in the feedback loop of Fig. 17.32(b). Note that in the latter loop the op amp is used in the unity-gain follower configuration. We shall now show that the two loops of Fig. 17.32 are equivalent.

If the op amp has an open-loop gain $A$, the follower in the circuit of Fig. 17.32(b) will have a gain of $A /(A+1)$. This, together with the fact that the transfer function of network $n$ from $c$ to $a$ is $1-t$ (see Fig. 17.31), enables us to write for the circuit in Fig. 17.32(b) the characteristic equation

$$
1-\frac{A}{A+1}(1-t)=0
$$

This equation can be manipulated to the form

$$
1+A t=0
$$

which is the characteristic equation of the loop in Fig. 17.32(a). As an example, consider the application of the complementary transformation to the feedback loop of Fig. 17.29: The feedback loop of Fig. 17.33(a) results. Injecting the input signal through $C_{1}$ results in the circuit in Fig. 17.33(b), which can be shown (by direct analysis) to realize a second-order high-pass function. This circuit is one of a family of SABs known as the Sallen-and-Key circuits, after their originators. The design of the circuit in Fig. 17.33(b) is based on Eqs. (17.73) through (17.76): namely, $R_{3}=R, R_{4}=R / 4 Q^{2}, C_{1}=C_{2}=C, C R=2 Q / \omega_{0}$, and the value of $C$ is arbitrarily chosen to be practically convenient.

As another example, Fig. 17.34(a) shows the feedback loop generated by placing the two-port RC network of Fig. 17.28(b) in the negative-feedback path of an op amp. For an ideal op amp, this feedback loop realizes a pair of complex-conjugate natural modes having


Figure 17.33 (a) Feedback loop obtained by applying the complementary transformation to the loop in Fig. 17.29. (b) Injecting the input signal through $C_{1}$ realizes the high-pass function. This is one of the Sallen-and-Key family of circuits.


Figure 17.34 (a) Feedback loop obtained by placing the bridged-T network of Fig. 17.28(b) in the negative-feedback path of an op amp. (b) Equivalent feedback loop generated by applying the complementary transformation to the loop in (a). (c) A low-pass filter obtained by injecting $V_{i}$ through $R_{1}$ into the loop in (b).
the same location as the zeros of $t(s)$ of the RC network. Thus, using the expression for $t(s)$ given in Fig. 17.28(b), we can write for the active-filter poles

$$
\begin{aligned}
\omega_{0} & =1 / \sqrt{C_{3} C_{4} R_{1} R_{2}} \\
Q & =\left[\frac{\sqrt{C_{3} C_{4} R_{1} R_{2}}}{C_{4}}\left(\frac{1}{R_{1}}+\frac{1}{R_{2}}\right)\right]^{-1}
\end{aligned}
$$

Normally the design of this circuit is based on selecting $R_{1}=R_{2}=R, C_{4}=C$, and $C_{3}=C / m$. When substituted in Eqs. (17.77) and (17.78), these yield

$$
\begin{aligned}
m & =4 Q^{2} \\
C R & =2 Q / \omega_{0}
\end{aligned}
$$

with the remaining degree of freedom (the value of $C$ or $R$ ) left to the designer to choose.
Injecting the input signal to the $C_{4}$ terminal that is connected to ground can be shown to result in a bandpass realization. If, however, we apply the complementary transformation to the feedback loop in Fig. 17.34(a), we obtain the equivalent loop in Fig. 17.34(b). The loop equivalence means that the circuit of Fig. 17.34(b) has the same poles and thus the same $\omega_{0}$ and $Q$ and the same design equations (Eqs. 17.77 through 17.80). The new loop in Fig. 17.34(b) can be used to realize a low-pass function by injecting the input signal as shown in Fig. 17.34(c).

In conclusion, we note that complementary transformation is a powerful tool that enables us to obtain new filter circuits from ones we already have, thus increasing our repertoire of filter realizations.

# EXERCISES 

17.28 Analyze the circuit in Fig. 17.34(c) to determine its transfer function $V_{o}(s) / V_{i}(s)$ and thus show that $\omega_{0}$ and $Q$ are indeed those in Eqs. (17.77) and (17.78). Also show that the dc gain is unity.
D17.29 Design the circuit in Fig. 17.34(c) to realize a low-pass filter with $f_{0}=4 \mathrm{kHz}$ and $Q=1 / \sqrt{2}$. Use $10-\mathrm{k} \Omega$ resistors.
Ans. $R_{1}=R_{2}=10 \mathrm{k} \Omega ; C_{3}=2.81 \mathrm{nF} ; C_{4}=5.63 \mathrm{nF}$

### 17.9 Sensitivity

Because of the tolerances in component values and because of the finite op-amp gain, the response of the actual assembled filter will deviate from the ideal response. As a means for predicting such deviations, the filter designer employs the concept of sensitivity. Specifically, for second-order filters one is usually interested in finding how sensitive their poles are relative to variations (both initial tolerances and future drifts) in RC component values and amplifier gain. These sensitivities can be quantified using the classical sensitivity function $S_{s}^{y}$, defined as

$$
S_{s}^{y} \equiv \operatorname{Lim}_{\Delta x \rightarrow 0} \frac{\Delta y / y}{\Delta x / x}
$$
Thus,

$$
S_{x}^{y}=\frac{\partial y x}{\partial x y}
$$

Here, $x$ denotes the value of a component (a resistor, a capacitor, or an amplifier gain) and $y$ denotes a circuit parameter of interest (say, $\omega_{0}$ or $Q$ ). For small changes

$$
S_{x}^{y} \simeq \frac{\Delta y / y}{\Delta x / x}
$$

Thus we can use the value of $S_{x}^{y}$ to determine the per-unit change in $y$ due to a given per-unit change in $x$. For instance, if the sensitivity of $Q$ relative to a particular resistance $R_{1}$ is 5 , then a $1 \%$ increase in $R_{1}$ results in a $5 \%$ increase in the value of $Q$.

# Example 17.3 

For the feedback loop of Fig. 17.29, find the sensitivities of $\omega_{0}$ and $Q$ relative to all the passive components and the op-amp gain. Evaluate these sensitivities for the design considered in the preceding section for which $C_{1}=C_{2}$.

## Solution

To find the sensitivities with respect to the passive components, called passive sensitivities, we assume that the op-amp gain is infinite. In this case, $\omega_{0}$ and $Q$ are given by Eqs. (17.73) and (17.74). Thus for $\omega_{0}$ we have

$$
\omega_{0}=\frac{1}{\sqrt{C_{1} C_{2} R_{3} R_{4}}}
$$

which can be used together with the sensitivity definition of Eq. (17.82) to obtain

$$
S_{C_{1}}^{\mathrm{op}}=S_{C_{2}}^{\mathrm{op}}=S_{R_{3}}^{\mathrm{op}}=S_{R_{4}}^{\mathrm{op}}=-\frac{1}{2}
$$

For $Q$ we have

$$
Q=\left[\sqrt{C_{1} C_{2} R_{3} R_{4}}\left(\frac{1}{C_{1}}+\frac{1}{C_{2}}\right) \frac{1}{R_{3}}\right]^{-1}
$$

to which we apply the sensitivity definition to obtain

$$
S_{C_{1}}^{Q}=\frac{1}{2}\left(\sqrt{\frac{C_{2}}{C_{1}}}-\sqrt{\frac{C_{1}}{C_{2}}}\right)\left(\sqrt{\frac{C_{2}}{C_{1}}}+\sqrt{\frac{C_{1}}{C_{2}}}\right)^{-1}
$$

For the design with $C_{1}=C_{2}$ we see that $S_{C_{1}}^{Q}=0$. Similarly, we can show that

$$
S_{C_{2}}^{Q}=0, \quad S_{R_{3}}^{Q}=\frac{1}{2}, \quad S_{R_{4}}^{Q}=-\frac{1}{2}
$$

It is important to remember that the sensitivity expression should be derived before values corresponding to a particular design are substituted.
# Example 17.3 continued 

Next we consider the sensitivities relative to the amplifier gain. If we assume the op amp to have a finite gain $A$, the characteristic equation for the loop becomes

$$
1+A t(s)=0
$$

where $t(s)$ is given in Fig. 17.28(a). To simplify matters we can substitute for the passive components by their design values. This causes no errors in evaluating sensitivities, since we are now finding the sensitivity with respect to the amplifier gain. Using the design values obtained earlier-namely, $C_{1}=C_{2}=C, R_{3}=R$, $R_{4}=R / 4 Q^{2}$, and $C R=2 Q / \omega_{0}$-we get

$$
t(s)=\frac{s^{2}+s\left(\omega_{0} / Q\right)+\omega_{0}^{2}}{s^{2}+s\left(\omega_{0} / Q\right)\left(2 Q^{2}+1\right)+\omega_{0}^{2}}
$$

where $\omega_{0}$ and $Q$ denote the nominal or design values of the pole frequency and $Q$ factor. The actual values are obtained by substituting for $t(s)$ in Eq. (17.84):

$$
s^{2}+s \frac{\omega_{0}}{Q}\left(2 Q^{2}+1\right)+\omega_{0}^{2}+A\left(s^{2}+s \frac{\omega_{0}}{Q}+\omega_{0}^{2}\right)=0
$$

Assuming the gain $A$ to be real and dividing both sides by $A+1$, we get

$$
s^{2}+s \frac{\omega_{0}}{Q}\left(1+\frac{2 Q^{2}}{A+1}\right)+\omega_{0}^{2}=0
$$

From this equation we see that the actual pole frequency, $\omega_{0 \mathrm{e}}$, and the pole $Q, Q_{o}$, are

$$
\begin{gathered}
\omega_{0 \mathrm{e}}=\omega_{0} \\
Q_{o}=\frac{Q}{1+2 Q^{2} /(A+1)}
\end{gathered}
$$

Thus

$$
\begin{gathered}
S_{A}^{\omega_{0 \mathrm{e}}}=0 \\
S_{A}^{Q_{o}}=\frac{A}{A+1} \frac{2 Q^{2} /(A+1)}{1+2 Q^{2} /(A+1)}
\end{gathered}
$$

For $A \gg 2 Q^{2}$ and $A \gg 1$ we obtain

$$
S_{A}^{Q_{o}} \simeq \frac{2 Q^{2}}{A}
$$

It is usual to drop the subscript $a$ in this expression and write

$$
S_{A}^{Q} \simeq \frac{2 Q^{2}}{A}
$$

Note that if $Q$ is high $(Q \geq 5)$, its sensitivity relative to the amplifier gain can be quite high. ${ }^{10}$

[^0]
[^0]:    ${ }^{10}$ Because the open-loop gain $A$ of op amps usually has wide tolerance, it is important to keep $S_{A}^{\omega_{0}}$ and $S_{A}^{Q}$ very small.
The results of Example 17.3 indicate a serious disadvantage of single-amplifier biquads-the sensitivity of $Q$ relative to the amplifier gain is quite high. Although a technique exists for reducing $S_{A}^{Q}$ in SABs (see Sedra et al., 1980), this is done at the expense of increased passive sensitivities. Nevertheless, the resulting SABs are used extensively in many applications. However, for filters with $Q$ factors greater than about 10 , one usually opts for one of the multiamplifier biquads studied in Sections 17.6 and 17.7. For these circuits $S_{A}^{Q}$ is proportional to $Q$, rather than to $Q^{7}$ as in the SAB case (Eq. 17.89).

# EXERCISE 

17.30 In a particular filter utilizing the feedback loop of Fig. 17.29, with $C_{1}=C_{2}$, use the results of Example 17.3 to find the expected percentage change in $\omega_{0}$ and $Q$ under the conditions that (a) $R_{1}$ is $2 \%$ high, (b) $R_{4}$ is $2 \%$ high, (c) both $R_{3}$ and $R_{4}$ are $2 \%$ high, and (d) both capacitors are $2 \%$ low and both resistors are $2 \%$ high.
Ans. (a) $-1 \%,+1 \%$; (b) $-1 \%,-1 \%$; (c) $-2 \%, 0 \%$; (d) $0 \%, 0 \%$

### 17.10 Transconductance-C Filters

The op amp-RC circuits studied in Sections 17.4 and 17.6 through 17.8 are ideally suited for implementing audio-frequency filters using discrete op amps, resistors, and capacitors, assembled on printed-circuit boards. Such circuits have also been implemented in hybrid thinor thick-film forms where the op amps are used in chip form (i.e., without their packages).

The limitation of op amp-RC filters to low-frequency applications is a result of the relatively low bandwidth of general-purpose op amps. The lack of suitability of these filter circuits for implementation in IC form stems from:

1. The need for large-valued capacitors, which would require impractically large chip areas;
2. The need for very precise values of RC time constants. This is impossible to achieve on an IC without resorting to expensive trimming and tuning techniques; and
3. The need for op amps that can drive resistive and large capacitive loads. As we have seen, CMOS op amps are usually capable of driving only small capacitances.

### 17.10.1 Methods for IC Filter Implementation

We now introduce the three approaches currently in use for implementing filters in monolithic form.

Transconductance-C Filters These utilize transconductance amplifiers or simply transconductors together with capacitors and are hence called $G_{m}-C$ filters. Because high-quality and high-frequency transconductors can be easily realized in CMOS technology, where small-valued capacitors are plentiful, this filter-design method is very popular at this time. It
has been used at medium and high frequencies approaching the hundreds of megahertz range. We shall study this method briefly in this section.

MOSFET-C Filters These utilize the two-integrator-loop circuits of Section 17.8 but with the resistors replaced with MOSFETs operating in the triode region. Clever techniques have been evolved to obtain linear operation with large input signals. Because of space limitations, we shall not study this design method here and refer the reader to Tsividis and Voorman (1992).

Switched-Capacitor Filters These are based on the ingenious technique of obtaining a large resistance by switching a capacitor at a relatively high frequency. Because of the switching action, the resulting filters are discrete-time circuits, as opposed to the continuous-time filters studied thus far. The switched-capacitor approach is ideally suited for implementing low-frequency filters in IC form using CMOS technology. We shall study switched-capacitor filters in Section 17.11.

EARLY FILTER PIONEERS-CAUER AND DARLINGTON:

While on a fellowship with Vannevar Bush at MIT and Harvard, the German mathematician Wilhelm Cauer (1900-1945) used the Chebyshev polynomials in a way that unified the field of filter transfer function design. The elliptical filters now known as Cauer filters have equiripple performance in both the passband and the stopband(s). Cauer continued to make contributions to LC filter synthesis until his mysterious disappearance and presumed death in Berlin on the last day of the Second World War.

Sidney Darlington (1906-1997) developed a complete design theory for LC filters while working at the Bell Telephone Laboratories in the 1940s. Ironically, in later years he became better known for his invention of a particular transistor circuit, the Darlington pair.

# 17.10.2 Transconductors 

Figure 17.35(a) shows the circuit symbol for a transconductor, and Fig. 17.35(b) shows its equivalent circuit. Here we are assuming the transconductor to be ideal, with infinite input and output impedances. Actual transconductors will obviously deviate from this ideal model. We shall investigate the effects of nonidealities in some of the end-of-chapter problems. Otherwise, we shall assume that for the purpose of this introductory study, the transconductors are ideal.

The transconductor of Fig. 17.35(a) has a positive output; that is, the output current $I_{o}=$ $G_{m} V_{i}$ flows out of the output terminal. Transconductors with a negative output are, of course, also possible and one is shown in Fig. 17.35(c), with its ideal model in Fig. 17.35(d).

The transconductors of Fig. 17.35(a) and (c) are both of the single-ended type. As mentioned in Chapter 9, differential amplification is preferred over the single-ended variety for a number of reasons, including lower susceptibility to noise and interference. This preference for fully differential operation extends to other signal-processing functions including filtering where it can be shown that distortion, an important issue in filter design, is reduced in fully differential configurations. As a result, at the present time, most IC analog filters utilize fully differential circuits. For this purpose, we show in Fig. 17.35(e) a differential-input-differential-output transconductor.


Figure 17.35 (a) A positive transconductor; (b) equivalent circuit of the transconductor in (a); (c) a negative transconductor and its equivalent circuit (d); (e) a fully differential transconductor; (f) a simple circuit implementation of the fully differential transconductor.

We have already encountered circuits for implementing transconductors. As an example of a simple implementation, we show the circuit in Fig. 17.35(f), which is simply a differential amplifier loaded with two current sources. The linearity of this circuit is of course limited by the $i_{D}-v_{G S}$ characteristic of the MOSFET, necessitating the use of small input signals. Many elaborate transconductor circuits have been proposed and utilized in the design of $G_{m}-C$ filters (see Chan Carusone, Johns, and Martin, 2012).

# 17.10.3 Basic Building Blocks 

In this section we present the basic building blocks of $G_{m}-C$ filters. Figure 17.36(a) shows how a negative transconductor can be used to realize a resistance. An integrator is obtained by feeding the output current of a transconductor, $G_{m} V_{i}$, to a grounded capacitor, as shown in


Figure 17.36 Realization of (a) a resistance using a negative transconductor; (b) an ideal noninverting integrator; (c) a first-order low-pass filter (a damped integrator); and (d) a fully differential first-order low-pass filter. (e) Alternative realization of the fully differential first-order low-pass filter.
Fig. 17.36(b). The transfer function obtained is

$$
\frac{V_{o}}{V_{i}}=\frac{G_{m}}{s C}
$$

which is ideal because we have assumed the transconductor to be ideal (see Problem 17.86).
To obtain a damped integrator, or a first-order low-pass filter, we connect a resistance of the type in Fig. 17.36(a) in parallel with the capacitor $C$ in the integrator of Fig. 17.36(b). The resulting circuit is shown in Fig. 17.36(c). The transfer function can be obtained by writing a node equation at $X$. The result is

$$
\frac{V_{o}}{V_{i}}=-\frac{G_{m 1}}{s C+G_{m 2}}
$$

Thus, the pole frequency is $\left(G_{m 2} / C\right)$ and the dc gain is $\left(-G_{m 1} / G_{m 2}\right)$.
The circuit in Figure 17.36(c) can be easily converted to the fully differential form shown in Fig. 17.36(d). An alternative implementation of the fully differential first-order low-pass filter is shown in Fig. 17.36(e). Note that the latter circuit requires four times the capacitance value of the circuit in Fig. 17.36(d). Nevertheless, the circuit of Fig. 17.36(e) has some advantages (see Chan Carusone et al., 2012).

# 17.10.4 Second-Order $G_{m}-C$ Filter 

To obtain a second-order $G_{m}-C$ filter, we use the two-integrator-loop topology of Fig. 17.25(a). Absorbing the $(1 / Q)$ branch within the first integrator, and lumping the second integrator together with the inverter into a single noninverting integrator block, we obtain the block diagram in Fig. 17.37(a). This block diagram can be easily implemented by $G_{m}-C$ circuits, resulting in the circuit of Fig. 17.37(b). Note that

1. The inverting integrator is realized by the inverting transconductor $G_{m 1}$, capacitor $C_{1}$, and the resistance implemented by transconductor $G_{m 3}$.
2. The noninverting integrator is realized by the noninverting transconductor $G_{m 2}$ and capacitor $C_{2}$.
3. The input summer is implemented by transconductor $G_{m 4}$, which feeds an output current $G_{m 4} V_{i}$ to the integrator capacitor $C_{1}$, and transconductor $G_{m 1}$, which feeds an output current $G_{m 1} V_{2}$ to $C_{1}$.
To derive the transfer functions $\left(V_{1} / V_{i}\right)$ and $\left(V_{2} / V_{i}\right)$ we first note that $V_{2}$ and $V_{1}$ are related by

$$
V_{2}=\frac{G_{m 2}}{s C_{2}} V_{1}
$$

Next, we write a node equation at $X$ and use the relationship above to eliminate $V_{2}$. After some simple algebraic manipulations we obtain

$$
\frac{V_{1}}{V_{i}}=-\frac{s\left(G_{m 4} / C_{1}\right)}{s^{2}+s \frac{G_{m 3}}{C_{1}}+\frac{G_{m 1} G_{m 2}}{C_{1} C_{2}}}
$$

Now, using Eq. (17.92) to replace $V_{1}$ in Eq. (17.93) results in

$$
\frac{V_{2}}{V_{i}}=-\frac{G_{m 2} G_{m 4} / C_{1} C_{2}}{s^{2}+s \frac{G_{m 3}}{C_{1}}+\frac{G_{m 1} G_{m 2}}{C_{1} C_{2}}}
$$Thus, the circuit in Fig. 17.37(b) is capable of realizing simultaneously a bandpass function $\left(V_{1} / V_{i}\right)$ and a low-pass function $\left(V_{2} / V_{i}\right)$. For both

$$
\omega_{0}=\sqrt{\frac{G_{m 1} G_{m 2}}{C_{1} C_{2}}}
$$


(a)

(b)

(c)

Figure 17.37 (a) Block diagram of the two-integrator-loop biquad. This is a somewhat modified version of Fig. 17.25. (b) $G_{m}-C$ implementation of the block diagram in (a). (c) Fully differential $G_{m}-C$ implementation of the block diagram in (a). In all parts, $V_{1} / V_{i}$ is a bandpass function and $V_{2} / V_{i}$ is a low-pass function.
and

$$
Q=\frac{\sqrt{G_{m 1} G_{m 2}}}{G_{m 3}} \sqrt{\frac{C_{1}}{C_{2}}}
$$

For the bandpass function,

$$
\text { Center-frequency gain }=-\frac{G_{m 4}}{G_{m 3}}
$$

and for the low-pass function,

$$
\text { DC gain }=-\frac{G_{m 4}}{G_{m 1}}
$$

There are a variety of possible designs. The most common is to make the time constants of the integrators equal [which is the case in the block diagram of Fig. 17.37(a)]. Doing this and selecting $G_{m 1}=G_{m 2}=G_{m}$ and $C_{1}=C_{2}=C$ results in the following design equation

$$
\begin{aligned}
\frac{G_{m}}{C} & =\omega_{0} \\
G_{m 3} & =\frac{G_{m}}{Q} \\
\text { For the BP: } \quad G_{m 4} & =\frac{G_{m}}{Q}|\text { Gain }| \\
\text { For the LP: } \quad G_{m 4} & =G_{m}|\text { Gain }|
\end{aligned}
$$

# Example 17.4 

Design the $G_{m}-C$ circuit of Fig. 17.37(b) to realize a bandpass filter with a center frequency of 10 MHz , a 3-dB bandwidth of 1 MHz , and a center-frequency gain of 10 . Use equal capacitors of 5 pF .

## Solution

Using the equal-integrator-time-constants design, Eq. (17.99) yields

$$
G_{m}=\omega_{0} C=2 \pi \times 10 \times 10^{6} \times 5 \times 10^{-12}=0.314 \mathrm{~mA} / \mathrm{V}
$$

Thus,

$$
G_{m 1}=G_{m 2}=0.314 \mathrm{~mA} / \mathrm{V}
$$

To obtain $G_{m 3}$, we first note that $Q=f_{0} / \mathrm{BW}=10 / 1=10$, and then use Eq. (17.100) to obtain

$$
G_{m 3}=\frac{G_{m}}{Q}=\frac{0.314}{10}=0.0314 \mathrm{~mA} / \mathrm{V}
$$

or

$$
G_{m 3}=31.4 \mu \mathrm{~A} / \mathrm{V}
$$

Finally, $G_{m 4}$ can be found by using Eq. (17.101) as

$$
G_{m 4}=\frac{G_{m}}{10} \times 10=0.314 \mathrm{~mA} / \mathrm{V}
$$
We note that the feedforward approach utilized in Section 17.7.3 to realize different transmission zeros (as required for high-pass, notch, and all-pass functions) can be adapted to the $G_{m}-C$ circuit in Fig. 17.37(b). Some of these possibilities are explored in the end-of-chapter problems. Finally, the circuit in Fig. 17.37(b) can be easily converted to the fully differential form shown in Fig. 17.37(c).

# EXERCISE 

D17.31 Design the circuit of Fig. 17.37(b) to realize a maximally flat low-pass filter with $f_{\lambda \mathrm{dB}}=20 \mathrm{MHz}$ and a dc gain of unity. Design for equal integrator time constants, and use equal capacitors of 2 pF each.
Ans. $G_{m 1}=G_{m 2}=G_{m 4}=0.251 \mathrm{~mA} / \mathrm{V} ; G_{m 3}=0.355 \mathrm{~mA} / \mathrm{V}$

This concludes our study of $G_{m}-C$ filters. The interested reader can find considerably more material on this subject in Schaumann et al. (2010).

### 17.11 Switched-Capacitor Filters

In this section we study another approach to the design of analog filters for IC implementation. Switched-capacitor filters, which require only small capacitors, analog switches, and op amps that need to drive only small capacitive loads, are ideally suited for implementation in CMOS. Currently, the switched-capacitor approach is the preferred method for the design of integrated-circuit audio filters.

### 17.11.1 The Basic Principle

The switched-capacitor filter technique is based on the realization that a capacitor switched between two circuit nodes at a sufficiently high rate is equivalent to a resistor connecting these two nodes. To be specific, consider the active-RC integrator of Fig. 17.38(a). This is the familiar Miller integrator, which we used in the two-integrator-loop biquad in Section 17.7. In Fig. 17.38(b) we have replaced the input resistor $R_{1}$ by a grounded capacitor $C_{1}$ together with two MOS transistors acting as switches. In some circuits, more elaborate switch configurations are used, but such details are beyond our present need.

The two MOS switches in Fig. 17.38(b) are driven by a nonoverlapping two-phase clock. Figure 17.38(c) shows the clock waveforms. We shall assume in this introductory exposition that the clock frequency $f_{c}\left(f_{c}=1 / T_{c}\right)$ is much higher than the frequency of the input signal $v_{i}$. Thus the variations in the input signal are negligibly small during clock phase $\phi_{1}$, when $C_{1}$ is connected across the input signal source $v_{i}$. It follows that during $\phi_{1}$, capacitor $C_{1}$ charges up to the voltage $v_{i}$,

$$
q_{C 1}=C_{1} v_{i}
$$


Figure 17.38 Basic principle of the switched-capacitor filter technique. (a) Active-RC integrator. (b) Switched-capacitor integrator. (c) Two-phase clock (nonoverlapping). (d) During $\phi_{1}, C_{1}$ charges up to the current value of $v_{i}$ and then, during $\phi_{2}$, discharges into $C_{2}$.

Then, during clock phase $\phi_{2}$, capacitor $C_{1}$ is connected to the virtual-ground input of the op amp, as indicated in Fig. 17.38(d). Capacitor $C_{1}$ is thus forced to discharge, and its previous charge $q_{C 1}$ is transferred to $C_{2}$, in the direction indicated in Fig. 17.38(d).

From the description above we see that during each clock period $T_{c}$ an amount of charge $q_{C 1}=C_{1} v_{i}$ is extracted from the input source and supplied to the integrator capacitor $C_{2}$. Thus the average current flowing between the input node (IN) and the virtual-ground node (VG) is

$$
i_{\mathrm{av}}=\frac{C_{1} v_{i}}{T_{c}}
$$

If $T_{c}$ is sufficiently short, one can think of this process as almost continuous and thus can define an equivalent resistance $R_{\mathrm{eq}}$ that is in effect present between nodes IN and VG:

$$
R_{\mathrm{eq}} \equiv v_{i} / i_{\mathrm{av}}
$$

Thus,

$$
R_{\mathrm{eq}}=T_{c} / C_{1}
$$

Using $R_{\text {eq }}$ we obtain an equivalent time constant for the integrator:

$$
\text { Time constant }=C_{2} R_{\mathrm{eq}}=T_{c} \frac{C_{2}}{C_{1}}
$$

Thus the time constant that determines the frequency response of the filter is established by the clock period $T_{c}$ and the capacitor ratio $C_{2} / C_{1}$. Both these parameters can be well controlled
in an IC process. Specifically, note the dependence on capacitor ratios rather than on absolute values of capacitors. The accuracy of capacitor ratios in MOS technology can be controlled to within $0.1 \%$.

Another point worth observing is that with a reasonable clocking frequency (such as 100 kHz ) and not-too-large capacitor ratios (say, 10), one can obtain reasonably large time constants (such as $10^{-4} \mathrm{~s}$ ) suitable for audio applications. Since capacitors typically occupy relatively large areas on the IC chip, one attempts to minimize their values. In this context, it is important to note that the ratio accuracies quoted earlier are obtainable with the smaller capacitor value as low as 0.1 pF .

# 17.11.2 Practical Circuits 

The switched-capacitor (SC) circuit in Fig. 17.38(b) realizes an inverting integrator [note the direction of charge flow through $C_{2}$ in Fig. 17.38(d)]. As we saw in Section 17.7, a two-integrator-loop active filter is composed of one inverting and one noninverting integrator. ${ }^{11}$ To realize a switched-capacitor biquad filter, we therefore need a pair of complementary switched-capacitor integrators. Figure 17.39(a) shows a noninverting, or positive, integrator circuit. The reader is urged to follow the operation of this circuit during the two clock phases and thus show that it operates in much the same way as the basic circuit of Fig. 17.38(b), except for a sign reversal.

In addition to realizing a noninverting integrator function, the circuit in Fig. 17.39(a) is insensitive to stray capacitances; however, we shall not explore this point any further. The interested reader is referred to Schaumann, Ghausi, and Laker (1990). By reversal of the clock phases on two of the switches, the circuit in Fig. 17.39(b) is obtained. This circuit realizes the inverting integrator function, like the circuit of Fig. 17.38(b), but is insensitive to stray capacitances [which the original circuit of Fig. 17.38(b) is not]. The complementary integrators of Fig. 17.39 have become the standard building blocks in the design of switched-capacitor filters.

Let us now consider the realization of a complete biquad circuit. Figure 17.40(a) shows the active-RC, two-integrator-loop circuit studied earlier. By considering the cascade of integrator 2 and the inverter as a positive integrator, and then simply replacing each resistor by its switched-capacitor equivalent, we obtain the circuit in Fig. 17.40(b). Ignore the damping around the first integrator (i.e., the switched capacitor $C_{5}$ ) for the time being and note that the feedback loop indeed consists of one inverting and one noninverting integrator. Then note the phasing of the switched capacitor used for damping. Reversing the phases here would convert the feedback to positive and move the poles to the right half of the $s$ plane. On the other hand, the phasing of the feed-in switched capacitor $\left(C_{6}\right)$ is not that important; a reversal of phases would result only in an inversion in the sign of the function realized.

Having identified the correspondences between the active-RC biquad and the switchedcapacitor biquad, we can now derive design equations. Analysis of the circuit in Fig. 17.40(a) yields

$$
\omega_{0}=\frac{1}{\sqrt{C_{1} C_{2} R_{3} R_{4}}}
$$

Replacing $R_{3}$ and $R_{4}$ with their switched-capacitor equivalent values, that is,

$$
R_{3}=T_{c} / C_{3} \quad \text { and } \quad R_{4}=T_{c} / C_{4}
$$

[^0]
[^0]:    ${ }^{11}$ In the two-integrator loop of Fig. 17.25(b), the noninverting integrator is realized by the cascade of a Miller integrator and an inverting amplifier.


Figure 17.39 A pair of complementary stray-insensitive, switched-capacitor integrators. (a) Noninverting switched-capacitor integrator. (b) Inverting switched-capacitor integrator.
gives $\omega_{0}$ of the switched-capacitor biquad as

$$
\omega_{0}=\frac{1}{T_{c}} \sqrt{\frac{C_{3}}{C_{2}} \frac{C_{4}}{C_{1}}}
$$

It is usual to select the time constants of the two integrators to be equal; that is,

$$
\frac{T_{c}}{C_{3}} C_{2}=\frac{T_{c}}{C_{4}} C_{1}
$$

If, further, we select the two integrating capacitors $C_{1}$ and $C_{2}$ to be equal,

$$
C_{1}=C_{2}=C
$$

then

$$
C_{3}=C_{4}=K C
$$

where from Eq. (17.106)

$$
K=\omega_{0} T_{c}
$$


Figure 17.40 (a) A two-integrator-loop, active-RC biquad and (b) its switched-capacitor counterpart.
For the case of equal time constants, the $Q$ factor of the circuit in Fig. 17.40(a) is given by $R_{3} / R_{4}$. Thus the $Q$ factor of the corresponding switched-capacitor circuit in Fig. 17.40(b) is given by

$$
Q=\frac{T_{c} / C_{5}}{T_{c} / C_{4}}=\frac{C_{4}}{C_{5}}
$$

Thus $C_{5}$ should be selected from

$$
C_{5}=\frac{C_{4}}{Q}=\frac{K C}{Q}=\omega_{0} T_{c} \frac{C}{Q}
$$

Finally, the center-frequency gain of the bandpass function is given by

$$
\text { Center-frequency gain }=\frac{C_{6}}{C_{5}}=Q \frac{C_{6}}{\omega_{0} T_{c} C}
$$

# EXERCISE 

D17.32 Use $C_{1}=C_{2}=20 \mathrm{pF}$ and design the circuit in Fig. 17.40(b) to realize a bandpass function with $f_{0}=10 \mathrm{kHz}, Q=20$, and unity center-frequency gain. Use a clock frequency $f_{c}=200 \mathrm{kHz}$. Find the values of $C_{3}, C_{4}, C_{5}$, and $C_{6}$.
Ans. $6.283 \mathrm{pF} ; 6.283 \mathrm{pF} ; 0.314 \mathrm{pF} ; 0.314 \mathrm{pF}$

### 17.11.3 Final Remarks

We have attempted to provide only an introduction to switched-capacitor filters. We have made many simplifying assumptions, the most important being the switched-capacitor-resistor equivalence (Eq. 17.103). This equivalence is correct only at $f_{c}=\infty$ and is approximately correct for $f_{c} \gg f$. Switched-capacitor filters are, in fact, discrete-time circuits whose analysis and design can be carried out exactly using $z$-transform techniques. The interested reader is referred to the bibliography in Appendix I.

The switched-capacitor circuits presented above are of the single-ended variety. In most applications, fully differential versions of these circuits are employed.

### 17.12 Tuned Amplifiers

We conclude this chapter with the study of a special kind of frequency-selective network, the LC-tuned amplifier. Figure 17.41 shows the general shape of the frequency response of a tuned amplifier. The techniques discussed apply to amplifiers with center frequencies in the range of a few hundred kilohertz to a few hundred megahertz. Tuned amplifiers find application in the radio-frequency (RF) and intermediate-frequency (IF) sections of communications receivers and in a variety of other systems. It should be noted that the tuned-amplifier response of Fig. 17.41 is similar to that of the bandpass filter discussed in earlier sections.


Figure 17.41 Frequency response of a tuned amplifier.

As indicated in Fig. 17.41, the response is characterized by the center frequency $\omega_{0}$, the 3-dB bandwidth $B$, and the skirt selectivity, which is usually measured as the ratio of the $30-\mathrm{dB}$ bandwidth to the 3-dB bandwidth. In many applications, the 3-dB bandwidth is less than $1 \%$ of $\omega_{0}$. This narrow-band property makes possible certain approximations that can simplify the design process.

The tuned amplifiers discussed in this section can be implemented in discrete-circuit form using transistors together with passive inductors and capacitors. Increasingly, however, they are implemented in IC form, where the inductors are specially fabricated by depositing thin metal films in a spiral shape. These IC inductors, however, are very small and hence are useful only in very-high-frequency applications. Also they usually have considerable losses or, equivalently, low $Q$ factors. Various circuit techniques have been proposed to raise the realized $Q$ factors. These usually involve an amplifier circuit that generates a negative resistance, which is connected to the inductor in a way that cancels part of its resistance and thus enhance its $Q$ factor. The resulting tuned amplifiers are therefore referred to as active-LC filters (see Schaumann et al., 2010).

This section considers tuned amplifiers that are small-signal voltage amplifiers in which the transistors operate in the "class A" mode; that is, the transistors conduct at all times. Tuned power amplifiers such as those based on class C operation of the transistor, are not studied in this book. (For a discussion on the classification of amplifiers, refer to Section 12.1.)

# 17.12.1 The Basic Principle 

The basic principle underlying the design of tuned amplifiers is the use of a parallel LCR circuit as the load, or at the input, of a BJT or an FET amplifier. This is illustrated in Fig. 17.42 with a MOSFET amplifier having a tuned-circuit load. For simplicity, the bias details are not included. Since this circuit uses a single tuned circuit, it is known as a single-tuned amplifier. The amplifier equivalent circuit is shown in Fig. 17.42(b). Here $R$ denotes the parallel equivalent of $R_{L}$ and the output resistance $r_{o}$ of the FET, and $C$ is the parallel equivalent of $C_{L}$ and the FET output capacitance (usually small). From the equivalent circuit we can write

$$
V_{o}=\frac{-g_{m} V_{i}}{Y_{L}}=\frac{-g_{m} V_{i}}{s C+1 / R+1 / s L}
$$

(a)

(b)

Figure 17.42 The basic principle of tuned amplifiers is illustrated using a MOSFET with a tuned-circuit load. Bias details are not shown.

Thus the voltage gain can be expressed as

$$
\frac{V_{o}}{V_{i}}=-\frac{g_{m}}{C} \frac{s}{s^{2}+s(1 / C R)+1 / L C}
$$

which is a second-order bandpass function. Thus the tuned amplifier has a center frequency of

$$
\omega_{0}=1 / \sqrt{L C}
$$

a 3-dB bandwidth of

$$
B=\frac{1}{C R}
$$

a $Q$ factor of

$$
Q \equiv \omega_{0} / B=\omega_{0} C R
$$

and a center-frequency gain of

$$
\frac{V_{o}\left(j \omega_{0}\right)}{V_{i}\left(j \omega_{0}\right)}=-g_{m} R
$$

Note that the expression for the center-frequency gain could have been written by inspection; at resonance, the reactances of $L$ and $C$ cancel out and the impedance of the parallel LCR circuit reduces to $R$.# Example 17.5 

It is required to design a tuned amplifier of the type shown in Fig. 17.42, having $f_{0}=1 \mathrm{MHz}, 3-\mathrm{dB}$ bandwidth $=10 \mathrm{kHz}$, and center-frequency gain $=-10 \mathrm{~V} / \mathrm{V}$. The FET available has at the bias point $g_{m}=5 \mathrm{~mA} / \mathrm{V}$ and $r_{o}=10 \mathrm{k} \Omega$. The output capacitance is negligibly small. Determine the values of $R_{L}, C_{L}$, and $L$.

## Solution

Center-frequency gain $=-10=-5 R$. Thus $R=2 \mathrm{k} \Omega$. Since $R=R_{L} \| r_{o}$, then $R_{L}=2.5 \mathrm{k} \Omega$.

$$
B=2 \pi \times 10^{4}=\frac{1}{C R}
$$

Thus

$$
C=\frac{1}{2 \pi \times 10^{4} \times 2 \times 10^{3}}=7958 \mathrm{pF}
$$

Since $\omega_{0}=2 \pi \times 10^{6}=1 / \sqrt{L C}$, we obtain

$$
L=\frac{1}{4 \pi^{2} \times 10^{12} \times 7958 \times 10^{-12}}=3.18 \mu \mathrm{H}
$$

### 17.12.2 Inductor Losses

The power loss in the inductor is usually represented by a series resistance $r_{s}$ as shown in Fig. 17.43(a). However, rather than specifying the value of $r_{s}$, the usual practice is to specify the inductor $Q$ factor at the frequency of interest,

$$
Q_{0} \equiv \frac{\omega_{0} L}{r_{s}}
$$

Typically, $Q_{0}$ is in the range of 50 to 200.
The analysis of a tuned amplifier is greatly simplified by representing the inductor loss by a parallel resistance $R_{p}$, as shown in Fig. 17.43(b). The relationship between $R_{p}$ and $Q_{0}$ can be found by writing, for the admittance of the circuit in Fig. 17.43(a),

$$
\begin{aligned}
Y\left(j \omega_{0}\right) & =\frac{1}{r_{s}+j \omega_{0} L} \\
& =\frac{1}{j \omega_{0} L} \frac{1}{1-j\left(1 / Q_{0}\right)}=\frac{1}{j \omega_{0} L} \frac{1+j\left(1 / Q_{0}\right)}{1+\left(1 / Q_{0}^{2}\right)}
\end{aligned}
$$

For $Q_{0} \gg 1$,

$$
Y\left(j \omega_{0}\right) \simeq \frac{1}{j \omega_{0} L}\left(1+j \frac{1}{Q_{0}}\right)
$$


Figure 17.43 Inductor equivalent circuits.

Equating this to the admittance of the circuit in Fig. 17.43(b) gives

$$
Q_{0}=\frac{R_{p}}{\omega_{0} L}
$$

or, equivalently,

$$
R_{p}=\omega_{0} L Q_{0}
$$

Finally, it should be noted that the coil $Q$ factor poses an upper limit on the value of $Q$ achieved by the tuned circuit.

# EXERCISE 

17.33 If the inductor in Example 17.5 has $Q_{0}=150$, find $R_{p}$ and then find the value to which $R_{L}$ should be changed to keep the overall $Q$, and hence the bandwidth, unchanged.
Ans. $3 \mathrm{k} \Omega ; 15 \mathrm{k} \Omega$

### 17.12.3 Use of Transformers

In many cases it is found that the required value of inductance is not practical, in the sense that coils with the required inductance might not be available with the required high values of $Q_{0}$. A simple solution is to use a transformer to effect an impedance change. Alternatively, a tapped coil, known as an autotransformer, can be used, as shown in Fig. 17.44. Provided the two parts of the inductor are tightly coupled, which can be achieved by winding on a ferrite core, the transformation relationships shown hold. The result is that the tuned circuit seen between terminals 1 and $1^{\prime}$ is equivalent to that in Fig. 17.42(b). For example, if a turns ratio $n=3$ is used in the amplifier of Example 17.5, then a coil with inductance $L^{\prime}=9 \times 3.18=28.6 \mu \mathrm{H}$ and a capacitance $C^{\prime}=7958 / 9=884 \mathrm{pF}$ will be required. Both these values are more practical than the original ones.

In applications that involve coupling the output of a tuned amplifier to the input of another amplifier, the tapped coil can be used to raise the effective input resistance of the latter amplifier stage. In this way, one can avoid reduction of the overall $Q$. This point is illustrated in Fig. 17.45 and in the following exercises.


Figure 17.44 A tapped inductor is used as an impedance transformer to allow using a higher inductance, $L^{\prime}$, and a smaller capacitance, $C^{\prime}$.


Figure 17.45 (a) The output of a tuned amplifier is coupled to the input of another amplifier via a tapped coil. (b) An equivalent circuit. Note that the use of a tapped coil increases the effective input impedance of the second amplifier stage.

# EXERCISES 

D17.34 Consider the circuit in Fig. 17.45(a), first without tapping the coil. Let $L=5 \mu \mathrm{H}$ and assume that $R_{1}$ is fixed at $1 \mathrm{k} \Omega$. We wish to design a tuned amplifier with $f_{\mathrm{n}}=455 \mathrm{kHz}$ and a $3-\mathrm{dB}$ bandwidth of 10 kHz [this is the intermediate frequency (IF) amplifier of an AM radio]. If the BJT has $R_{\mathrm{in}}=1 \mathrm{k} \Omega$ and $C_{\mathrm{in}}=200 \mathrm{pF}$, find the actual bandwidth obtained and the required value of $C_{1}$. Ans. $13 \mathrm{kHz} ; 24.27 \mathrm{nF}$
D17.35 Since the bandwidth realized in Exercise 17.34 is greater than desired, find an alternative design utilizing a tapped coil as in Fig. 17.45(a). Find the value of $n$ that allows the specifications to be just met. Also find the new required value of $C_{1}$ and the current gain $I_{c} / I$ at resonance. Assume that at the bias point the BJT has $g_{\mathrm{m}}=40 \mathrm{~mA} / \mathrm{V}$.
Ans. 1.36; $24.36 \mathrm{nF} ; 19.1 \mathrm{~A} / \mathrm{A}$
# 17.12.4 Amplifiers with Multiple Tuned Circuits 

The selectivity achieved with the single tuned circuit of Fig. 17.42 is not sufficient in many applications-for instance, in the IF amplifier of a radio or a TV receiver. Greater selectivity is obtained by using additional tuned stages. Figure 17.46 shows a BJT with tuned circuits at both the input and the output. ${ }^{12}$ In this circuit the bias details are shown, from which we note that biasing is quite similar to the classical arrangement employed in low-frequency, discrete-circuit design. However, to avoid the loading effect of the bias resistors $R_{B 1}$ and $R_{B 2}$ on the input tuned circuit, a radio-frequency choke (RFC) is inserted in series with each resistor. Such chokes have low resistance but high impedances at the frequencies of interest. The use of RFCs in biasing tuned RF amplifiers is common practice.

The analysis and design of the double-tuned amplifier of Fig. 17.46 is complicated by the Miller effect ${ }^{13}$ due to capacitance $C_{\mu}$. Since the load is not simply resistive, as was the case in the amplifiers studied in Section 10.3.3, the Miller impedance at the input will be complex. This reflected impedance will cause detuning of the input circuit as well as "skewing" of the response of the input circuit. Needless to say, the coupling introduced by $C_{\mu}$ makes tuning (or aligning) the amplifier quite difficult. Worse still, the capacitor $C_{\mu}$ can cause oscillations to occur (see Gray and Searle, 1969, and Problem 17.101).

Methods exist for neutralizing the effect of $C_{\mu}$, using additional circuits arranged to feed back a current equal and opposite to that through $C_{\mu}$. An alternative, and preferred, approach is to use circuit configurations that do not suffer from the Miller effect. These are discussed later. Before leaving this section, however, we wish to point out that circuits of the type shown in Fig. 17.46 are usually designed utilizing the $y$-parameter model of the BJT (see


Figure 17.46 A BJT amplifier with tuned circuits at the input and the output.

[^0]
[^0]:    ${ }^{12}$ Note that because the input circuit is a parallel resonant circuit, an input current source (rather than voltage source) signal is utilized.
    ${ }^{13}$ Here we use "Miller effect" to refer to the effect of the feedback capacitance $C_{\mu}$ in reflecting back an input impedance that is a function of the amplifier load impedance.
Appendix C). This is done because here, in view of the fact that $C_{\mu}$ plays a significant role, the $y$-parameter model makes the analysis simpler (in comparison to that using the hybrid- $\pi$ model). Also, the $y$ parameters can easily be measured at the particular frequency of interest, $\omega_{0}$. For narrow-band amplifiers, the assumption is usually made that the $y$ parameters remain approximately constant over the passband.

# 17.12.5 The Cascode and the CC-CB Cascade 

From our study of amplifier frequency response in Chapter 10, we know that two amplifier configurations do not suffer from the Miller effect. These are the cascode configuration and the common-collector, common-base cascade. Figure 17.47 shows tuned amplifiers based on these two configurations. The $\mathrm{CC}-\mathrm{CB}$ cascade is usually preferred in IC implementations because its differential structure makes it suitable for IC biasing techniques. (Note that the biasing details of the cascode circuit are not shown in Fig. 17.47(a). Biasing can be done using arrangements similar to those discussed in earlier chapters.)


Figure 17.47 Two tuned-amplifier configurations that do not suffer from the Miller effect: (a) cascode and (b) common-collector, common-base cascade. (Note that bias details of the cascode circuit are not shown.)
# 17.12.6 Synchronous Tuning and Stagger Tuning 

In the design of a tuned amplifier with multiple tuned circuits, the question of the frequency to which each circuit should be tuned arises. The objective, of course, is for the overall response to exhibit high passband flatness and skirt selectivity. To investigate this question, we shall assume that the overall response is the product of the individual responses: in other words, that the stages do not interact. This can easily be achieved using circuits such as those in Fig. 17.47.

Consider first the case of $N$ identical resonant circuits, known as the synchronously tuned case. Figure 17.48 shows the response of an individual stage and that of the cascade. Observe the bandwidth "shrinkage" of the overall response. The 3-dB bandwidth $B$ of the overall amplifier is related to that of the individual tuned circuits, $\omega_{0} / Q$, by (see Problem 17.102)

$$
B=\frac{\omega_{0}}{Q} \sqrt{2^{1 / N}-1}
$$

The factor $\sqrt{2^{1 / N}-1}$ is known as the bandwidth-shrinkage factor. Given $B$ and $N$, we can use Eq. (17.123) to determine the bandwidth required of the individual stages, $\omega_{0} / Q$.

## EXERCISE

D17.36 Consider the design of an IF amplifier for an FM radio receiver. Using two synchronously tuned stages with $f_{0}=10.7 \mathrm{MHz}$, find the $3-\mathrm{dB}$ bandwidth of each stage so that the overall bandwidth is 200 kHz . Using $3-\mu \mathrm{H}$ inductors find $C$ and $R$ for each stage.
Ans. $310.8 \mathrm{kHz} ; 73.7 \mathrm{pF} ; 6.95 \mathrm{k} \Omega$


Figure 17.48 Frequency response of a synchronously tuned amplifier.


Figure 17.49 Stagger-tuning the individual resonant circuits can result in an overall response with a passband flatter than that obtained with synchronous tuning (Fig. 17.48).

A much better overall response is obtained by stagger-tuning the individual stages, as illustrated in Fig. 17.49. Stagger-tuned amplifiers are usually designed so that the overall response exhibits maximal flatness around the center frequency $f_{0}$. Such a response can be obtained by transforming the response of a maximally flat (Butterworth) low-pass filter up the frequency axis to $\omega_{0}$. Appendix H shows how this can be done.

## Summary

- A filter is a linear two-port network with a transfer function $T(s)=V_{o}(s) / V_{c}(s)$. For physical frequencies, the filter transmission is expressed as $T(j \omega)=|T(j \omega)| e^{j \phi(\omega)}$. The magnitude of transmission can be expressed in decibels using either the gain function $G(\omega) \equiv 20 \log |T|$ or the attenuation function $A(\omega) \equiv-20 \log |T|$.
- The transmission characteristics of a filter are specified in terms of the edges of the passband(s) and the stopband(s); the maximum allowed variation in passband transmission, $A_{\text {max }}(\mathrm{dB})$; and the minimum attenuation required in the stopband, $A_{\min }(\mathrm{dB})$. In some applications, the phase characteristics are also specified.
- The filter transfer function can be expressed as the ratio of two polynomials in $s$; the degree of the denominator polynomial, $N$, is the filter order. The $N$ roots of the denominator polynomial are the poles (natural modes).
- To obtain a highly selective response, the poles are complex and occur in conjugate pairs (except for one real pole when $N$ is odd). The zeros are placed on the $j \omega$ axis in the stopband(s) including $\omega=0$ and $\omega=\infty$.
- The Butterworth filter approximation provides a low-pass response that is maximally flat at $\omega=0$. The transmission decreases monotonically as $\omega$ increases, reaching 0 (infinite attenuation) at $\omega=\infty$, where all $N$ transmission zeros lie. Eq. (17.11) gives $|T|$, where $\epsilon$ is given by Eq. (17.14) and the order $N$ is determined using Eq. (17.15). The poles are found using the graphical construction of Fig. 17.10, and the transfer function is given by Eq. (17.16).
- The Chebyshev filter approximation provides a low-pass response that is equiripple in the passband with the transmission decreasing monotonically in the stopband. All the transmission zeros are at $s=\infty$. Eq. (17.18) gives $|T|$ in the passband and Eq. (17.19) gives $|T|$ in the stopband, where $\epsilon$ is given by Eq. (17.21). The order $N$ can be determined using Eq. (17.22). The poles are given by Eq. (17.23) and the transfer function by Eq. (17.24).
- Figures 17.13 and 17.14 provide a summary of first-order filter functions and their realizations.
- Figure 17.16 provides the characteristics of seven special second-order filtering functions.
- The second-order LCR resonator of Fig. 17.17(a) realizes a pair of complex-conjugate poles with $\omega_{0}=1 / \sqrt{L C}$ and $Q=\omega_{0} C R$. This resonator can be used to realize the
various special second-order filtering functions, as shown in Fig. 17.18.

- By replacing the inductor of an LCR resonator with a simulated inductance obtained using the Antoniou circuit of Fig. 17.20(a), the op amp-RC resonator of Fig. 17.21(b) is obtained. This resonator can be used to realize the various second-order filter functions as shown in Fig. 17.22. The design equations for these circuits are given in Table 17.1.
- Biquads based on the two-integrator-loop topology are the most versatile and popular second-order filter realizations. There are two varieties: the KHN circuit of Fig. 17.24(a), which realizes the LP, BP, and HP functions simultaneously and can be combined with the output summing amplifier of Fig. 17.24(b) to realize the notch and all-pass functions; and the Tow-Thomas circuit of Fig. 17.25(b), which realizes the BP and LP functions simultaneously. Feedforward can be applied to the Tow-Thomas circuit to obtain the circuit of Fig. 17.26, which can be designed to realize any of the second-order functions (see Table 17.2).
- Single-amplifier biquads (SABs) are obtained by placing a bridged-T network in the negative-feedback path of an op amp. If the op amp is ideal, the poles realized are at the same locations as the zeros of the RC network. The complementary transformation can be applied to the feedback loop to obtain another feedback loop having identical poles. Different transmission zeros are realized by feeding the input signal to circuit nodes that are connected to ground. SABs are economic in their use of
op amps but are sensitive to the op-amp nonidealities and are thus limited to low- $Q$ applications $(Q \leq 10)$.
- The classical sensitivity function

$$
S_{s}^{z}=\frac{\partial y / y}{\partial x / x}
$$

is a very useful tool in investigating how tolerant a filter circuit is to the unavoidable inaccuracies in component values and to the nonidealities of the op amps.

- Transconductance-C circuits utilize transconductors and capacitors to realize medium- and high-frequency filters (as high as hundreds of megahertz) that can be implemented in CMOS. The basic building block is the integrator, and the basic filter building block is based on the two-integrator-loop topology.
- Switched-capacitor (SC) filters are based on the principle that a capacitor $C$, periodically switched between two circuit nodes at a high rate, $f_{c}$, is equivalent to a resistance $R=1 / C f_{c}$ connecting the two circuit nodes. SC filters can be fabricated in monolithic form using CMOS IC technology.
- Tuned amplifiers utilize LC-tuned circuits as loads, or at the input, of transistor amplifiers. They are used in the design of the RF tuner and the IF amplifier of communication receivers. The cascode and the $\mathrm{CC}-\mathrm{CB}$ cascade configurations are frequently used in the design of tuned amplifiers. Stagger-tuning the individual tuned circuits results in a flatter passband response (in comparison to that obtained with all the resonant circuits synchronously tuned).


## Section 17.1: Filter Transmission, Types, and Specification

17.1 The transfer function of a first-order low-pass filter (such as that realized by an RC circuit) can be expressed as $T(s)=\omega_{0} /\left(s+\omega_{0}\right)$, where $\omega_{0}$ is the $3-\mathrm{dB}$ frequency of the filter. Give in table form the values of $|T|, \phi, G$, and $A$ at $\omega=0,0.5 \omega_{0}, \omega_{0}, 2 \omega_{0}, 5 \omega_{0}, 10 \omega_{0}$, and $100 \omega_{0}$.
17.2 A sinusoid with 1-V peak amplitude is applied at the input of a filter having the transfer function

$$
T(s)=\frac{2 \pi \times 10^{4}}{s+2 \pi \times 10^{4}}
$$

Find the peak amplitude and the phase (relative to that of the input sinusoid) of the output sinusoid if the frequency of the input sinusoid is (a) 1 kHz , (b) 10 kHz , (c) 100 kHz , and (d) 1 MHz .
*17.3 A filter has the transfer function $T(s)=1 /\left[(s+1)\left(s^{2}+\right.\right.$ $s+1)]$. Show that $|T|=\sqrt{1+\omega^{2}}$ and find an expression for its phase response $\phi(\omega)$. Calculate the values of $|T|$ and $\phi$ for $\omega=0.1,1$, and $10 \mathrm{rad} / \mathrm{s}$ and then find the output corresponding to each of the following input signals:
(a) $10 \sin 0.1 t$ (volts)
(b) $10 \sin t$ (volts)
(c) $10 \sin 10 t$ (volts)
17.4 For the filter whose magnitude response is sketched (as the blue curve) in Fig. 17.3, find $|T|$ at $\omega=0, \omega=\omega_{p}$, and $\omega=\omega_{s} . A_{\max }=0.2 \mathrm{~dB}$, and $A_{\min }=60 \mathrm{~dB}$.

D 17.5 A low-pass filter is required to pass all signals within its passband, extending from 0 to 4 kHz , with a transmission variation of at most $5 \%$ (i.e., the ratio of the maximum to minimum transmission in the passband should not exceed 1.05). The transmission in the stopband, which extends from 5 kHz to $\infty$, should not exceed $0.05 \%$ of the maximum passband transmission. What are the values of $A_{\max }, A_{\min }$, and the selectivity factor for this filter?
17.6 A low-pass filter is specified to have $f_{p}=5 \mathrm{kHz}$ and a selectivity factor of 10 . The specifications are just met by a first-order transfer function

$$
T(s)=\frac{2 \pi \times 10^{4}}{s+2 \pi \times 10^{4}}
$$

What must $A_{\max }$ and $A_{\min }$ be?
17.7 A low-pass filter is specified to have $A_{\max }=2 \mathrm{~dB}$ and $A_{\min }=12 \mathrm{~dB}$. It is found that these specifications can be just met with a single-time-constant RC circuit having a time constant of 1 s and a dc transmission of unity. What must $\omega_{p}$ and $\omega_{s}$ of this filter be? What is the selectivity factor?
17.8 Sketch transmission specifications for a high-pass filter having a passband defined by $f \geq 3 \mathrm{kHz}$ and a stopband defined by $f \leq 2 \mathrm{kHz} . A_{\max }=0.4 \mathrm{~dB}$, and $A_{\min }=60 \mathrm{~dB}$.
17.9 Sketch transmission specifications for a bandstop filter that is required to pass signals over the bands $0 \leq f \leq 10 \mathrm{kHz}$ and $20 \mathrm{kHz} \leq f \leq \infty$ with $A_{\max }$ of 0.5 dB . The stopband extends from $f=12 \mathrm{kHz}$ to $f=18 \mathrm{kHz}$, with a minimum required attenuation of 50 dB .

## Section 17.2: The Filter Transfer Function

17.10 Consider a fifth-order filter whose poles are all at a radial distance from the origin of $10^{4} \mathrm{rad} / \mathrm{s}$. One pair of
complex-conjugate poles is at $18^{\circ}$ angles from the $j \omega$ axis, and the other pair is at $54^{\circ}$ angles. Give the transfer function in each of the following cases.
(a) The transmission zeros are all at $s=\infty$ and the dc gain is unity.
(b) The transmission zeros are all at $s=0$ and the high-frequency gain is unity.

What type of filter results in each case?
17.11 A third-order low-pass filter has transmission zeros at $\omega=2 \mathrm{rad} / \mathrm{s}$ and $\omega=\infty$. Its natural modes are at $s=-1$ and $s=-0.5 \pm j 0.8$. The dc gain is unity. Find $T(s)$.
17.12 A second-order low-pass filter has poles at $-0.25 \pm j$ and a transmission zero at $\omega=2 \mathrm{rad} / \mathrm{s}$. If the dc gain is unity, give the transfer function $T(s)$. What is the gain at $\omega$ approaching infinity?
17.13 Find the order $N$ and the form of $T(s)$ of a bandpass filter having transmission zeros as follows: one at $\omega=0$, one at $\omega=10^{3} \mathrm{rad} / \mathrm{s}$, one at $3 \times 10^{3} \mathrm{rad} / \mathrm{s}$, one at $6 \times 10^{3} \mathrm{rad} / \mathrm{s}$, and one at $\omega=\infty$. If this filter has a monotonically decreasing passband transmission with a peak at the center frequency of $2 \times 10^{3} \mathrm{rad} / \mathrm{s}$, and equiripple response in the stopbands, sketch the shape of its $|T|$.
*17.14 Analyze the RLC network of Fig. P17.14 to determine its transfer function $V_{o}(s) / V_{i}(s)$ and hence its poles and zeros. (Hint: Begin the analysis at the output and work your way back to the input.)


Figure P17.14

## Section 17.3: Butterworth and Chebyshev Filters

D 17.15 Determine the order $N$ of the Butterworth filter for which $A_{\max }=0.5 \mathrm{~dB}, A_{\min } \geq 20 \mathrm{~dB}$, and the selectivity ratio $\omega_{s} / \omega_{p}=1.7$. What is the actual value of minimum stopband attenuation realized? If $A_{\min }$ is to be exactly 20 dB , to what value can $A_{\max }$ be reduced?
17.16 Show that the order $N$ of a Butterworth filter can be obtained from the approximate expression

$$
N \geq \frac{A_{\min }-20 \log \epsilon}{20 \log \left(\omega_{r} / \omega_{p}\right)}
$$

Hint: Use Eq. (17.15) and neglect the unity term.
17.17 Calculate the value of attenuation obtained at a frequency 1.8 times the $3-\mathrm{dB}$ frequency of a seventh-order Butterworth filter.
17.18 Find the natural modes of a Butterworth filter having a $0.5-\mathrm{dB}$ bandwidth of $10^{3} \mathrm{rad} / \mathrm{s}$ and $N=5$.

D 17.19 Design a Butterworth filter that meets the following low-pass specifications: $f_{p}=10 \mathrm{kHz}, A_{\max }=3 \mathrm{~dB}, f_{s}=20 \mathrm{kHz}$, and $A_{\min }=20 \mathrm{~dB}$. Find $N$, the natural modes, and $T(s)$. What is the attenuation provided at 30 kHz ?
17.20 Sketch the transfer function magnitude for a low-pass Chebyshev filter of (a) sixth order and (b) seventh order.
17.21 On the same diagram, sketch the magnitude of the transfer function of a Butterworth and a Chebyshev low-pass filter of fifth order and having the same $\omega_{p}$ and $A_{\max }$. At the stopband edge, $\omega_{s}$, which filter gives greater attenuation?
*17.22 Sketch $|T|$ for a seventh-order low-pass Chebyshev filter with $\omega_{p}=1 \mathrm{rad} / \mathrm{s}$ and $A_{\max }=0.5 \mathrm{~dB}$. Use Eq. (17.18) to determine the values of $\omega$ at which $|T|=1$ and the values of $\omega$ at which $|T|=1 / \sqrt{1+\epsilon^{2}}$. Indicate these values on your sketch. Use Eq. (17.19) to determine $|T|$ at $\omega=2 \mathrm{rad} / \mathrm{s}$, and indicate this point on your sketch. For large values of $\omega$, at what rate (in dB/octave) does the transmission decrease?
17.23 Contrast the attenuation provided by a sixth-order Chebyshev filter at $\omega_{s}=2 \omega_{p}$ to that provided by a Butterworth filter of equal order. For both, $A_{\max }=1 \mathrm{~dB}$. Sketch $|T|$ for both filters on the same axes.

D*17.24 It is required to design a low-pass filter to meet the following specifications: $f_{p}=3.4 \mathrm{kHz}, A_{\max }=1 \mathrm{~dB}$, $f_{s}=4 \mathrm{kHz}, A_{\min }=35 \mathrm{~dB}$.
(a) Find the required order of Chebyshev filter. What is the excess (above 35 dB ) stopband attenuation obtained?
(b) Find the poles and the transfer function.

## Section 17.4: First-Order and Second-Order Filter Functions

D 17.25 Use the information displayed in Fig. 17.13 to design a first-order op amp-RC low-pass filter having a 3-dB
frequency of 5 kHz , a dc gain magnitude of 10 , and an input resistance of $12 \mathrm{k} \Omega$.

D 17.26 Use the information given in Fig. 17.13 to design a first-order op amp-RC high-pass filter with a 3-dB frequency of 200 Hz , a high-frequency input resistance of $120 \mathrm{k} \Omega$, and a high-frequency gain magnitude of unity.
17.27 Derive an expression for the transfer function of the op amp-RC circuit that is shown in Fig. 17.13(c). Give expressions for the frequency of the transmission zero $\omega_{T}$, the frequency of the pole $\omega_{P}$, the dc gain, and the high-frequency gain.

D*17.28 Use the information given in Fig. 17.13 to design a first-order op amp-RC spectrum-shaping network with a transmission zero frequency of 100 Hz , a pole frequency of 10 kHz , and a dc gain magnitude of unity. The low-frequency input resistance is to be $10 \mathrm{k} \Omega$. What is the high-frequency gain that results? Sketch the magnitude of the transfer function versus frequency.

D*17.29 By cascading a first-order op amp-RC low-pass circuit with a first-order op amp-RC high-pass circuit, one can design a wideband bandpass filter. Provide such a design for the case in which the midband gain is 12 dB and the $3-\mathrm{dB}$ bandwidth extends from 50 Hz to 50 kHz . Select appropriate component values under the constraints that no resistors higher than $100 \mathrm{k} \Omega$ are to be used and that the input resistance is to be as high as possible.

D 17.30 Derive $T(s)$ for the op amp-RC circuit in Fig. 17.14. Find $|T(j \omega)|$ and $\phi(\omega)$ We wish to use this circuit as a variable phase shifter by adjusting $R$. If the input signal frequency is $5 \times 10^{5} \mathrm{rad} / \mathrm{s}$ and if $C=10 \mathrm{nF}$, find the values of $R$ required to obtain phase shifts of $-30^{\circ},-60^{\circ},-90^{\circ},-120^{\circ}$, and $-150^{\circ}$.
17.31 Show that by interchanging $R$ and $C$ in the op amp-RC circuit of Fig. 17.14, the resulting phase shift covers the range 0 to $180^{\circ}$ (with $0^{\circ}$ at high frequencies and $180^{\circ}$ at low frequencies).

D*17.32 Use two first-order op amp-RC all-pass circuits in cascade to design a circuit that provides a set of three-phase $60-\mathrm{Hz}$ voltages, each separated by $120^{\circ}$ and equal in magnitude, as shown in the phasor diagram of Fig. P17.32. These voltages simulate those used in three-phase power transmission systems. Use $1-\mu \mathrm{F}$ capacitors.

[^0]
[^0]:    3.14 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem

Figure P17.32
17.33 Use the information in Fig. 17.16(a) to obtain the transfer function of a second-order low-pass filter with $\omega_{0}=$ $10^{*} \mathrm{rad} / \mathrm{s}, Q=2$, and dc gain $=1$. At what frequency does $|T|$ peak? What is the peak transmission?

D*17.34 Use the information in Fig. 17.16(a) to obtain the transfer function of a second-order low-pass filter that just meets the specifications defined in Fig. 17.3 with $\omega_{p}=1 \mathrm{rad} / \mathrm{s}$ and $A_{\max }=3 \mathrm{~dB}$. Note that there are two possible solutions. For each, find $\omega_{0}$ and $Q$. Also, if $\omega_{s}=2 \mathrm{rad} / \mathrm{s}$, find the value of $A_{\text {min }}$ obtained in each case.
17.35 Find the transfer function of a second-order high-pass filter with a maximally flat passband response, a $3-\mathrm{dB}$ frequency at $\omega=1 \mathrm{rad} / \mathrm{s}$, and a high-frequency gain of unity. Give the location of the poles and zeros.
17.36 Use the information given in Fig. 17.16(b) to find the transfer function of a second-order high-pass filter with natural modes at $-0.5 \pm j \sqrt{3} / 2$ and a high-frequency gain of unity. What are $\omega_{0}$ and $Q$ of the poles?
17.37 Find the transfer function of a second-order bandpass filter for which the center frequency $f_{0}=10 \mathrm{kHz}$, the $3-\mathrm{dB}$ bandwidth is 500 Hz , and the center-frequency gain is 10 . Also, give the locations of the poles and zeros.
$\mathbf{D}^{* * 17.38}$ (a) Show that $|T|$ of a second-order bandpass function is geometrically symmetrical around the center frequency $\omega_{0}$. That is, the members of each pair of frequencies $\omega_{1}$ and $\omega_{2}$ for which $\left|T\left(j \omega_{1}\right)\right|=\left|T\left(j \omega_{2}\right)\right|$ are related by $\omega_{1} \omega_{2}=\omega_{0}^{2}$.
(b) Find the transfer function of the second-order bandpass filter that meets specifications of the form in Fig. 17.4 where $\omega_{p 1}=8100 \mathrm{rad} / \mathrm{s}, \omega_{p 2}=10,000 \mathrm{rad} / \mathrm{s}$, and $A_{\max }=3 \mathrm{~dB}$. If $\omega_{s 1}=3000 \mathrm{rad} / \mathrm{s}$ find $A_{\min }$ and $\omega_{s 2}$.
$\mathbf{D}^{* 17.39}$ Use the result of Exercise 17.15 to find the transfer function of a notch filter that is required to eliminate
a bothersome interference of $60-\mathrm{Hz}$ frequency. Since the frequency of the interference is not stable, the filter should be designed to provide attenuation $\geq 20 \mathrm{~dB}$ over a $6-\mathrm{Hz}$ band centered around 60 Hz . The dc transmission of the filter is to be unity.
17.40 Consider a second-order all-pass circuit in which errors in the component values result in the frequency of the zeros being slightly lower than that of the poles. Roughly sketch the expected $|T|$. Repeat for the case of the frequency of the zeros slightly higher than the frequency of the poles.
17.41 Consider a second-order all-pass filter in which errors in the component values result in the $Q$ factor of the zeros being greater than the $Q$ factor of the poles. Roughly sketch the expected $|T|$. Repeat for the case of the $Q$ factor of the zeros lower than the $Q$ factor of the poles.

## Section 17.5: The Second-Order LCR Resonator

17.42 Analyze the circuit in Fig. 17.17(c) to determine its transfer function $T(s) \equiv V_{o}(s) / V_{i}(s)$, and hence show that its poles are characterized by $\omega_{0}$ and $Q$ of Eqs. (17.34) and (17.35), respectively.

D 17.43 Design the LCR resonator of Fig. 17.17(a) to obtain natural modes with $\omega_{0}=10^{*} \mathrm{rad} / \mathrm{s}$ and $Q=5$. Use $R=10 \mathrm{k} \Omega$.
17.44 For the LCR resonator of Fig. 17.17(a), find the change in $\omega_{0}$ that results from
(a) increasing $L$ by $1 \%$
(b) increasing $C$ by $1 \%$
(c) decreasing $R$ by $1 \%$
17.45 For each of the circuits in Fig. P17.45, find the transmission as $\omega$ approaches zero and as $\omega$ approaches $\infty$, and hence find the transmission zeros.
17.46 Derive an expression for $V_{o}(s) / V_{i}(s)$ of the high-pass circuit in Fig. 17.18(c).

D 17.47 Use the circuit of Fig. 17.18(b) to design a low-pass filter with $\omega_{0}=10^{*} \mathrm{rad} / \mathrm{s}$ and $Q=1 / \sqrt{2}$. Utilize a $1-\mathrm{nF}$ capacitor.

D 17.48 Modify the bandpass circuit of Fig. 17.18(d) to change its center-frequency gain from 1 to 0.5 without changing $\omega_{0}$ or $Q$.
17.49 Consider the LCR resonator of Fig. 17.17(a) with node $x$ disconnected from ground and connected to an input signal


Figure P17.45
source $V_{x}$, node $y$ disconnected from ground and connected to another input signal source $V_{y}$, and node $z$ disconnected from ground and connected to a third input signal source $V_{z}$. Use superposition to find the voltage that develops across the resonator, $V_{o}$, in terms of $V_{x}, V_{y}$, and $V_{z}$.
17.50 Consider the notch circuit shown in Fig. 17.18(g). For what ratio of $C_{2}$ to $C_{1}$ does the notch occur at $1.1 \omega_{0}$ ? For this case, what is the magnitude of the transmission at frequencies $\ll \omega_{0}$ ? At frequencies $\gg \omega_{0}$ ?

## Section 17.6: Second-Order Active Filters Based on Inductor Replacement

D 17.51 Design the circuit of Fig. 17.20 (utilizing suitable component values) to realize an inductance of (a) 15 H , (b) 1.5 H , and (c) 0.15 H .
17.52 Figure P17.52 shows a generalized form of the Antoniou circuit of Fig. 17.20(a). Here, $R_{5}$ is eliminated and the other four components are replaced by general impedances $Z_{1}, Z_{2}, Z_{3}$, and $Z_{4}$.
(a) With an impedance $Z_{5}$ connected between node 2 and ground, show that the input impedance looking into port 1 (i.e., between node 1 and ground) is

$$
Z_{11}=\left(\frac{Z_{1} Z_{2}}{Z_{2} Z_{4}}\right) Z_{5}
$$



Figure P17.52
(b) From the symmetry of the circuit, show that if an impedance $Z_{6}$ is connected between terminal 1 and ground, the input impedance looking into port 2 , which is between terminal 2 and ground, is given by

$$
Z_{22}=\left(\frac{Z_{2} Z_{4}}{Z_{1} Z_{3}}\right) Z_{6}
$$

(c) From the expressions above, observe that the two-port network in Fig. P17.52 acts as an "impedance transformer." Since by the appropriate choice of $Z_{1}, Z_{2}, Z_{3}$, and $Z_{4}$, the transformation ratio can be a general function
of the complex frequency variable $s$, the circuit is known as a generalized impedance converter, or GIC.
17.53 Consider the Antoniou circuit of Fig. 17.20(a) with $R_{L}$ eliminated, a capacitor $C_{R}$ connected between node 1 and ground, and a voltage source $V_{2}$ connected to node 2 . Show that the input impedance seen by $V_{2}$ is $R_{2} / s^{2} C_{4} C_{6} R_{3} R_{3}$. How does this impedance behave for physical frequencies ( $s=$ $j \omega$ )? (This impedance is known as a frequency-dependent negative resistance, or FDNR.)
*17.54 Starting from first principles and assuming ideal op amps, derive the transfer function of the circuit in Fig. 17.22(a).
$\mathbf{D}^{* 17.55}$ It is required to design a fifth-order Butterworth filter having a $3-\mathrm{dB}$ bandwidth of $10^{5} \mathrm{rad} / \mathrm{s}$ and a unity dc gain. Use a cascade of two circuits of the type shown in Fig. 17.22(a) and a first-order op amp-RC circuit of the type shown in Fig. 17.13(a). Select appropriate component values.
D 17.56 Design the circuit of Fig. 17.22(e) to realize an LPN function with $f_{0}=10 \mathrm{kHz}, f_{n}=12 \mathrm{kHz}, Q=10$, and a unity dc gain. Select $C_{4}=10 \mathrm{nF}$.
D 17.57 Design the all-pass circuit of Fig. 17.22(g) to provide a phase shift of $180^{\circ}$ at $f=2 \mathrm{kHz}$ and to have $Q=2$. Use $1-\mathrm{nF}$ capacitors.
D 17.58 Using the transfer function of the LPN filter, given in Table 17.1, derive the design equations also given.
D 17.59 Using the transfer function of the HPN filter, given in Table 17.1, derive the design equations also given.
$\mathbf{D}^{* * 17.60}$ It is required to design a third-order low-pass filter whose $|T|$ is equiripple in both the passband and the stopband (in the manner shown in Fig. 17.3, except that the response shown is for $N=5$ ). The filter passband extends from $\omega=0$ to $\omega=1 \mathrm{rad} / \mathrm{s}$, and the passband transmission varies between 1 and 0.9 . The stopband edge is at $\omega=1.2 \mathrm{rad} / \mathrm{s}$. The following transfer function was obtained using filter-design tables:

$$
T(s)=\frac{0.4508\left(s^{2}+1.6996\right)}{(s+0.7294)\left(s^{2}+s 0.2786+1.0504\right)}
$$

The actual filter realized is to have $\omega_{p}=10^{5} \mathrm{rad} / \mathrm{s}$.
(a) Obtain the transfer function of the actual filter by replacing $s$ by $s / 10^{5}$.
(b) Realize this filter as the cascade connection of a first-order LP op amp-RC circuit of the type shown in Fig. 17.13(a)
and a second-order LPN circuit of the type shown in Fig. 17.22(e). Each section is to have a dc gain of unity. Select appropriate component values. (Note: A filter with an equiripple response in both the passband and the stopband is known as an elliptic filter.)

## Section 17.7: Second-Order Active Filters Based on the Two-Integrator-Loop Topology

D 17.61 Design the KHN circuit of Fig. 17.24(a) to realize a bandpass filter with a center frequency of 2 kHz and a $3-\mathrm{dB}$ bandwidth of 50 Hz . Use $10-\mathrm{nF}$ capacitors. Give the complete circuit and specify all component values. What value of center-frequency gain is obtained?

D 17.62 (a) Using the KHN biquad with the output summing amplifier of Fig. 17.24(b), show that an all-pass function is realized by selecting $R_{L}=R_{H}=R_{B} / Q$. Also show that the flat gain obtained is $K R_{F} / R_{H}$.
(b) Design the all-pass circuit to obtain $\omega_{0}=10^{5} \mathrm{rad} / \mathrm{s}, Q=4$, and flat gain $=10$. Select appropriate component values.
17.63 Consider the case of the KHN circuit used together with the summing amplifier in Fig. 17.24(b) to realize a notch filter with a notch frequency $\omega_{n}$ and a high-frequency gain of $G$. Find expressions for the values required of the resistances associated with the summing amplifier.
D 17.64 Consider a notch filter with $\omega_{n}=\omega_{0}$ realized by using the KHN biquad with an output summing amplifier. If the summing resistors used have $1 \%$ tolerances, what is the worst-case percentage deviation between $\omega_{n}$ and $\omega_{0}$ ?
D 17.65 Design the circuit of Fig. 17.26 to realize a low-pass notch filter with $\omega_{0}=10^{5} \mathrm{rad} / \mathrm{s}, Q=10$, dc gain $=1$, and $\omega_{n}=1.3 \times 10^{5} \mathrm{rad} / \mathrm{s}$. Use $C=10 \mathrm{nF}$ and $r=20 \mathrm{k} \Omega$.
D 17.66 In the all-pass realization using the circuit of Fig. 17.26, which component(s) does one need to trim to adjust (a) only $\omega_{z}$ and (b) only $Q_{z}$ ?
D**17.67 Repeat Problem 17.60 using the Tow-Thomas biquad of Fig. 17.26 to realize the second-order section in the cascade.

## Section 17.8: Single-Amplifier Biquadratic Active Filters

D 17.68 Design the circuit of Fig. 17.29 to realize a pair of poles with $\omega_{0}=10^{5} \mathrm{rad} / \mathrm{s}$ and $Q=1 / \sqrt{2}$. Use $C_{1}=C_{2}=1 \mathrm{nF}$.
*17.69 Derive the transfer function $t(s)$ of the bridged-T network in Fig. 17.28(a), and thus verify the expression given in the figure.
17.70 Consider the bridged-T network of Fig. 17.28(a) with $R_{3}=R_{4}=R$ and $C_{1}=C_{2}=C$, and denote $C R=\tau$. Find the zeros and poles of the bridged-T network. If the network is placed in the negative-feedback path of an ideal infinite-gain op amp, as in Fig. 17.29, find the poles of the closed-loop amplifier.
17.71 Consider the bridged-T network of Fig. 17.28(b) with $R_{1}=R_{2}=R, C_{4}=C$, and $C_{3}=C / 36$. Let the network be placed in the negative-feedback path of an infinite-gain op amp and let $C_{4}$ be disconnected from ground and connected to the input signal source $V_{i}$. Analyze the resulting circuit to determine its transfer function $V_{o}(s) / V_{i}(s)$, where $V_{o}(s)$ is the voltage at the op-amp output. Show that the circuit obtained is a bandpass filter and find its $\omega_{0}, Q$, and the center-frequency gain.

D 17.72 Use the circuit in Fig. 17.30(b) with $\alpha=1$ to realize a bandpass filter with a center frequency of 10 kHz and a 3-dB bandwidth of 2 kHz . Give the values of all components and specify the center-frequency gain obtained.

D**17.73 Consider the bandpass circuit shown in Fig. 17.30(a). Let $C_{1}=C_{2}=C, R_{3}=R, R_{4}=R / 4 Q^{2}$, $C R=2 Q / \omega_{0}$, and $\alpha=1$. Disconnect the positive input terminal of the op amp from ground and apply $V_{i}$ through a voltage divider $R_{1}, R_{2}$ to the positive input terminal as well as through $R_{4} / \alpha$ as before. Analyze the circuit to find its transfer function $V_{o} / V_{i}$. Find the ratio $R_{2} / R_{1}$ so that the circuit realizes (a) an all-pass function and (b) a notch function. Assume the op amp to be ideal.

D*17.74 Derive the transfer function of the circuit in Fig. 17.33(b) assuming the op amp to be ideal. Thus show that the circuit realizes a high-pass function. What is the high-frequency gain of the circuit? Design the circuit for a maximally flat response with a 3-dB frequency of $10^{4} \mathrm{rad} / \mathrm{s}$. Use $C_{1}=C_{2}=10 \mathrm{nF}$. (Hint: For a maximally flat response, $Q=1 / \sqrt{2}$ and $\omega_{3 \mathrm{~dB}}=\omega_{0}$.)

D*17.75 Design a fifth-order Butterworth low-pass filter that has a 3-dB bandwidth of 10 kHz and a dc gain of unity. Use the cascade connection of two Sallen-and-Key circuits [Fig. 17.34(c)] and a first-order section [Fig. 17.13(a)]. Use a $10-\mathrm{k} \Omega$ value for all resistors.

D 17.76 The process of obtaining the complement of a transfer function by interchanging input and ground, as illustrated in Fig. 17.31, applies to any general network (not just RC networks as shown). Show that if the network $n$ is a bandpass with a center-frequency gain of unity, then the complement obtained is a notch. Verify this by using the RLC circuits of Fig. 17.18(d) and (e).

## Section 17.9: Sensitivity

17.77 Evaluate the sensitivities of $\omega_{0}$ and $Q$ relative to $R, L$, and $C$ of the low-pass circuit in Fig. 17.18(b).
*17.78 Verify the following sensitivity identities:
(a) If $y=u v$, then $S_{x}^{y}=S_{x}^{u}+S_{x}^{v}$.
(b) If $y=u / v$, then $S_{x}^{y}=S_{x}^{u}-S_{x}^{v}$.
(c) If $y=k u$, where $k$ is a constant, then $S_{x}^{y}=S_{x}^{u}$.
(d) If $y=u^{n}$, where $n$ is a constant, then $S_{x}^{y}=n S_{x}^{u}$.
(e) If $y=f_{1}(u)$ and $u=f_{2}(x)$, then $S_{x}^{y}=S_{x}^{y} \cdot S_{x}^{u}$.
*17.79 For the high-pass filter of Fig. 17.33(b), what are the sensitivities of $\omega_{0}$ and $Q$ to amplifier gain $A$ ?
*17.80 For the feedback loop of Fig. 17.34(a), use the expressions in Eqs. (17.77) and (17.78) to determine the sensitivities of $\omega_{0}$ and $Q$ relative to all passive components for the design in which $R_{1}=R_{2}$.
17.81 For the op amp-RC resonator of Fig. 17.21(b), use the expressions for $\omega_{0}$ and $Q$ given in the top row of Table 17.1 to determine the sensitivities of $\omega_{0}$ and $Q$ to all resistors and capacitors.

## Section 17.10: Transconductance-C Filters

17.82 For the fully differential transconductor of Fig. 17.35(f), find an expression for $G_{m}$ in terms of $I$ and the MOSFET's transconductance parameter $h_{n}$. For $h_{n}=0.5 \mathrm{~mA} / \mathrm{V}$, find the bias current $I$ that results in $G_{m}=0.25 \mathrm{~mA} / \mathrm{V}$. If for tuning purposes it is required to adjust $G_{m}$ in a $\pm 5 \%$ range, what is the required range for adjusting $I$ ?

D 17.83 Using the circuit of Fig. 17.36(a) to realize a 1-k $\Omega$ resistance, what $G_{m}$ is needed? If the output resistance of the transconductor is $100 \mathrm{k} \Omega$, what is the resistance actually realized?

D 17.84 Using four transconductors, give the circuit for obtaining an output voltage $V_{o}$ related to three input voltages

[^0]
[^0]:    3111 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
$V_{1}, V_{2}$, and $V_{3}$ by $V_{o}=V_{1}-2 V_{2}+3 V_{3}$. Give the values of the four transconductances as ratios of $G_{m}$ of the transconductor that delivers the output voltage.

D 17.85 For the integrator in Fig. 17.36(b), what value of $G_{m}$ is needed to obtain an integrator with a unity-gain frequency of 10 MHz utilizing a $5-\mathrm{pF}$ capacitor?

D 17.86 If the transconductor in the integrator of Fig. 17.36(b) has an output resistance $R_{o}$ and an output capacitance $C_{o}$, what is the transfer function realized? If the error in the integrator time constant must be less than $1 \%$, what is the smallest value of $C$ that can be used? If the low-frequency pole introduced by $R_{o}$ is to be at least two decades lower than the unity-gain frequency of the integrator, what is the smallest $G_{m}$ that this transconductor must have?

D 17.87 Design the first-order low-pass filter in Fig. 17.36(c) to have a pole frequency of 20 MHz and a dc gain of 10 . Use $C=2 \mathrm{pF}$.

D 17.88 If a capacitor $C_{1}$ is connected between the input node and node X in the circuit of Fig. 17.36(c), what transfer function $V_{i} / V_{i}$ is realized?

D*17.89 For the circuit in Fig. P17.89:


Figure P17.89
(a) Show that the input impedance $Z_{\mathrm{in}}$ is that of an inductance $L$ and find an expression for $L$.
(b) Use the inductance generated at the input to form an LCR resonator. To realize the resistance $R$, use a third transconductor $G_{m 3}$.
(c) Use a fourth inverting transconductor $G_{m 4}$ with its input connected to an input voltage $V_{i}$ and its output connected to node 1. Compare the circuit thus created to the two-integrator-loop $G_{m}-C$ filter of Fig. 17.37(b).
(d) What filter function is (i) $V_{1} / V_{i}$, (ii) $V_{2} / V_{i}$ ?

D 17.90 Consider the $G_{m}-C$ second-order bandpass filter of Fig. 17.37(b) and its associated expressions in Eqs. (17.95) and (17.96). Generate an alternative design based on selecting $G_{m 1}=G_{m 2}=G_{m 3}=G_{m}$ and $C_{2}=C$. Find expressions for $C_{1}$ and $G_{m}$ in terms of $\omega_{0}, Q$, and $C$.

D 17.91 To enable the second-order $G_{m}-C$ circuit in Fig. 17.37(b) to realize filter functions other than bandpass and lowpass, implement the following modifications:
(a) Connect a capacitor $C_{3}$ between the positive input terminal and the output terminal of transconductor $G_{m 4}$ and
(b) Add a fifth negative transconductor $G_{m 5}$ with $V_{i}$ applied to its input, and its output connected to the node at which $V_{2}$ is taken.

Derive an expression for the transfer function $V_{1} / V_{i}$.
D 17.92 Design the circuit of Fig. 17.37(c) to realize a bandpass function having a center frequency of 25 MHz , $Q=5$, and a center-frequency gain of 5 . Select $G_{m 1}=G_{m 2}$ and $C_{1}=C_{2}=5 \mathrm{pF}$.

## Section 17.11: Switched-Capacitor Filters

17.93 For the switched-capacitor input circuit of Fig. 17.38(b), in which a clock frequency of 200 kHz is used, what input resistances correspond to capacitance $C_{1}$ values of $1 \mathrm{pF}, 5 \mathrm{pF}$, and 10 pF ?
17.94 For a dc voltage of 1 V applied to the input of the circuit of Fig. 17.38(b), in which $C_{1}$ is 1 pF , what charge is transferred for each cycle of the two-phase clock? For a $100-\mathrm{kHz}$ clock, what is the average current drawn from the input source? For a feedback capacitance of 10 pF , what change would you expect in the output for each cycle of the clock? For an amplifier that saturates at $\pm 10 \mathrm{~V}$ and the feedback capacitor initially discharged, how many clock cycles would it take to saturate the amplifier? What is the average slope of the staircase output voltage produced?

D 17.95 Repeat Exercise 17.32 for a clock frequency of 500 kHz .

[^0]
[^0]:    17.85 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
D 17.96 Repeat Exercise 17.32 for $Q=50$.
D 17.97 Design the circuit of Fig. 17.40(b) to realize, at the output of the second (noninverting) integrator, a maximally flat low-pass function with $\omega_{\mathrm{MB}}=10^{3} \mathrm{rad} / \mathrm{s}$ and unity dc gain. Use a clock frequency $f_{c}=100 \mathrm{kHz}$ and select $C_{1}=C_{2}=5 \mathrm{pF}$. Give the values of $C_{1}, C_{4}, C_{5}$, and $C_{6}$. (Hint: For a maximally flat response, $Q=1 / \sqrt{2}$ and $\omega_{\mathrm{MB}}=\omega_{0}$.)

## Section 17.12: Tuned Amplifiers

*17.98 A voltage signal source with a resistance $R_{s}=10 \mathrm{k} \Omega$ is connected to the input of a common-emitter BJT amplifier. Between base and emitter is connected a tuned circuit with $L=0.5 \mu \mathrm{H}$ and $C=200 \mathrm{pF}$. The transistor is biased at 1 mA and has $\beta=200, C_{n}=10 \mathrm{pF}$, and $C_{p}=0.5 \mathrm{pF}$. The transistor load is a resistance of $5 \mathrm{k} \Omega$. Find $\omega_{0}, Q$, the 3-dB bandwidth, and the center-frequency gain of this single-tuned amplifier.
17.99 A coil having an inductance of $10 \mu \mathrm{H}$ is intended for applications around $1-\mathrm{MHz}$ frequency. Its $Q$ is specified to be 250 . Find the equivalent parallel resistance $R_{p}$. What is the value of the capacitor required to produce resonance at 1 MHz ? What additional parallel resistance is required to produce a 3-dB bandwidth of 12 kHz ?
17.100 An inductance of $36 \mu \mathrm{H}$ is resonated with a $1000-\mathrm{pF}$ capacitor. If the inductor is tapped at one-third of its turns and a $1-\mathrm{k} \Omega$ resistor is connected across the one-third part, find $f_{0}$ and $Q$ of the resonator.
*17.101 Consider a common-emitter transistor amplifier loaded with an inductance $L$. Ignoring $r_{o}$, show that for $\omega C_{p} \ll 1 / \omega L$, the amplifier input admittance is given by

$$
Y_{\text {in }} \simeq\left(\frac{1}{r_{o}}-\omega^{2} C_{o} L g_{m}\right)+j \omega\left(C_{o}+C_{o}\right)
$$

(Note: The real part of the input admittance can be negative. This can lead to oscillations.)
*17.102 (a) Substituting $s=j \omega$ in the transfer function $T(s)$ of a second-order bandpass filter [see Fig. 17.16(c)], find $|T(j \omega)|$. For $\omega$ in the vicinity of $\omega_{0}$ [i.e., $\omega=\omega_{0}+$ $\delta \omega=\omega_{0}\left(1+\delta \omega / \omega_{0}\right)$, where $\delta \omega / \omega_{0} \ll 1$ so that $\omega^{2} \simeq$ $\omega_{0}^{2}\left(1+2 \delta \omega / \omega_{0}\right)$ ], show that, for $Q \gg 1$,

$$
|T(j \omega)| \simeq \frac{\left|T\left(j \omega_{0}\right)\right|}{\sqrt{1+4 Q^{2}\left(\delta \omega / \omega_{0}\right)^{2}}}
$$

(b) Use the result obtained in (a) to show that the 3-dB bandwidth $B$, of $N$ synchronously tuned sections connected in cascade, is

$$
B=\left(\omega_{0} / Q\right) \sqrt{2^{1 / N}-1}
$$

**17.103 (a) Using the fact that for $Q \gg 1$ the second-order bandpass response in the neighborhood of $\omega_{0}$ is the same as the response of a first-order low-pass with 3-dB frequency of $\left(\omega_{0} / 2 Q\right)$, show that the bandpass response at $\omega=\omega_{0}+\delta \omega$, for $\delta \omega \ll \omega_{0}$, is given by

$$
|T(j \omega)| \simeq \frac{\left|T\left(j \omega_{0}\right)\right|}{\sqrt{1+4 Q^{2}\left(\delta \omega / \omega_{0}\right)^{2}}}
$$

(b) Use the relationship derived in (a) together with Eq. (17.123) to show that a bandpass amplifier with a 3-dB bandwidth $B$, designed using $N$ synchronously tuned stages, has an overall transfer function given by

$$
|T(j \omega)|_{\text {overall }}=\frac{\left|T\left(j \omega_{0}\right)\right|_{\text {overall }}}{\left[1+4\left(2^{1 / N}-1\right)(\delta \omega / B)^{2}\right]^{N / 2}}
$$

(c) Use the relationship derived in (b) to find the attenuation (in decibels) obtained at a bandwidth $2 B$ for $N=1$ to 5 . Also find the ratio of the $30-\mathrm{dB}$ bandwidth to the $3-\mathrm{dB}$ bandwidth for $N=1$ to 5 .
# CHAPTER 18 

## Signal Generators and WaveformShaping Circuits

Introduction 1379
18.1 Basic Principles of Sinusoidal Oscillators 1380
18.2 Op Amp-RC Oscillator Circuits 1388
18.3 LC and Crystal Oscillators 1396
18.4 Bistable Multivibrators 1404
18.5 Generation of Square and Triangular Waveforms Using Astable Multivibrators 1412
18.6 Generation of a Standardized Pulse: The Monostable Multivibrator 1417
18.7 Integrated-Circuit Timers 1419
18.8 Nonlinear Waveform-Shaping Circuits 1424

Summary 1428
Problems 1428
# IN THIS CHAPTER YOU WILL LEARN 

1. That an oscillator circuit that generates sine waves can be implemented by connecting a frequency-selective network in the positive-feedback path of an amplifier.
2. The conditions under which sustained oscillations are obtained and the frequency of the oscillations.
3. How to design nonlinear circuits to control the amplitude of the sine wave obtained in a linear oscillator.
4. A variety of circuits for implementing a linear sine-wave oscillator.
5. How op amps can be combined with resistors and capacitors to implement precision multivibrator circuits.
6. How a bistable circuit can be connected in a feedback loop with an op-amp integrator to implement a generator of square and triangular waveforms.
7. The application of one of the most popular IC chips of all time, the 555 timer, in the design of generators of pulse and square waveforms.
8. How a triangular waveform can be shaped by a nonlinear circuit to provide a sine waveform.

## Introduction

In the design of electronic systems, the need frequently arises for signals having prescribed standard waveforms, for example, sinusoidal, square, triangular, or pulse. Systems in which standard signals are required include computer and control systems where clock pulses are needed for, among other things, timing; communication systems where signals of a variety of waveforms are utilized as information carriers; and test and measurement systems where signals, again of a variety of waveforms, are employed for testing and characterizing electronic devices and circuits. In this chapter we study signal-generator circuits.

The signal-generator or oscillator circuits studied in this chapter are collectively capable of providing signals with frequencies in the range of hertz to hundreds of gigahertz. While some can be fabricated on chip, others utilize discrete components. Examples of commonly encountered oscillators include the microprocessor clock generator (fabricated on chip utilizing the ring oscillator studied in Section 16.4.4 with frequencies in the several-gigahertz range); the carrier-waveform generator in wireless transceivers (on chip, up to the hundreds-of-gigahertz range); the oscillator in an electronic watch (utilizing a quartz
crystal with a frequency of $2^{15} \mathrm{~Hz}$ ); and the variable-frequency function generator in the electronics lab (utilizing a discrete circuit with frequency in the hertz to megahertz range).

There are two distinctly different approaches for the generation of sinusoids, perhaps the most commonly used of the standard waveforms. The first approach, studied in Sections 18.1 to 18.3, employs a positive-feedback loop consisting of an amplifier and an RC or LC frequency-selective network. While the frequency of the generated sine wave is determined by the frequency-selective network, the amplitude is set using a nonlinear mechanism, implemented either with a separate circuit or using the nonlinearities of the amplifying device itself. In spite of this, these circuits, which generate sine waves utilizing resonance phenomena, are known as linear oscillators. The name clearly distinguishes them from the circuits that generate sinusoids by way of the second approach. In these circuits, a sine wave is obtained by appropriately shaping a triangular waveform. We study waveform-shaping circuits in Section 18.8, following the study of triangular-waveform generators.

Circuits that generate square, triangular, pulse (etc.) waveforms, called nonlinear oscillators or function generators, employ circuit building blocks known as multivibrators. There are three types of multivibrator: the bistable (Section 18.4), the astable (Section 18.5), and the monostable (Section 18.6). The multivibrator circuits presented in this chapter employ op amps and are intended for precision analog applications. Bistable and monostable multivibrator circuits using digital logic gates were studied in Chapter 16.

A general and versatile scheme for the generation of square and triangular waveforms is obtained by connecting a bistable multivibrator and an op-amp integrator in a feedback loop (Section 18.5). Similar results can be obtained using a commercially available versatile IC chip, the 555 timer (Section 18.7).

# 18.1 Basic Principles of Sinusoidal Oscillators 

In this section, we study the basic principles of the design of linear sine-wave oscillators. In spite of the name linear oscillator, some form of nonlinearity has to be employed to provide control of the amplitude of the output sine wave. In fact, all oscillators are essentially nonlinear circuits. This complicates the task of analysis and design of oscillators: No longer is one able to apply transform ( $s$-plane) methods directly. Nevertheless, techniques have been developed by which the design of sinusoidal oscillators can be performed in two steps: The first step is a linear one, and frequency-domain methods of feedback circuit analysis can be readily employed. Subsequently, in step 2, a nonlinear mechanism for amplitude control can be provided.

### 18.1.1 The Oscillator Feedback Loop

The basic structure of a sinusoidal oscillator consists of an amplifier and a frequency-selective network connected in a positive-feedback loop, such as that shown in block diagram form in Fig. 18.1. Although no input signal will be present in an actual oscillator circuit, we include an input signal here to help explain the principle of operation. It is important to note that unlike the negative-feedback loop of Fig. 11.1, here the feedback signal $x_{f}$ is summed with a positive sign. Thus the gain-with-feedback is given by

$$
A_{f}(s)=\frac{A(s)}{1-A(s) \beta(s)}
$$

where we note the negative sign in the denominator. The loop gain $L(s)$ is given by

$$
L(s) \equiv A(s) \beta(s)
$$


Figure 18.1 The basic structure of a sinusoidal oscillator. A positive-feedback loop is formed by an amplifier and a frequency-selective network. In an actual oscillator circuit, no input signal will be present; here an input signal $x_{s}$ is employed to help explain the principle of operation.
and the characteristic equation is

$$
1-L(s)=0
$$

# 18.1.2 The Oscillation Criterion 

If at a specific frequency $f_{0}$ the loop gain $A \beta$ is equal to unity, it follows from Eq. (18.1) that $A_{f}$ will be infinite. That is, at this frequency the circuit will have a finite output for zero input signal. Such a circuit is by definition an oscillator. Thus the condition for the feedback loop of Fig. 18.1 to provide sinusoidal oscillations of frequency $\omega_{0}$ is

$$
L\left(j \omega_{0}\right) \equiv A\left(j \omega_{0}\right) \beta\left(j \omega_{0}\right)=1
$$

That is, at $\omega_{0}$ the phase of the loop gain should be zero and the magnitude of the loop gain should be unity. This is known as the Barkhausen criterion. Note that for the circuit to oscillate at one frequency, the oscillation criterion should be satisfied only at one frequency (i.e., $\omega_{0}$ ); otherwise the resulting waveform will not be a simple sinusoid.

An intuitive feeling for the Barkhausen criterion can be gained by considering once more the feedback loop of Fig. 18.1. For this loop to produce and sustain an output $x_{o}$ with no input applied $\left(x_{s}=0\right)$, the feedback signal $x_{f}$,

$$
x_{f}=\beta x_{o}
$$

should be sufficiently large that when multiplied by $A$ it produces $x_{o}$, that is,

$$
A x_{f}=x_{o}
$$

that is,

$$
A \beta x_{o}=x_{o}
$$

which results in

$$
A \beta=1
$$

It should be noted that the frequency of oscillation $\omega_{0}$ is determined solely by the phase characteristics of the feedback loop; the loop oscillates at the frequency for which the phase is zero (or, equivalently, $360^{\circ}$ ). It follows that the stability of the frequency of oscillation will be determined by the manner in which the phase $\phi(\omega)$ of the feedback loop varies with frequency. A "steep" function $\phi(\omega)$ will result in a more stable frequency. This can be seen if one imagines a change in phase $\Delta \phi$ due to a change in one of the circuit components. If $d \phi / d \omega$ is large, the resulting change in $\omega_{0}$ will be small, as illustrated in Fig. 18.2.# Example 2.7 continued 

(d) For $V_{e}=1 \mathrm{~V}$ and $R_{L}$ reduced, the lowest value possible for $R_{L}$ while the output is remaining an undistorted sine wave of $10-\mathrm{V}$ peak can be found from

$$
i_{O \max }=20 \mathrm{~mA}=\frac{10 \mathrm{~V}}{R_{L \min }}+\frac{10 \mathrm{~V}}{9 \mathrm{k} \Omega+1 \mathrm{k} \Omega}
$$

which results in

$$
R_{L \min }=526 \Omega
$$

### 2.8.3 Slew Rate

Another phenomenon that can cause nonlinear distortion when large output signals are present is slew-rate limiting. The name refers to the fact that there is a specific maximum rate of change possible at the output of a real op amp. This maximum is known as the slew rate (SR) of the op amp and is defined as

$$
\mathrm{SR}=\left.\frac{d v_{o}}{d t}\right|_{\max }
$$

and is usually specified on the op-amp data sheet in units of $\mathrm{V} / \mu \mathrm{s}$. It follows that if the input signal applied to an op-amp circuit is such that it demands an output response that is faster than the specified value of SR, the op amp will not comply. Rather, its output will change at the maximum possible rate, which is equal to its SR. As an example, consider an op amp connected in the unity-gain voltage-follower configuration shown in Fig. 2.43(a), and let the input signal be the step voltage shown in Fig. 2.43(b). The output of the op amp will not be able to rise instantaneously to the ideal value $V$; rather, the output will be the linear ramp of slope equal to SR, shown in Fig. 2.43(c). The amplifier is then said to be slewing, and its output is slew-rate limited.

In order to understand the origin of the slew-rate phenomenon, we need to know about the internal circuit of the op amp, and we will study it in Chapter 13. For the time being, however, it is sufficient to know about the phenomenon and to note that it is distinct from the finite op-amp bandwidth that limits the frequency response of the closed-loop amplifiers, studied in the previous section. The limited bandwidth is a linear phenomenon and does not result in a change in the shape of an input sinusoid; that is, it does not lead to nonlinear distortion. The slew-rate limitation, on the other hand, can cause nonlinear distortion to an input sinusoidal signal when its frequency and amplitude are such that the corresponding ideal output would require $v_{o}$ to change at a rate greater than SR. This is the origin of another related op-amp specification, its full-power bandwidth, to be explained later.

Before leaving the example in Fig. 2.43, however, we should point out that if the step input voltage $V$ is sufficiently small, the output can be the exponentially rising ramp shown


Figure 2.43 (a) Unity-gain follower. (b) Input step waveform. (c) Linearly rising output waveform obtained when the amplifier is slew-rate limited. (d) Exponentially rising output waveform obtained when $V$ is sufficiently small so that the initial slope $\left(\omega_{i} V\right)$ is smaller than or equal to SR.
in Fig. 2.43(d). Such an output would be expected from the follower if the only limitation on its dynamic performance were the finite op-amp bandwidth. Specifically, the transfer function of the follower can be found by substituting $R_{1}=\infty$ and $R_{2}=0$ in Eq. (2.55) to obtain

$$
\frac{V_{o}}{V_{i}}=\frac{1}{1+s / \omega_{t}}
$$

which is a low-pass STC response with a time constant $1 / \omega_{t}$. Its step response would therefore be (see Appendix E)

$$
v_{o}(t)=V\left(1-e^{-\omega_{t} t}\right)
$$

The initial slope of this exponentially rising function is $\left(\omega_{i} V\right)$. Thus, as long as $V$ is sufficiently small so that $\omega_{t} V \leq \mathrm{SR}$, the output will be as in Fig. 2.43(d).
# EXERCISE 

2.29 An op amp that has a slew rate of $1 \mathrm{~V} / \mu \mathrm{s}$ and a unity-gain bandwidth $f_{i}$ of 1 MHz is connected in the unity-gain follower configuration. Find the largest possible input voltage step for which the output waveform will still be given by the exponential ramp of Eq. (2.58). For this input voltage, what is the $10 \%$ to $90 \%$ rise time of the output waveform? If an input step 10 times as large is applied, find the $10 \%$ to $90 \%$ rise time of the output waveform.
Ans. $0.16 \mathrm{~V} ; 0.35 \mu \mathrm{~s} ; 1.28 \mu \mathrm{~s}$

### 2.8.4 Full-Power Bandwidth

Op-amp slew-rate limiting can cause nonlinear distortion in sinusoidal waveforms. Consider once more the unity-gain follower with a sine-wave input given by

$$
v_{I}=\hat{V}_{i} \sin \omega t
$$

The rate of change of this waveform is given by

$$
\frac{d v_{I}}{d t}=\omega \hat{V}_{i} \cos \omega t
$$

with a maximum value of $\omega \hat{V}_{i}$. This maximum occurs at the zero crossings of the input sinusoid. Now if $\omega \hat{V}_{i}$ exceeds the slew rate of the op amp, the output waveform will be distorted in the manner shown in Fig. 2.44. Observe that the output cannot keep up with the large rate of change of the sinusoid at its zero crossings, and the op amp slews.

The op-amp data sheets usually specify a frequency $f_{M}$ called the full-power bandwidth. It is the frequency at which an output sinusoid with amplitude equal to the rated output voltage of the op amp begins to show distortion due to slew-rate limiting. If we denote the rated output


Figure 2.44 Effect of slew-rate limiting on output sinusoidal waveforms.
voltage $V_{o \text { max }}$, then $f_{M}$ is related to SR as follows:

$$
\omega_{M} V_{o \max }=\mathrm{SR}
$$

Thus,

$$
f_{M}=\frac{\mathrm{SR}}{2 \pi V_{o \max }}
$$

It should be obvious that output sinusoids of amplitudes smaller than $V_{o \text { max }}$ will show slew-rate distortion at frequencies higher than $\omega_{M}$. In fact, at a frequency $\omega$ higher than $\omega_{M}$, the maximum amplitude of the undistorted output sinusoid is given by

$$
V_{o}=V_{o \max }\left(\frac{\omega_{M}}{\omega}\right)
$$

# EXERCISE 

2.30 An op amp has a rated output voltage of $\pm 10 \mathrm{~V}$ and a slew rate of $1 \mathrm{~V} / \mu \mathrm{s}$. What is its full-power bandwidth? If an input sinusoid with frequency $f=5 f_{M}$ is applied to a unity-gain follower constructed using this op amp, what is the maximum possible amplitude that can be accommodated at the output without incurring SR distortion?
Ans. $15.9 \mathrm{kHz} ; 2 \mathrm{~V}$ (peak)

## Summary

- The IC op amp is a versatile circuit building block. It is easy to apply, and the performance of op-amp circuits closely matches theoretical predictions.
- The op-amp terminals are the inverting input terminal (1), the noninverting input terminal (2), the output terminal (3), the positive-supply terminal (4) to be connected to the positive power supply $\left(V_{C C}\right)$, and the negative-supply terminal (5) to be connected to the negative supply $\left(-V_{E E}\right)$. The common terminal of the two supplies is the circuit ground.
- The ideal op amp responds only to the difference input signal, that is, $\left(v_{3}-v_{1}\right)$; it provides at the output, between terminal 3 and ground, a signal $A\left(v_{3}-v_{1}\right)$, where $A$, the open-loop gain, is very large ( $10^{5}$ to $10^{6}$ ) and ideally infinite; and it has an infinite input resistance and a zero output resistance. (See Table 2.1.)
- Negative feedback is applied to an op amp by connecting a passive component between its output terminal and its inverting (negative) input terminal. Negative feedback
causes the voltage between the two input terminals to become very small and ideally zero. Correspondingly, a virtual short circuit is said to exist between the two input terminals. If the positive input terminal is connected to ground, a virtual ground appears on the negative input terminal.
- The two most important assumptions in the analysis of op-amp circuits, presuming negative feedback exists and the op amps are ideal, are as follows: the two input terminals of the op amp are at the same voltage, and zero current flows into the op-amp input terminals.
- With negative feedback applied and the loop closed, the closed-loop gain is almost entirely determined by external components: For the inverting configuration, $V_{o} / V_{i}=-R_{2} / R_{1}$; and for the noninverting configuration, $V_{o} / V_{i}=1+R_{2} / R_{1}$.
- The noninverting closed-loop configuration features a very high input resistance. A special case is the unity-gain
follower, frequently employed as a buffer amplifier to connect a high-resistance source to a low-resistance load.

- The difference amplifier of Fig. 2.16 is designed with $R_{4} / R_{3}=R_{2} / R_{1}$, resulting in $v_{D}=\left(R_{2} / R_{1}\right)\left(v_{I 2}-v_{I 1}\right)$.
- The instrumentation amplifier of Fig. 2.20(b) is a very popular circuit. It provides $v_{D}=\left(1+R_{2} / R_{1}\right)\left(R_{4} / R_{3}\right)$ $\left(v_{I 2}-v_{I 1}\right)$. It is usually designed with $R_{2}=R_{4}$, and $R_{1}$ and $R_{2}$ selected to provide the required gain. If an adjustable gain is needed, part of $R_{1}$ can be made variable.
- The inverting Miller integrator of Fig. 2.24(a) is a popular circuit, frequently employed in analog signal-processing functions such as filters (Chapter 17) and oscillators (Chapter 18).
- The input offset voltage, $V_{O S}$, is the magnitude of dc voltage that when applied between the op-amp input terminals, with appropriate polarity, reduces the dc offset voltage at the output to zero.
- The effect of $V_{O S}$ on performance can be evaluated by including in the analysis a dc source $V_{O S}$ in series with the op-amp positive input lead. For both the inverting and the noninverting configurations, $V_{O S}$ results in a dc offset voltage at the output of $V_{O S}\left(1+R_{2} / R_{1}\right)$.
- Capacitively coupling an op amp reduces the dc offset voltage at the output considerably.
- The average of the two dc currents, $I_{B 1}$ and $I_{B 2}$, that flow in the input terminals of the op amp, is called the
input bias current, $I_{B}$. In a closed-loop amplifier, $I_{B}$ gives rise to a dc offset voltage at the output of magnitude $I_{B} R_{2}$. This voltage can be reduced to $I_{O S} R_{2}$ by connecting a resistance in series with the positive input terminal equal to the total dc resistance seen by the negative input terminal. $I_{O S}$ is the input offset current; that is, $I_{O S}=\left|I_{B 1}-I_{B 2}\right|$.
- Connecting a large resistance in parallel with the capacitor of an op-amp inverting integrator prevents op-amp saturation (due to the effect of $V_{O S}$ and $I_{B}$ ).
- For most internally compensated op amps, the open-loop gain falls off with frequency at a rate of -20 dB /decade, reaching unity at a frequency $f_{i}$ (the unity-gain bandwidth). Frequency $f_{i}$ is also known as the gain-bandwidth product of the op amp: $f_{i}=A_{0} f_{b}$, where $A_{0}$ is the dc gain, and $f_{b}$ is the 3-dB frequency of the open-loop gain. At any frequency $f\left(f \gg f_{b}\right)$, the op-amp gain $|A| \simeq f_{i} / f$.
- For both the inverting and the noninverting closedloop configurations, the 3-dB frequency is equal to $f_{i} /\left(1+R_{2} / R_{1}\right)$.
- The maximum rate at which the op-amp output voltage can change is called the slew rate. The slew rate, SR, is usually specified in $\mathrm{V} / \mu s$. Op-amp slewing can result in nonlinear distortion of output signal waveforms.
- The full-power bandwidth, $f_{M}$, is the maximum frequency at which an output sinusoid with an amplitude equal to the op-amp rated output voltage $\left(V_{o \max }\right)$ can be produced without distortion: $f_{M}=\operatorname{SR} / 2 \pi V_{o \text { max }}$.


# PROBLEMS 

## Computer Simulation Problems

SIIC Problems identified by the Multisim/PSpice icon are intended to demonstrate the value of using SPICE simulation to verify hand analysis and design, and to investigate important issues such as allowable signal swing and amplifier nonlinear distortion. Instructions to assist in setting up PSPice and Multisim simulations for all the indicated problems can be found in the corresponding files on the website. Note that if a particular parameter value is not specified
in the problem statement, you are to make a reasonable assumption.

## Section 2.1: The Ideal Op Amp

2.1 What is the minimum number of pins required for a so-called dual-op-amp IC package, one containing two op amps? What is the number of pins required for a so-called quad-op-amp package, one containing four op-amps?
2.2 The circuit of Fig. P2.2 uses an op amp that is ideal except for having a finite gain $A$. Measurements indicate $v_{O}=4.0 \mathrm{~V}$ when $v_{I}=1.0 \mathrm{~V}$. What is the op-amp gain $A$ ?


Figure P2.2
2.3 Measurement of a circuit incorporating what is thought to be an ideal op amp shows the voltage at the op-amp output to be -2.000 V and that at the negative input to be -1.000 V . For the amplifier to be ideal, what would you expect the voltage at the positive input to be? If the measured voltage at the positive input is -1.005 V , what is likely to be the actual gain of the amplifier?
2.4 A set of experiments is run on an op amp that is ideal except for having a finite gain $A$. The results are tabulated below. Are the results consistent? If not, are they reasonable, in view of the possibility of experimental error? What do they show the gain to be? Using this value, predict values of the measurements that were accidentally omitted (the blank entries).

| Experiment \# | $\boldsymbol{v}_{\mathbf{1}}$ | $\boldsymbol{v}_{\mathbf{2}}$ | $\boldsymbol{v}_{\boldsymbol{O}}$ |
| :--: | :--: | :--: | :--: |
| 1 | 0.00 | 0.00 | 0.00 |
| 2 | 1.00 | 1.00 | 0.00 |
| 3 |  | 1.00 | 1.00 |
| 4 | 1.00 | 1.10 | 10.1 |
| 5 | 2.01 | 2.00 | -0.99 |
| 6 | 1.99 | 2.00 | 1.00 |
| 7 | 5.10 |  | -5.10 |

2.5 Refer to Exercise 2.3. This problem explores an alternative internal structure for the op amp. In particular, we wish to model the internal structure of a particular op amp using two transconductance amplifiers and one transresistance amplifier. Suggest an appropriate topology.

For equal transconductances $G_{m}$ and a transresistance $R_{m}$, find an expression for the open-loop gain $A$. For $G_{m}=40 \mathrm{~mA} / \mathrm{V}$ and $R_{m}=1 \times 10^{6} \Omega$, what value of $A$ results?
2.6 The two wires leading from the output terminals of a transducer pick up an interference signal that is a $60-\mathrm{Hz}, 2-\mathrm{V}$ sinusoid. The output signal of the transducer is sinusoidal of $5-\mathrm{mV}$ amplitude and $1000-\mathrm{Hz}$ frequency. Give expressions for $v_{c m}, v_{d}$, and the total signal between each wire and the system ground.
2.7 Nonideal (i.e., real) operational amplifiers respond to both the differential and common-mode components of their input signals (refer to Fig. 2.4 for signal representation). Thus the output voltage of the op amp can be expressed as

$$
v_{O}=A_{d} v_{k d}+A_{c m} v_{k c m}
$$

where $A_{d}$ is the differential gain (referred to simply as $A$ in the text) and $A_{c m}$ is the common-mode gain (assumed to be zero in the text). The op amp's effectiveness in rejecting common-mode signals is measured by its CMRR, defined as

$$
\mathrm{CMRR}=20 \log \left|\frac{A_{d}}{A_{c m}}\right|
$$

Consider an op amp whose internal structure is of the type shown in Fig. E2.3 except for a mismatch $\Delta G_{m}$ between the transconductances of the two channels; that is,

$$
\begin{aligned}
& G_{m 1}=G_{m}-\frac{1}{2} \Delta G_{m} \\
& G_{m 2}=G_{m}+\frac{1}{2} \Delta G_{m}
\end{aligned}
$$

Find expressions for $A_{d}, A_{c m}$, and CMRR. What is the maximum permitted percentage mismatch between the two $G_{m}$ values if a minimum CMRR of 60 dB is required?

## Section 2.2: The Inverting Configuration

2.8 Assuming ideal op amps, find the voltage gain $v_{s} / v_{i}$ and input resistance $R_{\mathrm{in}}$ of each of the circuits in Fig. P2.8.
2.9 A particular inverting circuit uses an ideal op amp and two $10-\mathrm{k} \Omega$ resistors. What closed-loop gain would you expect? If a dc voltage of +1.00 V is applied at the input, what outputs result? If the $10-\mathrm{k} \Omega$ resistors are said to be " $1 \%$ resistors," having values somewhere in the range ( $1 \pm 0.01$ ) times the nominal value, what range of outputs would you expect to actually measure for an input of precisely 1.00 V ?

[^0]
[^0]:    318 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem


Figure P2.8
2.10 You are provided with an ideal op amp and three $10-\mathrm{k} \Omega$ resistors. Using series and parallel resistor combinations, how many different inverting-amplifier circuit topologies are possible? What is the largest (noninfinite) available voltage gain magnitude? What is the smallest (nonzero) available gain magnitude? What are the input resistances in these two cases?

S10 2.11 For ideal op amps operating with the following feedback networks in the inverting configuration, what closed-loop gain results?
(a) $R_{1}=10 \mathrm{k} \Omega, R_{2}=10 \mathrm{k} \Omega$
(b) $R_{1}=10 \mathrm{k} \Omega, R_{2}=100 \mathrm{k} \Omega$
(c) $R_{1}=10 \mathrm{k} \Omega, R_{2}=1 \mathrm{k} \Omega$
(d) $R_{1}=100 \mathrm{k} \Omega, R_{2}=10 \mathrm{M} \Omega$
(e) $R_{1}=100 \mathrm{k} \Omega, R_{2}=1 \mathrm{M} \Omega$

D 2.12 Given an ideal op amp, what are the values of the resistors $R_{1}$ and $R_{2}$ to be used to design amplifiers with the closed-loop gains listed below? In your designs, use at least one $10-\mathrm{k} \Omega$ resistor and another equal or larger resistor.
(a) $-1 \mathrm{~V} / \mathrm{V}$
(b) $-2 \mathrm{~V} / \mathrm{V}$
(c) $-5 \mathrm{~V} / \mathrm{V}$
(d) $-100 \mathrm{~V} / \mathrm{V}$

D 2.13 Design an inverting op-amp circuit for which the gain is $-10 \mathrm{~V} / \mathrm{V}$ and the total resistance used is $110 \mathrm{k} \Omega$.

D 2.14 Using the circuit of Fig. 2.5 and assuming an ideal op amp, design an inverting amplifier with a gain of 46 dB having the largest possible input resistance under the constraint of having to use resistors no larger than $1 \mathrm{M} \Omega$. What is the input resistance of your design?
2.15 An ideal op amp is connected as shown in Fig. 2.5 with $R_{1}=10 \mathrm{k} \Omega$ and $R_{2}=100 \mathrm{k} \Omega$. A symmetrical square-wave signal with levels of 0 V and -1 V is applied at the input. Sketch and clearly label the waveform of the resulting output voltage. What is its average value? What is its highest value? What is its lowest value?
2.16 For the circuit in Fig. P2.16, assuming an ideal op amp, find the currents through all branches and the voltages at all nodes. Since the current supplied by the op amp is greater than the current drawn from the input signal source, where does the additional current come from?


Figure P2.16
2.17 An inverting op-amp circuit is fabricated with the resistors $R_{1}$ and $R_{2}$ having $x \%$ tolerance (i.e., the value of each resistance can deviate from the nominal value by as much as $\pm x \%)$. What is the tolerance on the realized closed-loop gain? Assume the op amp to be ideal. If the nominal closed-loop gain is $-100 \mathrm{~V} / \mathrm{V}$ and $x=1$, what is the range of gain values expected from such a circuit?
2.18 An ideal op amp with $5-\mathrm{k} \Omega$ and $15-\mathrm{k} \Omega$ resistors is used to create a $+5-\mathrm{V}$ supply from a $-15-\mathrm{V}$ reference. Sketch the circuit. What are the voltages at the ends of the $5-\mathrm{k} \Omega$ resistor? If these resistors are so-called $1 \%$ resistors, whose actual values are the range bounded by the nominal value $\pm 1 \%$, what are the limits of the output voltage produced? If the $-15-\mathrm{V}$ supply can also vary by $\pm 1 \%$, what is the range of the output voltages that might be found?
2.19 An inverting op-amp circuit for which the required gain is $-50 \mathrm{~V} / \mathrm{V}$ uses an op amp whose open-loop gain is only $500 \mathrm{~V} / \mathrm{V}$. If the larger resistor used is $100 \mathrm{k} \Omega$, to what must the smaller be adjusted? With what resistor must a $2-\mathrm{k} \Omega$ resistor connected to the input be shunted to achieve this goal? (Note that a resistor $R_{a}$ is said to be shunted by resistor $R_{b}$ when $R_{b}$ is placed in parallel with $R_{a}$.)
D 2.20 (a) Design an inverting amplifier with a closed-loop gain of $-200 \mathrm{~V} / \mathrm{V}$ and an input resistance of $1 \mathrm{k} \Omega$.
(b) If the op amp is known to have an open-loop gain of 5000 $\mathrm{V} / \mathrm{V}$, what do you expect the closed-loop gain of your circuit to be (assuming the resistors have precise values)?
(c) Give the value of a resistor you can place in parallel (shunt) with $R_{1}$ to restore the closed-loop gain to its nominal value. Use the closest standard $1 \%$ resistor value (see Appendix J).
2.21 An op amp with an open-loop gain of $5000 \mathrm{~V} / \mathrm{V}$ is used in the inverting configuration. If in this application the output
voltage ranges from -10 V to +10 V , what is the maximum voltage by which the "virtual ground node" departs from its ideal value?
2.22 The circuit in Fig. P2.22 is frequently used to provide an output voltage $v_{o}$ proportional to an input signal current $i_{i}$.


Figure P2.22
Derive expressions for the transresistance $R_{\mathrm{m}} \equiv v_{o} / i_{i}$ and the input resistance $R_{i} \equiv v_{i} / i_{i}$ for the following cases:
(a) $A$ is infinite.
(b) $A$ is finite.
2.23 Show that for the inverting amplifier if the op-amp gain is $A$, the input resistance is given by

$$
R_{\mathrm{in}}=R_{1}+\frac{R_{2}}{A+1}
$$

2.24 For an inverting amplifier with nominal closed-loop gain $R_{2} / R_{1}$, find the minimum value that the op-amp open-loop gain $A$ must have (in terms of $R_{2} / R_{1}$ ) so that the gain error (due to the finite $A$ ) is limited to $0.1 \%, 1 \%$, and $10 \%$. In each case find the value of a resistor $R_{k e}$ such that when it is placed in shunt with $R_{1}$, the gain is restored to its nominal value.
*2.25 Figure P2.25 shows an op amp that is ideal except for having a finite open-loop gain and is used to realize an inverting amplifier whose gain has a nominal magnitude $G=R_{2} / R_{1}$. To compensate for the gain reduction due to


Figure P2.25
the finite $A$, a resistor $R_{c}$ is shunted across $R_{1}$. Show that perfect compensation is achieved when $R_{c}$ is selected according to

$$
\frac{R_{c}}{R_{1}}=\frac{A-G}{1+G}
$$

D *2.26 (a) Use Eq. (2.5) to obtain the amplifier open-loop gain $A$ required to realize a specified closed-loop gain $\left(G_{\text {nominal }}=-R_{2} / R_{1}\right)$ within a specified gain error $\epsilon$,

$$
\epsilon \equiv\left|\frac{G-G_{\text {nominal }}}{G_{\text {nominal }}}\right|
$$

(b) Design an inverting amplifer for a nominal closed-loop gain of -100 , an input resistance of $1 \mathrm{k} \Omega$, and a gain error of $\leq 10 \%$. Specify $R_{1}, R_{2}$, and the minimum $A$ required.
*2.27 (a) Use Eq. (2.5) to show that a reduction $\Delta A$ in the op-amp gain $A$ gives rise to a reduction $\Delta|G|$ in the magnitude of the closed-loop gain $G$ with $\Delta|G|$ and $\Delta A$ related by

$$
\frac{\Delta|G| /|G|}{\Delta A / A} \simeq \frac{1+R_{2} / R_{1}}{A}
$$

Assume that $\left(1+\frac{R_{2}}{R_{1}}\right) \ll A$ and $\frac{\Delta A}{A} \ll 1$.
(b) If in a closed-loop amplifier with a nominal gain (i.e., $R_{2} / R_{1}$ ) of $100, A$ decreases by $10 \%$, what is the minimum nominal $A$ required to limit the percentage change in $|G|$ to $0.1 \%$ ?
2.28 Consider the circuit in Fig. 2.8 with $R_{1}=R_{2}=R_{4}=$ $1 \mathrm{M} \Omega$, and assume the op amp to be ideal. Find values for $R_{3}$ to obtain the following gains:
(a) $-100 \mathrm{~V} / \mathrm{V}$
(b) $-10 \mathrm{~V} / \mathrm{V}$
(c) $-2 \mathrm{~V} / \mathrm{V}$

D 2.29 An inverting op-amp circuit using an ideal op amp must be designed to have a gain of $-500 \mathrm{~V} / \mathrm{V}$ using resistors no larger than $100 \mathrm{k} \Omega$.
(a) For the simple two-resistor circuit, what input resistance would result?
(b) If the circuit in Fig. 2.8 is used with three resistors of maximum value, what input resistance results? What is the value of the smallest resistor needed?
2.30 The inverting circuit with the T network in the feedback is redrawn in Fig. P2.30 in a way that emphasizes the observation that $R_{2}$ and $R_{3}$ in effect are in parallel (because the ideal op amp forces a virtual ground at the inverting input terminal). Use this observation to derive an expression for the gain $\left(v_{0} / v_{I}\right)$ by first finding $\left(v_{g} / v_{I}\right)$ and $\left(v_{0} / v_{g}\right)$. For the latter use the voltage-divider rule applied to $R_{4}$ and $\left(R_{2} \| R_{3}\right)$.


Figure P2.30
*2.31 The circuit in Fig. P2.31 can be considered to be an extension of the circuit in Fig. 2.8.
(a) Find the resistances looking into node $1, R_{1}$; node $2, R_{2}$; node $3, R_{3}$; and node $4, R_{4}$.


Figure P2.31

[^0]
[^0]:    218 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
(b) Find the currents $I_{1}, I_{2}, I_{3}$, and $I_{4}$, in terms of the input current $I$.
(c) Find the voltages at nodes $1,2,3$, and 4 , that is, $V_{1}, V_{2}$, $V_{3}$, and $V_{4}$ in terms of $(I R)$.
2.32 The circuit in Fig. P2.32 utilizes an ideal op amp.
(a) Find $I_{1}, I_{2}, I_{3}, I_{L}$, and $V_{s}$.
(b) If $V_{O}$ is not to be lower than -13 V , find the maximum allowed value for $R_{L}$.
(c) If $R_{L}$ is varied in the range $100 \Omega$ to $1 \mathrm{k} \Omega$, what is the corresponding change in $I_{L}$ and in $V_{O}$ ?


Figure P2.32

D 2.33 Use the circuit in Fig. P2.32 as an inspiration to design a circuit that supplies a constant current $I_{L}$ of 3.1 mA to a variable resistance $R_{L}$. Assume the availability of a $1.5-\mathrm{V}$ battery and design so that the current drawn from the battery is 0.1 mA . For the smallest resistance in the circuit, use $500 \Omega$. If the op amp saturates at $\pm 10 \mathrm{~V}$, what is the maximum value that $R_{L}$ can have while the current source supplying it operates properly?

D 2.34 Assuming the op amp to be ideal, it is required to design the circuit shown in Fig. P2.34 to implement a current amplifier with gain $i_{L} / i_{I}=11 \mathrm{~A} / \mathrm{A}$.
(a) Find the required value for $R$.
(b) What are the input and the output resistance of this current amplifier?
(c) If $R_{L}=1 \mathrm{k} \Omega$ and the op amp operates in an ideal manner as long as $v_{O}$ is in the range $\pm 12 \mathrm{~V}$, what range of $i_{I}$ is possible?
(d) If the amplifier is fed with a current source having a current of 0.2 mA and a source resistance of $10 \mathrm{k} \Omega$, find $i_{L}$.


Figure P2.34

D 2.35 Design the circuit shown in Fig. P2.35 to have an input resistance of $100 \mathrm{k} \Omega$ and a gain that can be varied from $-1 \mathrm{~V} / \mathrm{V}$ to $-100 \mathrm{~V} / \mathrm{V}$ using the $100-\mathrm{k} \Omega$ potentiometer $R_{4}$. What voltage gain results when the potentiometer is set exactly at its middle value?


Figure P2.35
2.36 A weighted summer circuit using an ideal op amp has three inputs using $10-\mathrm{k} \Omega$ resistors and a feedback resistor of $50 \mathrm{k} \Omega$. A signal $v_{1}$ is connected to two of the inputs while a signal $v_{2}$ is connected to the third. Express $v_{O}$ in terms of $v_{1}$ and $v_{2}$. If $v_{1}=1 \mathrm{~V}$ and $v_{2}=-1 \mathrm{~V}$, what is $v_{O}$ ?

D 2.37 Design an op-amp circuit to provide an output $v_{O}=-\left[2 v_{1}+\left(v_{2} / 2\right)\right]$. Choose relatively low values of resistors but ones for which the input current (from each input signal source) does not exceed $50 \mu \mathrm{~A}$ for $1-\mathrm{V}$ input signals.

D 2.38 Use the scheme illustrated in Fig. 2.10 to design an op-amp circuit with inputs $v_{1}, v_{2}$, and $v_{3}$, whose output is

Figure 18.2 Dependence of the oscillator-frequency stability on the slope of the phase response. A steep phase response (i.e., large $d \phi / d \omega$ ) results in a small $\Delta \omega_{0}$ for a given change in phase $\Delta \phi$ [resulting from a change (due, for example, to temperature) in a circuit component].

An alternative approach to the study of oscillator circuits consists of examining the circuit poles, which are the roots of the characteristic equation (Eq. 18.3). For the circuit to produce sustained oscillations at a frequency $\omega_{0}$ the characteristic equation has to have roots at $s= \pm j \omega_{0}$. Thus $1-A(s) \beta(s)$ should have a factor of the form $s^{2}+\omega_{0}^{2}$.

# EXERCISE 

18.1 Consider a sinusoidal oscillator formed by connecting an amplifier with a gain of 2 and a second-order bandpass filter in a feedback loop. Find the pole frequency and the center-frequency gain of the filter needed to produce sustained oscillations at 1 kHz .
Ans. $1 \mathrm{kHz} ; 0.5$

### 18.1.3 Analysis of Oscillator Circuits

Analysis of a given oscillator circuit to determine the frequency of oscillation and the condition for the oscillations to start proceeds in three steps:

1. Break the feedback loop to determine the loop gain $A(s) \beta(s)$. This step is similar to that utilized in Section 11.2 in the analysis of negative-feedback amplifiers.
2. The oscillation frequency $\omega_{0}$ is found as the frequency for which the phase angle of $A(j \omega) \beta(j \omega)$ is zero or, equivalently, $360^{\circ}$.
3. The condition for the oscillations to start is found from

$$
\left|A\left(j \omega_{0}\right) \beta\left(j \omega_{0}\right)\right| \geq 1
$$

Note that making the magnitude of the loop gain slightly greater than unity ensures that oscillations will start.
# Example 18.1 

Figure 18.3(a) shows a sinusoidal oscillator formed by placing a second-order LCR bandpass filter [see Fig. 17.18(d)] in the feedback path of a positive-gain amplifier. Find the frequency of oscillation $\omega_{0}$, and the condition for oscillations to start. Assume an ideal op amp.

## Solution

To obtain the loop gain, we break the positive-feedback loop at the positive input terminal of the op amp where the input impedance is infinite, apply an input voltage $V_{i}$, and find the returned voltage $V_{r}$. This results in the circuit in Fig. 18.3(b). Since the op amp is ideal, we can find its output voltage $V_{o}$ and hence $A(s)$ as

$$
A(s) \equiv \frac{V_{o}}{V_{i}}=1+\frac{r_{2}}{r_{1}}
$$

The transfer function of the frequency-selective network $\beta(s) \equiv V_{i} / V_{o}$ can be found utilizing Eq. (17.39) as

$$
\beta(s) \equiv \frac{V_{r}}{V_{o}}=\frac{s \frac{1}{C R}}{s^{2}+s \frac{1}{C R}+\frac{1}{L C}}
$$

While we have found it easy to determine $A(s)$ and $\beta(s)$ separately, our interest is in fact in their product, the loop gain $A(s) \beta(s)$,

$$
A(s) \beta(s)=\frac{s \frac{1}{C R}\left(1+\frac{r_{2}}{r_{1}}\right)}{s^{2}+s \frac{1}{C R}+\frac{1}{L C}}
$$



Figure 18.3 (a) An oscillator formed by connecting a positive-gain amplifier in a feedback loop with a bandpass RLC circuit. (b) Breaking the feedback loop at the input of the op amp to determine $A(s) \equiv V_{o}(s) / V_{i}(s)$ and $\beta(s) \equiv V_{r}(s) / V_{o}(s)$, and hence the loop gain $A(s) \beta(s)$.
# Example 18.1 continued 

Substituting $s=j \omega$,

$$
A(j \omega) \beta(j \omega)=\frac{j \frac{\omega}{C R}\left(1+\frac{r_{2}}{r_{1}}\right)}{\left(-\omega^{2}+\frac{1}{L C}\right)+j \frac{\omega}{C R}}
$$

From this expression we see that the phase angle of $A(j \omega) \beta(j \omega)$ will be zero at the value of $\omega$ that makes the real part of the denominator zero, thus

$$
\omega_{0}=1 / \sqrt{L C}
$$

At this frequency, the magnitude of the loop gain is given by

$$
\left|A\left(j \omega_{0}\right) \beta\left(j \omega_{0}\right)\right|=1+\frac{r_{2}}{r_{1}}
$$

Thus oscillation will start for

$$
r_{2} / r_{1} \geq 0
$$

While $r_{2}=0$ is theoretically sufficient for sustained oscillations, it is usual to design for $r_{2} / r_{1}>0$ to ensure that oscillations start. This point will be explained in greater detail in the next section.

Before leaving this example, we observe that the results could have been obtained by inspection of the circuit in Fig. 18.3(a). Since the phase angle of the amplifier gain is zero, we examine the LCR bandpass circuit to determine the frequency at which its phase is zero. This in turn is the frequency at which the LC tank has an infinite impedance, which is the resonance frequency $\omega_{0}=1 / \sqrt{L C}$. At this frequency the transmission of the bandpass LCR circuit is unity. Thus for oscillation to start, the amplifier gain must be greater than or equal to unity.

An Alternative Analysis Approach There is a simple alternative approach for the analysis of oscillator circuits that does not involve breaking the feedback loop. The method proceeds as follows: We assume that the circuit is oscillating and thus has voltage and current signals at the oscillation frequency $\omega_{0}$. We analyze the circuit in the usual manner and reduce the equations to a single equation in terms of a single voltage or current variable. Since the voltage or current quantity is not zero (because the circuit is assumed to be oscillating), we can divide by the variable and thus eliminate it. The equation can then be manipulated to the form

$$
D(s)=0
$$

where $D(s)$ is a polynomial in $s$. Substituting $s=j \omega$, we then equate the real and imaginary parts of $D(j \omega)$ to zero. One of the resulting equations yields $\omega_{0}$ and the other provides the condition for sustained oscillation. This method will be utilized on numerous occasions in the next sections.
# EXERCISE 

18.2 Apply the alternative analysis method to the circuit of Fig. 18.3(a) and thus determine $D(s), \operatorname{Re}[D(j \omega)]$, $\operatorname{Im}[D(j \omega)], \omega_{0}$, and the condition for sustained oscillation.
Ans. $D(s)=s^{2}-s \frac{1}{C R} \frac{r_{2}}{r_{1}}+\frac{1}{L C} ;-\omega^{2}+\frac{1}{L C} ;-\frac{\omega}{C R} \frac{r_{2}}{r_{1}} ; 1 / \sqrt{L C} ; r_{2}=0$

### 18.1.4 Nonlinear Amplitude Control

The oscillation condition, the Barkhausen criterion, discussed in Section 18.1.2, guarantees sustained oscillations in a mathematical sense. It is well known, however, that the parameters of any physical system cannot be maintained constant for any length of time. In other words, suppose we work hard to make $|A \beta|=1$ at $\omega=\omega_{0}$, and then the temperature changes and $|A \beta|$ becomes slightly less than unity. Obviously, oscillations will cease in this case. Conversely, if $|A \beta|$ exceeds unity, oscillations will grow in amplitude. We therefore need a mechanism for forcing $|A \beta|$ to remain equal to unity at the desired value of output amplitude. This task is accomplished by providing a nonlinear circuit for gain control.

Basically, the function of the gain-control mechanism is as follows: First, to ensure that oscillations will start, one designs the circuit such that $|A \beta|$ is slightly greater than unity. This corresponds to designing the circuit so that the poles are in the right half of the $s$ plane. Thus as the power supply is turned on, oscillations will grow in amplitude. When the amplitude reaches the desired level, the nonlinear network comes into action and causes the loop gain to be reduced to exactly unity. In other words, the poles will be "pulled back" to the $j \omega$ axis. This action will cause the circuit to sustain oscillations at this desired amplitude. If, for some reason, the loop gain is reduced below unity, the amplitude of the sine wave will diminish. This will be detected by the nonlinear network, which will cause the loop gain to increase to exactly unity.

As will be seen, there are two basic approaches to the implementation of the nonlinear amplitude-stabilization mechanism. The first approach makes use of a limiter circuit (see Section 4.6). Oscillations are allowed to grow until the amplitude reaches the level to which the limiter is set. When the limiter comes into operation, the amplitude remains constant. Obviously, the limiter should be "soft" to minimize nonlinear distortion. Such distortion, however, is reduced by the filtering action of the frequency-selective network in the feedback loop. In fact, in one of the oscillator circuits studied in Section 18.2, the sine waves are hard limited, and the resulting square waves are applied to a bandpass filter present in the feedback loop. The "purity" of the output sine waves will be a function of the selectivity of this filter. That is, the higher the $Q$ of the filter, the less the harmonic content of the sine-wave output.

The other mechanism for amplitude control utilizes an element whose resistance can be controlled by the amplitude of the output sinusoid. By placing this element in the feedback circuit so that its resistance determines the loop gain, the circuit can be designed to ensure that the loop gain reaches unity at the desired output amplitude. Diodes, or JFETs operated in the triode region, ${ }^{1}$ are commonly employed to implement the controlled-resistance element.

[^0]
[^0]:    ${ }^{1}$ We have not studied JFETs in this book. However, the book website includes material on JFETs and JFET circuits.
# EXERCISE 

18.3 Assume that the oscillator of Fig. 18.3(a) is designed for a loop-gain magnitude greater than unity so that the amplitude of oscillations grows to the point that the op-amp output saturates. Assume that the saturation levels of the op amp are $\pm 2 \mathrm{~V}$ and that the signal at the output of the op amp is nearly a square wave. If the bandpass LCR circuit is of sufficiently high selectivity, what is the amplitude of the sine wave across the LC circuit? (Hint: The fundamental frequency component in the Fourier series expansion of a square wave of amplitude $V$ has an amplitude $4 V / \pi$.)
Ans. 2.55 V

### 18.1.5 A Popular Limiter Circuit for Amplitude Control

We conclude this section by presenting a limiter circuit that is frequently employed for the amplitude control of op-amp oscillators, as well as in a variety of other applications. The circuit is more precise and versatile than those presented in Chapter 4.

The limiter circuit is shown in Fig. 18.4(a), and its transfer characteristic is depicted in Fig. 18.4(b). To see how the transfer characteristic is obtained, consider first the case of a small (close to zero) input signal $v_{I}$ and a small output voltage $v_{O}$, so that $v_{A}$ is positive and $v_{B}$ is negative. It can be easily seen that both diodes $D_{1}$ and $D_{2}$ will be off. Thus all of the input current $v_{I} / R_{1}$ flows through the feedback resistance $R_{f}$, and the output voltage is given by

$$
v_{O}=-\left(R_{f} / R_{1}\right) v_{I}
$$

This is the linear portion of the limiter transfer characteristic in Fig. 18.4(b). We now can use superposition to find the voltages at nodes A and B in terms of $\pm V$ and $v_{O}$ as

$$
\begin{aligned}
& v_{\mathrm{A}}=V \frac{R_{3}}{R_{2}+R_{3}}+v_{O} \frac{R_{2}}{R_{2}+R_{3}} \\
& v_{\mathrm{B}}=-V \frac{R_{4}}{R_{4}+R_{5}}+v_{O} \frac{R_{5}}{R_{4}+R_{5}}
\end{aligned}
$$

As $v_{I}$ goes positive, $v_{O}$ goes negative (Eq. 18.5), and we see from Eq. (18.7) that $v_{\mathrm{B}}$ will become more negative, thus keeping $D_{2}$ off. Equation (18.6) shows, however, that $v_{\mathrm{A}}$ becomes less positive. Then, if we continue to increase $v_{I}$, a negative value of $v_{O}$ will be reached at which $v_{\mathrm{A}}$ becomes -0.7 V or so and diode $D_{1}$ conducts. If we use the constant-voltage-drop model for $D_{1}$ and denote the voltage drop $V_{D}$, the value of $v_{O}$ at which $D_{1}$ conducts can be found from Eq. (18.6). This is the negative limiting level, which we denote $L_{-}$,

$$
L_{-}=-V \frac{R_{3}}{R_{2}}-V_{D}\left(1+\frac{R_{3}}{R_{2}}\right)
$$

The corresponding value of $v_{I}$ can be found by dividing $L_{-}$by the limiter gain $-R_{f} / R_{1}$. If $v_{I}$ is increased beyond this value, more current is injected into $D_{1}$, and $v_{\mathrm{A}}$ remains at approximately


Figure 18.4 (a) A popular limiter circuit. (b) Transfer characteristic of the limiter circuit; $L_{-}$and $L_{+}$are given by Eqs. (18.8) and (18.9), respectively. (c) When $R_{f}$ is removed, the limiter turns into a comparator with the characteristic shown.
$-V_{D}$. Thus the current through $R_{2}$ remains constant, and the additional diode current flows through $R_{3}$. Thus $R_{3}$ appears in effect in parallel with $R_{f}$, and the incremental gain (ignoring the diode resistance) is $-\left(R_{f} \| R_{3}\right) / R_{1}$. To make the slope of the transfer characteristic small in the limiting region, a low value should be selected for $R_{3}$.

The transfer characteristic for negative $v_{I}$ can be found in a manner identical to that just employed. It can be easily seen that for negative $v_{I}$, diode $D_{2}$ plays an identical role to that
played by diode $D_{1}$ for positive $v_{I}$. We can use Eq. (18.7) to find the positive limiting level $L_{+}$

$$
L_{+}=V \frac{R_{4}}{R_{5}}+V_{D}\left(1+\frac{R_{4}}{R_{5}}\right)
$$

and the slope of the transfer characteristic in the positive limiting region is $-\left(R_{f} \| R_{4}\right) / R_{1}$. We thus see that the circuit of Fig. 18.4(a) functions as a soft limiter, with the limiting levels $L_{+}$ and $L_{-}$, and the limiting gains independently adjustable by the selection of appropriate resistor values.

Finally, we note that increasing $R_{f}$ results in a higher gain in the linear region while keeping $L_{+}$and $L_{-}$unchanged. In the limit, removing $R_{f}$ altogether results in the transfer characteristic of Fig. 18.4(c), which is that of a comparator. That is, the circuit compares $v_{I}$ with the comparator reference value of $0 \mathrm{~V}: v_{I}>0$ results in $v_{O} \simeq L_{-}$, and $v_{I}<0$ yields $v_{O} \simeq L_{+}$.

# EXERCISE 

18.4 For the circuit of Fig. 18.4(a) with $V=15 \mathrm{~V}, R_{1}=30 \mathrm{k} \Omega, R_{f}=60 \mathrm{k} \Omega, R_{2}=R_{5}=9 \mathrm{k} \Omega$, and $R_{3}=R_{4}=3 \mathrm{k} \Omega$, find the limiting levels and the value of $v_{I}$ at which the limiting levels are reached. Also determine the limiter gain and the slope of the transfer characteristic in the positive and negative limiting regions. Assume that $V_{D}=0.7 \mathrm{~V}$.
Ans. $\pm 5.93 \mathrm{~V} ; \pm 2.97 \mathrm{~V} ;-2 ;-0.095$

### 18.2 Op Amp-RC Oscillator Circuits

In this section we shall study some practical oscillator circuits utilizing op amps and RC networks. These circuits are usually assembled on printed-circuit boards; their frequency of operation extends from very low frequencies to at most 1 MHz .

### 18.2.1 The Wien-Bridge Oscillator

One of the simplest oscillator circuits is based on the Wien bridge. Figure 18.5 shows a Wien-bridge oscillator without the nonlinear gain-control network. The circuit consists of an op amp connected in the noninverting configuration, with a closed-loop gain of $1+R_{2} / R_{1}$. In the feedback path of this positive-gain amplifier, an RC network is connected. The loop gain can be easily obtained by multiplying the transfer function $V_{a}(s) / V_{o}(s)$ of the feedback network by the amplifier gain,

$$
\begin{aligned}
L(s) & =\left[1+\frac{R_{2}}{R_{1}}\right] \frac{Z_{p}}{Z_{p}+Z_{s}} \\
& =\frac{1+R_{2} / R_{1}}{1+Z_{s} Y_{p}}
\end{aligned}
$$


Figure 18.5 A Wien-bridge oscillator without amplitude stabilization.

Thus,

$$
L(s)=\frac{1+R_{2} / R_{1}}{3+s C R+1 / s C R}
$$

Substituting $s=j \omega$ results in

$$
L(j \omega)=\frac{1+R_{2} / R_{1}}{3+j(\omega C R-1 / \omega C R)}
$$

The loop gain will be a real number (i.e., the phase will be zero) at one frequency given by

$$
\omega_{0} C R=\frac{1}{\omega_{0} C R}
$$

That is,

$$
\omega_{0}=1 / C R
$$

Oscillations will start at this frequency if the loop gain is at least unity. This can be achieved by selecting

$$
R_{2} / R_{1}=2
$$

To ensure that oscillations will start, one chooses $R_{2} / R_{1}$ slightly greater than 2 . The reader can easily verify that if $R_{2} / R_{1}=2+\delta$, where $\delta$ is a small number, the roots of the characteristic equation $1-L(s)=0$ will be in the right half of the $s$ plane.

The amplitude of oscillation can be determined and stabilized by using a nonlinear control network. Two different implementations of the amplitude-controlling function are shown in Figs. 18.6 and 18.7. The circuit in Fig. 18.6 employs a symmetrical feedback limiter of the type studied in Section 18.1.4. It is formed by diodes $D_{1}$ and $D_{2}$ together with resistors $R_{3}, R_{4}$, $R_{5}$, and $R_{6}$. The limiter operates in the following manner: At the positive peak of the output voltage $v_{O}$, the voltage at node $b$ will exceed the voltage $v_{1}$ (which is about $\frac{1}{3} v_{O}$ ), and diode $D_{2}$ conducts. This will clamp the positive peak to a value determined by $R_{5}, R_{6}$, and the negative power supply. To be specific, the value of the positive output peak can be calculated by setting $v_{b}=v_{1}+V_{D 2}$ and writing a node equation at node $b$ while neglecting the current through $D_{2}$. Similarly, the negative peak of the output sine wave will be clamped to the value that causes diode $D_{1}$ to conduct. The value of the negative peak can be determined by setting $v_{a}=v_{1}-V_{D 1}$


Figure 18.6 A Wien-bridge oscillator with a limiter used for amplitude control.

THE WIEN-BRIDGE OSCILLATOR:

The Wien bridge consisting of four resistors and two capacitors was invented in 1891 by Max Wien, a Prussian physicist, for inductance measurement. Much later, William Hewlett (cofounder in 1939 of Hewlett-Packard), while working toward his master's degree at Stanford University, realized the importance of placing part of the Wien bridge in a positive-feedback loop to form what was called the Wien-bridge oscillator. The first product in 1939 of the new Hewlett-Packard Company was the HP200A, a flexible, precision sine-wave generator using vacuum tubes to implement the amplifier and a tungsten lamp to control the loop gain and thus the amplitude of the sine wave.

# EXERCISE 

18.5 For the circuit in Fig. 18.6: (a) Disregarding the limiter circuit, find the location of the closed-loop poles. (b) Find the frequency of oscillation. (c) With the limiter in place, find the amplitude of the output sine wave (assume that the diode drop is 0.7 V ).
Ans. (a) $\left(10^{5} / 16\right)(0.015 \pm j)$; (b) 1 kHz ; (c) 21.36 V (peak-to-peak)


Figure 18.7 A Wien-bridge oscillator with an alternative method for amplitude stabilization.
and writing an equation at node $a$ while neglecting the current through $D_{1}$. Finally, note that to obtain a symmetrical output waveform, $R_{3}$ is chosen equal to $R_{6}$, and $R_{4}$ equal to $R_{5}$.

The circuit of Fig. 18.7 employs an inexpensive implementation of the parameter-variation mechanism of amplitude control. Potentiometer $P$ is adjusted until oscillations just start to grow. As the oscillations grow, the diodes start to conduct, causing the effective resistance between $a$ and $b$ to decrease. Equilibrium will be reached at the output amplitude that causes the loop gain to be exactly unity. The output amplitude can be varied by adjusting potentiometer $P$.

As indicated in Fig. 18.7, the output is taken at point $b$ rather than at the op-amp output terminal because the signal at $b$ has lower distortion than that at $a$. To appreciate this point, note that the voltage at $b$ is proportional to the voltage at the op-amp input terminals and that the latter is a filtered (by the RC network) version of the voltage at node $a$. Node $b$, however, is a high-impedance node, and a buffer will be needed if a load is to be connected.

# EXERCISE 

18.6 For the circuit in Fig. 18.7, find the following: (a) the setting of potentiometer $P$ at which oscillations just start; (b) the frequency of oscillation.
Ans. (a) $20 \mathrm{k} \Omega$ to ground; (b) 1 kHz

### 18.2.2 The Phase-Shift Oscillator

The basic structure of the phase-shift oscillator is shown in Fig. 18.8. It consists of a negative-gain amplifier ( $\sim K$ ) with a three-section (third-order) RC ladder network in the feedback. The circuit will oscillate at the frequency for which the phase shift of the RC

Figure 18.8 A phase-shift oscillator.
network is $180^{\circ}$. Only at this frequency will the total phase shift around the loop be $0^{\circ}$ or $360^{\circ}$. Here we should note that the reason for using a three-section RC network is that three is the minimum number of sections (i.e., lowest order) that is capable of producing a $180^{\circ}$ phase shift at a finite frequency.

For oscillations to be sustained, the value of $K$ should be equal to the inverse of the magnitude of the RC network transfer function at the frequency of oscillation. However, to ensure that oscillations start, the value of $K$ has to be chosen slightly higher than the value that satisfies the unity-loop-gain condition. Oscillations will then grow in magnitude until limited by some nonlinear control mechanism.

Figure 18.9 shows a practical phase-shift oscillator with a feedback limiter, consisting of diodes $D_{1}$ and $D_{2}$ and resistors $R_{1}, R_{2}, R_{3}$, and $R_{4}$ for amplitude stabilization. To start oscillations, $R_{f}$ has to be made slightly greater than the minimum required value. Although the circuit stabilizes more rapidly and provides sine waves with more stable amplitude, if $R_{f}$ is made much larger than this minimum, the price paid is an increased output distortion.

# EXERCISES 

18.7 Consider the circuit of Fig. 18.9 without the limiter. Break the feedback loop at $X$ and find the loop gain $A \beta \equiv V_{o}(j \omega) / V_{s}(j \omega)$ in symbolic form (i.e., do not substitute the numerical values given). To do this, it is easier to start at the output and work backward, finding the various currents and voltages, and eventually $V_{s}$ in terms of $V_{o}$.
Ans. $\frac{\omega^{2} C^{2} R R_{f}}{4+j(3 \omega C R-1 / \omega C R)}$
18.8 Use the expression derived in Exercise 18.7 to find the frequency of oscillation $f_{0}$ and the minimum required value of $R_{f}$ for oscillations to start in the circuit of Fig. 18.9.
Ans. $\omega_{0}=1 / \sqrt{3} C R ; R_{f} \geq 12 R ; f_{0}=574.3 \mathrm{~Hz} ; R_{f}=120 \mathrm{k} \Omega$

### 18.2.3 The Quadrature Oscillator

The quadrature oscillator is based on the two-integrator loop studied in Section 17.7. As an active filter, the loop is damped to locate the poles in the left half of the $s$ plane. Here, no such


Figure 18.9 A practical phase-shift oscillator with a limiter for amplitude stabilization.
damping will be used, since we wish to locate the poles on the $j \omega$ axis to provide sustained oscillations. In fact, to ensure that oscillations start, the poles are initially located in the right half-plane and then "pulled back" by the nonlinear gain control.

Figure 18.10(a) shows a practical quadrature oscillator. Amplifier 1 is connected as an inverting Miller integrator with a limiter in the feedback for amplitude control. Amplifier 2 is connected as a noninverting integrator [thus replacing the cascade connection of the Miller integrator and the inverter in the two-integrator loop of Fig. 17.25(b)]. To understand the operation of this noninverting integrator, consider the equivalent circuit shown in Fig. 18.10(b). Here, we have replaced the integrator input voltage $v_{O 1}$ and the series resistance $2 R$ by the Norton equivalent composed of a current source $v_{O 1} / 2 R$ and a parallel resistance $2 R$. Now, since $v_{O 2}=2 v$, where $v$ is the voltage at the input of op amp 2, the current through $R_{f}$ will be $(2 v-v) / R_{f}=v / R_{f}$ in the direction from output to input. Thus $R_{f}$ gives rise to a negative input resistance, $-R_{f}$, as indicated in the equivalent circuit of Fig. 18.10(b). Nominally, $R_{f}$ is made equal to $2 R$, and thus $-R_{f}$ cancels $2 R$, and at the input we are left with a current source $v_{O 1} / 2 R$ feeding a capacitor $C$. The result is that $v=\frac{1}{C} \int_{0}^{t} \frac{v_{O 1}}{2 R} d t$ and $v_{O 2}=2 v=\frac{1}{2 R} \int_{0}^{t} v_{O 1} d t$. That is, for $R_{f}=2 R$, the circuit functions as a perfect noninverting integrator. If, however, $R_{f}$ is made smaller than $2 R$, a net negative resistance appears in parallel with $C$.

Returning to the oscillator circuit in Fig. 18.10(a), we note that the resistance $R_{f}$ in the positive-feedback path of op amp 2 is made variable, with a nominal value of $2 R$. Decreasing


Figure 18.10 (a) A quadrature-oscillator circuit. (b) Equivalent circuit at the input of op amp 2.
the value of $R_{f}$ moves the poles to the right half-plane (Problem 18.21) and ensures that the oscillations start. Too much positive feedback, although it results in better amplitude stability, also results in higher output distortion (because the limiter has to operate "harder"). In this regard, note that the output $v_{O 2}$ will be "purer" than $v_{O 1}$ because of the filtering action provided by the second integrator on the peak-limited output of the first integrator.

If we disregard the limiter and break the loop at $X$, the loop gain can be obtained as

$$
L(s) \equiv \frac{V_{o 2}}{V_{s}}=-\frac{1}{s^{2} C^{2} R^{2}}
$$

Thus the loop will oscillate at frequency $\omega_{0}$, given by

$$
\omega_{0}=\frac{1}{C R}
$$

Finally, it should be pointed out that the name quadrature oscillator is used because the circuit provides two sinusoids with $90^{\circ}$ phase difference. This is the case because $v_{O 2}$ is the integral of $v_{O 1}$. There are many applications for which quadrature sinusoids are required.

# 18.2.4 The Active-Filter-Tuned Oscillator 

The last oscillator circuit that we shall discuss is quite simple both in principle and in design. Nevertheless, the approach is general and versatile and can result in high-quality (i.e., low-distortion) output sine waves. The basic principle is illustrated in Fig. 18.11. The


Figure 18.11 Block diagram of the active-filter-tuned oscillator.
circuit consists of a high- $Q$ bandpass filter connected in a positive-feedback loop with a hard limiter. To understand how this circuit works, assume that oscillations have already started. The output of the bandpass filter will be a sine wave whose frequency is equal to the center frequency of the filter, $f_{0}$. The sine-wave signal $v_{1}$ is fed to the limiter, which produces at its output a square wave whose levels are determined by the limiting levels and whose frequency is $f_{0}$. The square wave in turn is fed to the bandpass filter, which filters out the harmonics and provides a sinusoidal output $v_{1}$ at the fundamental frequency $f_{0}$. Obviously, the purity of the output sine wave will be a direct function of the selectivity (or $Q$ factor) of the bandpass filter.

The simplicity of this approach to oscillator design should be apparent. We have independent control of frequency and amplitude as well as of distortion of the output sinusoid. Any filter circuit with positive gain can be used to implement the bandpass filter. The frequency stability of the oscillator will be directly determined by the frequency stability of the bandpass-filter circuit. Also, a variety of limiter circuits (see Section 4.6) with different degrees of sophistication can be used to implement the limiter block.

Figure 18.12 shows one possible implementation of the active-filter-tuned oscillator. This circuit uses a variation on the bandpass circuit based on the Antoniou inductance-simulation circuit [see Fig. 17.22(c)]. Here resistor $R_{2}$ and capacitor $C_{4}$ are interchanged. This makes the output of the lower op amp directly proportional to (in fact, twice as large as) the voltage across the resonator, and we can therefore dispense with the buffer amplifier $K$. The limiter used is a very simple one consisting of a resistance $R_{1}$ and two diodes.

# EXERCISE 

18.9 Using $C=16 \mathrm{nF}$, find the value of $R$ such that the circuit of Fig. 18.12 produces $1-\mathrm{kHz}$ sine waves. If the diode drop is 0.7 V , find the peak-to-peak amplitude of the output sine wave. (Hint: A square wave with peak-to-peak amplitude of $V$ volts has a fundamental component with $4 V / \pi$ volts peak-to-peak amplitude.)
Ans. $10 \mathrm{k} \Omega ; 3.6 \mathrm{~V}$


Figure 18.12 A practical implementation of the active-filter-tuned oscillator.

# 18.2.5 A Final Remark 

The op amp-RC oscillator circuits studied are useful for operation in the range 10 Hz to 100 kHz (or perhaps 1 MHz at most). Whereas the lower frequency limit is dictated by the size of passive components required, the upper limit is governed by the frequency-response and slew-rate limitations of op amps. For higher frequencies, circuits that employ transistors together with LC-tuned circuits or crystals are frequently used. ${ }^{2}$ These are discussed in Section 18.3.

### 18.3 LC and Crystal Oscillators

Oscillators utilizing transistors (FETs or BJTs), with LC circuits or crystals as the frequency-selective feedback elements, are used in the frequency range of 100 kHz to hundreds of gigahertz. They exhibit higher $Q$ than the RC types. However, LC oscillators are difficult to tune over wide ranges, and crystal oscillators operate at a single frequency.

### 18.3.1 The Colpitts and Hartely Oscillators

Figure 18.13 shows two commonly used configurations of LC oscillators. They are known as the Colpitts oscillator and the Hartley oscillator. Both utilize a parallel LC circuit connected between collector and base (or between drain and gate if a FET is used) with a fraction of the tuned-circuit voltage fed to the emitter (the source in a FET). This feedback is achieved by

[^0]
[^0]:    ${ }^{2}$ Of course, transistors can be used in place of the op amps in the circuits just studied. At higher frequencies, however, better results are obtained with LC-tuned circuits and crystals.


Figure 18.13 Two commonly used configurations of LC-tuned oscillators: (a) Colpitts and (b) Hartley.
way of a capacitive divider in the Colpitts oscillator and by way of an inductive divider in the Hartley circuit. Observe that in both circuits the voltage $V_{c b}$ gives rise to a current $I_{c}$ in the direction shown, which in turn results in a positive voltage across the LC circuit. Thus, we do have a positive-feedback loop.

If the frequency of operation is sufficiently low that we can neglect the transistor capacitances, the frequency of oscillation will be determined by the resonance frequency of the parallel-tuned circuit (also known as a tank circuit because it behaves as a reservoir for energy storage). Thus for the Colpitts oscillator we have

$$
\omega_{0}=1 / \sqrt{L\left(\frac{C_{1} C_{2}}{C_{1}+C_{2}}\right)}
$$

and for the Hartley oscillator we have

$$
\omega_{0}=1 / \sqrt{\left(L_{1}+L_{2}\right) C}
$$

The ratio $L_{1} / L_{2}$ or $C_{1} / C_{2}$ determines the feedback factor and thus must be adjusted in conjunction with the transistor gain to ensure that oscillations will start. Depending on where the output voltage of the oscillator is to be taken, the appropriate terminal of the transistor can be connected to ground. In this regard, note that any of the three terminals can be grounded without changing the nature of the feedback loop. As an example, we show in Fig. 18.14(a) the Colpitts oscillator with the emitter connected to ground and the output taken at the collector. Although the bias arrangement is not shown, we have included a resistance $R$ that models the combination of the output resistance of the transistor $\left(r_{o}\right)$, the inductor loss, and the input resistance of the circuit to which the oscillator output is connected.

To determine the oscillation condition for the Colpitts oscillator in Fig. 18.14(a), we replace the transistor with its equivalent circuit, as shown in Fig. 18.14(b). To simplify the analysis, we have neglected the transistor capacitance $C_{o}\left(C_{g d}\right.$ for a FET). Capacitance $C_{\pi}$ ( $C_{g o}$ for a FET), although not shown, can be considered to be a part of $C_{2}$. The input resistance $r_{\pi}$ (infinite for a FET) has also been neglected, assuming that at the frequency of oscillation $r_{\pi} \gg\left(1 / \omega C_{2}\right)$. Finally, as mentioned earlier, the resistance $R$ includes $r_{o}$ of the transistor.


Figure 18.14 (a) A Colpitts oscillator in which the emitter is grounded and the output is taken at the collector. (b) Equivalent circuit of the Colpitts oscillator of (a). To simplify the analysis, $C_{\mu}$ and $r_{\pi}$ are neglected. We can consider $C_{\pi}$ to be part of $C_{2}$, and we can include $r_{\sigma}$ in $R$.

Using the alternative analysis approach described in Section 18.1.3, we analyze the circuit as shown in Fig. 18.14(b). A node equation at the transistor collector (node C) yields

$$
s C_{2} V_{\pi}+g_{m} V_{\pi}+\left(\frac{1}{R}+s C_{1}\right)\left(1+s^{2} L C_{2}\right) V_{\pi}=0
$$

Since $V_{\pi} \neq 0$ (oscillations have started), it can be eliminated, and the equation can be rearranged in the form

$$
s^{3} L C_{1} C_{2}+s^{2}\left(L C_{2} / R\right)+s\left(C_{1}+C_{2}\right)+\left(g_{m}+\frac{1}{R}\right)=0
$$

Substituting $s=j \omega$ gives

$$
\left(g_{m}+\frac{1}{R}-\frac{\omega^{2} L C_{2}}{R}\right)+j\left[\omega\left(C_{1}+C_{2}\right)-\omega^{3} L C_{1} C_{2}\right]=0
$$

For oscillations to start, both the real and imaginary parts must be zero. Equating the imaginary part to zero gives the frequency of oscillation as

$$
\omega_{0}=1 / \sqrt{L\left(\frac{C_{1} C_{2}}{C_{1}+C_{2}}\right)}
$$

which is the resonance frequency of the tank circuit, as anticipated. ${ }^{3}$ Equating the real part to zero and using Eq. (18.20) gives

$$
C_{2} / C_{1}=g_{m} R
$$

which has a simple physical interpretation: For sustained oscillations, the magnitude of the gain from base to collector $\left(g_{m} R\right)$ must be equal to the inverse of the voltage ratio provided by the capacitive divider, which from Fig. 18.14(a) can be seen to be $V_{e b} / V_{c e}=C_{1} / C_{2}$. Of course, for oscillations to start, the loop gain must be made greater than unity, a condition that can be

[^0]
[^0]:    ${ }^{3}$ If $r_{\pi}$ is taken into account, the frequency of oscillation can be shown to shift slightly from the value given by Eq. (18.20).
stated in the equivalent form

$$
g_{m} R>C_{2} / C_{1}
$$

As oscillations grow in amplitude, the transistor's nonlinear characteristics reduce the effective value of $g_{m}$ and, correspondingly, reduce the loop gain to unity, thus sustaining the oscillations.

Analysis similar to the foregoing can be carried out for the Hartley circuit (see later: Exercise 18.10). At high frequencies, more accurate transistor models must be used. Alternatively, the $y$ parameters of the transistor can be measured at the intended frequency $\omega_{0}$, and the analysis can then be carried out using the $y$-parameter model (see Appendix C). This is usually simpler and more accurate, especially at frequencies above about $30 \%$ of the transistor $f_{T}$.

As an example of a practical LC oscillator, we show in Fig. 18.15 a discrete-circuit implementation of a Colpitts oscillator, complete with bias details. Here the radio-frequency choke (RFC) provides a high impedance at $\omega_{0}$ but a low dc resistance.

Finally, a few words are in order on the mechanism that determines the amplitude of oscillations in the LC oscillators discussed above. Unlike the op-amp oscillators that incorporate special amplitude-control circuitry, LC oscillators utilize the nonlinear $i_{C}-v_{B E}$ characteristics of the BJT (the $i_{D}-v_{G S}$ characteristics of the FET) for amplitude control. Thus these LC oscillators are known as self-limiting oscillators. Specifically, as the oscillations grow in amplitude, the effective gain of the transistor is reduced below its small-signal value. Eventually, an amplitude is reached at which the effective gain is reduced to the point that the Barkhausen criterion is satisfied exactly. The amplitude then remains constant at this value.

Reliance on the nonlinear characteristics of the BJT (or the FET) implies that the collector (drain) current waveform will be nonlinearly distorted. Nevertheless, the output voltage signal will still be a sinusoid of high purity because of the filtering action of the LC circuit. Detailed


Figure 18.15 Complete discrete-circuit implementation for a Colpitts oscillator.
analysis of amplitude control, which makes use of nonlinear-circuit techniques, is beyond the scope of this book.

# EXERCISES 

18.10 Show that for the Hartley oscillator of Fig. 18.13(b), the frequency of oscillation is given by Eq. (18.17) and that for oscillations to start $g_{\mathrm{oc}} R>\left(L_{1} / L_{2}\right)$.
D18.11 Using a BJT biased at $I_{C}=1 \mathrm{~mA}$, design a Colpitts oscillator to operate at $\omega_{0}=10^{6} \mathrm{rad} / \mathrm{s}$. Use $C_{1}=0.01 \mu \mathrm{~F}$ and assume that the coil available has a $Q$ of 100 (this can be represented by a resistance in parallel with $C_{1}$ given by $Q / \omega_{0} C_{1}$ ). Also assume that there is a load resistance at the collector of $2 \mathrm{k} \Omega$ and that for the BJT, $r_{o}=100 \mathrm{k} \Omega$. Find $C_{2}$ and $L$.
Ans. $0.66 \mu \mathrm{~F} ; 100 \mu \mathrm{H}$ (a somewhat smaller $C_{2}$ would be used to allow oscillations to grow in amplitude)

## OSCILLATOR PIONEERS:

Heinrich Georg Barkhausen was a German physicist who taught at the Technical University of Dresden. In 1911, at age 29, he became what has since been described as the world's first chaired professor of electrical engineering. Among his many interests were high-frequency oscillators, and he created the enduring Barkhausen stability criterion.

Nevada-born Ralph Hartley was a Rhodes Scholar who began work at Western Electric in 1915. He led a transatlantic-radio project for which he invented his tapped-inductor oscillator. As well, he is renowned for having developed a neutralizing scheme to prevent the triode "singing" (self-oscillation) produced by internal input/output capacitance coupling (analogous to that produced by $C_{o}$ in a BJT or $C_{p d}$ in a FET).

Edwin Henry Colpitts was a school principal in Newfoundland. He later obtained advanced education in math and physics at Harvard and in 1907 joined Western Electric, where he ultimately led a group in radio telephony. Later, he improved upon the Hartley tapped-inductor oscillator by introducing a more flexible capacitance voltage divider. The circuit now known as the Colpitts oscillator was patented in 1920 as the "oscillation generator." Though invented in the context of vacuum tubes, the Colpitts oscillator is extremely versatile and has marked significance in BJT and MOS designs.

### 18.3.2 The Cross-Coupled LC Oscillator

A currently popular LC oscillator circuit suitable for fabrication in IC form and capable of operating at frequencies approaching hundreds of gigahertz (for use in wireless transceivers) is shown in Fig. 18.16(a). It consists of a pair of MOSFETs connected in the differential amplifier configuration, each with a parallel LC-tuned circuit load, and with the drain of each connected to the gate of the other. The latter connection gives rise to the "cross-coupled" part of the name.

To see how the cross-coupled LC oscillator works, we first note that, as in a differential amplifier, from a signal point of view each of $Q_{1}$ and $Q_{2}$ operates in the grounded-source configuration. Next we observe that if we think of $Q_{1}$ and $Q_{2}$ together with their loads as common-source amplifiers, we see that the cross coupling simply means that the output of each


Figure 18.16 (a) The cross-coupled LC oscillator. (b) Signal equivalent circuit of the cross-coupled oscillator in (a).
amplifier drives the input of the other, resulting in the feedback loop shown in Fig. 18.16(b). Here we have eliminated all dc bias sources to concentrate on the signal operation of the circuit.

Examination of the feedback loop in Fig. 18.16(b) reveals that at the resonance frequency of each of the two tank circuits (i.e., at $\omega=\omega_{0}=1 \sqrt{L C}$ ), the load of each of $Q_{1}$ and $Q_{2}$ reduces to a resistance $R_{p}=\omega_{0} L Q$, where $Q$ is the quality factor of the inductance. Taking into consideration the output resistance $r_{o}$ of each of $Q_{1}$ and $Q_{2}$, we can write for the gain of each of the two stages at $\omega=\omega_{0}$,

$$
A_{1}=A_{2}=-g_{m}\left(R_{p} \| r_{o}\right)
$$

Thus each stage exhibits a $180^{\circ}$ phase shift, for a total phase shift around the loop of $360^{\circ}$. Thus the circuit will provide sustained oscillations at

$$
\omega_{0}=1 \sqrt{L C}
$$

provided

$$
\left|A_{1} A_{2}\right|=\left[g_{m}\left(R_{p} \| r_{o}\right)\right]^{2}=1
$$which reduces to

$$
g_{m}\left(R_{p} \| r_{o}\right)=1
$$

The condition in Eq. (18.24) can be used to determine the minimum required value of $g_{m}$ at which each of $Q_{1}$ and $Q_{2}$ is operated for oscillations to be sustained. As usual, to ensure that oscillations start, a somewhat higher value of $g_{m}$ is used. Amplitude stabilization is provided by the nonlinear MOSFET characteristics.

For applications at very high frequency, the inductor is fabricated on chip by depositing a thin metal film in a spiral shape. Such IC inductors have small values (in the nanohenry range) and, unfortunately, small $Q$ factors as well.

# EXERCISE 

D18.12 Design the cross-coupled oscillator to operate at $\omega_{0}=10 \mathrm{Grad} / \mathrm{s}$. The IC inductors available have $L=10 \mathrm{nH}$ and $Q=10$. If the transistor $r_{o}=10 \mathrm{k} \Omega$, find the required value of $C$ and the minimum required value of $g_{m}$ at which $Q_{1}$ and $Q_{2}$ are to be operated.
Ans. $1 \mathrm{pF} ; 1.1 \mathrm{~mA} / \mathrm{V}$

### 18.3.3 Crystal Oscillators

A piezoelectric crystal, such as quartz, exhibits electromechanical-resonance characteristics that are very stable (with time and temperature) and highly selective (having very high $Q$ factors). The circuit symbol of a crystal is shown in Fig. 18.17(a), and its equivalent-circuit model is given in Fig. 18.17(b). The resonance properties are characterized by a large inductance $L$ (as high as hundreds of henrys), a very small series capacitance $C_{s}$ (as small as 0.0005 pF ), a series resistance $r$ representing a $Q$ factor $\omega_{0} L / r$ that can be as high as a few hundred thousand, and a parallel capacitance $C_{p}$ (a few picofarads). Capacitor $C_{p}$ represents the electrostatic capacitance between the two parallel plates of the crystal. Note that $C_{p} \gg C_{s}$.

Since the $Q$ factor is very high, we may neglect the resistance $r$ and express the crystal impedance as

$$
Z(s)=1 / s C_{p}+\frac{1}{s L+1 / s C_{s}}
$$

which can be manipulated to the form

$$
Z(s)=\frac{1}{s C_{p}} \frac{s^{2}+\left(1 / L C_{s}\right)}{s^{2}+\left[\left(C_{p}+C_{s}\right) / L C_{s} C_{p}\right]}
$$

From Eq. (18.25) and from Fig. 18.17(b), we see that the crystal has two resonance frequencies: a series resonance at $\omega_{s}$

$$
\omega_{s}=1 / \sqrt{L C_{s}}
$$


Figure 18.17 A piezoelectric crystal. (a) Circuit symbol. (b) Equivalent circuit. (c) Crystal reactance versus frequency [note that, neglecting the small resistance $r, Z_{\text {crystal }}=j X(\omega)$ ].
and a parallel resonance at $\omega_{p}$

$$
\omega_{p}=1 / \sqrt{L\left(\frac{C_{s} C_{p}}{C_{s}+C_{p}}\right)}
$$

Thus for $s=j \omega$ we can write

$$
Z(j \omega)=-j \frac{1}{\omega C_{p}}\left(\frac{\omega^{2}-\omega_{s}^{2}}{\omega^{2}-\omega_{p}^{2}}\right)
$$

From Eqs. (18.26) and (18.27) we note that $\omega_{p}>\omega_{s}$. However, since $C_{p} \gg C_{s}$, the two resonance frequencies are very close. Expressing $Z(j \omega)=j X(\omega)$, the crystal reactance $X(\omega)$ will have the shape shown in Fig. 18.17(c). We observe that the crystal reactance is inductive over the very narrow frequency band between $\omega_{s}$ and $\omega_{p}$. For a given crystal, this frequency band is well defined. Thus we may use the crystal to replace the inductor of the Colpitts oscillator [Fig. 18.13(a)]. The resulting circuit will oscillate at the resonance frequency of the crystal inductance $L$ with the series equivalent of $C_{s}$ and $\left(C_{p}+C_{1} C_{2} /\left(C_{1}+C_{2}\right)\right)$. Since $C_{s}$ is much smaller than the three other capacitances, it will be dominant and

$$
\omega_{0} \simeq 1 / \sqrt{L C_{s}}=\omega_{s}
$$

In addition to the basic Colpitts oscillator, a variety of configurations exist for crystal oscillators. Figure 18.18 shows a popular configuration (called the Pierce oscillator) utilizing a CMOS inverter (see Section 14.3) as an amplifier. Resistor $R_{f}$ determines a dc operating point in the high-gain region of the VTC of the CMOS inverter. Resistor $R_{1}$ together with capacitor $C_{1}$ provides a low-pass filter that discourages the circuit from oscillating at a higher harmonic of the crystal frequency. Note that this circuit also is based on the Colpitts configuration.


Figure 18.18 A Pierce crystal oscillator utilizing a CMOS inverter as an amplifier.

The extremely stable resonance characteristics and the very high $Q$ factors of quartz crystals result in oscillators with very accurate and stable frequencies. Crystals are available with resonance frequencies in the range of a few kilohertz to hundreds of megahertz. Temperature coefficients of $\omega_{0}$ of 1 or 2 parts per million (ppm) per degree Celsius are achievable. Unfortunately, however, crystal oscillators, being mechanical resonators, are fixed-frequency circuits.

# EXERCISE 

18.13 A $2-\mathrm{MHz}$ quartz crystal is specified to have $L=0.52 \mathrm{H}, C_{s}=0.012 \mathrm{pF}, C_{p}=4 \mathrm{pF}$, and $r=120 \Omega$. Find $f_{s}, f_{p}$, and $Q$.
Ans. $2.015 \mathrm{MHz} ; 2.018 \mathrm{MHz} ; 55,000$

### 18.4 Bistable Multivibrators

In this section we begin the study of waveform-generating circuits of the other type-nonlinear oscillators or function generators. These devices make use of a special class of circuits known as multivibrators. As mentioned earlier, there are three types of multivibrator: bistable, monostable, and astable. This section is concerned with the first, the bistable multivibrator. ${ }^{4}$

As its name indicates, the bistable multivibrator has two stable states. The circuit can remain in either stable state indefinitely and moves to the other stable state only when appropriately triggered.

[^0]
[^0]:    ${ }^{4}$ Digital implementations of multivibrators were presented in Chapter 16. Here, we are interested in implementations utilizing op amps.
# 18.4.1 The Feedback Loop 

Bistability can be obtained by connecting a dc amplifier in a positive-feedback loop having a loop gain greater than unity. Such a feedback loop is shown in Fig. 18.19; it consists of an op amp and a resistive voltage divider in the positive-feedback path. To see how bistability is obtained, consider operation with the positive input terminal of the op amp near ground potential. This is a reasonable starting point, since the circuit has no external excitation. Assume that the electrical noise that is inevitably present in every electronic circuit causes a small positive increment in the voltage $v_{+}$. This incremental signal will be amplified by the large open-loop gain $A$ of the op amp, with the result that a much greater signal will appear in the op amp's output voltage $v_{O}$. The voltage divider $\left(R_{1}, R_{2}\right)$ will feed a fraction $\beta \equiv R_{1} /\left(R_{1}+R_{2}\right)$ of the output signal back to the positive input terminal of the op amp. If $A \beta$ is greater than unity, as is usually the case, the fed-back signal will be greater than the original increment in $v_{+}$. This regenerative process continues until eventually the op amp saturates with its output voltage at the positive saturation level, $L_{+}$. When this happens, the voltage at the positive input terminal, $v_{+}$, becomes $L_{+} R_{1} /\left(R_{1}+R_{2}\right)$, which is positive and thus keeps the op amp in positive saturation. This is one of the two stable states of the circuit.

In the description above we assumed that when $v_{+}$was near zero volts, a positive increment occurred in $v_{+}$. Had we assumed the equally probable situation of a negative increment, the op amp would have ended up saturated in the negative direction with $v_{O}=L_{-}$and $v_{+}=L_{-} R_{1} /\left(R_{1}+R_{2}\right)$. This is the other stable state.

We thus conclude that the circuit of Fig. 18.19 has two stable states, one with the op amp in positive saturation and the other with the op amp in negative saturation. The circuit can exist in either of these two states indefinitely. We also note that the circuit cannot exist in the state for which $v_{+}=0$ and $v_{O}=0$ for any length of time. This is a state of unstable equilibrium (also known as a metastable state); any disturbance, such as that caused by electrical noise, causes the bistable circuit to switch to one of its two stable states. This is in sharp contrast to the case when the feedback is negative, causing a virtual short circuit to appear between the op amp's input terminals and maintaining this virtual short circuit in the face of disturbances. A physical analogy for the operation of the bistable circuit is depicted in Fig. 18.20.


Figure 18.19 A positive-feedback loop capable of bistable operation.

Figure 18.20 A physical analogy for the operation of the bistable circuit. The ball cannot remain at the top of the hill for any length of time (a state of unstable equilibrium or metastability); the inevitably present disturbance will cause the ball to fall to one side or the other, where it can remain indefinitely (the two stable states).
# 18.4.2 Transfer Characteristic of the Bistable Circuit 

The question naturally arises as to how we can make the bistable circuit of Fig. 18.19 change state. To help answer this crucial question, we derive the transfer characteristic of the bistable circuit. Reference to Fig. 18.19 indicates that either of the two nodes that are connected to ground can serve as an input terminal. We investigate both possibilities.

Figure 18.21(a) shows the bistable circuit with a voltage $v_{I}$ applied to the inverting input terminal of the op amp. To derive the transfer characteristic $v_{O}-v_{I}$, assume that $v_{O}$ is at one of its two possible levels, say $L_{+}$, and thus $v_{+}=\beta L_{+}$. Now as $v_{I}$ is increased from 0 V , we can see from the circuit that nothing happens until $v_{I}$ reaches a value equal to $v_{+}$(i.e., $\beta L_{+}$). As


Figure 18.21 (a) The bistable circuit of Fig. 18.19 with the negative input terminal of the op amp disconnected from ground and connected to an input signal $v_{I}$. (b) The transfer characteristic of the circuit in (a) for increasing $v_{I}$. (c) The transfer characteristic for decreasing $v_{I}$. (d) The complete transfer characteristics.
$v_{I}$ begins to exceed this value, a net negative voltage develops between the input terminals of the op amp. This voltage is amplified by the open-loop gain of the op amp, and thus $v_{O}$ goes negative. The voltage divider in turn causes $v_{+}$to go negative, thus increasing the net negative input to the op amp and keeping the regenerative process going. This process culminates in the op amp saturating in the negative direction: that is, with $v_{O}=L_{-}$and, correspondingly, $v_{+}=\beta L_{-}$. It is easy to see that increasing $v_{I}$ further has no effect on the acquired state of the bistable circuit. Figure 18.21(b) shows the transfer characteristic for increasing $v_{I}$. Observe that the characteristic is that of a comparator with a threshold voltage denoted $V_{T H}$, where $V_{T H}=\beta L_{+}$.

Next consider what happens as $v_{I}$ is decreased. Since now $v_{+}=\beta L_{-}$, we see that the circuit remains in the negative-saturation state until $v_{I}$ goes negative to the point that it equals $\beta L_{-}$. As $v_{I}$ goes below this value, a net positive voltage appears between the op amp's input terminals. This voltage is amplified by the op-amp gain and thus gives rise to a positive voltage at the op amp's output. The regenerative action of the positive-feedback loop then sets in and causes the circuit eventually to go to its positive saturation state, in which $v_{O}=L_{+}$ and $v_{+}=\beta L_{+}$. The transfer characteristic for decreasing $v_{I}$ is shown in Fig. 18.21(c). Here again we observe that the characteristic is that of a comparator, but with a threshold voltage $V_{T L}=\beta L_{-}$.

The complete transfer characteristics, $v_{O}-v_{I}$, of the circuit in Fig. 18.21(a) can be obtained by combining the characteristic in Fig. 18.21(b) and (c), as shown in Fig. 18.21(d). As indicated, the circuit changes state at different values of $v_{I}$, depending on whether $v_{I}$ is increasing or decreasing. Thus the circuit is said to exhibit hysteresis; the width of the hysteresis is the difference between the high threshold $V_{T H}$ and the low threshold $V_{T L}$. Also note that the bistable circuit is in effect a comparator with hysteresis. As will be shown shortly, adding hysteresis to a comparator's characteristics can be very beneficial in certain applications. Finally, observe that because the bistable circuit of Fig. 18.21 switches from the positive state $\left(v_{O}=L_{+}\right)$to the negative state $\left(v_{O}=L_{-}\right)$as $v_{I}$ is increased past the positive threshold $V_{T H}$, the circuit is said to be inverting. A bistable circuit with a noninverting transfer characteristic will be presented shortly.

# 18.4.3 Triggering the Bistable Circuit 

Returning now to the question of how to make the bistable circuit change state, we observe from the transfer characteristics of Fig. 18.21(d) that if the circuit is in the $L_{+}$state it can be switched to the $L_{-}$state by applying an input $v_{I}$ of value greater than $V_{T H} \equiv \beta L_{+}$. Such an input causes a net negative voltage to appear between the input terminals of the op amp, which initiates the regenerative cycle that culminates in the circuit switching to the $L_{-}$stable state. Here it is important to note that the input $v_{I}$ merely initiates or triggers regeneration. Thus we can remove $v_{I}$ with no effect on the regeneration process. In other words, $v_{I}$ can be simply a pulse of short duration. The input signal $v_{I}$ is thus referred to as a trigger signal, or simply a trigger.

The characteristics of Fig. 18.21(d) indicate also that the bistable circuit can be switched to the positive state $\left(v_{O}=L_{+}\right)$by applying a negative trigger signal $v_{I}$ of magnitude greater than that of the negative threshold $V_{T L}$.

### 18.4.4 The Bistable Circuit as a Memory Element

We observe from Fig. 18.21(d) that for input voltages in the range $V_{T L}<v_{I}<V_{T H}$, the output can be either $L_{+}$or $L_{-}$, depending on the state that the circuit is already in. Thus, for this input
range, the output is determined by the previous value of the trigger signal (the trigger signal that caused the circuit to be in its current state). Thus the circuit exhibits memory. Indeed, the bistable multivibrator is the basic memory element of digital systems, as we have seen in Chapter 16. Finally, note that in analog-circuit applications, such as the ones of concern to us in this chapter, the bistable circuit is also known as a Schmitt trigger.

# 18.4.5 A Bistable Circuit with Noninverting Transfer Characteristic 

The basic bistable feedback loop of Fig. 18.19 can be used to derive a circuit with noninverting transfer characteristic by applying the input signal $v_{I}$ (the trigger signal) to the terminal of $R_{1}$ that is connected to ground. The resulting circuit is shown in Fig. 18.22(a). To obtain the transfer characteristic we first employ superposition to the linear circuit formed by $R_{1}$ and $R_{2}$, thus expressing $v_{+}$in terms of $v_{I}$ and $v_{O}$ as

$$
v_{+}=v_{I} \frac{R_{2}}{R_{1}+R_{2}}+v_{O} \frac{R_{1}}{R_{1}+R_{2}}
$$

From this equation we see that if the circuit is in the positive stable state with $v_{O}=L_{+}$, positive values for $v_{I}$ will have no effect. To trigger the circuit into the $L_{-}$state, $v_{I}$ must be made negative and of such a value as to make $v_{+}$decrease below zero. Thus the low-threshold $V_{T L}$ can be found by substituting in Eq. (18.30) $v_{O}=L_{+}, v_{+}=0$, and $v_{I}=V_{T L}$. The result is

$$
V_{T L}=-L_{+}\left(R_{1} / R_{2}\right)
$$

Similarly, Eq. (18.30) indicates that when the circuit is in the negative-output state ( $v_{O}=L_{-}$), negative values of $v_{I}$ will make $v_{+}$more negative with no effect on operation. To initiate the regeneration process that causes the circuit to switch to the positive state, $v_{+}$must be made to


Figure 18.22 (a) A bistable circuit derived from the positive-feedback loop of Fig. 18.19 by applying $v_{I}$ through $R_{1}$. (b) The transfer characteristic of the circuit in (a) is noninverting. [Compare it to the inverting characteristic in Fig. 18.21(d).]
go slightly positive. The value of $v_{I}$ that causes this to happen is the high-threshold voltage $V_{T H}$, which can be found by substituting in Eq. (18.30) $v_{O}=L_{-}$and $v_{+}=0$. The result is

$$
V_{T H}=-L_{-}\left(R_{1} / R_{2}\right)
$$

The complete transfer characteristic of the circuit of Fig. 18.22(a) is displayed in Fig. 18.22(b). Observe that a positive triggering signal $v_{I}$ (of value greater than $V_{T H}$ ) causes the circuit to switch to the positive state ( $v_{O}$ goes from $L_{-}$to $L_{+}$). Thus the transfer characteristic of this circuit is noninverting.

# 18.4.6 Application of the Bistable Circuit as a Comparator 

The comparator is an analog-circuit building block that is used in a variety of applications ranging from detecting the level of an input signal relative to a preset threshold value to the design of analog-to-digital (A/D) converters. Although one normally thinks of the comparator as having a single threshold value [see Fig. 18.23(a)], it is useful in many applications to add hysteresis to the comparator characteristic. If this is done, the comparator

(a)

(b)

Figure 18.23 (a) Block diagram representation and transfer characteristic for a comparator having a reference, or threshold, voltage $V_{R}$. (b) Comparator characteristic with hysteresis.


Figure 18.24 Illustrating the use of hysteresis in the comparator characteristic as a means of rejecting interference.
exhibits two threshold values, $V_{T L}$ and $V_{T H}$, symmetrically placed about the desired reference level, as indicated in Fig. 18.23(b). Usually $V_{T H}$ and $V_{T L}$ are separated by a small amount, say 100 mV .

To demonstrate the need for hysteresis, we consider a common application of comparators. It is required to design a circuit that detects and counts the zero crossings of an arbitrary waveform. Such a function can be implemented using a comparator whose threshold is set to 0 V . The comparator provides a step change at its output every time a zero crossing occurs. Each step change can be used to generate a pulse, and the pulses are fed to a counter circuit.

Imagine now what happens if the signal being processed has-as it usually does have-interference superimposed on it, say of a frequency much higher than that of the signal. It follows that the signal might cross the zero axis a number of times around each of the zero-crossing points we are trying to detect, as shown in Fig. 18.24. The comparator would thus change state a number of times at each of the zero crossings, and our count would obviously be in error. However, if we have an idea of the expected peak-to-peak amplitude of the interference, the problem can be solved by introducing hysteresis of appropriate width in the comparator characteristics. Then, if the input signal is increasing in magnitude, the comparator with hysteresis will remain in the low state until the input level exceeds the high threshold $V_{T H}$. Subsequently the comparator will remain in the high state even if, owing to interference, the signal decreases below $V_{T H}$. The comparator will switch to the low state only if the input signal is decreased below the low threshold $V_{T L}$. The situation is illustrated


Figure 18.25 Limiter circuits are used to obtain more precise output levels for the bistable circuit. In both circuits the value of $R$ should be chosen to yield the current required for the proper operation of the zener diodes. (a) For this circuit $L_{+}=V_{Z_{1}}+V_{D}$ and $L_{-}=-\left(V_{Z_{2}}+V_{D}\right)$, where $V_{D}$ is the forward diode drop. (b) For this circuit $L_{+}=V_{Z}+V_{D_{1}}+V_{D_{2}}$ and $L_{-}=-\left(V_{Z}+V_{D_{3}}+V_{D_{4}}\right)$.
in Fig. 18.24, from which we see that including hysteresis in the comparator characteristic provides an effective means for rejecting interference (thus providing another form of filtering).

# 18.4.7 Making the Output Levels More Precise 

The output levels of the bistable circuit can be made more precise than the saturation voltages of the op amp are by cascading the op amp with a limiter circuit (see Section 4.6 for a discussion of limiter circuits). Two such arrangements are shown in Fig. 18.25.

## EXERCISES

D18.14 The op amp in the bistable circuit of Fig. 18.21(a) has output saturation voltages of $\pm 13 \mathrm{~V}$. Design the circuit to obtain threshold voltages of $\pm 5 \mathrm{~V}$. For $R_{1}=10 \mathrm{k} \Omega$, find the value required for $R_{2}$. Ans. $16 \mathrm{k} \Omega$
D18.15 If the op amp in the circuit of Fig. 18.22(a) has $\pm 10-\mathrm{V}$ output saturation levels, design the circuit to obtain $\pm 5-\mathrm{V}$ thresholds. Give suitable component values.
Ans. Possible choice: $R_{1}=10 \mathrm{k} \Omega$ and $R_{2}=20 \mathrm{k} \Omega$
18.16 Consider a bistable circuit with a noninverting transfer characteristic and let $L_{+}=-L_{-}=10 \mathrm{~V}$ and $V_{D I}=-V_{I L}=5 \mathrm{~V}$. If $v_{I}$ is a triangular wave with a $0-\mathrm{V}$ average, a $10-\mathrm{V}$ peak amplitude, and a 1-ms period, sketch the waveform of $v_{O}$. Find the time interval between the zero crossings of $v_{I}$ and $v_{O}$.
Ans. $v_{O}$ is a square wave with $0-\mathrm{V}$ average, $10-\mathrm{V}$ amplitude, and 1 -ms period and is delayed by $125 \mu \mathrm{~s}$ relative to $v_{I}$18.17 Consider an op amp having saturation levels of $\pm 12 \mathrm{~V}$ used without feedback, with the inverting input terminal connected to +3 V and the noninverting input terminal connected to $v_{I}$. Characterize its operation as a comparator. What are $L_{+}, L_{-}$, and $V_{R}$, as defined in Fig. 18.23(a)?
Ans. $+12 \mathrm{~V} ;-12 \mathrm{~V} ;+3 \mathrm{~V}$
18.18 In the circuit of Fig. 18.22(a), let $L_{+}=-L_{-}=10 \mathrm{~V}$ and $R_{1}=1 \mathrm{k} \Omega$. Find a value for $R_{2}$ that gives a hysteresis of $100-\mathrm{mV}$ width.
Ans. $200 \mathrm{k} \Omega$

# 18.5 Generation of Square and Triangular Waveforms Using Astable Multivibrators 

A square waveform can be generated by arranging for a bistable multivibrator to switch states periodically. This can be done by connecting the bistable multivibrator with an RC circuit in a feedback loop, as shown in Fig. 18.26(a). Observe that the bistable multivibrator has an inverting transfer characteristic and can thus be realized using the circuit of Fig. 18.21(a). This results in the circuit of Fig. 18.26(b). We shall show shortly that this circuit has no stable states and thus is appropriately named an astable multivibrator.

At this point we wish to remind the reader of an important relationship, which we shall employ on many occasions in the following few sections: A capacitor $C$ that is charging or


Figure 18.26 (a) Connecting a bistable multivibrator with inverting transfer characteristics in a feedback loop with an RC circuit results in a square-wave generator.


Figure 18.26 continued (b) The circuit obtained when the bistable multivibrator is implemented with the circuit of Fig. 18.21(a). (c) Waveforms at various nodes of the circuit in (b). This circuit is called an astable multivibrator.
discharging through a resistance $R$ toward a final voltage $V_{\infty}$ has a voltage $v(t)$,

$$
v(t)=V_{\infty}-\left(V_{\infty}-V_{0+}\right) e^{-t / \tau}
$$

where $V_{0+}$ is the voltage at $t=0+$ and $\tau=C R$ is the time constant.

# 18.5.1 Operation of the Astable Multivibrator 

To see how the astable multivibrator operates, refer to Fig. 18.26(b) and let the output of the bistable multivibrator be at one of its two possible levels, say $L_{+}$. Capacitor $C$ will charge toward this level through resistor $R$. Thus the voltage across $C$, which is applied to the negative input terminal of the op amp and thus is denoted $v_{-}$, will rise exponentially toward $L_{+}$with a time constant $\tau=C R$. Meanwhile, the voltage at the positive input terminal
of the op amp is $v_{+}=\beta L_{+}$. This situation will continue until the capacitor voltage reaches the positive threshold $V_{T H}=\beta L_{+}$, at which point the bistable multivibrator will switch to the other stable state, in which $v_{O}=L_{-}$and $v_{+}=\beta L_{-}$. The capacitor will then start discharging, and its voltage, $v_{-}$, will decrease exponentially toward $L_{-}$. This new state will prevail until $v_{-}$reaches the negative threshold $V_{T L}=\beta L_{-}$, at which time the bistable multivibrator switches to the positive-output state, the capacitor begins to charge, and the cycle repeats itself.

From the preceding description we see that the astable circuit oscillates and produces a square waveform at the output of the op amp. This waveform, and the waveforms at the two input terminals of the op amp, are displayed in Fig. 18.26(c). The period $T$ of the square wave can be found as follows: During the charging interval $T_{1}$ the voltage $v_{-}$ across the capacitor at any time $t$, with $t=0$ at the beginning of $T_{1}$, is given by (see Appendix E)

$$
v_{-}=L_{+}-\left(L_{+}-\beta L_{-}\right) e^{-t / \tau}
$$

where $\tau=C R$. Substituting $v_{-}=\beta L_{+}$at $t=T_{1}$ gives

$$
T_{1}=\tau \ln \frac{1-\beta\left(L_{-} / L_{+}\right)}{1-\beta}
$$

Similarly, during the discharge interval $T_{2}$ the voltage $v_{-}$at any time $t$, with $t=0$ at the beginning of $T_{2}$, is given by

$$
v_{-}=L_{-}-\left(L_{-}-\beta L_{+}\right) e^{-t / \tau}
$$

Substituting $v_{-}=\beta L_{-}$at $t=T_{2}$ gives

$$
T_{2}=\tau \ln \frac{1-\beta\left(L_{+} / L_{-}\right)}{1-\beta}
$$

Equations (18.33) and (18.34) can be combined to obtain the period $T=T_{1}+T_{2}$. Normally, $L_{+}=-L_{-}$, resulting in symmetrical square waves of period $T$ given by

$$
T=2 \tau \ln \frac{1+\beta}{1-\beta}
$$

Note that this square-wave generator can be made to have variable frequency by switching different capacitors $C$ (usually in decades) and by continuously adjusting $R$ (to obtain continuous frequency control within each decade of frequency). Also, the waveform across $C$ can be made almost triangular by using a small value for the parameter $\beta$. However, triangular waveforms of superior linearity can be easily generated using the scheme discussed next.

Before leaving this section, however, note that although the astable circuit has no stable states, it has two quasi-stable states and remains in each for a time interval determined by the time constant of the RC network and the thresholds of the bistable multivibrator.
# EXERCISES 

18.19 For the circuit in Fig. 18.26(b), let the op-amp saturation voltages be $\pm 10 \mathrm{~V}, R_{1}=100 \mathrm{k} \Omega$, $R_{2}=R=1 \mathrm{M} \Omega$, and $C=0.01 \mu \mathrm{~F}$. Find the frequency of oscillation.
Ans. 274 Hz
18.20 Consider a modification of the circuit of Fig. 18.26(b) in which $R_{1}$ is replaced by a pair of diodes connected in parallel in opposite directions. For $L_{+}=-L_{-}=12 \mathrm{~V}, R_{2}=R=10 \mathrm{k} \Omega, C=0.1 \mu \mathrm{~F}$, and the diode voltage as a constant denoted $V_{D}$, find an expression for frequency as a function of $V_{D}$. If $V_{D}=0.70 \mathrm{~V}$ at $25^{\circ} \mathrm{C}$ with a $T C$ of $-2 \mathrm{mV} /{ }^{\circ} \mathrm{C}$, find the frequency at $0^{\circ} \mathrm{C}, 25^{\circ} \mathrm{C}, 50^{\circ} \mathrm{C}$, and $100^{\circ} \mathrm{C}$. Note that the output of this circuit can be sent to a remotely connected frequency meter to provide a digital readout of temperature.
Ans. $f=500 / \ln \left[\left(12+V_{D}\right) /\left(12-V_{D}\right)\right] \mathrm{Hz} ; 3995 \mathrm{~Hz}, 4281 \mathrm{~Hz}, 4611 \mathrm{~Hz}, 5451 \mathrm{~Hz}$

### 18.5.2 Generation of Triangular Waveforms

The exponential waveforms generated in the astable circuit of Fig. 18.24 can be changed to triangular by replacing the low-pass RC circuit with an integrator. (The integrator is, after all, a low-pass circuit with a corner frequency at dc.) The integrator causes linear charging and discharging of the capacitor, thus providing a triangular waveform. The resulting circuit is shown in Fig. 18.27(a). Observe that because the integrator is inverting, it is necessary to invert the characteristics of the bistable circuit. Thus the bistable circuit required here is of the noninverting type and can be implemented using the circuit of Fig. 18.22(a).

We now proceed to show how the feedback loop of Fig. 18.27(a) oscillates and generates a triangular waveform $v_{1}$ at the output of the integrator and a square waveform $v_{2}$ at the output of the bistable circuit: Let the output of the bistable circuit be at $L_{+}$. A current equal to $L_{+} / R$ will flow into the resistor $R$ and through capacitor $C$, causing the output of the integrator to linearly decrease with a slope of $-L_{+} / C R$, as shown in Fig. 18.27(c). This will continue until the integrator output reaches the lower threshold $V_{T L}$ of the bistable circuit, at which point the bistable circuit will switch states, its output becoming negative and equal to $L_{-}$. At this moment the current through $R$ and $C$ will reverse direction, and its value will become equal to $\left|L_{-}\right| / R$. It follows that the integrator output will start to increase linearly with a positive slope equal to $\left|L_{-}\right| / C R$. This will continue until the integrator output voltage reaches the positive threshold of the bistable circuit, $V_{T H}$. At this point the bistable circuit switches, its output becomes positive $\left(L_{+}\right)$, the current into the integrator reverses direction, and the output of the integrator starts to decrease linearly, beginning a new cycle.

From the discussion above, it is relatively easy to derive an expression for the period $T$ of the square and triangular waveforms. During the interval $T_{1}$ we have, from Fig. 18.27(c),

$$
\frac{V_{T H}-V_{T L}}{T_{1}}=\frac{L_{+}}{C R}
$$

from which we obtain

$$
T_{1}=C R \frac{V_{T H}-V_{T L}}{L_{+}}
$$


Figure 18.27 A general scheme for generating triangular and square waveforms.

Similarly, during $T_{2}$ we have

$$
\frac{V_{T H}-V_{T L}}{T_{2}}=\frac{-L_{-}}{C R}
$$

from which we obtain

$$
T_{2}=C R \frac{V_{T H}-V_{T L}}{-L_{-}}
$$

Thus to obtain symmetrical square waves we design the bistable circuit to have $L_{+}=-L_{-}$.

# EXERCISE 

D18.21 Consider the circuit of Fig. 18.27(a) with the bistable circuit realized by the circuit in Fig. 18.22(a). If the op amps have saturation voltages of $\pm 10 \mathrm{~V}$, and if a capacitor $C=0.01 \mu \mathrm{~F}$ and a resistor $R_{1}=10 \mathrm{k} \Omega$ are used, find the values of $R$ and $R_{2}$ (note that $R_{1}$ and $R_{2}$ are associated with the bistable circuit of Fig. 18.22a) such that the frequency of oscillation is 1 kHz and the triangular waveform has a $10-\mathrm{V}$ peak-to-peak amplitude.
Ans. $50 \mathrm{k} \Omega ; 20 \mathrm{k} \Omega$
# 18.6 Generation of a Standardized Pulse: The Monostable Multivibrator 

In some applications the need arises for a pulse of known height and width generated in response to a trigger signal. Because the width of the pulse is predictable, its trailing edge can be used for timing purposes-that is, to initiate a particular task at a specified time. Such a standardized pulse can be generated by the third type of multivibrator, the monostable multivibrator.

The monostable multivibrator has one stable state in which it can remain indefinitely. It also has a quasi-stable state to which it can be triggered and in which it stays for a predetermined interval equal to the desired width of the output pulse. When this interval expires, the monostable multivibrator returns to its stable state and remains there, awaiting another triggering signal. The action of the monostable multivibrator has given rise to its alternative name, the one-shot.

Figure 18.28(a) shows an op-amp monostable circuit. We observe that this circuit is an augmented form of the astable circuit of Fig. 18.26(b). Specifically, a clamping diode $D_{1}$ is added across the capacitor $C_{1}$, and a trigger circuit composed of capacitor $C_{2}$, resistor $R_{4}$, and diode $D_{2}$ is connected to the noninverting input terminal of the op amp. The circuit operates as follows: In the stable state, which prevails in the absence of the triggering signal, the output of the op amp is at $L_{+}$and diode $D_{1}$ is conducting through $R_{3}$ and thus clamping the voltage $v_{B}$ to one diode drop above ground. We select $R_{4}$ much larger than $R_{1}$, so that diode $D_{2}$ will be conducting a very small current and the voltage $v_{C}$ will be very closely determined by the


Figure 18.28 (a) An op-amp monostable circuit. (b) Signal waveforms in the circuit of (a).
voltage divider $R_{1}, R_{2}$. Thus $v_{C}=\beta L_{+}$, where $\beta=R_{1} /\left(R_{1}+R_{2}\right)$. The stable state is maintained because $\beta L_{+}$is greater than $V_{D 1}$.

Now consider the application of a negative-going step at the trigger input and refer to the signal waveforms shown in Fig. 18.28(b). The negative triggering edge is coupled to the cathode of diode $D_{2}$ via capacitor $C_{2}$, and thus $D_{2}$ conducts heavily and pulls node C down. If the trigger signal is of sufficient height to cause $v_{C}$ to go below $v_{B}$, the op amp will see a net negative input voltage and its output will switch to $L_{-}$. This in turn will cause $v_{C}$ to go negative to $\beta L_{-}$, keeping the op amp in its newly acquired state. Note that $D_{2}$ will then cut off, thus isolating the circuit from any further changes at the trigger input terminal.

The negative voltage at A causes $D_{1}$ to cut off, and $C_{1}$ begins to discharge exponentially toward $L_{-}$with a time constant $C_{1} R_{3}$. The monostable multivibrator is now in its quasi-stable state, which will prevail until the declining $v_{B}$ goes below the voltage at node C , which is $\beta L_{-}$. At this instant the op-amp output switches back to $L_{+}$and the voltage at node C goes back to $\beta L_{+}$. Capacitor $C_{1}$ then charges toward $L_{+}$until diode $D_{1}$ turns on and the circuit returns to its stable state.

From Fig. 18.28(b), we observe that a negative pulse is generated at the output during the quasi-stable state. The duration $T$ of the output pulse is determined from the exponential waveform of $v_{B}$,

$$
v_{B}(t)=L_{-}-\left(L_{-}-V_{D 1}\right) e^{-t / C_{1} R_{3}}
$$

by substituting $v_{B}(T)=\beta L_{-}$,

$$
\beta L_{-}=L_{-}-\left(L_{-}-V_{D 1}\right) e^{-T / C_{1} R_{3}}
$$

which yields

$$
T=C_{1} R_{3} \ln \left(\frac{V_{D 1}-L_{-}}{\beta L_{-}-L_{-}}\right)
$$

For $V_{D 1} \ll\left|L_{-}\right|$, this equation can be approximated by

$$
T \simeq C_{1} R_{3} \ln \left(\frac{1}{1-\beta}\right)
$$

Finally, note that the monostable circuit should not be triggered again until capacitor $C_{1}$ has been recharged to $V_{D 1}$; otherwise the resulting output pulse will be shorter than normal. This recharging time is known as the recovery period. Circuit techniques exist for shortening the recovery period.

# EXERCISE 

18.22 For the monostable circuit of Fig. 18.28(a), find the value of $R_{3}$ that will result in a $100-\mu$ s output pulse for $C_{1}=0.1 \mu \mathrm{~F}, \beta=0.1, V_{D}=0.7 \mathrm{~V}$, and $L_{+}=-L_{-}=12 \mathrm{~V}$.
Ans. $6171 \Omega$
# 18.7 Integrated-Circuit Timers 

Commercially available integrated-circuit packages exist that contain the bulk of the circuitry needed to implement monostable and astable multivibrators with precise characteristics. In this section we discuss the most popular of such ICs, the $\mathbf{5 5 5}$ timer. Introduced in 1972 by the Signetics Corporation as a bipolar integrated circuit, the 555 is also available in CMOS technology and from a number of manufacturers. ${ }^{5}$

### 18.7.1 The 555 Circuit

Figure 18.29 shows a block diagram representation of the 555 timer circuit (for the actual circuit, refer to Grebene, 1984). The circuit consists of two comparators, an SR flip-flop, and a transistor $Q_{1}$ that operates as a switch. One power supply $\left(V_{C C}\right)$ is required for operation, with the supply voltage typically 5 V . A resistive voltage divider, consisting of the three equal-valued resistors labeled $R_{1}$, is connected across $V_{C C}$ and establishes the reference (threshold) voltages for the two comparators. These are $V_{T H}=\frac{3}{3} V_{C C}$ for comparator 1 and $V_{T L}=\frac{1}{3} V_{C C}$ for comparator 2.

We studied SR flip-flops in Chapter 16. For our purposes here we note that an SR flip-flop is a bistable circuit having complementary outputs, denoted $Q$ and $\bar{Q}$. In the set state, the output at $Q$ is "high" (approximately equal to $V_{C C}$ ) and that at $\bar{Q}$ is "low" (approximately equal to 0 V ). In the other stable state, termed the reset state, the output at $Q$ is low and that at $\bar{Q}$ is


Figure 18.29 A block diagram representation of the internal circuit of the 555 integrated-circuit timer.

[^0]
[^0]:    ${ }^{5}$ In a recent article in IEEE Spectrum (May 2009), the 555 was selected as one of the " 25 Microchips That Shook the World."
high. The flip-flop is set by applying a high level $\left(V_{C C}\right)$ to its set input terminal, labeled $S$. To reset the flip-flop, a high level is applied to the reset input terminal, labeled $R$. Note that the reset and set input terminals of the flip-flop in the 555 circuit are connected to the outputs of comparator 1 and comparator 2, respectively.

The positive-input terminal of comparator 1 is brought out to an external terminal of the 555 package, labeled Threshold. Similarly, the negative-input terminal of comparator 2 is connected to an external terminal labeled Trigger, and the collector of transistor $Q_{1}$ is connected to a terminal labeled Discharge. Finally, the $Q$ output of the flip-flop is connected to the output terminal of the timer package, labeled Out.

# 18.7.2 Implementing a Monostable Multivibrator Using the 555 IC 

Figure 18.30(a) shows a monostable multivibrator implemented using the 555 IC together with an external resistor $R$ and an external capacitor $C$. In the stable state the flip-flop will be in the reset state, and thus its $\bar{Q}$ output will be high, turning on transistor $Q_{1}$. Transistor $Q_{1}$ will be saturated, and thus $v_{C}$ will be close to 0 V , resulting in a low level at the output of comparator 1. The voltage at the trigger input terminal, labeled $v_{\text {trigger }}$, is kept high (greater than $V_{T L}$ ), and thus the output of comparator 2 also will be low. Finally, note that since the flip-flop is in the reset state, $Q$ will be low and thus $v_{O}$ will be close to 0 V .

To trigger the monostable multivibrator, a negative input pulse is applied to the trigger input terminal. As $v_{\text {trigger }}$ goes below $V_{T L}$, the output of comparator 2 goes to the high level, thus setting the flip-flop. Output $Q$ of the flip-flop goes high, and thus $v_{O}$ goes high, and output $\bar{Q}$ goes low, turning off transistor $Q_{1}$. Capacitor $C$ now begins to charge up through resistor $R$, and its voltage $v_{C}$ rises exponentially toward $V_{C C}$, as shown in Fig. 18.30(b). The monostable multivibrator is now in its quasi-stable state. This state prevails until $v_{C}$ reaches and begins to exceed the threshold of comparator $1, V_{T H}$, at which time the output of comparator 1 goes high, resetting the flip-flop. Output $\bar{Q}$ of the flip-flop now goes high and turns on transistor $Q_{1}$. In turn, transistor $Q_{1}$ rapidly discharges capacitor $C$, causing $v_{C}$ to go to 0 V . Also, when the flip-flop is reset, its $Q$ output goes low, and thus $v_{O}$ goes back to 0 V . The monostable multivibrator is now back in its stable state and is ready to receive a new triggering pulse.

From the description above we see that the monostable multivibrator produces an output pulse $v_{O}$ as indicated in Fig. 18.30(b). The width of the pulse, $T$, is the time interval that the monostable multivibrator spends in the quasi-stable state; it can be determined by reference to the waveforms in Fig. 18.30(b) as follows: Denoting the instant at which the trigger pulse is applied as $t=0$, the exponential waveform of $v_{C}$ can be expressed as

$$
v_{C}=V_{C C}\left(1-e^{-t / C R}\right)
$$

Substituting $v_{C}=V_{T H}=\frac{2}{3} V_{C C}$ at $t=T$ gives

$$
T=C R \ln 3 \simeq 1.1 C R
$$

Thus the pulse width is determined by the external components $C$ and $R$, which can be selected to have values as precise as desired.

### 18.7.3 An Astable Multivibrator Using the 555 IC

Figure 18.31(a) shows the circuit of an astable multivibrator employing a 555 IC, two external resistors, $R_{A}$ and $R_{B}$, and an external capacitor $C$. To see how the circuit operates, refer to the


Figure 18.30 (a) The 555 timer connected to implement a monostable multivibrator. (b) Waveforms of the circuit in (a).

Figure 18.31 (a) The 555 timer connected to implement an astable multivibrator. (b) Waveforms of the circuit in (a).
waveforms depicted in Fig. 18.31(b). Assume that initially $C$ is discharged and the flip-flop is set. Thus $v_{O}$ is high and $Q_{1}$ is off. Capacitor $C$ will charge up through the series combination of $R_{A}$ and $R_{B}$, and the voltage across it, $v_{C}$, will rise exponentially toward $V_{C C}$. As $v_{C}$ crosses the level equal to $V_{T L}$, the output of comparator 2 goes low. This, however, has no effect on the circuit operation, and the flip-flop remains set. Indeed, this state continues until $v_{C}$ reaches and begins to exceed the threshold of comparator $1, V_{T H}$. At this instant of time, the output of comparator 1 goes high and resets the flip-flop. Thus $v_{O}$ goes low, $\bar{Q}$ goes high, and transistor $Q_{1}$ is turned on. The saturated transistor $Q_{1}$ causes a voltage of approximately zero volts to appear at the common node of $R_{A}$ and $R_{B}$. Thus $C$ begins to discharge through $R_{B}$ and the collector of $Q_{1}$. The voltage $v_{C}$ decreases exponentially with a time constant $C R_{B}$ toward 0 V . When $v_{C}$ reaches the threshold of comparator $2, V_{T L}$, the output of comparator 2 , goes high and sets the flip-flop. The output $v_{O}$ then goes high, and $\bar{Q}$ goes low, turning off $Q_{1}$. Capacitor $C$ begins to charge through the series equivalent of $R_{A}$ and $R_{B}$, and its voltage rises exponentially toward $V_{C C}$ with a time constant $C\left(R_{A}+R_{B}\right)$. This rise continues until $v_{C}$ reaches $V_{T H}$, at which time the output of comparator 1 goes high, resetting the flip-flop, and the cycle continues.

From the description above we see that the circuit of Fig. 18.31(a) oscillates and produces a square waveform at the output. The frequency of oscillation can be determined as follows. Reference to Fig. 18.31(b) indicates that the output will be high during the interval $T_{H}$, in which $v_{C}$ rises from $V_{T L}$ to $V_{T H}$. The exponential rise of $v_{C}$ can be described by

$$
v_{C}=V_{C C}-\left(V_{C C}-V_{T L}\right) e^{-t / C\left(R_{A}+R_{B}\right)}
$$

where $t=0$ is the instant at which the interval $T_{H}$ begins. Substituting $v_{C}=V_{T H}=\frac{2}{3} V_{C C}$ at $t=T_{H}$ and $V_{T L}=\frac{1}{3} V_{C C}$ results in

$$
T_{H}=C\left(R_{A}+R_{B}\right) \ln 2 \simeq 0.69 C\left(R_{A}+R_{B}\right)
$$

We also note from Fig. 18.31(b) that $v_{O}$ will be low during the interval $T_{L}$, in which $v_{C}$ falls toward zero, from $V_{T H}$ to $V_{T L}$. The exponential fall of $v_{C}$ can be described by

$$
v_{C}=V_{T H} e^{-t / C R_{B}}
$$

where we have taken $t=0$ as the beginning of the interval $T_{L}$. Substituting $v_{C}=V_{T L}=\frac{1}{3} V_{C C}$ at $t=T_{L}$ and $V_{T H}=\frac{2}{3} V_{C C}$ results in

$$
T_{L}=C R_{B} \ln 2 \simeq 0.69 C R_{B}
$$

Equations (18.43) and (18.45) can be combined to obtain the period $T$ of the output square wave as

$$
T=T_{H}+T_{L}=0.69 C\left(R_{A}+2 R_{B}\right)
$$

Also, the duty cycle of the output square wave can be found from Eqs. (18.43) and (18.45):

$$
\text { Duty cycle } \equiv \frac{T_{H}}{T_{H}+T_{L}}=\frac{R_{A}+R_{B}}{R_{A}+2 R_{B}}
$$

Note that the duty cycle will always be greater than $0.5(50 \%)$; it approaches 0.5 if $R_{A}$ is selected to be much smaller than $R_{B}$ (unfortunately, at the expense of increased supply current).
# EXERCISES 

D18.23 Using a $10-\mathrm{nF}$ capacitor $C$, find the value of $R$ that yields an output pulse of $100 \mu \mathrm{~s}$ in the monostable circuit of Fig. 18.30(a).
Ans. $9.1 \mathrm{k} \Omega$
D18.24 For the circuit in Fig. 18.31(a), with a 1-nF capacitor, find the values of $R_{A}$ and $R_{B}$ that result in an oscillation frequency of 100 kHz and a duty cycle of $75 \%$.
Ans. $7.2 \mathrm{k} \Omega, 3.6 \mathrm{k} \Omega$

### 18.8 Nonlinear Waveform-Shaping Circuits

Diodes or transistors can be combined with resistors to synthesize two-port networks having arbitrary nonlinear transfer characteristics. Such two-port networks can be employed in waveform shaping-that is, changing the waveform of an input signal in a prescribed manner to produce a waveform of a desired shape at the output. In this section we illustrate this application by a concrete example: the sine-wave shaper. This is a circuit whose purpose is to change the waveform of an input triangular-wave signal to a sine wave. Though simple, the sine-wave shaper is a practical building block used extensively in function generators. This method of generating sine waves should be contrasted to that using linear oscillators (Sections 18.1-18.3). Although linear oscillators produce sine waves of high purity, they are not convenient at very low frequencies. Also, linear oscillators are in general more difficult to tune over wide frequency ranges. In the following we discuss two distinctly different techniques for designing sine-wave shapers.

### 18.8.1 The Breakpoint Method

In the breakpoint method the desired nonlinear transfer characteristic (in our case the sine function shown in Fig. 18.32) is implemented as a piecewise linear curve. Diodes are utilized as switches that turn on at the various breakpoints of the transfer characteristic, thus switching into the circuit additional resistors that cause the transfer characteristic to change slope.

Consider the circuit shown in Fig. 18.33(a). It consists of a chain of resistors connected across the entire symmetrical voltage supply $+V,-V$. The purpose of this voltage divider is to generate reference voltages that will serve to determine the breakpoints in the transfer characteristic. In our example these reference voltages are denoted $+V_{2},+V_{1},-V_{1},-V_{2}$. Note that the entire circuit is symmetrical, driven by a symmetrical triangular wave and generating a symmetrical sine-wave output. The circuit approximates each quarter-cycle of the sine wave by three straight-line segments; the breakpoints between these segments are determined by the reference voltages $V_{1}$ and $V_{2}$.

The circuit works as follows: Let the input be the triangular wave shown in Fig. 18.33(b), and consider first the quarter-cycle defined by the two points labeled 0 and 1 . When the input signal is less in magnitude than $V_{1}$, none of the diodes conducts. Thus zero current flows through $R_{4}$, and the output voltage at B will be equal to the input voltage. But as the input


Figure 18.32 Using a nonlinear (sinusoidal) transfer characteristic to shape a triangular waveform into a sinusoid.



Figure 18.33 (a) A three-segment sine-wave shaper. (b) The input triangular waveform and the output approximately sinusoidal waveform.
rises to $V_{1}$ and above, $D_{2}$ (assumed ideal) begins to conduct. Assuming that the conducting $D_{2}$ behaves as a short circuit, we see that, for $v_{I}>V_{1}$,

$$
v_{O}=V_{1}+\left(v_{I}-V_{1}\right) \frac{R_{5}}{R_{4}+R_{5}}
$$

This implies that as the input continues to rise above $V_{1}$, the output follows, but with a reduced slope. This gives rise to the second segment in the output waveform, as shown in Fig. 18.33(b). Note that in developing the equation above we have assumed that the resistances in the voltage divider are low enough in value to cause the voltages $V_{1}$ and $V_{2}$ to be constant independent of the current coming from the input.

Next consider what happens as the voltage at point B reaches the second breakpoint determined by $V_{2}$. At this point, $D_{1}$ conducts, thus limiting the output $v_{O}$ to $V_{2}$ (plus, of course, the voltage drop across $D_{1}$ if it is not assumed to be ideal). This gives rise to the third segment, which is flat, in the output waveform. The overall result is to "bend" the waveform and shape it into an approximation of the first quarter-cycle of a sine wave. Then, beyond the peak of the input triangular wave, as the input voltage decreases, the process unfolds, the output becoming progressively more like the input. Finally, when the input goes sufficiently negative, the process begins to repeat at $-V_{1}$ and $-V_{2}$ for the negative half-cycle.

Although the circuit is relatively simple, its performance is surprisingly good. A measure of goodness usually taken is to quantify the purity of the output sine wave by specifying the percentage total harmonic distortion (THD). This is the percentage ratio of the rms voltage of all harmonic components above the fundamental frequency (which is the frequency of the triangular wave) to the rms voltage of the fundamental (see also Chapter 12). Interestingly, one reason for the good performance of the diode shaper is the beneficial effects produced by the nonideal $i-v$ characteristics of the diodes-that is, the exponential knee of the junction diode as it goes into forward conduction. The consequence is a relatively smooth transition from one line segment to the next.

Practical implementations of the breakpoint sine-wave shaper employ six to eight segments (compared with the three used in the example above). Also, transistors are usually employed to provide more versatility in the design, with the goal being increased precision and lower THD (see Grebene, 1984, pages 592-595).

# 18.8.2 The Nonlinear-Amplification Method 

The other method we discuss for the conversion of a triangular wave into a sine wave is based on feeding the triangular wave to the input of an amplifier having a nonlinear transfer characteristic that approximates the sine function. One such amplifier circuit consists of a differential pair with a resistance connected between the two emitters, as shown in Fig. 18.34. With appropriate choice of the values of the bias current $I$ and the resistance $R$, the differential amplifier can be made to have a transfer characteristic that closely approximates that shown in Fig. 18.32. Observe that for small $v_{I}$ the transfer characteristic of the circuit of Fig. 18.34 is almost linear, as a sine waveform is near its zero crossings. At large values of $v_{I}$ the nonlinear characteristics of the BJTs reduce the gain of the amplifier and cause the transfer characteristic to bend, approximating the sine wave as it approaches its peak. (More details on this circuit can be found in Grebene, 1984, pages 595-597.)


Figure 18.34 A differential pair with an emitter-degeneration resistance used to implement a triangular-wave to sine-wave converter. Operation of the circuit can be graphically described by Fig. 18.32.

# EXERCISES 

D18.25 The circuit in Fig. E18.25 is required to provide a three-segment approximation to the nonlinear $i-v$ characteristic, $i=0.1 v^{2}$, where $v$ is the voltage in volts and $i$ is the current in milliamperes. Find the values of $R_{1}, R_{2}$, and $R_{3}$ such that the approximation is perfect at $v=2 \mathrm{~V}, 4 \mathrm{~V}$, and 8 V . Calculate the error in current value at $v=3 \mathrm{~V}, 5 \mathrm{~V}, 7 \mathrm{~V}$, and 10 V . Assume ideal diodes.


Figure E18.25

Ans. $5 \mathrm{k} \Omega, 1.25 \mathrm{k} \Omega, 1.25 \mathrm{k} \Omega ;-0.3 \mathrm{~mA},+0.1 \mathrm{~mA},-0.3 \mathrm{~mA}, 0$
18.26 A detailed analysis of the circuit in Fig. 18.34 shows that its optimum performance occurs when the values of $I$ and $R$ are selected so that $R I=2.5 V_{T}$, where $V_{T}$ is the thermal voltage. For this design, the peak amplitude of the input triangular wave should be $6.6 V_{T}$, and the corresponding sine wave across $R$ has a peak value of $2.42 V_{T}$. For $I=0.25 \mathrm{~mA}$ and $R_{C}=10 \mathrm{k} \Omega$, find the peak amplitude of the sine-wave output $v_{O}$. Assume $\alpha \simeq 1$.
Ans. 4.84 V
# Summary 

- There are two distinctly different types of signal generator: the linear oscillator, which utilizes some form of resonance, and the nonlinear oscillator or function generator, which employs a switching mechanism implemented with a multivibrator circuit.
- A linear oscillator can be realized by placing a frequency-selective network in the feedback path of an amplifier (an op amp or a transistor). The circuit will oscillate at the frequency at which the total phase shift around the loop is zero or $360^{\circ}$, provided the magnitude of loop gain at this frequency is equal to, or greater than, unity.
- If in an oscillator the magnitude of loop gain is greater than unity, the amplitude will increase until a nonlinear amplitude-control mechanism is activated.
- The Wien-bridge oscillator, the phase-shift oscillator, the quadrature oscillator, and the active-filter-tuned oscillator are popular configurations for frequencies up to about 1 MHz . These circuits employ RC networks together with op amps or transistors. For higher frequencies, LC-tuned or crystal-tuned oscillators are utilized. Popular configurations include the Colpitts circuit for discrete-circuit implementation and the cross-coupled circuit for IC implementation at frequencies as high as hundreds of gigahertz.
- Crystal oscillators provide the highest possible frequency accuracy and stability.
- There are three types of multivibrator: bistable, monostable, and astable. Op-amp circuit implementations
of multivibrators are useful in analog-circuit applications that require high precision.
- The bistable multivibrator has two stable states and can remain in either state indefinitely. It changes state when triggered. A comparator with hysteresis is bistable.
- A monostable multivibrator, also known as a one-shot, has one stable state, in which it can remain indefinitely. When triggered, it goes into a quasi-stable state in which it remains for a predetermined interval, thus generating, at its output, a pulse of known width.
- An astable multivibrator has no stable state. It oscillates between two quasi-stable states, remaining in each for a predetermined interval. It thus generates a periodic waveform at the output.
- A feedback loop consisting of an integrator and a bistable multivibrator can be used to generate triangular and square waveforms.
- The 555 timer, a commercially available IC, can be used with external resistors and a capacitor to implement high-quality monostable and astable multivibrators.
- A sine waveform can be generated by feeding a triangular waveform to a sine-wave shaper. A sine-wave shaper can be implemented either by using diodes (or transistors) and resistors, or by using an amplifier having a nonlinear transfer characteristic that approximates the sine function.


## PROBLEMS

## Section 18.1: Basic Principles of Sinusoidal Oscillators

18.1 Consider a sinusoidal oscillator consisting of an amplifier having a frequency-independent gain $A$ (where $A$ is positive) and a second-order bandpass filter with a pole frequency $\omega_{0}$, a pole $Q$ denoted $Q$, and a positive center-frequency gain $K$. Find the frequency of oscillation, and the condition that $A$ and $K$ must satisfy for sustained oscillation.
18.2 For the oscillator circuit described in Problem 18.1:
(a) Derive an expression for $d \phi / d \omega$, evaluated at $\omega=\omega_{0}$.
(b) Use the result of (a) to find an expression for the per-unit change in frequency of oscillation resulting from a phase-angle change of $\Delta \phi$, in the amplifier transfer function.

$$
\text { Hint: } \frac{d}{d x}\left(\tan ^{-1} y\right)=\frac{1}{1+y^{2}} \frac{d y}{d x}
$$

18.3 For the oscillator described in Problem 18.1, show that, independent of the value of $A$ and $K$, the poles of the circuit

[^0]
[^0]:    518 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
lie at a radial distance of $\omega_{0}$. Find the value of $A K$ that results in poles appearing (a) on the $j \omega$ axis, and (b) in the right half of the $s$ plane, at a horizontal distance from the $j \omega$ axis of $\omega_{0} /(2 Q)$.

D 18.4 For the oscillator circuit in Fig. 18.3(a) find the percentage change in the oscillation frequency resulting from a change of $+1 \%$ in the value of (a) $L$, (b) $C$, and (c) $R$.
18.5 An oscillator is formed by loading a transconductance amplifier having a positive gain with a parallel RLC circuit and connecting the output directly to the input (thus applying positive feedback with a factor $\beta=1$ ). Let the transconductance amplifier have an input resistance of $5 \mathrm{k} \Omega$ and an output resistance of $5 \mathrm{k} \Omega$. The LC resonator has $L=1 \mu \mathrm{H}$, $C=100 \mathrm{pF}$, and $Q=50$. For what value of transconductance $G_{m}$ will the circuit oscillate? At what frequency?
18.6 In a particular oscillator characterized by the structure of Fig. 18.1, the frequency-selective network exhibits a loss of 12 dB and a phase shift of $180^{\circ}$ at $\omega_{0}$. Give the phase shift and the minimum gain that the amplifier must have for oscillation to begin.
18.7 An oscillator is designed by connecting in a loop three identical common-source amplifier stages of the type shown in Fig. P18.7. Note that the bias circuits are not shown, and assume that $R$ and $C$ include the transistor output resistance and capacitance, respectively. For the circuit to oscillate at a frequency $\omega_{0}$, what must the phase angle provided by each amplifier stage be? Give an expression for $\omega_{0}$. For sustained oscillations, what is the minimum $g_{m}$ required of each transistor?


Figure P18.7

D 18.8 Consider the circuit of Fig. 18.4(a) with $R_{f}$ removed to realize the comparator function. Find suitable values for all resistors so that the comparator output levels are $\pm 3 \mathrm{~V}$ and the slope of the limiting characteristic is 0.05 . Use power-supply voltages of $\pm 5 \mathrm{~V}$ and assume the voltage drop of a conducting diode to be 0.7 V .

D 18.9 Consider the circuit of Fig. 18.4(a) with $R_{f}$ removed to realize the comparator function. Sketch the transfer characteristic. Show that by connecting a dc source $V_{R}$ to the virtual ground of the op amp through a resistor $R_{R}$, the transfer characteristic is shifted along the $v_{1}$ axis to the point $v_{1}=-\left(R_{1} / R_{R}\right) V_{R}$. Utilizing available $\pm 5-\mathrm{V}$ dc supplies for $\pm V$ and for $V_{R}$, find suitable component values so that the limiting levels are $\pm 3 \mathrm{~V}$ and the comparator threshold is at $v_{1}=+2 \mathrm{~V}$. Neglect the diode voltage drop (i.e., assume that $V_{D}=0$ ). The input resistance of the comparator is to be $100 \mathrm{k} \Omega$, and the slope in the limiting regions is to be $\leq 0.05 \mathrm{~V} / \mathrm{V}$. Use standard $5 \%$ resistors (see Appendix J).
18.10 Denoting the zener voltages of $Z_{1}$ and $Z_{2}$ by $V_{Z 1}$ and $V_{Z 2}$ and assuming that in the forward direction the voltage drop


Figure P18.10

[^0]
[^0]:    $S I N=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
is approximately 0.7 V , sketch and clearly label the transfer characteristics $v_{o}-v_{t}$ of the circuits in Fig. P18.10. Assume the op amps to be ideal.

## Section 18.2: Op Amp-RC Oscillator Circuits

18.11 For the Wien-bridge oscillator circuit in Fig. 18.5, show that the transfer function of the feedback network $\left[V_{o}(s) / V_{o}(s)\right]$ is that of a bandpass filter. Find $\omega_{0}$ and $Q$ of the poles, and find the center-frequency gain.
18.12 For the Wien-bridge oscillator of Fig. 18.5, let the closed-loop amplifier (formed by the op amp and the resistors $R_{1}$ and $R_{2}$ ) exhibit a phase shift of $-3^{\circ}$ in the neighborhood of $\omega=1 / C R$. Find the frequency at which oscillations can occur in this case in terms of $C R$. (Hint: Use Eq. 18.11.)
18.13 For the Wien-bridge oscillator of Fig. 18.5, use the expression for loop gain in Eq. (18.10) to find the poles of the closed-loop system. Give the expression for the pole $Q$, and use it to show that to locate the poles in the right half of the $s$ plane, $R_{2} / R_{1}$ must be selected to be greater than 2.

D 18.14 Reconsider Exercise 18.5 with $R_{3}$ and $R_{6}$ increased to reduce the output voltage. What values are required for a peak-to-peak output of 8 V ? What results if $R_{3}$ and $R_{6}$ are open-circuited?
18.15 For the circuit in Fig. P18.15, find $L(s), L(j \omega)$, the frequency for zero loop phase, and $R_{2} / R_{1}$ for oscillation. Assume the op amp to be ideal.


Figure P18.15
18.16 Repeat Problem 18.15 for the circuit in Fig. P18.16.


Figure P18.16
*18.17 Consider the circuit of Fig. 18.7 with the $50-\mathrm{k} \Omega$ potentiometer replaced by two fixed resistors: $10 \mathrm{k} \Omega$ between the op amp's negative input and ground, and $15 \mathrm{k} \Omega$. Modeling each diode as a $0.65-\mathrm{V}$ battery in series with a $100-\Omega$ resistance, find the peak-to-peak amplitude of the output sinusoid.

D **18.18 Design the circuit of Fig. 18.7 for operation at 10 kHz using $R=10 \mathrm{k} \Omega$. If at 10 kHz the op amp provides an excess phase shift (lag) of $5.7^{\circ}$, what will be the frequency of oscillation? (Assume that the phase shift introduced by the op amp remains constant for frequencies around 10 kHz .) To restore operation to 10 kHz , what change must be made in the shunt resistor of the Wien bridge? Also, to what value must $R_{2} / R_{1}$ be changed?
*18.19 For the circuit of Fig. 18.9, connect an additional resistor $(R=10 \mathrm{k} \Omega)$ in series with the rightmost capacitor $C$. For this modification (and ignoring the amplitude stabilization circuitry), find the loop gain $A \beta$ by breaking the circuit at node $X$. Find $R_{f}$ for oscillation to begin, and find $f_{0}$.

D 18.20 For the circuit in Fig. P18.19, break the loop at node $X$ and find the loop gain (working backward for simplicity to

[^0]
[^0]:    $\mathrm{III} \mathrm{=Multisim/PSpice;*}=$ difficult problem; ${ }^{* *}=$ more difficult; ${ }^{* * *}=$ very challenging; $\mathrm{D}=$ design problem


Figure P18.20
find $V_{s}$ in terms of $V_{o}$ ). For $R=10 \mathrm{k} \Omega$, find $C$ and $R_{f}$ to obtain sinusoidal oscillations at 15 kHz .
*18.21 Consider the quadrature-oscillator circuit of Fig. 18.10 without the limiter. Let the resistance $R_{f}$ be equal to $2 R /(1+\Delta)$, where $\Delta \ll 1$. Show that the poles of the characteristic equation are in the right-half $s$ plane and given by $s \simeq(1 / C R)[(\Delta / 4) \pm j]$.

D 18.22 Using $C=1.6 \mathrm{nF}$, find the value of $R$ such that the circuit of Fig. 18.12 produces $10-\mathrm{kHz}$ sine waves. If the diode drop is 0.7 V , find the peak-to-peak amplitude of the output sine wave. How do you modify the circuit to double the output amplitude? (Hint: A square wave with peak-to-peak amplitude of $V$ volts has a fundamental component with $4 V / \pi$ volts peak-to-peak amplitude.)
*18.23 Assuming that the diode-clipped waveform in Exercise 18.9 is nearly an ideal square wave and that the resonator $Q$ is 20 , provide an estimate of the distortion in the output sine wave by calculating the magnitude (relative to the fundamental) of
(a) the second harmonic
(b) the third harmonic
(c) the fifth harmonic
(d) the rms of harmonics to the tenth

Note that a square wave of amplitude $V$ and frequency $\omega$ is represented by the series

$$
\frac{4 V}{\pi}\left(\sin \omega t+\frac{1}{3} \sin 3 \omega t+\frac{1}{5} \sin 5 \omega t+\frac{1}{7} \sin 7 \omega t+\ldots\right)
$$

## Section 18.3: LC and Crystal Oscillators

18.24 For the Colpitts oscillator circuit in Fig. P18.24, derive an equation governing circuit operation and hence find the frequency of oscillation and the condition on the gain $g_{m} R_{L}$ that ensures that oscillations will start. Assume that $R_{L}$ includes $r_{o}$ of $Q_{1}$. Simplify your final expressions by assuming $r_{o}$ is large. Observe that this circuit is based on the configuration in Fig. 18.13(a) except that here the biasing circuit is included and the collector is placed at signal ground.


Figure P18.24
18.25 For the Colpitts oscillator circuit in Fig. P18.25, derive an equation governing circuit operation and hence find the frequency of oscillation and the condition the gain $g_{m} R_{L}$ mustsatisfy for oscillations to start. Assume that $R_{L}$ includes the MOSFET's $r_{o}$.


Figure P18.25
18.26 For the Colpitts oscillator circuit in Fig. P18.26, derive an equation governing circuit operation and hence find the frequency of oscillation and the condition the gain $g_{a s} R_{L}$ must satisfy to ensure that oscillations will start. Neglect $r_{o}$ of the BJT. Simplify your final expressions by assuming that $r_{a}$ is large. Note that this circuit is based on the configuration of Fig. 18.13(a) but with the bias circuit included and the base grounded.


Figure P18.26
18.27 For the Colpitts oscillator circuit in Fig. P18.27, derive an equation governing circuit operation and hence find the frequency of oscillation and the condition the gain $g_{a s} R_{L}$ must satisfy to ensure that oscillations will start. Assume that $r_{a}$
of the BJT is included in $R_{L}$ and neglect $R_{l}$ (i.e., assume $R_{l} \gg \omega_{0} L$ ). Simplify your final expressions by assuming $r_{a}$ is large. Observe that this circuit is similar to that in Fig. 18.15 except for utilizing a different biasing scheme.


Figure P18.27
*18.28 The LC oscillator in Fig. P18.28 is based on connecting a positive-gain amplifier (formed by $Q_{1}, Q_{2}$, and $R_{C}$ ) with a bandpass RLC circuit in a feedback loop.


Figure P18.28

[^0]
[^0]:    $\mathrm{AM}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; $\mathrm{D}=$ design problem
(a) Replace the BJTs with their small-signal models while neglecting $r_{o}$ and $r_{o}$ (to simplify matters).
(b) By inspection of the circuit found in (a), find the frequency of oscillation and the condition required for oscillations to start. Express the latter as the minimum required value of $\left(I R_{C}\right)$.
(c) If $I R_{C}$ is selected equal to 1 V , show that oscillations will start. If oscillations grow to the point that $V_{o}$ is large enough to turn the BJTs on and off, show that the signal at the collector of $Q_{2}$ will be a square wave of 1 V peak-to-peak. Estimate the peak-to-peak amplitude of the output sine wave $V_{o}$.

D 18.29 Design the cross-coupled LC oscillator of Fig. 18.16(a) to operate at $\omega_{0}=20 \mathrm{Grad} / \mathrm{s}$. The IC inductors available have $L=5 \mathrm{nH}$ and $Q=10$. If the transistor $r_{o}=5 \mathrm{k} \Omega$, find the required value of $C$ and the minimum required value of $g_{m}$ at which $Q_{1}$ and $Q_{2}$ are to be operated.
18.30 Consider the Pierce crystal oscillator of Fig. 18.18 with the crystal as specified in Exercise 18.13. Let $C_{1}$ be variable in the range 1 pF to 10 pF , and let $C_{2}$ be fixed at 10 pF . Find the range over which the oscillation frequency can be tuned. (Hint: Use the result in the statement leading to the expression in Eq. 18.29.)

## Section 18.4: Bistable Multivibrators

D 18.31 Design the bistable circuit in Fig. 18.21(a) to obtain a hysteresis of 2-V width. The op amp saturates at $\pm 5 \mathrm{~V}$. Select $R_{1}=10 \mathrm{k} \Omega$ and determine $R_{2}$.
18.32 Consider the bistable circuit of Fig. 18.21(a) with the op amp's positive input terminal connected to a positive-voltage source $V$ through a resistor $R_{3}$.
(a) Derive expressions for the threshold voltages $V_{T L}$ and $V_{T H}$ in terms of the op amp's saturation levels $L_{+}$and $L_{-}, R_{1}$, $R_{2}, R_{3}$, and $V$.
(b) Let $L_{+}=-L_{-}=10 \mathrm{~V}, V=15 \mathrm{~V}$, and $R_{1}=10 \mathrm{k} \Omega$. Find the values of $R_{2}$ and $R_{3}$ that result in $V_{T L}=+4.9 \mathrm{~V}$ and $V_{T H}=+5.1 \mathrm{~V}$.
18.33 Consider the bistable circuit of Fig. 18.22(a) with the op amp's negative-input terminal disconnected from ground and connected to a reference voltage $V_{R}$.
(a) Derive expressions for the threshold voltages $V_{T L}$ and $V_{T H}$ in terms of the op amp's saturation levels $L_{+}$and $L_{-}, R_{1}$, $R_{2}$, and $V_{R}$.
(b) Let $L_{+}=-L_{-}=V$ and $R_{1}=10 \mathrm{k} \Omega$. Find $R_{2}$ and $V_{R}$ that result in threshold voltages of 0 and $V / 10$.
18.34 For the circuit in Fig. P18.34, sketch and label the transfer characteristic $v_{t I}-v_{I}$. The diodes are assumed to have a constant $0.7-\mathrm{V}$ drop when conducting, and the op amp saturates at $\pm 12 \mathrm{~V}$. What is the maximum diode current?


Figure P18.34
18.35 Consider the circuit of Fig. P18.34 with $R_{1}$ eliminated and $R_{2}$ short-circuited. Sketch and label the transfer characteristic $v_{t I}-v_{I}$. Assume that the diodes have a constant $0.7-\mathrm{V}$ drop when conducting and that the op amp saturates at $\pm 12 \mathrm{~V}$.
*18.36 Consider a bistable circuit having a noninverting transfer characteristic with $L_{+}=-L_{-}=12 \mathrm{~V}, V_{T L}=-1 \mathrm{~V}$, and $V_{T H}=+1 \mathrm{~V}$.
(a) For a $0.5-\mathrm{V}$-amplitude sine-wave input having zero average, what is the output?
(b) Describe the output if a sinusoid of frequency $f$ and amplitude of 1.1 V is applied at the input. By how much can the average of this sinusoidal input shift before the output becomes a constant value?

D 18.37 Design the circuit of Fig. 18.25(a) to realize a transfer characteristic with $\pm 7.5-\mathrm{V}$ output levels and $\pm 7.5-\mathrm{V}$ threshold values. Design so that when $v_{I}=0 \mathrm{~V}$ a current of 0.5 mA flows in the feedback resistor and a current of 1 mA flows through the zener diodes. Assume that the output saturation levels of the op amp are $\pm 10 \mathrm{~V}$. Specify the voltages of the zener diodes and give the values of all resistors.

[^0]
[^0]:    $\mathrm{SHM}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem


Figure P18.41

## Section 18.5: Generation of Square and Triangular Waveforms Using Astable Multivibrators

18.38 Find the frequency of oscillation of the circuit in Fig. 18.26(b) for the case $R_{1}=10 \mathrm{k} \Omega, R_{2}=16 \mathrm{k} \Omega, C=5 \mathrm{nF}$, and $R=62 \mathrm{k} \Omega$.

D 18.39 Augment the astable multivibrator circuit of Fig. 18.26(b) with an output limiter of the type shown in Fig. 18.25(b). Design the circuit to obtain an output square wave with $5-\mathrm{V}$ amplitude and $1-\mathrm{kHz}$ frequency using a $10-\mathrm{nF}$ capacitor $C$. Use $\beta=0.462$, and design for a current in the resistive divider approximately equal to the average current in the RC network over a half-cycle. Assuming $\pm 13-\mathrm{V}$ op-amp saturation voltages, arrange for the zener to operate at a minimum current of 1 mA . Specify the values of all resistors and the zenor voltage.

D 18.40 Using the scheme of Fig. 18.27, design a circuit that provides square waves of 10 V peak to peak and triangular waves of 10 V peak to peak. The frequency is to be 1 kHz . Implement the bistable circuit with the circuit of Fig. 18.25(b). Use a $0.01-\mu \mathrm{F}$ capacitor and specify the values of all resistors and the required zener voltage. Design for a minimum zener current of 1 mA and for a maximum current in the resistive divider of 0.2 mA . Assume that the output saturation levels of the op amps are $\pm 12 \mathrm{~V}$.

D *18.41 The circuit of Fig. P18.41 consists of an inverting bistable multivibrator with an output limiter and a
noninverting integrator. Using equal values for all resistors except $R_{7}$ and a $0.5-\mathrm{nF}$ capacitor, design the circuit to obtain a square wave at the output of the bistable multivibrator of $15-\mathrm{V}$ peak-to-peak amplitude and $10-\mathrm{kHz}$ frequency. Sketch and label the waveform at the integrator output. Assuming $\pm 13-\mathrm{V}$ op-amp saturation levels, design for a minimum zener current of 1 mA . Specify the zener voltage required, and give the values of all resistors.

## Section 18.6: Generation of a Standardized Pulse-The Monostable Multivibrator

D 18.42 For the monostable circuit considered in Exercise 18.22, calculate the recovery time.
*18.43 Figure P18.43 shows a monostable multivibrator circuit. In the stable state, $v_{O}=L_{+}, v_{A}=0$, and $v_{B}=-V_{\text {ref }}$. The circuit can be triggered by applying a positive input pulse of height greater than $V_{\text {ref }}$. For normal operation, $C_{1} R_{1} \ll$ $C R$. Show the resulting waveforms of $v_{O}$ and $v_{A}$. Also, show that the pulse generated at the output will have a width $T$ given by

$$
T=C R \ln \left(\frac{L_{+}-L_{-}}{V_{\text {ref }}}\right)
$$

Note that this circuit has the interesting property that the pulse width can be controlled by changing $V_{\text {ref }}$.


Figure P18.43

D *18.44 Using the circuit of Fig. 18.28, with a nearly ideal op amp for which the saturation levels are $\pm 13 \mathrm{~V}$, design a monostable multivibrator to provide a negative output pulse of $100-\mu \mathrm{s}$ duration. Use capacitors of 0.1 nF and 1 nF . Wherever possible, choose resistors of $100 \mathrm{k} \Omega$ in your design. Diodes have a drop of 0.7 V . What is the minimum input step size that will ensure triggering? How long does the circuit take to recover to a state in which retriggering is possible with a normal output?

## Section 18.7: Integrated-Circuit Timers

18.45 Consider the 555 circuit of Fig. 18.29 when the Threshold and the Trigger input terminals are joined together and connected to an input voltage $v_{i}$. Verify that the transfer characteristic $v_{i t}-v_{t}$ is that of an inverting bistable circuit with thresholds $V_{t L}=\frac{1}{3} V_{c c}$ and $V_{t H}=\frac{2}{3} V_{c c}$ and output levels of 0 and $V_{c C}$.

D 18.46 (a) Using a $0.5-\mathrm{nF}$ capacitor $C$ in the circuit of Fig. 18.30(a), find the value of $R$ that results in an output pulse of $10-\mu \mathrm{s}$ duration.
(b) If the 555 timer used in (a) is powered with $V_{c c}=12 \mathrm{~V}$, and assuming that $V_{t H}$ can be varied externally (i.e., it need not remain equal to $\frac{2}{3} V_{c c}$ ), find its required value so that the pulse width is increased to $20 \mu \mathrm{~s}$, with other conditions the same as in (a).

D 18.47 Using a $680-\mathrm{pF}$ capacitor, design the astable circuit of Fig. 18.31(a) to obtain a square wave with a $20-\mathrm{kHz}$ frequency and an $80 \%$ duty cycle. Specify the values of $R_{A}$ and $R_{B}$.
*18.48 The node in the 555 timer at which the voltage is $V_{t H}$ (i.e., the inverting input terminal of comparator 1) is usually
connected to an external terminal. This allows the user to change $V_{t H}$ externally (i.e., $V_{t H}$ no longer remains at $\frac{2}{3} V_{c c}$ ). Note, however, that whatever the value of $V_{t H}$ becomes, $V_{t L}$ always remains $\frac{1}{2} V_{t H}$.
(a) For the astable circuit of Fig. 18.31, rederive the expressions for $T_{H}$ and $T_{L}$, expressing them in terms of $V_{t H}$ and $V_{t L}$.
(b) For the case $C=1 \mathrm{nF}, R_{A}=7.2 \mathrm{k} \Omega, R_{B}=3.6 \mathrm{k} \Omega$, and $V_{c c}=5 \mathrm{~V}$, find the frequency of oscillation and the duty cycle of the resulting square wave when no external voltage is applied to the terminal $V_{t H}$.
(c) For the design in (b), let a sine-wave signal of a much lower frequency than that found in (b) and of 1-V peak amplitude be capacitively coupled to the circuit node $V_{t H}$. This signal will cause $V_{t H}$ to change around its quiescent value of $\frac{2}{3} V_{c c}$, and thus $T_{H}$ will change correspondingly-a modulation process. Find $T_{H}$, and find the frequency of oscillation and the duty cycle at the two extreme values of $V_{t H}$.

## Section 18.8: Nonlinear Waveform-Shaping Circuits

D *18.49 The two-diode circuit shown in Fig. P18.49 can provide a crude approximation to a sine-wave output when driven by a triangular waveform. To obtain a good approximation, we select the peak of the triangular waveform, $V$, so that the slope of the desired sine wave at the zero crossings is equal to that of the triangular wave. Also, the value of $R$ is selected so that when $v_{t}$ is at its peak, the output voltage is equal to the desired peak of the sine wave. If the diodes exhibit a voltage drop of 0.7 V at $1-\mathrm{mA}$ current, changing at the rate of 0.1 V per decade, find the values of $V$ and $R$ that will yield an approximation to a sine waveform of $0.7-\mathrm{V}$ peak amplitude. Then find the angles $\theta$ (where $\theta=90^{\circ}$ when $v_{t}$ is at its peak) at which the output of the circuit, in volts, is $0.7,0.65,0.6,0.55,0.5,0.4,0.3,0.2,0.1$, and 0 . Use the


Figure P18.49

[^0]
[^0]:    SIN = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
angle values obtained to determine the values of the exact sine wave (i.e., $0.7 \sin \theta$ ), and thus find the percentage error of this circuit as a sine shaper. Provide your results in tabular form.

D 18.50 Design a two-segment sine-wave shaper using a $6.8-\mathrm{k} \Omega$-input resistor, two diodes, and two clamping voltages. The circuit, fed by an $8-\mathrm{V}$ peak-to-peak triangular wave, should limit the amplitude of the output signal via a $0.7-\mathrm{V}$ diode to a value corresponding to that of a sine wave whose zero-crossing slope matches that of the triangle. What are the clamping voltages you have chosen?
18.51 Show that the output voltage of the circuit in Fig. P18.51 is given by

$$
v_{O}=-V_{T} \ln \left(\frac{v_{I}}{I_{S} R}\right), \quad v_{I}>0
$$



Figure P18.51
where $I_{S}$ is the saturation current of the diode and $V_{T}$ is the thermal voltage. Since the output voltage is proportional to the logarithm of the input voltage, the circuit is known as a logarithmic amplifier. Such amplifiers find application in situations where it is desired to compress the signal range.
18.52 Verify that the circuit in Fig. P18.52 implements the transfer characteristic $v_{O}=-v_{1} v_{2}$ for $v_{1}, v_{2}>0$. Such a circuit is known as an analog multiplier. Check the circuit's performance for various combinations of input voltage of values, say, $0.5 \mathrm{~V}, 1 \mathrm{~V}, 2 \mathrm{~V}$, and 3 V . Assume all diodes to be identical, with $700-\mathrm{mV}$ drop at $1-\mathrm{mA}$ current. Note that a squarer can easily be produced using a single input (e.g., $v_{1}$ ) connected via a $0.5-\mathrm{k} \Omega$ resistor (rather than the $1-\mathrm{k} \Omega$ resistor shown).
**18.53 Detailed analysis of the circuit in Fig. 18.34 shows that optimum performance (as a sine shaper) occurs when the values of $I$ and $R$ are selected so that $R I=2.5 V_{T}$, where $V_{T}$ is the thermal voltage, and the peak amplitude of the input triangular wave is $6.6 V_{T}$. If the output is taken across $R$ (i.e., between the two emitters), find $v_{I}$ corresponding to $v_{O}=0.25 V_{T}, 0.5 V_{T}, V_{T}, 1.5 V_{T}, 2 V_{T}, 2.4 V_{T}$, and $2.42 V_{T}$. Plot $v_{O}-v_{I}$ and compare to the ideal curve given by

$$
v_{O}=2.42 V_{T} \sin \left(\frac{v_{I}}{6.6 V_{T}} \times 90^{\circ}\right)
$$



Figure P18.52

[^0]
[^0]:    $\mathrm{SH} \mid=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
# APPENDICES ON COMPANION WEBSITE 

For your convenience, ten additional chapters on important reference topics are included on the Companion Website. In PDF format, the Appendices are fully searchable and can be bookmarked.
Appendix A: VLSI Fabrication Technology This article is a concise explanation of the technology that goes into fabricating integrated circuits. The different processes used are described and compared, and the characteristics of the resulting devices presented. Design considerations that restrict IC designers are explored.
Appendix B: SPICE Device Models and Design and Simulation Examples Using PSpice ${ }^{\circledR}$ and Multisim ${ }^{\text {TM }}$ This three-part appendix could stand as a book on its own. Part 1 describes the models SPICE programs use to represent op amps, diodes, MOSFETs, and BJTs in integrated circuits. A thorough understanding of these models is critical for designers trying to extract meaningful information from an analysis. Part 2 describes and discusses all the PSpice ${ }^{\circledR}$ simulations, while Part 3 does the same for the Multisim ${ }^{\text {TM }}$ simulations. This is a rich resource to help analyze, experiment with, and design circuits that relate to the topics studied in Microelectronic Circuits.
Appendix C: Two-Port Network Parameters Throughout the text, we use different possible ways to characterize linear two-port networks. This appendix summarizes the $y$, $z, h$, and $g$ parameters and provides their equivalent-circuit representations.
Appendix D: Some Useful Network Theorems This article reviews Thévenin's theorem, Norton's theorem, and the source-absorption theorem, all of which are useful in simplifying the analysis of electronic circuits.
Appendix E: Single-Time-Constant Circuits STC circuits are composed of, or can be reduced to, one reactive component (inductance or capacitance) and one resistance. This is important to the design and analysis of linear and digital circuits. Analyzing an amplifier circuit can usually be reduced to the analysis of one or more STC circuits.
Appendix F: s-Domain Analysis: Poles, Zeroes, and Bode Plots Most of the work in analyzing the frequency response of an amplifier involves finding the amplifier voltage gain as a function of the complex frequency $s$. The tools to do this are summarized in this appendix.
Appendix G: Comparison of the MOSFET and the BJT Provides a comprehensive compilation and comparison of the properties of the MOSFET and the BJT. The comparison is aided by the inclusion of typical parameter values of devices fabricated with modern process technologies.
Appendix H: Design of Stagger-Tuned Amplifiers Provides a systematic procedure for the design of this type of tuned amplifier (Section 17.12.6).
Appendix I: Bibliography An excellent resource for students beginning research projects, this bibliography outlines key reference works on electronic circuits, circuit and system analysis, devices and IC fabrication, op amps, analog and digital circuits, filters and tuned amplifiers, and SPICE.
Appendix L: Answers to Selected Problems.
# VLSI FABRICATION TECHNOLOGY 

## Introduction

Since the first edition of this text, we have witnessed a fantastic evolution in VLSI (very-large-scale integrated circuits) technology. In the late 1970s, non-self-aligned metal gate MOSFETs with gate lengths in the order of $10 \mu \mathrm{~m}$ were the norm. Current VLSI fabrication technology is already at the physical scaling limit with gate lengths in the $20-\mathrm{nm}$ regime. This represents a reduction in device size of almost 1000x, along with an even more impressive increase in the number of devices per VLSI chip. Future development in VLSI technology must rely on new device concepts and new materials, taking quantum effects into account. While this is a very exciting time for researchers to explore new technology, we can also be assured that the "traditional" CMOS and BiCMOS (bipolar CMOS) fabrication technology will continue to be the workhorse of the microelectronic industry for many more years to come.

The purpose of this appendix is to familiarize the reader with VLSI fabrication technology. Brief explanations of standard VLSI processing steps are given. The variety of devices available in CMOS and BiCMOS fabrication technologies are also presented. In particular, the availability of components in the IC (integrated circuit) environment that are distinct from discrete circuit design will be discussed. In order to enjoy the economics of integrated circuits, designers have to overcome some serious device limitations (such as poor device tolerances) while exploiting device advantages (such as good component matching). An understanding of device characteristics is therefore essential in designing high-performance custom VLSIs.

This appendix will consider only silicon-based (Si) technologies. Although other compound materials in groups III through V, such as gallium arsenide (GaAs) and aluminum gallium nitride (AlGaN), are also used to implement VLSI chips, silicon is still the most popular material, with excellent cost-performance trade-off. Recent development in SiGe and strained-silicon technologies will further strengthen the position of Si-based fabrication processes in the microelectronic industry for many more years to come.

Silicon is an abundant element and occurs naturally in the form of sand. It can be refined using well-established purification and crystal growth techniques. It also exhibits suitable physical properties for fabricating active devices with good electrical characteristics. In addition, silicon can be easily oxidized to form an excellent insulator, $\mathrm{SiO}_{2}$ (glass). This native oxide is useful for constructing capacitors and MOSFETs. It also serves as a diffusion barrier that can mask against unwanted impurities from diffusing into the high-purity silicon material. This masking property allows the electrical properties of the silicon to be altered in predefined areas. Therefore, active and passive elements can be built on the same piece of material (substrate). The components can then be interconnected using metal layers (similar to those used in printed-circuit boards) to form a monolithic IC.
# A. 1 IC Fabrication Steps 

The basic IC fabrication steps will be described in the following sections. Some of these steps may be carried out many times, in different combinations and/or processing conditions during a complete fabrication run.

## A.1.1 Silicon Wafers

The starting material for modern integrated circuits is very-high-purity, single-crystal silicon. The material is initially grown as a single crystal ingot. It takes the shape of a steel-gray solid cylinder 10 cm to 30 cm in diameter and can be one to two meters in length. This crystal is then sawed (like a loaf of bread) to produce circular wafers that are $400 \mu \mathrm{~m}$ to $600 \mu \mathrm{~m}$ thick (a micrometer, or micron, $\mu \mathrm{m}$, is a millionth of a meter). The surface of the wafer is then polished to a mirror finish using chemical and mechanical polishing (CMP) techniques. Semiconductor manufacturers usually purchase ready-made silicon wafers from a supplier and rarely start their fabrication process in ingot form.

The basic electrical and mechanical properties of the wafer depend on the orientation of the crystalline structure, the impurity concentrations, and the type of impurities present. These variables are strictly controlled during crystal growth. A specific amount of impurities can be added to the pure silicon in a process known as doping. This allows the alteration of the electrical properties of the silicon, in particular its resistivity. Depending on the types of impurity, either holes (in $\boldsymbol{p}$-type silicon) or electrons (in $\boldsymbol{n}$-type silicon) can be responsible for electrical conduction. If a large number of impurity atoms is added, the silicon will be heavily doped (e.g., concentration $>\sim 10^{18}$ atoms $/ \mathrm{cm}^{-3}$ ). When designating the relative doping concentrations in semiconductor material, it is common to use the + and - symbols. A heavily doped (low-resistivity) $n$-type silicon wafer is referred to as $n+$ material, while a lightly doped material (e.g., concentration $<\sim 10^{16}$ atoms $/ \mathrm{cm}^{-3}$ ) is referred to as $n-$. Similarly, $p+$ and $p$ - designations refer to the heavily doped and lightly doped $p$-type regions, respectively. The ability to control the type of impurities and the doping concentration in the silicon permits the formation of diodes, transistors, and resistors in integrated circuits.

## A.1.2 Oxidation

In oxidation, silicon reacts with oxygen to form silicon dioxide $\left(\mathrm{SiO}_{2}\right)$. To speed up this chemical reaction, it is necessary to carry out the oxidation at high temperatures (e.g., $1000-1200^{\circ} \mathrm{C}$ ) and inside ultraclean furnaces. To avoid the introduction of even small quantities of contaminants (which could significantly alter the electrical properties of the silicon), it is necessary to operate in a clean room. Particle filters are used to ensure that the airflow in the processing area is free from dust. All personnel must protect the clean-room environment by wearing special lint-free clothing that covers a person from head to toe.

The oxygen used in the reaction can be introduced either as a high-purity gas (referred to as a "dry oxidation") or as steam (forming a "wet oxidation"). In general, wet oxidation has a faster growth rate, but dry oxidation gives better electrical characteristics. The thermally grown oxide layer has excellent electrical insulation properties. The dielectric strength for $\mathbf{S i O}_{2}$ is approximately $10^{7} \mathrm{~V} / \mathrm{cm}$. It has a dielectric constant of about 3.9 , and it can be used to form excellent MOS capacitors. Silicon dioxide can also serve as an effective mask against many impurities, allowing the introduction of dopants into the silicon only in regions that are not covered with oxide.

Silicon dioxide is a transparent film, and the silicon surface is highly reflective. If white light is shone on an oxidized wafer, constructive and destructive interference will cause
certain colors to be reflected. The wavelengths of the reflected light depend on the thickness of the oxide layer. In fact, by categorizing the color of the wafer surface, one can deduce the thickness of the oxide layer. The same principle is used by more sophisticated optical inferometers to measure film thickness. On a processed wafer, there will be regions with different oxide thicknesses. The colors can be quite vivid and are immediately obvious when a finished wafer is viewed with the naked eye.

# A.1.3 Photolithography 

Mass production with economy of scale is the primary reason for the tremendous impact VLSI has had on our society. The surface patterns of the various integrated-circuit components can be defined repeatedly using photolithography. The sequence of photolithographic steps is as illustrated in Fig. A.1.

The wafer surface is coated with a photosensitive layer called photoresist, using a spin-on technique. After this, a photographic plate with drawn patterns (e.g., a quartz plate with chromium layer for patterning) will be used to selectively expose the photoresist under a deep ultraviolet illumination (UV). The exposed areas will become softened (for positive photoresist). The exposed layer can then be removed using a chemical developer, causing the mask pattern to be duplicated on the wafer. Very fine surface geometries can be reproduced accurately by this technique. Furthermore, the patterns can be projected directly onto the wafer, or by using a separate photomask produced by a 10x "step and repeat" reduction technique as shown in Fig. A.2.

The patterned photoresist layer can be used as an effective masking layer to protect materials below from wet chemical etching or reactive ion etching (RIE). Silicon dioxide, silicon nitride, polysilicon, and metal layers can be selectively removed using the appropriate etching methods (see next section). After the etching step(s), the photoresist is stripped away, leaving behind a permanent pattern of the photomask on the wafer surface.

To make this process even more challenging, multiple masking layers (which can number more than 20 in advanced VLSI fabrication processes) must be aligned precisely on top of


Figure A. 1 Photolithography using positive or negative photoresist.


Figure A. 2 Conceptual illustration of a step-and-repeat reduction technique to facilitate the mass production of integrated circuits.
previous layers. This must be done with even finer precision than the minimum geometry size of the masking patterns. This requirement imposes very critical mechanical and optical constraints on the photolithography equipment.

# A.1.4 Etching 

To permanently imprint the photographic patterns onto the wafer, chemical (wet) etching or RIE dry etching procedures can be used. Chemical etching is usually referred to as wet etching. Different chemical solutions can be used to remove different layers. For example, hydrofluoric (HF) acid can be used to etch $\mathrm{SiO}_{2}$, potassium hydroxide $(\mathrm{KOH})$ for silicon, phosphoric acid for aluminum, and so on. In wet etching, the chemical usually attacks the exposed regions that are not protected by the photoresist layer in all directions (isotropic etching). Depending on the thickness of the layer to be etched, a certain amount of undercut will occur. Therefore, the dimension of the actual pattern will differ slightly from the original pattern. If exact dimension is critical, RIE dry etching can be used. This method is essentially a directional bombardment of the exposed surface using a corrosive gas (or ions). The cross section of the etched layer is usually highly directional (anisotropic etching) and has the same dimension as the photoresist pattern. A comparison between isotropic and anisotropic etching is given in Fig. A.3.

## A.1.5 Diffusion

Diffusion is a process by which atoms move from a high-concentration region to a lowconcentration region. This is very much like a drop of ink dispersing through a glass of water except that it occurs much more slowly in solids. In VLSI fabrication, this is a method to introduce impurity atoms (dopants) into silicon to change its resistivity. The rate at which dopants diffuse in silicon is a strong function of temperature. Diffusion of impurities is usually carried out at high temperatures $\left(1000-1200^{\circ} \mathrm{C}\right)$ to obtain the desired doping profile. When the wafer is cooled to room temperature, the impurities are essentially "frozen" in position.

Figure A. 3 (a) Cross-sectional view of an isotropic oxide etch with severe undercut beneath the photoresist layer. (b) Anisotropic etching, which usually produces a cross section with no undercut.

The diffusion process is performed in furnaces similar to those used for oxidation. The depth to which the impurities diffuse depends on both the temperature and the processing time.

The most common impurities used as dopants are boron, phosphorus, and arsenic. Boron is a $p$-type dopant, while phosphorus and arsenic are $n$-type dopants. These dopants can be effectively masked by thin silicon dioxide layers. By diffusing boron into an $n$-type substrate, a $p n$ junction is formed (diode). If the doping concentration is heavy, the diffused layer can also be used as a conducting layer with very low resistivity.

# A.1.6 Ion Implantation 

Ion implantation is another method used to introduce impurities into the semiconductor crystal. An ion implanter produces ions of the desired dopant, accelerates them by an electric field, and allows them to strike the semiconductor surface. The ions become embedded in the crystal lattice. The depth of penetration is related to the energy of the ion beam, which can be controlled by the accelerating-field voltage. The quantity of ions implanted can be controlled by varying the beam current (flow of ions). Since both voltage and current can be accurately measured and controlled, ion implantation results in impurity profiles that are much more accurate and reproducible than can be obtained by diffusion. In addition, ion implantation can be performed at room temperature. Ion implantation normally is used when accurate control of the doping profile is essential for device operation.

## A.1.7 Chemical Vapor Deposition

Chemical vapor deposition (CVD) is a process by which gases or vapors are chemically reacted, leading to the formation of solids on a substrate. CVD can be used to deposit various materials on a silicon substrate including $\mathrm{SiO}_{2}, \mathrm{Si}_{3} \mathrm{~N}_{4}$, polysilicon, and so on. For instance, if silane gas and oxygen are allowed to react above a silicon substrate, the end product, silicon dioxide, will be deposited as a solid film on the silicon wafer surface. The properties of the CVD oxide layer are not as good as those of a thermally grown oxide, but they are sufficient to allow the layer to act as an electrical insulator. The advantage of a CVD layer is that the oxide deposits at a faster rate and a lower temperature (below $500^{\circ} \mathrm{C}$ ).

If silane gas alone is used, then a silicon layer will be deposited on the wafer. If the reaction temperature is high enough (above $1000^{\circ} \mathrm{C}$ ), the layer deposited will be a crystalline layer (assuming that there is an exposed crystalline silicon substrate). Such a layer is called an epitaxial layer, and the deposition process is referred to as epitaxy instead of CVD. At lower temperatures, or if the substrate surface is not single-crystal silicon, the atoms will not be able to aligned along the same crystalline direction. Such a layer is called polycrystalline


Figure A. 4 Examples of an 8-pin plastic dual-in-line IC package and a 16-pin surface-mount package.
silicon (poly Si), since it consists of many small crystals of silicon aligned in random fashion. Polysilicon layers are normally doped very heavily to form highly conductive regions that can be used for electrical interconnections.

# A.1.8 Metallization 

The purpose of metallization is to interconnect the various components (transistors, capacitors, etc.) to form the desired integrated circuit. Metallization involves the deposition of a metal over the entire surface of the silicon. The required interconnection pattern is then selectively etched. The metal layer is normally deposited via a sputtering process. A pure metal disk (e.g., $99.99 \%$ aluminum target) is placed under an Ar (argon) ion gun inside a vacuum chamber. The wafers are also mounted inside the chamber above the target. The Ar ions will not react with the metal, since argon is a noble gas. However, the ions are made to physically bombard the target and literally knock metal atoms out of the target. These metal atoms will then coat all the surface inside the chamber, including the wafers. The thickness of the metal film can be controlled by the length of the sputtering time, which is normally in the range of 1 to 2 minutes. The metal interconnects can then be defined using photolithography and etching steps.

## A.1.9 Packaging

A finished silicon wafer may contain several hundreds of finished circuits or chips. A chip may contain from 10 to more than $10^{8}$ transistors; each chip is rectangular and can be up to tens of millimeters on a side. The circuits are first tested electrically (while still in wafer form) using an automatic probing station. Bad circuits are marked for later identification. The circuits are then separated from each other (by dicing), and the good circuits (dies) are mounted in packages (headers). Examples of such IC packages are given in Fig. A.4. Fine gold wires are normally used to interconnect the pins of the package to the metallization pattern on the die. Finally, the package is sealed using plastic or epoxy under vacuum or in an inert atmosphere.

## A. 2 VLSI Processes

Integrated-circuit fabrication technology was originally dominated by bipolar technology. By the late 1970s, metal oxide semiconductor (MOS) technology became more promising for VLSI implementation with higher packing density and lower power consumption. Since the early 1980s, complementary MOS (CMOS) technology has almost completely dominated the VLSI scene, leaving bipolar technology to fill specialized functions such as high-speed analog and RF circuits. CMOS technologies continue to evolve, and in the late 1980s, the incorporation of bipolar devices led to the emergence of high-performance bipolar-CMOS
(BiCMOS) fabrication processes that provided the best of both technologies. However, BiCMOS processes are often very complicated and costly, since they require upward of 15 to 20 masking levels per implementation-standard CMOS processes by comparison require only 10 to 12 masking levels.

The performance of CMOS and BiCMOS processes continues to improve with finer lithography resolution. However, fundamental limitations on processing techniques and semiconductor properties have prompted the need to explore alternate materials. Newly emerged SiGe and strained-Si technologies are good compromises to improve performance while maintaining manufacturing compatibility (hence low cost) with existing silicon-based CMOS fabrication equipment.

In the subsection that follows, we will examine a typical CMOS process flow, the performance of the available components, and the inclusion of bipolar devices to form a BiCMOS process.

# A.2.1 Twin-Well CMOS Process 

Depending on the choice of starting material (substrate), CMOS processes can be identified as $\boldsymbol{n}$-well, $\boldsymbol{p}$-well, or twin-well processes. The latter is the most complicated but most flexible in the optimization of both the $n$ - and $p$-channel MOSFETs. In addition, many advanced CMOS processes may make use of trench isolation and silicon-on-insulator (SOI) technology to reduce parasitic capacitance (hence higher speed) and to improve packing density.

A modern twin-well CMOS process flow is shown in Fig. A.5. A minimum of 10 masking layers is required. In practice, most CMOS processes will also require additional layers such as $n$ - and $p$-guards for better latchup immunity, a second polysilicon layer for capacitors, and multilayer metals for high-density interconnections. The inclusion of these layers would increase the total number of 15 to 20 masking layers.

The starting material for the twin-well CMOS is a $p$-type substrate. The process begins with the formation of the $p$-well and the $n$-well (Fig. A.5a). The $n$-well is required wherever $p$-channel MOSFETs are to be placed, while the $p$-well is used to house the $n$-channel MOSFETs. The well-formation procedures are similar. A thick photoresist layer is etched to expose the regions for $n$-well diffusion. The unexposed regions will be protected from the $n$-type phosphorus impurity. Phosphorus implantation is usually used for deep diffusions, since it has a large diffusion coefficient and can diffuse faster than arsenic into the substrate.

The second step is to define the active regions (region where transistors are to be placed) using a technique called shallow trench isolation (STI). To reduce the chance of unwanted latchup (a serious issue in CMOS technology), dry etching is used to produce trenches approximately $0.3 \mu \mathrm{~m}$ deep on the silicon surface. These trenches are then refilled using CVD oxide, followed by a planarization procedure. This results in a cross section with flat surface topology (Fig. A.5b). An alternate isolation technique is called local oxidation of silicon (LOCOS). This older technology uses silicon nitride $\left(\mathrm{Si}_{3} \mathrm{~N}_{4}\right)$ patterns to protect the penetration of oxygen during oxidation. This allows selective regions of the wafer surface to be oxidized. After a long wet-oxidation step, thick field oxide will appear in regions between transistors. This effectively produces an effect similar to that obtained in the STI process, but at the expense of large area overhead.

The next step is the formation of the polysilicon gate (Fig. A.5c). This is one of the most critical steps in the CMOS process. The thin oxide layer in the active region is first removed using wet etching followed by the growth of a high-quality thin gate oxide. Current deep-submicron CMOS processes routinely make used of oxide thicknesses as thin as $20 \AA$ to $50 \AA$ ( 1 angstrom $=10^{-8} \mathrm{~cm}$ ). A polysilicon layer, usually arsenic doped ( $n$-type), is then


Figure A. 5 A modern twin-well CMOS process flow with shallow trench isolation (STI).
deposited and patterned. The photolithography is most demanding in this step since the finest resolution is required to produce the shortest possible MOS channel length.

The polysilicon gate is a self-aligned structure and is preferred over the older type of metal gate structure. This is normally accompanied by the formation of lightly doped drain (LDD) regions for MOSFETs of both types to suppress the generation of hot electrons that might
affect the reliability of the transistors. A noncritical mask, together with the polysilicon gates, is used to form the self-aligned LDD regions (Fig. A.5d).

Prior to the $n+$ and $p+$ drain region implant, a sidewall spacer step is performed. A thick layer of silicon nitride is deposited uniformly on the wafer. Due to the conformal nature of the deposition, the thickness of the silicon nitride layer at all layer edges (i.e., at both ends of the polysilicon gate electrode) will be thicker than those deposited over a flat surface. After a timed RIE dry etch to remove all the silicon nitride layer, pockets of silicon nitride will remain at the edge of the polysilicon gate electrode (Fig. A.5e). Such pockets of silicon nitride are called sidewall spacers. They are used to block subsequent $n+$ or $p+$ source/drain implants, protecting the LDD regions.

A heavy arsenic implant can be used to form the $n+$ source and drain regions of the $n$-MOSFETs. The polysilicon gate also acts as a barrier for this implant to protect the channel region. A layer of photoresist can be used to block the regions where $p$-MOSFETs are to be formed (Fig. A.5e). The thick field oxide stops the implant and prevents $n+$ regions from forming outside the active regions. A reversed photolithography step can be used to protect the $n$-MOSFETs during the $p+$ boron source and drain implant for the $p$-MOSFETs (Fig. A.5f). Note that in both cases the separation between the source and drain diffusions-channel length-is defined by the polysilicon gate mask alone, hence the self-aligned property.

Before contact holes are opened, a thick layer of CVD oxide is deposited over the entire wafer. A photomask is used to define the contact window opening (Fig. A.5g), followed by a wet or dry oxide etch. A thin aluminum layer is then evaporated or sputtered onto the wafer. A final masking and etching step is used to pattern the interconnection (Fig. A.5h).

Not shown in the process flow is the final passivation step prior to packaging and wire bonding. A thick CVD oxide or pyrox glass is usually deposited on the wafer to serve as a protective layer.

# A.2.2 Integrated Devices 

Besides the obvious $n$ - and $p$-channel MOSFETs, other devices can be obtained by appropriate masking patterns. These include $p n$ junction diodes, MOS capacitors, and resistors.

## A.2.3 MOSFETs

The $n$-channel MOSFET is the preferred device in comparison to the $p$-MOSFET (Fig. A.6). The electron surface mobility is two to three times higher than that for holes. Therefore, with the same device size ( $W$ and $L$ ), the $n$-MOSFET offers higher current drive (or lower onresistance) and higher transconductance.


Figure A. 6 Cross-sectional diagram of $n$ - and $p$-MOSFETs.
In an integrated-circuit design environment, MOSFETs are characterized by their threshold voltage and by their device sizes. Usually the $n$ - and $p$-channel MOSFETs are designed to have threshold voltages of similar magnitude for a particular process. The transconductance can be adjusted by changing the device surface dimensions ( $W$ and $L$ ). This feature is not available for bipolar transistor, making the design of integrated MOSFET circuits much more flexible.

# A.2.4 Resistors 

Resistors in integrated form are not very precise. They can be made from various diffusion regions as shown in Fig. A.7. Different diffusion regions have different resistivity. The $n$ well is usually used for medium-value resistors, while the $n+$ and $p+$ diffusions are useful for low-value resistors. The actual resistance value can be defined by changing the length and width of diffused regions. The tolerance of the resistor value is very poor (20-50\%), but the matching of two similar resistor values is quite good ( $5 \%$ ). Thus circuit designers should design circuits that exploit resistor matching and should avoid designs that require a specific resistor value.

All diffused resistors are self-isolated by the reverse-biased $p n$ junctions. A serious drawback for these resistors is the fact that they are accompanied by a substantial parasitic junction capacitance, making them not very useful for high-frequency applications. The reverse-biased $p n$ junctions also exhibit a JFET effect, leading to a variation in the resistance value as the supply voltage is changed (a large voltage coefficient is undesirable). Since the mobilities of carriers vary with temperature, diffused resistors also exhibit a significant temperature coefficient.

A more useful resistor can be fabricated using the polysilicon layer that is placed on top of the thick field oxide. The thin polysilicon layer provides better surface area matching and hence more accurate resistor ratios. Furthermore, the polyresistor is physically separated from the substrate, resulting in a much lower parasitic capacitance and voltage coefficient.

## A.2.5 Capacitors

Two types of capacitor structure are available in CMOS processes: MOS and interpoly capacitors. The latter are also similar to metal-insulator-metal (MIM) capacitors. The cross sections of these structures are as shown in Fig. A.8. The MOS gate capacitance, depicted by the center structure, is basically the gate-to-source capacitance of a MOSFET. The capacitance value is dependent on the gate area. The oxide thickness is the same as the gate oxide



Figure A. 7 Cross sections of various resistor types available from a typical $n$-well CMOS process.


Figure A. 8 Interpoly and MOS capacitors in an $n$-well CMOS process.
thickness in the MOSFETs. This capacitor exhibits a large voltage dependence. To eliminate this problem, an addition $n+$ implant is required to form the bottom plate of the capacitors, as shown in the structure on the right. Both these MOS capacitors are physically in contact with the substrate, resulting in a large parasitic $p n$ junction capacitance at the bottom plate.

The interpoly capacitor exhibits near-ideal characteristics but at the expense of the inclusion of a second polysilicon layer to the CMOS process. Since this capacitor is placed on top of the thick field oxide, parasitic effects are kept to a minimum.

A third and less often used capacitor is the junction capacitor. Any $p n$ junction under reversed bias produces a depletion region that acts as a dielectric between the $p$ and the $n$ regions. The capacitance is determined by geometry and doping levels and has a large voltage coefficient. This type of capacitor is often used as a variactor (variable capacitor) for tuning circuits. However, this capacitor works only with reverse-bias voltages.

For the interpoly and MOS capacitors, the capacitance values can be controlled to within $1 \%$. Practical capacitance values range from 0.5 pF to a few tens of picofarads. The matching between capacitors of similar size can be within $0.1 \%$. This property is extremely useful for designing precision analog CMOS circuits.

# A.2.6 pn Junction Diodes 

Whenever $n$-type and $p$-type diffusion regions are placed next to each other, a $p n$ junction diode results. A useful structure is the $n$-well diode shown in Fig. A.9. The diode fabricated in an $n$ well can provide a high breakdown voltage. This diode is essential for the input clamping circuits for protection against electrostatic discharge. The diode is also very useful as an on-chip temperature sensor by monitoring the variation of its forward voltage drop.


Figure A. 9 A $p n$ junction diode in an $n$-well CMOS process.
A.2.7 BiCMOS Process
An $n p n$ vertical bipolar transistor can be integrated into the $n$-well CMOS process with the addition of a $p$-base diffusion region (Fig. A.10). The characteristics of this device depend on the base width and the emitter area. The base width is determined by the difference in junction depth between the $n+$ and the $p$-base diffusions. The emitter area is determined by the junction area of the $n+$ diffusion at the emitter. The $n$-well serves as the collector for the $n p n$ transistor. Typically, the $n p n$ transistor has a $\beta$ in the range of 50 to 100 and a cutoff frequency of greater than tens of gigahertz.

Normally, an $n+$ buried layer is used to reduce the series resistance of the collector, since the $n$ well has a very high resistivity. However, this would further complicate the process by introducing $p$-type epitaxy and one more masking step. Other variations on the bipolar transistor includes poly-emitter and self-aligned base contact to minimize parasitic effects.


Figure A. 10 Cross-sectional diagram of a BiCMOS process.

# A.2.8 Lateral pnp Transistor 

The fact that most BiCMOS processes do not have optimized pnp transistors makes circuit design somewhat difficult. However, in noncritical situations, a parasitic lateral pnp transistor can be used (Fig. A.11).

In this case, the $n$ well serves as the $n$-base region, with the $p+$ diffusions as the emitter and the collector. The base width is determined by the separation between the two $p+$ diffusions. Since the doping profile is not optimized for the base-collector junctions and because the base width is limited by the minimum photolithographic resolution, the performance of this device is not very good: typically, $\beta$ of around 10 , and the cutoff frequency is low.


Figure A. 11 Lateral pnp transistor.

## A.2.9 p-Base and Pinched-Base Resistors

With the additional $p$-base diffusion in the BiCMOS process, two additional resistor structures are available. The $p$-base diffusion can be used to form a straightforward $p$-base resistor as


Figure A. $12 p$-base and pinched $p$-base resistors.
shown in Fig. A.12. Since the base region is usually of a relatively low doping level and has a moderate junction depth, it is suitable for medium-value resistors (a few kilohms). If a large resistor value is required, the pinched-base resistor can be used. In this structure, the $p$-base region is encroached by the $n+$ diffusion, restricting the conduction path. Resistor values in the range of $10 \mathrm{k} \Omega$ to $100 \mathrm{k} \Omega$ can be obtained. As with the diffusion resistors discussed earlier, these resistors exhibit poor tolerance and temperature coefficients but relatively good matching.

# A.2.10 SiGe BiCMOS Process 

With the burgeoning of wireless applications, the demand for high-performance, high-frequency RF integrated circuits is tremendous. Owing to the fundamental limitations of physical material properties, silicon-based technology was not able to compete with more expensive technologies relying on compounds from groups III through IV, such as GaAs. By incorporating a controlled amount (typically no more than $15-20 \%$ mole fraction) of germanium $(\mathrm{Ge})$ into crystal silicon $(\mathrm{Si})$ in the BJT's base region, the energy bandgap can be altered. The specific concentration profile of the Ge can be engineered in such a way that the energy bandgap can be gradually reduced from the pure Si region to a lower value in the SiGe region. This energy bandgap reduction produces a built-in electric field that can assist the movement of carriers, hence resulting in faster operating speed. Therefore, SiGe bipolar transistors can achieve significant higher cutoff frequency (e.g., in the $100-200 \mathrm{GHz}$ range). Another benefit is that the SiGe process is compatible with existing Si-based fabrication technology, ensuring a very favorable cost/performance ratio.

To take advantage of the SiGe material characteristics, the basic bipolar transistor structure must also be modified to further reduce parasitic capacitance (for higher speed) and to improve the injection efficiency (for higher gain). A symmetric bipolar device structure is shown in Fig. A.13. The device made use of trench isolation to reduce the collector sidewall capacitance between the $n$-well $/ n+$ buried layer and the $p$ substrate. The emitter size and the $p+$ base contact size are defined by a self-aligned process to minimize the base-collector junction (Miller) capacitance. This type of device is called a heterojunction bipolar transistor (HBT) since the emitter-base junction is formed from two different types of material, polysilicon emitter and SiGe base. The injection efficiency is significantly better than a homojunction device (as in a conventional BJT). This advantage, coupled with the fact that base width is typically only around 50 nm , makes it easy to achieve current gain of more than 100. In addition, not shown in Fig. A.13, is the possible use of multiple layers of metallization to further reduce the device size and interconnect resistance. All these device features are necessary to complement the high-speed performance of SiGe material.


Figure A. 13 Cross-sectional diagram of a symmetric self-aligned SiGe heterojunction bipolar transistor, or HBT.

# A. 3 VLSI Layout 

The designed circuit schematic must be transformed into a layout that consists of the geometric representation of the circuit components and interconnections. Today, computer-aided design tools allow many of the conversion steps, from schematic to layout, to be carried out semior fully automatically. However, any good mixed-signal IC designer must have practiced full custom layout at one point or another. An example of a CMOS inverter can be used to illustrate this procedure (Fig. A.14).

The circuit must first be "flattened" and redrawn to eliminate any interconnection crossovers, similar to the requirement of a printed-circuit-board layout. Each process is made up of a specific set of masking layers. In this case, seven layers are used. Each layer is usually assigned a unique color and fill pattern for ease of identification on a computer screen or on a printed color plot. The layout begins with the placement of the transistors. For illustration purposes, the $p$ and $n$ MOSFETs are placed in an arrangement similar to that shown in the schematic. In practice, the designer is free to choose the most area-efficient layout. The MOSFETs are defined by the active areas overlapped by the "poly 1 " layer. The MOS channel length and width are defined by the width of the "poly 1 " strip and that of the active region, respectively. The $p$-MOSFET is enclosed in an $n$ well. For more complex circuits, multiple $n$ wells can be used for different groups of $p$-MOSFETs. The $n$-MOSFET is enclosed by the $n+$ diffusion mask to form the source and drain, while the $p$-MOSFET is enclosed by the $p+$ diffusion mask. Contact holes are placed in regions where connection to the metal layer is required. Finally, the "metal 1" layer completes the interconnections.

The corresponding cross-sectional diagram of the CMOS inverter along the $\mathrm{AA}^{\prime}$ plane is as shown in Fig. A.15. The poly-Si gates for both transistors are connected to form the input terminal, $X$. The drains of both transistors are tied together via "metal 1" to form the output terminal, $Y$. The sources of the $n$ - and $p$-MOSFETs are connected to GND and $V_{D D}$, respectively. Note that butting contacts consist of side-by-side $n+/ p+$ diffusions that are used to tie the body potential of the $n$ - and $p$-MOSFETs to the appropriate voltage levels.

When the layout is completed, the circuit must be verified using CAD tools such as the circuit extractor, the design rule checker (DRC), and the circuit simulator. Once these verifications have been satisfied, the design can be "taped out" to a mask-making facility. A

Figure A. 14 A CMOS inverter schematic and its layout.


Figure A. 15 Cross section along the plane $\mathrm{AA}^{\prime}$ of a CMOS inverter. Note that this particular layout is good for illustration purposes, but is not necessarily appropriate for latchup prevention.
pattern generator (PG) machine can then draw the geometries on a glass or quartz photoplate using electronically driven shutters. Layers are drawn one by one onto different photoplates. After these plates have been developed, clear and dark patterns resembling the geometries on the layout will result. A set of the photoplates for the CMOS inverter example is shown in Fig. A.16. Depending on whether the drawn geometries are meant to be opened as windows or kept as patterns, the plates can be clear or dark field. Note that each of these layers must be processed in sequence. The layers must be aligned within very fine tolerance to form the transistors and interconnections. Naturally, the greater the number of layers, the more difficult it is to maintain the alignment. This also requires better photolithography equipment and may

result in lower yield. Hence, each additional mask will be reflected in an increase in the final cost of the IC chip.

# A. 4 Beyond 20 nm Technology 

The rapid advancement of VLSI fabrication technology has followed a prediction called Moore's Law for more than four decades. In 1965, Gordon Moore, one of the cofounders


Figure A. 17 MOSFET scaling consists of the reduction of both the surface and vertical dimensions. In addition, modification of the doping profiles and choice of materials are also necessary.
of Intel, foresaw that the number of transistors that can be integrated onto a VLSI chip would roughly double every two years. In order to achieve this, the size of the transistor has to be reduced accordingly. Otherwise, the size of the VLSI chip would have grown to an unacceptable size, leading to low yield and high cost. Instead of redesigning a fabrication technology from scratch every time, a scaling procedure is normally carried out. The scaling process is not only an optical shrink of the device surface layout, it also requires the reduction in vertical dimensions such as gate oxide thickness, source and drain junction depths, etc. The effect of MOSFET scaling is illustrated in Fig. A.17. VLSI fabrication technology is categorized by the minimum dimension that it can define. This is usually referred to as the channel length of the MOS gate. The reduction in device dimensions not only allows higher integration density, the shorter channel length and closer proximity of the devices also allow higher switch speed, hence better performance. As a rule of thumb, scaling cannot be carried out with an aggressive factor. Normally, $50 \%$ reducing in dimensions is achieved every two generations. Therefore, a scaling factor of approximately 0.7 is normally used. This is why we have technology nodes such as $1 \mu \mathrm{~m}$ in 1990 , to $0.7 \mu \mathrm{~m}, 0.5 \mu \mathrm{~m}, 0.35 \mu \mathrm{~m}, 0.25 \mu \mathrm{~m}, 0.18 \mu \mathrm{~m}$, $0.13 \mu \mathrm{~m}, 90 \mathrm{~nm}$ and so on.

However, this scaling approach cannot continue forever. As we approach the 20 nm technology node, the ultrathin gate dielectric and ultrashort channel length lead to an unacceptable level of gate and drain to source leakage currents. This is due to the physical limitations such as tunneling and DIBL (Drain-Induced Barrier Lowering). Some of these problems can be addressed by the use of other materials, such as high-k dielectric (e.g., HfO 2 ) for the MOS gate.

In order to maintain the quest for an even higher level of integration, new device structures have been studied. One of the most promising technologies is the ultra-thin-body (UTB) device. In particular, the FINFET, as illustrated in Fig. A.18, has a three-dimension gate warped around a very thin slab of silicon (the fin) that stands vertically from the surface of an SOI wafer. The thin silicon fin is fully depleted during off condition to suppress drain-source leakage current. In 2014, 16 nm FINFET technology is already ready for the production of high performance VLSI chips.


Figure A. 18 A perspective view of the FINFET showing a 3D gate warped around a very thin slab of silicon fin. The source and drain contact areas are actually larger than the intrinsic device.

# Summary 

- This appendix presents an overview of the various aspects of VLSI fabrication procedures. This includes component characteristics, process flows, and layouts. This is by no means a complete account of state-of-the-art VLSI technologies. Interested readers should consult other references on this subject for more detailed descriptions.


## Bibliography

R. S. Muller, T.I. Kamins, and M. Chan, Device Electronics for Integrated Circuits, 3rd ed., Hoboken, NJ, John Wiley \& Sons, 2003.
J. D. Plummer, M.D. Deal, and P.B. Griffin, Silicon VLSI Technology, Upper Saddle River, NJ, Prentice Hall, 2000.
S. Wolf, Microchip Manufacturing, Lattice Press (www.latticepress.com), 2004.
# APPENDIX B 

## SPICE DEVICE MODELS AND DESIGN SIMULATION EXAMPLES USING PSPICE AND MULTISIM

## Introduction

This appendix is concerned with the very important topic of using PSpice and Multisim to simulate the operation of electronic circuits. The need for and the role of computer simulation in circuit design was described in the preface. The appendix has three sections: Section B. 1 presents a brief description of the models that SPICE uses to describe the operation of op amps, diodes, MOSFETs, and BJTs. Section B. 2 presents design and simulation examples using PSpice. Finally, design and simulation examples utilizing Multisim are presented in Section B.3. The examples are keyed to the book chapters and are numbered in a way that makes this relationship transparent. Thus, Example PS.2.1 refers to the first PSpice simulation example on Chapter 2 material. Similarly, Example MS.5.2 refers to the second Multisim simulation example on Chapter 5 material.

Besides the descriptions presented in this appendix, the reader will find the complete simulation files for each example on the book website.

## B. 1 SPICE Device Models

To the designer, the value of simulation results is a direct function of the quality of the models used for the devices. The more faithfully the model represents the various characteristics of the device, the more accurately the simulation results will describe the operation of an actual fabricated circuit. In other words, to see the effect on circuit performance of various imperfections in device operation, these imperfections must be included in the device model used by the circuit simulator.

## B.1.1 The Op-Amp Model

In simulating circuits that use one or more op amps, it is useful to utilize a macromodel to represent each op amp. A macromodel is based on the observed terminal characteristics of the op amp rather than on the modeling of every transistor in the op-amp internal circuit. Macromodels can be developed from data-sheet specifications without knowledge of the details of the internal circuitry of the op amp.

Linear Macromodel The schematic capture of a linear macromodel for an internally compensated op amp with finite gain and bandwidth is shown in Fig. B.1. In this equivalent-circuit model, the gain constant $\mathrm{A}_{\mathrm{0 d}}$ of the voltage-controlled voltage source $\mathrm{E}_{\mathrm{d}}$ corresponds to the differential gain of the op amps at dc. Resistor $\mathrm{R}_{b}$ and capacitor $\mathrm{C}_{b}$ form a
a single-time-constant (STC) filter with a corner frequency

$$
f_{b}=\frac{1}{2 \pi R_{b} C_{b}}
$$

The low-pass response of this filter is used to model the frequency response of the internally compensated op amp. The values of $R_{b}$ and $C_{b}$ used in the macromodel are chosen such that $f_{b}$ corresponds to the $3-\mathrm{dB}$ frequency of the op amp being modeled. This is done by arbitrarily selecting a value for either $R_{b}$ or $C_{b}$ (the selected value does not need to be a practical one) and then using Eq. (B.1) to compute the other value. In Fig. B.1, the voltage-controlled voltage source $E_{b}$ with a gain constant of unity is used as a buffer to isolate the low-pass filter from any load at the op-amp output. Thus any op-amp loading will not affect the frequency response of the filter and hence that of the op amp.

The linear macromodel in Fig. B. 1 can be further expanded to account for other op-amp nonidealities. For example, the equivalent-circuit model in Fig. B. 2 can be used to model an internally compensated op amp while accounting for the following op-amp nonidealities:

1. Input Offset Voltage $\left(\boldsymbol{V}_{\boldsymbol{o s}}\right)$. The dc voltage source $V_{o s}$ models the op-amp input offset voltage.


Figure B. 1 A linear macromodel used to model the finite gain and bandwidth of an internally compensated op amp.


Figure B. 2 A comprehensive linear macromodel of an internally compensated op amp.
2. Input Bias Current $\left(I_{B}\right)$ and Input Offset Current $\left(I_{O S}\right)$. The dc current sources $I_{B 1}$ and $I_{B 2}$ model the input bias current at each input terminal of the op amp, with

$$
I_{B 1}=I_{B}+\frac{I_{O S}}{2} \quad \text { and } \quad I_{B 2}=I_{B}-\frac{I_{O S}}{2}
$$

where $I_{B}$ and $I_{O S}$ are, respectively, the input bias current and the input offset current specified by the op-amp manufacturer.
3. Common-Mode Input Resistance ( $\boldsymbol{R}_{\text {icm }}$ ). If the two input terminals of an op amp are tied together and the input resistance (to ground) is measured, the result is the common-mode input resistance $R_{i c m}$. In the macromodel of Fig. B.2, we have split $R_{i c m}$ into two equal parts $\left(2 R_{i c m}\right)$, each connected between one of the input terminals and ground.
4. Differential-Input Resistance $\left(\boldsymbol{R}_{\boldsymbol{i d}}\right)$. The resistance seen between the two input terminals of an op amp is the differential input resistance $R_{i d}$.
5. Differential Gain at DC $\left(A_{0 d}\right)$ and Common-Mode Rejection Ratio (CMRR). The output voltage of an op amp at dc can be expressed as

$$
V_{3}=A_{0 d}\left(V_{2}-V_{1}\right)+\frac{A_{0 c m}}{2}\left(V_{1}+V_{2}\right)
$$

where $A_{0} d$ and $A_{0 c m}$ are, respectively, the differential and common-mode gains of the op amp at dc. For an op amp with a finite CMRR,

$$
A_{0 c m}=A_{0 d} / \mathrm{CMRR}
$$

where CMRR is expressed in V/V (not in dB). In the macromodel of Fig. B.2, the voltage-controlled voltage sources $E_{c m 1}$ and $E_{c m 2}$ with gain constants of $A_{0 c m} / 2$ account for the finite CMRR while source $E_{d}$ models $A_{0 d}$.
6. Unity-Gain Frequency $\left(f_{s}\right)$. From Eq. (2.46), the 3-dB frequency $f_{b}$ and the unity-gain frequency (or gain-bandwidth product) $f_{s}$ of an internally compensated op amp with an STC frequency response are related by

$$
f_{b}=\frac{f_{s}}{A_{0 d}}
$$

As in Fig. B.1, the finite op-amp bandwidth is accounted for in the macromodel of Fig. B. 2 by setting the corner frequency of the filter formed by resistor $R_{b}$ and capacitor $C_{b}$ (Eq. B.1) to equal the 3-dB frequency of the op amp, $f_{b}$.
7. Ouput Resistance $\left(\boldsymbol{R}_{o}\right)$. The resistance seen at the output terminal of an op amp is the output resistance $R_{o}$.

The linear macromodels in Figs. B. 1 and B. 2 assume that the op-amp circuit is operating in its linear range and do not account for its nonideal performance when large signals are present at the output. Therefore, nonlinear effects, such as output saturation and slew rate, are not modeled.

Nonlinear Macromodel The linear macromodel in Fig. B. 2 can be expanded to account for the op-amp nonlinear performance. For example, the finite output voltage swing of the op amp can be modeled by placing limits on the output voltage of the voltage-controlled voltage source $\mathrm{E}_{b}$. In PSpice, this can be done using the ETABLE component in the
analog-behavioral-modeling (ABM) library and setting the output voltage limits in the lookup table of this component. Further details on how to build nonlinear macromodels for the op amp can be found in the references on SPICE simulation. In general, robust macromodels that account for the nonlinear effects in an IC are provided by the op-amp manufacturers. Most simulators include such macromodels for some of the popular off-the-shelf ICs in their libraries. For example, PSpice and Multisim include models for the $\mu$ A741, the LF411, and the LM324 op amps.

# B.1.2 The Diode Model 

The large-signal SPICE model for the diode is shown in Fig. B.3. The static behavior is modeled by the exponential $i-v$ relationship. Here, for generality, a constant $n$ is included in the exponential. It is known as the emission cofficient, and its value ranges from 1 to 2 . In our study of the diode in Chapter 4, we assumed $n=1$. The dynamic behavior is represented by the nonlinear capacitor $C_{D}$, which is the sum of the diffusion capacitance $C_{d}$ and the junction capacitance $C_{j}$. The series resistance $R_{S}$ represents the total resistance of the $p$ and $n$ regions on both sides of the junction. The value of this parasitic resistance is ideally zero, but it is typically in the range of a few ohms for small-signal diodes. For small-signal analysis, SPICE uses the diode incremental resistance $r_{d}$ and the incremental values of $C_{d}$ and $C_{j}$.

Table B. 1 provides a partial listing of the diode-model parameters used by SPICE, all of which should be familiar to the reader. But having a good device model solves only half of the modeling problem; the other half is to determine appropriate values for the model parameters. This is by no means an easy task. The values of the model parameters are determined using a combination of characterization of the device-fabrication process and specific measurements performed on the actual manufactured devices. Semiconductor manufacturers expend enormous effort and money to extract the values of the model parameters for their devices. For discrete diodes, the values of the SPICE model parameters can be determined from the diode data sheets, supplemented if needed by key measurements. Circuit simulators (such as PSpice) include in their libraries the model parameters of some of the popular off-the-shelf components. For instance, in Example PS4.1, we will use the commercially available D1N418 $p n$-junction diode whose SPICE model parameters are available in PSpice.


Figure B. 3 The SPICE diode model.
Table B. 1 Parameters of the SPICE Diode Model (Partial Listing)

| SPICE Parameter | Book Symbol | Description | Units |
| :-- | :-- | :-- | :-- |
| IS | $I_{S}$ | Saturation current | A |
| N | $n$ | Emission coefficient |  |
| RS | $R_{S}$ | Ohmic resistance | $\Omega$ |
| VJ | $V_{0}$ | Built-in potential | V |
| CJ 0 | $C_{j} 0$ | Zero-bias depletion (junction) capacitance | F |
| M | $m$ | Grading coefficient |  |
| TT | $\tau_{T}$ | Transit time | s |
| BV | $V_{Z K}$ | Breakdown voltage | V |
| IBV | $I_{Z K}$ | Reverse current at $V_{Z K}$ | A |



Figure B. 4 Equivalent-circuit model used to simulate the zener diode in SPICE. Diode $D_{1}$ is ideal and can be approximated in SPICE by using a very small value for $n$ (say $n=0.01$ ).

# B.1.3 The Zener Diode Model 

The diode model in Fig. B. 3 does not adequately describe the operation of the diode in the breakdown region. Hence, it does not provide a satisfactory model for zener diodes. However, the equivalent-circuit model shown in Fig B. 4 can be used to simulate a zener diode in SPICE. Here, diode $D_{1}$ is an ideal diode that can be approximated in SPICE by using a very small value for $n$ (say $n=0.01$ ). Diode $D_{2}$ is a regular diode that models the forward-bias region of the zener (for most applications, the parameters of $D_{2}$ are of little consequence).

## B.1.4 MOSFET Models

To simulate the operation of a MOSFET circuit, a simulator requires a mathematical model to represent the characteristics of the MOSFET. The model we derived in Chapter 5 to represent the MOSFET is a simplified or first-order model. This model, called the square-law model because of the quadratic $i-v$ relationship in saturation, works well for transistors with relatively long channels. However, for devices with short channels, especially deep-submicron transistors, many physical effects that we neglected come into play, with the result that the derived first-order model no longer accurately represents the actual operation of the MOSFET (see Sections 5.4.4 \& 15.1.3).

The simple square-law model is useful for understanding the basic operation of the MOSFET as a circuit element and is indeed used to obtain approximate pencil-and-paper circuit designs. However, more elaborate models, which account for short-channel effects, are required to be able to predict the performance of integrated circuits with a certain degree of precision prior to fabrication. Such models have indeed been developed and continue to
be refined to more accurately represent the higher-order effects in short-channel transistors through a mix of physical relationships and empirical data. Examples include the Berkeley short-channel IGFET model (BSIM) and the EKV model, popular in Europe. Currently, semiconductor manufacturers rely on such sophisticated models to accurately represent the fabrication process. These manufacturers select a MOSFET model and then extract the values for the corresponding model parameters using both their knowledge of the details of the fabrication process and extensive measurements on a variety of fabricated MOSFETs. A great deal of effort is expended on extracting the model parameter values. Such effort pays off in fabricated circuits exhibiting performance very close to that predicted by simulation, thus reducing the need for costly redesign.

Although it is beyond the scope of this book to delve into the subject of MOSFET modeling and short-channel effects, it is important that the reader be aware of the limitations of the square-law model and of the availability of more accurate but, unfortunately, more complex MOSFET models. In fact, the power of computer simulation is more apparent when one has to use these complex device models in the analysis and design of integrated circuits.

SPICE-based simulators, like PSpice and Multisim, provide the user with a choice of MOSFET models. The corresponding SPICE model parameters (whose values are provided by the semiconductor manufacturer) include a parameter called LEVEL, which selects the MOSFET model to be used by the simulator. Although the value of this parameter is not always indicative of the accuracy, nor of the complexity of the corresponding MOSFET model, LEVEL $=1$ corresponds to the simplest first-order model (called the Shichman-Hodges model), which is based on the square-law MOSFET equations presented in Chapter 5. For simplicity, we will use this model to illustrate the description of the MOSFET model parameters in SPICE and to simulate the example circuits in PSpice and Multisim. However, the reader is again reminded of the need to use a more sophisticated model than the level-1 model to accurately predict the circuit performance, especially for deep, submicron transistors.

MOSFET Model Parameters Table B. 2 provides a listing of some of the MOSFET model parameters used in the level-1 model of SPICE. The reader should already be familiar with these parameters, except for a few, which are described next.

MOSFET Diode Parameters For the two reverse-biased diodes formed between each of the source and drain diffusion regions and the body (see Fig. B.4), the saturation-current density is modeled in SPICE by the parameter JS. Furthermore, based on the parameters specified in Table B.2, SPICE will calculate the depletion-layer (junction) capacitances discussed in Section 10.2.1 as

$$
\begin{aligned}
& C_{d b}=\frac{\mathrm{CJ}}{\left(1+\frac{V_{D B}}{\mathrm{PB}}\right)^{\mathrm{MI}}} \mathrm{AD}+\frac{\text { CJSW }}{\left(1+\frac{V_{D B}}{\mathrm{PB}}\right)^{\text {MJSW }}} \mathrm{PD} \\
& C_{s b}=\frac{\mathrm{CJ}}{\left(1+\frac{V_{S B}}{\mathrm{PB}}\right)^{\mathrm{MI}}} \mathrm{AS}+\frac{\text { CJSW }}{\left(1+\frac{V_{S B}}{\mathrm{PB}}\right)^{\text {MJSW }}} \mathrm{PS}
\end{aligned}
$$

where AD and AS are the areas, while PD and PS are the perimeters of, respectively, the drain and source regions of the MOSFET. The first capacitance term in Eqs. (B.5) and (B.6) represents the depletion-layer (junction) capacitance over the bottom plate of the drain and source regions. The second capacitance term accounts for the depletion-layer capacitance along the sidewall (periphery) of these regions. Both terms are expressed using the formulaTable B. 2 Parameters of the SPICE Level-1 MOSFET Model (Partial Listing)

| SPICE Parameter | Book Symbol | Description | Units |
| :--: | :--: | :--: | :--: |
| Basic Model Parameters |  |  |  |
| LEVEL |  | MOSFET model selector |  |
| TOX | $t_{o x}$ | Gate-oxide thickness | m |
| COX | $C_{o x}$ | Gate-oxide capacitance, per unit area | $\mathrm{F} / \mathrm{m}^{2}$ |
| UO | $\mu$ | Carrier mobility | $\mathrm{cm}^{2} / \mathrm{V} \cdot \mathrm{s}$ |
| KP | $k^{\prime}$ | Process transconductance parameter | $\mathrm{A} / \mathrm{V}^{2}$ |
| LAMBDA | $\lambda$ | Channel-length modulation coefficient | $\mathrm{V}^{-1}$ |
| Threshold Voltage Parameters |  |  |  |
| VTO | $V_{r 0}$ | Zero-bias threshold voltage | V |
| GAMMA | $\gamma$ | Body-effect parameter | $\mathrm{V}^{1 / 2}$ |
| NSUB | $N_{A}, N_{D}$ | Substrate doping | $\mathrm{cm}^{-3}$ |
| PHI | $2 \phi_{f}$ | Surface inversion potential | V |
| MOSFET Diode Parameters |  |  |  |
| JS |  | Body-junction saturation-current density | $\mathrm{A} / \mathrm{m}^{2}$ |
| CJ |  | Zero-bias body-junction capacitance, per unit area over the drain/source region | $\mathrm{F} / \mathrm{m}^{2}$ |
| MJ |  | Grading coefficient, for area component |  |
| CJSW |  | Zero-bias body-junction capacitance, per unit length along $\mathrm{F} / \mathrm{m}$ the sidewall (periphery) of the drain/source region |  |
| MJSW |  | Grading coefficient, for sidewall component |  |
| PB | $V_{0}$ | Body-junction built-in potential | V |
| MOSFET Dimension Parameters |  |  |  |
| LD | $L_{o v}$ | Lateral diffusion into the channel from the source/drain diffusion regions | m |
| WD |  | Sideways diffusion into the channel from the body along the width | m |
| MOS Gate-Capacitance Parameters |  |  |  |
| CGBO |  | Gate-body overlap capacitance, per unit channel length | $\mathrm{F} / \mathrm{m}$ |
| CGDO | $C_{o v} / W$ | Gate-drain overlap capacitance, per unit channel width | $\mathrm{F} / \mathrm{m}$ |
| CGSO | $C_{o v} / W$ | Gate-source overlap capacitance, per unit channel width | $\mathrm{F} / \mathrm{m}$ |

developed in Section 3.6.1 (Eq. 3.56). The values of AD, AS, PD, and PS must be specified by the user based on the dimensions of the device being used.

MOSFET Dimension and Gate-Capacitance Parameters In a fabricated MOSFET, the effective channel length $L_{\text {eff }}$ is shorter than the nominal (or drawn) channel length $L$ (as specified by the designer) because the source and drain diffusion regions extend slightly under the gate oxide during fabrication. Furthermore, the effective channel width $W_{\text {eff }}$ of the MOSFET is shorter than the nominal or drawn channel width $W$ because of the sideways diffusion into the channel from the body along the width. Based on the parameters specified in Table B.2,

$$
\begin{aligned}
L_{\text {eff }} & =L-2 \mathrm{LD} \\
W_{\text {eff }} & =W-2 \mathrm{WD}
\end{aligned}
$$
In a manner analogous to using $L_{o v}$ to denote LD, we will use the symbol $W_{o v}$ to denote WD. Consequently, as indicated in Section 10.2.1, the gate-source capacitance $C_{g s}$ and the gate-drain capacitance $C_{g d}$ must be increased by an overlap component of, respectively,

$$
C_{g s, o v}=W \mathrm{CGSO}
$$

and

$$
C_{g d, o v}=W \mathrm{CGDO}
$$

Similarly, the gate-body capacitance $C_{g b}$ must be increased by an overlap component of

$$
C_{g b, o v}=L \mathrm{CGBO}
$$

The reader may have observed that there is a built-in redundancy in specifying the MOSFET model parameters in SPICE. For example, the user may specify the value of KP for a MOSFET or, alternatively, specify TOX and UO and let SPICE compute KP as UO TOX. Similarly, GAMMA can be directly specified, or the physical parameters that enable SPICE to determine it can be specified (e.g., NSUB). In any case, the user-specified values will always take precedence over (i.e., override) those values calculated by SPICE. As another example, note that the user has the option of either directly specifying the overlap capacitances CGBO, CGDO, and CGSO or letting SPICE compute them as $\mathrm{CGDO}=\mathrm{CGSO}=\mathrm{LD}$ COX and $\mathrm{CGBO}=\mathrm{WD}$ COX.

Table B. 3 provides typical values for the level-1 MOSFET model parameters of a modern $0.18-\mu \mathrm{m}$ CMOS technology and for older $0.5-\mu \mathrm{m}$ and $5-\mu \mathrm{m}$ CMOS technologies. The corresponding values for the minimum channel length $L_{\min }$, minimum channel width $W_{\min }$, and the maximum supply voltage $\left(V_{D D}+\left|V_{S S}\right|\right)_{\max }$ are as follows:

| Technology | $L_{\min }$ | $W_{\min }$ | $\left(V_{D D}+\left|V_{S S}\right|\right)_{\max }$ |
| :--: | :--: | :--: | :--: |
| $5-\mu \mathrm{m}$ CMOS | $5 \mu \mathrm{~m}$ | $12.5 \mu \mathrm{~m}$ | 10 V |
| $0.5-\mu \mathrm{m}$ CMOS | $0.5 \mu \mathrm{~m}$ | $1.25 \mu \mathrm{~m}$ | 3.3 V |
| $0.18-\mu \mathrm{m}$ CMOS | $0.18 \mu \mathrm{~m}$ | $0.22 \mu \mathrm{~m}$ | 1.8 V |

When simulating a MOSFET circuit, the user needs to specify both the values of the model parameters and the dimensions of each MOSFET in the circuit being simulated. At least the channel length $L$ and width $W$ must be specified. The areas AD and AS and the perimeters PD and PS need to be specified for SPICE to model the body-junction capacitances (otherwise, zero capacitances would be assumed). The exact values of these geometry parameters depend on the actual layout of the device (Appendix A). However, to estimate these dimensions, we will assume that a metal contact is to be made to each of the source and drain regions of the MOSFET. For this purpose, typically, these diffusion regions must be extended past the end of the channel (i.e., in the $L$-direction in Fig. 5.1) by at least $2.75 L_{\min }$. Thus, the minimum area and perimeter of a drain/source diffusion region with a contact are, respectively,

$$
\mathrm{AD}=\mathrm{AS}=2.75 L_{\min } W
$$
Table B. 3 Values of the Level-1 MOSFET Model Parameters for Two CMOS Technologies ${ }^{1}$

|  | 5- $\mu \mathrm{m}$ CMOS Process |  | 0.5- $\mu \mathrm{m}$ CMOS Process |  | 0.18- $\mu \mathrm{m}$ CMOS Process |  |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: |
|  | NMOS | PMOS | NMOS | PMOS | NMOS | PMOS |
| LEVEL | 1 | 1 | 1 | 1 | 1 | 1 |
| TOX | 8.50e-08 | 8.50e-08 | 9.50e-09 | 9.50e-09 | 4.08e-09 | 4.08e-09 |
| UO | 750 | 250 | 460 | 115 | 291 | 102 |
| LAMBDA | 0.01 | 0.03 | 0.1 | 0.2 | 0.08 | 0.11 |
| GAMMA | 1.4 | 0.65 | 0.5 | 0.45 | 0.3 | 0.3 |
| VTO | 1 | $-1$ | 0.7 | $-0.8$ | 0.5 | $-0.45$ |
| PHI | 0.7 | 0.65 | 0.8 | 0.75 | 0.84 | 0.8 |
| LD | 7.00e-07 | 6.00e-07 | 8.00e-08 | 9.00e-08 | 10e-9 | 10e. 9 |
| JS | 1.00e-06 | 1.00e-06 | 1.00e-08 | 5.00e-09 | 8.38e-6 | 4.00e-07 |
| CJ | 4.00e-04 | 1.80e-04 | 5.70e-04 | 9.30e-04 | 1.60e-03 | 1.00e-03 |
| MJ | 0.5 | 0.5 | 0.5 | 0.5 | 0.5 | 0.45 |
| CJSW | 8.00e-10 | 6.00e-10 | 1.20e-10 | 1.70e-10 | 2.04e-10 | 2.04e-10 |
| MJSW | 0.5 | 0.5 | 0.4 | 0.35 | 0.2 | 0.29 |
| PB | 0.7 | 0.7 | 0.9 | 0.9 | 0.9 | 0.9 |
| CGBO | 2.00e-10 | 2.00e-10 | 3.80e-10 | 3.80e-10 | 3.80e-10 | 3.50e-10 |
| CGDO | 4.00e-10 | 4.00e-10 | 4.00e-10 | 3.50e-10 | 3.67e-10 | 3.43e-10 |
| CGSO | 4.00e-10 | 4.00e-10 | 4.00e-10 | 3.50e-10 | 3.67e-10 | 3.43e-10 |

${ }^{1}$ In PSpice, we have created MOSFET parts corresponding to the above models. Readers can find these parts in the SEDRA.olb library, which is available online at www.oup.com/us/sedrasmith. The NMOS and PMOS parts for the $0.5-\mu \mathrm{m}$ CMOS technology are labeled NMOS0P5_BODY and PMOS0P5_BODY, respectively. The NMOS and PMOS parts for the $5-\mu \mathrm{m}$ CMOS technology are labeled NMOS5P0_BODY and PMOS5P0_BODY, respectively. Furthermore, parts NMOS5P0 and PMOS5P0 are created to correspond to, respectively, part NMOS0P5_BODY with its body connected to net 0 and part PMOS0P5_BODY with its body connected to net $V_{D D}$.
and

$$
\mathrm{PD}=\mathrm{PS}=2 \times 2.75 L_{\min }+W
$$

Unless otherwise specified, we will use Eqs. (B.12) and (B.13) to estimate the dimensions of the drain/source regions in our examples.

Finally, we note that SPICE computes the values for the parameters of the MOSFET small-signal model based on the dc operating point (bias point). These are then used by SPICE to perform the small-signal analysis (ac, or hand, analysis).

# B.1.5 The BJT Model 

SPICE uses a general form of the BJT model that we discussed in Chapter 6 (Fig. 6.5). Known as the transport form of the Ebers-Moll model, it is shown in Fig. B.5. Here, the currents of the base-emitter diode $\left(D_{B E}\right)$ and the base-collector diode $\left(D_{B C}\right)$ are given, respectively, by

$$
i_{B E}=\frac{I_{S}}{\beta_{F}}\left(e^{v_{B E} / n_{F} V_{F}}-1\right)
$$

and

$$
i_{B C}=\frac{I_{S}}{\beta_{R}}\left(e^{v_{B C} / n_{R} V_{F}}-1\right)
$$

where $n_{F}$ and $n_{R}$ are the emission coefficients of the BEJ and BCJ, respectively. These coefficients are generalizations of the constant $n$ of the $p n$-junction diode (Fig. B.3).


Figure B. 5 The transport form of the Ebers-Moll model for an $n p n$ BJT.
(We have so far assumed $n_{F}=n_{R}=1$ ). The parameters $\beta_{F}$ and $\beta_{R}$ are, respectively, the forward and reverse $\beta$ of the BJT. The reverse $\beta$ is the current gain obtained when the collector and emitter are interchanged and is much smaller than the forward $\beta$. In fact, $\beta_{R} \ll 1$. The controlled current-source $i_{C E}$ in the transport model is defined as

$$
i_{C E}=I_{S}\left(e^{v_{B E} / n_{F} V_{T}}-e^{v_{B C} / n_{R} V_{T}}\right)
$$

Observe that $i_{C E}$ represents the current component of $i_{C}$ and $i_{E}$ that arises as a result of the minority carrier diffusion across the base, or carrier transport across the base (hence the name transport model).

The transport model can account for the Early effect in a forward-biased BJT by including the factor $\left(1-v_{B C} / V_{A}\right)$ in the expression for the transport current $i_{C E}$ as follows:

$$
i_{C E}=I_{S}\left(e^{v_{B E} / n_{F} V_{T}}-e^{v_{B C} / n_{R} V_{T}}\right)\left(1-\frac{v_{B C}}{V_{A}}\right)
$$

Figure B. 6 shows the model used in SPICE. Here, resistors $r_{x}, r_{E}$, and $r_{C}$ are added to represent the ohmic resistance of, respectively, the base, emitter, and collector regions. The dynamic operation of the BJT is modeled by two nonlinear capacitors, $C_{B C}$ and $C_{B E}$. Each of these capacitors generally includes a diffusion component (i.e., $C_{D C}$ and $C_{D E}$ ) and a depletion or junction component (i.e., $C_{J C}$ and $C_{J E}$ ) to account for the charge-storage effects within the BJT (as described in Section 10.6.2). Furthermore, the BJT model includes a depletion junction capacitance $C_{J S}$ to account for the collector-substrate junction in integrated-circuit BJTs, where a reverse-biased $p n$ junction is formed between the collector and the substrate (which is common to all components of the IC).

For small-signal (ac) analysis, the SPICE BJT model is equivalent to the hybrid- $\pi$ model of Fig. 7.24, but augmented with $r_{E}, r_{C}$, and (for IC BJTs) $C_{J S}$. Furthermore, the model includes a large resistance $r_{\mu}$ between the base and collector (in parallel with $C_{\mu}$ ) to account for the dependence of $i_{1}$ on $v_{C B}$. The resistance $r_{\mu}$ is very large, typically greater than $10 \beta r_{o}$.

Although Fig. B. 5 shows the SPICE model for the $n p n$ BJT, the corresponding model for the $p n p$ BJT can be obtained by reversing the direction of the currents and the polarity of the diodes and terminal voltages.


Figure B. 6 The SPICE large-signal model for an $n p n$ BJT.

The SPICE Gummel-Poon Model of the BJT The BJT model described above lacks a representation of some second-order effects present in actual devices. One of the most important such effects is the variation of the current gains, $\beta_{F}$ and $\beta_{R}$, with the current $i_{C}$. The Ebers-Moll model assumes $\beta_{F}$ and $\beta_{R}$ to be constant, thereby neglecting their current dependence (as depicted in Fig. 6.19). To account for this, and other second-order effects, SPICE uses a more accurate, yet more complex, BJT model called the Gummel-Poon model (named after H. K. Gummel and H. C. Poon, two pioneers in this field). This model is based on the relationship between the electrical terminal characteristics of a BJT and its base charge. It is beyond the scope of this book to delve into the model details. However, it is important for the reader to be aware of the existence of such a model.

In SPICE, the Gummel-Poon model automatically simplifies to the Ebers-Moll model when certain model parameters are not specified. Consequently, the BJT model to be used by SPICE need not be explicitly specified by the user (unlike the MOSFET case in which the model is specified by the LEVEL parameter). For discrete BJTs, the values of the SPICE model parameters can be determined from the data specified on the BJT data sheets, supplemented (if needed) by key measurements. For instance, in Example PS5.6.1, we will use the Q2N3904 npn BJT (from Fairchild Semiconductor) whose SPICE model is available in PSpice. In fact, the PSpice and Multisim library already includes the SPICE model parameters for many of the commercially available discrete BJTs. For IC BJTs, the values of the SPICE model parameters are determined by the IC manufacturer (using both measurements on the fabricated devices and knowledge of the details of the fabrication process) and are provided to the IC designers.

The SPICE BJT Model Parameters Table B. 4 provides a listing of some of the BJT model parameters used in SPICE. The reader should be already familiar with these parameters. In the absence of a user-specified value for a particular parameter, SPICE uses a default value that typically results in the corresponding effect being ignored. For example, if no value is specified for the forward Early voltage (VAF), SPICE assumes that $\mathrm{VAF}=\infty$
and does not account for the Early effect. Although ignoring VAF can be a serious issue in some circuits, the same is not true, for example, for the value of the reverse Early voltage (VAR).

The BJT Model Parameters BF and BR in SPICE Before leaving the SPICE model, a comment on $\beta$ is in order. SPICE interprets the user-specified model parameters BF and BR as the ideal maximum values of the forward and reverse dc current gains, respectively, versus the operating current. These parameters are not equal to the constant-current-independent parameters $\beta_{F}\left(\beta_{d c}\right)$ and $\beta_{R}$ used in the Ebers-Moll model for the forward and reverse dc current gains of the BJT. SPICE uses a current-dependent model for $\beta_{F}$ and $\beta_{R}$, and the user can specify other parameters (not shown in Table B.4) for this model. Only when such parameters are not specified, and the Early effect is neglected, will SPICE assume that $\beta_{F}$ and $\beta_{R}$ are constant and equal to BF and BR , respectively. Furthermore, SPICE computes values for both $\beta_{\mathrm{dc}}$ and $\beta_{\mathrm{ac}}$, the two parameters that we generally assume to be approximately equal. SPICE then uses $\beta_{\mathrm{ac}}$ to perform small-signal (ac) analysis.

Table B. 4 Parameters of the SPICE BJT Model (Partial Listing)

| SPICE <br> Parameter | Book <br> Symbol | Description | Units |
| :--: | :--: | :--: | :--: |
| IS | $I_{S}$ | Saturation current | A |
| BF | $\beta_{F}$ | Ideal maximum forward current gain |  |
| BR | $\beta_{R}$ | Ideal maximum reverse current gain |  |
| NF | $n_{F}$ | Forward current emission coefficient |  |
| NR | $n_{R}$ | Reverse current emission coefficient |  |
| VAF | $V_{A}$ | Forward Early voltage | V |
| VAR |  | Reverse Early voltage | V |
| RB | $r_{s}$ | Zero-bias base ohmic resistance | $\Omega$ |
| RC | $r_{C}$ | Collector ohmic resistance | $\Omega$ |
| RE | $r_{E}$ | Emitter ohmic resistance | $\Omega$ |
| TF | $\tau_{F}$ | Ideal forward transit time | s |
| TR | $\tau_{R}$ | Ideal reverse transit time | s |
| CJC | $C_{j e 0}$ | Zero-bias base-collector depletion (junction) capacitance | F |
| MJC | $m_{\text {BCJ }}$ | Base-collector grading coefficient |  |
| VJC | $V_{0 c}$ | Base-collector built-in potential | V |
| CJE | $C_{j e 0}$ | Zero-bias base-emitter depletion (junction) capacitance | F |
| MJE | $m_{\text {BEJ }}$ | Base-emitter grading coefficient |  |
| VJE | $V_{0 e}$ | Base-emitter built-in potential | V |
| CJS |  | Zero-bias collector-substrate depletion (junction) capacitance | F |
| MJS |  | Collector-substrate grading coefficient |  |
| VJS |  | Collector-substrate built-in potential | V |
# B. 2 PSpice Examples 

## Example PS.2.1

## Performance of a Noninverting Amplifier

Consider an op amp with a differential input resistance of $2 \mathrm{M} \Omega$, an input offset voltage of 1 mV , a dc gain of 100 dB , and an output resistance of $75 \Omega$. Assume the op amp is internally compensated and has an STC frequency response with a gain-bandwidth product of 1 MHz .
(a) Create a subcircuit model for this op amp in PSpice.
(b) Using this subcircuit, simulate the closed-loop noninverting amplifier in Fig. 2.12 with resistors $R_{1}=$ $1 \mathrm{k} \Omega$ and $R_{2}=100 \mathrm{k} \Omega$ to find:
(i) Its 3-dB bandwidth $f_{\text {MB }}$.
(ii) Its output offset voltage $V_{\text {OYout }}$.
(iii) Its input resistance $R_{\text {in }}$.
(iv) Its output resistance $R_{\text {out }}$.
(c) Simulate the step response of the closed-loop amplifier, and measure its rise time $t_{r}$. Verify that this time agrees with the 3-dB frequency measured above.

## Solution

To model the op amp in PSpice, we use the equivalent circuit in Fig. B.2, but with $R_{\mathrm{ef}}=2 \mathrm{M} \Omega, R_{\mathrm{icm}}=\infty$ (open circuit), $I_{R 1}=I_{R 2}=0$ (open circuit), $V_{O S}=1 \mathrm{mV}, A_{0, d}=10^{5} \mathrm{~V} / \mathrm{V}, A_{0, \mathrm{cm}}=0$ (short circuit), and $R_{o}=75 \Omega$. Furthermore, we set $C_{b}=1 \mu \mathrm{~F}$ and $R_{b}=15.915 \mathrm{k} \Omega$ to achieve an $f_{s}=1 \mathrm{MHz}$.

To measure the 3-dB frequency of the closed-loop amplifier, we apply a $1-\mathrm{V}$ ac voltage at its input, perform an ac-analysis simulation in PSpice, and plot its output versus frequency. The output voltage, plotted in Fig. B.7, corresponds to the gain of the amplifier because we chose an input voltage of 1 V .


Figure B. 7 Frequency response of the closed-loop amplifier in Example PS.2.1.
# Example PS.2.1 continued 

Thus, from Fig. B.7, the closed-loop amplifier has a dc gain of $G_{0}=100.9 \mathrm{~V} / \mathrm{V}$, and the frequency at which its gain drops to $G_{0} / \sqrt{2}=71.35 \mathrm{~V} / \mathrm{V}$ is $f_{\mathrm{MB}}=9.9 \mathrm{kHz}$, which agrees with Eq. (B.7).

The input resistance $R_{\mathrm{in}}$ corresponds to the reciprocal of the current drawn out of the 1-V ac voltage source used in the above ac-analysis simulation at 0.1 Hz . (Theoretically, $R_{\mathrm{in}}$ is the small-signal input resistance at dc. However, ac-analysis simulations must start at frequencies greater than zero, so we use 0.1 Hz to approximate the dc point.) Accordingly, $R_{\mathrm{in}}$ is found to be $2 \mathrm{G} \Omega$.

To measure $R_{\text {out }}$, we short-circuit the amplifier input to ground, inject a 1-A ac current at its output, and perform an ac-analysis simulation. $R_{\text {out }}$ corresponds to the amplifier output voltage at 0.1 Hz and is found to be $76 \mathrm{~m} \Omega$. Although an ac test voltage source could equally well have been used to measure the output resistance in this case, it is a good practice to attach a current source rather than a voltage source between the output and ground. This is because an ac current source appears as an open circuit when the simulator computes the dc bias point of the circuit while an ac voltage source appears as a short circuit, which can erroneously force the dc output voltage to zero. For similar reasons, an ac test voltage source should be attached in series with the biasing dc voltage source for measuring the input resistance of a voltage amplifier.

A careful look at $R_{\text {in }}$ and $R_{\text {out }}$ of the closed-loop amplifier reveals that their values have, respectively, increased and decreased by a factor of about 1000 , relative to the corresponding resistances of the op amp. Such a large input resistance and small output resistance are indeed desirable characteristics for a voltage amplifier. This improvement in the small-signal resistances of the closed-loop amplifier is a direct consequence of applying negative feedback (through resistors $R_{1}$ and $R_{2}$ ) around the open-loop op amp. We will study negative feedback in Chapter 11, where we will also learn how the improvement factor (1000 in this case) corresponds to the ratio of the open-loop op-amp gain $\left(10^{5}\right)$ to the closed-loop amplifier gain (100).

From Eqs. (2.55) and (2.53), the closed-loop amplifier has an STC low-pass response given by

$$
\frac{V_{o}(s)}{V_{i}(s)}=\frac{G_{0}}{1+\frac{s}{2 \pi f_{\mathrm{MB}}}}
$$

As described in Appendix E, the response of such an amplifier to an input step of height $V_{\text {step }}$ is given by

$$
v_{O}(t)=V_{\text {final }}\left(1-e^{-t / \tau}\right)
$$

where $V_{\text {final }}=G_{0} V_{\text {step }}$ is the final output-voltage value (i.e., the voltage value toward which the output is heading) and $\tau=1 /\left(2 \pi f_{\mathrm{MB}}\right)$ is the time constant of the amplifier. If we define $t_{10 \%}$ and $t_{90 \%}$ to be the time it takes for the output waveform to rise to, respectively, $10 \%$ and $90 \%$ of $V_{\text {final }}$, then from Eq. (B.18), $t_{10 \%}$ $\simeq 0.1 \tau$ and $t_{90 \%} \simeq 2.3 \tau$. Therefore, the rise time $t_{r}$ of the amplifier can be expressed as

$$
t_{r}=t_{90 \%}-t_{10 \%}=2.2 \tau=\frac{2.2}{2 \pi f_{\mathrm{MB}}}
$$

Therefore, if $f_{\mathrm{MB}}=9.9 \mathrm{kHz}$, then $t_{r}=35.4 \mu \mathrm{~s}$. To simulate the step response of the closed-loop amplifier, we apply a step voltage at its input, using a piecewise-linear (PWL) source (with a very short rise time); then perform a transient-analysis simulation, and measure the voltage at the output versus time. In our simulation, we applied a 1-V step input, plotted the output waveform in Fig. B.8, and measured $t_{r}$ to be $35.3 \mu \mathrm{~s}$.

The linear macromodels in Figs. B. 1 and B. 2 assume that the op-amp circuit is operating in its linear range; they do not account for its nonideal performance when large signals are present at the output. Therefore, nonlinear effects, such as output saturation and slew rate, are not modeled. This is why, in the step response of Fig. B.8, we could see an output voltage of 100 V when we applied a 1-V step input. However, IC op amps are not capable of producing such large output voltages. Hence, a designer must be very careful when using these models.


Figure B. 8 Step response of the closed-loop amplifier in Example PS.2.1.
It is important to point out that we also saw output voltages of 100 V or so in the ac analysis of Fig. B.7, where for convenience we applied a 1-V ac input to measure the gain of the closed-loop amplifier. So, would we see such large output voltages if the op-amp macromodel accounted for nonlinear effects (particularly output saturation)? The answer is yes, because in an ac analysis PSpice uses a linear model for nonlinear devices with the linear-model parameters evaluated at a bias point. Thus, we must keep in mind that the voltage magnitudes encountered in an ac analysis may not be realistic. In this case, the voltage and current ratios (e.g., the output-to-input voltage ratio as a measure of voltage gain) are of importance to the designer.

# Example PS.2.2 

## Characteristics of the 741 Op Amp

Consider the $\mu$ A741 op amp whose macromodel is available in PSpice. Use PSpice to plot the open-loop gain and hence determine $f_{i}$. Also, investigate the SR limitation and the output saturation of this op amp.

## Solution

Figure B. 9 shows the schematic capture used to simulate the frequency response of the $\mu \mathrm{A} 741$ op amp. ${ }^{1}$ The $\mu$ A741 part has seven terminals. Terminals 7 and 4 are, respectively, the positive and negative

[^0]
[^0]:    ${ }^{1}$ The reader is reminded that the schematic capture diagram and the corresponding PSpice simulation files of all SPICE examples in this book can be found on the text's website (www.oup.com/us/sedrasmith).


Figure B. 9 Simulating the frequency response of the $\mu$ A741 op-amp in Example PS.2.2.
dc power-supply terminals of the op amp. The 741-type op amps are typically operated from $\pm 15-\mathrm{V}$ power supplies; therefore we connected the dc voltage sources $V_{C C}=+15 \mathrm{~V}$ and $V_{E E}=-15 \mathrm{~V}$ to terminals 7 and 4 , respectively. Terminals 3 and 2 of the $\mu \mathrm{A} 741$ part correspond to the positive and negative input terminals, respectively, of the op amp. In general, as outlined in Section 2.1.3, the op-amp input signals are expressed as

$$
\begin{aligned}
& v_{I N P}=V_{C M}+\frac{V_{d}}{2} \\
& v_{I N N}=V_{C M}-\frac{V_{d}}{2}
\end{aligned}
$$

where $v_{I N P}$ and $v_{I N N}$ are the signals at, respectively, the positive- and negative-input terminals of the op amp with $V_{C M}$ being the common-mode input signal (which sets the dc bias voltage at the op-amp input terminals) and $V_{d}$ being the differential input signal to be amplified. The dc voltage source $V_{C M}$ in Fig. B. 9 is used to set the common-mode input voltage. Typically, $V_{C M}$ is set to the average of the dc power-supply voltages $V_{C C}$ and $V_{E E}$ to maximize the available input signal swing. Hence, we set $V_{C M}=0$. The voltage source $V_{d}$ in Fig. B. 9 is used to generate the differential input signal $V_{d}$. This signal is applied differentially to the op-amp input terminals using the voltage-controlled voltage sources $E_{p}$ and $E_{u}$, whose gain constants are set to 0.5 .

Terminals 1 and 5 of part $\mu$ A741 are the offset-nulling terminals of the op amp (as depicted in Fig. 2.36). However, a check of the PSpice netlist of this part (by selecting Edit $\rightarrow$ PSpice Model, in the Capture menus), reveals that these terminals are floating; therefore the offset-nulling characteristic of the op amp is not incorporated in this macromodel.

To measure $f_{t}$ of the op amp, we set the voltage of source $V_{d}$ to be $1-\mathrm{V}$ ac, perform an ac-analysis simulation in PSpice, and plot the output voltage versus frequency as shown in Fig. B.10. Accordingly, the frequency at which the op-amp voltage gain drops to 0 dB is $f_{t}=0.9 \mathrm{MHz}$ (which is close to the $1-\mathrm{MHz}$ value reported in the data sheets for 741-type op amps).

To determine the slew rate of the $\mu \mathrm{A} 741$ op amp, we connect the op amp in a unity-gain configuration, as shown in Fig. B.11, apply a large pulse signal at the input with very short rise and fall times to

[^0]
[^0]:    In these schematics (as shown in Fig. B.13), we use variable parameters to enter the values of the various circuit components. This allow one to investigate the effect of changing component values by simply changing the corresponding parameter values.

Figure B. 10 Frequency response of the $\mu$ A741 op amp in Example PS.2.2.
cause slew-rate limiting at the output, perform a transient-analysis simulation in PSpice, and plot the output voltage as shown in Fig. B.12. The slope of the slew-rate limited output waveform corresponds to the slew-rate of the op amp and is found to be $\mathrm{SR}=0.5 \mathrm{~V} / \mu \mathrm{s}$ (which agrees with the value specified in the data sheets for 741-type op amps).


Figure B. 11 Circuit for determining the slew rate of the $\mu$ A741 op amp in Example PS.5.2.2.


Figure B. 12 Square-wave response of the $\mu \mathrm{A} 741$ op amp connected in the unity-gain configuration shown in Fig. B. 11 .

To determine the maximum output voltage of the $\mu \mathrm{A} 741$ op amp, we set the dc voltage of the differential voltage source $V_{d}$ in Fig. B. 9 to a large value, say +1 V , and perform a bias-point simulation in PSpice. The corresponding dc output voltage is the positive-output saturation voltage of the op amp. We repeat the simulation with the dc differential input voltage set to -1 V to find the negative-output saturation voltage. Accordingly, we find that the $\mu \mathrm{A} 741$ op amp has a maximum output voltage $V_{\text {smax }}=14.8 \mathrm{~V}$.

# Example PS.4.1 

## Design of a DC Power Supply

In this example, we will design a dc power supply using the rectifier circuit whose capture schematic is shown in Fig. B.13. This circuit consists of a full-wave diode rectifier, a filter capacitor, and a zener voltage regulator. The only perhaps puzzling component is the $R_{\text {isolation }}$, the $100-\mathrm{M} \Omega$ resistor between the secondary winding of the transformer and ground. This resistor is included to provide dc continuity and thus "keep SPICE happy"; it has little effect on circuit operation.

Let it be required that the power supply (in Fig. B.13) provide a nominal dc voltage of 5 V and be able to supply a load current $I_{\text {load }}$ as large as 25 mA ; that is, $R_{\text {load }}$ can be as low as $200 \Omega$. The power supply is fed from a $120-\mathrm{V}$ (rms) $60-\mathrm{Hz}$ ac line. Note that in the PSpice schematic (Fig. B.13), we use a sinusoidal voltage source with a $169-\mathrm{V}$ peak amplitude to represent the $120-\mathrm{V}$ rms supply (as $120-\mathrm{V}$ rms $=169-\mathrm{V}$ peak). Assume the availability of a $5.1-\mathrm{V}$ zener diode having $r_{z}=10 \Omega$ at $I_{Z}=20 \mathrm{~mA}$ (and thus $V_{Z 0}=4.9 \mathrm{~V}$ ), and that the required minimum current through the zener diode is $I_{Z \min }=5 \mathrm{~mA}$.


Figure B. 13 Schematic capture of the 5-V dc power supply in Example PS.4.1.
An approximate first-cut design can be obtained as follows: The $120-\mathrm{V}$ (rms) supply is stepped down to provide $12-\mathrm{V}$ (peak) sinusoids across each of the secondary windings using a $14: 1$ turns ratio for the center-tapped transformer. The choice of 12 V is a reasonable compromise between the need to allow for sufficient voltage (above the $5-\mathrm{V}$ output) to operate the rectifier and the regulator, while keeping the PIV ratings of the diodes reasonably low. To determine a value for $R$, we can use the following expression:

$$
R=\frac{V_{C \min }-V_{Z 0}-r_{c} I_{Z \min }}{I_{Z \min }+I_{L \max }}
$$

where an estimate for $V_{C \text { min }}$, the minimum voltage across the capacitor, can be obtained by subtracting a diode drop (say, 0.8 V ) from 12 V and allowing for a ripple voltage across the capacitor of, say, $V_{c}=0.5 \mathrm{~V}$. Thus, $V_{S \text { min }}=10.7 \mathrm{~V}$. Furthermore, we note that $I_{L \text { max }}=25 \mathrm{~mA}$ and $I_{Z \text { min }}=5 \mathrm{~mA}$, and that $V_{Z} 0=4.9 \mathrm{~V}$ and $r_{c}=10 \Omega$. The result is that $R=191 \Omega$.

Next, we determine $C$ using a restatement of Eq. (4.33) with $V_{p} / R$ replaced by the current through the $191-\Omega$ resistor. This current can be estimated by noting that the voltage across $C$ varies from 10.7 V to 11.2 V , and thus has an average value of 10.95 V . Furthermore, the desired voltage across the zener is 5 V . The result is $C=520 \mu \mathrm{~F}$.

Now, with an approximate design in hand, we can proceed with the SPICE simulation. For the zener diode, we use the model of Fig. B.4, and assume (arbitrarily) that $D_{1}$ has $I_{S}=100 \mathrm{pA}$ and $n=0.01$ while $D_{2}$ has $I_{S}=100 \mathrm{pA}$ and $n=1.7$. For the rectifier diodes, we use the commercially available 1 N 4148 type $^{2}$ (with $I_{S}=2.682 \mathrm{nA}, n=1.836, R_{S}=0.5664 \Omega, V_{0}=0.5 \mathrm{~V}, C_{f 0}=4 \mathrm{pF}, m=0.333, \tau_{T}=11.54 \mathrm{~ns}, V_{Z K}=100 \mathrm{~V}$, $I_{Z K}=100 \mu \mathrm{~A})$.

In PSpice, we perform a transient analysis and plot the waveforms of both the voltage $v_{C}$ across the smoothing capacitor $C$ and the voltage $v_{O}$ across the load resistor $R_{\text {load }}$. The simulation results for $R_{\text {load }}=200 \Omega\left(I_{\text {load }} \simeq 25 \mathrm{~mA}\right)$ are presented in Fig. B.14. Observe that $v_{C}$ has an average of 10.85 V and a ripple of $\pm 0.21 \mathrm{~V}$. Thus, $V_{1}=0.42 \mathrm{~V}$, which is close to the $0.5-\mathrm{V}$ value that we would expect from the chosen value of $C$. The output voltage $v_{O}$ is very close to the required 5 V , with $v_{O}$ varying between 4.957 V and 4.977 V for a ripple of only 20 mV . The variations of $v_{O}$ with $R_{\text {load }}$ are illustrated in Fig. B. 15

[^0]
[^0]:    ${ }^{2}$ The 1N4148 model is included in the evaluation (EVAL) library of PSpice.


Figure B. 14 The voltage $v_{2}$ across the smoothing capacitor $C$ and the voltage $v_{\mathrm{a}}$ across the load resistor $R_{\text {load }}=200 \Omega$ in the 5-V power supply of Example PS.4.1.


Figure B. 15 The output-voltage waveform from the 5-V power supply (in Example PS.4.1) for various load resistances: $R_{\text {load }}=500 \Omega, 250 \Omega, 200 \Omega$, and $150 \Omega$. The voltage regulation is lost at a load resistance of $150 \Omega$.
for $R_{\text {load }}=500 \Omega, 250 \Omega, 200 \Omega$, and $150 \Omega$. Accordingly, $v_{O}$ remains close to the nominal value of 5 V for $R_{\text {load }}$ as low as $200 \Omega\left(I_{\text {load }} \simeq 25 \mathrm{~mA}\right)$. For $R_{\text {load }}=150 \Omega$ (which implies $I_{\text {load }} \simeq 33.3 \mathrm{~mA}$, greater than the maximum designed value), we see a significant drop in $v_{\mathrm{O}}$ (to about 4.8 V ), as well as a large increase in the ripple voltage at the output (to about 190 mV ). This is because the zener regulator is no longer operational; the zener has in fact cut off.

We conclude that the design meets the specifications, and we can stop here. Alternatively, we may consider using further runs of PSpice to help with the task of fine-tuning the design. For instance, we could consider what happens if we use a lower value of $C$, and so on. We can also investigate other properties of the present design (e.g., the maximum current through each diode) and ascertain whether this maximum is within the rating specified for the diode.

# EXERCISE 

B. 1 Use PSpice to investigate the operation of the voltage doubler whose schematic capture is shown in Fig. B.16(a). Specifically, plot the transient behavior of the voltages $v_{2}$ and $v_{\text {OUT }}$ when the input is a sinusoid of $10-\mathrm{V}$ peak and $1-\mathrm{kHz}$ frequency. Assume that the diodes are of the 1 N 4148 type (with $I_{S}=2.682 \mathrm{nA}, n=1.836, R_{S}=0.5664 \Omega, V_{0}=0.5 \mathrm{~V}, C_{i} 0=4 \mathrm{pF}, m=0.333, \tau_{T}=11.54 \mathrm{~ns}$, $\left.V_{Z K}=100 \mathrm{~V}, I_{Z K}=100 \mu \mathrm{~A}\right)$.
Ans. The voltage waveforms are shown in Fig. B.16(b).

(a)

Figure EB. 16 (a) Schematic capture of the voltage-doubler circuit in Exercise B.1. (b) Various voltage waveforms in the voltage-doubler circuit. The top graph displays the input sine-wave voltage signal, the middle graph displays the voltage across diode $D_{1}$, and the bottom graph displays the voltage that appears at the output.


Figure EB. 16 continued
# Example PS.7.1 

## The CS Amplifier

In this example, we will use PSpice to analyze and verify the design of the CS amplifier whose capture schematic is shown in Fig. B.17. ${ }^{3}$ Observe that the MOSFET has its source and body connected in order to cancel the body effect. We will assume a $0.5-\mu \mathrm{m}$ CMOS technology for the MOSFET and use the SPICE level-1 model parameters listed in Table B.3. We will also assume a signal-source resistance $R_{\text {sig }}=10 \mathrm{k} \Omega$, a load resistance $R_{L}=50 \mathrm{k} \Omega$, and bypass and coupling capacitors of $10 \mu \mathrm{~F}$. The targeted specifications for this CS amplifier are a midband gain $A_{M}=10 \mathrm{~V} / \mathrm{V}$ and a maximum power consumption $P=1.5 \mathrm{~mW}$. As should always be the case with computer simulation, we will begin with an approximate pencil-and-paper design. We will then use PSpice to fine-tune our design and to investigate the performance of the final design. In this way, maximum advantage and insight can be obtained from simulation.

With a $3.3-\mathrm{V}$ power supply, the drain current of the MOSFET must be limited to $I_{D}=$ $P / V_{D D}=1.5 \mathrm{~mW} / 3.3 \mathrm{~V}=0.45 \mathrm{~mA}$ to meet the power consumption specification. Choosing $V_{D V}=0.3 \mathrm{~V}$ (a typical value in low-voltage designs) and $V_{D S}=V_{D D} / 3$ (to achieve a large signal swing at the output), the MOSFET can now be sized as

$$
\frac{W}{L_{\text {eff }}}=\frac{I_{D}}{\frac{1}{2} k_{b}^{\prime} V_{D V}^{2}\left(1+\lambda V_{D S}\right)}=\frac{0.45 \times 10^{-3}}{\frac{1}{2}\left(170.1 \times 10^{-6}\right)(0.3)^{2}[1+0.1(1.1)]} \simeq 53
$$

where $k_{b}^{\prime}=\mu_{a} C_{o s}=170.1 \mu \mathrm{~A} / \mathrm{V}^{2}$ (from Table B.3). Here, $L_{\text {eff }}$ rather than $L$ is used to more accurately compute $I_{D}$. The effect of using $W_{\text {eff }}$ rather than $W$ is much less important because typically $W \gg W_{e v}$. Thus, choosing $L=0.6 \mu \mathrm{~m}$ results in $L_{\text {eff }}=L-2 L_{e v}=0.44 \mu \mathrm{~m}$ and $W=23.3 \mu \mathrm{~m}$. Note that we chose $L$ slightly larger than $L_{\min }$. This is a common practice in the design of analog ICs to minimize the effects of fabrication nonidealities on the actual value of $L$. As shown in the text, this is particularly important when


Figure B. 17 Schematic capture of the CS amplifier in Example PS.7.1.

[^0]
[^0]:    ${ }^{3}$ The reader is reminded that the schematic capture diagrams and the corresponding PSpice simulation files of all SPICE examples in this book can be found on the text's website (www.oup.com/us/sedrasmith). In these schematics (as shown in Fig. B.17), we used variable parameters to enter the values of the various circuit components, including the dimensions of the MOSFET. This will allow the reader to investigate the effect of changing component values by simply changing the corresponding parameter values.
# Example PS.7.1 continued 

the circuit performance depends on the matching between the dimensions of two or more MOSFETs (e.g., in the current-mirror circuits studied in Chapter 8).

Next, $R_{D}$ is calculated based on the desired voltage gain:

$$
\left|A_{v}\right|=g_{m}\left(R_{D}\left\|R_{L}\right\| r_{o}\right)=10 \mathrm{~V} / \mathrm{V} \Rightarrow R_{D} \simeq 4.2 \mathrm{k} \Omega
$$

where $g_{m}=3.0 \mathrm{~mA} / \mathrm{V}$ and $r_{o}=22.2 \mathrm{k} \Omega$. Hence, the output bias voltage is $V_{O}=V_{D D}-I_{D} R_{D}=1.39 \mathrm{~V}$. An $R_{S}=\left(V_{O}-V_{D I} / 3\right) / I_{D}=630 \Omega$ is needed to bias the MOSFET at a $V_{D S}=V_{D D} / 3$. Finally, resistors $R_{G 1}=2 \mathrm{M} \Omega$ and $R_{G 2}=1.3 \mathrm{M} \Omega$ are chosen to set the gate bias voltage at $V_{G}=I_{D} R_{S}+V_{O V}+V_{t o} \simeq 1.29 \mathrm{~V}$. Using large values for these gate resistors ensures that both their power consumption and the loading effect on the input signal source are negligible. Note that we neglected the body effect in the expression for $V_{G}$ to simplify our hand calculations.

We will now use PSpice to verify our design and investigate the performance of the CS amplifier. We begin by performing a bias-point simulation to verify that the MOSFET is properly biased in the saturation region and that the dc voltages and currents are within the desired specifications. Based on this simulation, we have decreased the value of $W$ to $22 \mu \mathrm{~m}$ to limit $I_{D}$ to about 0.45 mA . Next, to measure the midband gain $A_{M}$ and the $3-\mathrm{dB}$ frequencies ${ }^{4} f_{L}$ and $f_{H}$, we apply a $1-\mathrm{V}$ ac voltage at the input, perform an ac-analysis simulation, and plot the output-voltage magnitude (in dB ) versus frequency as shown in Fig. B.18. This corresponds to the magnitude response of the CS amplifier because we chose a 1-V input signal. ${ }^{5}$ Accordingly, the midband gain is $A_{M}=9.55 \mathrm{~V} / \mathrm{V}$ and the $3-\mathrm{dB}$ bandwidth is $B W=f_{H}-f_{L} \simeq 122.1 \mathrm{MHz}$. Figure B. 18 further shows that the gain begins to fall off at about 300 Hz but flattens out again at about 10 Hz . This flattening in the gain at low frequencies is due to a real transmission zero ${ }^{6}$ introduced in the transfer function of the amplifier by $R_{S}$ together with $C_{S}$. This zero occurs at a frequency $f_{Z}=1 /\left(2 \pi R_{S} C_{S}\right)=25.3 \mathrm{~Hz}$, which is typically between the break frequencies $f_{P 2}$ and $f_{P 3}$ derived in Section 10.1.1. So, let us now verify this phenomenon by resimulating the CS amplifier with a $C_{S}=0$ (i.e., removing $C_{S}$ ) in order to move $f_{Z}$ to infinity and remove its effect. The corresponding frequency response is plotted also in Fig. B.18. As expected, with $C_{S}=0$, we do not observe any flattening in the low-frequency response of the amplifier. However, because the CS amplifier now includes a source resistor $R_{S}, A_{M}$ has dropped by a factor of 2.6. This factor is approximately equal to $\left(1+g_{m} R_{S}\right)$, as expected from our study of the CS amplifier with a source-degeneration resistance in Section 7.3.4. Note that the bandwidth $B W$ has increased by approximately the same factor as the drop in gain $A_{M}$. As we will learn in Chapter 11 when we study negative feedback, the source-degeneration resistor $R_{S}$ provides negative feedback, which allows us to trade off gain for wider bandwidth.

To conclude this example, we will demonstrate the improved bias stability achieved when a source resistor $R_{S}$ is used (see the discussion in Section 7.1.1 \& 7.1.7). Specifically, we will change (in the MOSFET level-1 model for part NMOS0P5) the value of the zero-bias threshold voltage parameter VTO by $\pm 15 \%$ and perform a bias-point simulation in PSpice. Table B. 5 shows the corresponding variations in $I_{D}$ and $V_{O}$ for the case in which $R_{S}=630 \Omega$. For the case without source degeneration, we use an $R_{S}=0$ in the

[^0]
[^0]:    ${ }^{4}$ No detailed knowledge of frequency-response calculations is required for this example; all that is needed is Section 7.5.3. Nevertheless, after the study of the frequency response of the CS amplifier in Sections 10.1 through 10.3, the reader will benefit by returning to this example and using PSpice to experiment further with the circuit. ${ }^{5}$ The reader should not be alarmed about the use of such a large signal amplitude. Recall that in a small-signal (ac) simulation, SPICE first finds the small-signal equivalent circuit at the bias point and then analyzes this linear circuit. Such ac analysis can, of course, be done with any ac signal amplitude. However, a $1-\mathrm{V}$ ac input is convenient to use because the resulting ac output corresponds to the voltage gain of the circuit.
    ${ }^{6}$ Readers who have not yet studied poles and zeros can skip these few sentences.


Figure B. 18 Frequency response of the CS amplifier in Example PS.7.1 with $C_{S}=10 \mu \mathrm{~F}$ and $C_{S}=0$ (i.e., $C_{S}$ removed).
schematic of Fig. B.17. Furthermore, to obtain the same $I_{D}$ and $V_{O}$ in both cases (for the nominal threshold voltage $V_{t 0}=0.7 \mathrm{~V}$ ), we use an $R_{G 2}=0.88 \mathrm{M} \Omega$ to reduce $V_{G}$ to around $V_{O V}+V_{m}=1 \mathrm{~V}$. The corresponding variations in the bias point are shown in Table B.5. Accordingly, we see that the source-degeneration resistor makes the bias point of the CS amplifier less sensitive to changes in the threshold voltage. In fact, the reader can show for the values displayed in Table B. 5 that the variation in bias current ( $\Delta I / I$ ) is reduced by approximately the same factor, $\left(1+g_{m} R_{S}\right)$. However, unless a large bypass capacitor $C_{S}$ is used, this reduced sensitivity comes at the expense of a reduction in the midband gain (as we observed in this example when we simulated the frequency response of the CS amplifier with a $C_{S}=0$ ).

Table B. 5 Variations in the Bias Point with the MOSFET Threshold Voltage

|  | $R_{S}=630 \Omega$ |  | $R_{S}=0$ |  |
| :-- | :--: | :--: | :--: | :--: |
| $V_{m 0}$ | $I_{D}(\mathrm{~mA})$ | $V_{O}(\mathrm{~V})$ | $I_{D}(\mathrm{~mA})$ | $V_{O}(\mathrm{~V})$ |
|  |  |  |  |  |
| 0.60 | 0.56 | 0.962 | 0.71 | 0.33 |
| 0.7 | 0.46 | 1.39 | 0.45 | 1.40 |
| 0.81 | 0.36 | 1.81 | 0.21 | 2.40 |
# Example PS.6.1 

## Dependence of the BJT $\beta$ on the Bias Current

In this example, we use PSpice to simulate the dependence of $\beta_{\mathrm{dc}}$ on the collector bias current for the Q2N3904 discrete BJT (from Fairchild Semiconductor) whose model parameters are listed in Table B. 6 and are available in PSpice. ${ }^{7}$ As shown in the schematic capture ${ }^{8}$ of Fig. B.19, the $V_{C E}$ of the BJT is fixed using a constant voltage source (in this example, $V_{C E}=2 \mathrm{~V}$ ) and a dc current source $I_{B}$ is applied at the base. To illustrate the dependence of $\beta_{\mathrm{dc}}$ on the collector current $I_{C}$, we perform a dc-analysis simulation in which the sweep variable is the current source $I_{B}$. The $\beta_{\mathrm{dc}}$ of the BJT, which corresponds to the ratio of the collector current $I_{C}$ to the base current $I_{B}$, can then be plotted versus $I_{C}$ using Probe (the graphical interface of PSpice), as shown in Fig. B.20. We see that to operate at the maximum value of $\beta_{\mathrm{dc}}$ (i.e., $\beta_{\mathrm{dc}}=163$ ), at $V_{C E}=2 \mathrm{~V}$, the BJT must be biased at an $I_{C}=10 \mathrm{~mA}$. Since increasing the bias current of a transistor increases the power dissipation, it is clear from Fig. B. 20 that the choice of current $I_{C}$ is a trade-off between the current gain $\beta_{\mathrm{dc}}$ and the power dissipation. Generally speaking, the optimum $I_{C}$ depends on the application and technology in hand. For example, for the Q2N3904 BJT operating at $V_{C E}=2 \mathrm{~V}$, decreasing $I_{C}$ by a factor of 20 (from 10 mA to 0.5 mA ) results in a drop in $\beta_{\mathrm{dc}}$ of about $25 \%$ (from 163 to 123 )


Figure B. 19 The PSpice test bench used to demonstrate the dependence of $\beta_{\mathrm{dc}}$ on the collector bias current $I_{C}$ for the Q2N3904 discrete BJT (Example PS.6.1).

Table B. 6 Spice Model Parameters of the Q2N3904 Discrete BJT

| IS $=6.734 \mathrm{~F}$ | XTI $=3$ | EG $=1.11$ | VAF $=74.03$ | $\mathrm{BF}=416.4$ | NE $=1.259$ | ISE $=6.734 \mathrm{~F}$ |
| :-- | :-- | :-- | :-- | :-- | :-- | :-- |
| IKF $=66.78 \mathrm{M}$ | XTB $=1.5$ | $\mathrm{BR}=.7371$ | $\mathrm{NC}=2$ | $\mathrm{ISC}=0$ | IKR $=0$ | $\mathrm{RC}=1$ |
| CJC $=3.638 \mathrm{P}$ | MJC $=.3085$ | $\mathrm{VJC}=.75$ | $\mathrm{FC}=.5$ | $\mathrm{CJE}=4.493 \mathrm{P}$ | $\mathrm{MJE}=.2593$ | $\mathrm{VJE}=.75$ |
| TR $=239.5 \mathrm{~N}$ | $\mathrm{TF}=301.2 \mathrm{P}$ | $\mathrm{ITF}=.4$ | $\mathrm{VTF}=4$ | $\mathrm{XTF}=2$ | $\mathrm{RB}=10$ |  |

[^0]
[^0]:    ${ }^{7}$ The Q2N3904 model is included in the evaluation (EVAL) library of PSpice, which is available on the website accompanying this book.
    ${ }^{8}$ The reader is reminded that the schematic diagrams and the corresponding PSpice simulation files of all SPICE examples in this book can be found on the text's website (www.oup.com/us/sedrasmith). In these schematics (as shown in Fig. B.19), we use variable parameters to enter the values of the various circuit components. This allows one to investigate the effect of changing component values by simply changing the corresponding parameter values.$v_{O}=-\left(2 v_{1}+4 v_{2}+8 v_{3}\right)$ using small resistors but no smaller than $1 \mathrm{k} \Omega$.

D 2.39 An ideal op amp is connected in the weighted summer configuration of Fig. 2.10. The feedback resistor $R_{f}=100 \mathrm{k} \Omega$, and six $100-\mathrm{k} \Omega$ resistors are connected to the inverting input terminal of the op amp. Show, by sketching the various circuit configurations, how this basic circuit can be used to implement the following functions:
(a) $v_{O}=-\left(v_{1}+2 v_{2}+3 v_{3}\right)$
(b) $v_{O}=-\left(v_{1}+v_{2}+2 v_{3}+2 v_{4}\right)$
(c) $v_{O}=-\left(v_{1}+5 v_{2}\right)$
(d) $v_{O}=-6 v_{1}$

In each case find the input resistance seen by each of the signal sources supplying $v_{1}, v_{2}, v_{3}$, and $v_{4}$. Suggest at least two additional summing functions that you can realize with this circuit. How would you realize a summing coefficient that is 0.5 ?

D 2.40 Give a circuit, complete with component values, for a weighted summer that shifts the dc level of a sine-wave signal of $3 \sin (\omega t) \mathrm{V}$ from zero to -3 V . Assume that in addition to the sine-wave signal you have a dc reference voltage of 1.5 V available. Sketch the output signal waveform.

D 2.41 Use two ideal op amps and resistors to implement the summing function

$$
v_{O}=v_{1}+2 v_{2}-3 v_{3}-5 v_{4}
$$

D 2.42 In an instrumentation system, there is a need to take the difference between two signals, one of $v_{1}=$ $2 \sin (2 \pi \times 60 t)+0.01 \sin (2 \pi \times 1000 t)$ volts and another of $v_{2}=2 \sin (2 \pi \times 60 t)-0.01 \sin (2 \pi \times 1000 t)$ volts. Draw a circuit that finds the required difference using two op amps and mainly $100-\mathrm{k} \Omega$ resistors. Since it is desirable to amplify the $1000-\mathrm{Hz}$ component in the process, arrange to provide an overall gain of 100 as well. The op amps available are ideal except that their output voltage swing is limited to $\pm 10 \mathrm{~V}$.
*2.43 Figure P2.43 shows a circuit for a digital-to-analog converter (DAC). The circuit accepts a 4-bit input binary word $a_{3} a_{2} a_{1} a_{0}$, where $a_{0}, a_{1}, a_{2}$, and $a_{3}$ take the values of 0 or 1 , and it provides an analog output voltage $v_{O}$ proportional to the value of the digital input. Each of the bits of the input word controls the correspondingly numbered switch. For instance, if $a_{2}$ is 0 then switch $S_{2}$ connects the $20-\mathrm{k} \Omega$ resistor to ground, while if $a_{2}$ is 1 then $S_{2}$ connects the $20-\mathrm{k} \Omega$ resistor to the $+5-\mathrm{V}$
power supply. Show that $v_{O}$ is given by

$$
v_{O}=-\frac{R_{f}}{16}\left[2^{0} a_{0}+2^{1} a_{1}+2^{2} a_{2}+2^{3} a_{3}\right]
$$

where $R_{f}$ is in kilohms. Find the value of $R_{f}$ so that $v_{O}$ ranges from 0 to -12 volts.


Figure P2.43

## Section 2.3: The Noninverting Configuration

D 2.44 Given an ideal op amp to implement designs for the following closed-loop gains, what values of resistors ( $R_{1}$, $R_{2}$ ) should be used? Where possible, use at least one $10-\mathrm{k} \Omega$ resistor as the smallest resistor in your design.
(a) $+1 \mathrm{~V} / \mathrm{V}$
(b) $+2 \mathrm{~V} / \mathrm{V}$
(c) $+21 \mathrm{~V} / \mathrm{V}$
(d) $+100 \mathrm{~V} / \mathrm{V}$

D 2.45 Design a circuit based on the topology of the noninverting amplifier to obtain a gain of $+1.5 \mathrm{~V} / \mathrm{V}$, using only $10-\mathrm{k} \Omega$ resistors. Note that there are two possibilities. Which of these can be easily converted to have a gain of

[^0]
[^0]:    210 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
either +1.0 V/V or +2.0 V/V simply by short-circuiting a single resistor in each case?

D 2.46 Figure P2.46 shows a circuit for an analog voltmeter of very high input resistance that uses an inexpensive moving-coil meter. The voltmeter measures the voltage $V$ applied between the op amp's positive-input terminal and ground. Assuming that the moving coil produces full-scale deflection when the current passing through it is $100 \mu \mathrm{~A}$, find the value of $R$ such that a full-scale reading is obtained when $V$ is +10 V . Does the meter resistance shown affect the voltmeter calibration?


Figure P2.46

D *2.47 (a) Use superposition to show that the output of the circuit in Fig. P2.47 is given by

$$
\begin{aligned}
v_{O}= & {\left[\frac{R_{f}}{R_{N 1}} v_{N 1}+\frac{R_{f}}{R_{N 2}} v_{N 2}+\cdots+\frac{R_{f}}{R_{N n}} v_{N n}\right] } \\
& +\left[1+\frac{R_{f}}{R_{N}}\right]\left[\frac{R_{P}}{R_{P 1}} v_{P 1}+\frac{R_{P}}{R_{P 2}} v_{P 2}+\cdots+\frac{R_{P}}{R_{P n}} v_{P n}\right]
\end{aligned}
$$

where $R_{N}=R_{N 1}\left\|R_{N 2}\right\| \cdots \| R_{N n}$, and

$$
R_{P}=R_{P 1}\left\|R_{P 2}\right\| \cdots \| R_{P n} \| R_{P 0}
$$

(b) Design a circuit to obtain

$$
v_{O}=-4 v_{N 1}+v_{P 1}+3 v_{P 2}
$$

The smallest resistor used should be $10 \mathrm{k} \Omega$.


Figure P2.47

D *2.48 Design a circuit, using one ideal op amp, whose output is $v_{O}=v_{I 1}+2 v_{I 2}-9 v_{I_{2}}+4 v_{I 4}$. (Hint: Use a structure similar to that shown in general form in Fig. P2.47.)
2.49 Derive an expression for the voltage gain, $v_{O} / v_{I}$, of the circuit in Fig. P2.49.


Figure P2.49
2.50 For the circuit in Fig. P2.50, use superposition to find $v_{O}$ in terms of the input voltages $v_{1}$ and $v_{2}$. Assume an ideal op amp. For

$$
\begin{aligned}
& v_{1}=10 \sin (2 \pi \times 60 t)-0.1 \sin (2 \pi \times 1000 t) \text {, volts } \\
& v_{2}=10 \sin (2 \pi \times 60 t)+0.1 \sin (2 \pi \times 1000 t) \text {, volts }
\end{aligned}
$$

find $v_{O}$.


Figure P2.50

D 2.51 The circuit shown in Fig. P2.51 utilizes a $10-\mathrm{k} \Omega$ potentiometer to realize an adjustable-gain amplifier. Derive an expression for the gain as a function of the potentiometer setting $x$. Assume the op amp to be ideal. What is the range of gains obtained? Show how to add a fixed resistor so that the gain range can be 1 to $11 \mathrm{~V} / \mathrm{V}$. What should the resistor value be?


Figure P2.51

D 2.52 Given the availability of resistors of value $1 \mathrm{k} \Omega$ and $10 \mathrm{k} \Omega$ only, design a circuit based on the noninverting configuration to realize a gain of $+10 \mathrm{~V} / \mathrm{V}$. What is the input resistance of your amplifier?
2.53 It is required to connect a $10-\mathrm{V}$ source with a source resistance of $1 \mathrm{M} \Omega$ to a $1-\mathrm{k} \Omega$ load. Find the voltage that will appear across the load if:
(a) The source is connected directly to the load.
(b) A unity-gain op-amp buffer is inserted between the source and the load.

In each case find the load current and the current supplied by the source. Where does the load current come from in case (b)?
2.54 Derive an expression for the gain of the voltage follower of Fig. 2.14, assuming the op amp to be ideal except for having a finite gain $A$. Calculate the value of the closed-loop gain for $A=1000,100$, and 10 . In each case find the percentage error in gain magnitude from the nominal value of unity.
2.55 Complete the following table for feedback amplifiers created using one ideal op amp. Note that $R_{\mathrm{in}}$ signifies input resistance and $R_{1}$ and $R_{2}$ are feedback-network resistors as labeled in the inverting and noninverting configurations.

| Case | Gain | $\boldsymbol{R}_{\text {in }}$ | $\boldsymbol{R}_{\mathbf{1}}$ | $\boldsymbol{R}_{\mathbf{2}}$ |
| :--: | :--: | :--: | :--: | :--: |
| a | $-10 \mathrm{~V} / \mathrm{V}$ | $10 \mathrm{k} \Omega$ |  |  |
| b | $-1 \mathrm{~V} / \mathrm{V}$ |  | $100 \mathrm{k} \Omega$ |  |
| c | $-2 \mathrm{~V} / \mathrm{V}$ |  |  | $200 \mathrm{k} \Omega$ |
| d | $+1 \mathrm{~V} / \mathrm{V}$ | $\infty$ |  |  |
| e | $+2 \mathrm{~V} / \mathrm{V}$ |  | $100 \mathrm{k} \Omega$ |  |
| f | $+11 \mathrm{~V} / \mathrm{V}$ |  |  | $100 \mathrm{k} \Omega$ |
| g | $-0.5 \mathrm{~V} / \mathrm{V}$ | $20 \mathrm{k} \Omega$ |  |  |

D 2.56 A noninverting op-amp circuit with nominal gain of $10 \mathrm{~V} / \mathrm{V}$ uses an op amp with open-loop gain of $100 \mathrm{~V} / \mathrm{V}$ and a lowest-value resistor of $10 \mathrm{k} \Omega$. What closed-loop gain actually results? With what value resistor can which resistor be shunted to achieve the nominal gain? If in the manufacturing process, an op amp of gain $200 \mathrm{~V} / \mathrm{V}$ were used, what closed-loop gain would result in each case (the uncompensated one, and the compensated one)?
2.57 Use Eq. (2.11) to show that if the reduction in the closed-loop gain $G$ from the nominal value $G_{0}=1+R_{2} / R_{1}$ is to be kept less than $x \%$ of $G_{0}$, then the open-loop gain of the op amp must exceed $G_{0}$ by at least a factor $F=(100 / x)-1 \simeq$ $100 / x$. Find the required $F$ for $x=0.01,0.1,1$, and 10 . Utilize these results to find for each value of $x$ the minimum required open-loop gain to obtain closed-loop gains of $1,10,10^{2}, 10^{3}$, and $10^{4} \mathrm{~V} / \mathrm{V}$.
2.58 For each of the following combinations of op-amp open-loop gain $A$ and nominal closed-loop gain $G_{0}$, calculate the actual closed-loop gain $G$ that is achieved. Also, calculate the percentage by which $|G|$ falls short of the nominal gain magnitude $\left|G_{0}\right|$.

[^0]
[^0]:    2.58 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
| Case | $\boldsymbol{G}_{\mathbf{0}}(\mathrm{V} / \mathrm{V})$ | $\boldsymbol{A}(\mathrm{V} / \mathrm{V})$ |
| :--: | :--: | :--: |
| a | -1 | 10 |
| b | +1 | 10 |
| c | -1 | 100 |
| d | +10 | 10 |
| e | -10 | 100 |
| f | -10 | 1000 |
| g | +1 | 2 |

2.59 Figure P2.59 shows a circuit that provides an output voltage $v_{O}$ whose value can be varied by turning the wiper of the $100-\mathrm{k} \Omega$ potentiometer. Find the range over which $v_{O}$ can be varied. If the potentiometer is a " 20 -turn" device, find the change in $v_{O}$ corresponding to each turn of the pot.


Figure P2.59

## Section 2.4: Difference Amplifiers

2.60 Find the voltage gain $v_{O} / v_{M}$ for the difference amplifier of Fig. 2.16 for the case $R_{1}=R_{3}=5 \mathrm{k} \Omega$ and $R_{2}=R_{4}=$ $100 \mathrm{k} \Omega$. What is the differential input resistance $R_{i d}$ ? If the two key resistance ratios $\left(R_{2} / R_{1}\right)$ and $\left(R_{4} / R_{3}\right)$ are different from each other by $1 \%$, what do you expect the common-mode gain $A_{c m}$ to be? Also, find the CMRR in this case. Neglect the effect of the ratio mismatch on the value of $A_{d}$.

D 2.61 Using the difference amplifier configuration of Fig. 2.16 and assuming an ideal op amp, design the circuit to provide the following differential gains. In each case, the differential input resistance should be $20 \mathrm{k} \Omega$.
(a) $1 \mathrm{~V} / \mathrm{V}$
(b) $5 \mathrm{~V} / \mathrm{V}$
(c) $100 \mathrm{~V} / \mathrm{V}$
(d) $0.5 \mathrm{~V} / \mathrm{V}$
2.62 For the circuit shown in Fig. P2.62, express $v_{O}$ as a function of $v_{1}$ and $v_{2}$. What is the input resistance seen by $v_{1}$ alone? By $v_{2}$ alone? By a source connected between the two input terminals? By a source connected to both input terminals simultaneously?


Figure P2.62
2.63 Consider the difference amplifier of Fig. 2.16 with the two input terminals connected together to an input common-mode signal source. For $R_{2} / R_{1}=R_{4} / R_{3}$, show that the input common-mode resistance is $\left(R_{3}+R_{4}\right) \|\left(R_{1}+R_{2}\right)$.
2.64 Consider the circuit of Fig. 2.16, and let each of the $v_{I 1}$ and $v_{I 2}$ signal sources have a series resistance $R_{s}$. What condition must apply in addition to the condition in Eq. (2.15) in order for the amplifier to function as an ideal difference amplifier?
*2.65 For the difference amplifier shown in Fig. P2.62, let all the resistors be $10 \mathrm{k} \Omega \pm x \%$. Find an expression for the worst-case common-mode gain that results. Evaluate this for $x=0.1,1$, and 5 . Also, evaluate the resulting CMRR in each case. Neglect the effect of resistor tolerances on $A_{d}$.
2.66 For the difference amplifier of Fig. 2.16, show that if each resistor has a tolerance of $\pm 100 \epsilon \%$ (i.e., for, say, a $5 \%$ resistor, $\epsilon=0.05$ ) then the worst-case CMRR is given approximately by

$$
\mathrm{CMRR} \simeq 20 \log \left[\frac{K+1}{4 \epsilon}\right]
$$

[^0]
[^0]:    $5 \mathrm{~N}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
where $K$ is the nominal (ideal) value of the ratios $\left(R_{3} / R_{1}\right)$ and $\left(R_{4} / R_{3}\right)$. Calculate the value of worst-case CMRR for an amplifier designed to have a differential gain of ideally $100 \mathrm{~V} / \mathrm{V}$, assuming that the op amp is ideal and that $1 \%$ resistors are used. What resistor tolerance is needed if a CMRR of 80 dB is required?

D *2.67 Design the difference amplifier circuit of Fig. 2.16 to realize a differential gain of 1000 , a differential input resistance of $2 \mathrm{k} \Omega$, and a minimum CMRR of 88 dB . Assume the op amp to be ideal. Specify both the resistor values and their required tolerance (e.g., better than $x \%$ ).
*2.68 (a) Find $A_{d}$ and $A_{c m}$ for the difference amplifier circuit shown in Fig. P2.68.
(b) If the op amp is specified to operate properly as long as the common-mode voltage at its positive and negative inputs falls in the range $\pm 2.5 \mathrm{~V}$, what is the corresponding limitation on the range of the input common-mode signal $v_{I c m}$ ? (This is known as the common-mode range of the differential amplifier.)
(c) The circuit is modified by connecting a $10-\mathrm{k} \Omega$ resistor between node A and ground, and another $10-\mathrm{k} \Omega$ resistor between node B and ground. What will now be the values of $A_{d}, A_{c m}$, and the input common-mode range?


Figure P2.68
D *2.69 To obtain a high-gain, high-input-resistance difference amplifier, the circuit in Fig. P2.69 employs positive feedback, in addition to the negative feedback provided by the resistor $R$ connected from the output to the negative input of the op amp. Specifically, a voltage divider $\left(R_{5}, R_{6}\right)$ connected across the output feeds a fraction $\beta$ of the output, that is, a voltage $\beta v_{O}$, back to the positive-input terminal of the op amp through a resistor $R$. Assume that $R_{5}$ and $R_{6}$ are much smaller than $R$ so that the current through $R$ is much lower than the current in the voltage divider, with the result that
$\beta \simeq R_{6} \mid\left(R_{5}+R_{6}\right)$. Show that the differential gain is given by

$$
A_{d} \equiv \frac{v_{O}}{v_{I d}}=\frac{1}{1-\beta}
$$

(Hint: Use superposition.)
Design the circuit to obtain a differential gain of $10 \mathrm{~V} / \mathrm{V}$ and differential input resistance of $2 \mathrm{M} \Omega$. Select values for $R, R_{5}$, and $R_{6}$, such that $\left(R_{5}+R_{6}\right) \leq R / 100$.


Figure P2.69
*2.70 Figure P2.70 shows a modified version of the difference amplifier. The modified circuit includes a resistor $R_{G}$, which can be used to vary the gain. Show that the differential voltage gain is given by

$$
\frac{v_{O}}{v_{I d}}=-2 \frac{R_{5}}{R_{1}}\left[1+\frac{R_{5}}{R_{G}}\right]
$$

(Hint: The virtual short circuit at the op-amp input causes the current through the $R_{1}$ resistors to be $v_{I d} / 2 R_{1}$ ).


Figure P2.70

[^0]
[^0]:    $\mathrm{IIM}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; $\mathrm{D}=$ design problem
D *2.71 The circuit shown in Fig. P2.71 is a representation of a versatile, commercially available IC, the INA105, manufactured by Burr-Brown and known as a differential amplifier module. It consists of an op amp and precision, laser-trimmed, metal-film resistors. The circuit can be configured for a variety of applications by the appropriate connection of terminals A, B, C, D, and O.
(a) Show how the circuit can be used to implement a difference amplifier of unity gain.
(b) Show how the circuit can be used to implement single-ended amplifiers with gains:
(i) $-1 \mathrm{~V} / \mathrm{V}$
(ii) $+1 \mathrm{~V} / \mathrm{V}$
(iii) $+2 \mathrm{~V} / \mathrm{V}$
(iv) $+1 / 2 \mathrm{~V} / \mathrm{V}$

Avoid leaving a terminal open-circuited, for such a terminal may act as an "antenna," picking up interference and noise through capacitive coupling. Rather, find a convenient node to connect such a terminal in a redundant way. When more than one circuit implementation is possible, comment on the relative merits of each, taking into account such considerations as dependence on component matching and input resistance.


Figure P2.71
2.72 Consider the instrumentation amplifier of Fig. 2.20(b) with a common-mode input voltage of +3 V (dc) and a differential input signal of $100-\mathrm{mV}$ peak sine wave. Let $2 R_{1}=2 \mathrm{k} \Omega, R_{2}=50 \mathrm{k} \Omega, R_{3}=R_{4}=10 \mathrm{k} \Omega$. Find the voltage at every node in the circuit.
2.73 (a) Consider the instrumentation amplifier circuit of Fig. 2.20(a). If the op amps are ideal except that their outputs saturate at $\pm 12 \mathrm{~V}$, in the manner shown in Fig. 1.14, find the maximum allowed input common-mode signal for the case $R_{1}=1 \mathrm{k} \Omega$ and $R_{2}=100 \mathrm{k} \Omega$.
(b) Repeat (a) for the circuit in Fig. 2.20(b), and comment on the difference between the two circuits.
2.74 (a) Expressing $v_{I 1}$ and $v_{I 2}$ in terms of differential and common-mode components, find $v_{O 1}$ and $v_{O 2}$ in the circuit in Fig. 2.20(a) and hence find their differential component $v_{O 2}-v_{O 1}$ and their common-mode component $\frac{1}{2}\left(v_{O 1}+v_{O 2}\right)$. Now find the differential gain and the common-mode gain of the first stage of this instrumentation amplifier and hence the CMRR.
(b) Repeat for the circuit in Fig. 2.20(b), and comment on the difference between the two circuits.
*2.75 For an instrumentation amplifier of the type shown in Fig. 2.20(b), a designer proposes to make $R_{2}=R_{3}=$ $R_{4}=100 \mathrm{k} \Omega$, and $2 R_{1}=10 \mathrm{k} \Omega$. For ideal components, what difference-mode gain, common-mode gain, and CMRR result? Reevaluate the worst-case values for these for the situation in which all resistors are specified as $\pm 1 \%$ units. Repeat the latter analysis for the case in which $2 R_{1}$ is reduced to $1 \mathrm{k} \Omega$. What do you conclude about the effect of the gain of the first stage on CMRR? (Hint: Eq. (2.19) can be used to evaluate $A_{c m}$ of the second stage.)

D 2.76 Design the instrumentation-amplifier circuit of Fig. 2.20(b) to realize a differential gain, variable in the range 2 to 100 , utilizing a $100-\mathrm{k} \Omega$ pot as variable resistor.

SNE *2.77 The circuit shown in Fig. P2.77 is intended to supply a voltage to floating loads (those for which both terminals are ungrounded) while making greatest possible use of the available power supply.


Figure P2.77

[^0]
[^0]:    SNE = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
(a) Assuming ideal op amps, sketch the voltage waveforms at nodes B and C for a 1-V peak-to-peak sine wave applied at A. Also sketch $v_{o}$.
(b) What is the voltage gain $v_{o} / v_{t}$ ?
(c) Assuming that the op amps operate from $\pm 15-\mathrm{V}$ power supplies and that their output saturates at $\pm 14 \mathrm{~V}$ (in the manner shown in Fig. 1.14), what is the largest sine-wave output that can be accommodated? Specify both its peak-to-peak and rms values.
*2.78 The two circuits in Fig. P2.78 are intended to function as voltage-to-current converters; that is, they supply the load impedance $Z_{L}$ with a current proportional to $v_{t}$ and independent of the value of $Z_{L}$. Show that this is indeed the case, and find for each circuit $i_{o}$ as a function of $v_{t}$. Comment on the differences between the two circuits.

## Section 2.5: Integrators and Differentiators

2.79 A Miller integrator incorporates an ideal op amp, a resistor $R$ of $10 \mathrm{k} \Omega$, and a capacitor $C$ of 1 nF . A sine-wave signal is applied to its input.
(a) At what frequency (in Hz ) are the input and output signals equal in amplitude?
(b) At that frequency, how does the phase of the output sine wave relate to that of the input?
(c) If the frequency is lowered by a factor of 10 from that found in (a), by what factor does the output voltage change, and in what direction (smaller or larger)?
(d) What is the phase relation between the input and output in situation (c)?

D 2.80 Design a Miller integrator with a time constant of 1 s and an input resistance of $100 \mathrm{k} \Omega$. A dc voltage of -1 volt is applied at the input at time 0 , at which moment $v_{o}=-10 \mathrm{~V}$. How long does it take the output to reach 0 V ? +10 V ?
2.81 An op-amp-based inverting integrator is measured at 10 kHz to have a voltage gain of -100 V/V. At what frequency is its gain reduced to $-1 \mathrm{~V} / \mathrm{V}$ ? What is the integrator time constant?

D 2.82 Design a Miller integrator that has a unity-gain frequency of $10 \mathrm{krad} / \mathrm{s}$ and an input resistance of $100 \mathrm{k} \Omega$. Sketch the output you would expect for the situation in which, with output initially at 0 V , a $2-\mathrm{V}, 100-\mu \mathrm{s}$ pulse is applied to the input. Characterize the output that results when a sine wave $2 \sin 10^{\circ} t$ is applied to the input.

D 2.83 Design a Miller integrator whose input resistance is $10 \mathrm{k} \Omega$ and unity-gain frequency is 100 kHz . What components are needed? For long-term stability, a feedback resistor is introduced across the capacitor to limit the dc gain


Figure P2.78

[^0]
[^0]:    $\overline{\text { SIN }}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
to 40 dB . What is its value? What is the associated lower 3-dB frequency? Sketch and label the output that results with a $10-\mu \mathrm{s}, 1-\mathrm{V}$ positive-input pulse (initially at 0 V ) with (a) no dc stabilization (but with the output initially at 0 V ) and (b) the feedback resistor connected.
*2.84 A Miller integrator whose input and output voltages are initially zero and whose time constant is 1 ms is driven by the signal shown in Fig. P2.84. Sketch and label the output waveform that results. Indicate what happens if the input levels are $\pm 2 \mathrm{~V}$, with the time constant the same ( 1 ms ) and with the time constant raised to 2 ms .


Figure P2.84
2.85 Consider a Miller integrator having a time constant of 1 ms and an output that is initially zero, when fed with a string of pulses of $10-\mu \mathrm{s}$ duration and $1-\mathrm{V}$ amplitude rising from 0 V (see Fig. P2.85). Sketch and label the output waveform resulting. How many pulses are required for an output voltage change of 1 V ?


Figure P2.85

D 2.86 Figure P2.86 shows a circuit that performs a low-pass STC function. Such a circuit is known as a first-order,
low-pass active filter. Derive the transfer function and show that the dc gain is $\left(-R_{2} / R_{1}\right)$ and the 3-dB frequency $\omega_{0}=1 / C R_{2}$. Design the circuit to obtain an input resistance of $10 \mathrm{k} \Omega$, a dc gain of 40 dB , and a $3-\mathrm{dB}$ frequency of 1 kHz . At what frequency does the magnitude of the transfer function reduce to unity?


Figure P2.86
*2.87 Show that a Miller integrator implemented with an op amp with open-loop gain $A_{0}$ has a low-pass STC transfer function. What is the pole frequency of the STC function? How does this compare with the pole frequency of the ideal integrator? If an ideal Miller integrator is fed with a $-1-\mathrm{V}$ pulse signal with a width $T=C R$, what will the output voltage be at $t=T$ ? Assume that at $t=0, v_{o}=0$. Repeat for an integrator with an op amp having $A_{0}=1000$.
2.88 A differentiator utilizes an ideal op amp, a $10-\mathrm{k} \Omega$ resistor, and a 1-nF capacitor. What is the frequency $f_{0}$ (in Hz ) at which its input and output sine-wave signals have equal magnitude? What is the output signal for a 1-V peak-to-peak sine-wave input with frequency equal to $10 f_{0}$ ?
2.89 An op-amp differentiator with 1-ms time constant is driven by the rate-controlled step shown in Fig. P2.89. Assuming $v_{o}$ to be zero initially, sketch and label its waveform.


Figure P2.89

[^0]
[^0]:    2.88 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
2.90 An op-amp differentiator, employing the circuit shown in Fig. 2.27(a), has $R=20 \mathrm{k} \Omega$ and $C=0.1 \mu \mathrm{~F}$. When a triangle wave of $\pm 1-\mathrm{V}$ peak amplitude at 1 kHz is applied to the input, what form of output results? What is its frequency? What is its peak amplitude? What is its average value? What value of $R$ is needed to cause the output to have a $12-\mathrm{V}$ peak amplitude?
2.91 Use an ideal op amp to design a differentiation circuit for which the time constant is $10^{-3} \mathrm{~s}$ using a $10-\mathrm{nF}$ capacitor. What are the gains and phase shifts found for this circuit at one-tenth and 10 times the unity-gain frequency? A series input resistor is added to limit the gain magnitude at high frequencies to $100 \mathrm{~V} / \mathrm{V}$. What is the associated $3-\mathrm{dB}$ frequency? What gain and phase shift result at 10 times the unity-gain frequency?

D 2.92 Figure P2.92 shows a circuit that performs the high-pass, single-time-constant function. Such a circuit is known as a first-order high-pass active filter. Derive the transfer function and show that the high-frequency gain is $\left(-R_{2} / R_{1}\right)$ and the $3-\mathrm{dB}$ frequency $\omega_{0}=1 / C R_{1}$. Design the circuit to obtain a high-frequency input resistance of $1 \mathrm{k} \Omega$, a high-frequency gain of 40 dB , and a $3-\mathrm{dB}$ frequency of 2 kHz . At what frequency does the magnitude of the transfer function reduce to unity?


Figure P2.92

D **2.93 Derive the transfer function of the circuit in Fig. P2.93 (for an ideal op amp) and show that it can be written in the form

$$
\frac{V_{o}}{V_{i}}=\frac{-R_{2} / R_{1}}{\left[1+\left(\omega_{1} / j \omega\right)\right]\left[1+j\left(\omega / \omega_{2}\right)\right]}
$$

where $\omega_{1}=1 / C_{1} R_{1}$ and $\omega_{2}=1 / C_{2} R_{2}$. Assuming that the circuit is designed such that $\omega_{2} \gg \omega_{1}$, find approximate expressions
for the transfer function in the following frequency regions:
(a) $\omega \ll \omega_{1}$
(b) $\omega_{1} \ll \omega \ll \omega_{2}$
(c) $\omega \gg \omega_{2}$


Figure P2.93

Use these approximations to sketch a Bode plot for the magnitude response. Observe that the circuit performs as an amplifier whose gain rolls off at the low-frequency end in the manner of a high-pass STC network, and at the high-frequency end in the manner of a low-pass STC network. Design the circuit to provide a gain of 40 dB in the "middle-frequency range," a low-frequency 3-dB point at 200 Hz , a high-frequency $3-\mathrm{dB}$ point at 200 kHz , and an input resistance (at $\omega \gg \omega_{1}$ ) of $2 \mathrm{k} \Omega$.

## Section 2.6: DC Imperfections

2.94 An op amp wired in the inverting configuration with the input grounded, having $R_{2}=100 \mathrm{k} \Omega$ and $R_{1}=2 \mathrm{k} \Omega$, has an output dc voltage of -0.2 V . If the input bias current is known to be very small, find the input offset voltage.
2.95 A noninverting amplifier with a gain of 100 uses an op amp having an input offset voltage of $\pm 2 \mathrm{mV}$. Find the output when the input is $0.01 \sin \omega t$, volts.
2.96 A noninverting amplifier with a closed-loop gain of 1000 is designed using an op amp having an input offset voltage of 3 mV and output saturation levels of $\pm 12 \mathrm{~V}$. What is the maximum amplitude of the sine wave that can be applied at the input without the output clipping? If the amplifier is

[^0]
[^0]:    2.90 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
capacitively coupled in the manner indicated in Fig. 2.36, what would the maximum possible amplitude be?
2.97 An op amp connected in a closed-loop inverting configuration having a gain of $1000 \mathrm{~V} / \mathrm{V}$ and using relatively small-valued resistors is measured with input grounded to have a dc output voltage of -1.8 V . What is its input offset voltage? Prepare an offset-voltage-source sketch resembling that in Fig. 2.28. Be careful of polarities.
2.98 A particular inverting amplifier with nominal gain of $-100 \mathrm{~V} / \mathrm{V}$ uses an imperfect op amp in conjunction with $100-\mathrm{k} \Omega$ and $10-\mathrm{M} \Omega$ resistors. The output voltage is found to be +5.3 V when measured with the input open and +5 V with the input grounded.
(a) What is the bias current of this amplifier? In what direction does it flow?
(b) Estimate the value of the input offset voltage.
(c) A $10-\mathrm{M} \Omega$ resistor is connected between the positive-input terminal and ground. With the input left floating (disconnected), the output dc voltage is measured to be -0.6 V . Estimate the input offset current.
D *2.99 A noninverting amplifier with a gain of $+10 \mathrm{~V} / \mathrm{V}$ using $100 \mathrm{k} \Omega$ as the feedback resistor operates from a $5-\mathrm{k} \Omega$ source. For an amplifier offset voltage of 0 mV , but with a bias current of $2 \mu \mathrm{~A}$ and an offset current of $0.2 \mu \mathrm{~A}$, what range of outputs would you expect? Indicate where you would add an additional resistor to compensate for the bias currents. What does the range of possible outputs then become? A designer wishes to use this amplifier with a $15-\mathrm{k} \Omega$ source. In order to compensate for the bias current in this case, what resistor would you use? And where?

D 2.100 The circuit of Fig. 2.36 is used to create an ac-coupled noninverting amplifier with a gain of $100 \mathrm{~V} / \mathrm{V}$ using resistors no larger than $100 \mathrm{k} \Omega$. What values of $R_{1}, R_{2}$, and $R_{3}$ should be used? For a break frequency due to $C_{1}$ at 100 Hz , and that due to $C_{2}$ at 10 Hz , what values of $C_{1}$ and $C_{2}$ are needed?
*2.101 Consider the difference amplifier circuit in Fig. 2.16. Let $R_{1}=R_{3}=10 \mathrm{k} \Omega$ and $R_{2}=R_{4}=1 \mathrm{M} \Omega$. If the op amp has $V_{\mathrm{ret}}=5 \mathrm{mV}, I_{B}=1 \mu \mathrm{~A}$, and $I_{\mathrm{Ltt}}=0.2 \mu \mathrm{~A}$, find the worst-case (largest) dc offset voltage at the output.
*2.102 The circuit shown in Fig. P2.102 uses an op amp having a $\pm 3-\mathrm{mV}$ offset. What is its output offset voltage? What does the output offset become with the input ac coupled
through a capacitor $C$ ? If, instead, a large capacitor is placed in series with a $1-\mathrm{k} \Omega$ resistor, what does the output offset become?


Figure P2.102
2.103 Using offset-nulling facilities provided for the op amp, a closed-loop amplifier with gain of +1000 is adjusted at $25^{\circ} \mathrm{C}$ to produce zero output with the input grounded. If the input offset-voltage drift is specified to be $20 \mu \mathrm{~V} /{ }^{\circ} \mathrm{C}$, what output would you expect at $0^{\circ} \mathrm{C}$ and at $100^{\circ} \mathrm{C}$ ? While nothing can be said separately about the polarity of the output offset at either 0 or $75^{\circ} \mathrm{C}$, what would you expect their relative polarities to be?
2.104 An op amp is connected in a closed loop with gain of +100 utilizing a feedback resistor of $1 \mathrm{M} \Omega$.
(a) If the input bias current is 200 nA , what output voltage results with the input grounded?
(b) If the input offset voltage is $\pm 2 \mathrm{mV}$ and the input bias current as in (a), what is the largest possible output that can be observed with the input grounded?
(c) If bias-current compensation is used, what is the value of the required resistor? If the offset current is no more than one-tenth the bias current, what is the resulting output offset voltage (due to offset current alone)?
(d) With bias-current compensation as in (c) in place, what is the largest dc voltage at the output due to the combined effect of offset voltage and offset current?
*2.105 An op amp intended for operation with a closed-loop gain of $-100 \mathrm{~V} / \mathrm{V}$ uses resistors of $10 \mathrm{k} \Omega$ and $1 \mathrm{M} \Omega$ with a bias-current-compensation resistor $R_{3}$. What should the value of $R_{3}$ be? With input grounded, the output offset voltage is found to be +0.30 V . Estimate the input offset current assuming zero input offset voltage. If the input offset voltage

[^0]
[^0]:    $\mathrm{SH} \mathrm{=Multisim/PSpice;*}=$ difficult problem; ${ }^{* *}=$ more difficult; ${ }^{* * *}=$ very challenging; $\mathrm{D}=$ design problem

Figure B. 20 Dependence of $\beta_{\mathrm{dc}}$ on $I_{C}$ (at $V_{C E}=2 \mathrm{~V}$ ) in the Q2N3904 discrete BJT (Example PS.6.1).

# Example PS.7.2 

## The CE Amplifier with Emitter Resistance

In this example, we use PSpice to analyze and verify the design of the CE amplifier. A schematic capture of the CE amplifier is shown in Fig. B.21. We will use part Q2N3904 for the BJT and a $\pm 5-\mathrm{V}$ power supply. We will also assume a signal source resistor $R_{\text {sig }}=10 \mathrm{k} \Omega$, a load resistor $R_{L}=10 \mathrm{k} \Omega$, and bypass and coupling capacitors of $10 \mu \mathrm{~F}$. To enable us to investigate the effect of including a resistance in the signal path of the emitter, a resistor $R_{e r}$ is connected in series with the emitter bypass capacitor $C_{E}$. Note that the roles of $R_{E}$ and $R_{e r}$ are different. Resistor $R_{E}$ is the dc emitter-degeneration resistor because it appears in the dc path between the emitter and ground. It is therefore used to help stabilize the bias point for the amplifier. The equivalent resistance $R_{e}=R_{E} \| R_{e r}$ is the small-signal emitter-degeneration resistance because it appears in the ac (small-signal) path between the emitter and ground and helps stabilize the gain of the amplifier. In this example, we will investigate the effects of both $R_{E}$ and $R_{e}$ on the performance of the CE amplifier. However, as should always be the case with computer simulation, we will begin with an approximate pencil-and-paper design. In this way, maximum advantage and insight can be obtained from simulation.

Based on the plot of $\beta_{\mathrm{dc}}$ versus $I_{C}$ in Fig. B.20, a collector bias current $I_{C}$ of 0.5 mA is selected for the BJT, resulting in $\beta_{\mathrm{dc}}=123$. This choice of $I_{C}$ is a reasonable compromise between power dissipation and current gain. Furthermore, a collector bias voltage $V_{C}$ of 0 V (i.e., at the mid-supply rail) is selected to


Figure B. 21 Schematic capture of the CE amplifier in Example PS.7.2.
achieve a high signal swing at the amplifier output. For $V_{C E}=2 \mathrm{~V}$, the result is that $V_{E}=-2 \mathrm{~V}$ requires bias resistors with values

$$
R_{C}=\frac{V_{C C}-V_{C}}{I_{C}}=10 \mathrm{k} \Omega
$$

and

$$
R_{E}=\frac{V_{E}-V_{E E}}{I_{C}}=6 \mathrm{k} \Omega
$$

Assuming $V_{B E}=0.7 \mathrm{~V}$ and using $\beta_{\mathrm{dc}}=123$, we can determine

$$
R_{B}=-\frac{V_{B}}{I_{B}}=-\frac{0-\left(V_{B E}+V_{E}\right)}{I_{C} / \beta_{\mathrm{dc}}}=320 \mathrm{k} \Omega
$$

Next, the formulas of Section 7.3.4 can be used to determine the input resistance $R_{\text {in }}$ and the midband voltage gain $\left|A_{M}\right|$ of the CE amplifier:

$$
\begin{gathered}
R_{\text {in }}=R_{B} \|\left(\beta_{\text {ac }}+1\right) \|\left(r_{e}+R_{e}\right) \\
\left|A_{M}\right|=\left|-\frac{R_{\text {in }}}{R_{\text {sig }}+R_{\text {in }}} \times \frac{R_{C}\left\|R_{L}\right|}{r_{e}+R_{e}}\right|
\end{gathered}
$$

For simplicity, we will assume $\beta_{\text {ac }} \simeq \beta_{\mathrm{dc}}=123$, resulting in

$$
r_{e}=\left(\frac{\beta_{\text {ac }}}{\beta_{\text {ac }}+1}\right)\left(\frac{V_{T}}{I_{C}}\right)=49.6 \Omega
$$

Thus, with no small-signal emitter degeneration (i.e., $R_{c e}=0$ ), $R_{\text {in }}=6.1 \mathrm{k} \Omega$ and $\left|A_{M}\right|=38.2 \mathrm{~V} / \mathrm{V}$. Using Eq. (B.22) and assuming $R_{B}$ is large enough to have a negligible effect on $R_{\text {in }}$, it can be shown that
the emitter-degeneration resistor $R_{e}$ decreases the voltage gain $\left|A_{M}\right|$ by a factor of

$$
\frac{1+\frac{R_{e}}{r_{e}}+\frac{R_{u g}}{r_{a}}}{1+\frac{R_{u g}}{r_{a}}}
$$

Therefore, to limit the reduction in voltage gain to a factor of 2 , we will select

$$
R_{e}=r_{e}+\frac{R_{u g}}{\beta_{m}+1}
$$

Thus, $R_{c e} \simeq R_{e}=130 \Omega$. Substituting this value in Eqs. (B.21) and (B.22) shows that $R_{m}$ increases from $6.1 \mathrm{k} \Omega$ to $20.9 \mathrm{k} \Omega$ while $\left|A_{M}\right|$ drops from $38.2 \mathrm{~V} / \mathrm{V}$ to $18.8 \mathrm{~V} / \mathrm{V}$.

We will now use PSpice to verify our design and investigate the performance of the CE amplifier. We begin by performing a bias-point simulation to verify that the BJT is properly biased in the active region and that the dc voltages and currents are within the desired specifications. Based on this simulation, we have increased the value of $R_{B}$ to $340 \mathrm{k} \Omega$ in order to limit $I_{C}$ to about 0.5 mA while using a standard $1 \%$ resistor value (Appendix H). Next, to measure the midband gain $A_{M}$ and the 3-dB frequencies ${ }^{9} f_{L}$ and $f_{H}$, we apply a $1-\mathrm{V}$ ac voltage at the input, perform an ac-analysis simulation, and plot the output-voltage magnitude (in dB) versus frequency as shown in Fig. B.22. This corresponds to the magnitude response of the CE amplifier because we chose a $1-\mathrm{V}$ input signal. ${ }^{10}$ Accordingly, with no emitter degeneration, the midband gain is $\left|A_{M}\right|=38.5 \mathrm{~V} / \mathrm{V}=31.7 \mathrm{~dB}$ and the 3-dB bandwidth is $B W=f_{H}-f_{L}=145.7 \mathrm{kHz}$. Using an $R_{c e}$ of $130 \Omega$ results in a drop in the midband gain $\left|A_{M}\right|$ by a factor of 2 (i.e., 6 dB ). Interestingly, however, $B W$ has now increased by approximately the same factor as the drop in $\left|A_{M}\right|$. As we learned in Chapter 10 in our study of negative feedback, the emitter-degeneration resistor $R_{c e}$ provides negative feedback, which allows us to trade off gain for other desirable properties, such as a larger input resistance and a wider bandwidth.

To conclude this example, we will demonstrate the improved bias-point (or dc operating-point) stability achieved when an emitter resistor $R_{E}$ is used (see the discussion in Section 7.4.2). Specifically, we will increase/decrease the value of the parameter BF (i.e., the ideal maximum forward current gain) in the SPICE model for part Q2N3904 by a factor of 2 and perform a bias-point simulation. The corresponding change in BJT parameters ( $\beta_{d c}$ and $\beta_{m}$ ) and bias-point (including $I_{C}$ and $C E$ ) are presented in Table B. 7 for the case of $R_{E}=6 \mathrm{k} \Omega$. Note that $\beta_{m}$ is not equal to $\beta_{d c}$ as we assumed, but is slightly larger. For the case without emitter degeneration, we will use $R_{E}=0$ in the schematic of Fig. B.21. Furthermore, to maintain the same $I_{C}$ and $V_{C}$ in both cases at the values obtained for nominal BF , we use $R_{B}=1.12 \mathrm{M} \Omega$ to limit $I_{C}$ to approximately 0.5 mA . The corresponding variations in the BJT bias point are also shown in Table B.7. Accordingly, we see that emitter degeneration makes the bias point of the CE amplifier much less sensitive to changes in $\beta$. However, unless a large bypass capacitor $C_{E}$ is used, this reduced bias sensitivity comes at the expense of a reduction in the midband gain (as we observed in this example when we simulated the frequency response of the CE amplifier with an $R_{e}=130 \Omega$ ).

[^0]
[^0]:    ${ }^{9}$ No detailed knowledge of frequency-response calculations is required for this example; all that is needed is Section 7.4.2. Nevertheless, after the study of the frequency of the CE amplifier in Sections 10.1 through 10.3, the reader will benefit by returning to this example to experiment further with the circuit using PSpice.
    ${ }^{10}$ The reader should not be alarmed about the use of such a large signal amplitude. Recall that in a small-signal (ac) simulation, SPICE first finds the small-signal equivalent circuit at the dc bias point and then analyzes this linear circuit. Such ac analysis can, of course, be done with any ac signal amplitude. However, a $1-\mathrm{V}$ ac input is convenient to use because the resulting ac output corresponds to the voltage gain of the circuit.


Figure B. 22 Frequency response of the CE amplifier in Example PS.7.3 with $R_{c e}=0$ and $R_{c e}=130 \Omega$.

Table B. 7 Variations in the Bias Point of the CE Amplifier with the SPICE Model-Parameter BF of BJT

|  | $R_{E}=6 \mathrm{k}$ |  |  | $R_{E}=0$ |  |  |  |
| :-- | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| BF (in SPICE) | $\beta_{\mathrm{dc}}$ | $\beta_{\mathrm{dc}}$ | $I_{C}(\mathrm{~mA})$ | $V_{C}(\mathrm{~V})$ | $\beta_{\mathrm{dc}}$ | $\beta_{\mathrm{dc}}$ | $I_{C}(\mathrm{~mA})$ | $V_{C}(\mathrm{~V})$ |
|  |  |  |  |  |  |  |  |  |
| 208 | 106 | 94.9 | 0.452 | 0.484 | 109 | 96.9 | 0.377 | 1.227 |
| 416.4 (nominal value) | 143 | 123 | 0.494 | 0.062 | 148 | 127 | 0.494 | 0.060 |
| 832 | 173 | 144 | 0.518 | -0.183 | 181 | 151 | 0.588 | -0.878 |

# Example PS.8.1 

## The CMOS CS Amplifier

In this example, we will use PSpice to compute the dc transfer characteristic of the CS amplifier whose capture schematic is shown in Fig. B.23. We will assume a $5-\mu \mathrm{m}$ CMOS technology for the MOSFETs and use parts NMOS5P0 and PMOS5P0 whose SPICE level-1 parameters are listed in Table B.3. To specify the dimensions of the MOSFETs in PSpice, we will use the multiplicative factor $m$ together with the channel length $L$ and the channel width $W$. The MOSFET parameter $m$, whose default value is 1 , is used in SPICE to specify the number of MOSFETs connected in parallel. As depicted in Fig. B.24, a wide transistor with channel length $L$ and channel width $m \times W$ can be implemented using $m$ narrower transistors


Figure B. 23 Schematic capture of the CS amplifier in Example PS.8.1.


Figure B. 24 Transistor equivalency.
in parallel, each having a channel length $L$ and a channel width $W$. Thus, neglecting the channel-length modulation effect, the drain current of a MOSFET operating in the saturation region can be expressed as

$$
I_{D}=\frac{1}{2} \mu C_{s s} m \frac{W}{L_{\text {eff }}} V_{O V}^{2}
$$

where $L_{\text {eff }}$ rather than $L$ is used to more accurately estimate the drain current.
The CS amplifier in Fig. B. 23 is designed for a bias current of $100 \mu \mathrm{~A}$ assuming a reference current $I_{\text {ref }}=100 \mu \mathrm{~A}$ and $V_{D D}=10 \mathrm{~V}$. The current mirror transistors $M_{2}$ and $M_{3}$ are sized for $V_{O V 2}=V_{O V 3}=1 \mathrm{~V}$,
Example PS.8.1 continued
while the input transistor $M_{1}$ is sized for $V_{O V 1}=0.5 \mathrm{~V}$. Note that a smaller overdrive voltage is selected for $M_{1}$ to achieve a larger voltage gain $G_{v}$ for the CS amplifier, since

$$
G_{v}=-g_{m 1} R_{L}^{\prime}=-g_{m 1}\left(r_{e 1} \| r_{e 2}\right)=-\frac{2}{V_{O V 1}}\left(\frac{V_{A n} V_{A p}}{V_{A n}+V_{A p}}\right)
$$

where $V_{A n}$ and $V_{A p}$ are the magnitudes of the Early voltages of, respectively, the NMOS and PMOS transistors. Unit-size transistors are used with $W / L=12.5 \mu \mathrm{~m} / 6 \mu \mathrm{~m}$ for the NMOS devices and $W / L=37.5$ $\mu \mathrm{m} / 6 \mu \mathrm{~m}$ for the PMOS devices. Thus, using Eq. (B.24) together with the $5-\mu \mathrm{m}$ CMOS process parameters in Table B.4, we find $m_{1}=10$ and $m_{2}=m_{3}=2$ (rounded to the nearest integer). Furthermore, Eq. (B.25) gives $G_{v}=-100 \mathrm{~V} / \mathrm{V}$.

To compute the dc transfer characteristic of the CS amplifier, we perform a dc analysis in PSpice with $V_{\text {IN }}$ swept over the range 0 to $V_{D D}$ and plot the corresponding output voltage $V_{\text {OUT }}$. Figure B.25(a) shows the resulting transfer characteristic. The slope of this characteristic (i.e., $d V_{\text {OUT }} / d V_{\text {IN }}$ ) corresponds to the gain of the amplifier. The high-gain segment is clearly visible for $V_{\text {IN }}$ around 1.5 V . This corresponds to an overdrive voltage for $M_{1}$ of $V_{O V 1}=V_{\mathrm{IN}}-V_{m}=0.5 \mathrm{~V}$, as desired. To examine the high-gain region more closely, we repeat the dc sweep for $V_{\text {IN }}$ between 1.3 V and 1.7 V . The resulting transfer characteristic is plotted in Fig. B. 25 (b, middle curve). Using the Probe graphical interface of PSpice, we find that the linear region of this dc transfer characteristic is bounded approximately by $V_{\mathrm{IN}}=1.465 \mathrm{~V}$ and $V_{\mathrm{IN}}=1.539 \mathrm{~V}$. The corresponding values of $V_{\text {OUT }}$ are 8.838 V and 0.573 V . These results are close to the expected values. Specifically, transistors $M_{1}$ and $M_{2}$ will remain in the saturation region and, hence, the amplifier will operate in its linear region if $V_{O V 1} \leq V_{\text {OUT }} \leq V_{D D}-V_{O V 2}$ or $0.5 \mathrm{~V} \leq V_{\text {OUT }} \leq 9 \mathrm{~V}$. From the results above, the voltage gain $G_{v}$ (i.e., the slope of the linear segment of the dc transfer characteristic) is approximately $-112 \mathrm{~V} / \mathrm{V}$, which is reasonably close to the value obtained by hand analysis.


Figure B. 25 (a) Voltage transfer characteristic of the CS amplifier in Example PS.8.1. (b) Expanded view of the transfer characteristic in the high-gain region. Also shown are the transfer characteristics where process variations cause the width of transistor $M_{1}$ to change by $+15 \%$ and $-15 \%$ from its nominal value of $W_{1}=12.5 \mu \mathrm{~m}$.


Figure B. 25 continued
Note from the dc transfer characteristic in Fig. B.25(b) that for an input dc bias of $V_{\text {IN }}=1.5 \mathrm{~V}$, the output dc bias is $V_{\text {OUT }}=4.88 \mathrm{~V}$. This choice of $V_{\text {IN }}$ maximizes the available signal swing at the output by setting $V_{\text {OUT }}$ at the middle of the linear segment of the dc transfer characteristic. However, because of the high resistance at the output node (or, equivalently, because of the high voltage gain), this value of $V_{\text {OUT }}$ is highly sensitive to the effect of process and temperature variations on the characteristics of the transistors. To illustrate this point, consider what happens when the width of $M_{1}$ (i.e., $W_{1}$, which is normally $12.5 \mu \mathrm{~m}$ ) changes by $\pm 15 \%$. The corresponding dc transfer characteristics are shown in Fig. B.25(b). Accordingly, when $V_{\text {IN }}=1.5 \mathrm{~V}, V_{\text {OUT }}$ will drop to 0.84 V if $W_{1}$ increases by $15 \%$ and will rise to 9.0 V if $W_{1}$ decreases by $15 \%$. In practical circuit implementations, this problem is circumvented by using negative feedback to accurately set the dc bias voltage at the output of the amplifier and, hence, to reduce the sensitivity of the circuit to process variations. We studied negative feedback in Chapter 11.

# Example PS.9.1 

## A Multistage Differential BJT Amplifier

The schematic capture of the multistage op-amp circuit analyzed in Examples 8.1 and 8.7 is shown in Fig. B.26. ${ }^{11}$ Observe the manner in which the differential signal input $V_{d}$ and the common-mode input voltage $V_{C M}$ are applied. Such an input bias configuration for an op-amp circuit was presented and used

[^0]
[^0]:    ${ }^{11}$ This circuit cannot be simulated using the student evaluation version of PSpice that is included on the website accompanying this book. This is because, in this free version of PSpice, circuit simulation is restricted to circuits with no more than 10 transistors.
# Example PS.9.1 continued 

in Example PS.2.2. In the following simulations, we will use parts Q2N3904 and Q2N3906 (from Fairchild Semiconductor) for the $n p n$ and $p n p$ BJTs, respectively. The model parameters of these discrete BJTs are listed in Table B. 8 and are available in PSpice.

Table B. 8 Spice Model Parameters of the Q2N3904 and Q2N3906 Discrete BJTs

| Q2N3904 Discrete BJT |  |  |  |  |  |  |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| $\mathrm{IS}=6.734 \mathrm{f}$ | $\mathrm{XTI}=3$ | $\mathrm{EG}=1.11$ | $\mathrm{VAF}=74.03$ | $\mathrm{BF}=416.4$ | $\mathrm{NE}=1.259$ | ISE $=6.734 \mathrm{f}$ |
| $\mathrm{IKF}=66.78 \mathrm{~m}$ | $\mathrm{XTB}=1.5$ | $\mathrm{BR}=.7371$ | $\mathrm{NC}=2$ | $\mathrm{ISC}=0$ | IKR $=0$ | $\mathrm{RC}=1$ |
| CJC $=3.638 \mathrm{p}$ | MJC $=.3085$ | $\mathrm{VJC}=.75$ | $\mathrm{FC}=.5$ | CJE $=4.493 \mathrm{p}$ | MJE $=.2593$ | $\mathrm{VJE}=.75$ |
| $\mathrm{TR}=239.5 \mathrm{n}$ | $\mathrm{TF}=301.2 \mathrm{p}$ | ITF $=.4$ | $\mathrm{VTF}=4$ | $\mathrm{XTF}=2$ | $\mathrm{RB}=10$ |  |
| Q2N3906 Discrete BJT |  |  |  |  |  |  |
| $\mathrm{IS}=1.41 \mathrm{f}$ | $\mathrm{XTI}=3$ | $\mathrm{EG}=1.11$ | $\mathrm{VAF}=18.7$ | $\mathrm{BF}=180.7$ | $\mathrm{NE}=1.5$ | ISE $=0$ |
| $\mathrm{IKF}=80 \mathrm{~m}$ | $\mathrm{XTB}=1.5$ | $\mathrm{BR}=4.977$ | $\mathrm{NC}=2$ | $\mathrm{ISC}=0$ | IKR $=0$ | $\mathrm{RC}=2.5$ |
| CJC $=9.728 \mathrm{p}$ | MJC $=.5776$ | $\mathrm{VJC}=.75$ | $\mathrm{FC}=.5$ | CJE $=8.063 \mathrm{p}$ | MJE $=.3677$ | $\mathrm{VJE}=.75$ |
| $\mathrm{TR}=33.42 \mathrm{n}$ | $\mathrm{TF}=179.3 \mathrm{p}$ | ITF $=.4$ | $\mathrm{VTF}=4$ | $\mathrm{XTF}=6$ | $\mathrm{RB}=10$ |  |

Table B. 9 DC Collector Currents of the Op-Amp Circuit in Fig. B. 26 as Computed by Hand Analysis (Example 8.6) and by PSpice

| Transistor | Collector Currents (mA) |  |  |
| :-- | :--: | :--: | :--: |
|  | Hand Analysis (Example 8.6) | PSpice | Error (\%) |
| $Q_{1}$ | 0.25 | 0.281 | -11.0 |
| $Q_{2}$ | 0.25 | 0.281 | -11.0 |
| $Q_{3}$ | 0.5 | 0.567 | -11.8 |
| $Q_{4}$ | 1.0 | 1.27 | -21.3 |
| $Q_{5}$ | 1.0 | 1.21 | -17.4 |
| $Q_{6}$ | 2.0 | 2.50 | -20.0 |
| $Q_{7}$ | 1.0 | 1.27 | -21.3 |
| $Q_{8}$ | 5.0 | 6.17 | -18.9 |
| $Q_{9}$ | 0.5 | 0.48 | +4.2 |

In PSpice, the common-mode input voltage $V_{C M}$ of the op-amp circuit is set to 0 V (i.e., to the average of the dc power-supply voltages $V_{C C}$ and $V_{E E}$ ) to maximize the available input signal swing. A bias-point simulation is performed to determine the dc operating point. Table B. 9 summarizes the value of the dc collector currents as computed by PSpice and as calculated by the hand analysis in Example 8.6. Recall that our hand analysis assumed both $\beta$ and the Early voltage $V_{A}$ of the BJTs to be infinite. However, our SPICE simulations in Example PS.6.1 (where we investigated the dependence of $\beta$ on the collector current $I_{C}$ ) indicate that the Q2N3904 has $\beta \simeq 125$ at $I_{C}=0.25 \mathrm{~mA}$. Furthermore, its forward Early voltage (SPICE parameter VAF) is 74 V , as given in Table B.8. Nevertheless, we observe from Table B. 9 that the largest error in the calculation of the dc bias currents is on the order of $20 \%$. Accordingly, we can conclude that a quick hand analysis using gross approximations can still yield reasonable results for a preliminary estimate and, of course, hand analysis yields much insight into the circuit operation. In addition to the dc bias currents listed in Table B.9, the bias-point simulation in PSpice shows that the output dc offset (i.e., $V_{\text {OUT }}$ when $V_{d}=0$ ) is 3.62 V and that the input bias current $I_{B 1}$ is $2.88 \mu \mathrm{~A}$.


Figure B. 26 Schematic capture of the op-amp circuit in Example 7.6.

To compute the large-signal differential transfer characteristic of the op-amp circuit, we perform a dc-analysis simulation in PSpice with the differential voltage input $V_{d}$ swept over the range $-V_{E E}$ to $+V_{C C}$, and we plot the corresponding output voltage $V_{\text {OUT }}$. Figure B.27(a) shows the resulting dc transfer characteristic. The slope of this characteristic (i.e., $d V_{\text {OUT }} / d V_{d}$ ) corresponds to the differential gain of the amplifier. Note that, as expected, the high-gain region is in the vicinity of $V_{d}=0 \mathrm{~V}$. However, the resolution of the input-voltage axis is too coarse to yield much information about the details of the high-gain region. Therefore, to examine this region more closely, the dc analysis is repeated with $V_{d}$ swept over the range -5 mV to +5 mV at increments of $10 \mu \mathrm{~V}$. The resulting differential dc transfer characteristic is plotted in Fig. B.27(b). We observe that the linear region of the large-signal differential characteristic is bounded approximately by $V_{d}=-1.5 \mathrm{mV}$ and $V_{d}=+0.5 \mathrm{mV}$. Over this region, the output level changes from $V_{\text {OUT }}=-15 \mathrm{~V}$ to about $\mathrm{V}_{\text {OUT }}=+10 \mathrm{~V}$ in a linear fashion. Thus, the output voltage swing for this amplifier is between -15 V and +10 V , a rather asymmetrical range. A rough estimate for the differential gain of this amplifier can be obtained from the boundaries of the linear region as $A_{d}=[10-(-15)] \mathrm{V} /[0.5-(-1.5)] \mathrm{mV}=12.5 \times 10^{3} \mathrm{~V} / \mathrm{V}$. We also observe from Fig B.27(b) that $V_{d} \simeq-260 \mu \mathrm{~V}$ when $V_{\text {OUT }}=0$. Therefore, the amplifier has an input offset voltage $V_{O S}$ of $+260 \mu \mathrm{~V}$ (by convention, the negative value of the $x$-axis intercept of the large-signal differential transfer characteristic). This corresponds to an output offset voltage of $A_{d} V_{O S} \simeq\left(12.5 \times 10^{3}\right)(260 \mu \mathrm{~V})=3.25 \mathrm{~V}$, which is


Figure B. 27 (a) The large-signal differential transfer characteristic of the op-amp circuit in Fig. B.26. The common-mode input voltage $V_{C M}$ is set to 0 V . (b) An expanded view of the transfer characteristic in the high-gain region.close to the value found through the bias-point simulation. It should be emphasized that this offset voltage is inherent in the design and is not the result of component or device mismatches. Thus, it is usually referred to as a systematic offset.

Next, to compute the frequency response of the op-amp circuit ${ }^{12}$ and to measure its differential gain $A_{d}$ and its $3-\mathrm{dB}$ frequency $f_{H}$ in PSpice, we set the differential input voltage $V_{d}$ to be a $1-\mathrm{V}$ ac signal (with $0-\mathrm{V}$ dc level), perform an ac-analysis simulation, and plot the output voltage magnitude $\left|V_{O U T}\right|$ versus frequency. Figure B.28(a) shows the resulting frequency response. Accordingly, $A_{d}=13.96 \times 10^{7} \mathrm{~V} / \mathrm{V}$ or 82.8 dB , and $f_{H}=256.9 \mathrm{kHz}$. Thus, this value of $A_{d}$ is close to the value estimated using the large-signal differential transfer characteristic.

An approximate value of $f_{H}$ can also be obtained using the expressions derived in Section 10.7. Specifically,

$$
f_{H} \simeq \frac{1}{2 \pi R_{\mathrm{eq}} C_{\mathrm{eq}}}
$$

where

$$
C_{\mathrm{eq}}=C_{\mu 2}+C_{\pi 5}+C_{\mu 5}\left[1+g_{m 5}\left(R_{3} \| r_{o 5} \|\left(r_{\pi 7}+(\beta+1) R_{4}\right)\right)\right]
$$

and

$$
R_{\mathrm{eq}}=R_{2}\left|r_{o 2}\right| r_{\pi 5}
$$

The values of the small-signal parameters as computed by PSpice can be found in the output file of a bias-point (or an ac-analysis) simulation. Using these values results in $C_{\mathrm{eq}}=338 \mathrm{pF}, R_{\mathrm{eq}}=2.91 \mathrm{k} \Omega$, and $f_{H}=161.7 \mathrm{kHz}$. However, this approximate value of $f_{H}$ is much smaller than the value computed by PSpice. The reason for this disagreement is that the foregoing expression for $f_{H}$ was derived (in Section 10.7) using the equivalent differential half-circuit concept. However, the concept is accurate only when it is applied to a symmetrical circuit. The op-amp circuit in Fig. B. 26 is not symmetrical because the second gain stage formed by the differential pair $Q_{4}-Q_{5}$ has a load resistor $R_{3}$ in the collector of $Q_{5}$ only. To verify that the expression for $f_{H}$ in Eq. (B.26) gives a close approximation for $f_{H}$ in the case of a symmetric circuit, we insert a resistor $R_{3}$ (whose size is equal to $R_{3}$ ) in the collector of $Q_{4}$. Note that this will have only a minor effect on the dc operating point. The op-amp circuit with $Q_{4}$ having a collector resistor $R_{3}^{\prime}$ is then simulated in PSpice. Figure B.28(b) shows the resulting frequency response of this symmetric op amp, where $f_{H}=155.7 \mathrm{kHz}$. Accordingly, in the case of a perfectly symmetric op-amp circuit, the value of $f_{H}$ in Eq. (B.26) closely approximates the value computed by PSpice. Comparing the frequency responses of the nonsymmetric (Fig. B.28a) and the symmetric (Fig. B.28b) op-amp circuits, we note that the 3-dB frequency of the op amp drops from 256.9 kHz to 155.7 kHz when resistor $R_{3}^{\prime}$ is inserted in the collector of $Q_{4}$ to make the op-amp circuit symmetrical. This is because, with a resistor $R_{3}^{\prime}$, the collector of $Q_{4}$ is no longer at signal ground and, hence, $C_{\mu 4}$ experiences the Miller effect. Consequently, the high-frequency response of the op-amp circuit is degraded.

Observe that in the preceding ac-analysis simulation, owing to the systematic offset inherent in the design, the op-amp circuit is operating at an output dc voltage of 3.62 V . However, in an actual circuit implementation (with $V_{C M}=0$ ), negative feedback is employed (see Chapters 2 and 11)

[^0]
[^0]:    ${ }^{12}$ This part of the example requires study of Section 10.7 .


Figure B. 28 Frequency response of (a) the op-amp circuit in Fig. B. 26 and (b) the op-amp circuit in Fig. B. 26 but with a resistor $R_{2}^{\prime}=R_{2}$ inserted in the collector of $Q_{4}$ to make the op-amp circuit symmetrical.
and the output dc voltage is stabilized at zero. Thus, the small-signal performance of the op-amp circuit can be more accurately simulated by biasing the circuit so as to force operation at this level of output voltage. This can be easily done by applying a differential dc input of $-V_{O S}$. Superimposed on this dc input, we can apply an ac signal to perform an ac-analysis simulation for the purpose of, for example, computing the differential gain and the 3-dB frequency.

Finally, to compute the input common-mode range of the op-amp circuit in Fig. B.26, we perform a dc-analysis simulation in PSpice with the input common-mode voltage swept over the range $-V_{E E}$ to $V_{C C}$, while maintaining $V_{d}$ constant at $-V_{O S}$ in order to cancel the output offset voltage (as discussed earlier) and, thus, prevent premature saturation of the BJTs. The corresponding output voltage $V_{\text {OUT }}$ is plotted in Fig. B.29(a). From this common-mode dc transfer characteristic we find that the amplifier behaves linearly over the $V_{C M}$ range -14.1 V to +8.9 V , which is therefore the input common-mode range. In Example 8.6, we noted that the upper limit of this range is determined by $Q_{1}$ and $Q_{2}$ saturating, whereas the lower limit is determined by $Q_{3}$ saturating. To verify this assertion, we requested PSpice to plot the values of the collector-base voltages of these BJTs versus the input common-mode voltage $V_{C M}$. The results are shown in Fig. B.29(b), from which we note that our assertion is indeed correct (recall that an $n p n$ BJT enters its saturation region when its base-collector junction becomes forward biased, i.e., $V_{B C} \geq 0$ ).


Figure B. 29 (a) The large-signal common-mode transfer characteristic of the op-amp circuit in Fig. B.26. The differential input voltage $V_{d}$ is set to $-V_{O S}=-260 \mu \mathrm{~V}$ to prevent premature saturation. (b) The effect of the common-mode input voltage VCM o n the linearity of the input stage of the op-amp circuit in Fig. B.26. The base-collector voltage of $Q_{1}$ and $Q_{2}$ is shown as a function of VCM. The input stage of the op-amp circuit leaves the active region when the base-collector junction of either $Q_{1}$ or $Q_{2}$ becomes forward biased (i.e., when $\mathrm{VBC} \geq 0$ ).


Figure B. 29 continued

# Example PS.10.1 

## Frequency Response of the CMOS CS and the Folded-Cascode Amplifiers

In this example, we will use PSpice to compute the frequency response of both the CS and the folded-cascode amplifiers whose schematic capture diagrams are shown shortly in Figs. B. 30 and B.32, respectively. We will assume that the dc bias levels at the output of the amplifiers are stabilized using negative feedback. However, before performing a small-signal analysis (an ac-analysis simulation) in SPICE to measure the frequency response, we will perform a dc analysis (a bias-point simulation) to verify that all MOSFETs are operating in the saturation region and, hence, ensure that the amplifier is operating in its linear region.

In the following, we will assume a $0.5-\mu \mathrm{m}$ CMOS technology for the MOSFETs and use parts NMOSOP5 and PMOSOP5 whose SPICE level-1 model parameters are listed in Table B.3. To specify the dimensions of the MOSFETs in PSpice, we will use the multiplicative factor $m$, together with the channel length $L$ and channel width $W$ (as we did in Example PS.7.1).

## The CMOS CS Amplifier

The CS amplifier circuit in Fig. B. 30 is identical to the one shown in Fig. 7.4, except that a current source is connected to the source of the input transistor $M_{1}$ to set its drain current $I_{D 1}$ independently of its drain voltage $V_{D 1}$. Furthermore, in our PSpice simulations, we used an impractically large bypass capacitor $C_{S}$ of 1 F .


Figure B. 30 Schematic capture of the CS amplifier in Example PS.10.1
This sets the source of $M_{1}$ at approximately signal ground during the ac-analysis simulation. Accordingly, the CS amplifier circuits in Figs. 7.4 and B. 30 are equivalent for the purpose of frequency-response analysis. In Chapter 9, we found out, in the context of studying the differential pair, how the goals of this biasing approach for the CS amplifier are realized in practical IC implementations.

The CS amplifier in Fig. B. 30 is designed assuming a reference current $I_{\text {ref }}=100 \mu \mathrm{~A}$ and $V_{D D}=3.3 \mathrm{~V}$. The current-mirror transistors, $M_{2}$ and $M_{3}$, are sized for $V_{O V 2}=V_{O V 3}=0.3 \mathrm{~V}$, while the input transistor $M_{1}$ is sized for $V_{O V 1}=0.15 \mathrm{~V}$. Unit-size transistors are used with $W / L=1.25 \mu \mathrm{~m} / 0.6$ $0.6 \mu \mathrm{~m}$ for the NMOS devices and $W / L=5 \mu \mathrm{~m} / 0.6 \mu \mathrm{~m}$ for the PMOS devices. Thus, using the square law $I_{D}-V_{O V}$ of the MOSFET together with the $0.5-\mu \mathrm{m}$ CMOS process parameters in Table B.4, we find $m_{1}=18$ and $m_{2}=m_{3}=4$. Furthermore, Eq. (B.25) gives $G_{v}=-44.4 \mathrm{~V} / \mathrm{V}$ for the CS amplifier.

In the PSpice simulations of the CS amplifier in Fig. B.30, the dc bias voltage of the signal source is set such that the voltage at the source terminal of $M_{1}$ is $V_{S 1}=1.3 \mathrm{~V}$. This requires the dc level of $V_{\text {sig }}$ to be $V_{O V 1}+V_{m 1}+V_{S 1}=2.45 \mathrm{~V}$ because $V_{m 1} \simeq 1 \mathrm{~V}$ as a result of the body effect on $M_{1}$. The reasoning behind this choice of $V_{S 1}$ is that, in a practical circuit implementation, the current source that feeds the source of $M_{1}$ is realized using a cascode current mirror such as the one in Fig. 8.32. In this case, the minimum voltage required across the current source (i.e., the minimum $V_{S 1}$ ) is $V_{t}+2 V_{O V}=1.3 \mathrm{~V}$, assuming $V_{O V}=0.3 \mathrm{~V}$ for the current-mirror transistors.

A bias-point simulation is performed in PSpice to verify that all MOSFETs are biased in the saturation region. Next, to compute the frequency response of the amplifier, we set the ac voltage of the signal source to 1 V , perform an ac-analysis simulation, and plot the output voltage magnitude versus frequency. Figure B.31(a) shows the resulting frequency response for $R_{\text {sig }}=100 \Omega$ and $R_{\text {sig }}=1 \mathrm{M} \Omega$. In both cases, a load capacitance of $C_{\text {load }}=0.5 \mathrm{pF}$ is used. The corresponding values of the $3-\mathrm{dB}$ frequency $f_{H}$ of the amplifier are given in Table B. 10 .


Figure B. 31 Frequency response of (a) the CS amplifier and (b) the folded-cascode amplifier in Example PS.10.1, with $R_{\text {sig }}=100 \Omega$ and $R_{\text {sig }}=1 \mathrm{M} \Omega$.

Observe that $f_{H}$ drops when $R_{\text {sig }}$ is increased. This is anticipated from our study of the high-frequency response of the CS amplifier in Section 10.3. Specifically, as $R_{\text {sig }}$ increases, the pole

$$
f_{p, \text { in }}=\frac{1}{2 \pi} \frac{1}{R_{\text {sig }} C_{\text {in }}}
$$

formed at the amplifier input will have an increasingly significant effect on the overall frequency response of the amplifier. As a result, the effective time constant $\tau_{H}$ in Eq. (10.88) increases and $f_{H}$ decreases. When $R_{\text {sig }}$ becomes very large, as it is when $R_{\text {sig }}=1 \mathrm{M} \Omega$, a dominant pole is formed by $R_{\text {sig }}$ and $C_{\text {in }}$. This results in

$$
f_{H} \simeq f_{p, \text { in }}
$$

To estimate $f_{p, \text { in }}$, we need to calculate the input capacitance $C_{\text {in }}$ of the amplifier. Using Miller's theorem, we have

$$
\begin{aligned}
C_{\text {in }} & =C_{g e 1}+C_{g d 1}\left(1+g_{m 1} R_{L}^{\prime}\right) \\
& =\left(\frac{2}{3} m_{1} W_{1} L_{1} C_{o x}+C_{g e, o v 1}\right)+C_{g d, o v 1}\left(1+g_{m 1} R_{L}^{\prime}\right)
\end{aligned}
$$
Table B. 10 Dependence of the 3-dB Bandwidth $f_{H}$ on $R_{\text {sig }}$ for the CS and the Folded-Cascode Amplifiers in Example PS.10.1

|  | $f_{H}$ |  |
| :-- | :-- | :-- |
| $R_{\text {sig }}$ | CS Amplifier | Folded-Cascode Amplifier |
| $100 \Omega$ | 7.49 MHz | 2.93 MHz |
| $1 \mathrm{M} \Omega$ | 293.2 kHz | 1.44 MHz |

where

$$
R_{L}^{\prime}=r_{o 1} \| r_{o 2}
$$

Thus, $C_{\text {in }}$ can be calculated using the values of $C_{g s 1}$ and $C_{g d 1}$, which are computed by PSpice and can be found in the output file of the bias-point simulation. Alternatively, $C_{\text {in }}$ can be found using Eq. (B.29) with the values of the overlap capacitances $C_{g s, o v 1}$ and $C_{g s d, o v 1}$ calculated using the process parameters in Table B. 4 (as described in Eqs. B. 9 and B.10); that is:

$$
\begin{aligned}
C_{g s, o v 1} & =m_{1} W_{1} C G S O \\
C_{g d, o v 1} & =m_{1} W_{1} C G D O
\end{aligned}
$$

This results in $C_{\text {in }}=0.53 \mathrm{pF}$ when $\left|G_{v}\right|=g_{m 1} R_{L}^{\prime}=53.2 \mathrm{~V} / \mathrm{V}$. Accordingly, using Eqs. (B.27) and (B.28), $f_{H}=300.3 \mathrm{kHz}$ when $R_{\text {sig }}=1 \mathrm{M} \Omega$, which is close to the value computed by PSpice.

# The Folded-Cascode Amplifier 

The folded-cascode amplifier circuit in Fig. B. 32 is equivalent to the one in Fig. 8.16, except that a current source is placed in the source of the input transistor $M_{1}$ (for the same dc-biasing purpose as in the case of the CS amplifier). Note that, in Fig. B.32, the PMOS current mirror $M_{2}-M_{4}$ and the NMOS current mirror $M_{5}-M_{6}$ are used to realize, respectively, current sources $I_{1}$ and $I_{2}$ in the circuit of Fig. 8.16. Furthermore, the current transfer ratio of mirror $M_{3}-M_{4}$ is set to 2 (i.e., $m_{3} / m_{4}=2$ ). This results in $I_{D 3} \simeq 2 I_{\text {ref }}$. Hence, transistor $M_{2}$ is biased at $I_{D 2}=I_{D 3}-I_{D 1}=I_{\text {ref }}$. The gate bias voltage of transistor $M_{2}$ is generated using the diode-connected transistors $M_{7}$ and $M_{8}$. The size and drain current of these transistors are set equal to those of transistor $M_{2}$. Therefore, ignoring the body effect,

$$
V_{G 2}=V_{D D}-V_{S G 7}-V_{S O S} \simeq V_{D D}-2\left(\left|V_{i p}\right|+\left|V_{O V p}\right|\right)
$$

where $V_{O V p}$ is the overdrive voltage of the PMOS transistors in the amplifier circuit. These transistors have the same overdrive voltage because their $I_{D} / m$ is the same. Thus, such a biasing configuration results in $V_{S G 2}=\left|V_{i p}\right|+\left|V_{O V p}\right|$ as desired, while setting $V_{S D 3}=\left|V_{i p}\right|+\left|V_{O V p}\right|$ to improve the bias matching between $M_{3}$ and $M_{4}$.

The folded-cascode amplifier in Fig. B. 32 is designed assuming a reference current $I_{o t 2}=100 \mu \mathrm{~A}$ and $V_{D D}=3.3 \mathrm{~V}$ (similar to the case of the CS amplifier). All transistors are sized for an overdrive voltage of 0.3 V , except for the input transistor $M_{1}$, which is sized for $V_{O V 1}=0.15 \mathrm{~V}$. Thus, since $I_{D}=\frac{1}{2} \mu m C_{o s} m$ $\left(W / L_{o t 1}\right) V_{O V}^{2}$, all the MOSFETs in the amplifier circuit are designed using $m=4$, except for $m_{1}=18$.

The midband voltage gain of the folded-cascode amplifier in Fig. B. 32 can be expressed as

$$
G_{v}=-g_{m 1} R_{\text {out }}
$$

where

$$
R_{\text {out }}=R_{\text {out } 2} \| R_{\text {out } 5}
$$


Figure B. 32 Schematic capture of the of folded-cascode amplifier in Example PS.10.1.
is the output resistance of the amplifier. Here, $R_{\text {out } 2}$ is the resistance seen looking into the drain of the cascode transistor $M_{2}$, while $R_{\text {out } 5}$ is the resistance seen looking into the drain of the current-mirror transistor $M_{5}$. Using Eq. (8.72), we have

$$
R_{\text {out } 2} \simeq\left(g_{m 2} r_{o 2}\right) R_{s 2}
$$

where

$$
R_{s 2}=r_{o 1} \| r_{o 3}
$$

is the effective resistance at the source of $M_{2}$. Furthermore,

$$
R_{\text {out } 5}=r_{o 5}
$$

Thus, for the folded-cascoded amplifier in Fig. B.32,

$$
R_{\text {out }} \simeq r_{o 5}
$$

and

$$
G_{o} \simeq-g_{m 1} r_{o 5}=-2 \frac{V_{A n}}{V_{D V 1}}
$$

Using the $0.5-\mu \mathrm{m}$ CMOS parameters, this gives $R_{\text {out }}=100 \mathrm{k} \Omega$ and $G_{o}=-133 \mathrm{~V} / \mathrm{V}$. Therefore, $R_{\text {out }}$ and hence $\left|G_{o}\right|$ of the folded-cascode amplifier in Fig. B. 32 are larger than those of the CS amplifier in Fig. B. 30 by a factor of 3 .

Figure B.31(b) shows the frequency response of the folded-cascode amplifier as computed by PSpice for the cases of $R_{\text {sig }}=100 \Omega$ and $R_{\text {sig }}=1 \mathrm{M} \Omega$. The corresponding values of the $3-\mathrm{dB}$ frequency $f_{H}$ of the amplifier are given in Table B.10. Observe that when $R_{\text {sig }}$ is small, $f_{H}$ of the folded-cascode amplifier is lower than that of the CS amplifier by a factor of approximately 2.6, approximately equal to the factor by which the gain is increased. This is because when $R_{\text {sig }}$ is small, the frequency response of both amplifiers is dominated by the pole formed at the output node, that is,

$$
f_{H} \simeq f_{p, \text { out }}=\frac{1}{2 \pi} \frac{1}{R_{\text {out }} C_{\text {out }}}
$$

Since the output resistance of the folded-cascode amplifier is larger than that of the CS amplifier (by a factor of approximately 3 , as found through the hand analysis above) while their output capacitances are approximately equal, the folded-cascode amplifier has a lower $f_{H}$ in this case.

On the other hand, when $R_{\text {sig }}$ is large, $f_{H}$ of the folded-cascode amplifier is much higher than that of the CS amplifier. This is because, in this case, the effect of the pole at $f_{p, \text { in }}$ on the overall frequency response of the amplifier becomes significant. Since, due to the Miller effect, $C_{\text {in }}$ of the CS amplifier is much larger than that of the folded-cascode amplifier, its $f_{H}$ is much lower in this case. To confirm this point, observe that $C_{\text {in }}$ of the folded-cascode amplifier can be estimated by replacing $R_{L}^{\prime}$ in Eq. (B.29) with the total resistance $R_{d 1}$ between the drain of $M_{1}$ and ground. Here,

$$
R_{d 1}=r_{o 1}\left\|r_{o 3}\right\| R_{\text {in } 2}
$$

where $R_{\text {in } 2}$ is the input resistance of the common-gate transistor $M_{2}$ and can be obtained using an approximation of the relationship in Eq. (8.53) as

$$
R_{\text {in } 2} \simeq \frac{r_{o 2}+r_{o 5}}{g_{m 2} r_{o 2}}
$$

Thus,

$$
R_{d 1} \simeq r_{o 1}\left\|r_{o 3}\right\|\left(\frac{r_{o 2}+r_{o 5}}{g_{m 2} r_{o 2}} \simeq \frac{2}{g_{m 2}}\right)
$$
# Example PS. 10.1 continued 

Therefore, $R_{d 1}$ is much smaller than $R_{L}^{\prime}$ in Eq. (B.30). Hence, $C_{\text {in }}$ of the folded-cascode amplifier in Fig. B. 32 is indeed much smaller than that of the CS amplifier in Fig. B.30. This confirms that the folded-cascode amplifier is much less impacted by the Miller effect and, therefore, can achieve a much higher $f_{H}$ when $R_{a \mathrm{~g}}$ is large.

The midband gain of the folded-cascode amplifier can be significantly increased by replacing the current mirror $M_{5}-M_{6}$ with a current mirror having a larger output resistance, such as the cascode current mirror in Fig. 8.32 whose output resistance is approximately $g_{m} r_{a}^{2}$. In this case, however, $R_{\text {in } 2}$ and hence $R_{d 1}$ increase, causing an increased Miller effect and a corresponding reduction in $f_{H}$.

Finally, it is interesting to observe that the frequency response of the folded-cascode amplifier, shown in Fig. B.31(b), drops beyond $f_{H}$ at approximately $-20 \mathrm{~dB} /$ decade when $R_{a \mathrm{~g}}=100 \Omega$ and at approximately $-40 \mathrm{~dB} /$ decade when $R_{a \mathrm{~g}}=1 \mathrm{M} \Omega$. This is because when $R_{a \mathrm{~g}}$ is small, the frequency response is dominated by the pole at $f_{p, \text { out }}$. However, when $R_{a \mathrm{~g}}$ is increased, $f_{p, \text { in }}$ is moved closer to $f_{p, \text { out }}$ and both poles contribute to the gain falloff.

## Example PS.11.1

## Determining the Loop Gain of a Feedback Amplifier

This example illustrates the use of SPICE to compute the loop gain $A \beta$. For this purpose, we shall use the shunt-series feedback amplifier shown in Fig. B.33a.

To compute the loop gain, we set the input signal $V_{b}$ to zero, and we choose to break the feedback loop between the collector of $Q_{1}$ and the base of $Q_{2}$. However, in breaking the feedback loop, we must ensure that the following two conditions that existed prior to breaking the feedback loop do not change: (1) the dc bias situation and (2) the ac signal termination.


Figure B. 33 Circuit of the shunt-series feedback amplifier in Example PS.11.1.To break the feedback loop without disturbing the dc bias conditions of the circuit, we insert a large inductor $L_{\text {break }}$, as shown in Fig. B.34(a). Using a value of, say, $L_{\text {break }}=1 \mathrm{GH}$ will ensure that the loop is opened for ac signals while keeping dc bias conditions unchanged.

To break the feedback loop without disturbing the signal termination conditions, we must load the loop output at the collector of $Q_{1}$ with a termination impedance $Z_{t}$ whose value is equal to the impedance seen looking into the loop input at the base of $Q_{2}$. Furthermore, to avoid disturbing the dc bias conditions, $Z_{t}$ must be connected to the collector of $Q_{1}$ via a large coupling capacitor. However, it is not always easy to determine the value of the termination impedance $Z_{t}$. So, we will describe two simulation methods to compute the loop gain without explicitly determining $Z_{T}$.
Method 1 Using the open-circuit and short-circuit transfer functions
As described in Section 11.1, the loop gain can be expressed as

$$
A \beta=-1 /\left(\frac{1}{T_{o c}}+\frac{1}{T_{s c}}\right)
$$

where $T_{o c}$ is the open-circuit voltage transfer function and $T_{s c}$ is the short-circuit voltage transfer function.
The circuit for determining $T_{o c}$ is shown in Fig. B.34(b). Here, an ac test signal voltage $V_{t}$ is applied to the loop input at the base of $Q_{2}$ via a large coupling capacitor (having a value of, say, 1 kF ) to avoid disturbing the dc bias conditions. Then,

$$
T_{o c}=\frac{V_{o c}}{V_{t}}
$$

where $V_{o c}$ is the ac open-circuit output voltage at the collector of $Q_{1}$.
In the circuit for determining $T_{s c}$ (Fig. B.34b), an ac test signal current $I_{t}$ is applied to the loop input at the base of $Q_{2}$. Note that a coupling capacitor is not needed in this case because the ac current source appears as an open circuit at dc, and, hence, does not disturb the dc bias conditions.

The loop output at the collector of $Q_{1}$ is ac short-circuited to ground via a large capacitor $C_{t o}$. Then,

$$
T_{s c}=\frac{I_{s c}}{I_{t}}
$$

where $I_{s c}$ is the ac short-circuit output current at the collector of $Q_{1}$.

# Method 2 Using a replica circuit 

As shown in Fig. B.35, a replica of the feedback amplifier circuit can be simply used as a termination impedance. Here, the feedback loops of both the amplifier circuit and the replica circuit are broken using a large inductor $L_{\text {break }}$ to avoid disturbing the dc bias conditions. The loop output at the collector of $Q_{1}$ in the amplifier circuit is then connected to the loop input at the base of $Q_{2}$ in the replica circuit via a large coupling capacitor $C_{t o}$ (again, to avoid disturbing the dc bias conditions). Thus, for ac signals, the loop output at the collector of $Q_{1}$ in the amplifier circuit sees an impedance equal to that seen before the feedback loop is broken. Accordingly, we have ensured that the conditions that existed in the amplifier circuit prior to breaking the loop have not changed.

Next, to determine the loop gain $A \beta$, we apply an ac test signal voltage $V_{t}$ via a large coupling capacitor $C_{t i}$ to the loop input at the base of $Q_{2}$ in the amplifier circuit. Then, as described in Section 11.5,

$$
A \beta=-\frac{V_{t}}{V_{t}}
$$

where $V_{r}$ is the ac returned signal at the loop output at the collector of $Q_{1}$ in the amplifier circuit.


Figure B. 34 Circuits for simulating (a) the open-circuit voltage transfer function $T_{o c}$ and (b) the short-circuit current transfer function $T_{s c}$ of the feedback amplifier in Fig. B. 33 for the purpose of computing its loop gain.


Figure B. 35 Circuit for simulating the loop gain of the feedback amplifier circuit in Fig. B. 33 using the replica-circuit method.

To compute the loop gain $A \beta$ of the feedback amplifier circuit in Fig. B. 33 using PSpice, we choose to simulate the circuit in Fig. B.35. In the PSpice simulations, we used part Q2N3904 (whose SPICE model is given in Table B.6) for the BJTs, and we set $L_{\text {break }}$ to be 1 GH and the coupling and bypass capacitors to be 1 kF . The magnitude and phase of $A \beta$ are plotted in Fig. B.36, from which we see that the feedback amplifier has a gain margin of 53.7 dB and a phase margin of $88.7^{\circ}$.


Figure B. 36 (a) Magnitude and (b) phase of the loop gain $A \beta$ of the feedback amplifier circuit in Fig. B.33.

# Example PS.12.1 

## Class B BJT Output Stage

We investigate the operation of the class B output stage whose schematic capture is shown in Fig. B.37. For the power transistors, we use the discrete BJTs MJE243 and MJE253 (from ON Semiconductor), ${ }^{13}$ which are rated for a maximum continuous collector current $I_{C \max }=4 \mathrm{~A}$ and a maximum collector-emitter voltage of $V_{C E \max }=100 \mathrm{~V}$. To permit comparison with the hand analysis performed in Example 11.1, in the simulation, we use component and voltage values identical (or close) to those of the circuit designed in Example 11.1. Specifically, we use a load resistance of $8 \Omega$, an input sine-wave signal of $17.9-\mathrm{V}$ peak and $1-\mathrm{kHz}$ frequency, and $23-\mathrm{V}$ power supplies. In PSpice, a transient-analysis simulation is performed over the interval 0 ms to 3 ms , and the waveforms of various node voltages and branch currents are plotted. In this example, Probe (the graphical interface of PSpice) is utilized to compute various power-dissipation values. Some of the resulting waveforms are displayed in Fig. B.38. The upper and middle graphs show the load voltage and current, respectively. The peak voltage amplitude is 16.9 V , and the peak current amplitude is 2.1 A . If one looks carefully, one can observe that both exhibit crossover distortion. The bottom

[^0]
[^0]:    ${ }^{13}$ In PSpice, we have created BJT parts for these power transistors based on the values of the SPICE model parameters available on the data sheets available from ON Semiconductor. Readers can find these parts (labeled QMJE243 and QMJE253) in the SEDRA.olb library, which is available at www.oup.com/us/sedrasmith.


Figure B. 37 Capture schematic of the class B output stage in Example PS.12.1.


Figure B. 38 Several waveforms associated with the class B output stage (shown in Fig. B.37) when excited by a $17.9-\mathrm{V}, 1-\mathrm{kHz}$ sinusoidal signal. The upper graph displays the voltage across the load resistance, the middle graph displays the load current, and the lower graph displays the instantaneous and average power dissipated by the load.
graph displays the instantaneous and the average power dissipated in the load resistance as computed using Probe by multiplying the voltage and current values to obtain the instantaneous power, and taking a running average for the average load power $P_{L}$. The transient behavior of the average load power, which eventually settles into a quasi-constant steady state of about 17.6 W , is an artifact of the PSpice algorithm used to compute the running average of a waveform.

The upper two graphs of Fig. B. 39 show the voltage and current waveforms, respectively, of the positive supply, $+V_{C C}$. The bottom graph shows the instantaneous and average power supplied by $+V_{C C}$.


Figure B. 39 The voltage (upper graph), current (middle graph), and instantaneous and average power (bottom graph) supplied by the positive voltage supply $\left(+V_{C C}\right)$ in the circuit of Fig. B.37.

Similar waveforms can be plotted for the negative supply, $-V_{C C}$. The average power provided by each supply is found to be about 15 W , for a total supply power $P_{S}$ of 30 W . Thus, the power-conversion efficiency can be computed to be

$$
\eta=P_{L} / P_{S}=\frac{17.6}{30} \times 100 \%=58.6 \%
$$

Figure B. 40 shows plots of the voltage, current, and power waveforms associated with transistor $Q_{P}$. Similar waveforms can be obtained for $Q_{N}$. As expected, the voltage waveform is a sinusoid, and the current waveform consists of half-sinusoids. The waveform of the instantaneous power, however, is rather unusual. It indicates the presence of some distortion as a result of driving the transistors rather hard. This can be verified by reducing the amplitude of the input signal. Specifically, when the amplitude is reduced to about 17 V , the "dip" in the power waveform vanishes. The average power dissipated in each of $Q_{N}$ and $Q_{P}$ can be computed by Probe and are found to be approximately 6 W .

Table B. 11 provides a comparison of the results found from the PSpice simulation and the corresponding values obtained using hand analysis in Example 11.1. Observe that the two sets of results are quite close.

To investigate the crossover distortion further, we present in Fig. B. 41 a plot of the voltage transfer characteristic (VTC) of the class B output stage. This plot is obtained through a dc-analysis simulation with $v_{\text {IN }}$ swept over the range -10 V to +10 V in $1.0-\mathrm{mV}$ increments. Using Probe, we determine that the slope of the VTC is nearly unity and that the dead band extends from -0.60 V to +0.58 V . The effect of the crossover distortion can be quantified by performing a Fourier analysis on the output voltage waveform in PSpice. This analysis decomposes the waveform generated through a transient analysis into its


Figure B. 40 Waveforms of the voltage across, the current through, and the power dissipated in the $p n p$ transistor $Q_{p}$ of the output stage shown in Fig. B. 37 .

Table B. 11 Various Power Terms Associated with the Class B Output Stage Shown in Fig. B. 37 as Computed by Hand and by PSpice Analysis

| Power/Efficiency | Equation | Hand Analysis <br> (Example PS.12.1) | PSpice | Error \% |
| :-- | :-- | :--: | :--: | :--: |
| $P_{S}$ | $\frac{2}{\pi} \frac{\hat{V}_{o}}{R_{L}} V_{C C}$ | 31.2 W | 30.0 W | 4 |
| $P_{D}$ | $\frac{2}{\pi} \frac{\hat{V}_{o}}{R_{L}} V_{C C}-\frac{1}{2} \frac{\hat{V}_{o}^{2}}{R_{L}}$ | 13.0 W | 12.4 W | 4.6 |
| $P_{L}$ | $\frac{1}{2} \frac{\hat{V}_{o}^{2}}{R_{L}}$ | 18.2 W | 17.6 W | 3.3 |
| $\eta$ | $\frac{P_{L}}{P_{S}} \times 100 \%$ | $58.3 \%$ | $58.6 \%$ | -0.5 |

Fourier-series components. Further, PSpice computes the total harmonic distortion (THD) of the output waveform. The results obtained from the simulation output file are shown on the next page.

These Fourier components are used to plot the line spectrum shown in Fig. B.42. We note that the output waveform is rather rich in odd harmonics and that the resulting THD is rather high ( $2.14 \%$ ).


Figure B. 41 Transfer characteristic of the class B output stage of Fig. B.37.

FOURIER COMPONENTS OF TRANSIENT RESPONSE V (OUT)
DC COMPONENT $=-1.525229 \mathrm{E}-02$

| HARMONIC <br> NO | FREQUENCY <br> (HZ) | FOURIER <br> COMPONENT | NORMALIZED <br> COMPONENT | PHASE <br> (DEG) | NORMALIZED <br> PHASE (DEG) |
| --: | :--: | :--: | :--: | :--: | :--: |
| 1 | $1.000 \mathrm{E}+03$ | $1.674 \mathrm{E}+01$ | $1.000 \mathrm{E}+00$ | $-2.292 \mathrm{E}-03$ | $0.000 \mathrm{E}+00$ |
| 2 | $2.000 \mathrm{E}+03$ | $9.088 \mathrm{E}-03$ | $5.428 \mathrm{E}-04$ | $9.044 \mathrm{E}+01$ | $9.044 \mathrm{E}+01$ |
| 3 | $3.000 \mathrm{E}+03$ | $2.747 \mathrm{E}-01$ | $1.641 \mathrm{E}-02$ | $-1.799 \mathrm{E}+02$ | $-1.799 \mathrm{E}+02$ |
| 4 | $4.000 \mathrm{E}+03$ | $4.074 \mathrm{E}-03$ | $2.433 \mathrm{E}-04$ | $9.035 \mathrm{E}+01$ | $9.036 \mathrm{E}+01$ |
| 5 | $5.000 \mathrm{E}+03$ | $1.739 \mathrm{E}-01$ | $1.039 \mathrm{E}-02$ | $-1.799 \mathrm{E}+02$ | $-1.799 \mathrm{E}+02$ |
| 6 | $6.000 \mathrm{E}+03$ | $5.833 \mathrm{E}-04$ | $3.484 \mathrm{E}-05$ | $9.159 \mathrm{E}+01$ | $9.161 \mathrm{E}+01$ |
| 7 | $7.000 \mathrm{E}+03$ | $1.195 \mathrm{E}-01$ | $7.140 \mathrm{E}-03$ | $-1.800 \mathrm{E}+02$ | $-1.799 \mathrm{E}+02$ |
| 8 | $8.000 \mathrm{E}+03$ | $5.750 \mathrm{E}-04$ | $3.435 \mathrm{E}-05$ | $9.128 \mathrm{E}+01$ | $9.129 \mathrm{E}+01$ |
| 9 | $9.000 \mathrm{E}+03$ | $9.090 \mathrm{E}-02$ | $5.429 \mathrm{E}-03$ | $-1.800 \mathrm{E}+02$ | $-1.799 \mathrm{E}+02$ |
| 10 | $1.000 \mathrm{E}+04$ | $3.243 \mathrm{E}-04$ | $1.937 \mathrm{E}-05$ | $9.120 \mathrm{E}+01$ | $9.122 \mathrm{E}+01$ |

TOTAL HARMONIC DISTORTION $=2.140017 \mathrm{E}+00$ PERCENT


Figure B. 42 Fourier-series components of the output waveform of the class B output stage in Fig. B.37.

# Example PS.13.1 

## Frequency Compensation of the Two-Stage CMOS Op Amp

In this example, we will use PSpice to aid in designing the frequency compensation of the two-stage CMOS circuit whose capture schematic is shown in Fig. B.43. PSpice will then be employed to determine the frequency response and the slew rate of the op amp. We will assume a $0.5-\mu \mathrm{m} n$-well CMOS technology for the MOSFETs and will use the SPICE level-1 model parameters listed in Table B.4. Observe that to eliminate the body effect and improve the matching between $M_{1}$ and $M_{2}$, the source terminals of the input PMOS transistors $M_{1}$ and $M_{2}$ are connected to their $n$ well.

The op-amp circuit in Fig. B. 43 is designed using a reference current $I_{R R V}=90 \mu \mathrm{~A}$, a supply voltage $V_{D D}=3.3 \mathrm{~V}$, and a load capacitor $C_{L}=1 \mathrm{pF}$. Unit-size transistors with $W / L=1.25 \mu \mathrm{~m} / 0.6 \mu \mathrm{~m}$ are used for both the NMOS and PMOS devices. The transistors are sized for an overdrive voltage $V_{O V}=0.3 \mathrm{~V}$. The corresponding multiplicative factors are given in Fig. B. 43.

In PSpice, the common-mode input voltage $V_{C M}$ of the op-amp circuit is set to $V_{D D} / 2=1.65 \mathrm{~V}$. A bias-point simulation is performed to determine the dc operating point. Using the values found in the simulation output file for the small-signal parameters of the MOSFETs, we obtain ${ }^{14}$

[^0]
[^0]:    ${ }^{14}$ Recall that $G_{m 1}$ and $G_{m 2}$ are the transconductances of, respectively, the first and second stages of the op amp. Capacitors $C_{1}$ and $C_{2}$ represent the total capacitance to ground at the output nodes of, respectively, the first and second stages of the op amp.
B-56 Appendix B SPICE Device Models and Design Simulation Examples Using PSpice and Multisim


Figure B. 43 Schematic capture of the two-stage CMOS op amp in Example PS.13.1.$$
\begin{aligned}
G_{w 1} & =0.333 \mathrm{~mA} / \mathrm{V} \\
G_{w 2} & =0.650 \mathrm{~mA} / \mathrm{V} \\
C_{1} & =26.5 \mathrm{fF} \\
C_{2} & =1.04 \mathrm{pF}
\end{aligned}
$$

using Eqs. (13.7), (13.14), (13.25), and (13.26), respectively. Then, using Eq. (13.35), the frequency of the second, nondominant, pole can be found as

$$
f_{P 2} \simeq \frac{G_{w 2}}{2 \pi C_{2}}=97.2 \mathrm{MHz}
$$

In order to place the transmission zero, given by Eq. (13.31), at infinite frequency, we select

$$
R=\frac{1}{G_{w 2}}=1.53 \mathrm{k} \Omega
$$

Now, using Eq. (13.31), the phase margin of the op amp can be expressed as

$$
P M=90^{\circ}-\tan ^{-1}\left(\frac{f_{t}}{f_{P 2}}\right)
$$

where $f_{t}$ is the unity-gain frequency, given in Eq. (13.83),

$$
f_{t}=\frac{G_{w 1}}{2 \pi C_{C}}
$$

Using Eqs. (B.44) and (B.45), we determine that compensation capacitors of $C_{C}=0.78 \mathrm{pF}$ and $C_{C}=2 \mathrm{pF}$ are required to achieve phase margins of $P M=55^{\circ}$ and $P M=75^{\circ}$, respectively.

Next, an ac-analysis simulation is performed in PSpice to compute the frequency response of the op amp and to verify the foregoing design values. It was found that with $R=1.53 \mathrm{k} \Omega$, we needed $C_{C}=0.6 \mathrm{pF}$ and $C_{C}=1.8 \mathrm{pF}$ to set $P M=55^{\circ}$ and $P M=75^{\circ}$, respectively. We note that these values are reasonably close to those predicted by hand analysis. The corresponding frequency responses for the compensated op amp are plotted in Figs. B. 44 and B.45. For comparison, we also show the frequency response of the uncompensated op amp $\left(C_{C}=0\right)$. Observe that the unity gain frequency $f_{t}$ drops from 70.2 MHz to 26.4 MHz as $C_{C}$ is increased to improve $P M$ (as anticipated from Eq. B.45).

Rather than increasing the compensation capacitor $C_{C}$, the value of the series resistor $R$ can be increased to improve the phase margin $P M$ : For a given $C_{C}$, increasing $R$ above $1 / G_{w 2}$ places the transmission zero at a negative real-axis location (Eq. 13.31), where the phase it introduces adds to the phase margin. Thus, $P M$ can be improved without affecting $f_{t}$. To verify this point, we set $C_{C}$ to 0.6 pF and simulate the op-amp circuit in PSpice for the cases of $R=1.53 \mathrm{k} \Omega$ and $R=3.2 \mathrm{k} \Omega$. The corresponding frequency response is plotted in Fig. B.46. Observe how $f_{t}$ is approximately independent of $R$. However, by increasing $R, P M$ is improved from $55^{\circ}$ to $75^{\circ}$.

Increasing the $P M$ is desirable because it reduces the overshoot in the step response of the op amp. To verify this point, we simulate in PSpice the step response of the op amp for $P M=55^{\circ}$ and $P M=75^{\circ}$. To do that, we connect the op amp in a unity-gain configuration, apply a small ( $10-\mathrm{mV}$ ) pulse signal at the input with very short (1-ps) rise and fall times to emulate a step input, perform a transient-analysis simulation, and plot the output voltage as shown in Fig. B.47. Observe that the overshoot in the step response drops from $15 \%$ to $1.4 \%$ when the phase margin is increased from $55^{\circ}$ to $75^{\circ}$.

We conclude this example by computing $S R$, the slew rate of the op amp. From Eq. (13.45),

$$
S R=2 \pi f_{t} V_{O V}=\frac{G_{w 1}}{C_{C}} V_{O V}=166.5 \mathrm{~V} / \mu \mathrm{s}
$$


Figure B. 44 Magnitude and phase response of the op-amp circuit in Fig. B.43: $R=1.53 \mathrm{k} \Omega, C_{C}=0$ (no frequency compensation), and $C_{C}=0.6 \mathrm{pF}\left(P M=55^{\circ}\right)$.


Figure B. 45 Magnitude and phase response of the op-amp circuit in Fig. B.43: $R=1.53 \mathrm{k} \Omega, C_{C}=0$ (no frequency compensation), and $C_{C}=1.8 \mathrm{pF}\left(P M=75^{\circ}\right)$.


Figure B. 46 Magnitude and phase response of the op-amp circuit in Fig. B.43: $C_{C}=0.6 \mathrm{pF}, R=1.53 \mathrm{k} \Omega\left(P M=55^{\circ}\right)$, and $R=3.2 \mathrm{k} \Omega\left(P M=75^{\circ}\right)$.


Figure B. 47 Small-signal step response (for a $10-\mathrm{mV}$ step input) of the op-amp circuit in Fig. B. 43 connected in a unity-gain configuration: $P M=55^{\circ}\left(C_{C}=0.6 \mathrm{pF}, R=1.53 \mathrm{k} \Omega\right)$ and $P M=75^{\circ}\left(C_{C}=0.6 \mathrm{pF}, R=3.2 \mathrm{k} \Omega\right)$.


Figure B. 48 Large-signal step response (for a 3.3-V step-input) of the op-amp circuit in Fig. B. 43 connected in a unity-gain configuration. The slope of the rising and falling edges of the output waveform correspond to the slew rate of the op amp.
when $C_{C}=0.6 \mathrm{pF}$. Next, to determine $S R$ using PSpice (see Example PS.2.2), we again connect the op amp in a unity-gain configuration and perform a transient-analysis simulation. However, we now apply a large pulse signal ( 3.3 V ) at the input to cause slew-rate limiting at the output. The corresponding output-voltage waveform is plotted in Fig. B.48. The slope of the slew-rate-limited output waveform corresponds to the slew rate of the op amp and is found to be $S R=160 \mathrm{~V} / \mathrm{ms}$ and $60 \mathrm{~V} / \mathrm{ms}$ for the negative- and positive-going output, respectively. These results, with the unequal values of $S R$ in the two directions, differ from those predicted by the simple model for the slew-rate limiting of the two-stage op-amp circuit (Section 13.1.6). The difference can perhaps be said to be a result of transistor $M_{4}$ entering the triode region and its output current (which is sourced through $C_{C}$ ) being correspondingly reduced. Of course, the availability of PSpice should enable the reader to explore this point further.

# Example PS.14.1 

## Operation of the CMOS Inverter

In this example, we will use PSpice to simulate the CMOS inverter whose schematic capture is shown in Fig, B.49. We will assume a $0.5-\mu \mathrm{m}$ CMOS technology for the MOSFETs and use parts NMOS0P5 and PMOS0P5 whose level-1 model parameters are listed in Table B.4. In addition to the channel length $L$ and the channel width $W$, we have used the multiplicative factor $m$ to specify the dimensions of the MOSFETs. The MOSFET parameter $m$, whose default value is 1 , is used in SPICE to specify the number of unit-size MOSFETs connected in parallel (see Fig. B.24). In our simulations, we will use unit-size transistors with $L=0.5 \mu \mathrm{~m}$ and $W=1.25 \mu \mathrm{~m}$. We will simulate the inverter for two cases: (a) setting $m_{p} / m_{n}=1$ so that the NMOS and PMOS transistors have equal widths, and (b) setting $m_{p} / m_{n}=\mu_{n} / \mu_{p}=4$ so that the PMOS


Figure B. 49 Schematic capture of the CMOS inverter in Example PS.14.1.
transistor is four times wider than the NMOS transistor (to compensate for the lower mobility in $p$-channel devices as compared with $n$-channel ones). Here, $m_{n}$ and $m_{p}$ are the multiplicative factors of, respectively, the NMOS and PMOS transistors of the inverter.

To compute both the voltage transfer characteristic (VTC) of the inverter and its supply current at various values of the input voltage $V_{\text {in }}$, we apply a dc voltage source at the input and perform a dc analysis with $V_{\text {in }}$ swept over the range of 0 to $V_{D D}$. The resulting VTC is plotted in Fig. B.50. Note that the slope of the VTC in the switching region (where both the NMOS and PMOS devices are in saturation) is not infinite as predicted from the simple theory presented in Chapter 14 (Section 14.2, Fig. 14.20). Rather, the nonzero value of $\lambda$ causes the inverter gain to be finite. Using the derivative feature of Probe, we can find the two points on the VTC at which the inverter gain is unity (i.e., the VTC slope is $-1 \mathrm{~V} / \mathrm{V}$ ) and, hence, determine $V_{I L}$ and $V_{I H}$. Using the results given in Fig. B.50, the corresponding noise margins are $N M_{L}=N M_{H}=1.34 \mathrm{~V}$ for the inverter with $m_{p} / m_{n}=4$, while $N M_{L}=0.975 \mathrm{~V}$ and $N M_{H}=1.74 \mathrm{~V}$ for the inverter with $m_{p} / m_{n}=1$. Observe that these results correlate reasonably well with the values obtained using the approximate formula in Eq. (14.38). Furthermore, note that with $m_{p} / m_{n}=\mu_{n} / \mu_{p}=4$, the NMOS and PMOS devices are closely matched and, hence, the two noise margins are equal.

The threshold voltage $V_{M}$ of the CMOS inverter is defined as the input voltage $v_{\text {IN }}$ that results in an identical output voltage $v_{\text {OUT }}$, that is,

$$
V_{M}=v_{\mathrm{IN}} \mid v_{\text {OUT }}=v_{\mathrm{IN}}
$$

Thus, as shown in Fig. B.51, $V_{M}$ is the intersection of the VTC, with the straight line corresponding to $v_{\text {OUT }}=v_{\text {IN }}$ (this line can be simply generated in Probe by plotting $v_{\text {IN }}$ versus $v_{\text {OUT }}$, as shown in Fig. B.51). Note that $V_{M} \simeq\left(V_{D D} / 2\right)$ for the inverter with $m_{p} / m_{n}=4$. Furthermore, decreasing $m_{p} / m_{n}$ decreases $V_{M}$. Figure B. 51 also shows the inverter supply current versus $v_{\text {IN }}$. Observe that the location of the supply-current peak shifts with the threshold voltage.


Figure B. 50 Input-output voltage transfer characteristic (VTC) of the CMOS inverter in Example PS.14.1 with $m_{p} / m_{n}=1$ and $m_{p} / m_{n}=4$.


Figure B. 51 (a) Output voltage and (b) supply current versus input voltage for the CMOS inverter in Example PS.14.1 with $m_{p} / m_{n}=1$ and $m_{p} / m_{n}=4$.


Figure B. 51 continued


Figure B. 52 Transient response of the CMOS inverter in Example PS.13.1 with $m_{p} / m_{n}=1$ and $m_{p} / m_{n}=4$.
To investigate the dynamic operation of the inverter with PSpice, we apply a pulse signal at the input (Fig. B.49), perform a transient analysis, and plot the input and output waveforms as shown in Fig. B.52. The rise and fall times of the pulse source are chosen to be very short. Note that increasing $m_{p} / m_{n}$ from 1 to 4 decreases $t_{P L H}$ (from 1.13 ns to 0.29 ns ) because of the increased current available to charge $C_{L}$, with only a minor increase in $t_{P H L}$ (from 0.33 ns to 0.34 ns ). The two propagation delays, $t_{P L H}$ and $t_{P H L}$, are not exactly equal when $m_{p} / m_{n}=4$, because the NMOS and PMOS transistors are still not perfectly matched (e.g., $V_{i n} \neq\left|V_{\varphi}\right|$ ).
# Example PS.15.1 

## Static and Dynamic Operation of an ECL Gate

In this example, we use PSpice to investigate the static and dynamic operation of the ECL gate (studied in Section 15.6) whose schematic capture is shown in Fig. B.53.

Having no access to the actual values for the SPICE model parameters of the BJTs utilized in commercially available ECL, we have selected parameter values representative of the technology utilized that, from our experience, would lead to reasonable agreement between simulation results and the measured


Figure B. 53 Schematic capture of the two-input ECL gate for Example PS.15.1


Figure B. 54 Circuit arrangement for computing the voltage transfer characteristics of the ECL gate in Fig. B.53.
performance data supplied by the manufacturer. It should be noted that this problem would not be encountered by an IC designer using SPICE as an aid; presumably, the designer would have full access to the proprietary process parameters and the corresponding device model parameters. In any case, for the simulations we conducted, we have utilized the following BJT model parameter values ${ }^{15}: I_{S}=0.26 \mathrm{fA}$, $\beta_{F}=100 ; \beta_{R}=1, \tau_{F}=0.1 \mathrm{~ns}, C_{j e}=1 \mathrm{pF}, C_{j e}=C_{o}=1.5 \mathrm{pF}$, and $\left|V_{A}\right|=100 \mathrm{~V}$.

We use the circuit arrangement of Fig. B. 54 to compute the voltage transfer characteristics of the ECL gate, that is, $v_{\text {OR }}$ and $v_{\text {NOR }}$ versus $v_{A}$, where $v_{A}$ is the input voltage at terminal A. For this investigation, the other input is deactivated by applying a voltage $v_{R}=V_{O L}=-1.77 \mathrm{~V}$. In PSpice, we perform a dc-analysis simulation with $v_{A}$ swept over the range -2 V to 0 V in $10-\mathrm{mV}$ increments and plot $v_{\text {OR }}$ and $v_{\text {NOR }}$ versus $v_{A}$. The simulation results are shown in Fig. B.55. We immediately recognize the VTCs as those we have seen and (partially) verified by manual analysis in Section 15.6. The two transfer curves are symmetrical about an input voltage of -1.32 V . PSpice also determined that the voltage $V_{R}$ at the base of the reference transistor $Q_{R}$ has exactly this value ( -1.32 V ), which is also identical to the value we determined by hand analysis of the reference-voltage circuit.

Utilizing Probe (the graphical interface of PSpice), one can determine the values of the important parameters of the VTC, as follows:

OR output: $V_{O L}=-1.77 \mathrm{~V}, V_{O H}=-0.88 \mathrm{~V}, V_{I L}=-1.41 \mathrm{~V}$, and $V_{I H}=-1.22 \mathrm{~V}$; thus, $N M_{H}=0.34 \mathrm{~V}$ and $N M_{L}=0.36 \mathrm{~V}$
NOR output: $V_{O L}=-1.78 \mathrm{~V}, V_{O H}=-0.88 \mathrm{~V}, V_{I L}=-1.41 \mathrm{~V}$, and $V_{I H}=-1.22 \mathrm{~V}$; thus, $N M_{H}=0.34 \mathrm{~V}$ and $N M_{L}=0.37 \mathrm{~V}$


Figure B. 55 Voltage transfer characteristics of the OR and NOR outputs (see Fig. B.54) for the ECL gate shown in Fig. B.53. Also indicated is the reference voltage, $V_{R}=-1.32 \mathrm{~V}$.

[^0]
[^0]:    ${ }^{15}$ In PSpice, we have created a part called QECL based on these BJT model parameter values. Readers can find this part in the SEDRA.olb library, which is available online at www.oup.com/us/sedrasmith.
# Example PS.15.1 continued 

These values are remarkably close to those found by pencil-and-paper analysis in Section 15.6.
We next use PSpice to investigate the temperature dependence of the transfer characteristics. The reader will recall that in Section 15.6, we discussed this point at some length and carried out a hand analysis in Example 14.4. Here, we use PSpice to find the voltage transfer characteristics at two temperatures, $0^{\circ} \mathrm{C}$ and $70^{\circ} \mathrm{C}$ (the VTCs shown in Fig. B. 55 were computed at $27^{\circ} \mathrm{C}$ ) for two different cases: the first case with $V_{R}$ generated as in Fig. B.53, and the second with the reference-voltage circuit eliminated and a constant, temperature-independent reference voltage of -1.32 V applied to the base of $Q_{R}$. The simulation results are displayed in Fig. B.56. Figure B.56(a) shows plots of the transfer characteristics for the case in which the reference circuit is utilized, and Fig. B.56(b) shows plots for the case in which a constant reference voltage is employed. Figure B.56(a) indicates that as the temperature is varied and $V_{R}$ changes, the values of $V_{\text {on }}$ and $V_{\text {oc }}$ also change but remain centered on $V_{R}$. In other words, the low and high noise margins remain nearly equal. As mentioned in Section 15.6 and demonstrated in the analysis of Example 14.4, this is the basic idea behind making $V_{R}$ temperature dependent. When $V_{R}$ is not temperature dependent, the symmetry of $V_{\text {oL }}$ and $V_{\text {on }}$ around $V_{R}$ is no longer maintained, as demonstrated in Fig. B.56(b). Finally, we show some of the values obtained in Table B.12. Observe that for the temperature-compensated case, the average value of $V_{\text {oL }}$ and $V_{\text {on }}$ remains very close to $V_{R}$. The reader is encouraged to compare these results to those obtained in Example 15.4.


Figure B. 56 Comparing the voltage transfer characteristics of the OR and NOR outputs (see Fig. B.54) of the ECL gate shown in Fig. B.53, with the reference voltage $V_{R}$ generated using: (a) the temperature-compensated bias network of Fig. B.53; (b) a temperature-independent voltage source.

Figure B. 56 continued

Table B. 12 PSpice-Computed Parameter Values of the ECL Gate, with and without Temperature Compensation, at Two Different Temperatures

| Temperature | Parameter | Temperature-Compensated |  | Not Temperature-Compensated |  |
| :--: | :--: | :--: | :--: | :--: | :--: |
|  |  | OR | NOR | OR | NOR |
| $0^{\circ} \mathrm{C}$ | $V_{O L}$ | $-1.779 \mathrm{~V}$ | $-1.799 \mathrm{~V}$ | $-1.786 \mathrm{~V}$ | $-1.799 \mathrm{~V}$ |
|  | $V_{O H}$ | $-0.9142 \mathrm{~V}$ | $-0.9092 \mathrm{~V}$ | $-0.9142 \mathrm{~V}$ | $-0.9092 \mathrm{~V}$ |
|  | $V_{\text {avg }}=$ | $\begin{gathered} -1.3466 \mathrm{~V} \\ V_{R} \end{gathered}$ | $\begin{gathered} -1.3541 \mathrm{~V} \\ -1.345 \mathrm{~V} \\ 1.6 \mathrm{mV} \end{gathered}$ | $\begin{gathered} -1.3501 \mathrm{~V} \\ -1.32 \mathrm{~V} \\ 9.1 \mathrm{mV} \end{gathered}$ | $\begin{gathered} -1.3541 \mathrm{~V} \\ -1.32 \mathrm{~V} \\ 30.1 \mathrm{mV} \end{gathered}$ |
|  | $\left\|V_{\text {avg }}-V_{R}\right\|$ |  |  |  |  |
| $70^{\circ} \mathrm{C}$ | $V_{O L}$ | $-1.742 \mathrm{~V}$ | $-1.759 \mathrm{~V}$ | $-1.729 \mathrm{~V}$ | $-1.759 \mathrm{~V}$ |
|  | $V_{O H}$ | $-0.8338 \mathrm{~V}$ | $-0.8285 \mathrm{~V}$ | $-0.8338 \mathrm{~V}$ | $-0.8285 \mathrm{~V}$ |
|  | $V_{\text {avg }}=$ | $\begin{gathered} -1.288 \mathrm{~V} \\ -1.271 \mathrm{~V} \\ 17 \mathrm{mV} \end{gathered}$ | $\begin{gathered} -1.294 \mathrm{~V} \\ -1.271 \mathrm{~V} \\ 23 \mathrm{mV} \end{gathered}$ | $\begin{gathered} -1.2814 \mathrm{~V} \\ -1.32 \\ 38 \mathrm{mV} \end{gathered}$ | $\begin{gathered} -1.294 \mathrm{~V} \\ -1.32 \mathrm{~V} \\ 26.2 \mathrm{mV} \end{gathered}$ |

The dynamic operation of the ECL gate is investigated using the arrangement of Fig. B.57. Here, two gates are connected by a $1.5-\mathrm{m}$ coaxial cable having a characteristic impedance $\left(Z_{0}\right)$ of $50 \Omega$. The manufacturer specifies that signals propagate along this cable (when it is properly terminated) at about half the speed of light, or $15 \mathrm{~cm} / \mathrm{ns}$. Thus we would expect the $1.5-\mathrm{m}$ cable we are using to introduce a delay $t_{d}$ of 10 ns . Observe that in this circuit (Fig. B.57), resistor $R_{T 1}$ provides the proper cable termination. The cable is


Figure B. 57 Circuit arrangement for investigating the dynamic operation of ECL. Two ECL gates (Fig. B.53) are connected in cascade via a $1.5-\mathrm{m}$ coaxial cable, which has a characteristic impedance $Z_{0}=50 \Omega$ and a propagation delay $t_{d}=10 \mathrm{~ns}$. Resistor $R_{T 1}(50 \Omega)$ provides proper termination for the coaxial cable.


Figure B. 58 Transient response of a cascade of two ECL gates interconnected by a $1.5-\mathrm{m}$ coaxial cable having a characteristic impedance of $50 \Omega$ and a delay of 10 ns (see Fig. B.57).
assumed to be lossless and is modeled in PSpice using the transmission line element (the T part in the Analog library) with $Z_{0}=50 \Omega$ and $t_{d}=10 \mathrm{~ns}$. A voltage step, rising from -1.77 V to -0.884 V in 1 ns , is applied to the input of the first gate, and a transient analysis over a 30-ns interval is requested. Figure B. 58 shows plots of the waveforms of the input, the voltage at the output of the first gate, the voltage at the input of the second gate, and the output. Observe that despite the very high edge speeds involved, the waveforms are reasonably clean and free of excessive ringing and reflections. This is particularly remarkable because the signal is being transported over a relatively long distance. A detailed examination of the waveforms reveals that the delay along the cable is indeed 10 ns , and the delay of the second gate is about 1.06 ns .


Figure B. 59 Transient response of a cascade of two ECL gates interconnected by a $1.5-\mathrm{m}$ cable having a characteristic impedance of $300 \Omega$. The termination resistance $R_{T 1}$ (see Fig. B.57) was kept unchanged at $50 \Omega$. Note the change in time scale of the plot.

Finally, to verify the need for properly terminating the transmission line, the dynamic analysis is repeated, this time with the $50-\Omega$ coaxial cable replaced with a $300-\Omega$ twisted-pair cable while keeping the termination resistance unchanged. The results are the slow rising and falling and long-delayed waveforms shown in Fig. B.59. (Note the change of plotting scale.)

# Example PS.17.1 

## Verification of the Design of a Fifth-Order Chebyshev Filter

In this example we show how SPICE can be utilized to verify the design of a fifth-order Chebyshev filter. Specifically, we simulate the operation of the circuit whose component values were obtained in Exercise 16.20. The complete circuit is shown in Fig. B.60(a). It consists of a cascade of two second-order simulated-LCR resonators using the Antoniou circuit and a first-order op amp-RC circuit. Using PSpice, we would like to compare the magnitude of the filter response with that computed directly from its transfer function. Here, we note that PSpice can also be used to perform the latter task by using the Laplace transfer-function block in the analog-behavioral-modeling (ABM) library.

Since the purpose of the simulation is simply to verify the design, we assume ideal components. For the op amps, we utilize a near-ideal model, namely, a voltage-controlled voltage source (VCVS) with a gain of $10^{9} \mathrm{~V} / \mathrm{V}$, as shown in Fig. B.60(b). ${ }^{16}$

[^0]
[^0]:    ${ }^{16}$ SPICE models for the op amp are described in Section B.1.1.


Figure B. 60 Circuits for Example PS.17.1. (a) Fifth-order Chebyshev filter circuit implemented as a cascade of two second-order simulated LCR resonator circuits and a single first-order op amp-RC circuit. (b) VCVS representation of an ideal op amp with gain $A$.


Figure B. 61 Magnitude response of the fifth-order lowpass filter circuit shown in Fig. B.60: (a) an expanded view of the passband region; (b) a view of both the passband and stopband regions.

In SPICE, we apply a $1-\mathrm{V}$ ac signal at the filter input, perform an ac-analysis simulation over the range 1 Hz to 20 kHz , and plot the output voltage magnitude versus frequency, as shown in Fig. B.61. Both an expanded view of the passband and a view of the entire magnitude response are shown. These results are almost identical to those computed directly from the ideal transfer function, thereby verifying the correctness of the design.

# Example PS 17.2 

## Effect of Finite Op-Amp Bandwidth on the Operation of the Two-Integrator-Loop Filter

In this example, we investigate the effect of the finite bandwidth of practical op amps on the response of a two-integrator-loop bandpass filter utilizing the Tow-Thomas biquad circuit of Fig. 16.25(b). The circuit is designed to provide a bandpass response with $f_{0}=10 \mathrm{kHz}, Q=20$, and a unity center-frequency gain. The op amps are assumed to be of the 741 type. Specifically, we model the terminal behavior of the op amp with the single-time-constant linear network shown in Fig. B.62. Since the analysis performed here is a small-signal (ac) analysis that ignores nonlinearities, no nonlinearities are included in this op-amp


$$
A_{0}=G_{m} R_{1} \quad \omega_{b}=1 / R_{b} C_{b}
$$

Figure B. 62 One-pole equivalent-circuit macromodel of an op amp operated within its linear region.


Figure B. 63 Circuit for Example PS.17.2 Second-order bandpass filter implemented with a Tow-Thomas biquad circuit having $f_{0}=10 \mathrm{kHz}, Q=20$, and unity center-frequency gain.
macromodel. (If the effects of op-amp nonlinearities are to be investigated, a transient analysis should be performed.) The following values are used for the parameters of the op-amp macromodel in Fig. B.62:

$$
\begin{array}{lll}
R_{u l}=2 \mathrm{M} \Omega & R_{i c m}=500 \mathrm{M} \Omega & R_{1}=75 \Omega \\
G_{m}=0.19 \mathrm{~mA} / \mathrm{V} & R_{b}=1.323 \times 10^{9} \Omega & C_{b}=30 \mathrm{pF}
\end{array}
$$

These values result in the specified input and output resistances of the 741-type op amp. Further, they provide a dc gain $A_{0}=2.52 \times 10^{3} \mathrm{~V} / \mathrm{V}$ and a $3-\mathrm{dB}$ frequency $f_{b}$ of 4 Hz , again equal to the values specified for the 741 . Note that the selection of the individual values of $G_{m}, R_{b}$, and $C_{b}$ is immaterial as long as $G_{m} R_{b}=A_{0}$ and $C_{b} R_{b}=1 / 2 \pi f_{b}$.

The Tow-Thomas circuit simulated is shown in Fig. B. 6 3. The circuit is simulated in PSpice for two cases: (1) assuming 741-type op amps and using the linear macromodel in Fig. B.62; and (2) assuming ideal op amps with dc gain of $A_{0}=10^{6} \mathrm{~V} / \mathrm{V}$ and using the near-ideal model in Fig. B.60. In both cases,


Figure B. 64 Comparing the magnitude response of the Tow-Thomas biquad circuit (shown in Fig. B.63) constructed with 741-type op amps, with the ideal magnitude response. These results illustrate the effect of the finite dc gain and bandwidth of the 741 op amp on the frequency response of the Tow-Thomas biquad circuit.
we apply a $1-\mathrm{V}$ ac signal at the filter input, perform an ac-analysis simulation over the range 8 kHz to 12 kHz , and plot the output-voltage magnitude versus frequency.

The simulation results are shown in Fig. B.64, from which we observe the significant deviation between the response of the filter using the 741 op amp and that using the near-ideal op-amp model. Specifically, the response with practical op amps shows a deviation in the center frequency of about -100 Hz , and a reduction in the $3-\mathrm{dB}$ bandwidth from 500 Hz to about 110 Hz . Thus, in effect, the filter $Q$ factor has increased from the ideal value of 20 to about 90 . This phenomenon, known as $Q$-enhancement, is predictable from an analysis of the two-integrator-loop biquad with the finite op-amp bandwidth taken into account [see Sedra and Brackett (1978)]. Such an analysis shows that $Q$-enhancement occurs as a result of the excess phase lag introduced by the finite op-amp bandwidth. The theory also shows that the $Q$-enhancement effect can be compensated for by introducing phase lead around the feedback loop. This can be accomplished by connecting a small capacitor, $C_{C}$, across resistor $R_{2}$. To investigate the potential of such a compensation technique, we repeat the PSpice simulation with various capacitance values. The results are displayed in Fig. B.65(a). We observe that as the compensation capacitance is increased from 0 pF , both the filter $Q$ and the resonance peak of the filter response move closer to the desired values. It is evident, however, that a compensation capacitance of 80 pF causes the response to deviate further from the ideal. Thus, optimum compensation is obtained with a capacitance value between 60 pF and 80 pF . Further experimentation using PSpice enabled us to determine that such an optimum is obtained with a compensation capacitance of 64 pF . The corresponding response is shown, together with the ideal response, in Fig. B.65(b). We note that although the filter $Q$ has been restored to its ideal value, there remains a deviation in the center frequency. We shall not pursue this matter any further
# Example PS.17.2 continued 

here; our objective is not to present a detailed study of the design of two-integrator-loop biquads; rather, it is to illustrate the application of SPICE in investigating the nonideal performance of active-filter circuits, generally.


Figure B. 65 (a) Magnitude response of the Tow-Thomas biquad circuit with different values of compensation capacitance. For comparison, the ideal response is also shown. (b) Comparing the magnitude response of the Tow-Thomas biquad circuit using a $64-\mathrm{pF}$ compensation capacitor and the ideal response.
# Example PS.18.1 

## Wien-Bridge Oscillator

For our first example on oscillators, we shall simulate the operation of the Wien-bridge oscillator whose schematic capture is shown in Fig. B.66. The component values are selected to yield oscillations at 1 kHz . We would like to investigate the operation of the circuit for different settings of $R_{1 a}$ and $R_{1 b}$, with $R_{1 a}+R_{1 b}=50 \mathrm{k} \Omega$. Since oscillation just starts when $\left(R_{2}+R_{1 b}\right) / R_{1 a}=2$ (see Exercise 17.4), that is, when $R_{1 a}=20 \mathrm{k} \Omega$ and $R_{1 b}=30 \mathrm{k} \Omega$, we consider three possible settings: (a) $R_{1 a}=15 \mathrm{k} \Omega, R_{1 b}=35 \mathrm{k} \Omega$; (b) $R_{1 a}=18 \mathrm{k} \Omega, R_{1 b}=32 \mathrm{k} \Omega$; and (c) $R_{1 a}=25 \mathrm{k} \Omega, R_{1 b}=25 \mathrm{k} \Omega$. These settings correspond to loop gains of $1.33,1.1$, and 0.8 , respectively.

In PSpice, a 741-type op amp and 1N4148-type diodes are used to simulate the circuit similar to the one in Fig. 18.7. ${ }^{17}$ A transient-analysis simulation is performed with the capacitor voltages initially set to zero. This demonstrates that the op-amp offset voltage is sufficient to cause the oscillations to start without the need for special start-up circuitry. Figure B. 67 shows the simulation results. The graph in Fig. B.67(a)


Figure B. 66 Example PS.18.1: Schematic capture of a Wien-bridge oscillator.

[^0]
[^0]:    ${ }^{17}$ The SPICE models for the 741 op amp and the 1 N 4148 diode are available in PSpice. The 741 op amp was characterized in Example PS.2.2. The 1N4148 diode was used in Example PS.4.1.


Figure B. 67 Start-up transient behavior of the Wien-bridge oscillator shown in Fig. B. 66 for various values of loop gain.shows the output waveform obtained for a loop gain of $1.33 \mathrm{~V} / \mathrm{V}$. Observe that although the oscillations grow and stabilize rapidly, the distortion is considerable. The output obtained for a loop gain of 1.1, shown in Fig. B.67(b), is much less distorted. However, as expected, as the loop gain is reduced toward unity, it takes longer for the oscillations to build up and for the amplitude to stabilize. For this case, the frequency is 986.6 Hz , which is reasonably close to the design value of 1 kHz , and the amplitude is 7.37 V . Finally, for a loop gain of 0.8 , the output shown in Fig. B.67(c) confirms our expectation that sustained oscillations cannot be obtained when the loop gain is less than unity.

PSpice can be used to investigate the spectral purity of the output sine wave. This is achieved using the Fourier analysis facility. It is found that in the steady state, the output for the case of a loop gain of 1.1 has a THD figure of $1.88 \%$. When the oscillator output is taken at the op-amp output (voltage $v_{A}$ ), a THD of $2.57 \%$ is obtained, which, as expected, is higher than that for the voltage $v_{\text {OUT }}$, but not by very much. The output terminal of the op amp is of course a much more convenient place to take the output.

# Example PS. 18.2 

## Active-Filter-Tuned Oscillator

In this example, we use PSpice to verify our contention that a superior op amp-oscillator can be realized using the active-filter-tuned circuit of Fig. 18.11. We also investigate the effect of changing the value of the filter $Q$ factor on the spectral purity of the output sine wave.

Consider the circuit whose schematic capture is shown in Fig. B.68. For this circuit, the center frequency is 1 kHz , and the filter $Q$ is 5 when $R_{1}=50 \mathrm{k} \Omega$ and 20 when $R_{1}=200 \mathrm{k} \Omega$. As in the case of the Wien-bridge circuit in Example PS.18.1, 741-type op amps and 1N4148-type diodes are utilized. In PSpice, a transient-analysis simulation is performed with the capacitor voltages initially set to zero. To be able to compute the Fourier components of the output, the analysis interval chosen must be long enough to allow the oscillator to reach a steady state. The time to reach a steady state is in turn determined by the value of the filter $Q$; the higher the $Q$, the longer it takes the output to settle. For $Q=5$, it was determined, through a combination of approximate calculations and experimentation using PSpice, that 50 ms is a reasonable estimate for the analysis interval. For plotting purposes, we use 200 points per period of oscillation.

The results of the transient analysis are plotted in Fig. B.69. The upper graph shows the sinusoidal waveform at the output of op amp $A_{1}$ (voltage $v_{1}$ ). The lower graph shows the waveform across the diode limiter (voltage $v_{2}$ ). The frequency of oscillation is found to be very close to the design value of 1 kHz . The amplitude of the sine wave is determined using Probe (the graphical interface of PSpice) to be 1.15 V (or 2.3 V p-p). Note that this is lower than the 3.6 V estimated in Exercise 17.7. The latter value, however, was based on an estimate of $0.7-\mathrm{V}$ drop across each conducting diode in the limiter. The lower waveform in Fig. B. 69 indicates that the diode drop is closer to 0.5 V for a 1 V peak-to-peak amplitude of the pseudo-square wave. We should therefore expect the peak-to-peak amplitude of the output sinusoid to be lower than 3.6 V by the same factor, and indeed it is approximately the case.

In PSpice, the Fourier analysis of the output sine wave indicates that THD $=1.61 \%$. Repeating the simulation with $Q$ increased to 20 (by increasing $R_{1}$ to $200 \mathrm{k} \Omega$ ), we find that the value of THD is reduced to $1.01 \%$. Thus, our expectations that the value of the filter $Q$ can be used as an effective means for constrolling the THD of the output waveform are confirmed.


Figure B. 68 Example PS.18.2: Schematic capture of an active-filter-tuned oscillator for which the $Q$ of the filter is adjustable by changing $R_{1}$.


Figure B. 69 Output waveforms of the active-filter-tuned oscillator shown in Fig. B. 68 for $Q=5\left(R_{1}=50 \mathrm{k} \Omega\right)$.

# B. 3 Multisim Examples 

## Example M5.7.1

## The CS Amplifier

In this example, we will use Multisim to characterize a CS amplifier whose schematic capture is shown in Fig. B.70. We will assume a $0.18-\mu \mathrm{m}$ CMOS technology for the MOSFET and use typical SPICE level-1 model parameters for this technology, as provided in Table B.4. We will also assume a signal-source resistance $R_{s i g}=10 \mathrm{k} \Omega$, a load resistance $R_{L}=50 \mathrm{k} \Omega$, and bypass and coupling capacitors of $10 \mu \mathrm{~F}$. The targeted specifications for this CS amplifier are a voltage gain $\left|A_{v}\right|=10 \mathrm{~V} / \mathrm{V}$ and a maximum power consumption $P=0.45 \mathrm{~mW}$. As should always be the case with computer simulation, we will begin with an approximate hand-analysis design. We will then use Multisim to fine-tune our design and to investigate the performance of the final design.

The amplifier specifications are summarized in Table B.13.

## Hand Design

With a $1.8-\mathrm{V}$ power supply, the drain current of the MOSFET must be limited to $I_{D}=P / V_{D D}=$ $0.45 \mathrm{~mW} / 1.8 \mathrm{~V}=0.25 \mathrm{~mA}$ to meet the power consumption specification. Choosing $V_{D V}=0.15 \mathrm{~V}$ and $V_{D S}=V_{D D} / 3=0.6 \mathrm{~V}$ (to achieve a large signal swing at the output), the MOSFET can now be sized as


Figure B. 70 Capture schematic of the CS amplifier.

| Parameters | Value |
| :-- | :-- |
| Power | 0.45 mW |
| $R_{\text {sig }}$ | $10 \mathrm{k} \Omega$ |
| $R_{L}$ | $50 \mathrm{k} \Omega$ |
| $\left\|A_{v}\right\|$ | $10 \mathrm{~V} / \mathrm{V}$ |
| $V_{D D}$ | 1.8 V |

where $k_{u}^{\prime}=\mu_{u} C_{o x}=246.2 \mu \mathrm{~A} / \mathrm{V}^{2}$. Here, $L_{\text {eff }}$ rather than $L$ is used to more accurately compute $I_{D}$.
The effect of using $W_{\text {eff }}$ instead of $W$ is much less important, because typically $W \gg W_{o v}$. Thus, choosing $L=0.200 \mu \mathrm{~m}$ results in $L_{\text {eff }}=L-2 L_{o v}=0.180 \mu \mathrm{~m}$, and $W=86 \times L_{\text {eff }}=15.48 \mu \mathrm{~m}$.

Note that we chose $L$ slightly larger than $L_{\min }$. This is a common practice in the design of analog ICs to minimize the effects of fabrication nonidealities on the actual value of $L$. As we have seen, this is particularly important when the circuit performance depends on the matching between the dimensions of two or more MOSFETs (e.g., in the current-mirror circuits studied in Chapter 8).

Next, $R_{D}$ is calculated based on the desired voltage gain:

$$
\left|A_{v}\right|=g_{m}\left(R_{D} \| R_{L} \| r_{o}\right)=10 \mathrm{~V} / \mathrm{V} \Rightarrow R_{D} \simeq 3.41 \mathrm{k} \Omega
$$

where

$$
g_{m}=\frac{2 I_{D}}{V_{O V}}=\frac{2 \times 0.25 \times 10^{-3}}{0.15}=3.33 \mathrm{~mA} / \mathrm{V}
$$
and

$$
r_{a}=\frac{V_{A}}{I_{D}}=\frac{12.5}{0.25 \times 10^{-3}}=50 \mathrm{k} \Omega
$$

Hence, the dc bias voltage is $V_{D}=V_{D D}-I_{D} R_{D}=0.9457 \mathrm{~V}$.
To stabilize the bias point of the CS amplifier, we include a resistor in the source lead. In other words, to bias the MOSFET at $V_{D S}=V_{D D} / 3$, we need an

$$
R_{s}=\frac{V_{S}}{I_{D}}=\frac{\left(V_{D}-V_{D D} / 3\right)}{I_{D}}=\frac{0.3475}{0.25 \times 10^{-3}}=1.39 \mathrm{k} \Omega
$$

However, as a result of including such a resistor, the gain drops by a factor of $\left(1+g_{m} R_{S}\right)$. Therefore, we include a capacitor, $C_{S}$, to eliminate the effect of $R_{S}$ on ac operation of the amplifier and gain.

Finally, choosing the current in the biasing branch to be $1 \mu \mathrm{~A}$ gives $R_{G 1}+R_{G 2}=V_{D D} / 1 \mu \mathrm{~A}=1.8 \Omega$. Also, we know that

$$
V_{G S}=V_{O V}+V_{t}=0.15+0.45=0.6 \mathrm{~V} \Rightarrow V_{G}=V_{S}+0.6=0.3475+0.6=0.9475 \mathrm{~V}
$$

Hence,

$$
\frac{R_{G 2}}{R_{G 1}+R_{G 2}}=\frac{V_{G}}{V_{D D}}=\frac{0.9475}{1.8} \Rightarrow R_{G 1}=0.8525 \mathrm{M} \Omega, R_{G 2}=0.9475 \mathrm{M} \Omega
$$

Using large values for these gate resistors ensures that both their power consumption and the loading effect on the input signal source are negligible.

# Simulation 

Amplifier Biasing We will now use Multisim to verify our design and investigate the performance of the CS amplifier. We begin by performing a bias-point simulation to verify that the MOSFET is properly biased in the saturation region and that the dc voltages and currents match the expected values (refer to this example's simulation file: Ch5_CS_Amplifier_Ex_DC.ms10). The results are shown in Fig. B.71.


Figure B. 71 DC bias-point analysis of the CS amplifier.
# Example MS.7.1 continued 

Amplifier Gain We can also verify if our design provides the desired gain. This can be done by performing transient response analysis, as set up in Ch5_CS_Amplifier_Ex_gain.ms10. As can be seen from Fig. B.72, $\left|G_{v}\right| \simeq\left|A_{v}\right| \simeq 11 \mathrm{~V} / \mathrm{V}$. Note the values of overall voltage gain $G_{v}$ and $A_{v}$ are close since $R_{i n}=\left(R_{G 1} \| R_{G 2}\right) \gg R_{s i g}$. In the case where the capacitor $C_{S}$ is not included $\left(C_{S}=0\right)$, the gain drops by a factor of 5.63 (approximately equal to $1+g_{m} R_{S}$ ) to 1.95 . This is as expected from our study of the CS amplifier with a source-degeneration resistance.


Figure B. 72 $A_{v}$ and $G_{v}$ of the CS amplifier: transient analysis.
Investigating Amplifier Bias Stability We can also demonstrate the improved bias stability achieved when a source resistor $R_{S}$ is used. Specifically, we change (in the MOSFET level-1 model) the value of the zero-bias threshold voltage parameter VTO by $\pm 0.1 \mathrm{~V}$ and perform bias-point simulation in Multisim. Table B. 14 shows the corresponding variations in $I_{D}$ and $V_{D}$ for the case in which $R_{S}=1.39 \mathrm{k} \Omega$. For the case without source degeneration, we use an $R_{S}=0$ in the given schematic. Furthermore, to obtain the same $I_{D}$ and $V_{D}$ in both cases (for the nominal threshold voltage $V_{t 0}=0.45 \mathrm{~V}$ ), we use $R_{G 1}=1.2 \mathrm{M} \Omega$ and $R_{G 2}=0.6 \mathrm{M} \Omega$.

| Table B. 14 Variations in VTO |  |  |  |  |
| :--: | :--: | :--: | :--: | :--: |
| With $R_{S}=1.39 \mathrm{k} \Omega$ |  |  |  |  |
| VTO (V) | $I_{D}(\mu \mathrm{~A})$ | $I_{D} \%$ Change | $V_{D}(\mathrm{~V})$ | $V_{D} \%$ Change |
| 0.45 | 250 | 0 | 0.948 | 0 |
| 0.35 | 309 | $23.60 \%$ | 0.748 | $-21.10 \%$ |
| 0.55 | 192 | $-37.86 \%$ | 1.14 | $20.25 \%$ |
| Without $R_{S}$ |  |  |  |  |
| 0.45 | 255.96 | 0 | 0.9292 | 0 |
| 0.35 | 492 | $96.80 \%$ | 0.122 | $-87.13 \%$ |
| 0.55 | 30.1 | $-90.26 \%$ | 1.7 | $127.27 \%$ |
Also, Table B. 15 shows the worst-case deviation of $I_{D}$ and $V_{D}$ values, when imposing $5 \%$ tolerance on the resistors that determine the gate voltage.

Table B. 15 Variations Due to Resistor Tolerances

|  | $\mathrm{R}_{\mathrm{G} 1}(\mathrm{M} \Omega)$ | $\mathrm{R}_{\mathrm{G} 2}(\mathrm{M} \Omega)$ | With $R_{\mathrm{g}}=1.39 \mathrm{k} \Omega \mathrm{s}$ |  |  |  |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: |
|  |  |  | $I_{D}(\mu \mathrm{~A})$ | $I_{D} \%$ Change | $V_{D}(\mathrm{~V})$ | $V_{1} \%$ Change |
| Nominal | 0.8525 | 0.9475 | 250 | 0 | 947.67 | 0 |
| $I_{D}$ low $V_{D}$ high | 0.895 | 0.9 | 223.86 | $-10.44 \%$ | 1.037 | $9.39 \%$ |
| $I_{D}$ high $V_{D}$ low | 0.81 | 0.995 | 276.1 | $10.46 \%$ | 0.858 | $-9.41 \%$ |
|  | $\mathrm{R}_{\mathrm{G} 1}(\mathrm{M} \Omega)$ | $\mathrm{R}_{\mathrm{G} 2}(\mathrm{M} \Omega)$ | Without $R_{\mathrm{g}}$ |  |  |  |
|  |  |  | $I_{D}(\mu \mathrm{~A})$ | $I_{D} \%$ Change | $V_{D}(\mathrm{~V})$ | $V_{D} \%$ Change |
| Nominal | 1.2 | 0.6 | 255.96 | 0 | 0.9292 | 0 |
| $I_{D}$ low $V_{D}$ high | 1.26 | 0.57 | 143.28 | $-44.02 \%$ | 1.311 | $41.44 \%$ |
| $I_{D}$ high $V_{D}$ low | 1.14 | 0.63 | 398.62 | $55.74 \%$ | 0.447 | $-52.47 \%$ |

Accordingly, we see that the source-degeneration resistor makes the bias point of the CS amplifier less sensitive to changes in the threshold voltage and the values of gate resistors. However, unless a large bypass capacitor $C_{S}$ is used, this reduced sensitivity comes at the expense of a reduction in gain.

Largest Allowable Input Signal Swing Next, we wish to analyze this amplifier circuit to determine the largest allowable $v_{\text {sig }}$ for which the transistor remains in saturation:

$$
v_{D S} \geq v_{G S}-v_{t}
$$

By enforcing this condition, with equality, at the point $v_{G S}$ is maximum and $v_{D S}$ is correspondingly minimum, we write:

$$
\begin{gathered}
v_{D S, \min } \geq v_{G S, \max }-v_{t 0} \\
v_{D S}-\left|G_{v}\right| v_{\text {sig }}=V_{G S}+v_{\text {sig }}-v_{t 0} \\
v_{\text {sig }}=\frac{V_{D S}-V_{G S}+V_{t 0}}{\left(1+\left|G_{v}\right|\right)}=\frac{0.9475-0.6+0.45}{11}=72.5 \mathrm{mV}
\end{gathered}
$$

This can be verified from Ch5_CS_Amplifier_Ex_swing.ms10 simulation setup. If we increase the source signal's amplitude beyond approximately 73 mV , we can observe the distortion in the output signal, indicating that the MOSFET has entered the triode region.

Amplifier Linearity Finally, we can investigate the linearity of the designed amplifier. To do so, we use the setup in Ch5_CS_Amplifier_Ex_linearity.ms10. In this case, we use a triangular waveform and increase the amplitude of the signal until the output waveform begins to show nonlinear distortion (i.e., the rising and falling edges are no longer straight lines). Based on hand analysis, linearity holds as long as $v_{\text {in }} \ll 2 \mathrm{~V}_{\text {ov }}$. According to the simulation results, linearity holds until $v_{\text {in }}$ reaches the value of approximately 30 mV , which is one-tenth of the value of $2 V_{\text {ov }}$.
# Example MS.7.2 

## Dependence of $\beta$ on the Bias Current

In this example, we use Multisim to investigate the dependence of $\beta_{\mathrm{dc}}$ on the collector bias current of the Q2N3904 discrete BJT (from Fairchild Semiconductor) whose model parameters are listed in Table B. 16 and are available in Multisim. As shown in the schematic capture of Fig. B.73, the $V_{C E}$ of the BJT is fixed using a constant voltage source (in this example, $V_{C E}=2 \mathrm{~V}$ ) and a dc current source $I_{R}$ is applied at the base. To obtain the dependence of $\beta_{\mathrm{dc}}$ on the collector current $I_{C}$, we perform a dc-analysis simulation in which the sweep variable is the current source $I_{R}$. The $\beta_{\mathrm{dc}}$ of the BJT, which corresponds to the ratio of the collector current $I_{C}$ to the base current $I_{R}$, can then be plotted versus $I_{C}$ (by exporting the data to a graphing software), as shown in Fig. B.74. We see that to operate at the maximum value of $\beta_{\mathrm{dc}}$ (i.e., $\beta_{\mathrm{dc}}=163$ ), at $V_{C E}=2 \mathrm{~V}$, the BJT must be biased at an $I_{C}=10 \mathrm{~mA}$. Since increasing the bias current of a transistor increases the power dissipation, it is clear from Fig. B. 74 that the choice of current $I_{C}$ is a trade-off between the current gain $\beta_{\mathrm{dc}}$ and the power dissipation. Generally speaking, the optimum $I_{C}$ depends on the application and technology in hand. For example, for the Q2N3904 BJT operating at $V_{C E}=2 \mathrm{~V}$, decreasing $I_{C}$ by a factor of 20 (from 10 mA to 0.5 mA ) results in a drop in $\beta_{\mathrm{dc}}$ of about $25 \%$ (from 163 to 123 ).

Table B. 16 SPICE Model Parameters of the Q2N3904 Discrete BJT

| Is $=6.734 \mathrm{f}$ | $\mathrm{Bf}=416.4$ | $\mathrm{Xtb}=1.5$ | $\mathrm{Ikr}=0$ | $\mathrm{Vjc}=.75$ | $\mathrm{Vje}=.75$ | $\mathrm{Vtf}=4$ |
| :-- | :-- | :-- | :-- | :-- | :-- | :-- |
| Xti $=3$ | $\mathrm{Ne}=1.259$ | $\mathrm{Br}=.7371$ | $\mathrm{Rc}=1$ | $\mathrm{Fc}=.5$ | $\mathrm{Tr}=239.5 \mathrm{n}$ | $\mathrm{Xtf}=2$ |
| $\mathrm{Eg}=1.11$ | $\mathrm{Ise}=6.734 \mathrm{f}$ | $\mathrm{Nc}=2$ | $\mathrm{Cjc}=3.638 \mathrm{p}$ | $\mathrm{Cje}=4.493 \mathrm{p}$ | $\mathrm{Tf}=301.2 \mathrm{p}$ | $\mathrm{Rb}=10$ |
| $\mathrm{Vaf}=74.03$ | $\mathrm{Ikf}=66.78 \mathrm{~m}$ | $\mathrm{Isc}=0$ | $\mathrm{Mjc}=.3085$ | $\mathrm{Mje}=.2593$ | $\mathrm{Itf}=.4$ |  |



Figure B. 73 The test bench used to investigate the dependence of $\beta_{\mathrm{dc}}$ on the bias current for the Q2N3904 discrete BJT.


Figure B. 74 Dependence of $\beta_{\mathrm{dc}}$ on $I_{C}$ (at $V_{C E}=2 \mathrm{~V}$ ) in the Q2N3904 discrete BJT.

# Example MS.7.3 

## The CE Amplifier with Emitter Resistance

In this example, we use Multisim to compute the voltage gain and frequency response of the CE amplifier and investigate its bias-point stability. A schematic capture of the CE amplifier is shown in Fig. B.75. We will use part Q2N3904 for the BJT and a $\pm 5-\mathrm{V}$ power supply. We will assume a signal-source resistor $R_{\text {sig }}=10 \mathrm{k} \Omega$, a load resistor $R_{\mathrm{L}}=10 \mathrm{k} \Omega$, and bypass and coupling capacitors of $10 \mu \mathrm{~F}$. To enable us to investigate the effect of including a resistance in the signal path of the emitter, a resistor $R_{c e}$ is connected in series with the emitter bypass capacitor $C_{E}$. Note that the roles of $R_{E}$ and $R_{c e}$ are different. Resistor $R_{E}$ is the dc emitter-degeneration resistor because it appears in the dc path between the emitter and ground. It is therefore used to help stabilize the bias point for the amplifier. The equivalent resistance $R_{e}=R_{E} \| R_{c e}$ is the small-signal emitter-degeneration resistance because it appears in the ac (small-signal) path between the emitter and ground and helps stabilize the gain of the amplifier. In this example, we will investigate the effects of both $R_{E}$ and $R_{e}$ on the performance of the CE amplifier. However, as should always be the case with computer simulation, we will begin with an approximate hand analysis. In this way, maximum advantage and insight can be obtained from simulation.

Based on the plot of $\beta_{\mathrm{dc}}$ versus $I_{R}$ in Fig. B.74, a collector bias current $I_{C}$ (i.e., $\beta_{\mathrm{dc}} I_{R}$ ) of 0.5 mA is selected for the BJT, resulting in $\beta_{\mathrm{dc}}=123$. This choice of $I_{C}$ is a reasonable compromise between power dissipation and current gain. Furthermore, a collector bias voltage $V_{C}$ of 0 V (i.e., at the mid-supply rail) is selected to achieve a high signal swing at the amplifier output. For $V_{C E}=2 \mathrm{~V}$, the result is that $V_{E}=-2 \mathrm{~V}$,


Figure B. 75 Schematic capture of the CE amplifier.
requiring bias resistors with values

$$
\begin{aligned}
& R_{C}=\frac{V_{C C}-V_{C}}{I_{C}}=10 \mathrm{k} \Omega \\
& R_{E}=\frac{V_{E}-V_{E E}}{I_{C}}=320 \mathrm{k} \Omega
\end{aligned}
$$

Assuming $V_{B E}=0.7 \mathrm{~V}$ and $\beta_{\mathrm{dc}}=123$, we can determine

$$
R_{B}=-\frac{V_{B}}{I_{B}}=-\frac{V_{B E}+V_{E}}{I_{C} / \beta_{\mathrm{dc}}}=320 \mathrm{k} \Omega
$$

Next, the input resistance $R_{\text {in }}$ and the voltage gain $\left|A_{v}\right|$ of the CE amplifier:

$$
\begin{aligned}
R_{\text {in }} & =R_{B}\left(\beta_{\text {ac }}+1\right)\left(r_{e}+R_{e}\right) \\
\left|A_{v}\right| & =\left|-\frac{R_{\text {in }}}{R_{\text {sig }}+R_{\text {in }}} \times \frac{R_{C} \| R_{L}}{r_{e}+R_{e}}\right|
\end{aligned}
$$

For simplicity, we will assume $\beta_{\text {ac }} \simeq \beta_{\mathrm{dc}}=123$, resulting in

$$
r_{e}=\left(\frac{\beta_{\text {ac }}}{\beta_{\text {ac }}+1}\right)\left(\frac{V_{T}}{I_{c}}\right)=49.6 \Omega
$$Thus, with no small-signal emitter degeneration (i.e., $R_{s e}=0$ ), $R_{\text {in }}=6.1 \mathrm{k} \Omega$ and $\left|A_{v}\right|=38.2 \mathrm{~V} / \mathrm{V}$. Using the equation found for $\left|A_{v}\right|$ and assuming that $R_{B}$ is large enough to have a negligible effect on $R_{\text {in }}$, it can be shown that the emitter-degeneration resistance $R_{e}$ decreases the voltage gain $\left|A_{v}\right|$ by a factor of

$$
\frac{1+\frac{R_{e}}{r_{e}}+\frac{R_{\text {sig }}}{r_{n}}}{1+\frac{R_{\text {sig }}}{r_{n}}}
$$

Therefore, to limit the reduction in voltage gain to a factor of 2 , we will select

$$
R_{e}=r_{e}+\frac{R_{\text {sig }}}{\beta_{m}+1}
$$

Thus, $R_{s e} \simeq R_{e}=130 \Omega$. Substituting this value in the equations found for $\left|A_{v}\right|$ and $R_{\text {in }}$ shows that $R_{\text {in }}$ increases from $6.1 \mathrm{k} \Omega$ to $20.9 \mathrm{k} \Omega$ while $\left|A_{v}\right|$ drops from $38.2 \mathrm{~V} / \mathrm{V}$ to $18.8 \mathrm{~V} / \mathrm{V}$.

We will now use Multisim to verify our design and investigate the performance of the CE amplifier. We begin by performing a bias-point simulation to verify that the BJT is properly biased in the active region and that the dc voltages and currents meet the desired specifications. Based on this simulation forward, we have increased the value of $R_{B}$ to $340 \mathrm{k} \Omega$ in order to limit $I_{C}$ to about 0.5 mA while using a standard $1 \%$ resistor value. Next, to measure the gain $A_{v}$, we conduct a transient response analysis, as set up in Ch6_CE_Amplifier_Ex.ms10. Accordingly, with no emitter degeneration, the gain is $\left|A_{v}\right|=38.5 \mathrm{~V} / \mathrm{V}$. Using $R_{s e}=130 \Omega$ results in a drop in the gain by a factor of 2 (as can be seen from Fig. B.76).


Figure B. 76 Transient analysis of the CE amplifier with $R_{s e}=0$ and $R_{s e}=130 \Omega$.
Thus far in this example, we have assumed that the voltage gain of the BJT amplifier is constant and independent of the frequency of the input signal. However, as mentioned in Section 10.6, this is not true, since it implies that the amplifier has infinite bandwidth. To illustrate the finite bandwidth, we compute the frequency response of the amplifier. The plot of the output-voltage magnitude (in dB ) versus frequency is
# Example MS.7.3 continued 

shown in Fig. B.77. With no emitter degeneration, the midband gain is $\left|A_{M}\right|=38.5 \mathrm{~V} / \mathrm{V}=31.7 \mathrm{~dB}$ and the $3-\mathrm{dB}$ bandwidth is $B W=f_{H}-f_{L}=145.7 \mathrm{kHz}$. Using an $R_{c e}$ of $130 \Omega$ results in a drop in the midband gain $\left|A_{M}\right|$ by a factor of 2 (consistent with what we observed previously in our transient analysis). Interestingly, however, $B W$ has now increased by approximately the same factor as the drop in $\left|A_{M}\right|$. As we learned in Chapter 11, the emitter-degeneration resistor $R_{c e}$ provides negative feedback, which allows us to trade off gain for other desirable properties such as a larger input resistance and a wider bandwidth.

To conclude this example, we will demonstrate the improved bias-point (or dc operating point) stability achieved when an emitter resistor $R_{E}$ is used. Specifically, we will increase/decrease the value of the parameter $B F$ (i.e., the ideal maximum forward current gain) in the SPICE model for part Q2N3904 by a factor of 2 and read the bias-point probes. The corresponding change in BJT parameter $\left(\beta_{d c}\right)$ and bias-point $\left(I_{C}\right.$ and $\left.V_{C E}\right)$ are presented in Table B. 17 for the case of $R_{E}=6 \mathrm{k} \Omega$.


Figure B. 77 Frequency response of the CE amplifier with $R_{c e}=0$ and $R_{c e}=130 \Omega$.

Table B. 17 Variations in the Bias Point of the CE Amplifier with the SPICE Model-Parameter BF of BJT

| $B F$ (in SPICE) | $R_{E}=6 \mathrm{k} \Omega$ |  |  | $R_{E}=0$ |  |  |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: |
|  | $\beta_{\mathrm{dc}}$ | $I_{C}(\mathrm{~mA})$ | $V_{C}(\mathrm{~V})$ | $\beta_{\mathrm{dc}}$ | $I_{C}(\mathrm{~mA})$ | $V_{C}(\mathrm{~V})$ |
| 208 | 94.9 | 0.452 | 0.484 | 96.9 | 0.377 | 1.227 |
| 416.4 (nominal value) | 123 | 0.494 | 0.062 | 127 | 0.494 | 0.060 |
| 832 | 144 | 0.518 | $-0.183$ | 151 | 0.588 | $-0.878$ |

For the case without emitter degeneration, we will use $R_{E}=0$ in the schematic of Fig. B.75. Furthermore, to maintain the same $I_{C}$ and $V_{C}$ in both cases at the values obtained for nominal $B F$, we use $R_{B}=1.12 \mathrm{M} \Omega$ to limit $I_{C}$ to approximately 0.5 mA . The corresponding variations in the BJT bias
point are also shown in Table B.17. Accordingly, we see that emitter degeneration makes the bias point of the CE amplifier much less sensitive to changes in $\beta$. However, unless a large bypass capacitor $C_{E}$ is used, this reduced bias sensitivity comes at the expense of a reduction in gain (as we observed in this example when we simulated the transient response of the CE amplifier with an $R_{c e}=130 \Omega$ ).

# Example MS.8.1 

## The CMOS CS Amplifier

In this example, we will use Multisim to characterize the CMOS CS amplifier whose schematic capture is shown in Fig. B.78. We will assume a $0.18-\mu \mathrm{m}$ CMOS technology for the MOSFET and use typical SPICE level-1 model parameters for this technology as given in Table B.4. We will begin with an approximate hand-analysis design. We will then use Multisim to investigate the performance of the final design. The targeted specifications for this CMOS CS amplifier are a voltage gain $\left|G_{v}\right|=50 \mathrm{~V} / \mathrm{V}$ and a bias current $I_{D}$ of $100 \mu \mathrm{~A}$.

The amplifier specifications are summarized in Table B. 18 .

| Table B. 18 CMOS CS Amplifier Specifications |  |
| :-- | :-- |
| Specification | Value |
| $I_{D}$ | $100 \mu \mathrm{~A}$ |
| $\left\|G_{v}\right\|$ | $50 \mathrm{~V} / \mathrm{V}$ |
| $V_{D D}$ | 1.8 V |


| NMOS |  |
| :-- | :--: |
| Vtn | 0.5 V |
| IVAnl | 12.5 V |
| kn' | $246.2 \mathrm{uA} / \mathrm{V}^{\wedge} 2$ |
| I | 0.1 mA |
| L | 0.2 um |
| W | 0.523 um |
| PMOS |  |
| Vtp | -0.5 V |
| IVApl | 9 V |
| kp' | $-86.1 \mathrm{uA} / \mathrm{V}^{\wedge} 2$ |
| I | 0.1 mA |
| L | 0.2 um |
| W | 0.46 um |



Figure B. 78 Schematic capture of the CMOS CS amplifier.
Example MS.8.1 continued

# Hand Design 

For the design of this amplifier we choose $L=0.20 \mu \mathrm{~m}$, so that similar to Example MS.7.1, we have $L_{\text {eff }}=0.18 \mu \mathrm{~m}$. For this channel length, and in $0.18-\mu \mathrm{m}$ CMOS technology, the magnitudes of the Early voltages of the NMOS and PMOS transistors are $V_{A n}=12.5 \mathrm{~V}$ and $\left|A_{A p}\right|=9 \mathrm{~V}$, respectively. Therefore, the value of $V_{O V 1}$ can now be calculated as follows:

$$
\begin{aligned}
G_{v} & =-g_{m} R_{L}^{\prime}=-g_{m}\left(r_{o 1} \| r_{o 2}\right)=-\frac{2}{V_{O V 1}}\left(\frac{V_{A n}\left|V_{A p}\right|}{V_{A n}\left|V_{A p}\right|}\right) \\
V_{O V 1} & =-\frac{2}{G_{v}}\left(\frac{V_{A n}\left|V_{A p}\right|}{V_{A n}\left|V_{A p}\right|}\right)=-\frac{2}{(-50)}\left(\frac{12.5 \times 9}{12.5+9}\right) \simeq 0.21 \mathrm{~V}
\end{aligned}
$$

MOSFET 1 can now be sized (by ignoring the channel-length modulation) as

$$
\frac{W_{1}}{L_{\mathrm{eff}}}=\frac{I_{D}}{\frac{1}{2} k_{n}^{\prime} V_{O V 1}^{2}}=\frac{100 \times 10^{-6}}{\frac{1}{2} \times 246.2 \times 10^{-6} \times 0.21^{2}} \simeq 18.42
$$

where, as mentioned, $L_{\text {eff }}=0.180 \mu \mathrm{~m}$, and similar to Example MS.7.1, $k_{n}^{\prime}=246.2 \mu \mathrm{~A} / \mathrm{V}^{2}$. This yields $W_{1}=18.42 L_{\text {eff }}=3.32 \mu \mathrm{~m}$. To specify the dimensions of the MOSFETs in Multisim, we will use the multiplicative factor $m$; its default value is 1 , and it is used in SPICE to specify the number of MOSFETs connected in parallel. As depicted in Fig. B.79, a transistor with channel length $L$ and channel width $m \times W$ can be implemented using $m$ narrower transistors in parallel, each having a channel length $L$ and a channel width $W$. In this example, a unit-size NMOS transistor is used with $W_{1} / L_{1}=0.52 \mu \mathrm{~m} / 0.2 \mu \mathrm{~m}$. Thus, we find $m_{1}=3.32 / 0.52 \simeq 6$.


Aspect ratio of $m W / L$


Aspect ratio of each transistor $W / L$

Figure B. 79 Transistor equivalency.
Furthermore, MOSFETs 2 and 3 must be sized to have reasonably small $V_{O V}$ for the bias current $I_{D}$ of $100 \mu \mathrm{~A}$. This allows large signal-swing at the output of the amplifier. Similar to our previous approach, by choosing $\left|V_{O V 2}\right|=0.3 \mathrm{~V}$, and noting $\left|D_{D S, 2}\right| \simeq\left(V_{D D} / 2\right)=0.9 \mathrm{~V}$ (mid-rail voltage):

$$
\frac{W_{2}}{L_{\mathrm{eff}}}=\frac{I_{D}}{\frac{1}{2}\left|k_{p}^{\prime}\right| V_{O V 2}^{2}\left(1+\left|\lambda_{2}\right|\left|V_{D S, 2}\right|\right)}=\frac{100 \times 10^{-6}}{\frac{1}{2} \times 86.1 \times 10^{-6} \times 0.3^{2} \times(1+0.11 \times 0.9)} \simeq 23.5
$$
where $L_{\text {eff }}=0.18 \mu \mathrm{~m}$ and $\left|k_{b}^{\prime}\right|=86.1 \mu \mathrm{~A} / \mathrm{V}^{2}$. This yields $W_{2}=23.5 \times L_{\text {eff }}=4.23 \mu \mathrm{~m}$. In this example, unit-size PMOS transistors are used with $W_{2} / L_{2}=W_{3} / L_{3}=0.46 \mu \mathrm{~m} / 0.2 \mu \mathrm{~m}$. Thus, we find $m_{2}=m_{3}=$ $4.23 / 0.46 \simeq 9$.

# Simulation 

Amplifier Biasing Now our design can be verified using the simulation tool. The schematic is in Ch7_CMOS_CS_Amplifier_Ex_VTC.ms10. Based on the simulation results, $\left|G_{c}\right|=54 \mathrm{~V} / \mathrm{V}$ and $I_{D}=101 \mu \mathrm{~A}$. Therefore, the simulation results confirm that the designed CMOS CS amplifier meets the specifications.

DC Voltage Transfer Characteristic To compute the dc transfer characteristic of the CS amplifier, we perform a dc analysis in Multisim with $V_{\text {IN }}$ swept over the range 0 to $V_{D D}$ and plot the corresponding output voltage $V_{\text {OUT }}$.

Figure B.80(a) shows the resulting transfer characteristic. The slope of the VTC curve at $V_{G S 1}=0.71 \mathrm{~V}$ corresponds to the desired gain of the amplifier. To examine the high-gain region more closely, we repeat the dc sweep for $V_{\text {IN }}$ between 0.6 V and 0.8 V . The resulting transfer characteristic is plotted in Fig. B.80(b) (middle curve). Using the cursor of the Grapher in Multisim, we find that the linear region of this dc


Figure B. 80 (a) Voltage transfer characteristic of the CMOS CS amplifier.


Figure B. 80 (b) Expanded view of the transfer characteristics in the high-gain region for $W=W_{\text {nominal }} \pm 15 \%$.
transfer characteristic is bounded approximately by $V_{\mathrm{IN}}=0.698 \mathrm{~V}$ and $V_{\mathrm{IN}}=0.721 \mathrm{~V}$. The corresponding values of $V_{\text {OUT }}$ are 1.513 V and 0.237 V . These results are close to the expected values. Specifically, transistors $Q_{1}$ and $Q_{2}$ will remain in the saturation region and, hence, the amplifier will operate in its linear region if $V_{O V 1} \leq V_{\text {OUT }} \leq V_{D D}-\left|V_{O V 2}\right|$ or $0.21 \mathrm{~V} \leq V_{\text {OUT }} \leq 1.5 \mathrm{~V}$. From the results above, the voltage gain $G_{v}$ (i.e., the slope of the linear segment of the dc transfer characteristic) is approximately $-54 \mathrm{~V} / \mathrm{V}$, which exceeds but is reasonably close to the targeted gain.

Note, from the dc transfer characteristic in Fig. 80(b), that for an input dc bias of $V_{\mathrm{IN}}=0.710 \mathrm{~V}$, the output dc bias is $V_{\text {OUT }}=0.871 \mathrm{~V}$. This choice of $V_{\text {IN }}$ maximizes the available signal swing at the output by setting $V_{\text {OUT }}$ at approximately the middle of the linear segment of the dc transfer characteristic.

Using Transient Analysis to Verify $G_{v}$ This can be done by conducting transient response analysis, as set up in Ch7_CMOS_CS_Amplifier_Ex_gain.ms10. As can be seen from Fig. B.81, $\left|G_{v}\right| \simeq\left|A_{v}\right| \simeq$ $54 \mathrm{~V} / \mathrm{V}$.


Figure B. 81 $G_{c}$ of the CMOS CS amplifier (transient analysis).
Sensitivity to Process Variations Because of the high resistance at the output node (or, equivalently, because of the high voltage gain), the value of $V_{\text {OUT }}$ is highly sensitive to the effect of process and temperature variations on the characteristics of the transistors. To illustrate this point, consider what happens when the width of $Q_{1}$ (i.e., $W_{1}$ ) changes by $\pm 15 \%$. The corresponding dc transfer characteristics are shown in Fig. B.80(b). Accordingly, when $V_{\mathrm{IN}}=0.71 \mathrm{~V}, V_{\text {OUT }}$ will drop to 0.180 V if $W_{1}$ increases by $15 \%$, and will rise to 1.556 V if $W_{1}$ decreases by $15 \%$. In practical circuit implementations, this problem is alleviated by using negative feedback to accurately set the dc bias voltage at the output of the amplifier and, hence, to reduce the sensitivity of the circuit to process variations. We studied the topic of negative feedback in Chapter 11.

# Example MS.8.2 

## The Folded-Cascode Amplifier

In this example, we will use Multisim to design the folded-cascode amplifier whose schematic capture is shown in Fig. B.82. We will assume a $0.18-\mu \mathrm{m}$ CMOS technology for the MOSFET and use typical SPICE level-1 model parameters for this technology, excluding the intrinsic capacitance values. We will begin with an approximate hand-analysis design. We will then use Multisim to verify that the designed circuit meets the specifications. The targeted specifications for this folded-cascode amplifier are a dc gain
# Example MS.8.2 continued 

$\left|G_{c}\right|=100 \mathrm{~V} / \mathrm{V}$ and a bias current $I_{D}$ of $100 \mu \mathrm{~A}$. Note that while this design does not provide a very high gain, its bandwidth is large (see Chapter 10).

The amplifier specifications are summarized in Table B.19.


Figure B. 82 Schematic capture of the folded-cascode amplifier.

| Table B.19 Folded-Cascode Amplifier Specifications |  |
| :-- | :-- |
| Parameters | Value |
| $I_{D}$ | $100 \mu \mathrm{~A}$ |
| $\left\|G_{c}\right\|$ | $100 \mathrm{~V} / \mathrm{V}$ |
| $V_{D D}$ | 1.8 V |

## Hand Design

For the design of this amplifier we choose $L=200 \mu \mathrm{~m}$, so we have $L_{\text {eff }}=180 \mu \mathrm{~m}$. For this channel length, and in $0.18-\mu \mathrm{m}$ CMOS technology, the magnitudes of the Early voltages of the NMOS and PMOS transistors are $V_{A n}=12.5 \mathrm{~V}$ and $\left|V_{A p}\right|=9 \mathrm{~V}$, respectively.

The folded-cascode amplifier in Fig. B. 82 is equivalent to the one in Fig. 8.36, except that a current source is placed in the source of the input transistor $Q_{1}$ (for the same dc-biasing purpose as in the case of the CS amplifier). Note that in Fig. B.82, the PMOS current mirror $Q_{3}-Q_{4}$ and the NMOS current mirror $Q_{5}-Q_{6}$ are used to realize, respectively, current sources $I_{1}$ and $I_{2}$ in the circuit of Fig. 8.36. Furthermore, the current transfer ratio of mirror $Q_{3}-Q_{4}$ is set to 2 (i.e., $m_{3} / m_{4}=2$ ). This results in $I_{D 3} \simeq 2 I_{\text {ref }}$. Hence, transistor $Q_{2}$ is biased at $I_{D 2}-I_{D 3}-I_{D 1}=I_{\text {ref }}$.
The overall dc voltage gain of the folded-cascode amplifier under design can be expressed by using Eq. (8.73) as

$$
G_{v}=-g_{m 1} R_{\text {out }}
$$

where

$$
R_{\text {out }}=R_{\text {out } 2} \| R_{\text {out } 5}
$$

is the output resistance of the amplifier. Here, $R_{\text {out } 2}$ is the resistance seen looking into the drain of the cascode transistor $Q_{2}$, while $R_{\text {out } 5}$ is the resistance seen looking into the drain of the current mirror transistor $Q_{3}$. Using Eq. (8.93), we have

$$
R_{\text {out } 2} \simeq\left(g_{m 2} r_{o 2}\right) R_{S 2}
$$

where

$$
R_{S 2}=\left(r_{o 1} \| r_{o 2}\right)
$$

is the effective resistance at the source of $Q_{2}$. Furthermore,

$$
R_{\text {out } 5}=r_{o 5}
$$

Thus, for the folded-cascode amplifier in Fig. B.82,

$$
R_{\text {out }} \simeq r_{o 5}
$$

and

$$
G_{v}=-g_{m 1} r_{o 5}=-2 \frac{V_{A n}}{V_{O V 1}}
$$

Therefore, based on the given information, the value of $V_{O V 1}$ can be determined:

$$
V_{o v 1}=2 \frac{V_{A n}}{\left|G_{v}\right|}=2 \frac{12.5}{100}=0.25 \mathrm{~V}
$$

The gate bias voltage of transistor $Q_{2}$ is generated using the diode-connected transistors $Q_{3}$ and $Q_{8}$. The size and drain currents of these transistors are set equal to those of transistor $Q_{2}$. Therefore, ignoring the body effect,

$$
V_{G, 2}=V_{D D}-V_{S G, 7}-V_{S G, 8}=V_{D D}-2\left(\left|V_{i p}\right|+\left|V_{O V, P}\right|\right)
$$

where $V_{O V, P}$ is the overdrive voltage of the PMOS transistors in the amplifier circuit. Thus, such a biasing configuration results in $V_{S G, 2}=\left|V_{i p}\right|+\left|V_{O V, P}\right|=0.5+0.25=0.75 \mathrm{~V}$ as desired, while setting $V_{S D, 3}=\left|V_{i p}\right|+$ $\left|V_{O V, P}\right|=0.75 \mathrm{~V}$ to improve the bias matching between $Q_{3}$ and $Q_{4}$. For this example, all transistors are sized for an overdrive voltage of 0.25 V . Also, to simplify the design procedure, we ignore the channel-length modulation effect. As a result, using unit-size NMOS transistors with $W_{o} / L_{u}=0.48 \mu \mathrm{~m} / 0.2 \mu \mathrm{~m}$, and unit-size PMOS transistors with $W_{o} / L_{u}=0.64 \mu \mathrm{~m} / 0.2 \mu \mathrm{~m}$, the corresponding multiplicative factor $m$ for each transistor can be calculated by rounding to the nearest integer the value of $m$ :

$$
m=\frac{I_{D}}{\frac{1}{2} k\left(\frac{W}{L_{e f f}}\right) V_{O V}^{2}}
$$
# Example MS.8.2 continued 

Table B. 20 summarizes the relevant design information and the calculated $m$ values for each transistor.

| Transistor | $I_{D}(\mu \mathrm{~A})$ | $V_{O V}(\mathrm{~V})$ | $W(\mu \mathrm{~m})$ | $L_{\text {eff }}(\mu \mathrm{m})$ | $K\left(\mu \mathrm{~A} / \mathrm{V}^{2}\right)$ | $m$ |
| :-- | :-- | :-- | :-- | :-- | :-- | :-- |
| 1 | 100 | 0.25 | 0.48 | 0.18 | 246.2 | 5 |
| 2 | 100 | 0.25 | 0.64 | 0.18 | 86.1 | 10 |
| 3 | 200 | 0.25 | 0.64 | 0.18 | 86.1 | 20 |
| 4 | 100 | 0.25 | 0.64 | 0.18 | 86.1 | 10 |
| 5 | 100 | 0.25 | 0.48 | 0.18 | 246.2 | 5 |
| 6 | 100 | 0.25 | 0.48 | 0.18 | 246.2 | 5 |
| 7 | 100 | 0.25 | 0.64 | 0.18 | 86.1 | 10 |
| 8 | 100 | 0.25 | 0.64 | 0.18 | 86.1 | 10 |

## Simulation

Verifying $G_{v}$ Now our design can be verified by reading probes or conducting transient response analysis, as set up in Ch7_Folded_Cascode_Ex.ms10. Based on the simulation results, $\left|G_{v}\right|=102 \mathrm{~V} / \mathrm{V}$ (Fig. B.83) and $I_{D 1}=I_{D 2}=100 \mu \mathrm{~A}$. Therefore, the simulation results confirm that the designed folded-cascode amplifier meets the specifications.


Figure B. $83 G_{v}$ of the folded-cascode amplifier (transient analysis).
Sensitivity to Channel-Length Modulation In the hand design of this example, the channel-length modulation effect was ignored (except for the role of $r_{e S}$ in determining the gain). However, the simulation took the finite $r_{e}$ of each transistor into account. Furthermore, one can investigate the effect of changes in the Early voltages by modifying the value of lambda for each transistor in the design.# Example MS.9.1 

## The Two-Stage CMOS Op Amp

In this example, we will design the two-stage CMOS op amp whose schematic capture is shown in Fig. B.84. Once designed, the circuit's characteristics, such as the input common-mode range, the common-mode rejection ratio, the output-voltage range, and the input offset voltage will be evaluated.

The first stage is differential pair $Q_{1}-Q_{2}$ (which is actively loaded with the current mirror formed by $Q_{3}$ and $Q_{4}$ ), with bias current supplied by the current mirror formed by $Q_{8}$, and $Q_{5}$, which utilizes the reference bias current $I_{\text {REF }}$. The second stage consists of $Q_{6}$, which is a common-source amplifier actively loaded with the current source transistor $Q_{7}$.

For the design of this CMOS op amp, we will assume a $0.18-\mu \mathrm{m}$ CMOS technology for the MOSFETs and use typical SPICE level-1 model parameters for this technology, excluding the intrinsic capacitance values. We will begin with an approximate hand-analysis design. We will then use Multisim to verify that the implemented circuit meets the specifications. The targeted specifications for this op amp are a dc open-loop voltage gain $\left|A_{v}\right|=2500 \mathrm{~V} / \mathrm{V}$, with each of transistors $Q_{1}, Q_{2}, Q_{3}$, and $Q_{4}$ conducting a drain current of $100 \mu \mathrm{~A}$.

| NMOS |  |
| :--: | :--: |
| Vin | 0.5 V |
| iVAnt | 12.5 V |
| $\mathrm{kn}^{\prime}$ | $246.2 \mu \mathrm{~A} / \mathrm{V}^{*} 2$ |
| IREF | 0.2 mA |
| L | 0.2 um |
| W | 0.48 um |
| PMOS |  |
| Vtp | -0.5 V |
| iVApt | 9 V |
| kp | $-86.1 \mu \mathrm{~A} / \mathrm{V}^{*} 2$ |
| IREF | 0.1 mA |
| L | 0.2 um |
| W | 0.64 um |



Figure B. 84 Schematic capture of the two-stage CMOS op amp.
To achieve the targeted specifications, a biasing current $I_{\text {REF }}=200 \mu \mathrm{~A}$ is used, and the transistors $Q_{5}, Q_{6}, Q_{7}$, and $Q_{8}$ will be sized so that they conduct the drain current of $200 \mu \mathrm{~A}$. Also, the open-loop voltage gain for this design is the product of the voltage gains of the two stages. Accordingly, each stage is designed to contribute a voltage gain of $-50 \mathrm{~V} / \mathrm{V}$, so as to achieve the specified open-loop voltage gain.

The amplifier specifications are summarized in Table B. 21.
Example MS.9.1 continued

| Parameter | Value |
| :-- | :-- |
| $I_{(Q 1, Q 2, Q 3, \text { and } Q 4)}$ | $100 \mu \mathrm{~A}$ |
| $I_{(Q 5, Q 6, Q 7, \text { and } Q 8)}$ | $200 \mu \mathrm{~A}$ |
| $\left\|A_{1}\right\|$ | $50 \mathrm{~V} / \mathrm{V}$ |
| $\left\|A_{2}\right\|$ | $50 \mathrm{~V} / \mathrm{V}$ |
| $V_{D D}$ | 1 V |
| $V_{S S}$ | -1 V |

Hand Design For the design of this amplifier we choose $L=0.200 \mu \mathrm{~m}$, so we have $L_{o E}=0.180 \mu \mathrm{~m}$. For this channel length, and in $0.18-\mu \mathrm{m}$ CMOS technology, the magnitudes of the Early voltages of the NMOS and PMOS transistors are $V_{A n}=12.5 \mathrm{~V}$ and $\left\|V_{A p}\right\|=9 \mathrm{~V}$.

The two-stage CMOS op amp in Fig. B. 84 is equivalent to the one in Fig. 9.40, except that the first stage is an NMOS differential amplifier and the second stage is a PMOS common source. Note that the differential voltage gain of the first stage can be expressed using Eq. (9.37) as:

$$
A_{1}=-g_{m 1}\left(r_{o 2} \| r_{o 4}\right)
$$

Hence,

$$
A_{1}=-\frac{2}{V_{O V 1}}\left(\frac{V_{A n}\left\|V_{A p}\right\|}{V_{A n}+\left\|V_{A p}\right\|}\right)
$$

resulting in

$$
V_{O V 1}=-\frac{2}{A_{1}}\left(\frac{V_{A n}\left\|V_{A p}\right\|}{V_{A n}+\left\|V_{A p}\right\|}\right)=-\frac{2}{(-50)}\left(\frac{12.5 \times 9}{12.5+9}\right) \simeq 0.21 \mathrm{~V}
$$

Also, the voltage gain of the second stage is provided by Eq. (9.37) as

$$
A_{2}=-g_{m 6}\left(r_{o 6} \| r_{o 7}\right)
$$

Therefore,

$$
A_{2}=-\frac{2}{V_{O V 6}}\left(\frac{V_{A n}\left\|V_{A p}\right\|}{V_{A n}+\left\|V_{A p}\right\|}\right)
$$

resulting in

$$
V_{O V 6}=-\frac{2}{A_{2}}\left(\frac{V_{A n}\left\|V_{A p}\right\|}{V_{A n}+\left\|V_{A p}\right\|}\right)=-\frac{2}{(-50)}\left(\frac{12.5 \times 9}{12.5+9}\right) \simeq 0.21 \mathrm{~V}
$$

For this example, all transistors are sized for an overdrive voltage of 0.21 V . Furthermore, to simplify the design procedure, we ignore the channel-length modulation effect. As a result, using unit-size NMOS transistors with $W_{a} / L_{n}=0.64 \mu \mathrm{~m} / 0.2 \mu \mathrm{~m}$, and unit-size PMOS transistors with $W_{a} / L_{n}=0.48 \mu \mathrm{~m} / 0.2 \mu \mathrm{~m}$, the corresponding multiplicative factor $m$ for each transistor can be calculated by rounding to the nearest
integer value which is calculated as $m$ :

$$
m=\frac{I_{D}}{\frac{1}{2} k\left(\frac{W}{L_{\text {eff }}}\right) V_{O V}^{2}}
$$

Table B. 22 summarizes the relevant information and the calculated $m$ values for each transistor.

| Transistor | Transistor | $I_{D}(\mu \mathrm{~A})$ | $V_{O V}(\mathrm{~V})$ | $W(\mu \mathrm{~m})$ | $L_{\text {eff }}(\mu \mathrm{m})$ | $k^{\prime}\left(\mu \mathrm{A} / \mathrm{V}^{2}\right)$ | $m$ |
| :-- | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| 1 | 100 | 0.21 | 0.48 | 0.18 | 246.2 | 7 |  |
| 2 | 100 | 0.21 | 0.48 | 0.18 | 246.2 | 7 |  |
| 3 | 100 | 0.21 | 0.64 | 0.18 | 86.1 | 15 |  |
| 4 | 100 | 0.21 | 0.64 | 0.18 | 86.1 | 15 |  |
| 5 | 200 | 0.21 | 0.48 | 0.18 | 246.2 | 14 |  |
| 6 | 200 | 0.21 | 0.64 | 0.18 | 86.1 | 30 |  |
| 7 | 200 | 0.21 | 0.48 | 0.18 | 246.2 | 14 |  |
| 8 | 200 | 0.21 | 0.48 | 0.18 | 246.2 | 14 |  |

# Simulation 

Verifying $A$. Now our design can be verified by reading probes, as set up in Ch8_Two_Stage_Op_ Amp_Ex.ms10. Based on the simulation results we read $\left|A_{1}\right|=57 \mathrm{~V} / \mathrm{V},\left|A_{2}\right|=58.6 \mathrm{~V} / \mathrm{V},\left|A_{v}\right|=3340 \mathrm{~V} / \mathrm{V}$, $I_{(Q 1, Q 2, Q 3, \text { and } Q 4)}=97 \mu \mathrm{~A}, I_{Q 5}=194 \mu \mathrm{~A}, I_{(Q 6, Q 7)}=202 \mu \mathrm{~A}$, and $I_{Q 8}=200 \mu \mathrm{~A}$. These values are somewhat different from the targeted specifications. The deviations can be attributed to the fact that we rounded the values of $m$ to the nearest integer and ignored the effect of channel-length modulation, that is, the term $\left(1+\lambda V_{D S}\right)$, when calculating the multiplicative factor. To get closer to our targeted specifications, we may use the obtained $V_{D S}$ values for each transistor, from the original design, to estimate new multiplicative factor values by taking the term $\left(1+\lambda V_{D S}\right)$ into account. Table B. 23 shows the revised multiplicative factor values.

| Transistor | $m$ |
| :-- | --: |
| 1 | 6 |
| 2 | 6 |
| 3 | 14 |
| 4 | 14 |
| 5 | 13 |
| 6 | 26 |
| 7 | 13 |
| 8 | 13 |

The revised design is evaluated by reading probes, as set up in Ch8_Two_Stage_Op_Amp_ revised_Ex.ms10. The simulation results show $\left|A_{1}\right|=54 \mathrm{~V} / \mathrm{V},\left|A_{2}\right|=58.2 \mathrm{~V} / \mathrm{V},\left|A_{v}\right|=3145 \mathrm{~V} / \mathrm{V}$,
Example MS.9.1 continued
$I_{(Q 1, Q 2, Q 3 \text { and } Q 4)}=103 \mu \mathrm{~A}, I_{Q 5}=206 \mu \mathrm{~A}, I_{(Q 6, Q 7)}=205 \mu \mathrm{~A}$, and $I_{Q 8}=200 \mu \mathrm{~A}$, from which we see that the voltage gains are closer to the targeted specifications.

One should note that the discrepancies between the hand-design and simulation results in this simulation example are more apparent because errors in each stage add up.

Next, we will explore some important characteristics of the designed two-stage CMOS op amp.
Input Common-Mode Range The upper limit of the input common-mode range is the value of input voltage at which $Q_{1}$ and $Q_{2}$ leave the saturation region. This occurs when the input voltage exceeds the drain voltage of $Q_{1}$ by $V_{i n}=0.5 \mathrm{~V}$. Since the drain of $Q_{1}$ is at $1-(0.21+0.5)=0.29 \mathrm{~V}$, then the upper limit of the input common-mode range is $v_{I C M \max }=0.29+0.5=0.79 \mathrm{~V}$.

The lower limit of the input common-mode range is the value of input voltage at which $Q_{5}$ leaves the saturation region. Since for $Q_{5}$ to operate in saturation the voltage across it (i.e., $V_{D S 5}$ ) should at least be equal to the overdrive voltage at which it is operating (i.e., 0.21 V ), the highest voltage permitted at the drain of $Q_{5}$ should be -0.79 V . It follows that the lowest value of $v_{I C M}$ should be $v_{I C M \min }=-0.08 \mathrm{~V}$.

To verify the results using the simulation tool, we swept the input common-mode voltage $v_{I C M}$ from -1 V to 1 V and plotted the resulting $v_{G D}$ of $Q_{1}$ and $Q_{5}$ (as set up in Ch8_Two_Stage_Op_Amp_ Ex_CM_Range.ms10). As can be seen from Fig. B.85, both transistors $Q_{1}$ and $Q_{5}$ stay in saturation for the input common-mode range of $-0.08 \mathrm{~V} \leq v_{I C M} \leq 0.79 \mathrm{~V}$, as indicated by cursors.


Figure B. 85 Input common-mode range of the two-stage CMOS op amp.
Common-Mode Rejection Ratio (CMRR) of the First Stage The value of the CMRR of the first stage (the active-loaded MOS differential amplifier) is determined from Eq. (8.147). Note that the value of $R_{S S}$ in the provided equation corresponds to the output resistance of $Q_{5}$ (i.e., $r_{o 5}$ ). Thus,

$$
\mathrm{CMRR} \equiv \frac{\left|A_{1}\right|}{\left|A_{c m}\right|}=\frac{50}{1 / 2 g_{m 3} r_{o 5}}=100 g_{m 3} r_{o 5}=100 \frac{2 \times 100 \times 10^{-6}}{0.21} \frac{12.5}{200 \times 10^{-6}}=5952.4=75.5 \mathrm{~dB}
$$
Using the simulation tool, the value of CMRR is calculated by dividing the previously obtained $A_{1}$ value ( $54 \mathrm{~V} / \mathrm{V}$ ) by the common-mode gain of the first stage as measured in Ch8_Two_Stage_Op_Amp_ Ex_CMRR.ms10. This yields

$$
\mathrm{CMRR} \equiv \frac{\left|A_{1}\right|}{\left|A_{c m}\right|}=\frac{54}{78 \times 10^{-3}}=6923=76.8 \mathrm{~dB}
$$

Output Voltage Range The lowest allowable output voltage is the value at which $Q_{z}$ leaves the saturation region, which is $-V_{S S}+V_{O V 7}=-1+0.21=0.79 \mathrm{~V}$. The highest allowable output voltage is the value at which $Q_{\mathrm{s}}$ leaves saturation, which is $V_{D D}-\left|-V_{O V 6}\right|=1-0.21=0.79 \mathrm{~V}$. Thus, the output-voltage range is -0.79 V to 0.79 V .

As set up in Ch8_Two_Stage_Op_Amp_Ex_Output_Range.ms10, to verify the calculated output voltage range, we swept the input voltage from -2 mV to 2 mV (we used a small input voltage due to high gain). As can be seen from Fig. B.86, the output level changes from -0.795 V to 0.784 V , a rather symmetrical range. Therefore, the simulation results confirm our hand-analysis calculations.


Figure B. 86 Output-voltage range of the two-stage CMOS op amp.

Input Offset Voltage Although, theoretically, there should be no systematic offset, we do observe an output offset voltage $V_{O}$. As defined by Eq. 9.97, the input offset voltage, $V_{O S}$, can be obtained as

$$
V_{O S}=\frac{V_{O}}{A_{v}}
$$


Figure B. 87 Input offset voltage of the two-stage CMOS op amp.
Equivalently, if we apply a voltage $-V_{O S}$ between the input terminals of the differential amplifier, the output voltage should be reduced to zero. This equivalency can be verified using the simulation tool (Ch8_Two_Stage_Op_Amp_Ex_Output_Range.ms10). When both the input terminals are grounded, the probe at the output reads the dc voltage 0.574 V . Also, when we apply the voltage $V_{O S}=(0.574 / 3145) \simeq$ $183 \mu \mathrm{~V}$, between the input terminals, the output voltage is reduced to zero (Fig. B.87). Hence, the op amp has an input offset voltage of $V_{O S}=195 \mu \mathrm{~V}$, which approximately corresponds to an output offset voltage of $V_{O}=0.574 \mathrm{~V}$.

# Example MS. 10.1 

## Frequency Response of the Discrete CS Amplifier

In this example, we will investigate the frequency response of the CS amplifier of Example MS.7.1. By using Multisim to perform "ac analysis" on the designed CS amplifier, we are able to measure the midband gain $A_{M}$ and the $3-\mathrm{dB}$ frequencies $f_{L}$ and $f_{H}$, and to plot the output-voltage magnitude (in dB ) versus frequency. Figure B. 88 shows the schematic capture of the CS amplifier.


Figure B. 88 Schematic capture of discrete CS amplifier.

# Hand Analysis 

Midband Gain The midband gain of this CS amplifier can be determined using Eq. (10.10) as follows:

$$
\begin{aligned}
A_{M} & =\frac{R_{\mathrm{in}}}{R_{\mathrm{in}}+R_{\mathrm{sig}}}\left[g_{m}\left(R_{D} \| R_{L}\right)\right] \\
R_{\mathrm{in}} & =\left(R_{G 1} \| R_{G 2}\right)=852.5 \times 10^{3} \| 947.5 \times 10^{3}=448.75 \times 10^{3} \Omega \\
g_{m} & =3.33 \mathrm{~mA} / \mathrm{V} \\
A_{M} & =\frac{448.75 \times 10^{3}}{448.75 \times 10^{3}+10 \times 10^{3}}\left[3.33 \times 10^{-3}\left(3.41 \times 10^{3} \| 50 \times 10^{3}\right)\right] \simeq 10 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

Low-Frequency Poles and Zero We know from Section 10.1.1 that the low-frequency poles are as follows:

$$
\begin{aligned}
& f_{P 1}=\frac{1}{2 \pi \times C_{C I}\left(R_{\mathrm{sig}}+R_{\mathrm{in}}\right)}=\frac{1}{2 \pi \times 10 \times 10^{-6}\left[\left(10 \times 10^{3}\right)+448.75 \times 10^{3}\right]} \\
& f_{P 1}=0.0347 \mathrm{~Hz} \\
& f_{P 2}=\frac{1}{2 \pi \times C_{C O}\left(R_{D}+R_{L}\right)}=\frac{1}{2 \pi \times 10 \times 10^{-6}\left(3.41 \times 10^{3}\right)+\left(50 \times 10^{3}\right)} \\
& f_{P 2}=0.30 \mathrm{~Hz} \\
& f_{P 3}=\frac{1}{2 \pi \times C_{S}}\left(g_{m}+\frac{1}{R_{S}}\right)=\frac{1}{2 \pi \times 10 \times 10^{-6}}\left[\left(3.33 \times 10^{-3}\right)+\frac{1}{1.39 \times 10^{3}}\right] \\
& f_{P 3}=64.4 \mathrm{~Hz}
\end{aligned}
$$

And the location of the real transmission zero is determined as

$$
\begin{aligned}
& f_{Z}=\frac{1}{2 \pi \times C_{S} R_{S}}=\frac{1}{2 \pi \times\left(10 \times 10^{-6}\right)\left(1.39 \times 10^{3}\right)} \\
& f_{Z}=11.45 \mathrm{~Hz}
\end{aligned}
$$
# Example MS.10.1 continued 

Upon observing the relative magnitude of each of the poles, we can conclude that $f_{P 3}$ will determine $f_{L}$, the lower 3-dB frequency of the amplifier gain,

$$
f_{L} \simeq f_{P 3} \simeq 11.45 \mathrm{~Hz}
$$

High-Frequency Rolloff The high-frequency rolloff of the amplifier gain is caused by the MOSFET internal capacitance. The typical values for $0.180 \mu \mathrm{~m}$ CMOS technology are given in Table B.4. We know from Eq. (10.53) in Section 10.2 that

$$
\begin{aligned}
f_{H} & =\frac{1}{2 \pi \times C_{\text {in }} R_{\text {sig }}^{\prime}} \\
R_{\text {sig }}^{\prime} & =10 \times 10^{3} \| 448.75 \times 10^{3}=9.78 \times 10^{3} \\
C_{\text {in }} & =W\left\{C_{\text {gel } 1}+C_{\text {gel } 0}\left[1+g_{m}\left(R_{L} \| R_{L}\right)\right]\right\}
\end{aligned}
$$

Note that $C_{\text {gel } 0}$ and $C_{\text {gel } 0}$ are per-unit-width values provided in the models.

$$
\begin{aligned}
C_{\text {in }} & =\left(15.48 \times 10^{-6}\right) \times\left(0.3665 \times 10^{-9}\right) \times\left[1+1+3.33 \times 10^{-3}\left(50 \times 10^{3} \| 3.41 \times 10^{-3}\right)\right] \\
C_{\text {in }} & =0.716 \mathrm{fF} \\
f_{H} & =\frac{1}{2 \pi \times 0.716 \times 10^{-15} \times 9.78 \times 10^{3}} \\
f_{H} & \simeq 191 \mathrm{MHz}
\end{aligned}
$$

Now we can determine the bandwidth, $B W$, of the CS amplifier:

$$
\begin{aligned}
& B W=f_{H}-f_{L} \\
& B W \simeq f_{H}=191 \mathrm{MHz}
\end{aligned}
$$

## Simulation

Figure B. 89 shows the magnitude plot of the frequency response of this CS amplifier.


Figure B. 89 Frequency response of the CS amplifier.


Figure B. 90 Frequency response of the CS amplifier with $C_{S}=10 \mu \mathrm{~F}$ and $C_{S}=0$.
Based on the simulation results, the midband gain is $A_{M}=9.80 \mathrm{~V} / \mathrm{V}$. Also, $f_{L}=60.8 \mathrm{~Hz}$ and $f_{H}=$ 192.2 MHz , resulting in 3-dB bandwidth of $B W=f_{L}-f_{H}=192.2 \mathrm{MHz}$. Figure B. 89 further shows that (moving toward the left) the gain begins to fall off at about 300 Hz , but flattens out again at about 12.2 Hz . This flattening in the gain at low frequencies is due to a real transmission zero introduced in the transfer function of the amplifier by $R_{S}$ together with $C_{S}$, with a frequency $f_{Z}-=1 / 2 \pi R_{S} C_{S}=11.45 \mathrm{~Hz}$. Students are encouraged to investigate this relationship by using the simulation tool to modify the values of $R_{S}$ and $C_{S}$ and observing the corresponding change in the zero frequency. Note this value of zero is typically between the break frequencies $f_{P 2}$ and $f_{P 3}$. The simulation is set up in Ch9_CS_Amplifier_Ex.ms10.

We can further verify this phenomenon by resimulating the CS amplifier with a $C_{S}=0$ (i.e., removing $C_{S}$ ) in order to move $f_{Z}$ to infinity and remove its effect. The corresponding frequency response is plotted in Fig. B.90. As expected with $C_{S}=0$, we do not observe any flattening in the low-frequency response of the amplifier. However, because the CS amplifier now includes a source resistor $R_{S}$, the value of $A_{M}$ has dropped by a factor of 5.4. This factor is approximately equal to $\left(1+g_{m} R_{S}\right)$, as expected from our study of the CS amplifier with a source-degeneration resistance. Note that the bandwidth $B W$ has increased by approximately the same factor as the drop in gain $A_{M}$. As we learned in Chapter 11 in our study of negative feedback, the source-degeneration resistor $R_{S}$ provides negative feedback, which allows us to trade off gain for a wider bandwidth.

# Example MS. 10.2 

## The Frequency Response of CMOS CS Amplifier and the Folded-Cascode Amplifier

In this example, we will investigate the frequency response of the CMOS CS amplifier and the folded-cascode amplifier studied in Examples MS.8.1 and MS.8.2. The circuit diagram of the CMOS CS amplifier is given in Fig. B.91.
# Example MS.10.2 continued 

By using Multisim to perform "ac analysis" on the designed CMOS CS amplifier, we are able to measure the midband gain $A_{M}$ and the 3-dB frequency $f_{H}$, and to plot the output-voltage magnitude (in dB) versus frequency for two different cases of $R_{\text {sig }}(100 \Omega$ and $1 \mathrm{M} \Omega)$, as shown in Fig. B. 92 .

Observe that $f_{H}$ decreases when $R_{\text {sig }}$ is increased. This is anticipated from our study of the high-frequency response of the CS amplifier. Specifically, as $R_{\text {sig }}$ increases, the pole

$$
f_{p, \text { in }}=\frac{1}{2 \pi} \frac{1}{R_{\text {sig }} C_{\text {in }}}
$$

formed at the amplifier input will have an increasingly significant effect on the overall frequency response of the amplifier. As a result, the effective time constant $\tau_{H}$ increases and $f_{H}$ decreases. When $R_{\text {sig }}$ becomes very large, as it is when $R_{\text {sig }}=1 \mathrm{M} \Omega$, a dominant pole is formed by $R_{\text {sig }}$ and $C_{\text {in }}$. This results in

$$
f_{H} \simeq f_{p, \text { in }}
$$

To estimate $f_{p, \text { in }}$, we need to calculate the input capacitance $C_{\text {in }}$ of the amplifier. Using Miller's theorem, we have

$$
C_{\text {in }}=C_{g s 1}+C_{g s 1}\left(1+g_{m 1} R_{L}^{\prime}\right)
$$

where

$$
R_{L}^{\prime}=r_{o 1} \| r_{o 2}
$$

The value of $C_{\text {in }}$ can be calculated by using the overlap capacitances $C_{g s, o v 1}$ and gate-to-channel $C_{g s}$ and $C_{g d, o v 1}$ as follows:

$$
\begin{aligned}
& C_{g s, o v_{1}}=m_{1} W_{1} C G S O=\left(5 \times 0.48 \times 10^{-6}\right) \times\left(0.3665 \times 10^{-9}\right)=0.880 \mathrm{fF} \\
& C_{g d, o v_{1}}=m_{1} W_{1} C G D O=\left(5 \times 0.48 \times 10^{-6}\right) \times\left(0.3665 \times 10^{-9}\right)=0.880 \mathrm{fF}
\end{aligned}
$$

For $C_{g s}$, we write

$$
\begin{aligned}
C_{g s_{\text {out,channel }}} & =\frac{2}{3} m_{1} W_{1} L C_{o s}=\frac{2}{3}\left[\left(5 \times 0.48 \times 10^{-6}\right) \times\left(0.18 \times 10^{-6}\right)\left(\frac{3.9 \times 8.85 \times 10^{-12}}{4.08 \times 10^{-9}}\right)\right] \\
C_{g s_{\text {out,channel }}} & =2.48 \mathrm{fF} \\
C_{g s} & =2.48 \mathrm{fF}+0.880 \mathrm{fF}=3.36 \mathrm{fF}
\end{aligned}
$$

This results in $C_{\text {in }}=45.78 \mathrm{fF}$ when $\left\|G_{v}\right\|=50 \mathrm{~V} / \mathrm{V}$. Accordingly,

$$
f_{H} \simeq \frac{1}{2 \pi} \frac{1}{1 \times 10^{6} \times 43.3 \times 10^{-15}}=3.48 \mathrm{MHz}
$$

which is close to the value computed by Multisim (i.e., $f_{H}=3.66 \mathrm{MHz}$ ).| NMOS |  |
| :-- | :--: |
| Vm | 0.5 V |
| IVAnl | 12.5 V |
| $\mathrm{kn}^{\prime}$ | $246.2 \mathrm{uA} / \mathrm{V}^{\wedge} 2$ |
| IREF | 0.1 mA |
| L | 0.2 um |
| W | 0.48 um |
| PMOS |  |
| Vip | -0.5 V |
| IVApl | 9 V |
| $\mathrm{kp}^{\prime}$ | $-86.1 \mathrm{uA} / \mathrm{V}^{\wedge} 2$ |
| IREF | 0.1 mA |
| L | 0.2 um |
| W | 0.64 um |



Figure B. 91 Schematic capture of the CMOS CS amplifier.


Figure B. 92 Frequency response of the CMOS CS amplifier with $R_{\text {sig }}=100 \Omega$ and $R_{\text {sig }}=1 \mathrm{M} \Omega$.
# Example MS.10.2 continued 

The Folded-Cascode Amplifier Next, we will investigate the frequency response of the folded-cascode amplifier and compare its performance with that of the CS amplifier. Figure B. 93 shows the circuit diagram of the folded-cascode amplifier.


Figure B. 93 Schematic capture of the folded-cascode amplifier.
Figure B. 94 shows the frequency response of the folded-cascode amplifier as simulated by Multisim for the cases of $R_{\text {sig }}=100 \Omega$ and $1 \mathrm{M} \Omega$. The corresponding values of the $3-\mathrm{dB}$ frequency $f_{H}$ of the amplifier are given in Table B. 24 .


Figure B. 94 Frequency response of the folded-cascode amplifier with $R_{\text {sig }}=100 \Omega$ and $R_{\text {sig }}=1 \mathrm{M} \Omega$.
| Table B. 24 Dependence of $f_{H}$ for the Designed Amplifiers |  |  |
| :-- | :-- | :-- |
|  | $f_{H}$ |  |
| $R_{\text {sig }}$ | CS Amplifier | Folded-Cascode Amplifier |
| $100 \Omega$ | 510.7 MHz | 296.2 MHz |
| $1 \mathrm{M} \Omega$ | 3.39 MHz | 24.0 MHz |

First, note that for the designed folded-cascode amplifier, $R_{\text {out }}=125 \mathrm{k} \Omega$ and $\left|G_{v}\right|=100 \mathrm{~V} / \mathrm{V}$. Thus, $R_{\text {out }}$ and $G_{v}$ are larger than those of the CS amplifier (by a factor of 2 ). Note that these calculations can be found in Examples MS.8.1 and MS.8.2.

Also, observe that when $R_{\text {sig }}$ is small, $f_{H}$ of the folded-cascode amplifier is lower than that of the CS amplifier by a factor of about 1.8 , approximately equal to the factor by which the gain is increased. This is because when $R_{\text {sig }}$ is small, the frequency response of both amplifiers is dominated by the pole formed at the output node, that is,

$$
f_{H} \simeq f_{p, \text { out }}=\frac{1}{2 \pi} \frac{1}{R_{\text {out }} C_{\text {out }}}
$$

Now the output resistance of the folded-cascode amplifier is larger than that of the CS amplifier, while their output capacitances are approximately equal. Therefore, the folded-cascode amplifier has a lower $f_{H}$ in this case.

On the other hand, when $R_{\text {sig }}$ is large, $f_{H}$ of the folded-cascode amplifier is much higher than that of the CS amplifier. This is because in this case, the effect of the pole at $f_{p, \text { in }}$ on the overall frequency response of the amplifier becomes dominant. Since, owing to the Miller effect, $C_{\text {in }}$ of the CS amplifier is much larger than that of the folded-cascode amplifier, its $f_{H}$ is much lower.

To confirm this point, observe that $C_{\text {in }}$ of the folded-cascode amplifier can be estimated by replacing $R_{L}^{\prime}$ in the equation used to compute $C_{\text {in }}$ for the CS amplifier, with the total resistance $R_{d 1}$, between the drain of $Q_{1}$ and ground. Here,

$$
R_{d 1}=r_{01}\left\|r_{01}\right\| R_{\mathrm{in} 2}
$$

where $R_{\text {in } 2}$ is the input resistance of the common-gate transistor $Q_{2}$ and can be obtained using an approximation of the relationship found for input resistance of the common-gate amplifier:

$$
R_{\mathrm{in} 2} \simeq \frac{r_{o 2}+r_{o 3}}{g_{m 2} r_{o 2}}
$$

Thus,

$$
R_{d 1} \simeq r_{o 1}\left\|r_{o 3}\right\| \frac{r_{o 2}+r_{o 3}}{g_{m 2} r_{o 2}}=\frac{2}{g_{m 2}}
$$

Therefore, $R_{d 1}$ is much smaller than $R_{L}^{\prime}$ (in the CS amplifier $\simeq r_{o 1}\left\|r_{o 3}\right.$ ). Hence, $C_{\text {in }}$ of the designed folded-cascode amplifier is indeed much smaller than that of the CS amplifier because the ( $1+g_{m} R^{\prime}$ ) multiplier is smaller for the folded-cascode device. This confirms that the folded-cascode amplifier is much less impacted by the Miller effect and, therefore, can achieve a much higher $f_{H}$ when $R_{\text {sig }}$ is large.

The midband gain of the folded-cascode amplifier can be significantly increased by replacing the current mirror $Q_{5}-Q_{6}$ with a current mirror having a larger output resistance, such as the cascode current mirror in Fig. 8.32, whose output resistance is approximately $g_{m} r_{o 2}$. In this case, however, $R_{\text {in } 2}$ and, hence, $R_{d 1}$ increase, causing an increased Miller effect and a corresponding reduction in $f_{H}$.
Example MS.10.2 continued
Finally, it is interesting to observe that the frequency response of the folded-cascode amplifier shown in Fig. B. 94 drops beyond $f_{H}$ at approximately $-20 \mathrm{~dB} /$ decade when $R_{\text {sig }}=100 \Omega$ and at approximately $-40 \mathrm{~dB} /$ decade when $R_{\text {sig }}=1 \mathrm{M} \Omega$. This is because when $R_{\text {sig }}$ is small, the frequency response is dominated by the pole at $f_{p, \text { out }}$. However, when $R_{\text {sig }}$ is increased, $f_{p, \text { in }}$ is moved closer to $f_{p, \text { out }}$, and both poles contribute to the gain falloff.

# Example MS.11.1 

## A Two-Stage CMOS Op Amp with Series-Shunt Feedback

In this example, we will investigate the effect of applying a series-shunt feedback to the two-stage CMOS op amp whose schematic capture is shown in Fig. B. 95 .

The first stage is a differential pair $Q_{1}-Q_{2}$ (which is actively loaded with the current mirror formed by $Q_{3}$ and $Q_{4}$ ) with bias current supplied by a current mirror formed by $Q_{8}$ and $Q_{5}$, which utilizes the reference bias current $I_{\text {REF }}$. The second stage consists of $Q_{6}$, which is a common-drain amplifier actively loaded with a current source load (transistor $Q_{7}$ ).

For the implementation of this CMOS op amp, we will use a $0.18-\mu \mathrm{m}$ CMOS technology for the MOSFETs and typical SPICE level-1 model parameters for this technology, including the intrinsic capacitance values. The targeted specifications are an unloaded dc open-loop voltage gain $\left|A_{v}\right|=50 \mathrm{~V} / \mathrm{V}$,

| NMOS |  |
| :--: | :--: |
| Vtn | 0.5 V |
| IVAnl | 12.5 V |
| $\mathrm{kn}^{\prime}$ | $246.2 \mathrm{uA} / \mathrm{V}^{\wedge} 2$ |
| L | 0.2 um |
| W | 0.48 um |
|  |  |
| PMOS |  |
| Vtp | -0.5 V |
| IVApl | 9 V |
| $\mathrm{kp}^{\prime}$ | $-86.1 \mu \mathrm{~A} / \mathrm{V}^{\wedge} 2$ |
| L | 0.2 um |
| W | 0.64 um |



Figure B. 95 Schematic capture of the two-stage CMOS op amp.
and closed-loop voltage gain $\left|A_{f}\right|=10 \mathrm{~V} / \mathrm{V}$, with each of transistors $Q_{1}, Q_{2}, Q_{3}$, and $Q_{4}$ biased at a drain current of $100 \mu \mathrm{~A}$.

To achieve the targeted specifications, a biasing current $I_{\mathrm{REF}}=200 \mu \mathrm{~A}$ is used, and the transistors $Q_{5}, Q_{6}, Q_{7}$, and $Q_{8}$ will be sized to conduct drain currents of $200 \mu \mathrm{~A}$. The dc open-loop voltage gain for this amplifier is the product of the voltage gains of the two stages. Since the gain of the second stage (source follower) is approximately $1 \mathrm{~V} / \mathrm{V}$, the first stage must be designed to provide the full voltage gain of $50 \mathrm{~V} / \mathrm{V}$ to achieve the specified open-loop voltage gain.

The amplifier specifications are summarized in Table B. 25 .

| Parameters | Value |
| :-- | :-- |
| $I_{(Q 1, Q 2, Q 3, \text { and } Q 4)}$ | $100 \mu \mathrm{~A}$ |
| $I_{(Q 5, Q 6, Q 7, \text { and } Q 8)}$ | $200 \mu \mathrm{~A}$ |
| $\left\|A_{1}\right\|$ | $50 \mathrm{~V} / \mathrm{V}$ |
| $\left\|A_{2}\right\|$ | $1 \mathrm{~V} / \mathrm{V}$ |
| $\left\|A_{f}\right\|$ | $10 \mathrm{~V} / \mathrm{V}$ |
| $V_{D D}$ | 1 V |
| $V_{S S}$ | -1 V |

# Hand Design 

Design of the Two-Stage Op Amp The first stage of this CMOS op amp is identical to the first stage of the op amp we designed in Example MS.9.1, to which the reader is referred. Also, transistors $Q_{6}$ and $Q_{7}$ are sized to provide the bias current of $200 \mu \mathrm{~A}$ in the second stage.

As a result, using unit-size NMOS transistors with $W_{n} / L_{n}=0.48 \mu \mathrm{~m} / 0.20 \mu \mathrm{~m}$, and unit-size PMOS transistors with $W_{n} / L_{p}=0.64 \mu \mathrm{~m} / 0.20 \mu \mathrm{~m}$, the corresponding multiplicative factor m for each transistor can be calculated as found in Example MS.9.1 (with the difference here that $Q_{6}$ and $Q_{7}$ have the same dimensions). Table B. 26 summarizes the relevant information and the calculated $m$ values for the transistor.

| Transistor | $I_{D}(\mu \mathrm{~A})$ | $m$ |
| :--: | :--: | :--: |
| 1 | 100 | 6 |
| 2 | 100 | 6 |
| 3 | 100 | 14 |
| 4 | 100 | 14 |
| 5 | 200 | 13 |
| 6 | 200 | 13 |
| 7 | 200 | 13 |
| 8 | 200 | 13 |
# Example MS.11.1 continued 

Design of the Feedback Network First we need to determine the value of the feedback factor $\beta$ for this series-shunt feedback amplifier. The $\beta$ network can be implemented using a voltage divider, as shown in Fig. B.96. The resistor values are chosen large enough (in comparison to the output resistance of the designed two-stage op amp) to minimize the effect of loading. Therefore, effectively,

$$
A \simeq A_{v}
$$

where $A$ is the open-loop gain of the amplifier (with loading). Now we can calculate the required feedback factor, $\beta$, as follows:

$$
\begin{aligned}
\left|A_{f}\right| & =\frac{A_{v}}{1+A_{v} \beta}=\frac{50}{1+50 \beta}=10 \mathrm{~V} / \mathrm{V} \\
\beta & =0.08
\end{aligned}
$$

The resistor values of this voltage divider are selected to provide voltage divisions of $0.08\left(R_{1}=92 \mathrm{k} \Omega\right.$ and $R_{2}=8 \mathrm{k} \Omega$ ).


Figure B. $96 \beta$ Network.

## Simulation

Now we will simulate our designed circuit to verify our hand design and study the effect of feedback on the dc-gain, bandwidth, and output resistance of the amplifier.

Verifying $A_{v}$ The schematic capture of the two-stage CMOS amplifier is in Fig. B.95. We can verify the dc voltage gain of this amplifier by performing frequency-response analysis as set up in Ch10_OpAmp_Ex_Av.ms10.

As can be seen from Fig. B.97, $\left|A_{v}\right|=35.0 \mathrm{~dB} \simeq 56.2 \mathrm{~V} / \mathrm{V}$, which is close to the targeted specification.

Verifying $A$ The schematic capture of the $A$-circuit is given in Fig. B. 98 .


Figure B. 97 Frequency response of the two-stage CMOS op-amp amplifier.


Figure B. 98 Schematic capture of the $A$-circuit.

We can verify the open-loop voltage gain of this circuit by performing a frequency-response analysis as set up in Ch10_OpAmp_Ex_A.ms10. As can be seen from Fig. B.99, $|A|=34.9 \mathrm{~dB} \simeq 55.6 \mathrm{~V} / \mathrm{V}$, which is close to the value of $A_{v}$. This supports our assumption of $A \simeq A_{v}$.


Figure B. 99 Schematic capture of the $A$-circuit.

Verifying $A_{f}$ The schematic capture of the closed-loop circuit is given in Fig. B.100. As can be seen from this schematic, the $\beta$-network establishes a series connection at the input and a shunt connection at the output of the original two-stage CMOS op amp.


Figure B. 100 Schematic capture of the closed-loop circuit.


Figure B. 101 Frequency response of the closed-loop circuit.
We can verify the closed-loop voltage gain by performing a frequency-response analysis as set up in Ch10_OpAmp_Ex_Af.ms10. As can be seen from Fig. B.101, $\left|A_{f}\right|=20.2 \mathrm{~dB} \simeq 10.2 \mathrm{~V} / \mathrm{V}$, which is close to the targeted specification for $A_{f}$.

Investigating the Effect of Feedback In addition to the frequency-response analysis, which provided information on the dc voltage gain and the 3-dB bandwidth, we used Multisim to find the output resistances of the open-loop and closed-loop circuits (as set up in Ch10_OpAmp_Ex_A.ms10 and Ch10_OpAmp_Ex_Af.ms10). Table B. 27 summarizes our findings for open-loop (A-circuit) and closed-loop circuits.

| Circuit | Gain (V/V) | 3-dB Bandwidth (MHz) | $R_{\text {out }}(\Omega)$ |
| :-- | :--: | :--: | :--: |
| Open loop | 55.6 | 137 | 492.6 |
| Closed loop | 10.2 | 816 | 89.3 |

It can be seen from Table B. 27 that the series-shunt feedback connection causes the dc voltage gain and the output resistance of the circuit to decrease by a factor of 5.5 , while the $3-\mathrm{dB}$ bandwidth increases by approximately the same factor. This factor is equal to $1+A \beta$, the amount of the feedback. This is as expected and corresponds to what we learned in Chapter 11.
# Example MS.12.1 

## Class B Bipolar Output Stage

In this example, we will design a class B output stage to deliver an average power of 20 W to an $8-\Omega$ load. The schematic capture of a class B output stage implemented using BJTs is shown in Fig. B.102. We then will investigate various characteristics of the designed circuit such as crossover distortion and power-conversion efficiency. For this design, we are to select $V_{C C}$ about 5 V greater than the peak output voltage in order to avoid transistor saturation and signal distortion.


Figure B. 102 Schematic capture of class B output stage.
The circuit specifications are summarized in Table B. 28 .

| Table B.28 Class B Output Stage Specifications |  |
| :-- | :-- |
| Specification | Value |
| $P_{L}$ | 20 W |
| $R_{L}$ | $8 \Omega$ |
| $V_{C C}$ | $\hat{V}+5 \mathrm{~V}$ |

## Hand Design

We know from Eq. (12.12) that

$$
P_{L}=\frac{1}{2} \frac{\hat{V}^{2}}{R_{L}}
$$# Example MS.12.1 continued 

Thus

$$
\begin{aligned}
& V=\sqrt{2 P_{L} R_{L}}=\sqrt{2 \times 20 \times 8} \\
& V=17.9 \mathrm{~V}
\end{aligned}
$$

which leads to $V_{C C}=23 \mathrm{~V}$.
The peak current drawn from the supply will be

$$
\begin{aligned}
I_{O} & =\frac{\hat{V}}{R_{L}}=\frac{17.9}{8} \\
I_{o} & =2.24 \mathrm{~A}
\end{aligned}
$$

Now we can use Eq. (12.13) to calculate the average power drawn from each of the supplies

$$
\begin{gathered}
P_{S+}=P_{S-}=\frac{1}{\pi} \frac{\hat{V}}{R_{L}} V_{C C}=\frac{1}{\pi} \times 2.24 \times 23 \\
P_{S+}=P_{S-}=16.4 \mathrm{~W} \\
P_{S}=P_{S+}+P_{S-}=16.4+16.4=32.8 \mathrm{~W}
\end{gathered}
$$

Therefore, the power-conversion efficiency, $\eta$, is

$$
\eta=\frac{P_{L}}{P_{S}} \times 100 \%=\frac{17.9}{32.8} \times 100 \%=61 \%
$$

Now we can utilize Eq. (12.22) to calculate the maximum power dissipated in each of the transistors as

$$
\begin{aligned}
& P_{D P \max }=P_{D P \max }=\frac{V_{C C}^{2}}{\pi^{2} R_{L}}=\frac{(23)^{2}}{\pi^{2} \times 8} \\
& P_{D P \max }=P_{D P \max }=6.7 \mathrm{~W}
\end{aligned}
$$

## Simulation

Next, we use Multisim to verify the operation of the class B output stage designed above. For simulation purposes, we will use discrete-power transistors MJE243 and MJE253 (from ON Semiconductor), which are rated for a maximum continuous collector current $I_{C \max }=4 \mathrm{~A}$ and a maximum collector-emitter voltage $V_{C E \max }$ of 100 V .

Load Power $P_{L}$ To measure the amount of power delivered to the load, we will utilize Transient Analysis in Multisim as set up in Ch11_Class_B_Ex.ms10. The transient analysis simulation is performed over the interval 0 ms to 2 ms , and the waveforms of the voltage at the output node and the output current are plotted in Fig. B. 103 .

As can be seen in Fig. B.103, the peak voltage amplitude is approximately 16.9 V and the peak current amplitude is 2.1 A . Upon a closer look at the current and voltage waveforms, we can observe that both exhibit crossover distortion. The bottom graph in Fig. B. 103 shows the instantaneous and the average


Figure B. 103 Load voltage, current, and instantaneous and average load power.
power dissipated in the load resistance. These waveforms were obtained by multiplying the current and voltage waveforms, and by taking the running average for the average power, $P_{L}$. The transient behavior of average power eventually settles into a quasi-constant steady-state value of 17.6 W .
Supply Power, $P_{S}$ Similarly, we can plot instantaneous voltage and current at the $V_{c c}$ and $V_{e e}$ nodes to measure the value of $P_{s}$. Figure B. 104 shows the voltage, current, instantaneous, and average power for $+V_{c c}$. We can plot these quantities for $-V_{e e}$ as well. However, owing to symmetry, we do not need to generate plots for the negative voltage supply. The average power provided by $+V_{c c}, P_{s+}$, is 15 W . Therefore, the total power provided by both voltage supplies is 30 W .


Figure B. 104 Supply voltage, current, and instantaneous and average supply power.
Power-Conversion Efficiency, $\eta$ Now we can calculate the power-conversion efficiency of the simulated circuit as follows.

$$
\eta=\frac{P_{s}}{P_{s}} \times 100 \%=\frac{17.6}{30} \times 100 \%=58.6 \%
$$
# Example MS.12.1 continued 

Transistor Power Dissipation, $P_{D}$ Figure B. 103 shows voltage, current, instantaneous and average power plots for $Q_{e}$ only. A similar plot can be obtained for $Q_{s}$ to measure the power dissipated in the $n p n$ device. As expected, the voltage waveform is a sinusoid, and the current waveform consists of half-sinusoids. The waveform of instantaneous power is rather unusual. It indicates the presence of some distortion as a result of driving the transistors rather hard. This can be verified by reducing the amplitude of the input signal. Students are encouraged to investigate this point. The average power dissipated in $Q_{e}$, as measured from Fig. B.105, is approximately 6 W . Therefore, the total power dissipated in the transistors is 12 W .


Figure B. 105 Voltage, current, and instantaneous and average power for $Q_{1}$.
The simulation results and hand-design calculations are summarized in Table B.29. Observe that the values are quite close, which verifies our design of the class B output stage.

| Table B.29 Summary of Simulation and Hand-Design Results |  |  |  |
| :-- | :--: | :--: | :--: |
| Measurement | Hand Design | Simulated | Error \% |
|  |  |  |  |
| $P_{L}$ | 17.9 W | 17.6 W | 1.7 |
| $P_{S}$ | 32.8 W | 30 W | 8.5 |
| $P_{D}$ | 13.4 W | 12 W | 10.4 |
| $n$ | $61 \%$ | $58.6 \%$ | 3.9 |

Crossover Distortion We can further investigate the crossover distortion of this circuit by utilizing the voltage transfer characteristics (VTC) curve of the class B output stage. The plot is obtained through a dc sweep analysis in Multisim where $v_{D i}$ is swept over the range -10 V to 10 V in $1.0-\mathrm{mV}$ increments. From the resulting VTC curve, shown in Fig. B.106, we can see that the dead band extends from -0.605 V to 0.56 V . The effect of crossover distortion can be quantified by performing a Fourier analysis on the output voltage in Multisim.


Figure B. 106 VTC of class B output stage.

Total Harmonic Distortion (THD) This analysis decomposes the waveform generated via transient analysis into its Fourier-series components. Furthermore, Multisim computes the THD of the output waveform, and the results are shown in Fig. B.107.


Figure B. 107 Fourier-series components of the output voltage and class B output stage THD.
From the Fourier analysis, we note that the waveform is rather rich in odd harmonics and that the resulting THD is $2.13 \%$, which is rather high.

# Example MS.13.1 

## A Two-Stage CMOS Op Amp with Frequency Compensation

In this example, we will use Multisim to aid in designing the frequency compensation of the two-stage CMOS circuit whose schematic is shown in Fig. B.108. Multisim will then be employed to determine the frequency response and the slew rate of the op amp. We will assume a $0.5-\mu \mathrm{m}$ CMOS technology for the MOSFETs and use typical SPICE level-1 model parameters for this technology.

The op-amp circuit in Fig. B. 108 is designed using a reference current $I_{\mathrm{REF}}=90 \mu \mathrm{~A}$, a supply voltage $V_{D D}=3.3 \mathrm{~V}$, and a load capacitor $C_{L}=1 \mathrm{pF}$. Unit-size transistors with $W / L=1.25 \mu \mathrm{~m} / 0.6 \mu \mathrm{~m}$ are used for both the NMOS and PMOS devices. The transistors are sized for an overdrive voltage $V_{O V}=0.3 \mathrm{~V}$. The corresponding multiplicative factors are shown in Fig. B.108.


Figure B. 108 Schematic capture of the two-stage CMOS op amp.
In Multisim, the common-mode input voltage $V_{C M}$ of the op-amp circuit is set to $V_{D D} / 2=1.65 \mathrm{~V}$, and dc operating-point analysis is performed to determine the dc bias conditions. Using the values found from the simulation results for the small-signal parameters of the MOSFETs, we obtain

$$
\begin{aligned}
G_{m 1} & =0.333 \mathrm{~mA} / \mathrm{V} \\
G_{m 2} & =0.650 \mathrm{~mA} / \mathrm{V} \\
C_{1} & =26.5 \mathrm{fF} \\
C_{2} & =1.04 \mathrm{pF}
\end{aligned}
$$

using Eqs. (13.7), (13.14), (13.25), and (13.26) respectively. Recall that $G_{m 1}$ and $G_{m 2}$ are the transconductances of, respectively, the first and second stages of the op amp. Capacitors $C_{1}$ and $C_{2}$ represent the total capacitance to ground at the output nodes of, respectively, the first and second stage of the op amp.

Then, using Eq. (13.35), the frequency of the second, nondominant, pole can be found as

$$
f_{P 2} \simeq \frac{G_{m 2}}{2 \pi C_{2}}=97.2 \mathrm{MHz}
$$
Example MS.13.1 continued
To place the transmission zero, given by Eq. (13.31), at infinite frequency, we select

$$
R=\frac{1}{G_{m 2}}=1.53 \mathrm{k} \Omega
$$

Now, using Eq. (13.42), the phase margin of the op amp can be expressed as

$$
P M=90^{\circ}-\tan ^{-1}\left(\frac{f_{t}}{f_{P 2}}\right)
$$

where $f_{t}$ is the unity-gain frequency, given in Eq. (13.83):

$$
f_{1}=\frac{G_{m 1}}{2 \pi C_{C}}
$$

Using the above two equations we determine that compensation capacitors of $C_{C}=0.78 \mathrm{pF}$ and $C_{C}=2 \mathrm{pF}$ are required to achieve phase margins of $P M=55^{\circ}$ and $P M=75^{\circ}$, respectively.

Next, an ac-analysis simulation is performed in Multisim to compute the frequency response of the op amp and to verify the foregoing design values (as set up in Ch12_Two_Stage_CMOS_OpAmp_ Ex_Freq-Resp.ms10). It was found that, with $R=1.53 \mathrm{k} \Omega$, we needed $C_{C}=0.6 \mathrm{pF}$ and $C_{C}=1.8 \mathrm{pF}$ to set $P M=55^{\circ}$ and $P M=75^{\circ}$, respectively. We note that these values are reasonably close to those predicted by hand analysis. The corresponding frequency responses for the compensated op amps are plotted in Figs. B. 109 and B.110. For comparison, we also show the frequency response


Figure B. 109 Magnitude and phase response of the op-amp circuit with $R=1.53 \mathrm{k}, C_{C}=0$ (no frequency compensation), and $C_{C}=1.8 \mathrm{pF}\left(P M=75^{\circ}\right)$.
of the uncompensated op amp $\left(C_{C}=0\right)$. Observe that the unity-gain frequency $f_{i}$ drops from 70.8 MHz to 26.4 MHz as $C_{c}$ is increased to improve $P M$.

Rather than increasing the compensation capacitor $C_{C}$ to improve the phase margin, the value of the series resistor $R$ can be increased: for a given $C_{C}$, increasing $R$ above $1 / G_{m 2}$ places the transmission zero at a negative real-axis location (Eq. 13.31), where the phase it introduces adds to the phase margin. Thus, $P M$ can be improved without affecting $f_{i}$. To verify this point, we set $C_{C}$ to 0.6 pF and simulate the op-amp circuit in Multisim for the cases of $R=1.53 \mathrm{k} \Omega$ and $R=3.2 \mathrm{k} \Omega$. The corresponding frequency response is plotted in Fig. B.111. Observe how $f_{i}$ is approximately independent of $R$. However, by increasing $R$, we can improve $P M$ from $55^{\circ}$ to $75^{\circ}$.

Increasing the $P M$ is desirable because it reduces the overshoot in the step response of the op amp. To verify this point, we simulate in Multisim the step response of the op amp for $P M=55^{\circ}$ and $P M=75^{\circ}$. To do that, we connect the op amp in a unity-gain configuration, apply a small $(10-\mathrm{mV})$ pulse signal at the input with very short (1-ps) rise and fall times to emulate a step input, perform a transient analysis simulation (as set up in Ch12_Two_Stage_CMOS_OpAmp_Ex_Small-Signal.ms10), and plot the output voltage as shown in Fig. B.112. Observe that the overshoot in the step response drops from $15 \%$ to $1.4 \%$ when the phase margin is increased from $55^{\circ}$ to $75^{\circ}$.

We conclude this example by computing $S R$, the slew rate of the op amp. From Eq. (13.45), we have

$$
S R=2 \pi f_{i} V_{O V}=\frac{G_{m 1}}{C_{C}} V_{O V}=166.5 \mathrm{~V} / \mu \mathrm{s}
$$



Figure B. 110 Magnitude and phase response of the op-amp circuit with $R=1.53 \mathrm{k} \Omega, C_{C}=0$ (no frequency compensation), and $C_{C}=1.8 \mathrm{pF}\left(P M=75^{\circ}\right)$.


Figure B. 111 Magnitude and phase response of the op-amp circuit with $C_{C}=0.6 \mathrm{pF}, R=1.53 \mathrm{k} \Omega\left(P M=55^{\circ}\right)$, and $R=3.2 \mathrm{k} \Omega\left(P M=75^{\circ}\right)$.


Figure B. 112 Small-signal step response (for a $10-\mathrm{mV}$ step input) if the op-amp circuit is connected in a unity-gain configuration: $P M=55^{\circ}\left(C_{C}=0.6 \mathrm{pF}, R=1.53 \mathrm{k} \Omega\right)$ and $P M=75^{\circ}\left(C_{C}=0.6 \mathrm{pF}, R=3.2 \mathrm{k} \Omega\right)$.can be as large as 1 mV of unknown polarity, what range of offset current is possible?
2.106 A Miller integrator with $R=10 \mathrm{k} \Omega$ and $C=10 \mathrm{nF}$ is implemented by using an op amp with $V_{\mathrm{OT}}=2 \mathrm{mV}, I_{B}=$ $0.1 \mu \mathrm{~A}$, and $I_{\mathrm{OT}}=20 \mathrm{nA}$. To provide a finite dc gain, a $1-\mathrm{M} \Omega$ resistor is connected across the capacitor.
(a) To compensate for the effect of $I_{B}$, a resistor is connected in series with the positive-input terminal of the op amp. What should its value be?
(b) With the resistor of (a) in place, find the worst-case dc output voltage of the integrator when the input is grounded.

## Section 2.7: Effect of Finite Open-Loop Gain and Bandwidth on Circuit Performance

2.107 The data in the following table apply to internally compensated op amps. Fill in the blank entries.

| $A_{0}$ | $f_{b}(\mathrm{~Hz})$ | $f_{i}(\mathrm{~Hz})$ |
| :--: | :--: | :--: |
| $10^{5}$ | $10^{2}$ |  |
| $10^{6}$ |  | $10^{6}$ |
|  | $10^{3}$ | $10^{8}$ |
| $2 \times 10^{5}$ | $10^{-1}$ | $10^{6}$ |
|  | 10 |  |

2.108 A measurement of the open-loop gain of an internally compensated op amp at very low frequencies shows it to be 98 dB ; at 100 kHz , this shows it is 40 dB . Estimate values for $A_{0}, f_{b}$, and $f_{i}$.
2.109 Measurements of the open-loop gain of a compensated op amp intended for high-frequency operation indicate that the gain is $4 \times 10^{5}$ at 100 kHz and $20 \times 10^{3}$ at 10 kHz . Estimate its 3-dB frequency, its unity-gain frequency, and its dc gain.
2.110 Measurements made on the internally compensated amplifiers listed below provide the dc gain and the frequency at which the gain has dropped by 20 dB . For each, what are the 3 dB and unity-gain frequencies?
(a) $2 \times 10^{5} \mathrm{~V} / \mathrm{V}$ and $5 \times 10^{2} \mathrm{~Hz}$
(b) $20 \times 10^{5} \mathrm{~V} / \mathrm{V}$ and 10 Hz
(c) $1800 \mathrm{~V} / \mathrm{V}$ and 0.1 MHz
(d) $100 \mathrm{~V} / \mathrm{V}$ and 0.1 GHz
(e) $25 \mathrm{~V} / \mathrm{mV}$ and 250 kHz
2.111 An inverting amplifier with nominal gain of $-50 \mathrm{~V} / \mathrm{V}$ employs an op amp having a dc gain of $10^{4}$ and a unity-gain frequency of $10^{6} \mathrm{~Hz}$. What is the $3-\mathrm{dB}$ frequency $f_{3 \mathrm{~dB}}$ of the closed-loop amplifier? What is its gain at $0.1 f_{3 \mathrm{~dB}}$ and at $10 f_{3 \mathrm{~dB}}$ ?
2.112 A particular op amp, characterized by a gain-bandwidth product of 20 MHz , is operated with a closed-loop gain of $+100 \mathrm{~V} / \mathrm{V}$. What 3-dB bandwidth results? At what frequency does the closed-loop amplifier exhibit a $-6^{\circ}$ phase shift? A $-84^{\circ}$ phase shift?
2.113 Find the $f_{i}$ required for internally compensated op amps to be used in the implementation of closed-loop amplifiers with the following nominal dc gains and 3-dB bandwidths:
(a) $-50 \mathrm{~V} / \mathrm{V} ; 100 \mathrm{kHz}$
(b) $+50 \mathrm{~V} / \mathrm{V} ; 100 \mathrm{kHz}$
(c) $+2 \mathrm{~V} / \mathrm{V} ; 5 \mathrm{MHz}$
(d) $-2 \mathrm{~V} / \mathrm{V} ; 5 \mathrm{MHz}$
(e) $-1000 \mathrm{~V} / \mathrm{V} ; 10 \mathrm{kHz}$
(f) $+1 \mathrm{~V} / \mathrm{V} ; 1 \mathrm{MHz}$
(g) $-1 \mathrm{~V} / \mathrm{V} ; 1 \mathrm{MHz}$
2.114 A noninverting op-amp circuit with a gain of $96 \mathrm{~V} / \mathrm{V}$ is found to have a 3-dB frequency of 8 kHz . For a particular system application, a bandwidth of 32 kHz is required. What is the highest gain available under these conditions?
2.115 Consider a unity-gain follower utilizing an internally compensated op amp with $f_{i}=2 \mathrm{MHz}$. What is the $3-\mathrm{dB}$ frequency of the follower? At what frequency is the gain of the follower $1 \%$ below its low-frequency magnitude? If the input to the follower is a $1-\mathrm{V}$ step, find the $10 \%$ to $90 \%$ rise time of the output voltage. (Note: The step response of STC low-pass networks is discussed in Appendix E. Specifically, note that the $10 \%-90 \%$ rise time of a low-pass STC circuit with a time constant $\tau$ is $2.2 \tau$.)

D *2.116 It is required to design a noninverting amplifier with a dc gain of 10 . When a step voltage of 100 mV is applied at the input, it is required that the output be within $1 \%$ of its final value of 1 V in at most 200 ns . What must the $f_{i}$ of the op amp be? (Note: The step response of STC low-pass networks is discussed in Appendix E.)

D *2.117 This problem illustrates the use of cascaded closed-loop amplifiers to obtain an overall bandwidth greater than can be achieved using a single-stage amplifier with the same overall gain.

[^0]
[^0]:    $100=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
(a) Show that cascading two identical amplifier stages, each having a low-pass STC frequency response with a 3-dB frequency $f_{1}$, results in an overall amplifier with a 3-dB frequency given by

$$
f_{3 \mathrm{~dB}}=\sqrt{\sqrt{2}-1} f_{1}
$$

(b) It is required to design a noninverting amplifier with a dc gain of 40 dB utilizing a single internally compensated op amp with $f_{i}=2 \mathrm{MHz}$. What is the 3-dB frequency obtained?
(c) Redesign the amplifier of (b) by cascading two identical noninverting amplifiers each with a dc gain of 20 dB . What is the 3-dB frequency of the overall amplifier? Compare this to the value obtained in (b) above.
$\mathbf{D}^{* *} 2.118$ A designer, wanting to achieve a stable gain of 100 $\mathrm{V} / \mathrm{V}$ at 5 MHz , considers her choice of amplifier topologies. Whatunity-gainfrequency wouldasingleoperationalamplifier require to satisfy her need? Unfortunately, the best available amplifier has an $f_{1}$ of 40 MHz . How many such amplifiers connected in a cascade of identical noninverting stages would she need to achieve her goal? What is the 3-dB frequency of each stage she can use? What is the overall 3-dB frequency?
2.119 Consider the use of an op amp with a unity-gain frequency $f_{i}$ in the realization of:
(a) An inverting amplifier with dc gain of magnitude $K$.
(b) A noninverting amplifier with a dc gain of $K$.

In each case find the 3-dB frequency and the gain-bandwidth product ( $\mathrm{GBP} \equiv \mid$ Gain $\left.\mid \times f_{3 \mathrm{~dB}}\right)$. Comment on the results.
*2.120 Consider an inverting summer with two inputs $V_{1}$ and $V_{2}$ and with $V_{o}=-\left(V_{1}+3 V_{2}\right)$. Find the 3-dB frequency of each of the gain functions $V_{o} / V_{1}$ and $V_{o} / V_{2}$ in terms of the op amp $f_{i}$. (Hint: In each case, the other input to the summer can be set to zero-an application of superposition.)

## Section 2.8: Large-Signal Operation of Op Amps

2.121 A particular op amp using $\pm 15-\mathrm{V}$ supplies operates linearly for outputs in the range -14 V to +14 V . If used in an inverting amplifier configuration of gain -100 , what is the rms value of the largest possible sine wave that can be applied at the input without output clipping?
2.122 Consider an op amp connected in the inverting configuration to realize a closed-loop gain of $-100 \mathrm{~V} / \mathrm{V}$ utilizing resistors of $1 \mathrm{k} \Omega$ and $100 \mathrm{k} \Omega$. A load resistance $R_{L}$
is connected from the output to ground, and a low-frequency sine-wave signal of peak amplitude $V_{p}$ is applied to the input. Let the op amp be ideal except that its output voltage saturates at $\pm 10 \mathrm{~V}$ and its output current is limited to the range $\pm 20 \mathrm{~mA}$.
(a) For $R_{L}=1 \mathrm{k} \Omega$, what is the maximum possible value of $V_{p}$ while an undistorted output sinusoid is obtained?
(b) Repeat (a) for $R_{L}=200 \Omega$.
(c) If it is desired to obtain an output sinusoid of $10-\mathrm{V}$ peak amplitude, what minimum value of $R_{L}$ is allowed?
2.123 An op amp having a slew rate of $10 \mathrm{~V} / \mu \mathrm{s}$ is to be used in the unity-gain follower configuration, with input pulses that rise from 0 to 2 V . What is the shortest pulse that can be used while ensuring full-amplitude output? For such a pulse, describe the output resulting.
2.124 For operation with $10-\mathrm{V}$ output pulses with the requirement that the sum of the rise and fall times represent only $20 \%$ of the pulse width (at half-amplitude), what is the slew-rate requirement for an op amp to handle pulses $2 \mu \mathrm{~s}$ wide? (Note: The rise and fall times of a pulse signal are usually measured between the $10 \%$ - and $90 \%$-height points.)
2.125 What is the highest frequency of a triangle wave of $10-\mathrm{V}$ peak-to-peak amplitude that can be reproduced by an op amp whose slew rate is $20 \mathrm{~V} / \mu \mathrm{s}$ ? For a sine wave of the same frequency, what is the maximum amplitude of output signal that remains undistorted?
2.126 For an amplifier having a slew rate of $40 \mathrm{~V} / \mu \mathrm{s}$, what is the highest frequency at which a $20-\mathrm{V}$ peak-to-peak sine wave can be produced at the output?
$\mathbf{D}^{*}$ 2.127 In designing with op amps one has to check the limitations on the voltage and frequency ranges of operation of the closed-loop amplifier, imposed by the op-amp finite bandwidth $\left(f_{i}\right)$, slew rate (SR), and output saturation $\left(V_{o \max }\right)$. This problem illustrates the point by considering the use of an op amp with $f_{i}=20 \mathrm{MHz}, \mathrm{SR}=10 \mathrm{~V} / \mu \mathrm{s}$, and $V_{o \max }=10 \mathrm{~V}$ in the design of a noninverting amplifier with a nominal gain of 10 . Assume a sine-wave input with peak amplitude $V_{i}$.
(a) If $V_{i}=0.5 \mathrm{~V}$, what is the maximum frequency before the output distorts?
(b) If $f=200 \mathrm{kHz}$, what is the maximum value of $V_{i}$ before the output distorts?
(c) If $V_{i}=50 \mathrm{mV}$, what is the useful frequency range of operation?
(d) If $f=50 \mathrm{kHz}$, what is the useful input voltage range?
# CHAPTER 3 

## Semiconductors

Introduction 135
3.1 Intrinsic Semiconductors 136
3.2 Doped Semiconductors 139
3.3 Current Flow in Semiconductors 142
3.4 The pn Junction 148
3.5 The pn Junction with an Applied Voltage 155
3.6 Capacitive Effects in the pn Junction 164

Summary 168
Problems 171
# IN THIS CHAPTER YOU WILL LEARN 

1. The basic properties of semiconductors and in particular silicon, which is the material used to make most of today's electronic circuits.
2. How doping a pure silicon crystal dramatically changes its electrical conductivity, which is the fundamental idea underlying the use of semiconductors in the implementation of electronic devices.
3. The two mechanisms by which current flows in semiconductors:drift and diffusion of charge carriers.
4. The structure and operation of the $p n$ junction; a basic semiconductor structure that implements the diode and plays a dominant role in transistors.

## Introduction

Thus far we have dealt with electronic circuits, and notably amplifiers, as system building blocks. For instance, in Chapter 2 we learned how to use op amps to design interesting and useful circuits, taking advantage of the terminal characteristics of the op amp and without any knowledge of what is inside the op-amp package. Though interesting and motivating, this approach has its limitations. Indeed, to achieve our goal of preparing the reader to become a proficient circuit designer, we have to go beyond this black-box or system-level abstraction and learn about the basic devices from which electronic circuits are assembled, namely, diodes (Chapter 4) and transistors (Chapters 5 and 6). These solid-state devices are made using semiconductor materials, predominantly silicon.

In this chapter, we briefly introduce the properties and physics of semiconductors. The objective is to provide a basis for understanding the physical operation of diodes and transistors in order to enable their effective use in the design of circuits. Although many of the concepts studied in this chapter apply to semiconductor materials in general, our treatment is heavily biased toward silicon, simply because it is the material used in the vast majority of microelectronic circuits. To complement the material presented here, Appendix A provides a description of the integrated-circuit fabrication process. As discussed in Appendix A, whether our circuit consists of a single transistor or is an integrated circuit containing more than 2 billion transistors, it is fabricated in a single silicon crystal, which gives rise to the name monolithic circuit. This chapter therefore begins with a study of the crystal structure of semiconductors and introduces the two types of charge carriers available for current conduction: electrons and holes. The most significant property of semiconductors is that their conductivity can be varied over a very wide range through the introduction of
controlled amounts of impurity atoms into the semiconductor crystal in a process called doping. Doped semiconductors are discussed in Section 3.2. This is followed by the study in Section 3.3 of the two mechanisms for current flow in semiconductors, namely, carrier drift and carrier diffusion.

Armed with these basic semiconductor concepts, we spend the remainder of the chapter on the study of an important semiconductor structure: the $p n$ junction. In addition to being essentially a diode, the $p n$ junction is the basic element of the bipolar junction transistor (BJT, Chapter 6) and plays an important role in the operation of field-effect transistors (FETs, Chapter 5).

# 3.1 Intrinsic Semiconductors 

As their name implies, semiconductors are materials whose conductivity lies between that of conductors, such as copper, and insulators, such as glass. There are two kinds of semiconductors: single-element semiconductors, such as germanium and silicon, which are in group IV in the periodic table; and compound semiconductors, such as gallium-arsenide, which are formed by combining elements from groups III and V or groups II and VI. Compound semiconductors are useful in special electronic circuit applications as well as in applications that involve light, such as light-emitting diodes (LEDs). Of the two elemental semiconductors, germanium was used in the fabrication of very early transistors (late 1940s, early 1950s). It was quickly supplanted, however, with silicon, on which today's integrated-circuit technology is almost entirely based. For this reason, we will deal mostly with silicon devices throughout this book. ${ }^{1}$

A silicon atom has four valence electrons, and thus it requires another four to complete its outermost shell. This is achieved by sharing one of its valence electrons with each of its four neighboring atoms. Each pair of shared electrons forms a covalent bond. The result is that a crystal of pure or intrinsic silicon has a regular lattice structure, where the atoms are held in their position by the covalent bonds. Figure 3.1 shows a two-dimensional representation of such a structure.

At sufficiently low temperatures, approaching absolute zero $(0 \mathrm{~K})$, all the covalent bonds are intact and no electrons are available to conduct electric current. Thus, at such low temperatures, the intrinsic silicon crystal behaves as an insulator.

At room temperature, sufficient thermal energy exists to break some of the covalent bonds, a process known as thermal generation. As shown in Fig. 3.2, when a covalent bond is broken, an electron is freed. The free electron can wander away from its parent atom, and it becomes available to conduct electric current if an electric field is applied to the crystal. As the electron leaves its parent atom, it leaves behind a net positive charge, equal to the magnitude of the electron charge. Thus, an electron from a neighboring atom may be attracted to this positive charge, and leaves its parent atom. This action fills up the "hole" that existed in the ionized atom but creates a new hole in the other atom. This process may repeat itself, with the result that we effectively have a positively charged carrier, or hole, moving through the silicon crystal structure and being available to conduct electric current. The charge of a hole is equal in magnitude to the charge of an electron. We can thus see that as temperature increases, more covalent bonds are broken and electron-hole pairs are generated. The increase in the numbers of free electrons and holes results in an increase in the conductivity of silicon.

[^0]
[^0]:    ${ }^{1}$ An exception is the subject of gallium arsenide (GaAs) circuits, which though not covered in this edition of the book, is studied in some detail in material provided on the text website.


Figure 3.1 Two-dimensional representation of the silicon crystal. The circles represent the inner core of silicon atoms, with +4 indicating its positive charge of $+4 q$, which is neutralized by the charge of the four valence electrons. Observe how the covalent bonds are formed by sharing of the valence electrons. At 0 K , all bonds are intact and no free electrons are available for current conduction.


Figure 3.2 At room temperature, some of the covalent bonds are broken by thermal generation. Each broken bond gives rise to a free electron and a hole, both of which become available for current conduction.

Thermal generation results in free electrons and holes in equal numbers and hence equal concentrations, where concentration refers to the number of charge carriers per unit volume $\left(\mathrm{cm}^{3}\right)$. The free electrons and holes move randomly through the silicon crystal structure, and in the process some electrons may fill some of the holes. This process, called recombination, results in the disappearance of free electrons and holes. The recombination rate is
proportional to the number of free electrons and holes, which in turn is determined by the thermal generation rate. The latter is a strong function of temperature. In thermal equilibrium, the recombination rate is equal to the generation rate, and one can conclude that the concentration of free electrons $n$ is equal to the concentration of holes $p$,

$$
n=p=n_{i}
$$

where $n_{i}$ denotes the number of free electrons and holes in a unit volume $\left(\mathrm{cm}^{3}\right)$ of intrinsic silicon at a given temperature. Results from semiconductor physics gives $n_{i}$ as

$$
n_{i}=B T^{3 / 2} e^{-E_{g} / 2 k T}
$$

where $B$ is a material-dependent parameter that is $7.3 \times 10^{15} \mathrm{~cm}^{-3} \mathrm{~K}^{-3 / 2}$ for silicon; $T$ is the temperature in $K ; E_{g}$, a parameter known as the bandgap energy, is 1.12 electron volt (eV) for silicon ${ }^{2}$; and $k$ is Boltzmann's constant $\left(8.62 \times 10^{-5} \mathrm{eV} / \mathrm{K}\right)$. It is interesting to know that the bandgap energy $E_{g}$ is the minimum energy required to break a covalent bond and thus generate an electron-hole pair.

# Example 3.1 

Calculate the value of $n_{i}$ for silicon at room temperature $(T \simeq 300 \mathrm{~K})$.

## Solution

Substituting the values given above in Eq. (3.2) provides

$$
\begin{aligned}
n_{i} & =7.3 \times 10^{15}(300)^{3 / 2} e^{-1.12\left(2 \times 8.62 \times 10^{-5} \times 300\right)} \\
& =1.5 \times 10^{10} \text { carriers } / \mathrm{cm}^{3}
\end{aligned}
$$

Although this number seems large, to place it into context note that silicon has $5 \times 10^{22}$ atoms $/ \mathrm{cm}^{3}$. Thus at room temperature only one in about $5 \times 10^{12}$ atoms is ionized and contributing a free electron and a hole!

Finally, it is useful for future purposes to express the product of the hole and free-electron concentration as

$$
p n=n_{i}^{2}
$$

where for silicon at room temperature, $n_{i} \simeq 1.5 \times 10^{10} / \mathrm{cm}^{3}$. As will be seen shortly, this relationship extends to extrinsic or doped silicon as well.

[^0]
[^0]:    ${ }^{2}$ Note that $1 \mathrm{eV}=1.6 \times 10^{-19} \mathrm{~J}$.
## LCDs, THE FACE OF ELECTRONICS:

The existence of liquid crystals whose color could be changed by means of an external heat source was first reported in 1888 by an Austrian botanical physiologist. The LC idea lay dormant until the late 1940s, however. Subsequent developments in the field of solid-state electronics provided the technology to harness the technique in display media, with the first LCDs being demonstrated by RCA beginning in 1962. Today, LCDs are an essential component in every mobile device as the interface to the world of electronics within. At the other end of the scale, large LCDs are used in flat-panel TVs, and very large LCDs are appearing as "dynamic" wallpaper in museum display settings.

# EXERCISE 

3.1 Calculate the intrinsic carrier density $n_{i}$ for silicon at $T=50 \mathrm{~K}$ and 350 K . Ans. $9.6 \times 10^{-39} / \mathrm{cm}^{3} ; 4.15 \times 10^{11} / \mathrm{cm}^{3}$

### 3.2 Doped Semiconductors

The intrinsic silicon crystal described above has equal concentrations of free electrons and holes, generated by thermal generation. These concentrations are far too small for silicon to conduct appreciable current at room temperature. Also, the carrier concentrations and hence the conductivity are strong functions of temperature, not a desirable property in an electronic device. Fortunately, a method was developed to change the carrier concentration in a semiconductor crystal substantially and in a precisely controlled manner. This process is known as doping, and the resulting silicon is referred to as doped silicon.

Doping involves introducing impurity atoms into the silicon crystal in sufficient numbers to substantially increase the concentration of either free electrons or holes but with little or no change in the crystal properties of silicon. To increase the concentration of free electrons, $n$, silicon is doped with an element with a valence of 5 , such as phosphorus. The resulting doped silicon is then said to be of $\boldsymbol{n}$ type. To increase the concentration of holes, $p$, silicon is doped with an element having a valence of 3 , such as boron, and the resulting doped silicon is said to be of $\boldsymbol{p}$ type.

Figure 3.3 shows a silicon crystal doped with phosphorus impurity. The dopant (phosphorus) atoms replace some of the silicon atoms in the crystal structure. Since the phosphorus atom has five electrons in its outer shell, four of these electrons form covalent bonds with the neighboring atoms, and the fifth electron becomes a free electron. Thus each phosphorus atom donates a free electron to the silicon crystal, and the phosphorus impurity is called a donor. It should be clear, though, that no holes are generated by this process. The net positive charge associated with the phosphorus atom is a bound charge that does not move through the crystal.

If the concentration of donor atoms is $N_{D}$, where $N_{D}$ is usually much greater than $n_{i}$, the concentration of free electrons in the $n$-type silicon will be

$$
n_{n} \simeq N_{D}
$$


Figure 3.3 A silicon crystal doped by a pentavalent element. Each dopant atom donates a free electron and is thus called a donor. The doped semiconductor becomes $n$ type.
where the subscript $n$ denotes $n$-type silicon. Thus $n_{n}$ is determined by the doping concentration and not by temperature. This is not the case, however, for the hole concentration. All the holes in the $n$-type silicon are those generated by thermal ionization. Their concentration $p_{n}$ can be found by noting that the relationship in Eq. (3.3) applies equally well for doped silicon, provided thermal equilibrium is achieved. Thus for $n$-type silicon

$$
p_{n} n_{n}=n_{i}^{2}
$$

Substituting for $n_{n}$ from Eq. (3.4), we obtain for $p_{n}$

$$
p_{n} \simeq \frac{n_{i}^{2}}{N_{D}}
$$

Thus $p_{n}$ will have the same dependence on temperature as that of $n_{i}^{2}$. Finally, we note that in $n$-type silicon the concentration of free electrons $n_{n}$ will be much larger than that of holes. Hence electrons are said to be the majority charge carriers and holes the minority charge carriers in $n$-type silicon.

To obtain $p$-type silicon in which holes are the majority charge carriers, a trivalent impurity such as boron is used. Figure 3.4 shows a silicon crystal doped with boron. Note that the boron atoms replace some of the silicon atoms in the silicon crystal structure. Since each boron atom has three electrons in its outer shell, it accepts an electron from a neighboring atom, thus forming covalent bonds. The result is a hole in the neighboring atom and a bound negative charge at the acceptor (boron) atom. It follows that each acceptor atom provides a hole. If the acceptor doping concentration is $N_{A}$, where $N_{A} \gg n_{i}$, the hole concentration becomes

$$
p_{p} \simeq N_{A}
$$

where the subscript $p$ denotes $p$-type silicon. Thus, here the majority carriers are holes and their concentration is determined by $N_{A}$. The concentration of minority electrons can be found


Figure 3.4 A silicon crystal doped with boron, a trivalent impurity. Each dopant atom gives rise to a hole, and the semiconductor becomes $p$ type.
by using the relationship

$$
p_{p} n_{p}=n_{i}^{2}
$$

and substituting for $p_{p}$ from Eq. (3.6),

$$
n_{p} \simeq \frac{n_{i}^{2}}{N_{A}}
$$

Thus, the concentration of the minority electrons will have the same temperature dependence as that of $n_{i}^{2}$.

It should be emphasized that a piece of $n$-type or $p$-type silicon is electrically neutral; the charge of the majority free carriers (electrons in the $n$-type and holes in the $p$-type silicon) are neutralized by the bound charges associated with the impurity atoms.

# Example 3.2 

Consider an $n$-type silicon for which the dopant concentration $N_{D}=10^{17} / \mathrm{cm}^{3}$. Find the electron and hole concentrations at $T=300 \mathrm{~K}$.

## Solution

The concentration of the majority electrons is

$$
n_{n} \simeq N_{D}=10^{17} / \mathrm{cm}^{3}
$$

Figure B. 113 Large-signal step response (for a $2.2-\mathrm{V}$ step input) if the op-amp circuit is connected in a unity-gain configuration. The slope of the rising and falling edges of the output waveform correspond to the slew rate of the op amp.
when $C_{C}=0.6 \mathrm{pF}$. Next, to determine SR using Multisim, we again connect the op amp in a unity-gain configuration and perform a transient analysis simulation (as set up in Ch12_Two_Stage_CMOS_ OpAmp_Ex_Large-Signal.ms10). However, we now apply a large pulse signal ( 2.2 V ) at the input to cause slew-rate limiting at the output. The corresponding output voltage waveform is plotted in Fig. B.113. The slope of the slew-rate-limited output waveform corresponds to the slew rate of the op amp and is found to be $S R=160 \mathrm{~V} / \mu \mathrm{s}$ and $60 \mathrm{~V} / \mu \mathrm{s}$ for the negative- and positive-going output, respectively. These results, with the unequal values of $S R$ in the two directions, differ from those predicted by the simple model for the slew-rate limiting of the two-stage op-amp circuit. The difference can perhaps be said to be a result of transistor $Q_{s}$ entering the triode region and its output current (which is sourced through $C_{C}$ ) being correspondingly reduced. Of course, the availability of Multisim should enable the reader to explore this point further.

# Example MS. 14.1 

## The CMOS Inverter

In this example, we will use Multisim to design a CMOS inverter whose schematic capture is shown in Fig. B.114. We will assume a $0.18-\mu \mathrm{m}$ CMOS technology for the MOSFETs and use typical SPICE level-1 model parameters for this technology, including the intrinsic capacitance values. This model does not take into account the short-channel effects for this technology. Also, the load capacitance is assumed
# Example MS.14.1 continued 

to be dominated by the extrinsic component $C_{\text {ext }}$ (resulting from the wiring and the input capacitance of the driven gates), where the value used in this example is 15 fF . We will begin with an approximate hand-analysis design. We will then use Multisim to verify that the designed circuit meets the specifications. The targeted specification for this inverter is a high-to-low propagation delay $\left(t_{P H L}\right)$ of less than 45 ps . Once designed, the other characteristics of this inverter such as low-to-high propagation delay $\left(t_{P L H}\right)$, noise margins, and threshold voltage will be investigated.

The inverter specifications are summarized in Table B.30.

| Table B.30 CMOS Inverter Specifications |  |
| :-- | :-- |
| Parameters | Value |
|  |  |
| $t_{P H L}$ | 45 ps |
| $C_{L}$ | 15 fF |
| $V_{D D}$ | 1.8 V |



Figure B. 114 Schematic capture of the CMOS inverter.

## Hand Design

For the design of this inverter we choose $L=0.2 \mu \mathrm{~m}$, so we have $L_{\text {eff }}=0.180 \mu \mathrm{~m}$. As mentioned earlier, to minimize area, all channels are usually made equal to the minimum length permitted by the given technology. To meet the specified $t_{P H L}$, we need to size $\left(W / L_{\text {eff }}\right)_{n}$ carefully. Once sized, $\left(W / L_{\text {eff }}\right)_{p}=$ $2\left(W / L_{\text {eff }}\right)_{n}$ is chosen, which is a compromise between area, noise margins, and $t_{P L H}$.

The value of $t_{P H L}$ can be estimated using Eq. (14.46) as

$$
t_{P H L}=\frac{\alpha_{a} C}{k_{i}\left(\frac{W}{L_{\text {eff }}}\right) V_{D D}}=\frac{15 \times 10^{-15} \alpha_{a}}{246.2 \times 10^{-6}\left(\frac{W}{L_{\text {eff }}}\right) 1.8}
$$
where $\alpha_{a}$ is a factor determined by the relative values of $V_{t}$ and $V_{D D}\left(V_{t o} / V_{D D=0.5 / 1.8=0.278}\right)$ :

$$
\alpha_{a}=\frac{2}{7 / 4^{-3}\left(V_{t o} / V_{D D}\right)+\left(V_{t o} / V_{D D}\right)^{2}}=2.01
$$

Based on the above equations, the specified $t_{P H L}$ can be achieved by selecting the ratio $\left(W / L_{e f l}\right)_{o}=1.5$ and consequently $\left(W / L_{e f l}\right)_{o}=3$. Table B. 31 summarizes the relevant sizing information for each transistor. The third column of this table shows the transconductance parameter values for each transistor (which are typical values for $0.18-\mu \mathrm{m}$ CMOS technology).

| Transistor | $W(\mu \mathrm{~m})$ | $L_{\text {eff }}(\mu \mathrm{m})$ | $k^{\prime}\left(\mu \mathrm{A} / \mathrm{V}^{2}\right)$ |
| :-- | :--: | :--: | :--: |
| NMOS | 0.27 | 0.18 | 246.2 |
| PMOS | 0.54 | 0.18 | 86.1 |

Note that for the selected width values, the intrinsic capacitances $C_{g d 1}$ and $C_{g d 2}$ are insignificant in comparison to the load capacitance. This confirms our initial assumption that in our hand calculations of delay, we could neglect $C_{g d 1}$ an $C_{g d 2}$ (which vary proportionally with width).

# Simulation 

Verifying Propagation Delay To investigate the dynamic operation of the inverter and to verify that the design meets the specified $t_{P H L}$, we apply an ideal pulse signal at the input and perform a transient analysis, as set up in Ch13_CMOS_Inverter_tPHL_Ex.ms10. Then, we plot the input and output waveforms as shown in Fig. B.115. Based on the simulated response, $t_{P H L}=40.5 \mathrm{ps}$ (as indicated in Fig. B.115). Similarly, we obtain $t_{P L H}=60.3 \mathrm{ps}$, resulting in the inverter propagation delay $\left(t_{p}\right)$ of 50.4 ps. Therefore, the specified high-to-low propagation delay specification is met, and $t_{p}$ takes a reasonable value.

Voltage Transfer Characteristic (VTC) To compute both the VTC of the inverter and its supply current at various values of the input voltage $V_{i n}$, we apply a dc voltage source at the input and perform a dc sweep with $V_{i n}$ swept over the range 0 to $V_{D D}$, as set up in Ch13_CMOS_Inverter_VTC_Ex.ms10. The resulting VTC is plotted in Fig. B.116. Note that the slope of the VTC in the switching region (where the NMOS and PMOS devices are both in saturation) is not infinite as predicted from the simple theory presented earlier. Rather, the nonzero value of $\lambda$ causes the inverter gain to be finite. The two points on the VTC at which the inverter gain is unity (i.e., the VTC slope is $-1 \mathrm{~V} / \mathrm{V}$ ) and that determine $V_{I L}$ and $V_{I H}$ are indicated in Fig. B.116. The corresponding noise margins are $N M_{L}=0.76 \mathrm{~V}$ and $N M_{H}=0.81 \mathrm{~V}$. Note that the design provides high tolerance to noise, since noise margins are reasonably high ( $N M_{L}$ and $N M_{H}$ are $42 \%$ and $45 \%$ of the supply voltage). This implies that the inverter would provide the correct logic output for an input noise variation of up to approximately $40 \%$ of the $V_{D D}$.


Figure B. 115 Time-domain response of the CMOS inverter to measure $t_{P H L}$.


Figure B. 116 Output voltage versus input voltage for the inverter (to measure low and high noise margins $N_{M L}$ and $N_{M H}$ ).

The threshold voltage $V_{M}$ of the CMOS inverter is defined as the input voltage $v_{\text {IN }}$ that results in an identical switching output voltage $v_{\text {OUT }}$, that is,

$$
V_{M}=v_{\mathrm{IN}} \mid v_{\mathrm{OUT}}=v_{\mathrm{IN}}
$$
Thus, as shown in Fig. B.117, $V_{M}$ is at the intersection of the VTC with the straight line corresponding to $v_{\text {OUT }}=v_{\text {IN }}$. This line can be simply generated by plotting $v_{\text {IN }}$ on the vertical axis, in addition to $v_{\text {OUT }}$. Note that $V_{M}=0.87 \mathrm{~V}$, which is very close to the desired value of $V_{D D} / 2=0.9 \mathrm{~V}$, as desired.


Figure B. 117 Output voltage versus input voltage for the inverter (to the threshold voltage measure $V_{t}$ ).


Figure B. 118 Supply current versus input voltage for the inverter.
Finally, the supply current is plotted versus input voltage in Fig. B.118. Observe that in the transition region, where the inverter is switching, the current is no longer zero. Specifically, the peak current occurs at the inverter threshold voltage.
# APPENDIX C 

## TWO-PORT NETWORK PARAMETERS

## Introduction

At various points throughout the text, we make use of some of the different possible ways to characterize linear two-port networks. A summary of this topic is presented in this appendix.

## C. 1 Characterization of Linear Two-Port Networks

A two-port network (Fig. C.1) has four port variables: $V_{1}, I_{1}, V_{2}$, and $I_{2}$. If the two-port network is linear, we can use two of the variables as excitation variables and the other two as response variables. For instance, the network can be excited by a voltage $V_{1}$ at port 1 and a voltage $V_{2}$ at port 2 , and the two currents, $I_{1}$ and $I_{2}$, can be measured to represent the network response. In this case, $V_{1}$ and $V_{2}$ are independent variables and $I_{1}$ and $I_{2}$ are dependent variables, and the network operation can be described by the two equations

$$
\begin{aligned}
& I_{1}=y_{11} V_{1}+y_{12} V_{2} \\
& I_{2}=y_{21} V_{1}+y_{22} V_{2}
\end{aligned}
$$

Here, the four parameters $y_{11}, y_{12}, y_{21}$, and $y_{22}$ are admittances, and their values completely characterize the linear two-port network.

Depending on which two of the four port variables are used to represent the network excitation, a different set of equations (and a correspondingly different set of parameters) is obtained for characterizing the network. We shall present the four parameter sets commonly used in electronics.

## C.1.1 y Parameters

The short-circuit admittance (or $y$-parameter) characterization is based on exciting the network by $V_{1}$ and $V_{2}$, as shown in Fig. C.2(a). The describing equations are Eqs. (C.1) and (C.2). The four admittance parameters can be defined according to their roles in Eqs. (C.1) and (C.2).


Figure C. 1 The reference directions of the four port variables in a linear two-port network.
Specifically, from Eq. (C.1) we see that $y_{11}$ is defined as

$$
y_{11}=\left.\frac{I_{1}}{V_{1}}\right|_{V_{2}=0}
$$

Thus $y_{11}$ is the input admittance at port 1 with port 2 short-circuited. This definition is illustrated in Fig. C.2(b), which also provides a conceptual method for measuring the input short-circuit admittance $y_{11}$.

The definition of $y_{12}$ can be obtained from Eq. (C.1) as

$$
y_{12}=\left.\frac{I_{1}}{V_{2}}\right|_{V_{1}=0}
$$

Thus $y_{12}$ represents transmission from port 2 to port 1 . Since in amplifiers, port 1 represents the input port and port 2 the output port, $y_{12}$ represents internal feedback in the network. Figure C.2(c) illustrates the definition of and the method for measuring $y_{12}$.

The definition of $y_{21}$ can be obtained from Eq. (C.2) as

$$
y_{21}=\left.\frac{I_{2}}{V_{1}}\right|_{V_{2}=0}
$$


(a)

(b)
(c)


Figure C. 2 Definition of and conceptual measurement circuits for the $y$ parameters.
Thus $y_{21}$ represents transmission from port 1 to port 2 . If port 1 is the input port and port 2 the output port of an amplifier, then $y_{21}$ provides a measure of the forward gain or transmission. Figure C.2(d) illustrates the definition of and the method for measuring $y_{21}$.

The parameter $y_{22}$ can be defined, based on Eq. (C.2), as

$$
y_{22}=\left.\frac{I_{2}}{V_{2}}\right|_{V_{1}=0}
$$

Thus $y_{22}$ is the admittance looking into port 2 while port 1 is short-circuited. For amplifiers, $y_{22}$ is the output short-circuit admittance. Figure C.2(e) illustrates the definition of and the method for measuring $y_{22}$.

# C.1.2 $z$ 

The open-circuit impedance (or $z$-parameter) characterization of two-port networks is based on exciting the network by $I_{1}$ and $I_{2}$, as shown in Fig. C.3(a). The describing equations are

$$
\begin{aligned}
& V_{1}=z_{11} I_{1}+z_{12} I_{2} \\
& V_{2}=z_{21} I_{1}+z_{22} I_{2}
\end{aligned}
$$



(b)

(d)

(c)

Figure C. 3 Definition of and conceptual measurement circuits for the $z$ parameters.
Owing to the duality between the $z$ - and $y$-parameter characterizations, we shall not give a detailed discussion of $z$ parameters. The definition and the method of measuring each of the four $z$ parameters are given in Fig. C.3.

# C.1.3 $h$ 

The hybrid (or $h$-parameter) characterization of two-port networks is based on exciting the network by $I_{1}$ and $V_{2}$, as shown in Fig. C.4(a) (note the reason behind the name hybrid). The describing equations are

$$
\begin{aligned}
& V_{1}=h_{11} I_{1}+h_{12} V_{2} \\
& I_{2}=h_{21} I_{1}+h_{22} V_{2}
\end{aligned}
$$

from which the definition of the four $h$ parameters can be obtained as

$$
\begin{array}{ll}
h_{11}=\left.\frac{V_{1}}{I_{1}}\right|_{V_{2}=0} & h_{21}=\left.\frac{I_{2}}{I_{1}}\right|_{V_{2}=0} \\
h_{12}=\left.\frac{V_{1}}{V_{2}}\right|_{I_{0}=0} & h_{22}=\left.\frac{I_{2}}{V_{2}}\right|_{I_{1}=0}
\end{array}
$$



$$
\begin{aligned}
& V_{1}=h_{11} I_{1}+h_{12} V_{2} \\
& I_{2}=h_{21} I_{1}+h_{22} V_{2}
\end{aligned}
$$



Figure C. 4 Definition of and conceptual measurement circuits for the $h$ parameters.
Thus, $h_{11}$ is the input impedance at port 1 with port 2 short-circuited. The parameter $h_{12}$ represents the reverse or feedback voltage ratio of the network, measured with the input port open-circuited. The forward-transmission parameter $h_{21}$ represents the current gain of the network with the output port short-circuited; for this reason, $h_{21}$ is called the short-circuit current gain. Finally, $h_{22}$ is the output admittance with the input port open-circuited.

The definitions and conceptual measuring setups of the $h$ parameters are given in Fig. C.4.

# C.1.4 $g$ 

The inverse-hybrid (or $g$-parameter) characterization of two-port networks is based on excitation of the network by $V_{1}$ and $I_{2}$, as shown in Fig. C.5(a). The describing equations are

$$
\begin{aligned}
& I_{1}=g_{11} V_{1}+g_{12} I_{2} \\
& V_{2}=g_{21} V_{1}+g_{22} I_{2}
\end{aligned}
$$

The definitions and conceptual measuring setups are given in Fig. C.5.

## C.1.5 Equivalent-Circuit Representation

A two-port network can be represented by an equivalent circuit based on the set of parameters used for its characterization. Figure C. 6 shows four possible equivalent circuits corresponding


(b)

(d)

(c)

(e)

Figure C. 5 Definition of and conceptual measurement circuits for the $g$ parameters.
(a)

(b)

(c)

(d)

Figure C. 6 Equivalent circuits for two-port networks in terms of (a) $y$, (b) $z$, (c) $h$, and (d) $g$ parameters.
to the four parameter types just discussed. Each of these equivalent circuits is a direct pictorial representation of the corresponding two equations describing the network in terms of the particular parameter set.

Finally, it should be mentioned that other parameter sets exist for characterizing two-port networks, but these are not discussed or used in this book.

# EXERCISE 

C. 1 Figure EC. 1 shows the small-signal, equivalent-circuit model of a transistor. Calculate the values of the $h$ parameters.
Ans. $h_{11} \simeq 2.6 \mathrm{k} \Omega ; h_{12} \simeq 2.5 \times 10^{-4} ; h_{21} \simeq 100 ; h_{22} \simeq 2 \times 10^{-5} \Omega$


Figure EC. 1
C. 1 (a) An amplifier characterized by the $h$-parameter equi-valent circuit of Fig. C.6(c) is fed with a source having a voltage $V_{s}$ and a resistance $R_{s}$, and is loaded in a resistance $R_{L}$. Show that its voltage gain is given by

$$
\frac{V_{2}}{V_{s}}=\frac{-h_{21}}{\left(h_{11}+R_{s}\right)\left(h_{22}+1 / R_{L}\right)-h_{12} h_{21}}
$$

(b) Use the expression derived in (a) to find the voltage gain of the transistor in Exercise C. 1 for $R_{s}=1 \mathrm{k} \Omega$ and $R_{L}=10 \mathrm{k} \Omega$.
C. 2 The terminal properties of a two-port network are measured with the following results: With the output short-circuited and an input current of 0.01 mA , the output current is 1.0 mA and the input voltage is 26 mV . With the input open-circuited and a voltage of 10 V applied to the output,
the current in the output is 0.2 mA and the voltage measured at the input is 2.5 mV . Find values for the $h$ parameters of this network.
C. 3 Figure PC. 3 shows the high-frequency equivalent circuit of a BJT. (For simplicity, $r_{s}$ has been omitted.) Find the $y$ parameters.


Figure PC. 3
# APPENDIX D 

## SOME USEFUL NETWORK THEOREMS

## Introduction

In this appendix we review three network theorems that are useful in simplifying the analysis of electronic circuits: Thévenin's theorem, Norton's theorem, and the source-absorption theorem.

## D. 1 Thévenin's Theorem

Thévenin's theorem is used to represent a part of a network by a voltage source $V_{i}$ and a series impedance $Z_{i}$, as shown in Fig. D.1. Figure D.1(a) shows a network divided into two parts, A and B. In Fig. D.1(b), part A of the network has been replaced by its Thévenin equivalent: a voltage source $V_{i}$ and a series impedance $Z_{i}$. Figure D.1(c) illustrates how $V_{i}$ is to be determined: Simply open-circuit the two terminals of network A and measure (or calculate) the voltage that appears between these two terminals. To determine $Z_{i}$, we reduce all external (i.e., independent) sources in network A to zero by short-circuiting voltage sources and open-circuiting current sources. The impedance $Z_{i}$ will be equal to the input impedance of network A after this reduction has been performed, as illustrated in Fig. D.1(d).

## D. 2 Norton's Theorem

Norton's theorem is the dual of Thévenin's theorem. It is used to represent a part of a network by a current source $I_{n}$ and a parallel impedance $Z_{n}$, as shown in Fig. D.2. Figure D.2(a) shows a network divided into two parts, A and B. In Fig. D.2(b), part A has been replaced by its Norton's equivalent: a current source $I_{n}$ and a parallel impedance $Z_{n}$. The Norton's current source $I_{n}$ can be measured (or calculated) as shown in Fig. D.2(c). The terminals of the network being reduced (network A) are shorted, and the current $I_{n}$ will be equal simply to the short-circuit current. To determine the impedance $Z_{n}$, we first reduce the external excitation in network A to zero: That is, we short-circuit independent voltage sources and open-circuit independent current sources. The impedance $Z_{n}$ will be equal to the input impedance of network A after this source-elimination process has taken place. Thus the Norton impedance $Z_{n}$ is equal to the Thévenin impedance $Z_{i}$. Finally, note that $I_{n}=V_{i} / Z$, where $Z=Z_{n}=Z_{i}$.


Figure D. 1 Thévenin's theorem.


Figure D. 2 Norton's theorem.

# Example D. 1 

Figure D.3(a) shows a bipolar junction transistor circuit. The transistor is a three-terminal device with the terminals labeled E (emitter), B (base), and C (collector). As shown, the base is connected to the dc power supply $V^{+}$via the voltage divider composed of $R_{1}$ and $R_{2}$. The collector is connected to the dc supply $V^{+}$ through $R_{3}$ and to ground through $R_{4}$. To simplify the analysis, we wish to apply Thévenin's theorem to reduce the circuit.

## Solution

Thévenin's theorem can be used at the base side to reduce the network composed of $V^{+}, R_{1}$, and $R_{2}$ to a dc voltage source $V_{B B}$,

$$
V_{B B}=V^{+} \frac{R_{2}}{R_{1}+R_{2}}
$$


Figure D. 3 Thévenin's theorem applied to simplify the circuit of (a) to that in (b). (See Example D.1.)
and a resistance $R_{B}$,

$$
R_{B}=R_{1} \| R_{2}
$$

where $\|$ denotes "in parallel with." At the collector side, Thévenin's theorem can be applied to reduce the network composed of $V^{+}, R_{3}$, and $R_{4}$ to a dc voltage source $V_{C C}$,

$$
V_{C C}=V^{+} \frac{R_{4}}{R_{3}+R_{4}}
$$

and a resistance $R_{C}$,

$$
R_{C}=R_{3} \| R_{4}
$$

The reduced circuit is shown in Fig. D.3(b).

# D. 3 Source-Absorption Theorem 

Consider the situation shown in Fig. D.4. In the course of analyzing a network, we find a controlled current source $I_{x}$ appearing between two nodes whose voltage difference is the controlling voltage $V_{x}$. That is, $I_{x}=g_{m} V_{x}$ where $g_{m}$ is a conductance. We can replace this controlled source by an impedance $Z_{x}=V_{x} / I_{x}=1 / g_{m}$, as shown in Fig. D.4, because the current drawn by this impedance will be equal to the current of the controlled source that we have replaced.


Figure D. 4 The source-absorption theorem.
# Example D. 2 

Figure D.5(a) shows the small-signal, equivalent-circuit model of a transistor. We want to find the resistance $R_{\text {in }}$ "looking into" the emitter terminal E-that is, the resistance between the emitter and ground-with the base B and collector C grounded.


Figure D. 5 Circuit for Example D.2.

## Solution

From Fig. D.5(a), we see that the voltage $v_{n}$ will be equal to $-v_{c}$. Thus, looking between E and ground, we see a resistance $r_{n}$ in parallel with a current source drawing a current $g_{m} v_{c}$ away from terminal E. The latter source can be replaced by a resistance $\left(1 / g_{m}\right)$, resulting in the input resistance $R_{\text {in }}$ given by

$$
R_{\text {in }}=r_{n} \|\left(1 / g_{m}\right)
$$

as illustrated in Fig. D.5(b).

## EXERCISES

D. 1 A source is measured and found to have a $10-\mathrm{V}$ open-circuit voltage and to provide 1 mA into a short circuit. Calculate its Thévenin and Norton equivalent source parameters.
Ans. $V_{c}=10 \mathrm{~V} ; Z_{s}=Z_{u}=10 \mathrm{k} \Omega ; I_{u}=1 \mathrm{~mA}$
D. 2 In the circuit shown in Fig. ED.2, the diode has a voltage drop $V_{D} \simeq 0.7 \mathrm{~V}$. Use Thévenin's theorem to simplify the circuit and hence calculate the diode current $I_{D}$.
Ans. 1 mA


Figure ED. 2
D. 3 The two-terminal device M in the circuit of Fig. ED. 3 has a current $I_{M} \simeq 1 \mathrm{~mA}$ independent of the voltage $V_{M}$ across it. Use Norton's theorem to simplify the circuit and hence calculate the voltage $V_{M}$. Ans. 5 V


Figure ED. 3

D. 1 Consider the Thévenin equivalent circuit characterized by $V_{t}$ and $Z_{t}$. Find the open-circuit voltage $V_{o c}$ and the shortcircuit current $I_{s c}$ (i.e., the current that flows when the terminals are shorted together). Express $Z_{t}$ in terms of $V_{o c}$ and $I_{s c}$.
D. 2 Repeat Problem D. 1 for a Norton equivalent circuit characterized by $I_{n}$ and $Z_{n}$.
D. 3 A voltage divider consists of a $9-\mathrm{k} \Omega$ resistor connected to +10 V and a resistor of $1 \mathrm{k} \Omega$ connected to ground. What is the Thévenin equivalent of this voltage divider? What output voltage results if it is loaded with $1 \mathrm{k} \Omega$ ? Calculate this two ways: directly and using your Thévenin equivalent.


Figure PD. 4
D. 4 Find the output voltage and output resistance of the circuit shown in Fig. PD. 4 by considering a succession of Thévenin equivalent circuits.
D. 5 Repeat Example D. 2 with a resistance $R_{B}$ connected between B and ground in Fig. D. 5 (i.e., rather than directly grounding the base B as indicated in Fig. D.5).
D. 6 Figure PD.6(a) shows the circuit symbol of a device known as the $p$-channel junction field-effect transistor (JFET). As indicated, the JFET has three terminals. When the gate terminal G is connected to the source terminal S , the two-terminal device shown in Fig. PD.6(b) is obtained. Its $i-v$ characteristic is given by

$$
\begin{array}{ll}
i=I_{D S S}\left[2 \frac{v}{V_{P}}-\left(\frac{v}{V_{P}}\right)^{2}\right] & \text { for } v \leq V_{P} \\
i=I_{D S S} & \text { for } v \geq V_{P}
\end{array}
$$

where $I_{D S S}$ and $V_{P}$ are positive constants for the particular JFET. Now consider the circuit shown in Fig. PD.6(c) and let $V_{P}=2 \mathrm{~V}$ and $I_{D S S}=2 \mathrm{~mA}$. For $V^{+}=10 \mathrm{~V}$ show that the JFET is operating in the constant-current mode and find the voltage across it. What is the minimum value of $V^{+}$for which this mode of operation is maintained? For $V^{+}=2 \mathrm{~V}$ find the values of $I$ and $V$.


Figure PD. 6
# APPENDIX E 

## SINGLE-TIME-CONSTANT CIRCUITS

## Introduction

Single-time-constant (STC) circuits are those circuits that are composed of or can be reduced to one reactive component (inductance or capacitance) and one resistance. An STC circuit formed of an inductance $L$ and a resistance $R$ has a time constant $\tau=L / R$. The time constant $\tau$ of an STC circuit composed of a capacitance $C$ and a resistance $R$ is given by $\tau=C R$.

Although STC circuits are quite simple, they play an important role in the design and analysis of linear and digital circuits. For instance, the analysis of an amplifier circuit can usually be reduced to the analysis of one or more STC circuits. For this reason, we will review in this appendix the process of evaluating the response of STC circuits to sinusoidal and other input signals such as step and pulse waveforms. The latter signal waveforms are encountered in some amplifier applications but are more important in switching circuits, including digital circuits.

## E. 1 Evaluating the Time Constant

The first step in the analysis of an STC circuit is to evaluate its time constant $\tau$.

## Example E. 1

Reduce the circuit in Fig. E.1(a) to an STC circuit, and find its time constant.

## Solution

The reduction process is illustrated in Fig. E. 1 and consists of repeated applications of Thévenin's theorem. From the final circuit (Fig. E.1c), we obtain the time constant as

$$
\tau=C\left\{R_{4} \|\left[R_{3}+\left(R_{1} \| R_{2}\right)\right]\right\}
$$

## E.1.1 Rapid Evaluation of $\tau$

In many instances, it will be important to be able to evaluate rapidly the time constant $\tau$ of a given STC circuit. A simple method for accomplishing this goal consists first of reducing the excitation to zero; that is, if the excitation is by a voltage source, short it, and if by a current


Figure E. 1 The reduction of the circuit in (a) to the STC circuit in (c) through the repeated application of Thévenin's theorem.
source, open it. Then, if the circuit has one reactive component and a number of resistances, "grab hold" of the two terminals of the reactive component (capacitance or inductance) and find the equivalent resistance $R_{\mathrm{eq}}$ seen by the component. The time constant is then either $L / R_{\mathrm{eq}}$ or $C R_{\mathrm{eq}}$. As an example, in the circuit of Fig. E.1(a), we find that the capacitor $C$ "sees" a resistance $R_{4}$ in parallel with the series combination of $R_{3}$ and $R_{2}$ in parallel with $R_{1}$. Thus

$$
R_{\mathrm{eq}}=R_{4} \|\left[R_{3}+\left(R_{2} \| R_{1}\right)\right]
$$

and the time constant is $C R_{\mathrm{eq}}$.
In some cases it may be found that the circuit has one resistance and a number of capacitances or inductances. In such a case, the procedure should be inverted; that is, "grab hold" of the resistance terminals and find the equivalent capacitance $C_{\mathrm{eq}}$, or equivalent inductance $L_{\mathrm{eq}}$, seen by this resistance. The time constant is then found as $C_{\mathrm{eq}} R$ or $L_{\mathrm{eq}} / R$. This is illustrated in Example E.2.

# Example E. 2 

Find the time constant of the circuit in Fig. E.2.


Figure E. 2 Circuit for Example E.2.# Solution 

After reducing the excitation to zero by short-circuiting the voltage source, we see that the resistance $R$ "sees" an equivalent capacitance $C_{1}+C_{2}$. Thus, the time constant $\tau$ is given by

$$
\tau=\left(C_{1}+C_{2}\right) R
$$

Finally, in some cases an STC circuit has more than one resistance and more than one capacitance (or more than one inductance). Such cases require some initial work to simplify the circuit, as illustrated by Example E.3.

## Example E. 3

Here we show that the response of the circuit in Fig. E.3(a) can be obtained using the method of analysis of STC circuits.

## Solution

The analysis steps are illustrated in Fig. E.3. In Fig. E.3(b) we show the circuit excited by two separate but equal voltage sources. The reader should convince himself or herself of the equivalence of the circuits in Fig. E.3(a) and E.3(b). The "trick" employed to obtain the arrangement in Fig. E.3(b) is a very useful one.


Figure E. 3 The response of the circuit in (a) can be found by superposition, that is, by summing the responses of the circuits in (d) and (e).
# Example E. 3 continued 

Application of Thévenin's theorem to the circuit to the left of the line $X X^{\prime}$ and then to the circuit to the right of that line results in the circuit of Fig. E.3(c). Since this is a linear circuit, the response may be obtained using the principle of superposition. Specifically, the output voltage $v_{o}$ will be the sum of the two components $v_{o 1}$ and $v_{o 2}$. The first component, $v_{o 1}$, is the output due to the left-hand-side voltage source with the other voltage source reduced to zero. The circuit for calculating $v_{o 1}$ is shown in Fig. E.3(d). It is an STC circuit with a time constant given by

$$
\tau=\left(C_{1}+C_{2}\right)\left(R_{1} \| R_{2}\right)
$$

Similarly, the second component $v_{o 2}$ is the output obtained with the left-hand-side voltage source reduced to zero. It can be calculated from the circuit of Fig. E.3(e), which is an STC circuit with the same time constant $\tau$.

Finally, it should be observed that the fact that the circuit is an STC one can also be ascertained by setting the independent source $v_{t}$ in Fig. E.3(a) to zero. Also, the time constant is then immediately obvious.

## E. 2 Classification of STC Circuits

STC circuits can be classified into two categories, low-pass (LP) and high-pass (HP) types, with each category displaying distinctly different signal responses. The task of finding whether an STC circuit is of LP or HP type may be accomplished in a number of ways, the simplest of which uses the frequency domain response. Specifically, low-pass circuits pass dc (i.e., signals with zero frequency) and attenuate high frequencies, with the transmission being zero at $\omega=\infty$. Thus, we can test for the circuit type either at $\omega=0$ or at $\omega=\infty$. At $\omega=0$ capacitors should be replaced by open circuits $(1 / j \omega C=\infty)$ and inductors should be replaced by short circuits $(j \omega L=0)$. Then if the output is zero, the circuit is of the high-pass type, while if the output is finite, the circuit is of the low-pass type. Alternatively, we may test at $\omega=\infty$ by replacing capacitors with short circuits $(1 / j \omega C=0)$ and inductors with open circuits $(j \omega L=\infty)$. Then if the output is finite, the circuit is of the HP type, whereas if the output is zero, the circuit is of the LP type. In Table E.1, which provides a summary of these results, s.c. stands for short circuit and o.c. for open circuit.

Figure E. 4 shows examples of low-pass STC circuits, and Fig. E. 5 shows examples of high-pass STC circuits. For each circuit we have indicated the input and output variables of interest. Note that a given circuit can be of either category, depending on the input and output variables. The reader is urged to verify, using the rules of Table E.1, that the circuits of Figs. E. 4 and E. 5 are correctly classified.

Table E. 1 Rules for finding the type of STC Circuit

| Test at | Replace | Circuit is LP if | Circuit is HP if |
| :-- | :-- | :-- | :-- |
| $\omega=0$ | $C$ by o.c. | output is finite | output is zero |
| $\omega=\infty$ | $C$ by s.c. | output is zero | output is finite |
|  | $L$ by o.c. |  |  |


Figure E. 4 STC circuits of the low-pass type.


Figure E. 5 STC circuits of the high-pass type.

# EXERCISES 

E. 1 Find the time constants for the circuits shown in Fig. EE.1.

Ans. (a) $\frac{\left(L_{1}\left\|L_{2}\right)}{R}$; (b) $\frac{\left(L_{1}\left\|L_{2}\right)\right.}{\left(R_{1}\left\|R_{2}\right)\right.}$


Figure EE. 1
E. 2 Classify the following circuits as STC high-pass or low-pass: Fig. E.4(a) with output $i_{o}$ in $C$ to ground; Fig. E.4(b) with output $i_{o}$ in $R$ to ground; Fig. E.4(d) with output $i_{o}$ in $C$ to ground; Fig. E.4(e) with output $i_{o}$ in $R$ to ground; Fig. E.5(b) with output $i_{o}$ in $L$ to ground; and Fig. E.5(d) with output $v_{o}$ across $C$.
Ans. HP; LP; HP; HP; LP; LP

# E. 3 Frequency Response of STC Circuits 

## E.3.1 Low-Pass Circuits

The transfer function $T(s)$ of an STC low-pass circuit can always be written in the form

$$
T(s)=\frac{K}{1+\left(s / \omega_{0}\right)}
$$

which, for physical frequencies, where $s=j \omega$, becomes

$$
T(j \omega)=\frac{K}{1+j\left(\omega / \omega_{0}\right)}
$$

where $K$ is the magnitude of the transfer function at $\omega=0(\mathrm{dc})$ and $\omega_{0}$ is defined by

$$
\omega_{0}=1 / \tau
$$

with $\tau$ being the time constant. Thus the magnitude response is given by

$$
|T(j \omega)|=\frac{K}{\sqrt{1+\left(\omega / \omega_{0}\right)^{2}}}
$$

and the phase response is given by

$$
\phi(\omega)=-\tan ^{-1}\left(\omega / \omega_{0}\right)
$$

Figure E. 6 sketches the magnitude and phase responses for an STC low-pass circuit. The magnitude response shown in Fig. E.6(a) is simply a graph of the function in Eq. (E.3). The magnitude is normalized with respect to the dc gain $K$ and is expressed in decibels; that is, the plot is for $20 \log |T(j \omega) / K|$, with a logarithmic scale used for the frequency axis. Furthermore, the frequency variable has been normalized with respect to $\omega_{0}$. As shown, the magnitude curve is closely defined by two straight-line asymptotes. The low-frequency asymptote is a horizontal straight line at 0 dB . To find the slope of the high-frequency asymptote, consider Eq. (E.3) and let $\omega / \omega_{0} \gg 1$, resulting in

$$
|T(j \omega)| \simeq K \frac{\omega_{0}}{\omega}
$$

It follows that if $\omega$ doubles in value, the magnitude is halved. On a logarithmic frequency axis, doublings of $\omega$ represent equally spaced points, with each interval called an octave. Halving the magnitude function corresponds to a $6-\mathrm{dB}$ reduction in transmission $(20 \log 0.5=-6 \mathrm{~dB})$. Thus the slope of the high-frequency asymptote is $-6 \mathrm{~dB} /$ octave. This can be equivalently expressed as $-20 \mathrm{~dB} /$ decade, where "decade" indicates an increase in frequency by a factor of 10 .

The two straight-line asymptotes of the magnitude-response curve meet at the "corner frequency" or "break frequency" $\omega_{0}$. The difference between the actual magnitude-response


Figure E. 6 (a) Magnitude and (b) phase response of STC circuits of the low-pass type.
curve and the asymptotic response is largest at the corner frequency, where its value is 3 dB . To verify that this value is correct, simply substitute $\omega=\omega_{0}$ in Eq. (E.3) to obtain

$$
\left|T\left(j \omega_{0}\right)\right|=K / \sqrt{2}
$$

Thus at $\omega=\omega_{0}$, the gain drops by a factor of $\sqrt{2}$ relative to the dc gain, which corresponds to a $3-\mathrm{dB}$ reduction in gain. The corner frequency $\omega_{0}$ is appropriately referred to as the $3-\mathrm{dB}$ frequency.

Similar to the magnitude response, the phase-response curve, shown in Fig. E.6(b), is closely defined by straight-line asymptotes. Note that at the corner frequency the phase is $-45^{\circ}$, and that for $\omega \gg \omega_{0}$ the phase approaches $-90^{\circ}$. Also note that the $-45^{\circ} /$ decade straight line approximates the phase function, with a maximum error of $5.7^{\circ}$, over the frequency range $0.1 \omega_{0}$ to $10 \omega_{0}$.

# Example E. 4 

Consider the circuit shown in Fig. E.7(a), where an ideal voltage amplifier of gain $\mu=-100$ has a small $(10-\mathrm{pF})$ capacitance connected in its feedback path. The amplifier is fed by a voltage source having a source resistance of $100 \mathrm{k} \Omega$. Show that the frequency response $V_{s} / V_{r}$ of this amplifier is equivalent to that of an STC circuit, and sketch the magnitude response.


Figure E. 7 (a) An amplifier circuit and (b) a sketch of the magnitude of its transfer function.

# Solution 

Direct analysis of the circuit in Fig. E.7(a) results in the transfer function

$$
\frac{V_{s}}{V_{s}}=\frac{\mu}{1+s R C_{f}(-\mu+1)}
$$

which can be seen to be that of a low-pass STC circuit with a dc gain $\mu=-100$ (or, equivalently, 40 dB ) and a time constant $\tau=R C_{f}(-\mu+1)=100 \times 10^{3} \times 10 \times 10^{-12} \times 101 \simeq 10^{-4} \mathrm{~s}$, which corresponds to a frequency $\omega_{0}=1 / \tau=10^{4} \mathrm{rad} / \mathrm{s}$. The magnitude response is sketched in Fig. E.7(b).

## E.3.2 High-Pass Circuits

The transfer function $T(s)$ of an STC high-pass circuit can always be expressed in the form

$$
T(s)=\frac{K s}{s+\omega_{0}}
$$

which for physical frequencies $s=j \omega$ becomes

$$
T(j \omega)=\frac{K}{1-j \omega_{0} / \omega}
$$

where $K$ denotes the gain as $s$ or $\omega$ approaches infinity and $\omega_{0}$ is the inverse of the time constant $\tau$,

$$
\omega_{0}=1 / \tau
$$

The magnitude response

$$
|T(j \omega)|=\frac{K}{\sqrt{1+\left(\omega_{0} / \omega\right)^{2}}}
$$

and the phase response

$$
\phi(\omega)=\tan ^{-1}\left(\omega_{0} / \omega\right)
$$


Figure E. 8 (a) Magnitude and (b) phase response of STC circuits of the high-pass type.
are sketched in Fig. E.8. As in the low-pass case, the magnitude and phase curves are well defined by straight-line asymptotes. Because of the similarity (or, more appropriately, duality) with the low-pass case, no further explanation will be given.

# EXERCISES 

E. 3 Find the dc transmission, the corner frequency $f_{0}$, and the transmission at $f=2 \mathrm{MHz}$ for the low-pass STC circuit shown in Fig. EE.3.


Figure EE. 3
Ans. $-6 \mathrm{~dB} ; 318 \mathrm{kHz} ;-22 \mathrm{~dB}$
E. 4 Find the transfer function $T(s)$ of the circuit in Fig. E.2. What type of STC network is it? Ans. $T(s)=\frac{C_{1}}{C_{1}+C_{2}} \frac{s}{s+\left[1 /\left(C_{1}+C_{2}\right) R\right]} ; \mathrm{HP}$
E. 5 For the situation discussed in Exercise E.4, if $R=10 \mathrm{k} \Omega$, find the capacitor values that result in the circuit having a high-frequency transmission of $0.5 \mathrm{~V} / \mathrm{V}$ and a corner frequency $\omega_{0}=10 \mathrm{rad} / \mathrm{s}$. Ans. $C_{1}=C_{2}=5 \mu \mathrm{~F}$
E. 6 Find the high-frequency gain, the 3-dB frequency $f_{0}$, and the gain at $f=1 \mathrm{~Hz}$ of the capacitively coupled amplifier shown in Fig. EE.6. Assume the voltage amplifier to be ideal.


Figure EE. 6

Ans. $40 \mathrm{~dB} ; 15.9 \mathrm{~Hz} ; 16 \mathrm{~dB}$

# E. 4 Step Response of STC Circuits 

In this section we consider the response of STC circuits to the step-function signal shown in Fig. E.9. Knowledge of the step response enables rapid evaluation of the response to other switching-signal waveforms, such as pulses and square waves.

## E.4.1 Low-Pass Circuits

In response to an input step signal of height $S$, a low-pass STC circuit (with a dc gain $K=1$ ) produces the waveform shown in Fig. E.10. Note that while the input rises from 0 to $S$ at $t=0$, the output does not respond immediately to this transient and simply begins to rise exponentially toward the final dc value of the input, $S$. In the long term-that is, for $t \gg$ $\tau$ - the output approaches the dc value $S$, a manifestation of the fact that low-pass circuits faithfully pass dc.

The equation of the output waveform can be obtained from the expression

$$
y(t)=Y_{\infty}-\left(Y_{\infty}-Y_{0+}\right) e^{-t / \tau}
$$

where $Y_{\infty}$ denotes the final value or the value toward which the output is heading and $Y_{0+}$ denotes the value of the output immediately after $t=0$. This equation states that the output at


Figure E. 9 A step-function signal of height $S$.


Figure E. 10 The output $y(t)$ of a low-pass STC circuit excited by a step of height $S$.


Figure E. 11 The output $y(t)$ of a high-pass STC circuit excited by a step of height $S$.
any time $t$ is equal to the difference between the final value $Y_{\infty}$ and a gap that has an initial value of $Y_{\infty}-Y_{0+}$ and is "shrinking" exponentially. In our case, $Y_{\infty}=S$ and $Y_{0+}=0$; thus,

$$
y(t)=S\left(1-e^{-t / \tau}\right)
$$

The reader's attention is drawn to the slope of the tangent to $y(t)$ at $t=0$, which is indicated in Fig. E. 10 .

# E.4.2 High-Pass Circuits 

The response of an STC high-pass circuit (with a high-frequency gain $K=1$ ) to an input step of height $S$ is shown in Fig. E.11. The high-pass circuit faithfully transmits the transient part of the input signal (the step change) but blocks the dc. Thus the output at $t=0$ follows the input,

$$
Y_{0+}=S
$$

and then it decays toward zero,

$$
Y_{\infty}=0
$$

Substituting for $Y_{0+}$ and $Y_{\infty}$ in Eq. (E.9) results in the output $y(t)$,

$$
y(t)=S e^{-t / \tau}
$$

The reader's attention is drawn to the slope of the tangent to $y(t)$ at $t=0$, indicated in Fig. E. 11 .
# Example E. 5 

This example is a continuation of the problem considered in Example E.3. For an input $v_{I}$ that is a $10-\mathrm{V}$ step, find the condition under which the output $v_{O}$ is a perfect step.

## Solution

Following the analysis in Example E.3, which is illustrated in Fig. E.3, we have

$$
v_{O 1}=k_{v}\left[10\left(1-e^{-t / \tau}\right)\right]
$$

where

$$
k_{v} \equiv \frac{R_{2}}{R_{1}+R_{2}}
$$

and

$$
v_{O 2}=k_{v}\left(10 e^{-t / \tau}\right)
$$

where

$$
k_{v} \equiv \frac{C_{1}}{C_{1}+C_{2}}
$$

and

$$
\tau=\left(C_{1}+C_{2}\right)\left(R_{1} \| R_{2}\right)
$$

Thus

$$
\begin{aligned}
v_{O} & =v_{O 1}+v_{O 2} \\
& =10 k_{v}+10 e^{-t / \tau}\left(k_{v}-k_{r}\right)
\end{aligned}
$$

It follows that the output can be made a perfect step of height $10 k_{v}$ volts if we arrange that

$$
k_{v}=k_{r}
$$

that is, if the resistive voltage divider ratio is made equal to the capacitive voltage divider ratio.
This example illustrates an important technique, namely, that of the "compensated attenuator." An application of this technique is found in the design of the oscilloscope probe. The oscilloscope probe problem is investigated in Problem E.3.

## EXERCISES

E. 7 For the circuit of Fig. E.4(f), find $v_{O}$ if $i_{I}$ is a $3-\mathrm{mA}$ step, $R=1 \mathrm{k} \Omega$, and $C=100 \mathrm{pF}$. Ans. $3\left(1-e^{-\mu i^{2} t}\right)$
E. 8 In the circuit of Fig. E.5(f), find $v_{O}(t)$ if $i_{I}$ is a $2-\mathrm{mA}$ step, $R=2 \mathrm{k} \Omega$, and $L=10 \mu \mathrm{H}$. Ans. $4 e^{-2 \times \mu i^{2} t}$
E. 9 The amplifier circuit of Fig. EE. 6 is fed with a signal source that delivers a $20-\mathrm{mV}$ step. If the source resistance is $100 \mathrm{k} \Omega$, find the time constant $\tau$ and $v_{O}(t)$.
Ans. $\tau=2 \times 10^{-2} \mathrm{~s} ; v_{O}(t)=1 \times e^{-50 t}$
E. 10 For the circuit in Fig. E. 2 with $C_{1}=C_{2}=0.5 \mu \mathrm{~F}, R=1 \mathrm{M} \Omega$, find $v_{O}(t)$ if $v_{I}(t)$ is a $10-\mathrm{V}$ step. Ans. $5 e^{-t}$
E. 11 Show that the area under the exponential of Fig. E. 11 is equal to that of the rectangle of height $S$ and width $\tau$.# E. 5 Pulse Response of STC Circuits 

Figure E. 12 shows a pulse signal whose height is $P$ and whose width is $T$. We wish to find the response of STC circuits to input signals of this form. Note at the outset that a pulse can be considered as the sum of two steps: a positive one of height $P$ occurring at $t=0$ and a negative one of height $P$ occurring at $t=T$. Thus, the response of a linear circuit to the pulse signal can be obtained by summing the responses to the two step signals.

## E.5.1 Low-Pass Circuits

Figure E.13(a) shows the response of a low-pass STC circuit (having unity dc gain) to an input pulse of the form shown in Fig. E.12. In this case, we have assumed that the time constant $\tau$ is in the same range as the pulse width $T$. As shown, the LP circuit does not respond immediately to the step change at the leading edge of the pulse; rather, the output starts to rise exponentially toward a final value of $P$. This exponential rise, however, will be stopped at time $t=T$, that is, at the trailing edge of the pulse when the input undergoes a negative step change. Again, the output will respond by starting an exponential decay toward the final value of the input, which is zero. Finally, note that the area under the output waveform will be equal to the area under the input pulse waveform, since the LP circuit faithfully passes dc.

A low-pass effect usually occurs when a pulse signal from one part of an electronic system is connected to another. The low-pass circuit in this case is formed by the output resistance (Thévenin's equivalent resistance) of the system part from which the signal originates and the input capacitance of the system part to which the signal is fed. This unavoidable low-pass filter will cause distortion-of the type shown in Fig. E.13(a)—of the pulse signal. In a well-designed system such distortion is kept to a low value by arranging that the time constant $\tau$ be much smaller than the pulse width $T$. In this case, the result will be a slight rounding of the pulse edges, as shown in Fig. E.13(b). Note, however, that the edges are still exponential.

The distortion of a pulse signal by a parasitic (i.e., unwanted) low-pass circuit is measured by its rise time and fall time. The rise time is conventionally defined as the time taken by the amplitude to increase from $10 \%$ to $90 \%$ of the final value. Similarly, the fall time is the time during which the pulse amplitude falls from $90 \%$ to $10 \%$ of the maximum value. These definitions are illustrated in Fig. E.13(b). By use of the exponential equations of the rising and falling edges of the output waveform, it can be easily shown that

$$
t_{r}=t_{f} \simeq 2.2 \tau
$$

which can be also expressed in terms of $f_{0}=\omega_{0} / 2 \pi=1 / 2 \pi \tau$ as

$$
t_{r}=t_{f} \simeq \frac{0.35}{f_{0}}
$$



Figure E. 12 A pulse signal with height $P$ and width $T$.


Figure E. 13 Pulse responses of three STC low-pass circuits.
Finally, we note that the effect of the parasitic low-pass circuits that are always present in a system is to "slow down" the operation of the system: To keep the signal distortion within acceptable limits, one has to use a relatively long pulse width (for a given low-pass time constant).

The other extreme case-namely, when $\tau$ is much larger than $T$, is illustrated in Fig. E.13(c). As shown, the output waveform rises exponentially toward the level $P$. However, since $\tau \gg T$, the value reached at $t=T$ will be much smaller than $P$. At $t=T$, the output waveform starts its exponential decay toward zero. Note that in this case the output waveform bears little resemblance to the input pulse. Also note that because $\tau \gg T$, the portion of the exponential curve from $t=0$ to $t=T$ is almost linear. Since the slope of this linear curve is proportional to the height of the input pulse, we see that the output waveform approximates the time integral of the input pulse. That is, a low-pass network with a large time constant approximates the operation of an integrator.

# E.5.2 High-Pass Circuits 

Figure E.14(a) shows the output of an STC HP circuit (with unity high-frequency gain) excited by the input pulse of Fig. E.12, assuming that $\tau$ and $T$ are comparable in value. As shown, the step transition at the leading edge of the input pulse is faithfully reproduced at the output of the HP circuit. However, since the HP circuit blocks dc, the output waveform immediately starts an exponential decay toward zero. This decay process is stopped at $t=T$, when the negative step transition of the input occurs and the HP circuit faithfully reproduces it. Thus, at $t=T$ the output waveform exhibits an undershoot. Then it starts an exponential decay toward zero. Finally, note that the area of the output waveform above the zero axis will be equal to that below the axis for a total average area of zero, consistent with the fact that HP circuits block dc.

In many applications, an STC high-pass circuit is used to couple a pulse from one part of a system to another part. In such an application, it is necessary to keep the distortion in the pulse shape as small as possible. This can be accomplished by selecting the time constant $\tau$ to be much longer than the pulse width $T$. If this is indeed the case, the loss in amplitude during the pulse period $T$ will be very small, as shown in Fig. E.14(b). Nevertheless, the output waveform still swings negatively, and the area under the negative portion will be equal to that under the positive portion.

Consider the waveform in Fig. E.14(b). Since $\tau$ is much larger than $T$, it follows that the portion of the exponential curve from $t=0$ to $t=T$ will be almost linear and that its slope


Figure E. 14 Pulse responses of three STC high-pass circuits.
will be equal to the slope of the exponential curve at $t=0$, which is $P / \tau$. We can use this value of the slope to determine the loss in amplitude $\Delta P$ as

$$
\Delta P \simeq \frac{P}{\tau} T
$$

The distortion effect of the high-pass circuit on the input pulse is usually specified in terms of the per-unit or percentage loss in pulse height. This quantity is taken as an indication of the "sag" in the output pulse,

$$
\text { Percentage sag } \equiv \frac{\Delta P}{P} \times 100
$$

Thus

$$
\text { Percentage sag }=\frac{T}{\tau} \times 100
$$

Finally, note that the magnitude of the undershoot at $t=T$ is equal to $\Delta P$.
The other extreme case-namely, $\tau \ll T$-is illustrated in Fig. E.14(c). In this case, the exponential decay is quite rapid, resulting in the output becoming almost zero shortly beyond the leading edge of the pulse. At the trailing edge of the pulse, the output swings negatively by an amount almost equal to the pulse height $P$. Then the waveform decays rapidly to zero. As seen from Fig. E.14(c), the output waveform bears no resemblance to the input pulse. It consists of two spikes: a positive one at the leading edge and a negative one at the trailing edge. Note that the output waveform is approximately equal to the time derivative of the input pulse. That is, for $\tau \ll T$, an STC high-pass circuit approximates a differentiator. However, the resulting differentiator is not an ideal one; an ideal differentiator would produce two impulses. Nevertheless, high-pass STC circuits with short time constants are employed in some applications to produce sharp pulses or spikes at the transitions of an input waveform.
# EXERCISES 

E. 12 Find the rise and fall times of a $1-\mu \mathrm{s}$ pulse after it has passed through a low-pass RC circuit with a corner frequency of 10 MHz .
Ans. 35 ns
E. 13 Consider the pulse response of a low-pass STC circuit, as shown in Fig. E.13(c). If $\tau=100 T$, find the output voltage at $t=T$. Also, find the difference in the slope of the rising portion of the output waveform at $t=0$ and $t=T$ (expressed as a percentage of the slope at $t=0$ ).
Ans. $0.01 P ; 1 \%$
E. 14 The output of an amplifier stage is connected to the input of another stage via a capacitance $C$. If the first stage has an output resistance of $10 \mathrm{k} \Omega$, and the second stage has an input resistance of $40 \mathrm{k} \Omega$, find the minimum value of $C$ such that a $10-\mu \mathrm{s}$ pulse exhibits less than $1 \%$ sag.
Ans. $0.02 \mu \mathrm{~F}$
E. 15 A high-pass STC circuit with a time constant of $100 \mu \mathrm{~s}$ is excited by a pulse of $1-\mathrm{V}$ height and $100-\mu \mathrm{s}$ width. Calculate the value of the undershoot in the output waveform.
Ans. 0.632 V

## PROBLEMS

E. 1 Consider the circuit of Fig. E.3(a) and the equivalent shown in (d) and (e). There, the output, $v_{O}=v_{O 1}+v_{O 2}$, is the sum of outputs of a low-pass and a high-pass circuit, each with the time constant $\tau=\left(C_{1}+C_{2}\right)\left(R_{1} \| R_{2}\right)$. What is the condition that makes the contribution of the low-pass circuit at zero frequency equal to the contribution of the high-pass circuit at infinite frequency? Show that this condition can be expressed as $C_{1} R_{1}=C_{2} R_{2}$. If this condition applies, sketch $\left|V_{o} / V_{i}\right|$ versus frequency for the case $R_{1}=R_{2}$.
E. 2 Use the voltage divider rule to find the transfer function $V_{o}(s) / V_{i}(s)$ of the circuit in Fig. E.3(a). Show that the transfer function can be made independent of frequency if the condition $C_{1} R_{1}=C_{2} R_{2}$ applies. Under this condition the circuit is called a compensated attenuator. Find the transmission of the compensated attenuator in terms of $R_{1}$ and $R_{2}$.

D **E. 3 The circuit of Fig. E.3(a) is used as a compensated attenuator (see Problems E. 1 and E.2) for an
oscilloscope probe. The objective is to reduce the signal voltage applied to the input amplifier of the oscilloscope, with the signal attenuation independent of frequency. The probe itself includes $R_{1}$ and $C_{1}$, while $R_{2}$ and $C_{2}$ model the oscilloscope input circuit. For an oscilloscope having an input resistance of $1 \mathrm{M} \Omega$ and an input capacitance of 30 pF , design a compensated " 10 -to- 1 probe" -that is, a probe that attenuates the input signal by a factor of 10 . Find the input impedance of the probe when connected to the oscilloscope, which is the impedance seen by $v_{I}$ in Fig. E.3(a). Show that this impedance is 10 times higher than that of the oscilloscope itself. This is the great advantage of the 10:1 probe.
E. 4 In the circuits of Figs. E. 4 and E.5, let $L=10 \mathrm{mH}$, $C=0.01 \mu \mathrm{~F}$, and $R=1 \mathrm{k} \Omega$. At what frequency does a phase angle of $45^{\circ}$ occur?
*E. 5 Consider a voltage amplifier with an open-circuit voltage gain $A_{v o}=-100 \mathrm{~V} / \mathrm{V}, R_{o}=0, R_{i}=10 \mathrm{k} \Omega$, and
an input capacitance $C_{i}$ (in parallel with $R_{i}$ ) of 10 pF . The amplifier has a feedback capacitance (a capacitance connected between output and input) $C_{f}=1 \mathrm{pF}$. The amplifier is fed with a voltage source $V$, having a resistance $R_{s}=10 \mathrm{k} \Omega$. Find the amplifier transfer function $V_{o}(s) / V_{s}(s)$ and sketch its magnitude response versus frequency ( dB vs. frequency) on a $\log$ axis.
E. 6 For the circuit in Fig. PE.6, assume the voltage amplifier to be ideal. Derive the transfer function $V_{o}(s) / V_{i}(s)$. What type of STC response is this? For $C=0.01 \mu \mathrm{~F}$ and $R=100 \mathrm{k} \Omega$, find the corner frequency.


Figure PE. 6
E. 7 For the circuits of Figs. E.4(b) and E.5(b), find $v_{i t}(t)$ if $v_{l}$ is a $10-\mathrm{V}$ step, $R=1 \mathrm{k} \Omega$, and $L=1 \mathrm{mH}$.
E. 8 Consider the exponential response of an STC low-pass circuit to a $10-\mathrm{V}$ step input. In terms of the time constant $\tau$, find the time taken for the output to reach $5 \mathrm{~V}, 9 \mathrm{~V}, 9.9 \mathrm{~V}$, and 9.99 V .
E. 9 The high-frequency response of an oscilloscope is specified to be like that of an STC LP circuit with a $100-\mathrm{MHz}$ corner frequency. If this oscilloscope is used to display an ideal step waveform, what rise time ( $10 \%$ to $90 \%$ ) would you expect to observe?
E. 10 An oscilloscope whose step response is like that of a low-pass STC circuit has a rise time of $t_{s}$ seconds. If an input signal having a rise time of $t_{w}$ seconds is displayed, the waveform seen will have a rise time $t_{d}$ seconds, which can be found using the empirical formula $t_{d}=\sqrt{t_{s}^{2}+t_{w}^{2}}$. If $t_{s}=35 \mathrm{~ns}$, what is the $3-\mathrm{dB}$ frequency of the oscilloscope? What is
the observed rise time for a waveform rising in $100 \mathrm{~ns}, 35 \mathrm{~ns}$, and 10 ns ? What is the actual rise time of a waveform whose displayed rise time is 49.5 ns ?
E. 11 A pulse of $10-\mathrm{ms}$ width and $10-\mathrm{V}$ amplitude is transmitted through a system characterized as having an STC high-pass response with a corner frequency of 10 Hz . What undershoot would you expect?
E. 12 An RC differentiator having a time constant $\tau$ is used to implement a short-pulse detector. When a long pulse with $T \gg \tau$ is fed to the circuit, the positive and negative peak outputs are of equal magnitude. At what pulse width does the negative output peak differ from the positive one by $10 \%$ ?
E. 13 A high-pass STC circuit with a time constant of 1 ms is excited by a pulse of $10-\mathrm{V}$ height and $1-\mathrm{ms}$ width. Calculate the value of the undershoot in the output waveform. If an undershoot of 1 V or less is required, what is the time constant necessary?
E. 14 A capacitor $C$ is used to couple the output of an amplifier stage to the input of the next stage. If the first stage has an output resistance of $2 \mathrm{k} \Omega$ and the second stage has an input resistance of $3 \mathrm{k} \Omega$, find the value of $C$ so that a $1-\mathrm{ms}$ pulse exhibits less than $1 \%$ sag. What is the associated 3-dB frequency?

D E. 15 An RC differentiator is used to convert a step voltage change $V$ to a single pulse for a digital-logic application. The logic circuit that the differentiator drives distinguishes signals above $V / 2$ as "high" and below $V / 2$ as "low." What must the time constant of the circuit be to convert a step input into a pulse that will be interpreted as "high" for $10 \mu \mathrm{~s}$ ?

D E. 16 Consider the circuit in Fig. E.7(a) with $\mu=-100$, $C_{f}=100 \mathrm{pF}$, and the amplifier being ideal. Find the value of $R$ so that the gain $\left|V_{o} / V_{s}\right|$ has a 3-dB frequency of 1 kHz .
# APPENDIX F 

## 5-DOMAIN ANALYSIS: POLES, ZEROS, AND BODE PLOTS

In analyzing the frequency response of an amplifier, most of the work involves finding the amplifier voltage gain as a function of the complex frequency $s$. In this $s$-domain analysis, a capacitance $C$ is replaced by an admittance $s C$, or equivalently an impedance $1 / s C$, and an inductance $L$ is replaced by an impedance $s L$. Then, using usual circuit-analysis techniques, one derives the voltage transfer function $T(s) \equiv V_{o}(s) / V_{i}(s)$.

## EXERCISE

F. 1 Find the voltage transfer function $T(s) \equiv V_{o}(s) / V_{i}(s)$ for the STC network shown in Fig. EF.1.


Figure EF. 1
Ans. $T(s)=\frac{1 / C R_{1}}{s+1 / C\left(R_{1} \| R_{2}\right)}$

Once the transfer function $T(s)$ is obtained, it can be evaluated for physical frequencies by replacing $s$ by $j \omega$. The resulting transfer function $T(j \omega)$ is in general a complex quantity whose magnitude gives the magnitude response (or transmission) and whose angle gives the phase response of the amplifier.

In many cases it will not be necessary to substitute $s=j \omega$ and evaluate $T(j \omega)$; rather, the form of $T(s)$ will reveal many useful facts about the circuit performance. In general, for all the circuits dealt with in this book, $T(s)$ can be expressed in the form

$$
T(s)=\frac{a_{m} s^{m}+a_{m-1} s^{m-1}+\ldots+a_{0}}{s^{n}+b_{n-1} s^{n-1}+\ldots+b_{0}}
$$
where the coefficients $a$ and $b$ are real numbers, and the order $m$ of the numerator is smaller than or equal to the order $n$ of the denominator; the latter is called the order of the network. Furthermore, for a stable circuit-that is, one that does not generate signals on its own-the denominator coefficients should be such that the roots of the denominator polynomial all have negative real parts. The problem of amplifier stability is studied in Chapter 10.

# F. 1 Poles and Zeros 

An alternate form for expressing $T(s)$ is

$$
T(s)=a_{m} \frac{\left(s-Z_{1}\right)\left(s-Z_{2}\right) \ldots\left(s-Z_{m}\right)}{\left(s-P_{1}\right)\left(s-P_{2}\right) \ldots\left(s-P_{n}\right)}
$$

where $a_{m}$ is a multiplicative constant (the coefficient of $s^{m}$ in the numerator), $Z_{1}, Z_{2}, \ldots, Z_{m}$ are the roots of the numerator polynomial, and $P_{1}, P_{2}, \ldots, P_{n}$ are the roots of the denominator polynomial. $Z_{1}, Z_{2}, \ldots, Z_{m}$ are called the transfer-function zeros or transmission zeros, and $P_{1}, P_{2}, \ldots, P_{n}$ are the transfer-function poles or the natural modes of the network. A transfer function is completely specified in terms of its poles and zeros together with the value of the multiplicative constant.

The poles and zeros can be either real or complex numbers. However, since the $a$ and $b$ coefficients are real numbers, the complex poles (or zeros) must occur in conjugate pairs. That is, if $5+j 3$ is a zero, then $5-j 3$ also must be a zero. A zero that is purely imaginary $\left( \pm j \omega_{Z}\right)$ causes the transfer function $T(j \omega)$ to be exactly zero at $\omega=\omega_{Z}$. This is because the numerator will have the factors $\left(s+j \omega_{Z}\right)\left(s-j \omega_{Z}\right)=\left(s^{2}+\omega_{Z}^{2}\right)$, which for physical frequencies becomes $\left(-\omega^{2}+\omega_{Z}^{2}\right)$, and thus the transfer fraction will be exactly zero at $\omega=\omega_{Z}$. Thus the "trap" one places at the input of a television set is a circuit that has a transmission zero at the particular interfering frequency. Real zeros, on the other hand, do not produce transmission nulls. Finally, note that for values of $s$ much greater than all the poles and zeros, the transfer function in Eq. (F.1) becomes $T(s) \simeq a_{m} / s^{n-m}$. Thus the transfer function has $(n-m)$ zeros at $s=\infty$.

## F. 2 First-Order Functions

Many of the transfer functions encountered in this book have real poles and zeros and can therefore be written as the product of first-order transfer functions of the general form

$$
T(s)=\frac{a_{1} s+a_{0}}{s+\omega_{0}}
$$

where $-\omega_{0}$ is the location of the real pole. The quantity $\omega_{0}$, called the pole frequency, is equal to the inverse of the time constant of this single-time-constant (STC) network (see Appendix E). The constants $a_{0}$ and $a_{1}$ determine the type of STC network. Specifically, we studied in Chapter 1 two types of STC networks, low pass and high pass. For the low-pass first-order network we have

$$
T(s)=\frac{a_{0}}{s+\omega_{0}}
$$

In this case the dc gain is $a_{0} / \omega_{0}$, and $\omega_{0}$ is the corner or 3-dB frequency. Note that this transfer function has one zero at $s=\infty$. On the other hand, the first-order high-pass transfer function
has a zero at dc and can be written as

$$
T(s)=\frac{a_{1} s}{s+\omega_{0}}
$$

At this point the reader is strongly urged to review the material on STC networks and their frequency and pulse responses in Appendix E. Of specific interest are the plots of the magnitude and phase responses of the two special kinds of STC networks. Such plots can be employed to generate the magnitude and phase plots of a high-order transfer function, as explained below.

# F. 3 Bode Plots 

A simple technique exists for obtaining an approximate plot of the magnitude and phase of a transfer function given its poles and zeros. The technique is particularly useful in the case of real poles and zeros. The method was developed by H. Bode, and the resulting diagrams are called Bode plots.

A transfer function of the form depicted in Eq. (F.2) consists of a product of factors of the form $s+a$, where such a factor appears on top if it corresponds to a zero and on the bottom if it corresponds to a pole. It follows that the magnitude response in decibels of the network can be obtained by summing together terms of the form $20 \log _{10} \sqrt{a^{2}+\omega^{2}}$, and the phase response can be obtained by summing terms of the form $\tan ^{-1}(\omega / a)$. In both cases the terms corresponding to poles are summed with negative signs. For convenience we can extract the constant $a$ and write the typical magnitude term in the form $20 \log \sqrt{1+(\omega / a)^{2}}$. On a plot of decibels versus $\log$ frequency this term gives rise to the curve and straight-line asymptotes shown in Fig. F.1. Here the low-frequency asymptote is a horizontal straight line at $0-\mathrm{dB}$ level and the high-frequency asymptote is a straight line with a slope of $6 \mathrm{~dB} /$ octave or, equivalently, $20 \mathrm{~dB} /$ decade. The two asymptotes meet at the frequency $\omega=|a|$, which is called the corner frequency. As indicated, the actual magnitude plot differs slightly from


Figure F. 1 Bode plot for the typical magnitude term. The curve shown applies for the case of a zero. For a pole, the high-frequency asymptote should be drawn with a $-6-\mathrm{dB} /$ octave slope.
the value given by the asymptotes; the maximum difference is 3 dB and occurs at the corner frequency.

For $a=0$-that is, a pole or a zero at $s=0$-the plot is simply a straight line of $6 \mathrm{~dB} /$ octave slope intersecting the $0-\mathrm{dB}$ line at $\omega=1$.

In summary, to obtain the Bode plot for the magnitude of a transfer function, the asymptotic plot for each pole and zero is first drawn. The slope of the high-frequency asymptote of the curve corresponding to a zero is $+20 \mathrm{~dB} /$ decade, while that for a pole is $-20 \mathrm{~dB} /$ decade. The various plots are then added together, and the overall curve is shifted vertically by an amount determined by the multiplicative constant of the transfer function.

# Example F. 1 

An amplifier has the voltage transfer function

$$
T(s)=\frac{10 s}{\left(1+s / 10^{2}\right)\left(1+s / 10^{5}\right)}
$$

Find the poles and zeros and sketch the magnitude of the gain versus frequency. Find approximate values for the gain at $\omega=10,10^{3}$, and $10^{6} \mathrm{rad} / \mathrm{s}$.

## Solution

The zeros are as follows: one at $s=0$ and one at $s=\infty$. The poles are as follows: one at $s=-10^{2} \mathrm{rad} / \mathrm{s}$ and one at $s=-10^{5} \mathrm{rad} / \mathrm{s}$.

Figure F. 2 shows the asymptotic Bode plots of the different factors of the transfer function. Curve 1, which is a straight line intersecting the $\omega$-axis at $1 \mathrm{rad} / \mathrm{s}$ and having a $+20 \mathrm{~dB} /$ decade slope, corresponds to the $s$ term (that is, the zero at $s=0$ ) in the numerator. The pole at $s=-10^{2}$ results in curve 2 , which consists of two asymptotes intersecting at $\omega=10^{3}$. Similarly, the pole at $s=-10^{3}$ is represented by curve 3 , where the intersection of the asymptotes is at $\omega=10^{5}$. Finally, curve 4 represents the multiplicative constant of value 10 .


Figure F. 2 Bode plots for Example F.1.
Adding the four curves results in the asymptotic Bode diagram of the amplifier gain (curve 5). Note that since the two poles are widely separated, the gain will be very close to $10^{3}(60 \mathrm{~dB})$ over the frequency range $10^{2}$ to $10^{5} \mathrm{rad} / \mathrm{s}$. At the two corner frequencies $\left(10^{2}\right.$ and $\left.10^{5} \mathrm{rad} / \mathrm{s}\right)$ the gain will be approximately 3 dB below the maximum of 60 dB . At the three specific frequencies, the values of the gain as obtained from the Bode plot and from exact evaluation of the transfer function are as follows:

| $\omega$ | Approximate Gain | Exact Gain |
| :--: | :--: | :--: |
| 10 | 40 dB | 39.96 dB |
| $10^{3}$ | 60 dB | 59.96 dB |
| $10^{6}$ | 40 dB | 39.96 dB |

We next consider the Bode phase plot. Figure F. 3 shows a plot of the typical phase term $\tan ^{-1}(\omega / a)$, assuming that $a$ is negative. Also shown is an asymptotic straight-line approximation of the arctan function. The asymptotic plot consists of three straight lines. The first is horizontal at $\phi=0$ and extends up to $\omega=0.1|a|$. The second line has a slope of $-45^{\circ} /$ decade and extends from $\omega=0.1|a|$ to $\omega=10|a|$. The third line has a zero slope and a level of $\phi=-90^{\circ}$. The complete phase response can be obtained by summing the asymptotic Bode plots of the phase of all poles and zeros.


Figure F. 3 Bode plot of the typical phase term $\tan ^{-1}(\omega / a)$ when $a$ is negative.

# Example F. 2 

Find the Bode plot for the phase of the transfer function of the amplifier considered in Example F.1.

## Solution

The zero at $s=0$ gives rise to a constant $+90^{\circ}$ phase function represented by curve 1 in Fig. F.4. The pole at $s=-10^{2}$ gives rise to the phase function

$$
\phi_{1}=-\tan ^{-1} \frac{\omega}{10^{2}}
$$

Figure F. 4 Phase plots for Example F.2.
(the leading minus sign is due to the fact that this singularity is a pole). The asymptotic plot for this function is given by curve 2 in Fig. F.4. Similarly, the pole at $s=-10^{5}$ gives rise to the phase function

$$
\phi_{2}=-\tan ^{-1} \frac{\omega}{10^{5}}
$$

whose asymptotic plot is given by curve 3 . The overall phase response (curve 4) is obtained by direct summation of the three plots. We see that at $100 \mathrm{rad} / \mathrm{s}$, the amplifier phase leads by $45^{\circ}$ and at $10^{5} \mathrm{rad} / \mathrm{s}$ the phase lags by $45^{\circ}$.

# F. 4 An Important Remark 

For constructing Bode plots, it is most convenient to express the transfer-function factors in the form $(1+s / a)$. The material of Figs. F. 1 and F. 2 and of the preceding two examples is then directly applicable.

## PROBLEMS

F. 1 Find the transfer function $T(s)=V_{c}(s) / V_{i}(s)$ of the circuit in Fig. PF.1. Is this an STC network? If so, of what type? For $C_{1}=C_{2}=0.5 \mu \mathrm{~F}$ and $R=100 \mathrm{k} \Omega$, find the location of the pole(s) and zero(s), and sketch Bode plots for the magnitude response and the phase response.


Figure PF. 1
D *F. 2 (a) Find the voltage transfer function $T(s)=$ $V_{o}(s) / V_{i}(s)$, for the STC network shown in Fig. PF.2.


Figure PF. 2
(b) In this circuit, capacitor $C$ is used to couple the signal source $V_{s}$ having a resistance $R_{s}$ to a load $R_{L}$. For $R_{s}=10 \mathrm{k} \Omega$, design the circuit, specifying the values of $R_{L}$ and $C$ to only one significant digit to meet the following requirements:
(i) The load resistance should be as small as possible.
(ii) The output signal should be at least $70 \%$ of the input at high frequencies.
(iii) The output should be at least $10 \%$ of the input at 10 Hz .
F. 3 Two STC RC circuits, each with a pole at $100 \mathrm{rad} / \mathrm{s}$ and a maximum gain of unity, are connected in cascade with an intervening unity-gain buffer that ensures that they function separately. Characterize the possible combinations (of low-pass and high-pass circuits) by providing (i) the relevant transfer functions, (ii) the voltage gain at $10 \mathrm{rad} / \mathrm{s}$, (iii) the voltage gain at $100 \mathrm{rad} / \mathrm{s}$, and (iv) the voltage gain at $1000 \mathrm{rad} / \mathrm{s}$.
F. 4 Design the transfer function in Eq. (F.5) by specifying $a_{1}$ and $\omega_{0}$ so that the gain is $10 \mathrm{~V} / \mathrm{V}$ at high frequencies and $1 \mathrm{~V} / \mathrm{V}$ at 10 Hz .
F. 5 An amplifier has a low-pass STC frequency response. The magnitude of the gain is 20 dB at dc and 0 dB at 100 kHz . What is the corner frequency? At what frequency is the gain 19 dB ? At what frequency is the phase $-6^{\circ}$ ?
F. 6 A transfer function has poles at $(-5),(-7+j 10)$, and $(-20)$, and a zero at $(-1-j 20)$. Since this function represents
an actual physical circuit, where must other poles and zeros be found?
F. 7 An amplifier has a voltage transfer function $T(s)=$ $10^{6} s(s+10)\left(s+10^{7}\right)$. Convert this to the form convenient for constructing Bode plots [that is, place the denominator factors in the form $(1+s / a)$ ]. Provide a Bode plot for the magnitude response, and use it to find approximate values for the amplifier gain at $1,10,10^{2}, 10^{3}, 10^{4}$, and $10^{5} \mathrm{rad} / \mathrm{s}$. What would the actual gain be at $10 \mathrm{rad} / \mathrm{s}$ ? At $10^{3} \mathrm{rad} / \mathrm{s}$ ?
F. 8 Find the Bode phase plot of the transfer function of the amplifier considered in Problem F.7. Estimate the phase angle at $1,10,10^{2}, 10^{3}, 10^{4}$, and $10^{5} \mathrm{rad} / \mathrm{s}$. For comparison, calculate the actual phase at 1,10 , and $100 \mathrm{rad} / \mathrm{s}$.
F. 9 A transfer function has the following zeros and poles: one zero at $s=0$ and one zero at $s=\infty$; one pole at $s=-100$ and one pole at $s=-10^{\circ}$. The magnitude of the transfer function at $\omega=10^{4} \mathrm{rad} / \mathrm{s}$ is 100 . Find the transfer function $T(s)$ and sketch a Bode plot for its magnitude.
F. 10 Sketch Bode plots for the magnitude and phase of the transfer function

$$
T(s)=\frac{10^{4}\left(1+s / 10^{5}\right)}{\left(1+s / 10^{3}\right)\left(1+s / 10^{4}\right)}
$$

From your sketches, determine approximate values for the magnitude and phase at $\omega=10^{6} \mathrm{rad} / \mathrm{s}$. What are the exact values determined from the transfer function?
F. 11 A particular amplifier has a voltage transfer function $T(s)=10 s^{2} /(1+s / 10)(1+s / 100)\left(1+s / 10^{6}\right)$. Find the poles and zeros. Sketch the magnitude of the gain in dB versus frequency on a logarithmic scale. Estimate the gain at $10^{0}, 10^{3}$, $10^{5}$, and $10^{7} \mathrm{rad} / \mathrm{s}$.
F. 12 A direct-coupled differential amplifier has a differential gain of $100 \mathrm{~V} / \mathrm{V}$ with poles at $10^{6}$ and $10^{8} \mathrm{rad} / \mathrm{s}$, and a common-mode gain of $10^{-3} \mathrm{~V} / \mathrm{V}$ with a zero at $10^{4} \mathrm{rad} / \mathrm{s}$ and a pole at $10^{8} \mathrm{rad} / \mathrm{s}$. Sketch the Bode magnitude plots for the differential gain, the common-mode gain, and the CMRR. What is the CMRR at $10^{7} \mathrm{rad} / \mathrm{s}$ ? (Hint: Division of magnitudes corresponds to subtraction of logarithms.)
# APPENDIX G 

## COMPARISON OF THE MOSFET AND THE BJT

The full text of Appendix G is on the book's website. Here, we show only Table G.3, which provides a summary comparison of the MOSFET and the BJT.

Table G. 3 Comparison of the MOSFET and the BJT


| To Operate in the Active Mode, Two Conditions Have to Be Satisfied | (1) Induce a channel: | (1) Forward-bias EBJ: |
| :--: | :--: | :--: |
|  | $v_{G S} \geq V_{t}, \quad V_{t}=0.3-0.5 \mathrm{~V}$ | $v_{B E} \geq V_{B E o n}, \quad V_{B E o n} \simeq 0.5 \mathrm{~V}$ |
|  | Let $v_{G S}=V_{t}+v_{O V}$ |  |
|  | (2) Pinch-off channel at drain: | (2) Reverse-bias CBJ: |
|  | $v_{G D}<V_{t}$ | $v_{B C}<V_{B C o n}, \quad V_{B C o n} \simeq 0.4 \mathrm{~V}$ |
|  | or equivalently, | or equivalently, |
|  | $v_{D S} \geq V_{O V}, \quad V_{O V}=0.1-0.3 \mathrm{~V}$ | $v_{C E} \geq 0.3 \mathrm{~V}$ |
| Current-Voltage Characteristics in the Active Region | $i_{D}=\frac{1}{2} \mu_{n} C_{o n} \frac{W}{L}\left(v_{G S}-V_{t}\right)^{2}\left(1+\frac{v_{D S}}{V_{A}}\right)$ | $i_{C}=I_{S} e^{v_{B E} / V_{T}}\left(1+\frac{v_{C E}}{V_{A}}\right)$ |
|  | $=\frac{1}{2} \mu_{n} C_{o n} \frac{W}{L} v_{O V}^{2}\left(1+\frac{v_{D S}}{V_{A}}\right)$ |  |
|  | $i_{G}=0$ | $i_{B}=i_{C} / \beta$ |
Table G. 3 continued

G-3 Appendix G Comparison of the MOSFET and the BJT

Table G. 3 continued

# APPENDIX G 

## COMPARISON OF THE MOSFET AND THE BJT

In this appendix we present a comparison of the characteristics of the two major electronic devices: the MOSFET and the BJT. To facilitate this comparison, typical values for the important parameters of the two devices are first presented. We also discuss the design parameters available with each of the two devices, such as $I_{C}$ in the BJT, and $I_{D}$ and $V_{O V}$ in the MOSFET, and the trade-offs encountered in deciding on suitable values for these.

## G. 1 Typical Values of MOSFET Parameters

Typical values for the important parameters of NMOS and PMOS transistors fabricated in a number of CMOS processes are shown in Table G.1. Each process is characterized by the minimum allowed channel length, $L_{\min }$; thus, for example, in a $0.18-\mu \mathrm{m}$ process, the smallest transistor has a channel length $L=0.18 \mu \mathrm{~m}$. The technologies presented in Table G. 1 are in descending order of channel length, with that having the shortest channel length being the most modern. Although the $0.8-\mu \mathrm{m}$ process is now obsolete, its data are included to show trends in the values of various parameters. It should also be mentioned that although Table G. 1 stops at the $65-\mathrm{nm}$ process, by 2014 there were $45-, 32-$, and $22-\mathrm{nm}$ processes available, and processes down to 14 nm were in various stages of development. The $0.18-\mu \mathrm{m}$ and the $0.13-\mu \mathrm{m}$ processes, however, remained popular in the design of analog ICs. The most recently announced digital ICs utilize $32-\mathrm{nm}$ and $22-\mathrm{nm}$ processes and pack as many as 4.3 billion transistors onto one chip. An important caution is in order regarding the data presented in Table G.1: These data do not pertain to any particular commercially available process.

Table G. 1 Typical Values of CMOS Device Parameters

| Parameter | 0.8 nm |  | 0.5 nm |  | 0.25 nm |  | 0.18 nm |  | 0.13 nm |  | 65 nm |  |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
|  | NMOS | PMOS | NMOS | PMOS | NMOS | PMOS | NMOS | PMOS | NMOS | PMOS | NMOS | PMOS |
| $t_{\text {ox }}(\mathrm{nm})$ | 15 | 15 | 9 | 9 | 6 | 6 | 4 | 4 | 2.7 | 2.7 | 1.4 | 1.4 |
| $C_{o x}\left(\mathrm{~F} / \mu \mathrm{m}^{2}\right)$ | 2.3 | 2.3 | 3.8 | 3.8 | 5.8 | 5.8 | 8.6 | 8.6 | 12.8 | 12.8 | 25 | 25 |
| $\mu\left(\mathrm{cm}^{2} / \mathrm{V} \cdot \mathrm{s}\right)$ | 550 | 250 | 500 | 180 | 460 | 160 | 450 | 100 | 400 | 100 | 216 | 40 |
| $\mu C_{o x}\left(\mu \mathrm{~A} / \mathrm{V}^{2}\right)$ | 127 | 58 | 190 | 68 | 267 | 93 | 387 | 86 | 511 | 128 | 540 | 100 |
| $V_{t 0}(\mathrm{~V})$ | 0.7 | $-0.7$ | 0.7 | $-0.8$ | 0.5 | $-0.6$ | 0.5 | $-0.5$ | 0.4 | $-0.4$ | 0.35 | $-0.35$ |
| $V_{D D}(\mathrm{~V})$ | 5 | 5 | 3.3 | 3.3 | 2.5 | 2.5 | 1.8 | 1.8 | 1.3 | 1.3 | 1.0 | 1.0 |
| $\left|C_{A}\right|(\mathrm{V} / \mu \mathrm{m})$ | 25 | 20 | 20 | 10 | 5 | 6 | 5 | 6 | 5 | 6 | 3 | 3 |
| $C_{o v}\left(\mathrm{fF} / \mu \mathrm{m}\right)$ | 0.2 | 0.2 | 0.4 | 0.4 | 0.3 | 0.3 | 0.37 | 0.33 | 0.36 | 0.33 | 0.33 | 0.31 |
Accordingly, these generic data are not intended for use in an actual IC design; rather, they show trends and, as we shall see, help to illustrate design trade-offs as well as enable us to work out design examples and problems with parameter values that are as realistic as possible.

As indicated in Table G.1, the trend has been to reduce the minimum allowable channel length. This trend has been motivated by the desire to pack more transistors on a chip as well as to operate at higher speeds or, in analog terms, over wider bandwidths.

Observe that the oxide thickness, $t_{o x}$, scales down with the channel length, reaching 1.4 nm for the $65-\mathrm{nm}$ process. Since the oxide capacitance $C_{o x}$ is inversely proportional to $t_{o x}$, we see that $C_{o x}$ increases as the technology scales down. The surface mobility $\mu$ decreases as the technology minimum-feature size is decreased, and $\mu_{p}$ decreases faster than $\mu_{u}$. As a result, the ratio of $\mu_{p}$ to $\mu_{u}$ has been decreasing with each generation of technology, falling from about 0.5 for older technologies to 0.2 or so for the newer ones. Despite the reduction of $\mu_{u}$ and $\mu_{p}$, the transconductance parameters $k_{n}^{\prime}=\mu_{u} C_{o x}$ and $k_{p}^{\prime}=\mu_{p} C_{o x}$ have been steadily increasing. As a result, modern short-channel devices achieve required levels of bias currents at lower overdrive voltages. As well, they achieve higher transconductance, a major advantage.

Although the magnitudes of the threshold voltages $V_{t n}$ and $V_{t p}$ have been decreasing with $L_{\min }$ from about $0.7-0.8 \mathrm{~V}$ to $0.3-0.4 \mathrm{~V}$, the reduction has not been as large as that of the power supply $V_{D D}$. The latter has been reduced dramatically, from 5 V for older technologies to 1.0 V for the $65-\mathrm{nm}$ process. This reduction has been necessitated by the need to keep the electric fields in the smaller devices from reaching very high values. Another reason for reducing $V_{D D}$ is to keep power dissipation as low as possible given that the IC chip now has a much larger number of transistors. ${ }^{1}$

The fact that in modern short-channel CMOS processes $\left|V_{t}\right|$ has become a much larger proportion of the power-supply voltage poses a serious challenge to the circuit design engineer. Recalling that $\left|V_{G S}\right|=\left|V_{t}\right|+\left|V_{O V}\right|$, where $V_{O V}$ is the overdrive voltage, to keep $\left|V_{G S}\right|$ reasonably small, $\left|V_{O V}\right|$ for modern technologies is usually in the range of 0.1 V to 0.2 V . To appreciate this point further, recall that to operate a MOSFET in the saturation region, $\left|V_{D S}\right|$ must exceed $\left|V_{O V}\right|$; thus, to be able to have a number of devices stacked between the power-supply rails in a regime in which $V_{D D}$ is only 1.8 V or lower, we need to keep $\left|V_{O V}\right|$ as low as possible. We will shortly see, however, that operating at a low $\left|V_{O V}\right|$ has some drawbacks.

Another significant though undesirable feature of modern deep submicron ( $L_{\text {min }}<$ $0.25 \mu \mathrm{~m}$ ) CMOS technologies is that the channel-length modulation effect is very pronounced. As a result, $V_{A}^{\prime}$ has decreased to about $3 \mathrm{~V} / \mu \mathrm{m}$, which combined with the decreasing values of $L$ has caused the Early voltage $V_{A}=V_{A}^{\prime} L$ to become very small. Correspondingly, short-channel MOSFETs exhibit low output resistances.

Studying the MOSFET high-frequency ${ }^{2}$ equivalent-circuit model in Section 10.2 and the high-frequency response of the common-source amplifier in Section 10.3 shows that two major MOSFET capacitances are $C_{g s}$ and $C_{g d}$. While $C_{g s}$ has an overlap component, ${ }^{3} C_{g d}$ is entirely an overlap capacitance. Both $C_{g d}$ and the overlap component of $C_{g s}$ are almost equal and are denoted $C_{o v}$. The last line of Table G. 1 provides the value of $C_{o v}$ per micron of gate width. Although the normalized $C_{o v}$ has been staying more or less constant with the reduction in $L_{\text {min }}$, we will shortly see that the shorter devices exhibit much higher operating speeds and wider amplifier bandwidths than the longer devices. Specifically, we will, for example, see that $f_{T}$ for a $0.25-\mu \mathrm{m}$ NMOS transistor can be as high as 10 GHz .

[^0]
[^0]:    ${ }^{1}$ Chip power dissipation is a very serious issue, with some ICs dissipating as much as 100 W . As a result, an important current area of research concerns what is termed "power-aware design."
    ${ }^{2}$ For completeness, this appendix includes material on the high-frequency models and operation of both the MOSFET and the BJT. These topics are covered in Chapter 10. The reader can easily skip the appendix paragraphs dealing with these topics until Chapter 10 has been studied.
    ${ }^{3}$ Overlap capacitances result because the gate electrode overlaps the source and drain diffusions (Fig. 5.1).
# G. 2 Typical Values of IC BJT Parameters 

Table G. 2 provides typical values for the major parameters that characterize integrated-circuit bipolar transistors. Data are provided for devices fabricated in two different processes: the standard, old process, known as the "high-voltage process," and an advanced, modern process, referred to as a "low-voltage process." For each process we show the parameters of the standard $n p n$ transistor and those of a special type of $p n p$ transistor known as a lateral pnp (as opposed to vertical, as in the $n p n$ case) (see Appendix A). In this regard we should mention that a major drawback of standard bipolar integrated-circuit fabrication processes has been the lack of pnp transistors of a quality equal to that of the $n p n$ devices. Rather, there are a number of $p n p$ implementations for which the lateral $p n p$ is the most economical to fabricate. Unfortunately, however, as should be evident from Table G.2, the lateral pnp has characteristics that are much inferior to those of the vertical npn. Note in particular the lower value of $\beta$ and the much larger value of the forward transit time $\tau_{F}$ that determines the emitter-base diffusion capacitance $C_{d e}$ and, hence, the transistor speed of operation. The data in Table G. 2 can be used to show that the unity-gain frequency of the lateral $p n p$ is 2 orders of magnitude lower than that of the $n p n$ transistor fabricated in the same process. Another important difference between the lateral $p n p$ and the corresponding $n p n$ transistor is the value of collector current at which their $\beta$ values reach their maximums: For the high-voltage process, for example, this current is in the tens of microamperes range for the $p n p$ and in the milliampere range for the $n p n$. On the positive side, the problem of the lack of high-quality $p n p$ transistors has spurred analog circuit designers to come up with highly innovative circuit topologies that either minimize the use of $p n p$ transistors or minimize the dependence of circuit performance on that of the $p n p$. We encounter some of these ingenious circuits at various locations in this book.

The dramatic reduction in device size achieved in the advanced low-voltage process should be evident from Table G.2. As a result, the scale current $I_{S}$ also has been reduced by about three orders of magnitude. Here we should note that the base width, $W_{B}$, achieved in the advanced process is on the order of $0.1 \mu \mathrm{~m}$, as compared to a few microns in the standard high-voltage process. Note also the dramatic increase in speed; for the low-voltage npn transistor, $\tau_{F}=10 \mathrm{ps}$ as opposed to 0.35 ns in the high-voltage process. As a result, $f_{T}$ for the modern $n p n$ transistor is 10 GHz to 25 GHz , as compared to the 400 MHz to 600 MHz achieved in the high-voltage process. Although the Early voltage, $V_{A}$, for the modern process is lower than its value in the

Table G. 2 Typical Parameter Values for BJTs*

|  | Standard High-Voltage Process |  | Advanced Low-Voltage Process |  |
| :-- | :-- | :-- | :-- | :-- |
| Parameter | $n p n$ | Lateral $p n p$ | $n p n$ | Lateral $p n p$ |
| $A_{E}\left(\mu \mathrm{~m}^{2}\right)$ | 500 | 900 | 2 | 2 |
| $I_{S}(\mathrm{~A})$ | $5 \times 10^{-15}$ | $2 \times 10^{-15}$ | $6 \times 10^{-18}$ | $6 \times 10^{-18}$ |
| $\beta_{0}(\mathrm{~A} / \mathrm{A})$ | 200 | 50 | 100 | 50 |
| $V_{A}(\mathrm{~V})$ | 130 | 50 | 35 | 30 |
| $V_{C E D}(\mathrm{~V})$ | 50 | 60 | 8 | 18 |
| $\tau_{F}$ | 0.35 ns | 30 ns | 10 ps | 650 ps |
| $C_{p 0}$ | 1 pF | 0.3 PF | 5 fF | 14 fF |
| $C_{p 0}$ | 0.3 pF | 1 pF | 5 fF | 15 fF |
| $r_{s}(\Omega)$ | 200 | 300 | 400 | 200 |
| *Adapted from Gray et al. (2001); see Appendix I. |  |  |  |  |
old high-voltage process, it is still reasonably high at 35 V . Another feature of the advanced process-and one that is not obvious from Table G. 2 -is that $\beta$ for the $n p n$ peaks at a collector current of $50 \mu \mathrm{~A}$ or so. Finally, note that as the name implies, npn transistors fabricated in the low-voltage process break down at collector-emitter voltages of 8 V , versus 50 V or so for the high-voltage process. Thus, while circuits designed with the standard high-voltage process utilize power supplies of $\pm 15 \mathrm{~V}$ (e.g., in commercially available op amps of the 741 type), the total power-supply voltage utilized with modern bipolar devices is 5 V (or even 2.5 V to achieve compatibility with some of the submicron CMOS processes).

# G. 3 Comparison of Important Characteristics 

Table G. 3 provides a compilation of the important characteristics of the NMOS and the npn transistors. The material is presented in a manner that facilitates comparison. In the following, we comment on the various items in Table G.3. As well, a number of numerical examples and exercises are provided to illustrate how the wealth of information in Table G. 3 can be put to use. Before proceeding, note that the PMOS and the $p n p$ transistors can be compared in a similar way.

Table G. 3 Comparison of MOSFET and the BJT
NMOS
npn



To Operate in the Active Mode, Two Conditions Have to Be Satisfied
(1) Induce a channel:
(1) Forward-bias EBJ:

$$
v_{G S} \geq V_{t}, \quad V_{t}=0.3-0.5 \mathrm{~V}
$$

Let $v_{G S}=V_{t}+v_{O V}$
(2) Pinch-off channel at drain:
(2) Reverse-bias CBJ:

$$
\begin{array}{ll}
v_{G D}<V_{t} & v_{B C}<V_{B C o n}, \quad V_{B C o n} \simeq 0.4 \mathrm{~V} \\
\text { or equivalently, } & \text { or equivalently, } \\
v_{D S} \geq V_{O V}, \quad V_{O V}=0.1-0.3 \mathrm{~V} & v_{C E} \geq 0.3 \mathrm{~V}
\end{array}
$$

Current-Voltage Characteristics in the Active Region

$$
\begin{aligned}
i_{D} & =\frac{1}{2} \mu_{n} C_{o s} \frac{W}{L}\left(v_{G S}-V_{t}\right)^{2}\left(1+\frac{v_{D S}}{V_{A}}\right) & i_{C}=I_{A} e^{i_{B E} / v_{F}}\left(1+\frac{v_{C E}}{v_{A}}\right) \\
& =\frac{1}{2} \mu_{n} C_{o s} \frac{W}{L} v_{O V}^{2}\left(1+\frac{v_{D S}}{V_{A}}\right) & \\
i_{G} & =0 & i_{B}=i_{C} / \beta
\end{aligned}
$$
Table G. 3
Table G. 3 continued


# G.3.1 Operating Conditions 

At the outset, note that we shall use active mode or active region to denote both the active mode of operation of the BJT and the saturation mode of operation of the MOSFET.

The conditions for operating in the active mode are very similar for the two devices: The explicit threshold $V_{t}$ of the MOSFET has $V_{B E o n}$ as its implicit counterpart in the BJT. Furthermore, for modern processes, $V_{B E o n}$ and $V_{t}$ are almost equal.

Also, pinching off the channel of the MOSFET at the drain end is very similar to reverse biasing the CBJ of the BJT; the first makes $i_{D}$ nearly independent of $v_{D}$, and the second makes $I_{C}$ nearly independent of $v_{C}$. Note, however, that the asymmetry of the BJT results in $V_{B C o n}$ and $V_{B E o n}$ being unequal, while in the symmetrical MOSFET the operative threshold voltages at the source and the drain ends of the channel are identical $\left(V_{t}\right)$. Finally, for both the MOSFET and the BJT to operate in the active mode, the voltage across the device $\left(v_{D S}, v_{C E}\right)$ must be at least 0.1 V to 0.3 V .
# G.3.2 Current-Voltage Characteristics 

The square-law control characteristic, $i_{D}-v_{G S}$, in the MOSFET should be contrasted with the exponential control characteristic, $i_{C}-v_{B E}$, of the BJT. Obviously, the latter is a much more sensitive relationship, with the result that $i_{C}$ can vary over a very wide range (five decades or more) within the same BJT. In the MOSFET, the range of $i_{D}$ achieved in the same device is much more limited. To appreciate this point further, consider the parabolic relationship between $i_{D}$ and $v_{O V}$, and recall from our discussion above that $v_{O V}$ is usually kept in a narrow range $(0.1 \mathrm{~V}$ to 0.3 V$)$.

Next we consider the effect of the device dimensions on its current. For the bipolar transistor, the control parameter is the area of the emitter-base junction (EBJ), $A_{E}$, which determines the scale current $I_{S}$. It can be varied over a relatively narrow range, such as 10 to 1. Thus, while the emitter area can be used to achieve current scaling in an $I_{C}$ (as we can see in Section 8.2 in connection with the design of current mirrors), its narrow range of variation reduces its significance as a design parameter. This is particularly so if we compare $A_{E}$ with its counterpart in the MOSFET, the aspect ratio W/L. MOSFET devices can be designed with $W / L$ ratios in a wide range, such as 1.0 to 500 . As a result, $W / L$ is a very significant MOS design parameter. Like $A_{E}$, it is also used in current scaling, as we can see in Section 8.2. Combining the possible range of variation of $v_{O V}$ and $W / L$, one can design MOS transistors to operate over an $i_{D}$ range of four decades or so.

The channel-length modulation in the MOSFET and the base-width modulation in the BJT are similarly modeled and give rise to the dependence of $i_{D}\left(i_{C}\right)$ on $v_{D S}\left(v_{C E}\right)$ and, hence, to the finite output resistance $r_{o}$ in the active region. Two important differences, however, exist. In the BJT, $V_{A}$ is solely a process-technology parameter and does not depend on the dimensions of the BJT. In the MOSFET, the situation is quite different: $V_{A}=V_{A}^{\prime} L$, where $V_{A}^{\prime}$ is a process-technology parameter and $L$ is the channel length used. Also, in modern deep submicron processes, $V_{A}^{\prime}$ is very low, resulting in $V_{A}$ values that are lower than the corresponding values for the BJT.

The last, and perhaps most important, difference between the current-voltage characteristics of the two devices concerns the input current into the control terminal: While at low frequencies the gate current of the MOSFET is practically zero and the input resistance looking into the gate is practically infinite, the BJT draws base current $i_{B}$ that is proportional to the collector current; that is, $i_{B}=i_{C} / \beta$ The finite base current and the corresponding finite input resistance looking into the base comprise a definite disadvantage of the BJT in comparison to the MOSFET. Indeed, it is the infinite input resistance of the MOSFET that has made possible analog and digital circuit applications that are not feasible with the BJT. Examples include dynamic digital memory (Chapter 16) and switched-capacitor filters (Chapter 17).

## Example G. 1

(a) For an NMOS transistor with $W / L=10$ fabricated in the $0.18-\mu \mathrm{m}$ process whose data are given in Table G.1, find the values of $V_{O V}$ and $V_{G S}$ required to operate the device at $I_{D}=100 \mu \mathrm{~A}$. Ignore channel-length modulation.
(b) Find $V_{B E}$ for an $n p n$ transistor fabricated in the low-voltage process specified in Table G. 2 and operated at $I_{C}=100 \mu \mathrm{~A}$. Ignore base-width modulation.
# Example G. 1 continued 

## Solution

(a)

$$
I_{D}=\frac{1}{2}\left(\mu_{n} C_{o s}\right)\left(\frac{W}{L}\right) V_{O V}^{2}
$$

Substituting $I_{D}=100 \mu \mathrm{~A}, W / L=10$, and, from Table G.1, $\mu_{n} C_{o s}=387 \mu \mathrm{~A} / \mathrm{V}^{2}$ results in

$$
\begin{aligned}
& 100=\frac{1}{2} \times 387 \times 10 \times V_{O V}^{2} \\
& V_{O V}=0.23 \mathrm{~V}
\end{aligned}
$$

Thus,

$$
V_{G S}=V_{m}+V_{O V}=0.5+0.23=0.73 \mathrm{~V}
$$

(b)

$$
I_{C}=I_{S} e^{V_{B E} / V_{T}}
$$

Substituting $I_{C}=100 \mu \mathrm{~A}$ and, from Table G.2, $I_{S}=6 \times 10^{-18} \mathrm{~A}$ gives,

$$
V_{B E}=0.025 \ln \frac{100 \times 10^{-6}}{6 \times 10^{-18}}=0.76 \mathrm{~V}
$$

## EXERCISE

G. 1 (a) For NMOS transistors fabricated in the $0.18-\mu \mathrm{m}$ technology specified in Table G.1, find the range of $I_{D}$ obtained for active-mode operation with $V_{O V}$ ranging from 0.2 V to 0.4 V and $W / L=0.1$ to 100 . Neglect channel-length modulation.
(b) If a similar range of current is required in an $n p n$ transistor fabricated in the low-voltage process specified in Table G.2, find the corresponding change in its $V_{B E}$.
Ans. (a) $I_{D \min }=0.8 \mu \mathrm{~A}$ and $I_{D \max }=3.1 \mathrm{~mA}$ for a range of about 4000:1; (b) for $I_{C}$ varying over a 4000:1 range, $\Delta V_{B E}=207 \mathrm{mV}$

## G.3.3 Low-Frequency Small-Signal Models

The low-frequency models for the two devices are very similar except, of course, for the finite base current (finite $\beta$ ) of the BJT, which gives rise to $r_{\pi}$ in the hybrid- $\pi$ model and to the unequal emitter and collector currents in the T models $\alpha<1$. Here it is interesting to note that the low-frequency, small-signal models become identical if one thinks of the MOSFET as a BJT with $\beta=\infty(\alpha=1)$
For both devices, the hybrid- $\pi$ model indicates that the open-circuit voltage gain obtained from gate to drain (base to collector) with the source (emitter) grounded is $-g_{m} r_{o}$. It follows that $g_{m} r_{o}$ is the maximum gain available from a single transistor of either type. This important transistor parameter is given the name intrinsic gain and is denoted $A_{0}$. We have more to say about the intrinsic gain in Section 8.3.2.

Although not included in the MOSFET low-frequency model shown in Table G.3, the body effect can have some implications for the operation of the MOSFET as an amplifier. In simple terms, if the body (substrate) is not connected to the source, it can act as a second gate for the MOSFET. The voltage signal that develops between the body and the source, $v_{b s}$, gives rise to a drain current component $g_{m b} v_{b s}$, where the body transconductance $g_{m b}$ is proportional to $g_{m}$; that is, $g_{m b}=\chi g_{m}$, where the factor $\chi$ is in the range of 0.1 to 0.2 . The body effect has no counterpart in the BJT.

# G.3.4 The Transconductance 

For the BJT, the transconductance $g_{m}$ depends only on the dc collector current $I_{C}$. (Recall that $V_{T}$ is a physical constant $\simeq 0.025 \mathrm{~V}$ at room temperature.) It is interesting to observe that $g_{m}$ does not depend on the geometry of the BJT, and its dependence on the EBJ area is only through the effect of the area on the total collector current $I_{C}$. Similarly, the dependence of $g_{m}$ on $V_{B E}$ is only through the fact that $V_{B E}$ determines the total current in the collector. By contrast, $g_{m}$ of the MOSFET depends on $I_{D}, V_{O V}$, and W/L. Therefore, we use three different (but equivalent) formulas to express $g_{m}$ of the MOSFET.

The first formula given in Table G. 3 for the MOSFET's $g_{m}$ is the most directly comparable with the formula for the BJT. It indicates that for the same operating current, $g_{m}$ of the MOSFET is smaller than that of the BJT. This is because $V_{O V} / 2$ is the range of 0.05 V to 0.15 V , which is two to six times the corresponding term in the BJT's formula, namely $V_{T}$.

The second formula for the MOSFET's $g_{m}$ indicates that for a given device (i.e., given $W / L), g_{m}$ is proportional to $V_{O V}$. Thus a higher $g_{m}$ is obtained by operating the MOSFET at a higher overdrive voltage. However, we should recall the limitations imposed on the magnitude of $V_{O V}$ by the limited value of $V_{D D}$. Put differently, the need to obtain a reasonably high $g_{m}$ constrains the designer's interest in reducing $V_{O V}$.

The third $g_{m}$ formula shows that for a given transistor (i.e., given $W / L$ ), $g_{m}$ is proportional to $\sqrt{I_{D}}$. This should be contrasted with the bipolar case, where $g_{m}$ is directly proportional to $I_{C}$.

## G.3.5 Output Resistance

The output resistance for both devices is determined by similar formulas, with $r_{o}$ being the ratio of $V_{A}$ to the bias current ( $I_{D}$ or $I_{C}$ ). Thus, for both transistors, $r_{o}$ is inversely proportional to the bias current. The difference in nature and magnitude of $V_{A}$ between the two devices has already been discussed.

## G.3.6 Intrinsic Gain

The intrinsic gain $A_{0}$ of the BJT is the ratio of $V_{A}$, which is solely a process parameter ( 5 V to 100 V ), and $V_{T}$, which is a physical parameter ( 0.025 V at room temperature). Thus $A_{0}$ of a BJT is independent of the device junction area and of the operating current, and its value ranges from $200 \mathrm{~V} / \mathrm{V}$ to $5000 \mathrm{~V} / \mathrm{V}$. The situation in the MOSFET is very different: Table G. 3 provides three different (but equivalent) formulas for expressing the MOSFET's intrinsic


Figure G. 1 The intrinsic gain of the MOSFET versus bias current $I_{D}$. Outside the subthreshold region, this is a plot of $A_{0}=V_{A}^{\prime} \sqrt{2 \mu_{w} C_{o s} W L / I_{D}}$, for the case: $\mu_{w} C_{o s}=20 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{A}^{\prime}=20 \mathrm{~V} / \mu \mathrm{m}, L=2 \mu \mathrm{~m}$, and $W=20 \mu \mathrm{~m}$.
gain. The first formula is the one most directly comparable to that of the BJT. Here, however, we note the following:

1. The quantity in the denominator is $V_{O V} / 2$, which is a design parameter, and although it is becoming smaller in designs using short-channel technologies, it is still at least two to four times larger than $V_{T}$. Furthermore, as we have seen, there are reasons for selecting larger values for $V_{O V}$.
2. The numerator quantity $V_{A}$ is both process- and device-dependent, and its value has been steadily decreasing.

As a result, the intrinsic gain realized in a single MOSFET amplifier stage fabricated in a modern short-channel technology is only $20 \mathrm{~V} / \mathrm{V}$ to $40 \mathrm{~V} / \mathrm{V}$, at least an order of magnitude lower than that for a BJT.

The third formula given for $A_{0}$ in Table G. 3 points out a very interesting fact: For a given process technology ( $V_{A}^{\prime}$ and $\mu_{w} C_{o s}$ ) and a given device ( $L$ and $W$ ), the intrinsic gain is inversely proportional to $\sqrt{I_{D}}$. This is illustrated in Fig. G.1, which shows a typical plot of $A_{0}$ versus the bias current $I_{D}$. The plot confirms that the gain increases as the bias current is lowered. The gain, however, levels off at very low currents. This is because the MOSFET enters the subthreshold region of operation (Section 5.1.9), where it becomes very much like a BJT with an exponential current-voltage characteristic. The intrinsic gain then becomes constant, just like that of a BJT. Note, however, that although a higher gain is achieved at lower bias currents, the price paid is a lower $g_{m}$ and less ability to drive capacitive loads and thus a decrease in bandwidth. This point will be further illustrated shortly.

# Example G. 2 

We wish to compare the values of $g_{m}$, input resistance at the gate (base), $r_{o}$, and $A_{0}$ for an NMOS transistor fabricated in the $0.25-\mu \mathrm{m}$ technology specified in Table G. 1 and an npn transistor fabricated in the
# Example G. 2 continued 

low-voltage technology specified in Table G.2. Assume both devices are operating at a drain (collector) current of $100 \mu \mathrm{~A}$. For the MOSFET, let $L=0.4 \mu \mathrm{~m}$ and $W=4 \mu \mathrm{~m}$, and specify the required $V_{O V}$.

## Solution

For the NMOS transistor,

$$
\begin{aligned}
I_{D} & =\frac{1}{2}\left(\mu_{\pi} C_{o s}\right)\left(\frac{W}{L}\right) V_{O V}^{2} \\
100 & =\frac{1}{2} \times 267 \times \frac{4}{0.4} \times V_{O V}^{2}
\end{aligned}
$$

Thus,

$$
\begin{aligned}
V_{O V} & =0.27 \mathrm{~V} \\
g_{m} & =\sqrt{2\left(\mu_{\pi} C_{o s}\right)\left(\frac{W}{L}\right) I_{D}} \\
& =\sqrt{2 \times 267 \times 10 \times 100}=0.73 \mathrm{~mA} / \mathrm{V} \\
R_{\mathrm{in}} & =\infty \\
r_{o} & =\frac{V_{A}^{\prime} L}{I_{D}}=\frac{5 \times 0.4}{0.1}=20 \mathrm{k} \Omega \\
A_{0} & =g_{m} r_{o}=0.73 \times 20=14.6 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

For the $n p n$ transistor,

$$
\begin{aligned}
g_{m} & =\frac{I_{C}}{V_{T}}=\frac{0.1 \mathrm{~mA}}{0.025 \mathrm{~V}}=4 \mathrm{~mA} / \mathrm{V} \\
R_{\mathrm{in}} & =r_{\pi}=\beta_{0} / g_{m}=\frac{100}{4 \mathrm{~mA} / \mathrm{V}}=25 \mathrm{k} \Omega \\
r_{o} & =\frac{V_{A}}{I_{C}}=\frac{35}{0.1 \mathrm{~mA}}=350 \mathrm{k} \Omega \\
A_{0} & =g_{m} r_{o}=4 \times 350=1400 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

## EXERCISE

G. 2 For an NMOS transistor fabricated in the $0.5-\mu \mathrm{m}$ process specified in Table G. 1 with $W=5 \mu \mathrm{~m}$ and $L=0.5 \mu \mathrm{~m}$, find the transconductance and the intrinsic gain obtained at $I_{D}=10 \mu \mathrm{~A}, 100 \mu \mathrm{~A}$, and 1 mA . Ans. $0.2 \mathrm{~mA} / \mathrm{V}, 200 \mathrm{~V} / \mathrm{V} ; 0.6 \mathrm{~mA} / \mathrm{V}, 62 \mathrm{~V} / \mathrm{V} ; 2 \mathrm{~mA} / \mathrm{V}, 20 \mathrm{~V} / \mathrm{V}$
# G.3.7 High-Frequency Operation 

The simplified high-frequency equivalent circuits for the MOSFET and the BJT are very similar, and so are the formulas for determining their unity-gain frequency (also called transition frequency) $f_{T}$. As we demonstrate in Chapter 10, $f_{T}$ is a measure of the intrinsic bandwidth of the transistor itself and does not take into account the effects of capacitive loads. We address the issue of capacitive loads shortly. For the time being, note the striking similarity between the approximate formulas given in Table G. 3 for the value of $f_{T}$ of the two devices. In both cases $f_{T}$ is inversely proportional to the square of the critical dimension of the device: the channel length for the MOSFET and the base width for the BJT. These formulas also clearly indicate that shorter-channel MOSFETs ${ }^{4}$ and narrower-base BJTs are inherently capable of a wider bandwidth of operation. It is also important to note that while for the BJT the approximate expression for $f_{T}$ indicates that it is entirely process determined, the corresponding expression for the MOSFET shows that $f_{T}$ is proportional to the overdrive voltage $V_{O V}$. Thus we have conflicting requirements on $V_{O V}$ : While a higher low-frequency gain is achieved by operating at a low $V_{O V}$, wider bandwidth requires an increase in $V_{O V}$. Therefore the selection of a value for $V_{O V}$ involves, among other considerations, a trade-off between gain and bandwidth.

For $n p n$ transistors fabricated in the modern low-voltage process, $f_{T}$ is in the range of 10 GHz to 20 GHz as compared to the 400 MHz to 600 MHz obtained with the standard high-voltage process. In the MOS case, NMOS transistors fabricated in a modern submicron technology, such as the $0.18-\mu \mathrm{m}$ process, achieve $f_{T}$ values in the range of 5 GHz to 15 GHz .

Before leaving the subject of high-frequency operation, let's look into the effect of a capacitive load on the bandwidth of the common-source (common-emitter) amplifier. For this purpose we shall assume that the frequencies of interest are much lower than $f_{T}$ of the transistor. Hence we shall not take the transistor capacitances into account. Figure G.2(a) shows a common-source amplifier with a capacitive load $C_{L}$. The voltage gain from gate to drain can be found as follows:

$$
\begin{aligned}
V_{o} & =-g_{m} V_{g s}\left(r_{o} \| C_{L}\right) \\
& =-g_{m} V_{g s} \frac{r_{o} \frac{1}{s C_{L}}}{r_{o}+\frac{1}{s C_{L}}} \\
A_{v} & =\frac{V_{o}}{V_{g s}}=-\frac{g_{m} r_{o}}{1+s C_{L} r_{o}}
\end{aligned}
$$

Thus the gain has, as expected, a low-frequency value of $g_{m} r_{o}=A_{0}$ and a frequency response of the single-time-constant (STC) low-pass type with a break (pole) frequency at

$$
\omega_{P}=\frac{1}{C_{L} r_{o}}
$$

Obviously this pole is formed by $r_{o}$ and $C_{L}$. A sketch of the magnitude of gain versus frequency is shown in Fig. G.2(b). We observe that the gain crosses the 0-dB line at

[^0]
[^0]:    ${ }^{4}$ Although the reason is beyond our capabilities at this stage, $f_{T}$ of MOSFETs that have very short channels varies inversely with $L$ rather than with $L^{2}$.

(a)

(b)

Figure G. 2 Frequency response of a CS amplifier loaded with a capacitance $C_{L}$ and fed with an ideal voltage source. It is assumed that the transistor is operating at frequencies much lower than $f_{T}$, and thus the internal capacitances are not taken into account.
frequency $\omega_{t}$,

$$
\omega_{t}=A_{0} \omega_{P}=\left(g_{m} r_{o}\right) \frac{1}{C_{L} r_{o}}
$$

Thus,

$$
\omega_{t}=\frac{g_{m}}{C_{L}}
$$

That is, the unity-gain frequency or, equivalently, the gain-bandwidth product ${ }^{5} \omega_{t}$ is the ratio of $g_{m}$ and $C_{L}$. We thus clearly see that for a given capacitive load $C_{L}$, a larger gain-bandwidth product is achieved by operating the MOSFET at a higher $g_{m}$. Identical analysis and conclusions apply to the case of the BJT. In each case, bandwidth increases as bias current is increased.

[^0]
[^0]:    ${ }^{5}$ The unity-gain frequency and the gain-bandwidth product of an amplifier are the same when the frequency response is of the single-pole type; otherwise the two parameters may differ.
G.3.8 Design Parameters
For the BJT there are three design parameters- $I_{C}, V_{B E}$, and $I_{S}$ (or, equivalently, the area of the emitter-base junction)-and the designer can select any two. However, since $I_{C}$ is exponentially related to $V_{B E}$ and is very sensitive to the value of $V_{B E}\left(V_{B E}\right.$ changes by only 60 mV for a factor of 10 change in $I_{C}$ ), $I_{C}$ is much more useful than $V_{B E}$ as a design parameter. As mentioned earlier, the utility of the EBJ area as a design parameter is rather limited because of the narrow range over which $A_{E}$ can vary. It follows that for the BJT there is only one effective design parameter: the collector current $I_{C}$. Finally, note that we have not considered $V_{C E}$ to be a design parameter, since its effect on $I_{C}$ is only secondary. Of course, as we learned in Chapter 7, $V_{C E}$ affects the output-signal swing.

For the MOSFET there are four design parameters- $I_{D}, V_{O V}, L$, and $W$-and the designer can select any three. For analog circuit applications the trade-off in selecting a value for $L$ is between the higher speed of operation (wider amplifier bandwidth) obtained at lower values of $L$ and the higher intrinsic gain obtained at larger values of $L$. Usually one selects an $L$ of about $25 \%$ to $50 \%$ greater than $L_{\text {min }}$.

The second design parameter is $V_{O V}$. We have already made numerous remarks about the effect of the value of $V_{O V}$ on performance. Usually, for submicron technologies, $V_{O V}$ is selected in the range of 0.1 V to 0.3 V .

Once values for $L$ and $V_{O V}$ have been selected, the designer is left with the selection of the value of $I_{D}$ or $W$ (or, equivalently, $W / L$ ). For a given process and for the selected values of $L$ and $V_{O V}, I_{D}$ is proportional to $W / L$. It is important to note that the choice of $I_{D}$ or, equivalently, of $W / L$ has no bearing on the value of intrinsic gain $A_{0}$ and the transition frequency $f_{T}$. However, it affects the value of $g_{m}$ and hence the gain-bandwidth product. Figure G. 3 illustrates this point by showing how the gain of a common-source amplifier operated at a constant $V_{O V}$ varies with $I_{D}$ (or, equivalently, $W / L$ ). Note that while the dc gain remains unchanged, increasing $W / L$ and, correspondingly, $I_{D}$, increases the bandwidth proportionally. This, however, assumes that the load capacitance $C_{L}$ is not affected by the device size, an assumption that may not be entirely justified in some cases.


Figure G. 3 Increasing $I_{D}$ or $W / L$ increases the bandwidth of a MOSFET amplifier operated at a constant $V_{O V}$ and loaded by a constant capacitance $C_{L}$.
# Example G. 3 

In this example we investigate the gain and the high-frequency response of an $n p n$ transistor and an NMOS transistor. For the $n p n$ transistor, assume that it is fabricated in the low-voltage process specified in Table G.2, and assume that $C_{\mu} \simeq C_{\mu 0}$. For $I_{C}=10 \mu \mathrm{~A}, 100 \mu \mathrm{~A}$, and 1 mA , find $g_{m}, r_{o}, A_{0}, C_{d e}, C_{j e}, C_{\pi}, C_{\mu}$, and $f_{T}$. Also, for each value of $I_{C}$, find the gain-bandwidth product $f_{t}$ of a common-emitter amplifier loaded by a $1-\mathrm{pF}$ capacitance, neglecting the internal capacitances of the transistor. For the NMOS transistor, assume that it is fabricated in the $0.25-\mu \mathrm{m}$ CMOS process with $L=0.4 \mu \mathrm{~m}$. Let the transistor be operated at $V_{O V}=0.25 \mathrm{~V}$. Find $W / L$ that is required to obtain $I_{D}=10 \mu \mathrm{~A}, 100 \mu \mathrm{~A}$, and 1 mA . At each value of $I_{D}$, find $g_{m}, r_{o}, A_{0}, C_{g e}, C_{g d}$, and $f_{T}$. Also, for each value of $I_{D}$, determine the gain-bandwidth product $f_{T}$ of a common-source amplifier loaded by a $1-\mathrm{pF}$ capacitance, neglecting the internal capacitances of the transistor.

## Solution

For the $n p n$ transistor,

$$
\begin{aligned}
g_{m} & =\frac{I_{C}}{V_{T}}=\frac{I_{C}}{0.025}=40 I_{C} \mathrm{~A} / \mathrm{V} \\
r_{o} & =\frac{V_{A}}{I_{C}}=\frac{35}{I_{C}} \Omega \\
A_{0} & =\frac{V_{A}}{V_{T}}=\frac{35}{0.025}=1400 \mathrm{~V} / \mathrm{V} \\
C_{d e} & =\tau_{F} g_{m}=10 \times 10^{-12} \times 40 I_{C}=0.4 \times 10^{-9} I_{C} \mathrm{~F} \\
C_{j e} & \simeq 2 C_{j e 0}=10 \mathrm{fF} \\
C_{\pi} & =C_{d e}+C_{j e} \\
C_{\mu} & \simeq C_{\mu 0}=5 \mathrm{fF} \\
f_{T} & =\frac{g_{m}}{2 \pi\left(C_{\pi}+C_{\mu}\right)} \\
f_{t} & =\frac{g_{m}}{2 \pi C_{L}}=\frac{g_{m}}{2 \pi \times 1 \times 10^{-12}}
\end{aligned}
$$

We thus obtain the following results:

| $I_{C}$ | $g_{m}(\mathrm{~mA} / \mathrm{V})$ | $r_{o}(\mathrm{k} \Omega)$ | $A_{0}(\mathrm{~V} / \mathrm{V})$ | $C_{d e}(\mathrm{fF})$ | $C_{j e}(\mathrm{fF})$ | $C_{\pi}(\mathrm{fF})$ | $C_{j e}(\mathrm{fF})$ | $f_{T}(\mathrm{GHz})$ | $f_{t}(\mathrm{MHz})$ |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| $10 \mu \mathrm{~A}$ | 0.4 | 3500 | 1400 | 4 | 10 | 14 | 5 | 3.4 | 64 |
| $100 \mu \mathrm{~A}$ | 4 | 350 | 1400 | 40 | 10 | 50 | 5 | 11.6 | 640 |
| 1 mA | 40 | 35 | 1400 | 400 | 10 | 410 | 5 | 15.3 | 6400 |# Example G. 3 continued 

For the NMOS transistor,

$$
\begin{aligned}
I_{D} & =\frac{1}{2} \mu_{n} C_{o s} \frac{W}{L} V_{O V}^{2} \\
& =\frac{1}{2} \times 267 \times \frac{W}{L} \times \frac{1}{16}
\end{aligned}
$$

Thus,

$$
\begin{aligned}
\frac{W}{L} & =0.12 I_{D} \\
g_{m} & =\frac{I_{D}}{V_{O V} / 2}=\frac{I_{D}}{0.25 / 2}=8 I_{D} \mathrm{~A} / \mathrm{V} \\
r_{o} & =\frac{V_{A}^{\prime} L}{I_{D}}=\frac{5 \times 0.4}{I_{D}}=\frac{2}{I_{D}} \Omega \\
A_{0} & =g_{m} r_{o}=16 \mathrm{~V} / \mathrm{V} \\
C_{g s} & =\frac{2}{3} W L C_{o s}+C_{o v}=\frac{2}{3} W \times 0.4 \times 5.8+0.6 W \\
C_{g d} & =C_{o v}=0.6 W \\
f_{T} & =\frac{g_{m}}{2 \pi\left(C_{g s}+C_{g d}\right)} \\
f_{t} & =\frac{g_{m}}{2 \pi C_{L}}
\end{aligned}
$$

We thus obtain the following results:

| $I_{D}$ | $W / L$ | $g_{m}(\mathrm{~mA} / \mathrm{V})$ | $r_{o}(\mathrm{k} \Omega)$ | $A_{0}(\mathrm{~V} / \mathrm{V})$ | $C_{g s}(\mathrm{fF})$ | $C_{g d}(\mathrm{fF})$ | $f_{T}(\mathrm{GHz})$ | $f_{t}(\mathrm{MHz})$ |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| $10 \mu \mathrm{~A}$ | 1.2 | 0.08 | 200 | 16 | 1.03 | 0.29 | 9.7 | 12.7 |
| $100 \mu \mathrm{~A}$ | 12 | 0.8 | 20 | 16 | 10.3 | 2.9 | 9.7 | 127 |
| 1 mA | 120 | 8 | 2 | 16 | 103 | 29 | 9.7 | 1270 |

## EXERCISE

G. 3 Find $I_{D}, g_{m}, r_{o}, A_{0}, C_{g s}, C_{g d}$, and $f_{T}$ for an NMOS transistor fabricated in the $0.5-\mu \mathrm{m}$ CMOS technology specified in Table G.1. Let $L=0.5 \mu \mathrm{~m}, W=5 \mu \mathrm{~m}$, and $V_{O V}=0.3 \mathrm{~V}$.
Ans. $85.5 \mu \mathrm{~A} ; 0.57 \mathrm{~mA} / \mathrm{V} ; 117 \mathrm{k} \Omega ; 66.7 \mathrm{~V} / \mathrm{V} ; 8.3 \mathrm{fF} ; 2 \mathrm{fF} ; 8.8 \mathrm{GHz}$
# G. 4 Combining MOS and Bipolar Transistors-BiCMOS Circuits 

From the discussion above it should be evident that the BJT has the advantage over the MOSFET of a much higher transconductance $\left(g_{m}\right)$ at the same value of dc bias current. Thus, in addition to realizing higher voltage gains per amplifier stage, bipolar transistor amplifiers have superior high-frequency performance compared to their MOS counterparts.

On the other hand, the practically infinite input resistance at the gate of a MOSFET makes it possible to design amplifiers with extremely high input resistances and an almost zero input bias current. Also, as mentioned earlier, the MOSFET provides an excellent implementation of a switch, a fact that has made CMOS technology capable of realizing a host of analog circuit functions that are not possible with bipolar transistors.

It can thus be seen that each of the two transistor types has its own distinct and unique advantages: Bipolar technology has been extremely useful in the design of very-high-quality general-purpose circuit building blocks, such as op amps. On the other hand, CMOS, with its very high packing density and its suitability for both digital and analog circuits, has become the technology of choice for the implementation of very-large-scale integrated circuits. Nevertheless, the performance of CMOS circuits can be improved if the designer has available (on the same chip) bipolar transistors that can be employed in functions that require their high $g_{m}$ and excellent current-driving capability. A technology that allows the fabrication of high-quality bipolar transistors on the same chip as CMOS circuits is aptly called BiCMOS. At appropriate locations throughout this book we present interesting and useful BiCMOS circuit blocks.

## G. 5 Validity of the Square-Law MOSFET Model

We conclude this appendix with a comment on the validity of the simple square-law model we have been using to describe the operation of the MOS transistor. While this simple model works well for devices with relatively long channels ( $>1 \mu \mathrm{~m}$ ), it does not provide an accurate representation of the operation of short-channel devices. This is because a number of physical phenomena come into play in these submicron devices, resulting in what are called short-channel effects. Although a detailed study of short-channel effects is beyond the scope of this book, it should be mentioned that MOSFET models have been developed that take these effects into account. However, they are understandably quite complex and do not lend themselves to hand analysis of the type needed to develop insight into circuit operation. Rather, these models are suitable for computer simulation and are indeed used in SPICE (Appendix B). For quick, manual analysis, however, we will continue to use the square-law model, which is the basis for the comparison of Table G.3.
G. 1 Find the range of $I_{D}$ obtained in a particular NMOS transistor as its overdrive voltage is increased from 0.15 V to 0.4 V . If the same range is required in $I_{C}$ of a BJT, what is the corresponding change in $V_{B E}$ ?
G. 2 What range of $I_{C}$ is obtained in an $n p n$ transistor as a result of changing the area of the emitter-base junction by a factor of 10 while keeping $V_{B E}$ constant? If $I_{C}$ is to be kept constant, by what amount must $V_{B E}$ change?
G. 3 For each of the CMOS technologies specified in Table G.1, find the $\left|V_{O V}\right|$ and hence the $\left|V_{G S}\right|$ required to operate a device with a $W / L$ of 10 at a drain current $I_{D}=$ $100 \mu \mathrm{~A}$. Ignore channel-length modulation.
G. 4 Consider NMOS and PMOS devices fabricated in the $0.25-\mu \mathrm{m}$ process specified in Table G.1. If both devices are to operate at $\left|V_{O V}\right|=0.25 \mathrm{~V}$ and $I_{D}=100 \mu \mathrm{~A}$, what must their $W / L$ ratios be?
G. 5 Consider NMOS and PMOS transistors fabricated in the $0.25-\mu \mathrm{m}$ process specified in Table G.1. If the two devices are to be operated at equal drain currents, what must the ratio of $(W / L)_{p}$ to $(W / L)_{n}$ be to achieve equal values of $g_{m}$ ?
G. 6 An NMOS transistor fabricated in the $0.18-\mu \mathrm{m}$ CMOS process specified in Table G. 1 is operated at $V_{O V}=0.2 \mathrm{~V}$. Find the required $W / L$ and $I_{D}$ to obtain a $g_{m}$ of $10 \mathrm{~mA} / \mathrm{V}$. At what value of $I_{C}$ must an $n p n$ transistor be operated to achieve this value of $g_{m}$ ?
G. 7 For each of the CMOS process technologies specified in Table G.1, find the $g_{m}$ of an NMOS and a PMOS transistor with $W / L=10$ operated at $I_{D}=100 \mu \mathrm{~A}$.
G. 8 An NMOS transistor operated with an overdrive voltage of 0.25 V is required to have a $g_{m}$ equal to that of an $n p n$ transistor operated at $I_{C}=0.1 \mathrm{~mA}$. What must $I_{D}$ be? What value of $g_{m}$ is realized?
G. 9 It is required to find the incremental (i.e., small-signal) resistance of each of the diode-connected transistors shown in Fig. PG.9. Assume that the dc bias current $I=0.1 \mathrm{~mA}$. For the MOSFET, let $\mu_{n} C_{o s}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $W / L=10$.


Figure PG. 9
G. 10 For an NMOS transistor with $L=1 \mu \mathrm{~m}$ fabricated in the $0.8-\mu \mathrm{m}$ process specified in Table G.1, find $g_{m}, r_{o}$, and $A_{0}$ if the device is operated with $V_{O V}=0.5 \mathrm{~V}$ and $I_{D}=100 \mu \mathrm{~A}$. Also, find the required device width $W$.
G. 11 For an NMOS transistor with $L=0.3 \mu \mathrm{~m}$ fabricated in the $0.18-\mu \mathrm{m}$ process specified in Table G.1, find $g_{m}, r_{o}$, and $A_{0}$ obtained when the device is operated at $I_{D}=100 \mu \mathrm{~A}$ with $V_{O V}=0.2 \mathrm{~V}$. Also, find $W$.
G. 12 Fill in the table below. For the BJT, let $\beta=100$ and $V_{A}=100 \mathrm{~V}$. For the MOSFET, let $\mu_{n} C_{o s}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$, $W / L=40$, and $V_{A}=10 \mathrm{~V}$. Note that $R_{\mathrm{m}}$ refers to the input resistance at the control input terminal (gate, base) with the (source, emitter) grounded.

|  | BJT | MOSFET |
| :-- | :--: | :--: |
| Bias Current | $I_{C}=0.1 \mathrm{~mA}$ | $I_{C}=1 \mathrm{~mA} I_{D}=0.1 \mathrm{~mA} I_{D}=1 \mathrm{~mA}$ |
| $g_{m}(\mathrm{~mA} / \mathrm{V})$ |  |  |
| $r_{o}(\mathrm{k} \Omega)$ |  |  |
| $A_{0}(\mathrm{~V} / \mathrm{V})$ |  |  |
| $R_{m}(\mathrm{k} \Omega)$ |  |  |

G. 13 For an NMOS transistor fabricated in the $0.18-\mu \mathrm{m}$ process specified in Table G. 1 with $L=0.3 \mu \mathrm{~m}$ and $W=$ $6 \mu \mathrm{~m}$, find the value of $f_{T}$ obtained when the transistor is operated at $V_{O V}=0.2 \mathrm{~V}$. Use both the formula in terms of $C_{g s}$ and $C_{g d}$ and the approximate formula. Why does the approximate formula overestimate $f_{T}$ ?
G. 14 An NMOS transistor fabricated in the $0.18-\mu \mathrm{m}$ process specified in Table G. 1 and having $L=0.3 \mu \mathrm{~m}$ and $W=6 \mu \mathrm{~m}$ is operated at $V_{O V}=0.2 \mathrm{~V}$ and used to drive a
capacitive load of 100 fF . Find $A_{0}, f_{P}\left(\right.$ or $f_{3 \text { dB }}$ ), and $f_{c}$. At what $I_{D}$ value is the transistor operating? If it is required to double $f_{c}$, what must $I_{D}$ become? What happens to $A_{0}$ and $f_{P}$ in this case?
G. 15 For an $n p n$ transistor fabricated in the high-voltage process specified in Table G.2, evaluate $f_{T}$ at $I_{C}=10 \mu \mathrm{~A}$, $100 \mu \mathrm{~A}$, and 1 mA . Assume $C_{\mu} \simeq C_{\mu 0}$. Repeat for the low-voltage process.
G. 16 Consider an NMOS transistor fabricated in the $0.8-\mu \mathrm{m}$ process specified in Table G.1. Let the transistor have $L=1 \mu \mathrm{~m}$, and assume it is operated at $I_{D}=100 \mu \mathrm{~A}$.
(a) For $V_{O V}=0.25 \mathrm{~V}$, find $W, g_{m}, r_{o}, A_{0}, C_{g s}, C_{g d}$, and $f_{T}$.
(b) To what must $V_{O V}$ be changed to double $f_{T}$ ? Find the new values of $W, g_{m}, r_{o}, A_{0}, C_{g s}$, and $C_{g d}$.
G. 17 For a lateral pnp transistor fabricated in the high-voltage process specified in Table G.2, find $f_{T}$ if the device is operated at a collector bias current of 1 mA . Compare to the value obtained for a vertical npn.
G. 18 Show that for a MOSFET the selection of $L$ and $V_{O V}$ determines $A_{0}$ and $f_{T}$. In other words, show that $A_{0}$ and $f_{T}$ will not depend on $I_{D}$ and $W$.
G. 19 Consider an NMOS transistor fabricated in the $0.18-\mu \mathrm{m}$ technology specified in Table G.1. Let the transistor be operated at $V_{O V}=0.2 \mathrm{~V}$. Find $A_{0}$ and $f_{T}$ for $L=0.2 \mu \mathrm{~m}$, $0.3 \mu \mathrm{~m}$, and $0.4 \mu \mathrm{~m}$.

D G. 20 Consider an NMOS transistor fabricated in the $0.5-\mu \mathrm{m}$ process specified in Table G.1. Let $L=0.5 \mu \mathrm{~m}$ and $V_{O V}=0.3 \mathrm{~V}$. If the MOSFET is connected as a common-source amplifier with a load capacitance $C_{L}=1 \mathrm{pF}$ (as in Fig. G.2a), find the required transistor width $W$ and bias current $I_{D}$ to obtain a unity-gain bandwidth of 100 MHz . Also, find $A_{0}$ and $f_{3 \text { dB }}$.
# APPENDIX H 

## DESIGN OF STAGGER-TUNED AMPLIFIERS

As mentioned in Section 17.11.7, a much better overall response of a tuned amplifier is obtained by stagger-tuning (as opposed to synchronous tuning) the individual stages, as illustrated in Fig. 17.46 which is repeated here as Fig. H.1. Stagger-tuned amplifiers are usually designed so that the overall response exhibits maximal flatness around the center-frequency $f_{0}$. Such a response can be obtained by transforming the response of a maximally flat (Butterworth) low-pass filter up the frequency axis to $\omega_{0}$. We show here how this can be done.

The transfer function of a second-order bandpass filter can be expressed in terms of its poles as

$$
T(s)=\frac{a_{1} s}{\left(s+\frac{\omega_{0}}{2 Q}-j \omega_{0} \sqrt{1-\frac{1}{4 Q^{2}}}\right)\left(s+\frac{\omega_{0}}{2 Q}+j \omega_{0} \sqrt{1-\frac{1}{4 Q^{2}}}\right)}
$$

For a narrow-band filter, $Q \gg 1$, and for values of $s$ in the neighborhood of $+j \omega_{0}$ (see Fig. H.2b), the second factor in the denominator is approximately $\left(s+j \omega_{0} \simeq 2 s\right)$. Hence Eq. (H.1) can be approximated in the neighborhood of $j \omega_{0}$ by

$$
T(s) \simeq \frac{a_{1} / 2}{s+\omega_{0} / 2 Q-j \omega_{0}}=\frac{a_{1} / 2}{\left(s-j \omega_{0}\right)+\omega_{0} / 2 Q}
$$

This is known as the narrow-band approximation. ${ }^{1}$ Note that the magnitude response, for $s=j \omega$, has a peak value of $a_{1} Q / \omega_{0}$ at $\omega=\omega_{0}$, as expected.

Now consider a first-order low-pass network with a single pole at $p=-\omega_{0} / 2 Q$ (we use $p$ to denote the complex frequency variable for the low-pass filter). Its transfer function is

$$
T(p)=\frac{K}{p+\omega_{0} / 2 Q}
$$

where $K$ is a constant. Comparing Eqs. (H.2) and (H.3) we note that they are identical for $p=s-j \omega_{0}$ or, equivalently,

$$
s=p+j \omega_{0}
$$

[^0]
[^0]:    ${ }^{1}$ The bandpass response is geometrically symmetrical around the center frequency $\omega_{0}$. That is, each pair of frequencies $\omega_{1}$ and $\omega_{2}$ at which the magnitude response is equal are related by $\omega_{1} \omega_{2}=\omega_{0}^{2}$. For high $Q$, the symmetry becomes almost arithmetic for frequencies close to $\omega_{0}$. That is, two frequencies with the same magnitude response are almost equally spaced from $\omega_{0}$. The same is true for higher-order bandpass filters designed using the transformation presented in this section.


Figure H. 1 Stagger-tuning the individual resonant circuits can result in an overall response with a passband flatter than that obtained with synchronous tuning (Fig. 17.48).

This result implies that the response of the second-order bandpass filter in the neighborhood of its center frequency $s=j \omega_{0}$ is identical to the response of a first-order low-pass filter with a pole at $\left(-\omega_{0} / 2 Q\right)$ in the neighborhood of $p=0$. Thus the bandpass response can be obtained by shifting the pole of the low-pass prototype and adding the complex-conjugate pole, as illustrated in Fig. H.2(b). This is called a lowpass-to-bandpass transformation for narrow-band filters.

The transformation $p=s-j \omega_{0}$ can be applied to low-pass filters of order greater than one. For instance, we can transform a maximally flat, second-order low-pass filter $(Q=1 / \sqrt{2})$ to obtain a maximally flat bandpass filter. If the $3-\mathrm{dB}$ bandwidth of the bandpass filter is to be $B \mathrm{rad} / \mathrm{s}$, then the low-pass filter should have a $3-\mathrm{dB}$ frequency (and thus a pole frequency) of $(B / 2) \mathrm{rad} / \mathrm{s}$, as illustrated in Fig. H.3. The resulting fourth-order bandpass filter will be a stagger-tuned one, with its two tuned circuits (refer to Fig. 16.48) having

$$
\begin{aligned}
& \omega_{01}=\omega_{0}+\frac{B}{2 \sqrt{2}} \quad B_{1}=\frac{B}{\sqrt{2}} \quad Q_{1} \simeq \frac{\sqrt{2} \omega_{0}}{B} \\
& \omega_{02}=\omega_{0}-\frac{B}{2 \sqrt{2}} \quad B_{2}=\frac{B}{\sqrt{2}} \quad Q_{2}=\frac{\sqrt{2} \omega_{0}}{B}
\end{aligned}
$$

Note that for the overall response to have a normalized center-frequency gain of unity, the individual responses have to have equal center-frequency gains of $\sqrt{2}$, as shown in Fig. H.3(d).


Figure H. 2 Obtaining a second-order narrow-band bandpass filter by transforming a first-order low-pass filter. (a) Pole of the first-order filter in the $p$ plane. (b) Applying the transformation $s=p+j \omega_{0}$ and adding a complex-conjugate pole results in the poles of the second-order bandpass filter. (c) Magnitude response of the first-order low-pass filter. (d) Magnitude response of the second-order bandpass filter.


Figure H. 3 Obtaining the poles and the frequency response of a fourth-order stagger-tuned, narrow-band bandpass amplifier by transforming a second-order low-pass, maximally flat response.
# EXERCISES 

D H. 1 A stagger-tuned design for the IF amplifier specified in Exercise 17.36 is required. Find $f_{01}, B_{1}, f_{02}$, and $B_{2}$. Also give the value of $C$ and $R$ for each of the two stages. (Recall that $3-\mu \mathrm{H}$ inductors are to be used.)
Ans. $10.77 \mathrm{MHz} ; 141.4 \mathrm{kHz} ; 10.63 \mathrm{MHz} ; 141.4 \mathrm{kHz} ; 72.8 \mathrm{pF} ; 15.5 \mathrm{k} \Omega ; 74.7 \mathrm{pF} ; 15.1 \mathrm{k} \Omega$
H. 2 Using the fact that the voltage gain at resonance is proportional to the value of $R$, find the ratio of the gain at 10.7 MHz of the stagger-tuned amplifier designed in Exercise H. 1 and the synchronously tuned amplifier designed in Exercise 17.36. (Hint: For the stagger-tuned amplifier, note that the gain at $\omega_{0}$ is equal to the product of the gains of the individual stages at their 3-dB frequencies.)
Ans. 2.42
*H. 1 This problem investigates the selectivity of maximally flat stagger-tuned amplifiers derived in the manner illustrated in Fig. H.3.
(a) The low-pass maximally flat (Butterworth) filter having a 3-dB bandwidth $B / 2$ and order $N$ has the magnitude response

$$
|T|=1 / \sqrt{1+\left(\frac{\Omega}{B / 2}\right)^{2 N}}
$$

where $\Omega=\operatorname{Im}(p)$ is the frequency in the low-pass domain. (This relationship can be obtained using the information provided in Section 17.3 on Butterworth filters.) Use this expression to obtain for the corresponding bandpass filter
at $\omega=\omega_{0}+\delta \omega$, where $\delta \omega \ll \omega_{0}$, the relationship

$$
|T|=1 / \sqrt{1+\left(\frac{\delta \omega}{B / 2}\right)^{2 N}}
$$

(b) Use the transfer function in (a) to find the attenuation (in decibels) obtained at a bandwidth of $2 B$ for $N=1$ to 5 . Also find the ratio of the $30-\mathrm{dB}$ bandwidth to the $3-\mathrm{dB}$ bandwidth for $N=1$ to 5 .
**H. 2 Consider a sixth-order, stagger-tuned bandpass amplifier with center frequency $\omega_{0}$ and $3-\mathrm{dB}$ bandwidth $B$. The poles are to be obtained by shifting those of the third-order maximally flat low-pass filter, given in Fig. 17.10(c). For each of the three resonant circuits, find $\omega_{0}$, the $3-\mathrm{dB}$ bandwidth, and $Q$.
# APPENDIX I 

## BIBLIOGRAPHY

## HISTORY OF ELECTRONICS

L. Berlin, The Man Behind the Microchip: Robert Noyce and the Invention of Silicon Valley, New York: Oxford University Press, 2005.
J. Gertner, The Idea Factory: Bell Labs and the Great Age of American Innovation, New York: The Penguin Press, 2012.
IEEE Solid-State Circuits Magazine, and its predecessor, IEEE Solid-State Circuits Newsletter, published quarterly by the IEEE Solid-State Circuits Society.
T.R. Reid, The Chip, New York: Random House, 2001.
J.N. Shurkin, Broken Genius: The Rise and Fall of William Shockley, Creator of the Electronic Age, New York, Macmillan, 2008.
J. Williams, editor, Analog Circuit Design: Art, Science, and Personalities, Boston: ButterworthHeinemann, 1991.

## GENERAL TEXTBOOKS ON ELECTRONIC CIRCUITS

E.F. Angelo Jr., Electronics: BJTs, FETs, and Microcircuits, New York: McGraw-Hill, 1969.
S.B. Burns and P.R. Bond, Principles of Electronic Circuits, St. Paul: West, 1987.
M.S. Ghausi, Electronic Devices and Circuits: Discrete and Integrated, New York: Holt, Rinehart and Winston, 1985.
P.E. Gray and C.L. Searle, Electronic Principles, New York: Wiley, 1969.
A.R. Hambley, Electronics, 2nd ed., Upper Saddle River, NJ: Prentice-Hall, 1999.
W.H. Hayt and G.W. Neudeck, Electronic Circuit Analysis and Design, 2nd ed., Boston: Houghton Mifflin Co., 1984.
C.A. Holt, Electronic Circuits, New York: Wiley, 1978.
M.N. Horenstein, Microelectronic Circuits and Devices, 2nd ed., Englewood Cliffs, NJ: Prentice-Hall, 1995.
R.T. Howe and C.G. Sodini, Microelectronics-An Integrated Approach, Englewood Cliffs, NJ: Prentice-Hall, 1997.
R.C. Jaeger and T.N. Blalock, Microelectronic Circuit Design, 4th ed., New York: McGraw-Hill, 2011.
N.R. Malik, Electronic Circuits: Analysis, Simulation, and Design, Englewood Cliffs, NJ: Prentice-Hall, 1995.
J. Millman and A. Grabel, Microelectronics, 2nd ed., New York: McGraw-Hill, 1987.
D.A. Neamen, Electronic Circuit Analysis and Design, 4th ed., New York: McGraw-Hill, 2010.
M.H. Rashid, Microelectronic Circuits: Analysis and Design, Boston: PWS, 1999.
B. Ravazi, Fundamentals of Microelectronics, 2nd ed. Hoboken, NJ: Wiley, 2014.
D.L. Schilling and C. Belove, Electronic Circuits, 2nd ed., New York: McGraw-Hill, 1979.
R.A. Spencer and M.S. Ghausi, Introduction to Electronic Circuit Design, Upper Saddle River, NJ: Pearson Education Inc. (Prentice-Hall), 2003.

## CIRCUIT AND SYSTEM ANALYSIS

L.S. Bobrow, Elementary Linear Circuit Analysis, 2nd ed., New York: Holt, Rinehart and Winston, 1987.
A.M. Davis, Linear Circuit Analysis, Boston, PWS Publishing Company, 1998.
S.S. Haykin, Active Network Theory, Reading, MA: Addison-Wesley, 1970.
W.H. Hayt, G.E. Kemmerly, and S.M. Durbin, Engineering Circuit Analysis, 6th ed., New York: McGraw-Hill, 2003.
D. Irwin, Basic Engineering Circuit Analysis, 7th ed., New York: Wiley, 2001.
B.P. Lathi, Linear Systems and Signals, New York: Oxford University Press, 1992.
J.W. Nilsson and S. Riedel, Electronic Circuits, 7th ed., Upper Saddle River, NJ: Prentice-Hall, 2005.

## DEVICES AND IC FABRICATION

R.S.C. Cobbold, Theory and Applications of Field Effect Transistors, New York: Wiley, 1969.
I. Getreu, Modeling the Bipolar Transistor, Beaverton, OR: Tektronix, Inc., 1976.
R.S. Muller and T.I. Kamins, Device Electronics for Integrated Circuits, 3rd ed., New York: Wiley, 2003.
J.D. Plummer, M.D. Deal, and P.B. Griffin, Silicon VLSI Technology, Upper Saddle River, NJ: Prentice-Hall, 2000.
D.L. Pulfrey and N.G. Tarr, Introduction to Microelectronic Devices, Englewood Cliffs, NJ: Prentice-Hall, 1989.C.L. Searle, A.R. Boothroyd, E.J. Angelo, Jr., P.E. Gray, and D.O. Pederson, Elementary Circuit Properties of Transistors, Vol. 3 of the SEEC Series, New York: Wiley, 1964.
B.G. Streetman and S. Banerjee, Solid-State Electronic Devices, 5th ed., Upper Saddle River, NJ: Prentice-Hall, 2000.
Y. Tsividis, Operation and Modeling of the MOS Transistor, 3rd ed., New York: Oxford University Press, 2011.

## OPERATIONAL AMPLIFIERS

G.B. Clayton, Experimenting with Operational Amplifiers, London: Macmillan, 1975.
G.B. Clayton, Operational Amplifiers, 2nd ed., London: Newnes-Butterworths, 1979.
S. Franco, Design with Operational Amplifiers and Analog Integrated Circuits, 3rd ed., New York: McGraw-Hill, 2001.
J.G. Graeme, G.E. Tobey, and L.P. Huelsman, Operational Amplifiers: Design and Applications, New York: McGraw-Hill, 1971.
W. Jung, IC Op Amp Cookbook, Indianapolis: Howard Sams, 1974.
E.J. Kennedy, Operational Amplifier Circuits: Theory and Applications, New York: Holt, Rinehart and Winston, 1988.
J.K. Roberge, Operational Amplifiers: Theory and Practice, New York: Wiley, 1975.
J.L. Smith, Modern Operational Circuit Design, New York: Wiley-Interscience, 1971.
J.V. Wait, L.P. Huelsman, and G.A. Korn, Introduction to Operational Amplifiers:Theory and Applications, New York: McGraw-Hill, 1975.

## ANALOG CIRCUITS

P.E. Allen and D.R. Holberg, CMOS Analog Circuit Design, 3rd ed., New York: Oxford University Press, 2012.
R. Jacob Baker, CMOS: Circuit Design, Layout and Simulation, 3rd ed. Hoboken, N.J.: Wiley, 2010.
K. Bult, Transistor-Level Analog IC Design. Notes for a short course organized by Mead, Ecole Polytechnique Féderal de Lausanne, 2002.
T. Chan Carusone, D.A. Johns, and K. Martin, Analog Integrated Circuit Design, 2nd ed. New York: Wiley, 2012.
M.J. Fonderic and J.H. Huising, Design of Low-Voltage Bipolar Operational Amplifiers, Boston: Kluwer Academic Publishers, 1993.
R.L. Geiger, P.E. Allen, and N.R. Strader, VLSI Design Techniques for Analog and Digital Circuits, New York: McGraw-Hill, 1990.
P.R. Gray, P.J. Hurst, S.H. Lewis, and R.G. Meyer, Analysis and Design of Analog Integrated Circuits, 5th ed., Hoboken, NJ: Wiley, 2008.
A.B. Grebene, Bipolar and MOS Analog Integrated Circuit Design, New York: Wiley, 1984.
R. Gregorian and G.C. Temes, Analog MOS Integrated Circuits for Signal Processing, New York: Wiley, 1986.
J.H. Huising, Operational Amplifiers, Boston: Kluwer Academic Publishers, 2001.
IEEE Journal of Solid-State Circuits, a monthly publication of the IEEE.
K. Laker and W. Sansen, Design for Analog Integrated Circuits and Systems, New York: McGraw-Hill, 1999.
H.S. Lee, "Analog Design," Chapter 8 in BiCMOS Technology and Applications, A.R. Alvarez, editor, Boston: Kluwer Academic Publishers, 1989.
National Semiconductor Corporation, Audio/Radio Handbook, Santa Clara, CA: National Semiconductor Corporation, 1980.
B. Razavi, Design of Analog CMOS Integrated Circuits, New York: McGraw-Hill, 2001.
J.K. Roberge, Operational Amplifiers: Theory and Practice, New York: Wiley, 1975.
S. Rosenstark, Feedback Amplifier Principles, New York: Macmillan, 1986.
W.M.C. Sansen, Analog Design Essentials, Dordrecht, The Netherlands: Springer, 2006.
A.S. Sedra and G.W. Roberts, "Current Conveyor Theory and Practice," Chapter 3 in Analogue IC Design: The Current-Mode Approach, C. Toumazou, F.J. Lidgey, and D.G. Haigh, editors, London: Peter Peregrinus, 1990.
R. Severns, editor, MOSPOWER Applications Handbook, Santa Clara, CA: Siliconix, 1984.
Texas Instruments, Inc., Power Transistor and TTL Integrated-Circuit Applications, New York: McGraw-Hill, 1977.
S. Soclof, Applications of Analog Integrated Circuits, Englewood Cliffs, NJ: Prentice-Hall, 1985.
J.M. Steininger, "Understanding wideband MOS transistors," IEEE Circuits and Devices, Vol. 6, No. 3, pp. 26-31, May 1990.

## DIGITAL CIRCUITS

A.R. Alvarez, editor, BiCMOS Technology and Applications, 2nd ed., Boston: Kluwer Academic Publishers, 1993.
M.I. Elmasry, editor, Digital MOS Integrated Circuits, New York: IEEE Press, 1981. Also, Digital MOS Integrated Circuits II, 1992.
S.H.K Embabi, A. Bellaour, and M.I. Elmasry, Digital BiCMOS Integrated Circuit Design, Boston: Kluwer, 1993.
D.A. Hodges, H.G. Jackson, and R.A. Saleh, Analysis and Design of Digital Integrated Circuits, 3rd ed., New York: McGraw-Hill, 2004.
IEEE Journal of Solid-State Circuits, a monthly publication of the IEEE.
S.M. Kang and Y. Leblebici, CMOS Digital Integrated Circuits, 3rd ed., New York: McGraw-Hill, 2003.
R. Littauer, Pulse Electronics, New York: McGrawHill, 1965.
K. Martin, Digital Integrated Circuit Design, New York: Oxford University Press, 2000.
J. Millman and H. Taub, Pulse, Digital, and Switching Waveforms, New York: McGraw-Hill, 1965.
Motorola, MECL Device Data, Phoenix, AZ: Motorola Semiconductor Products, Inc., 1989.
Motorola, MECL System Design Handbook, Phoenix, AZ: Motorola Semiconductor Products, Inc., 1988.
J.M. Rabaey, Digital Integrated Circuits, Englewood Cliffs, NJ: Prentice-Hall, 1996. Note: A 2nd ed., with A. Chandrakasan and B. Nikolic, also appeared in 2003.
L. Strauss, Wave Generation and Shaping, 2nd ed., New York: McGraw-Hill, 1970.
H. Taub and D. Schilling, Digital Integrated Electronics, New York: McGraw-Hill, 1977.
N. Weste and K. Eshraghian, Principles of CMOS VLSI Design, Reading, MA: Addison-Wesley, 1985 and 1993.

## FILTERS AND TUNED AMPLIFIERS

P.E. Allen and E. Sanchez-Sinencio, Switched-Capacitor Circuits, New York: Van Nostrand Reinhold, 1984.
K.K. Clarke and D.T. Hess, Communication Circuits: Analysis and Design, Ch. 6, Reading, MA: Addison Wesley, 1971.
G. Daryanani, Principles of Active Network Synthesis and Design, New York: Wiley, 1976.
R. Gregorian and G.C. Temes, Analog MOS Integrated Circuits for Signal Processing, New York: Wiley-Interscience, 1986.
S.K. Mitra and C.F. Kurth, editors, Miniaturized and Integrated Filters, New York: Wiley-Interscience, 1989.
C. Ouslis and A. Sedra, "Designing custom filters," IEEE Circuits and Devices, May 1995, pp. 29-37.
R. Schaumann, M.S. Ghausi, and K.R. Laker, Design of Analog Filters, Englewood Cliffs, NJ: Prentice-Hall, 1990.
R. Schaumann, M. Soderstand, and K. Laker, editors, Modern Active Filter Design, New York: IEEE Press, 1981.
R. Schaumann, H. Xiao, and M.E. Van Valkenburg, Design of Analog Filters, 2nd ed. New York: Oxford University Press, 2010.
A.S. Sedra, "Switched-capacitor filter synthesis," in MOS VLSI Circuits for Telecommunications, Y. Tsividis and P. Antognetti, editors, Englewood Cliffs, NJ: Prentice-Hall, 1985.
A.S. Sedra and P.O. Brackett, Filter Theory and Design: Active and Passive, Portland, OR: Matrix, 1978.
M.E. Van Valkenburg, Analog Filter Design, New York: Holt, Rinehart and Winston, 1981.
A.I. Zverev, Handbook of Filter Synthesis, New York: Wiley, 1967.

## SPICE

M.E. Herniter, Schematic Capture with Cadence PSpice, 2nd ed., Upper Saddle River, NJ: Prentice-Hall, 2003.
G. Massobrio and P. Antognetti, Semiconductor Device Modeling with SPICE, 2nd ed., New York: McGraw-Hill, 1993.
G.W. Roberts and A.S. Sedra, SPICE, New York: Oxford University Press, 1992 and 1997.
J.A. Svoboda, PSpice for Linear Circuits, New York: Wiley, 2002.
P.W. Tuinenga, SPICE: A Guide to Circuit Simulation Analysis Using PSpice, 2nd ed., Englewood Cliffs, NJ: Prentice-Hall, 1992.
# APPENDIX J 

## STANDARD RESISTANCE VALUES AND UNIT PREFIXES

Discrete resistors are available only in standard values. Table J. 1 provides the multipliers for the standard values of $5 \%$-tolerance and $1 \%$-tolerance resistors. Thus, in the kilohm range of $5 \%$ resistors, one finds resistances of $1.0,1.1,1.2,1.3,1.5, \ldots$ In the same range, one finds $1 \%$ resistors of kilohm values of $1.00,1.02,1.05,1.07,1.10, \ldots$

Table J. 1 Standard Resistance Values

|  | $1 \%$ Resistor Values $(\mathrm{k} \Omega)$ |  |  |  |
| :--: | :--: | :--: | :--: | :--: |
| $5 \%$ Resistor Values $(\mathrm{k} \Omega)$ | $100-174$ | $178-309$ | $316-549$ | $562-976$ |
| 10 | 100 | 178 | 316 | 562 |
| 11 | 102 | 182 | 324 | 576 |
| 12 | 105 | 187 | 332 | 590 |
| 13 | 107 | 191 | 340 | 604 |
| 15 | 110 | 196 | 348 | 619 |
| 16 | 113 | 200 | 357 | 634 |
| 18 | 115 | 205 | 365 | 649 |
| 20 | 118 | 210 | 374 | 665 |
| 22 | 121 | 215 | 383 | 681 |
| 24 | 124 | 221 | 392 | 698 |
| 27 | 127 | 226 | 402 | 715 |
| 30 | 130 | 232 | 412 | 732 |
| 33 | 133 | 237 | 422 | 750 |
| 36 | 137 | 243 | 432 | 768 |
| 39 | 140 | 249 | 442 | 787 |
| 43 | 143 | 255 | 453 | 806 |
| 47 | 147 | 261 | 464 | 825 |
| 51 | 150 | 267 | 475 | 845 |
| 56 | 154 | 274 | 487 | 866 |
| 62 | 158 | 280 | 499 | 887 |
| 68 | 162 | 287 | 511 | 909 |
| 75 | 165 | 294 | 523 | 931 |
| 82 | 169 | 301 | 536 | 953 |
| 91 | 174 | 309 | 549 | 976 |
Table J. 2 provides the SI unit prefixes used in this book and in all modern works in English.

| Table J. 2 | SI Unit Prefixes |  |
| :-- | :--: | :-- |
| Name | Symbol | Factor |
| femto | f | $\times 10^{-15}$ |
| pico | p | $\times 10^{-12}$ |
| nano | n | $\times 10^{-9}$ |
| micro | $\mu$ | $\times 10^{-6}$ |
| milli | m | $\times 10^{-3}$ |
| kilo | k | $\times 10^{3}$ |
| mega | M | $\times 10^{6}$ |
| giga | G | $\times 10^{9}$ |
| tera | T | $\times 10^{12}$ |
| peta | P | $\times 10^{15}$ |

Table J. 3 provides the meter conversion factors.

Table J. 3 Meter Conversion Factors
$1 \mu \mathrm{~m}=10^{-4} \mathrm{~cm}=10^{-6} \mathrm{~m}$
$1 \mathrm{~m}=10^{2} \mathrm{~cm}=10^{6} \mu \mathrm{~m}=10^{9} \mathrm{~nm}$
$0.1 \mu \mathrm{~m}=100 \mathrm{~nm}$
$1 \AA=10^{-8} \mathrm{~cm}=10^{-10} \mathrm{~m}$
# APPENDIX K 

## TYPICAL PARAMETER VALUES FOR IC DEVICES FABRICATED IN CMOS AND BIPOLAR PROCESSES

Table K. 1 Typical Values of CMOS Device Parameters

| Parameter | $0.8 \mu \mathrm{~m}$ |  | $0.5 \mu \mathrm{~m}$ |  | $0.25 \mu \mathrm{~m}$ |  | $0.18 \mu \mathrm{~m}$ |  | $0.13 \mu \mathrm{~m}$ |  | 65 nm |  |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
|  | NMOS | PMOS | NMOS | PMOS | NMOS | PMOS | NMOS | PMOS | NMOS | PMOS | NMOS | PMOS |
| $t_{\text {ox }}(\mathrm{nm})$ | 15 | 15 | 9 | 9 | 6 | 6 | 4 | 4 | 2.7 | 2.7 | 1.4 | 1.4 |
| $C_{\text {ox }}\left(\mathrm{fF} / \mu \mathrm{m}^{2}\right)$ | 2.3 | 2.3 | 3.8 | 3.8 | 5.8 | 5.8 | 8.6 | 8.6 | 12.8 | 12.8 | 25 | 25 |
| $\mu\left(\mathrm{cm}^{2} / \mathrm{V} \cdot \mathrm{s}\right)$ | 550 | 250 | 500 | 180 | 460 | 160 | 450 | 100 | 400 | 100 | 216 | 40 |
| $\mu C_{\text {ox }}\left(\mu \mathrm{A} / \mathrm{V}^{2}\right)$ | 127 | 58 | 190 | 68 | 267 | 93 | 387 | 86 | 511 | 128 | 540 | 100 |
| $V_{t 0}(\mathrm{~V})$ | 0.7 | $-0.7$ | 0.7 | $-0.8$ | 0.5 | $-0.6$ | 0.5 | $-0.5$ | 0.4 | $-0.4$ | 0.35 | $-0.35$ |
| $V_{D D}(\mathrm{~V})$ | 5 | 5 | 3.3 | 3.3 | 2.5 | 2.5 | 1.8 | 1.8 | 1.3 | 1.3 | 1.0 | 1.0 |
| $\left|V_{A}\right|(V / \mu \mathrm{m})$ | 25 | 20 | 20 | 10 | 5 | 6 | 5 | 6 | 5 | 6 | 3 | 3 |
| $C_{\text {ov }}(\mathrm{fF} / \mu \mathrm{m})$ | 0.2 | 0.2 | 0.4 | 0.4 | 0.3 | 0.3 | 0.37 | 0.33 | 0.36 | 0.33 | 0.33 | 0.31 |

Table K. 2 Typical Parameter Values for BJTs*

| Parameter | Standard High-Voltage Process |  | Advanced Low-Voltage Process |  |
| :--: | :--: | :--: | :--: | :--: |
|  | npn | Lateral pnp | npn | Lateral pnp |
| $A_{E}\left(\mu \mathrm{~m}^{2}\right)$ | 500 | 900 | 2 | 2 |
| $I_{S}(\mathrm{~A})$ | $5 \times 10^{-15}$ | $2 \times 10^{-15}$ | $6 \times 10^{-18}$ | $6 \times 10^{-18}$ |
| $\beta_{0}(\mathrm{~A} / \mathrm{A})$ | 200 | 50 | 100 | 50 |
| $V_{A}(\mathrm{~V})$ | 130 | 50 | 35 | 30 |
| $V_{C E O}(\mathrm{~V})$ | 50 | 60 | 8 | 18 |
| $\tau_{F}$ | 0.35 ns | 30 ns | 10 ps | 650 ps |
| $C_{p 0}$ | 1 pF | 0.3 PF | 5 fF | 14 fF |
| $C_{p 0}$ | 0.3 pF | 1 pF | 5 fF | 15 fF |
| $r_{s}(\Omega)$ | 200 | 300 | 400 | 200 |
| *Adapted from Gray et al. (2001); see Appendix I. |  |  |  |  |

Note: For more information, refer to Appendix G (on the book's Website).
# APPENDIX L 

## ANSWERS TO SELECTED PROBLEMS

## CHAPTER 1

1.1 (a) 5 mA ; (b) $5 \mathrm{k} \Omega$; (c) 1 V ; (d) 10 mA
1.3 (a) $5 \mathrm{~V}, 25 \mathrm{~mW}$; (b) $5 \mathrm{k} \Omega, 5 \mathrm{~mW}$; (c) $10 \mathrm{~mA}, 1 \mathrm{k} \Omega$; (d) $10 \mathrm{~V}, 100 \mathrm{k} \Omega$; (e) 31.6 mA , 31.6 V
$1.5990 \mathrm{k} \Omega, 190 \mathrm{k} \Omega, 90 \mathrm{k} \Omega, 10 \mathrm{k} \Omega ; 9.9 \mathrm{k} \Omega(1 \%$ reduction $), 9.09 \mathrm{k} \Omega(9.1 \%$ reduction $)$, $5 \mathrm{k} \Omega(50 \%$ reduction $)$
$1.72 \mathrm{~V}, 1.2 \mathrm{k} \Omega ; 1.88 \mathrm{~V}$ to $2.12 \mathrm{~V} ; 1.26 \mathrm{k} \Omega$ to $1.14 \mathrm{k} \Omega$
1.94 .80 V , Shunt the $10-\mathrm{k} \Omega$ resistor with $157 \mathrm{k} \Omega$; Add a series resistance of $200 \Omega$.
$1.1110 \mathrm{k} \Omega, 5 \mathrm{k} \Omega$
$1.150 .77 \mathrm{~V}, 12.31 \mathrm{k} \Omega, 0.05 \mathrm{~mA}$
$1.160 .75 \mathrm{~mA}, 0.5 \mathrm{~mA}, 1.25 \mathrm{~mA}, 2.5 \mathrm{~V}$
1.20 (a) $10^{-7} \mathrm{~s}, 10^{7} \mathrm{~Hz}, 6.28 \times 10^{7} \mathrm{rad} / \mathrm{s}$; (f) $10^{3} \mathrm{rad} / \mathrm{s}, 1.59 \times 10^{2} \mathrm{~Hz}, 6.28 \times 10^{-3} \mathrm{~s}$
1.22 (a) $(1-j 1.59) \mathrm{k} \Omega$; (b) $(247.3-j 1553) \Omega$; (c) $(71.72-j 45.04) \mathrm{k} \Omega$; (d) $(100+j 628) \Omega$
$1.2460 \mathrm{mV}, 1.2 \mu \mathrm{~A}, 50 \mathrm{k} \Omega$
$1.255 \mathrm{k} \Omega$
1.29 (a) 165 V ; (b) 24 V
$1.3214 \mathrm{kHz}, 441 \mathrm{mV}$ (peak); $312 \mathrm{mV} ; 693 \mathrm{mV}, 71.4 \mu \mathrm{~s}$
$1.340,110,1011,11100,111011$
1.36 (c) $12,1.2 \mathrm{mV}, 0.6 \mathrm{mV}$
$1.387 .056 \times 10^{5}$ bits/second.
$1.4011 \mathrm{~V} / \mathrm{V}$ or $20.8 \mathrm{~dB} ; 22 \mathrm{~A} / \mathrm{A}$ or $26.8 \mathrm{~dB} ; 242 \mathrm{~W} / \mathrm{W}$ or $23.8 \mathrm{~dB} ; 120 \mathrm{~mW}, 95.8 \mathrm{~mW}$, $20.2 \%$
1.43 (a) $82.6 \mathrm{~V} / \mathrm{V}$ or 38.3 dB
$1.460 .69 \mathrm{~V} ; 0.69 \mathrm{~V} / \mathrm{V}$ or $-3.2 \mathrm{~dB} ; 8280 \mathrm{~A} / \mathrm{A}$ or $78.4 \mathrm{~dB} ; 5713 \mathrm{~W} / \mathrm{W}$ or 37.6 dB .
1.48 S-A-B-L is preferred as it provides higher voltage gain.
1.51 (a) $400 \mathrm{~V} / \mathrm{V}$; (b) $40 \mathrm{k} \Omega, 2 \times 10^{4} \mathrm{~A} / \mathrm{A}, 8 \times 10^{6} \mathrm{~W} / \mathrm{W}$; (c) $500 \Omega$; (d) $750 \mathrm{~V} / \mathrm{V}$; (e) $100 \mathrm{k} \Omega$, $100 \Omega, 484 \mathrm{~V} / \mathrm{V}$
$1.5638 .1 \mathrm{~V} / \mathrm{V}$
1.59 Voltage amplifier, $R_{i}=1 \times 10^{5} \Omega, R_{o}=1 \times 10^{2} \Omega, A_{v o}=121 \mathrm{~V} / \mathrm{V}$
$1.641025 \mathrm{~V} / \mathrm{V}$ or $60.2 \mathrm{~dB}, 2500 \mathrm{~A} / \mathrm{A}$ or $68 \mathrm{~dB}, 2.63 \times 10^{6} \mathrm{~W} / \mathrm{W}$ or 64.2 dB
1.684 MHz
1.7064 nF
$1.730 .51 / C R$
$1.750 .8 \mathrm{k} \Omega, 8.65 \mathrm{k} \Omega$, connect 2 nF to node B .
$1.78159 \mathrm{kHz} ; 14.5 \mathrm{~Hz} ; \simeq 159 \mathrm{kHz}$
$1.8110 \mathrm{~Hz}, 10 \mathrm{kHz}, 0.04 \mathrm{~dB}, 0.04 \mathrm{~dB}, 10 \mathrm{~Hz}, 10 \mathrm{kHz}$

# CHAPTER 2 

2.24004 V/V
$2.540,000 \mathrm{~V} / \mathrm{V}$
$2.70 .1 \%$
2.8 In all cases, $-5 \mathrm{~V} / \mathrm{V}, 20 \mathrm{k} \Omega$
2.11 (a) $-1 \mathrm{~V} / \mathrm{V}$; (c) $-0.1 \mathrm{~V} / \mathrm{V}$; (e) $-10 \mathrm{~V} / \mathrm{V}$
$2.1310 \mathrm{k} \Omega, 100 \mathrm{k} \Omega$
2.15 Average $=+5 \mathrm{~V}$, highest $=+10 \mathrm{~V}$, lowest $=0 \mathrm{~V}$
$2.17 \pm 2 x \% ;-98$ to $-102 \mathrm{~V} / \mathrm{V}$
$2.191 .8 \mathrm{k} \Omega ; 18 \mathrm{k} \Omega$
$2.21 \pm 2 \mathrm{mV}$
$2.241000\left(1+\frac{R_{2}}{R_{1}}\right), 100\left(1+\frac{R_{2}}{R_{1}}\right), 10\left(1+\frac{R_{2}}{R_{1}}\right) ; 1000 R_{1}, 100 R_{1}, 10 R_{1}$
2.26 (b) $1 \mathrm{k} \Omega, 100 \mathrm{k} \Omega, 909 \mathrm{~V} / \mathrm{V}$
2.28 (a) $10.2 \mathrm{k} \Omega$
2.32 (a) $0.1 \mathrm{~mA}, 0.1 \mathrm{~mA}, 10 \mathrm{~mA}, 10.1 \mathrm{~mA},-1 \mathrm{~V}$; (b) $1.19 \mathrm{k} \Omega$; (c) -11.1 V to -2.01 V
2.34 (a) $1 \mathrm{k} \Omega$; (b) $0, \infty$; (c) -0.57 mA to +0.57 mA (d) 2.2 mA
$2.36 v_{O}=-\left(10 v_{1}+5 v_{2}\right) ;-5 \mathrm{~V}$
$2.4312 .8 \mathrm{k} \Omega$
2.44 (a) $\infty$; 0 ; (b) $10 \mathrm{k} \Omega, 10 \mathrm{k} \Omega$; (d) $10 \mathrm{k} \Omega, 990 \mathrm{k} \Omega$
$2.46100 \mathrm{k} \Omega$; no
$2.502 \sin (2 \pi \times 1000 t)$
$2.511 / x ; 1$ to $\infty$; add $1-\mathrm{k} \Omega$ resistor between the left end of the pot and ground.
2.53 (a) $10 \mathrm{mV}, 10 \mu \mathrm{~A}, 10 \mu \mathrm{~A}$; (b) $10 \mathrm{~V}, 10 \mathrm{~mA}, 0$; from the power supply of the op amp
2.58 (a) $-0.83 \mathrm{~V} / \mathrm{V}, 17 \%$; (c) $-0.98 \mathrm{~V} / \mathrm{V}, 2 \%$; (e) $-9 \mathrm{~V} / \mathrm{V}, 10 \%$
$2.6020 \mathrm{~V} / \mathrm{V}, 10 \mathrm{k} \Omega, 0.0095 \mathrm{~V} / \mathrm{V}, 66.4 \mathrm{~dB}$
$2.64 R_{1}=R_{3}, R_{2}=R_{4}$
$2.650 .02 x \mathrm{~V} / \mathrm{V} ; 0.002 \mathrm{~V} / \mathrm{V}, 54 \mathrm{~dB} ; 0.02 \mathrm{~V} / \mathrm{V}, 34 \mathrm{~dB} ; 0.1 \mathrm{~V} / \mathrm{V}, 20 \mathrm{~dB}$
$2.671 \mathrm{k} \Omega, 1 \mathrm{M} \Omega, 1 \mathrm{k} \Omega, 1 \mathrm{M} \Omega ; 1 \%$ tolerances
$2.69 R=1 \mathrm{M} \Omega, R_{5}=756 \Omega, R_{6}=6.8 \mathrm{k} \Omega$
2.73 (a) -0.12 V to +0.12 V ; (b) -12 V to +12 V
2.75 Ideal: $21 \mathrm{~V} / \mathrm{V}, 0, \infty ; \pm 1 \%$ resistors: $A_{d}=21 \pm 4 \%, \mid A_{c m} \mid=0.02, \mathrm{CMRR}=60.4 \mathrm{~dB}$
2.77 (a) $v_{B} / v_{A}=3 \mathrm{~V} / \mathrm{V}, v_{C} / v_{A}=-3 \mathrm{~V} / \mathrm{V}$; (b) $6 \mathrm{~V} / \mathrm{V}$; (c) $56 \mathrm{~V} \mathrm{pp}, 19.8 \mathrm{~V}$ rms
2.79 (a) 1591 Hz ; (b) leads by $90^{\circ}$; (c) increases by a factor of 10 ; (d) the same as in (b)
$2.811 \mathrm{MHz} ; 0.159 \mu \mathrm{~s}$
$2.83 R=10 \mathrm{k} \Omega, C=159 \mathrm{pF} ; R_{F}=1 \mathrm{M} \Omega, 1 \mathrm{kHz}$; (a) $v_{O}$ decreases linearly to -6.3 V , (b) $v_{O}$ decreases exponentially, $v_{O}(t)=-100\left(1-e^{-t / 159}\right)$, reaching -6.1 V at the end of the pulse.
$2.86 R_{1}=10 \mathrm{k} \Omega, R_{2}=1 \mathrm{M} \Omega, C=0.16 \mathrm{nF} ; 100 \mathrm{kHz}$
$2.8815 .9 \mathrm{kHz}, v_{O}=-5 \sin \left(10^{6} t+90^{\circ}\right) \mathrm{V}$
2.90 Square wave of the same frequency, 8 V peak amplitude, average is $0 \mathrm{~V} ; 30 \mathrm{k} \Omega$
$2.92 R_{1}=1 \mathrm{k} \Omega, R_{2}=100 \mathrm{k} \Omega, C=79 \mathrm{nF} ; 20 \mathrm{~Hz}$
2.944 mV
$2.969 \mathrm{mV} ; 12 \mathrm{mV}$
2.98 (a) $0.53 \mu \mathrm{~A}$, into the input terminals; (b) -3 mV ; (c) -60 nA
$2.100 R_{1}=1.01 \mathrm{k} \Omega, R_{2}=R_{3}=100 \mathrm{k} \Omega, C_{1}=1.58 \mu \mathrm{~F}, C_{2}=0.16 \mu \mathrm{~F}$
$2.1026 \mathrm{~V} ; 3 \mathrm{~V} ; 9 \mathrm{mV}$
2.104 (a) 0.2 V ; (b) 0.4 V ; (c) $10 \mathrm{k} \Omega, 20 \mathrm{mV}$; (d) 0.22 V
2.106 (a) $9.9 \mathrm{k} \Omega$; (b) 0.222 V
$2.10880,000 \mathrm{~V} / \mathrm{V}, 125 \mathrm{~Hz}, 10 \mathrm{MHz}$
$2.11119 .61 \mathrm{kHz}, 49.75 \mathrm{~V} / \mathrm{V}, 4.975 \mathrm{~V} / \mathrm{V}$
2.113 (a) 5.1 MHz ; (c) 10 MHz ; (e) $10.1 \mathrm{MHz} ;(\mathrm{g}) 2 \mathrm{MHz}$
$2.11636 .6 \mathrm{MHz}$
$2.118500 \mathrm{MHz} ; 3 ; 7 \mathrm{MHz} ; 3.6 \mathrm{MHz}$
$2.121100 \mathrm{mV}$
$2.1251 \mathrm{MHz}, 3.18 \mathrm{~V}$
# CHAPTER 3 

$3.1-55^{\circ} \mathrm{C}: 2.68 \times 10^{6} \mathrm{~cm}^{-3}$, one out of every $1.9 \times 10^{16}$ silicon atoms; $+75^{\circ} \mathrm{C}$ : $3.70 \times 10^{11} \mathrm{~cm}^{-3}, N / n_{i}=1.4 \times 10^{11}$
$3.35 \times 10^{18} \mathrm{~cm}^{-3} ; 45 \mathrm{~cm}^{-3} ;$
3.5 At $27^{\circ} \mathrm{C}: n_{n}=10^{17} / \mathrm{cm}^{3}, p_{n}=2.25 \times 10^{3} \mathrm{~cm}^{3}$;

At $125^{\circ} \mathrm{C}: n_{n}=10^{17} / \mathrm{cm}^{3}, p_{n}=2.23 \times 10^{8} \mathrm{~cm}^{3}$
$3.7 v_{p-\text { drift }}=1.44 \times 10^{6} \mathrm{~cm} / \mathrm{s}, v_{n-\text { drift }}=4.05 \times 10^{6} \mathrm{~cm} / \mathrm{s}$
$3.99 .26 \times 10^{17} / \mathrm{cm}^{3}$
$3.12778 \mathrm{mV} ; 0.2 \mu \mathrm{~m}, 0.1 \mu \mathrm{~m}, 0.1 \mu \mathrm{~m} ; 1.6 \times 10^{-14} \mathrm{C}$
3.141 .6 pC
3.1659 .6 mV
$3.207 .85 \times 10^{-17} \mathrm{~A} ; 0.3 \mathrm{~mA}$
$3.223 .6 \times 10^{-16} \mathrm{~A} ; 0.742 \mathrm{~V}$
$3.2431 .6 \mathrm{fF} ; 14.16 \mathrm{fF}$
$3.270 .5 \mathrm{pF} ; 129.5 \mathrm{ps}$

## CHAPTER 4

4.2 (a) $-3 \mathrm{~V}, 0.6 \mathrm{~mA} ;$ (b) $+3 \mathrm{~V}, 0 \mathrm{~mA}$
4.3 (a) $V=2 \mathrm{~V}, I=2.5 \mathrm{~mA}$; (b) $I=1 \mathrm{~mA}, V=1 \mathrm{~V}$
$4.6 X=A B ; Y=A+B ; X$ and $Y$ are the same for $A=B ; X$ and $Y$ are opposite if $A \# B$.
4.9 (a) $I=0, V=1 \mathrm{~V}$; (b) $I=0.25 \mathrm{~mA}, V=0 \mathrm{~V}$
$4.11 R \geq 4.2 \mathrm{k} \Omega, 169.7 \mathrm{~V}$
$4.132 .5 \mathrm{~V} ; 1.25 \mathrm{~V} ; 25 \mathrm{~mA} ; 12.5 \mathrm{~mA} ; 2.5 \mathrm{~V}$
$4.1534 \mathrm{~V} ; 8.3 \Omega ; 0.6 \mathrm{~A} ; 29 \mathrm{~V} ; 34 \mathrm{~V}, 8 \Omega ; 25 \% ; 103 \mathrm{~mA} ; 0.625 \mathrm{~A} ; 29 \mathrm{~V}$
4.17 At $-55^{\circ} \mathrm{C}, V_{T}=18.8 \mathrm{mV} ;$ At $+55^{\circ} \mathrm{C}, V_{T}=28.3 \mathrm{mV} ; V_{T}=25 \mathrm{mV}$ at $17^{\circ} \mathrm{C}$.
$4.190 .335 \mu \mathrm{~A}$
4.21 (a) $6.91 \times 10^{-13} \mathrm{~A}, 0.64 \mathrm{~V}$; (c) $5.11 \times 10^{-17} \mathrm{~A}, 0.59 \mathrm{~V}$
$4.233 .9 \mathrm{~mA} ;-22 \mathrm{mV}$
$4.26 A_{4}=2 A_{3}=4 A_{2}=8 A_{1} ; 1.5 \mathrm{~mA}$
$4.2842 \Omega$
$4.3150^{\circ} \mathrm{C} ; 6 \mathrm{~W} ; 8.33^{\circ} \mathrm{C} / \mathrm{W}$
4.33230 mV ; independent of temperature
$4.350 .6635 \mathrm{~V}, 0.3365 \mathrm{~mA}$
$4.37 R=582 \Omega$
4.41 (a) $-2.3 \mathrm{~V}, 0.53 \mathrm{~mA} ;$ (b) $+3 \mathrm{~V}, 0 \mathrm{~mA}$
4.43 (a) $I=0, V=-1.23 \mathrm{~V}$; (b) $I=0.133 \mathrm{~mA}, V=0 \mathrm{~V}$
$4.45 R \geq 4.23 \mathrm{k} \Omega, 169.7 \mathrm{~V}$; essentially the same.
$4.480 .24 \mathrm{mV}, 2.0 \mathrm{mV}, 9.6 \mathrm{mV} ; 25 \mu \mathrm{~A}$
$4.53 V_{o} / V_{i}=1 /\left(1+j \omega C r_{d}\right) ;-\tan ^{-1}\left(\omega C V_{T} / I\right) ; 157 \mu \mathrm{~A}-84.3^{\circ}$ to $-5.71^{\circ}$
$4.56 R=417 \Omega ; 7.39 \mathrm{~mA} ; 6.8 \mathrm{mV} ;-3.4 \mathrm{mV} ;-6.8 \mathrm{mV} ;-13.6 \mathrm{mV}$
4.59 (a) $r_{z}=8 \Omega, 1.04 \mathrm{~W}$; (b) $V_{Z 0}=8.8 \mathrm{~V}, 188 \mathrm{~mW}$
$4.6188 .9 \mathrm{mV}$
$4.63167 \Omega ; 7.65 \mathrm{~V} ; 7.35 \mathrm{~V} ; 7.78 \mathrm{~V} ; 707 \Omega ; 7.2 \mathrm{~V}$
4.66 (a) 9.825 V ; (b) $207 \Omega$; (c) $33 \mathrm{mV} / \mathrm{V}, \pm 1.65 \%$; (d) $-6.77 \mathrm{~V} / \mathrm{A},-1.35 \%$; (e) 70.9 mA , 732 mW
$4.69 \quad 0.324 \mathrm{~V}$
$4.7113 .44 \mathrm{~V} ; 48.4 \% ; 8.3 \mathrm{~V} ; 8.3 \mathrm{~mA}$
4.73 (a) $10.1: 1$; (b) $1.072: 1$
4.7545 V
4.77 (a) $12.77 \mathrm{~V}, 13.37 \mathrm{~V}$; (b) $7.1 \%, 2.24 \%$; (c) $192 \mathrm{~mA}, 607 \mathrm{~mA}$; (d) $371 \mathrm{~mA} ; 1.2 \mathrm{~A}$
4.80 (a) 9.7 V ; (b) $542 \mu \mathrm{~F}$; (c) $25.7 \mathrm{~V}, 38.5 \mathrm{~V}$; (d) 739 mA ; (e) 1.42 A
$4.8310 .74 \mathrm{~V} ; 23.5 \mu \mathrm{~s} ; 4.913 \mathrm{~A} ; 4.913 \mathrm{~A}$
4.85 (a) $+1 \mathrm{~V},+2 \mathrm{~V},+2.7 \mathrm{~V}$; (b) $+3 \mathrm{~V},+6 \mathrm{~V},+6.7 \mathrm{~V}$; (c) $0 \mathrm{~V}, 0 \mathrm{~V}, 0 \mathrm{~V},-13 \mathrm{~V}$; (d) 0 V , $0 \mathrm{~V},-13 \mathrm{~V}$
$4.96-7.07 \mathrm{~V}$

# CHAPTER 5 

5.1580 to $2900 \mu \mathrm{~m}^{2} ; 24$ to $54 \mu \mathrm{~m}$
5.4 (a) 0.5 ; (b) 0.5 ; (c) 1.0 ; (d) 0.5
$5.70 .35 \mu \mathrm{~m}$
$5.9 \quad 0.5 \mathrm{~V} ; 0.5 \mathrm{~mA}$
5.11 (a) -1.1 V ; (b) -0.4 V ; (c) $0.05 \mathrm{~mA} ; 0.5 \mathrm{~mA}$
$5.13116 .3 \Omega, 116.3 \mathrm{mV} ; 50$
$5.172 .8 \mathrm{~V} ; 500 \Omega, 100 \Omega$$5.195 \mathrm{~mA} / \mathrm{V}^{2} ; 0.6 \mathrm{~V}$
$5.210 .5 \mathrm{~V} ; 20 ; 145 \mu \mathrm{~A} ; 1.5 \mathrm{~V}, 1.125 \mathrm{~mA}$
$5.232 .5 \mathrm{k} \Omega$ to $125 \Omega$; (a) $5 \mathrm{k} \Omega$ to $250 \Omega$; (b) $1.25 \mathrm{k} \Omega$ to $62.5 \Omega$; (c) $2.5 \mathrm{k} \Omega$ to $125 \Omega$.
5.29 (a) $3 \%$; (b) $5 \%$
$5.31200 \mathrm{k} \Omega, 20 \mathrm{k} \Omega ; 5 \%, 5 \%$
$5.33104 \mu \mathrm{~A} ; 4 \%$; double $L$ to $3 \mu \mathrm{~m}$
5.35 Increases by a factor of 16 .
$5.38350 \mu \mathrm{~A} ; 750 \mu \mathrm{~A} ; 864 \mu \mathrm{~A} ; 880 \mu \mathrm{~A} ; 960 \mu \mathrm{~A}$
5.41 At 3.0 V , transistor is cut off; at 2.5 V , transistor enters saturation region; at 0.5 V , transistor enters triode region.
$5.431 \mathrm{~V}, 0 \mathrm{~V}, 1 \mathrm{~V}, 0.25 \mathrm{~V} ; 5 \mathrm{k} \Omega, 5 \mathrm{k} \Omega, 5 \mathrm{k} \Omega, 5 \mathrm{k} \Omega ; 10 \mathrm{k} \Omega, 2 \mathrm{~V} ; 10 \mathrm{k} \Omega,-1 \mathrm{~V} ; 10 \mathrm{k} \Omega$, $2 \mathrm{~V} ; 10 \mathrm{k} \Omega,-0.75 \mathrm{~V}$
$5.450 .08 \mathrm{~mA} ; 10 \mathrm{k} \Omega, 5 \mathrm{k} \Omega ; 17.5 \mathrm{k} \Omega$
$5.484 \mathrm{k} \Omega$
$5.504 \mu \mathrm{~m}, 11.1 \mu \mathrm{~m} ; 1.4 \mathrm{k} \Omega$
$5.520 .45 \mathrm{~mA},+7.3 \mathrm{~V}$; quite tolerant.
$5.5444 .4 ; 1.25 \mathrm{k} \Omega$
$5.56-1 \mathrm{~V},-1.43 \mathrm{~V},-2.8 \mathrm{~V}, 1 \mathrm{~V}, 2.8 \mathrm{~V},+1 \mathrm{~V}, 2.8 \mathrm{~V},-1 \mathrm{~V}$
$5.59 I_{1}=405 \mu \mathrm{~A}, V_{2}=1.5 \mathrm{~V} ; I_{3}=217 \mu \mathrm{~A}, V_{4}=1.232 \mathrm{~V} ; V_{5}=1.5 \mathrm{~V}, I_{6}=405 \mu \mathrm{~A}$
5.61 (a) $0.5 \mathrm{~V}, 0.5 \mathrm{~V},-0.983 \mathrm{~V}$; (b) $0.1 \mathrm{~V}, 0.9 \mathrm{~V},-1.01 \mathrm{~V}$
$5.63-1.24 \mathrm{~V}$
5.65 triode, 0.59 mA ; triode, 5 mA ; saturation, 9 mA ; saturation, 9 mA

# CHAPTER 6 

$6.24 .7 \times 10^{-17} \mathrm{~A}, 1.87 \times 10^{-16} \mathrm{~A} ; A_{2} / A_{1}=4$
6.40 .31 V
6.6 Old: 0.673 V ; New: 0.846 V
$6.880 ; 0.988$
$6.100 .5 ; 0.67 ; 0.91 ; 0.95 ; 0.98 ; 0.99 ; 0.995 ; 0.998 ; 0.999$
$6.12 I_{C}=0.5 \mathrm{~mA} \rightarrow 3 \mathrm{~mA} ; I_{E}=0.51 \mathrm{~mA} \rightarrow 3.01 \mathrm{~mA} ; 30 \mathrm{~mW}$
$6.14990 \mu \mathrm{~A}, 99,0.99 ; 980 \mu \mathrm{~A}, 49,0.98 ; 950 \mu \mathrm{~A}, 19,0.95$
$6.17-0.668 \mathrm{~V} ; 1.04 \mathrm{~V} ; 0.02 \mathrm{~mA}$
6.19 EBJ: 0.691 V ; CBJ: 0.576 V ; EBJ: $0.49 \mu \mathrm{~A}$; CBJ: $48.5 \mu \mathrm{~A}$
$6.230 .758 \mathrm{~V} ; 0.815 \mathrm{~V}$
$6.25238 \mathrm{~mA} ; 6 \times 10^{-14} \mathrm{~A} ; 87$
6.28 (a) $2 \mathrm{~mA},-0.7 \mathrm{~V}$; (b) -2 V ; (c) $2 \mathrm{~V}, 0.5 \mathrm{~mA}$; (d) $1.6 \mathrm{~mA},-4.5 \mathrm{~V}$
$6.308 .3 \mathrm{k} \Omega ; 20 ; 100 ; 200$
$6.32 R_{C}=4 \mathrm{k} \Omega ; R_{E}=3.64 \mathrm{k} \Omega ; R_{C \max }=5.86 \mathrm{k} \Omega$
$6.34 R_{E}=3.66 \mathrm{k} \Omega ; R_{C}=5 \mathrm{k} \Omega$
$6.3610 .24 \mu \mathrm{~A}$
$6.380 .75 \mathrm{~V} ; 0.55 \mathrm{~V}$
$6.403 .35 \mu \mathrm{~A} ; 3000$
$6.43125 \mathrm{k} \Omega ; 125 \mathrm{~V} ; 12.5 \mathrm{k} \Omega$
$6.451 \mathrm{~mA} ; 10 \mathrm{~V} ; 50 \mathrm{~V} ; 50 \mathrm{k} \Omega$
$6.47 \beta=100 ; \beta_{a c}=80 ; \Delta i_{C}=0.18 \mathrm{~mA}, i_{C}=1.18 \mathrm{~mA}$
$6.50 \beta_{\text {forced }}=11.2 ; V_{C}=4.8 \mathrm{~V} ; R_{B}=45.7 \mathrm{k} \Omega$
$6.522 .05 \mathrm{~V}, 2.38 \mathrm{~V}$
$6.55 R_{1}=18 \mathrm{k} \Omega, R_{2}=12 \mathrm{k} \Omega ; 0.46 \mathrm{~mA}, 2.54 \mathrm{~V}$
$6.58+0.41 \mathrm{~V},+1.11 \mathrm{~V},-1.15 \mathrm{~V} ;+1.2 \mathrm{~V},+1.9 \mathrm{~V},-1.9 \mathrm{~V} ; 204$
6.61 (a) $-0.7 \mathrm{~V},+1.2 \mathrm{~V}$; (b) $+1.2 \mathrm{~V}, 0.5 \mathrm{~mA}$; (c) $-0.7 \mathrm{~V}, 0 \mathrm{~V},+1.2 \mathrm{~V}$; (d) +1.45 V , $-0.5 \mathrm{~V}$; (e) $+0.75 \mathrm{~V},+1.45 \mathrm{~V},-0.5 \mathrm{~V}$
$6.63 R_{E}=4 \mathrm{k} \Omega, R_{B}=50 \mathrm{k} \Omega, R_{C}=4 \mathrm{k} \Omega, I_{C}=0.85 \mathrm{~mA}$ to $0.98 \mathrm{~mA}, V_{C}=-1.6 \mathrm{~V}$ to $-1.1 \mathrm{~V}$
6.66 (a) $0 \mathrm{~V},+0.7 \mathrm{~V},-0.725 \mathrm{~V},-1.425 \mathrm{~V},+1.1 \mathrm{~V}$; (b) $+0.23 \mathrm{~V}+0.93 \mathrm{~V},-1 \mathrm{~V}$, $-1.7 \mathrm{~V},+1.47 \mathrm{~V}$
$6.680 \mathrm{~V}, 0 \mathrm{~V} ;+1.8 \mathrm{~V},+1.1 \mathrm{~V} ;-2.2 \mathrm{~V},-1.5 \mathrm{~V} ;-3 \mathrm{~V},-2.3 \mathrm{~V}$

# CHAPTER 7 

7.2 A: $(0.5 \mathrm{~V}, 5 \mathrm{~V}) ; \mathrm{B}:(0.72 \mathrm{~V}, 0.22 \mathrm{~V})$
$7.320 \mathrm{k} \Omega ;(0.72 \mathrm{~V}, 0.22 \mathrm{~V}) ;-40 \mathrm{~V} / \mathrm{V} ; 0.78 \mathrm{~V} ; 19.5 \mathrm{mV}$
$7.60 .4 \mathrm{~V} ; 8.33$
7.8 (a) 0.712 V ; (b) $-42.7 \mathrm{~V} / \mathrm{V}, 11.7 \mathrm{mV}$; (c) $42.88 \mathrm{k} \Omega ; 24.9$
$7.10-160 \mathrm{~V} / \mathrm{V} ; 0.7 \mathrm{~V} ; 4.4 \mathrm{mV}$
$7.121 .08 \mathrm{~V} ; 0.78 \mathrm{~V} ;-156.7 \mathrm{~V} / \mathrm{V}$
$7.15-60 \mathrm{~V} / \mathrm{V}$
$7.183 \mathrm{~mA} ;-120 \mathrm{~V} / \mathrm{V} ;+5 \mathrm{mV}: \exp . \rightarrow-660 \mathrm{mV}$, linear $\rightarrow-600 \mathrm{mV}$;
$-5 \mathrm{mV}: \exp . \rightarrow+540 \mathrm{mV}$, linear $\rightarrow+600 \mathrm{mV}$.
7.25 (a) $0.1 \mathrm{~mA}, 0.8 \mathrm{~V}$; (b) $1 \mathrm{~mA} / \mathrm{V}$; (c) -10 V/V; (d) $100 \mathrm{k} \Omega,-9.1 \mathrm{~V} / \mathrm{V}$
$7.260 .5 \mathrm{~mA} / \mathrm{V} ; 0.067 \mathrm{~mA}, 0.27 \mathrm{~V} ; 9.14 ; 0.67 \mathrm{~V}$
$7.2916 \mu \mathrm{~m} ; 0.75 \mathrm{~V}$
$7.31-18.2 \mathrm{~V} / \mathrm{V} ; 1.207 \mathrm{~V},-23.6 \mathrm{~V} / \mathrm{V}$
7.33 (b) $2 \mathrm{~mA} / \mathrm{V}, 200 \mathrm{k} \Omega$; (d) $3.33 \mathrm{M} \Omega, 0.94 \mathrm{~V} / \mathrm{V},-15.38 \mathrm{~V} / \mathrm{V},-14.5 \mathrm{~V} / \mathrm{V}$
$7.352 .5 \mathrm{~V} ; 0.611 \mathrm{~mA}, 1.95 \mathrm{~V} ; 5 \mathrm{mV} ;-0.55 \mathrm{~V} ;-110 \mathrm{~V} / \mathrm{V} ;-100 \mathrm{~V} / \mathrm{V}$
$7.3740 \mathrm{~mA} / \mathrm{V} ; 25 \Omega ; 2.5 \mathrm{k} \Omega ; 1 \mathrm{~V}$
$7.391 .04 \mathrm{k} \Omega$ to $4.7 \mathrm{k} \Omega$
7.42 (a) $1.000, \infty, 1.00 \mathrm{~mA}, 1.00 \mathrm{~mA}, 0 \mathrm{~mA}, 40 \mathrm{~mA} / \mathrm{V}, 25 \Omega, \infty \Omega$; (c) $0.980,50,1.00 \mathrm{~mA}$, $1.02 \mathrm{~mA}, 0.02 \mathrm{~mA}, 40 \mathrm{~mA} / \mathrm{V}, 24.5 \Omega, 1.25 \mathrm{k} \Omega$; (e) $0.990,100,0.248 \mathrm{~mA}, 0.25 \mathrm{~mA}$, $0.002 \mathrm{~mA}, 9.92 \mathrm{~mA} / \mathrm{V}, 100 \Omega, 10.1 \mathrm{k} \Omega$
$7.481 \mathrm{~V} ; 125 \Omega ; 80 \mathrm{~V} / \mathrm{V}$
$7.53 R_{\text {in }}=75 \Omega ; v_{o} / v_{\text {sig }}=39.6 \mathrm{~V} / \mathrm{V}$
$7.55-1000 \mathrm{~V} / \mathrm{V} ;-5000 \mathrm{~V} / \mathrm{V}$
$7.578 .6 \mathrm{k} \Omega, 7.7 \mathrm{k} \Omega ; 77 \mathrm{~V} / \mathrm{V}$
$7.5979 .4 \mathrm{~V} / \mathrm{V} ; 4762 \mathrm{~A} / \mathrm{A}$
$7.64-10 \mathrm{~V} / \mathrm{V}$
$7.661 \mathrm{~mA} / \mathrm{V} ; 125 \mu \mathrm{~A} ;-7.5 \mathrm{~V} / \mathrm{V}$
$7.685 \mathrm{k} \Omega, 10 \mathrm{k} \Omega,-200 \mathrm{~V} / \mathrm{V} ;-100 \mathrm{~V} / \mathrm{V},-33.3 \mathrm{~V} / \mathrm{V} ; 15 \mathrm{mV}, 0.5 \mathrm{~V}$
7.70 (b) $1250 \mathrm{~V} / \mathrm{V}$
$7.720 .5 \mathrm{k} \Omega$
$7.7430 .3 \mathrm{k} \Omega,-40 \mathrm{~V} / \mathrm{V}, 12 \mathrm{k} \Omega ;-20 \mathrm{~V} / \mathrm{V},-15 \mathrm{~V} / \mathrm{V} ; 6.65 \mathrm{mV}, 100 \mathrm{mV}$
$7.7680 \mathrm{~V} / \mathrm{V}, 44.4 \mathrm{~V} / \mathrm{V}$ to $109.1 \mathrm{~V} / \mathrm{V} ; R_{e}=275 \Omega, 25 \mathrm{~V} / \mathrm{V}, 20 \mathrm{~V} / \mathrm{V}$ to $27.3 \mathrm{~V} / \mathrm{V}$
$7.782 .5 \mathrm{~mA} / \mathrm{V} ; 0.2 \mathrm{~V}$
$7.80 i_{\text {sig }} R_{C}$
$7.820 .357 \mathrm{k} \Omega ; 1.6 \mathrm{~mA} ; 1.13 \mathrm{~V}$
$7.841 .25 \mathrm{~mA} ; 1.5 \mathrm{~mA}, 1.0 \mathrm{~mA} ; 0.5 \mathrm{~V} / \mathrm{V} ; 1 \mathrm{~V}$
$7.86149 \Omega, 0.87 \mathrm{~V} / \mathrm{V} ; 116 \Omega$ to $246 \Omega ; 0.80 \mathrm{~V} / \mathrm{V}$ to $0.90 \mathrm{~V} / \mathrm{V}$
$7.89-91 \mathrm{~V} / \mathrm{V}$
$7.9127 .5 \mathrm{~V} / \mathrm{V}, 41.2 \mathrm{~V} / \mathrm{V}, 55.6 \mathrm{~V} / \mathrm{V}, 57.1 \mathrm{~V} / \mathrm{V}, 55.6 \mathrm{~V} / \mathrm{V} ; 0.325 \mathrm{~mA}$
$7.9218 \mathrm{M} \Omega, 22 \mathrm{M} \Omega, 3 \mathrm{k} \Omega, 3 \mathrm{k} \Omega ; 2 \mathrm{~V}$
$7.945 .07 \mathrm{~V}, 1.27 \mathrm{~mA}$ to $2.48 \mathrm{~mA} ; 620 \Omega ; 0.91 \mathrm{~mA}$ to 1.5 mA
$7.962 \mathrm{~V} ; 2.4 \mathrm{~V} ; 1.2 \mathrm{~mA}$
7.101 (a) $2.7 \mathrm{~V}, 2.2 \mathrm{~V}$; (b) $3.05 \mathrm{~V}, 3.05 \mathrm{~V}$
$7.1032 .5 \mathrm{k} \Omega, 22 \mathrm{M} \Omega, 20 \mathrm{M} \Omega$
7.105 (a) $230 \mathrm{k} \Omega ; 0.5 \mathrm{~mA}$ to $1.5 \mathrm{~mA} ; 1 \mathrm{~V}$ to 0 V (saturated transistor), design very intolerant of $\beta$ variation.
7.108 (a) 5.73 ; (b) $V_{B B}=V_{B E}+0.352 V_{C C}$; (c) $38.8 \mathrm{k} \Omega, 37.5 \mathrm{k} \Omega, 3.33 \mathrm{k} \Omega$; (d) $8.1 \mathrm{k} \Omega$; 0.475 mA to 0.509 mA with a nominal value of 0.5 mA
$7.1105 .75 \mathrm{k} \Omega, 6.2 \mathrm{k} \Omega ; 10.8 \%$
7.112 (a) $R_{C}=1.5 \mathrm{k} \Omega, R_{B}=80 \mathrm{k} \Omega$; (b) $R_{C}=1.5 \mathrm{k} \Omega, R_{B}=82 \mathrm{k} \Omega ; 1.52 \mathrm{~V}, 0.98 \mathrm{~mA}$; (c) $0.7 \mathrm{~V}, 1.53 \mathrm{~mA}$; (d) $R_{B 1}=40 \mathrm{k} \Omega, R_{B 2}=70 \mathrm{k} \Omega, R_{C}=1.47 \mathrm{k} \Omega, 1.1 \mathrm{~V}, 1.28 \mathrm{~mA}$
$7.1168 .6 \mathrm{k} \Omega,+0.4 \mathrm{~V}$
7.118 (a) $V_{D}=2.5 \mathrm{~V}, k_{n}=11.1 \mathrm{~mA} / \mathrm{V}^{2}$; (b) $120 \mathrm{k} \Omega,-4.1 \mathrm{~V} / \mathrm{V}$; (c) $0.264 \mathrm{~V}, 1.08 \mathrm{~V}$; (d) $300 \Omega, 1.08 \mathrm{~V}$
$7.12020 \mathrm{~mA} / \mathrm{V} ; 0.1 \mathrm{~mA} ; 5 \mathrm{mV} ; 10 \mathrm{k} \Omega$
7.122 (a) $0.99 \mathrm{~V} / \mathrm{V}, 99 \Omega$; (b) $99 \Omega, 14.3 \mathrm{~V} / \mathrm{V}$; (c) $7.15 \mathrm{~V} / \mathrm{V}$
7.124 (a) $1.6 \mathrm{~V}, 0.1 \mathrm{~mA}, 82.4 \mathrm{k} \Omega$; (b) $1 \mathrm{~mA} / \mathrm{V}$; (d) $1.95 \mathrm{~V} / \mathrm{V}, 39.1 \mathrm{k} \Omega$
$7.126 R_{1}=47 \mathrm{k} \Omega, R_{2}=24 \mathrm{k} \Omega, R_{E}=2.2 \mathrm{k} \Omega, R_{C}$ either $4.7 \mathrm{k} \Omega$ or $5.1 \mathrm{k} \Omega$
$7.128 R_{B}=91 \mathrm{k} \Omega, R_{C}=22 \mathrm{k} \Omega, I=0.2 \mathrm{~mA} ;-176 \mathrm{~V} / \mathrm{V} ;-29.7 \mathrm{~V} / \mathrm{V}$
7.130 (a) $1 \mathrm{~mA}, 8.2 \mathrm{~V}$; (c) $2.32 \mathrm{k} \Omega, 0.32 \mathrm{~V} / \mathrm{V}$; (d) $2.32 \mathrm{k} \Omega,-69.2 \mathrm{~V} / \mathrm{V}$; (e) $-61.8 \mathrm{~V} / \mathrm{V}$; (f) $1368.5 \mathrm{~V} / \mathrm{V}$
7.132 (a) $0.495 \mathrm{~mA}, 1.18 \mathrm{~V} ;-71.9 \mathrm{~V} / \mathrm{V}$
$7.134 \beta=50$ : (a) $0.78 \mathrm{~mA}, 0.78 \mathrm{~V}, 1.48 \mathrm{~V}$; (b) $21.3 \mathrm{k} \Omega$; (c) $0.64 \mathrm{~V} / \mathrm{V} ; \beta=200$ : (a) 1.54 mA , $1.54 \mathrm{~V}, 2.24 \mathrm{~V}$; (b) $50.9 \mathrm{k} \Omega$; (c) $0.81 \mathrm{~V} / \mathrm{V}$
7.136 (a) $1.73 \mathrm{~mA}, 68.4 \mathrm{~mA} / \mathrm{V}, 14.5 \Omega, 1.4645 \mathrm{k} \Omega$; (b) $148.3 \mathrm{k} \Omega, 0.93 \mathrm{~V} / \mathrm{V}$; (c) $18.21 \mathrm{k} \Omega$, $0.64 \mathrm{~V} / \mathrm{V}$
$7.13875 \Omega ; 25 \mathrm{~Hz} ; 25 \mathrm{~V} / \mathrm{V}$

# CHAPTER 8 

$8.112 \mathrm{k} \Omega ; 0.2 \mathrm{~V} ; 25 \mathrm{k} \Omega ; 20 \mu \mathrm{~A}$
$8.350 ; 8.75 \mathrm{k} \Omega$
$8.65 \mu \mathrm{~m}, 25 \mu \mathrm{~m}, 10 \mu \mathrm{~m}, 2.5 \mu \mathrm{~m}, 5 \mu \mathrm{~m} ; 15 \mathrm{k} \Omega ; 25 \mathrm{k} \Omega, 31.25 \mathrm{k} \Omega$
8.8 (a) 0.691 V to $0.863 \mathrm{~V}, 10 \mu \mathrm{~A}$ to 10 mA ; (b) $9.62 \mu \mathrm{~A}, 0.098 \mathrm{~mA}, 0.98 \mathrm{~mA}, 9.62 \mathrm{~mA}$
$8.110 .1 \mathrm{~mA}, 10 \%$
8.14 Both cases: $-0.7 \mathrm{~V},+2 \mathrm{~V},+0.7 \mathrm{~V},-0.7 \mathrm{~V},-1.7 \mathrm{~V}$; (a) $I=0.4 \mathrm{~mA}$;
(b) $I=0.04 \mathrm{~mA}$
$8.17700 \Omega, 5 \mathrm{~A} / \mathrm{A}, 10 \mathrm{k} \Omega$.
$8.19 v_{o}=g_{m 1} v_{i}\left(W_{3} / W_{2}\right) R_{L} ; g_{m 1} R_{L}\left(W_{3} / W_{2}\right) ; 1 / g_{m 2} ;-g_{m 1} / g_{m 2}$
8.21 (a) $1.6 \mathrm{k} \Omega$; (b) $250 \Omega$
$8.25 I=10 \mu \mathrm{~A}: 0.4 \mathrm{~mA} / \mathrm{V}, 250 \mathrm{k} \Omega, 1 \mathrm{M} \Omega, 400 \mathrm{~V} / \mathrm{V} ; I=100 \mu \mathrm{~A}: 4 \mathrm{~mA} / \mathrm{V}, 25 \mathrm{k} \Omega, 100 \mathrm{k} \Omega$, $400 \mathrm{~V} / \mathrm{V} ; I=1 \mathrm{~mA}: 40 \mathrm{~mA} / \mathrm{V}, 2.5 \mathrm{k} \Omega, 10 \mathrm{k} \Omega, 400 \mathrm{~V} / \mathrm{V}$
$8.2750 \mathrm{~V} / \mathrm{V} ; 0.2 \mathrm{~mA} ; 12.5 \mu \mathrm{~m}$
$8.290 .4 \mu \mathrm{~m} ; 25 ; 0.2 \mathrm{~mA}$
$8.310 .5 \mathrm{~mA} ; 4 \mathrm{~mA} / \mathrm{V}$
$8.331 \mathrm{~mA} / \mathrm{V} ; 15 \mathrm{k} \Omega ; 15 \mathrm{~V} / \mathrm{V} ; 3.9 \mu \mathrm{~m}$
$8.35 \quad 0.144 \mathrm{~mA}$
8.37 (a) $80 \mu \mathrm{~A} / \mathrm{V}, 0.18 \mathrm{M} \Omega, 14.4 \mathrm{~V} / \mathrm{V}$; (b) $0.79 \mathrm{~V}, 0.253 \mathrm{~mA} / \mathrm{V}, 18 \mathrm{k} \Omega, 4.55 \mathrm{~V} / \mathrm{V}$;
(c) $0.8 \mathrm{~mA} / \mathrm{V}, 18 \mathrm{k} \Omega, 14.4 \mathrm{~V}$; (d) $0.08 \mathrm{~V}, 0.253 \mathrm{~mA} / \mathrm{V}, 180 \mathrm{k} \Omega, 45.5 \mathrm{~V} / \mathrm{V}$;
(e) lowest $A_{0}$ : first design when operated at $I_{D}=100 \mu \mathrm{~A}, A_{0}=4.55 \mathrm{~V} / \mathrm{V}$, highest $A_{0}$ : second design when operated at $I_{D}=10 \mu \mathrm{~A}, A_{0}=45.5 \mathrm{~V} / \mathrm{V}$; gain increases by a factor 10 .
$8.390 .5 \mu \mathrm{~m} ; 12.5$
$8.411 .05 \mathrm{~V} ; 2 \mu \mathrm{~m} ; 8 ; 32$
8.43 (a) $0.95 \mathrm{~V}, 0.475 \mu \mathrm{~A}, 2.375 \mathrm{~V}$; (b) $-86.5 \mathrm{~V} / \mathrm{V}, 1.9 \mathrm{~V}, 22 \mathrm{mV}$; (c) $33.7 \mathrm{k} \Omega$
$8.450 .913 \mathrm{~V} ; 1.07 \mathrm{~V}$
8.47 (a) $25 \mu \mathrm{~A}$; (b) 0.33 V and 2.98 V ; (c) -189.3 V/V; (d)-195.8 V/V; (e) -210.6 V/V
8.49 (a) $0.25 \mathrm{~mA}$; (b) $120 \mathrm{k} \Omega, 120 \mathrm{k} \Omega, 60 \mathrm{k} \Omega$; (c) $5 \mathrm{k} \Omega, 10 \mathrm{~mA} / \mathrm{V}$; (d) $5 \mathrm{k} \Omega,-600 \mathrm{~V} / \mathrm{V}$, $60 \mathrm{k} \Omega$
$8.51980 \Omega ; 61 \mathrm{k} \Omega ; 10.1 \mathrm{~V} / \mathrm{V}$
$8.532 \mathrm{k} \Omega ; 1.1 \mathrm{~V}$
8.55 (a) $100 \mu \mathrm{~A}, 1.03 \mathrm{~V}$; (b) $0.9 \mathrm{~mA} / \mathrm{V}, 200 \mathrm{k} \Omega$; (c) $2.2 \mathrm{k} \Omega$; (d) $209 \mathrm{k} \Omega$; (e) $90.9 \mathrm{~V} / \mathrm{V}$, $89 \mathrm{~V} / \mathrm{V}$; (f) 32 mV
$8.57 r_{o}$
8.590 .99 (or more exactly, 0.975 ); $14.8 \mathrm{M} \Omega$
8.61 (a) $208 \Omega$; (b) $500 \Omega$; (c) $4.8 \mathrm{k} \Omega ; 101$ with $R_{c}=\infty$
8.63 (a) $50,1.6 \mathrm{M} \Omega$; (b) $250,320 \mathrm{k} \Omega$
$8.650 .5 \mu \mathrm{~m} ; 20 ; 1 \mathrm{~V} ; 0.25 \mathrm{~mA} ; 0.5 \mathrm{~V}$
$8.670 .6 \mu \mathrm{~m} ; 0.125 \mathrm{~mA} ;(W / L)_{1,2}=10 ;(W / L)_{3,4}=40$
$8.69 \quad g_{m 2} r_{o 2}$
$8.710 .2 \mathrm{~V} ; 0.5 \mathrm{~V}$ to 0.8 V
$8.741 .2 \mathrm{~V} ; 1.0 \mathrm{~V} ; 0.8 \mathrm{~V} ; 100 ; 6.91 \mathrm{M} \Omega$
$8.761 \mathrm{M} \Omega$
$8.79-10^{5} \mathrm{~V} / \mathrm{V}$
8.81 (a) $1.41 \mathrm{~mA} / \mathrm{V}, 822.3 \mathrm{k} \Omega,-1159 \mathrm{~V} / \mathrm{V}$; (b) $1.41 \mathrm{~mA} / \mathrm{V}, 457 \mathrm{k} \Omega,-644 \mathrm{~V} / \mathrm{V}$
$8.83\left(g_{m 3} r_{o 3}\right)\left(g_{m 2} r_{o 2}\right) r_{o 1}$
8.85 (a) $I_{O 1}=I_{O 2}=\frac{1}{2} I_{\mathrm{REF}} /\left(1+2 / \beta^{2}\right)$; (b) Use $I_{\mathrm{REF}}=0.7 \mathrm{~mA}$ and 3 transistors $Q_{3}, Q_{4}$ and $Q_{5}$ whose EBJ areas are in the ratio 1:2:4; currents realized are $0.0999 \mathrm{~mA}, 0.1999 \mathrm{~mA}$ and 0.3997 mA .
8.88 (a) $0.3 \mathrm{~V}, 0.8 \mathrm{~V}$; (b) $8 \mu \mathrm{~A}, 172 \mu \mathrm{~A}$; (c) $180 \mu \mathrm{~A}$; (d) 1.1 V ; (e) $12 \mathrm{M} \Omega$; (f) $0.08 \mu \mathrm{~A}$, $0.04 \%$
8.90 (a) $R_{E}=2.88 \mathrm{k} \Omega$; (b) $8.2 \mathrm{M} \Omega, 0.7 \mu \mathrm{~A}$
8.92 (a) $58.5 \mathrm{k} \Omega$; (b) $79.9 \mathrm{M} \Omega$,
$8.95360 \mu \mathrm{~A} ; 2.4 \mathrm{~mA} / \mathrm{V} ; 0.48 \mathrm{~mA} / \mathrm{V} ; 27.8 \mathrm{k} \Omega ; 0.81 \mathrm{~V} / \mathrm{V} ; 339 \Omega ; 0.7 \mathrm{~V} / \mathrm{V}$
8.97 (b) $g_{m 1}=0.632 \mathrm{~mA} / \mathrm{V}, g_{m 2}=40 \mathrm{~mA} / \mathrm{V}, r_{\pi 2}=5 \mathrm{k} \Omega$; (c) $-19.5 \mathrm{~V} / \mathrm{V}$; (d) $487 \mathrm{k} \Omega$, $-9.6 \mathrm{~V} / \mathrm{V}$; (e) $10 \mathrm{M} \Omega,-18.6 \mathrm{~V} / \mathrm{V}$
$8.9950 .2 \mathrm{~V} / \mathrm{V}$

# CHAPTER 9 

9.1 (a) $0.2 \mathrm{~V}, 0.6 \mathrm{~V}$; (b) $-0.6 \mathrm{~V}, 0.08 \mathrm{~mA}, 0.08 \mathrm{~mA},+0.6 \mathrm{~V},+0.6 \mathrm{~V}$; (c) -0.2 V , $0.08 \mathrm{~mA}, 0.08 \mathrm{~mA},+0.6 \mathrm{~V},+0.6 \mathrm{~V}$; (d) $-0.7 \mathrm{~V}, 0.08 \mathrm{~mA}, 0.08 \mathrm{~mA}$, $+0.6 \mathrm{~V},+0.6 \mathrm{~V}$; (e) 1.0 V ; (f) $-0.8 \mathrm{~V},-0.2 \mathrm{~V}$
9.3 (a) $0 \mathrm{~V},-0.6 \mathrm{~V}, 0.6 \mathrm{~V}, 0.6 \mathrm{~V}, 0 \mathrm{~V}$; (b) $0.104 \mathrm{~V},-0.541 \mathrm{~V}, 0.4 \mathrm{~V}, 0.8 \mathrm{~V}, 0.4 \mathrm{~V}$;
(c) $0.283 \mathrm{~V},-0.4 \mathrm{~V},+0.2 \mathrm{~V}, 1 \mathrm{~V}, 0.8 \mathrm{~V}$; (d) $-0.104 \mathrm{~V},-0.645 \mathrm{~V},+0.8 \mathrm{~V},+0.4 \mathrm{~V}$, $-0.4 \mathrm{~V}$; (e) $-0.283 \mathrm{~V},-0.683 \mathrm{~V},+1 \mathrm{~V},+0.2 \mathrm{~V},-0.8 \mathrm{~V}$
$9.50 .587 \mathrm{~V} ;-0.587 \mathrm{~V} ; 0.612 \mathrm{~V} ; 0.025 \mathrm{~V} ; 0.10 \mathrm{~V}, 4 \mathrm{~V} / \mathrm{V} ;-0.025 \mathrm{~V}$
$9.70 .35 \mathrm{~V} ; 16.3 ; 1.14 \mathrm{~mA} / \mathrm{V}$
$9.90 .212 \mathrm{~V} ; 554.5 \mu \mathrm{~A}$
9.11 (a) $0.1 V_{O V}$; (b) $0,0.338 V_{O V}, 0.05 V_{O V}, 0.005 V_{O V}, 1.072 V_{O V}$
$9.130 .25 \mathrm{~V} ; 0.5 \mathrm{~mA} ; 5 \mathrm{k} \Omega ; 40$
$9.150 .5 \mathrm{~mA} ; 3.6 \mathrm{k} \Omega ; 38.6$
$9.17 I=2 I_{D} ; P_{\text {diff }}=2 P_{\mathrm{CS}}$
9.19 (a) $g_{m 1,2}\left[\frac{1}{g_{m 3,4}}\left\|r_{o 3,4}\right\| r_{o 1,2}\right]$; (b) $\sqrt{\left[\mu_{n}(W / L)_{1,2}\right] /\left[\mu_{p}(W / L)_{3,4}\right]}$; (c) 25
$9.238 \mathrm{k} \Omega ; W / L, I_{D}(\mathrm{~mA})$ and $\left|V_{G S}\right|(\mathrm{V})$ are: $Q_{1}(50,0.1,0.7), Q_{2}(50,0.1,0.7)$, $Q_{3}(100,0.2,0.7), Q_{4}(20,0.1,0.7), Q_{5}(20,0.1,0.7), Q_{6}(100,0.2,0.7), Q_{7}(40,0.2,0.7)$
$9.250 .632 \mu \mathrm{~m} ; 0.28 \mathrm{~mA}$
$9.27 v_{B 1}=+0.5 \mathrm{~V}:-0.177 \mathrm{~V},+0.52 \mathrm{~V}, 2.5 \mathrm{~V} ; v_{B 1}=-0.5 \mathrm{~V}:-0.677 \mathrm{~V},+2.5 \mathrm{~V}$, $+0.52 \mathrm{~V}$
9.30 (a) $-0.574 \mathrm{~V}, 0.4 \mathrm{~V}, 0.4 \mathrm{~V}$; (b) -0.326 V to $0.674 \mathrm{~V}$; (c) 5 mV
9.32 (a) $V_{C C}-(I / 2) R_{C}$; (b) 2 V ; (c) $0.4 \mathrm{~mA}, 5 \mathrm{k} \Omega$
$9.34 R_{C}=5.05 \mathrm{k} \Omega,+1.6 \mathrm{~V}$
$9.360 .5 \mathrm{~mA}, 1.0 \mathrm{~mA} ; 17.3 \mathrm{mV}$
$9.388 \mathrm{~mA} / \mathrm{V} ; 40 \mathrm{k} \Omega$
$9.405 \mathrm{mV} ; 250 \Omega ;-40 \mathrm{~V} / \mathrm{V} ; 200 \mathrm{mV} ; 400 \mathrm{mV}$
9.42 Each emitter has a resistance $R_{e}=450 \Omega, R_{C}=10 \mathrm{k} \Omega ; I=1 \mathrm{~mA}$; Possible value of $V_{C C}=10 \mathrm{~V}$
$9.4912 \mathrm{~V} / \mathrm{V}$
$9.5116 \mathrm{~V} / \mathrm{V}$
$9.5325 \mathrm{~V} / \mathrm{V} ; 101 \mathrm{k} \Omega$
$9.557 .7 \mathrm{~V} / \mathrm{V} ; 5 \times 10^{-4} \mathrm{~V} / \mathrm{V} ; 1.54 \times 10^{4}$ or 83.8 dB
9.57 (a) 2.332 V ; (b) $5.06 \mathrm{k} \Omega$; (c) 2.47 V ; (d) $-1.92 \mathrm{~V} / \mathrm{V}$; (e) 0.287 V
$9.594 \mu \mathrm{~m}$
9.61 (a) $20 \mathrm{~V} / \mathrm{V}$; (b) $0.23 \mathrm{~V} / \mathrm{V}$; (c) 86.5 or 38.7 dB ; (d) $-0.023 \sin 2 \pi \times 60 t+$ $0.2 \sin 2 \pi \times 1000 t$, volts
9.63 (a) $100 \mathrm{~V} / \mathrm{V}$; (b) $50 \mathrm{k} \Omega$; (c) $2.5 \times 10^{-4} \mathrm{~V} / \mathrm{V}$; (d) $4 \times 10^{5}$ or 112 dB ; (e) $25 \mathrm{M} \Omega$
9.65 (a) $50 \mathrm{~V} / \mathrm{V}$; (b) $2.5 \times 10^{-3} \mathrm{~V} / \mathrm{V}, 2 \times 10^{4}$ or 86 dB ; (c) $5 \times 10^{-5} \mathrm{~V} / \mathrm{V}, 10^{6}$ or 120 dB
9.67 (a) Two emitter resistances and a single bias-current source $I ; R_{e}=25 \Omega ; R_{C}=10 \mathrm{k} \Omega$; $V_{C C}=+15 \mathrm{~V} ; R_{E E}=50 \mathrm{k} \Omega ; V_{A}=100 \mathrm{~V} ; 2.4 \mathrm{M} \Omega$
$9.692 / 3$ in one transistor and $1 / 3$ in the other; $0.008 \mathrm{~V} / \mathrm{V}$
9.7211 mV ; variability of $V_{i} ; 7.33 \%$
$9.742 .5 \mathrm{mV}$
$9.77-0.25 \mathrm{mV}$
$9.79 \quad 1.25 \mathrm{mV}$
9.81 (a) $x=0.3 \mathrm{k} \Omega$; (b) $x=0.225 \mathrm{k} \Omega$
$9.832 \alpha I / 3$ and $\alpha I / 3 ; \alpha I R_{C} / 3 ; 18.75 \mathrm{mV} ; 17.3 \mathrm{mV}$
$9.8520 \mathrm{k} \Omega ; 40 \mathrm{~V} / \mathrm{V}$
$9.871 .4 \mathrm{~mA} / \mathrm{V} ; 25 \mathrm{k} \Omega ; 25 \mathrm{k} \Omega ; 17.5 \mathrm{~V} / \mathrm{V}$
$9.893 \mathrm{~V}$
$9.921 \mathrm{~mA} / \mathrm{V} ; 75 \mathrm{k} \Omega ; 75 \mathrm{~V} / \mathrm{V} ; 75 \mathrm{k} \Omega$
$9.9420 \mathrm{k} \Omega ; 20 \mathrm{k} \Omega ; 10 \mathrm{~mA} / \mathrm{V} ; 200 \mathrm{~V} / \mathrm{V} ; 100 \mathrm{~V} / \mathrm{V}$
$9.96-2 V_{T} / \beta_{P}^{2} ;-20 \mu \mathrm{~V}$
$9.982 .67 \times 10^{4} \mathrm{~V} / \mathrm{V}$
$9.100 \frac{I / 2}{\beta+1} /\left(\frac{\beta}{2}\right)$, a reduction by a factor of $(\beta / 2) ; R_{i d}$ increases by a factor $(\beta / 3)$
$9.1021 .13 \mathrm{~mA} / \mathrm{V} ; 75 \mathrm{k} \Omega ; 85 \mathrm{~V} / \mathrm{V}$
$9.1051 \mathrm{~mA} / \mathrm{V} ; 25 \mathrm{k} \Omega ; 25 \mathrm{~V} / \mathrm{V} ; 25 \mathrm{k} \Omega, 0.02 \mathrm{~mA} / \mathrm{V} ; 0.98 \mathrm{k} \Omega ; 0.98 \mathrm{~A} / \mathrm{A} ; 50 \mathrm{k} \Omega ; 2600 \mathrm{k} \Omega$; $-0.0196 \mathrm{~V} / \mathrm{V} ; 1274$ or 62.1 dB
9.1070 .1
$9.1108 \mathrm{~mA} / \mathrm{V} ; 100 \mathrm{k} \Omega ; 800 \mathrm{~V} / \mathrm{V} ; 37.5 \mathrm{k} \Omega ; 100 \mathrm{k} \Omega ;-0.013 \mathrm{~V} / \mathrm{V} ; 60,000$ or 96 dB ; $444.4 \mathrm{~V} / \mathrm{V}$
9.112 (a) $83.3 \mathrm{k} \Omega$; (b) $1200 \mathrm{~V} / \mathrm{V}$; (c) $21 \times 10^{6}$ or 146 dB
9.114 (a) $W / L: 12.5,12.5,50,50,25,100,25,25,0 \mathrm{~V}$; (b) -0.1 V to +0.7 V ; (c) -0.7 V to +0.7 V ; (d) $900 \mathrm{~V} / \mathrm{V}$
$9.116108 \mu \mathrm{~A} ; 909 \mathrm{mV} ; 0.86 \mathrm{mV}$
9.118 (a) $W / L: 32.9,32.9,178,178,65.8,356,65.8,32.9$; (b) 0.65 V to 1.05 V ; (c) 0.15 V to $1.05 \mathrm{~V} ; 144 \mathrm{~V} / \mathrm{V}$
$9.12025 \mathrm{~V} / \mathrm{V} ; 20 \mathrm{k} \Omega ; 5000 \mathrm{~A} / \mathrm{A}$
$9.122 R_{5} ; 7.37 \mathrm{k} \Omega$; reduced to about half its original value; change $R_{4}$ to $1.085 \mathrm{k} \Omega$, this will slightly reduce $A_{2}$.
9.124 (a) $0.52 \mathrm{~mA}, 1.04 \mathrm{~mA}, 2.1 \mathrm{~mA}, 0 \mathrm{~V}$; (b) $4 \mathrm{k} \Omega, 65.5 \Omega$; (e) $8770 \mathrm{~V} / \mathrm{V}$

# CHAPTER 10 

10.120 nf
$10.310 \mu \mathrm{~F} ; 88.4 \mathrm{~Hz} ; 8.84 \mathrm{~Hz}$
10.5 (a) $10 \mathrm{k} \Omega$; (b) $3.53 \mu \mathrm{~F}$; (c) 10 Hz ; (d) 100 Hz ; (e) dc gain $=2$, makes perfect sense since $C_{S}$ behaves as an open-circuit at dc.
$10.75 \mu \mathrm{~F} ; 0.5 \mu \mathrm{~F} ; 0.5 \mu \mathrm{~F} ; 92.2 \mathrm{~Hz} ; 6 \mu \mathrm{~F}$
10.10141 .4
$10.13 g_{m}=1.3 \mathrm{~mA} / \mathrm{V} ; g_{m b}=0.25 \mathrm{~mA} / \mathrm{V} ; r_{o}=100 \mathrm{k} \Omega ; C_{g s}=61.6 \mathrm{fF} ; C_{g d}=4.3 \mathrm{fF}$; $C_{s b}=12.8 \mathrm{fF} ; C_{d b}=9.4 \mathrm{fF} ; f_{T}=3.1 \mathrm{GHz}$
$10.17 L=L_{\min }: 6.5 \mathrm{~V} / \mathrm{V}, 113 \mathrm{GHz} ; 2 L_{\min }: 13 \mathrm{~V} / \mathrm{V}, 28.3 \mathrm{GHz} ; 3 L_{\min }: 19.5 \mathrm{~V} / \mathrm{V}, 12.6 \mathrm{GHz}$; $4 L_{\min }: 26 \mathrm{~V} / \mathrm{V}, 7.1 \mathrm{GHz} ; 5 L_{\min }: 32.5 \mathrm{~V} / \mathrm{V}, 4.5 \mathrm{GHz}$
10.19265 .3 MHz
10.21500 MHz ; 600 MHz ; 252 ps ; 0.43 pF
$10.2350 \mathrm{MHz} ; 10 \mathrm{MHz}$
$10.255 \mathrm{pF} ;<31.8 \mathrm{k} \Omega$
10.28200 .2 pF ; $-1000 /\left[1+s C_{\mathrm{in}} R_{\text {sig }}\right] ; 795 \mathrm{kHz} ; 795 \mathrm{MHz}$
$10.31870 \mathrm{kHz} ;-6.1 \mathrm{~V} / \mathrm{V} ; R_{\mathrm{in}}=33.3 \mathrm{k} \Omega \rightarrow 3.1 \mathrm{~V} / \mathrm{V} ; R_{L}=1.24 \mathrm{k} \Omega \rightarrow 1.6 \mathrm{~V} / \mathrm{V}$
$10.33-9.2 \mathrm{~V} / \mathrm{V} ; 525 \mathrm{kHz}$
$10.3561 \mathrm{pF} ; 522 \mathrm{kHz}$
10.37 - $33 \mathrm{~V} / \mathrm{V} ; 873 \mathrm{kHz} ; 28.8 \mathrm{MHz} ; f_{H}$ increases by a factor of 1.16 and voltage gain decreases by the same factor while GB remains nearly constant. Power dissipation increases by a factor of 2 .
$10.39-32.8 \mathrm{~V} / \mathrm{V} ; 572 \mathrm{kHz}$
10.41 (a) $1001 \mathrm{pF}, 1.001 \mathrm{pF}$; (c) $20 \mathrm{pF}, 20 \mathrm{pF}$; (e) $-90 \mathrm{pF}, 9 \mathrm{pF} ;+90 \mathrm{pF}$
10.44 (a) 0.54 mA ; (b) $21.6, \mathrm{~A} / \mathrm{V}, 4.63 \mathrm{k} \Omega$; (c) $-10.8 \mathrm{~V} / \mathrm{V}$; (d) $4 \mathrm{k} \Omega, 2.14 \mathrm{k} \Omega$;
(e) $-7.4 \mathrm{~V} / \mathrm{V}$; (f) 14.37 pF ; (g) 16.3 MHz
$10.46-80 \mathrm{~V} / \mathrm{V} ; 3.8 \mathrm{MHz} ; 6.4 \mathrm{GHz} ; 304 \mathrm{MHz}$
$10.48-81.4 \mathrm{~V} / \mathrm{V} ; 21.4 \mathrm{MHz} ; 11.2 \mathrm{GHz}$
10.50 (a) 99.2 MHz ; (b) 227.6 MHz
10.53 (a) 4.26 ; (b) 49.3
$10.555 .67 \times 10^{7} \mathrm{rad} / \mathrm{s}$
$10.57-40.6 \mathrm{~V} / \mathrm{V} ; \tau_{g s}=243.8 \mathrm{~ns} ; \tau_{g d}=3112.8 \mathrm{~ns} ; \tau_{C L}=300 \mathrm{~ns} ; 43.5 \mathrm{MHz}$
$10.59-80 \mathrm{~V} / \mathrm{V} ; 10.1 \mathrm{pF} ; 788 \mathrm{kHz} ; 652 \mathrm{kHz}$; the latter as it takes into account $C_{L}$.
10.6141 .6 fF
$10.63-138.9 \mathrm{~V} / \mathrm{V} ; 2.98 \mathrm{MHz} ; 2.28 \mathrm{MHz}$, the latter as it takes into account $C_{L}$.
10.66 $8.3 \mathrm{~V} / \mathrm{V} ; 239 \mathrm{MHz} ; 7.23 \mathrm{MHz} ; 7.23 \mathrm{MHz}$
10.6911 .1 fF
$10.71-913 \mathrm{~V} / \mathrm{V} ; 6.28 \mathrm{MHz}$
$10.730 .2 \mathrm{~V} ; 0.2 \mathrm{~mA} ; 289.4 \mathrm{MHz} ; 57.9 \mathrm{kHz},-100 \mathrm{~V} / \mathrm{V}(40 \mathrm{~dB})$
$10.76-26.5 \mathrm{~V} / \mathrm{V} ; 5.7 \mathrm{MHz}$
$10.78-100,000 \mathrm{~V} / \mathrm{V} ; 31.8 \mathrm{kHz}, 31.8 \mathrm{kHz} ; 3.18 \mathrm{GHz}$
10.79 $0.91 \mathrm{~V} / \mathrm{V} ; 200 \Omega ; 398 \mathrm{MHz} ; 33.4 \mathrm{MHz}, 90.7 \mathrm{MHz} ; 31.6 \mathrm{MHz}$
$10.820 .8 /\left[s^{2}+8.886 \times 10^{6} \mathrm{~s}+39.48 \times 10^{12}\right]$
$10.840 .96 \mathrm{~V} / \mathrm{V} ; 2 \mathrm{GHz} ; 676 \mathrm{MHz}, 4.6 \mathrm{GHz} ; 676 \mathrm{MHz}$
10.861 .59 MHz
10.884 MHz ; decreases by a factor of 4 to 1 MHz
10.90 (b) -49.8 V/V; (c) $53.2 \mathrm{pF}, 598 \mathrm{kHz}, 29.8 \mathrm{MHz}$
10.9250 V/V; $15.9 \mathrm{MHz} ; 1.59 \mathrm{GHz} ; 3.18 \mathrm{GHz}$
10.96 (a) $-100 \mathrm{~V} / \mathrm{V}, 603 \mathrm{kHz}, 60.3 \mathrm{MHz}$; (b) $-50 \mathrm{~V} / \mathrm{V}, 1.02 \mathrm{MHz}, 51.2 \mathrm{MHz}$
10.101 (a) $2.5 \mathrm{M} \Omega,-4000 \mathrm{~V} / \mathrm{V}$; (b) 107.6 kHz ; two dominant capacitances: $C_{L}$ (most significant) and $C_{\mu 2}$
10.103 $66.7 \mathrm{~V} / \mathrm{V} ; 2 \mathrm{MHz}$
10.106 (a) $10,000 \mathrm{~V} / \mathrm{V}$; (b) 11.1 MHz

# CHAPTER 11 

$11.14 .9 \times 10^{-3} ; 169.5 ;-15.3 \%$
$11.31 ; 0.999 \mathrm{~V} / \mathrm{V} ; 60 \mathrm{~dB} ; 0.999 \mathrm{~V}, 0.001 \mathrm{~V} ;-0.011 \%$
11.5 (b) (i) 1000; (ii) 100; (iii) 20
$11.72500 \mathrm{~V} / \mathrm{V} ; 0.0196 \mathrm{~V} / \mathrm{V} ; 49 ; 50 \mathrm{~V} / \mathrm{V} ; 34 \mathrm{~dB}$
11.10 99; 4
11.12 $1000 \mathrm{~V} / \mathrm{V} ; 0.099 \mathrm{~V} / \mathrm{V}$
$11.14416 .6 \mathrm{~V} / \mathrm{V} ; 9.33 \times 10^{-3} \mathrm{~V} / \mathrm{V} ; 5016.8 \mathrm{~V} / \mathrm{V}, 9.95 \times 10^{-3} \mathrm{~V} / \mathrm{V} ; 41.66 \mathrm{~V} / \mathrm{V}$, $9.33 \times 10^{-2} \mathrm{~V} / \mathrm{V} ; 501.68 \mathrm{~V} / \mathrm{V}, 9.95 \times 10^{-2} \mathrm{~V} / \mathrm{V}$
11.16 $500 \mathrm{~V} / \mathrm{V} ; 0.098 \mathrm{~V} / \mathrm{V} ; 653.4 \mathrm{~V} / \mathrm{V}$
11.191 MHz, 1 Hz
11.21 Three stages; each with a closed-loop gain of $10 \mathrm{~V} / \mathrm{V}$, an amount of feedback of 100 , and $\beta=0.099 \mathrm{~V} / \mathrm{V}$.
$11.2350 \mathrm{~V} / \mathrm{V} ; 0.008 \mathrm{~V} / \mathrm{V} ; 16 \mathrm{~Hz}$
$11.25 \quad 0.089$; for $\left|v_{S}\right| \leq 0.9 \mathrm{~V}, v_{O} / v_{S}=11.1 \mathrm{~V} / \mathrm{V}$, for $0.9 \mathrm{~V} \leq\left|v_{S}\right| \leq 1.4 \mathrm{~V}, v_{O} / v_{S}=$ $10.1 \mathrm{~V} / \mathrm{V}$, and for $\left|v_{S}\right| \geq 1.4 \mathrm{~V}, v_{O}= \pm 15 \mathrm{~V}$
11.27 (a) $90 \mathrm{k} \Omega$; (b) $43.11,9.77 \mathrm{~V} / \mathrm{V}$; (c) 2.343
11.29 (a) $1+\frac{R_{2}}{R_{1}}=11 \mathrm{~V} / \mathrm{V}$; (b) $0.1 \mathrm{~mA}, 0.3 \mathrm{~mA},+7.7 \mathrm{~V}$; (c) 23.2 ; (d) $10.5 \mathrm{~V} / \mathrm{V}$
11.31 (a) $0.9 \mathrm{k} \Omega$; (b) $31.33,9.7 \mathrm{~V} / \mathrm{V},-3 \%$, change $R_{F}$ to $933 \Omega$
11.33 (a) $47.62 \beta, 47.62 \mathrm{~V} / \mathrm{V}$; (b) $821 \mathrm{k} \Omega, 179 \mathrm{k} \Omega$
11.35 Lower; 199; $20 \mathrm{k} \Omega$
$11.37100 \mathrm{~V} / \mathrm{V} ; 1.001 \mathrm{M} \Omega$
11.39 (a) $1+\left(R_{2} / R_{1}\right)=11 \mathrm{~V} / \mathrm{V}$; (b) $0.1 \mathrm{~mA}, 0.3 \mathrm{~mA},+7.7 \mathrm{~V}$; (c) $255.3 \mathrm{~V} / \mathrm{V}, 0.359 \mathrm{k} \Omega$, $0.917 \mathrm{k} \Omega$; (d) $1 / 11$; (e) $10.5 \mathrm{~V} / \mathrm{V}, 8.59 \mathrm{k} \Omega, 39.4 \Omega, 4.5 \%$11.41 (b) $10 \mathrm{~V} / \mathrm{V}$; (c) $0.2 \mathrm{~V}, 1.1 \mathrm{~V}, 0.2 \mathrm{~V}, 0.9 \mathrm{~V}$; (d) $-35.3 \mathrm{~V} / \mathrm{V},-50 \mathrm{~V} / \mathrm{V}, 0.935 \mathrm{~V} / \mathrm{V}$, $1650 \mathrm{~V} / \mathrm{V}$; (e) $0.1 \mathrm{~V} / \mathrm{V}$; (f) $9.94 \mathrm{~V} / \mathrm{V},-0.6 \%$; (g) $5.6 \Omega$
11.44 (c) $1.2 \mathrm{k} \Omega$; (d) $1.42 \mathrm{k} \Omega, 628 \Omega$; (e) $23.8 \mathrm{~V} / \mathrm{V}$; (f) $145 \mathrm{k} \Omega, 0.53 \Omega$
$11.46100 \Omega ; 9.94 \mathrm{~mA} / \mathrm{V}$
11.48 (c) $-0.999 \mathrm{k} \Omega$
11.50 (a) $0.135 \mathrm{~V} / \mathrm{V}$; (b) $7.4 \mathrm{~V} / \mathrm{V}$; (c) $0.14 \Omega$
11.53 (a) $200 \Omega$; (b) $1418.4 \mathrm{~mA} / \mathrm{V}$; (c) 283.7,284.7 ; (d) $4.982 \mathrm{~mA} / \mathrm{V}$, very close; (e) $28.2 \mathrm{k} \Omega, 8 \mathrm{M} \Omega$
$11.569 .56 \mathrm{~mA} / \mathrm{V} ; 503.4 \mathrm{k} \Omega$
11.58 (a) $0 \mathrm{~V},+0.6 \mathrm{~V},+0.6 \mathrm{~V}$; (b) $0.1 \mathrm{~mA} / \mathrm{V}$; (c) $0.099 \mathrm{~mA} / \mathrm{V}$; (d) $203 \mathrm{M} \Omega$; (e) $0.99 \mathrm{~V} / \mathrm{V} ; 1.25 \Omega$
$11.60-9.88 \mathrm{k} \Omega, 11.1 \Omega, 1.1 \Omega$ compared to $-9.99 \mathrm{k} \Omega, 1.11 \Omega, 0.11 \Omega$.
$11.62323 ;-0.1 \mathrm{~mA} / \mathrm{V} ;-32.3 \mathrm{k} \Omega ;-7.63 \mathrm{k} \Omega$; due to the approximation used in the systematic analysis method.
11.64 (a) $-R_{F} / R_{s}, 20 \mathrm{k} \Omega$; (b) $-9.88 \mathrm{~V} / \mathrm{V}, 21.7 \Omega, 22.1 \Omega$; (c) 82.18 kHz
11.66 159, larger by about $2.5 \%$, a result of the approximations involved in the general method. The more accurate value is the one obtained here.
$11.6810 \mathrm{k} \Omega ;-9.52 \mathrm{k} \Omega ; 11.9 \Omega ; 244 \Omega$
11.70 (b) $-98.8 \mathrm{~V} / \mathrm{V} ; 7.2 \Omega ; 10.3 \Omega$
$11.720 .53 \mathrm{k} \Omega ; 10.5 \Omega ; 526 \Omega$
11.74 (d) $-99.8 \mathrm{~A} / \mathrm{A},-0.1 \mathrm{~A} / \mathrm{A}, 9.98,-9.1 \mathrm{~A} / \mathrm{A}, 0.2 \mathrm{k} \Omega, 18.2 \Omega$; (e) $328.4 \mathrm{k} \Omega$
11.76 970.9, $-9709 \mathrm{~A} / \mathrm{A},-9.99 \mathrm{~A} / \mathrm{A} ; A \beta$ and $A$ differ slightly from the results in Example 11.10; however, $A_{f}$ is identical.
$11.81 I_{C 1}=0.1 \mathrm{~mA}, I_{C 2}=10 \mathrm{~mA} ; V_{o} / V_{s}=3.62 \mathrm{~V} / \mathrm{V} ; R_{\text {in }}=176.7 \Omega$
$11.8320 \mathrm{krad} / \mathrm{s} ; 4 \times 10^{-3} \mathrm{~V} / \mathrm{V} ; 250 \mathrm{~V} / \mathrm{V}$
$11.858 \times 10^{-4}$
$11.8710 \mathrm{~V} / \mathrm{V} ; 10^{5} \mathrm{~Hz} ; 1 \mathrm{MHz}$; by the amount-of-feedback $\simeq 10^{4}$.
11.89 (a) $2.025 \times 10^{-4}, 5.5 \times 10^{4} \mathrm{~Hz}$; (b) $3306 \mathrm{~V} / \mathrm{V}, 1653 \mathrm{~V} / \mathrm{V}$; (c) 0.5 ;
(d) $(-5.5 \pm j 13.25) \times 10^{4} \mathrm{~Hz}, 1.325$
$11.910 .1 ; 0.686 ; 2.1$
$11.932 ; 173.2 \mathrm{kHz}$
$11.953 .085 \times 10^{3} \mathrm{~Hz} ; 18.15^{\circ} ; 10^{-3}$
$11.973 .16 \times 10^{-4} ; 2.4 \times 10^{3} \mathrm{~V} / \mathrm{V}$ or 67.6 dB .
$11.992 .4 \times 10^{4} \mathrm{~V} / \mathrm{V}$ or $87.6 \mathrm{~dB} ; 9.09 \times 10^{3} \mathrm{~V} / \mathrm{V}$ or 79.2 dB .
$11.1012 \mathrm{kHz} ; 500$
11.10410 Hz ; 15.9 nF
11.106 (b) $3.16 \times 10^{4} \mathrm{~Hz}, 1.8^{\circ}$; (c) zero: $-10^{3} \mathrm{rad} / \mathrm{s}$, poles: $(-0.505 \pm j 31.62) \times 10^{3} \mathrm{rad} / \mathrm{s}$, the response is very peaky with a peak of 1000 at $31.62 \mathrm{krad} / \mathrm{s}$.

# CHAPTER 12 

$12.1-9.3 \mathrm{~V}$ to $+9.7 \mathrm{~V} ;-8.6 \mathrm{~V}$ to $+10.4 \mathrm{~V} ;-4.65 \mathrm{~V}$ to $+9.7 \mathrm{~V} ;-3.95 \mathrm{~V}$ to $+10.4 \mathrm{~V}$; -9.7 V to $+9.7 \mathrm{~V} ;-9 \mathrm{~V}$ to +10.4 V
$12.32 .7 \mathrm{k} \Omega ; 24 \mathrm{~mW}$
$12.6 V_{C C} I$ (in all cases)
$12.8 \hat{V} ; \hat{V} / R_{L} ; 25 \%$
12.11 $4.5 \mathrm{~V} ; 6.4 \% ; 625 \Omega$
12.13 $10 \mathrm{~V} ; 6.37 \mathrm{~V} ; 6.85 \Omega, 7.3 \mathrm{~W} ; 9.62 \Omega, 1.3 \mathrm{~W}$
12.17 $1.266 \mathrm{~V} ; 12.5 \Omega ; 0.889 \mathrm{~V} / \mathrm{V} ; 0.998 \mathrm{~V} / \mathrm{V}$
12.192 .15 mA
$12.221 \mathrm{~mA} ;-1.06 \mathrm{~V} ;+4 \mathrm{~V} ;-6 \mathrm{~V}$
$12.240 .98 \mathrm{~mA} ;+5.1 \mathrm{~V} ;-10 \mathrm{~V} ; 99 ; 1.96 \mathrm{~mA} ; 1.92 \mathrm{~mA}$
$12.2820 .7 \mathrm{~mA} ; 788 \mathrm{~mW} ; 7.9^{\circ} \mathrm{C} ; I_{Q}$ becomes 37.6 mA , etc., etc.
12.30 (a) $1.365 \mathrm{k} \Omega, 1.365 \mathrm{k} \Omega, 1.365 \mathrm{~V}$; (b) 1.420 ; (c) 1.512 V ; (d) 1.641 V
12.32 (a) For $R_{L}=\infty$ : at $v_{I}=0, I_{1}=0$; at $v_{I}=+10 \mathrm{~V}, I_{1}=20 \mu \mathrm{~A}$, at $v_{I}=-10 \mathrm{~V}$, $I_{1}=-20 \mu \mathrm{~A} ;$ (b) $R_{L}=100 \Omega$; at $v_{I}=0, I_{1}=0$, at $v_{I}=+10 \mathrm{~V}, I_{1}=22.5 \mu \mathrm{~A}$, at $v_{I}=-10 \mathrm{~V}, I_{1}=-22.5 \mu \mathrm{~A}$.
$12.34215 \Omega, 215 \Omega, 0.75 \Omega, 0.75 \Omega ; 0.7 \Omega ; 0.704 \mathrm{~V}$
12.37 (a) $0.0164 \mathrm{~mA}, 1.64 \mathrm{~mA}$; (b) $32.8 v_{i},-66.2 \mathrm{~V} / \mathrm{V}$; (c) $27.2 \mathrm{k} \Omega$
$12.39 R_{1}=300 \mathrm{k} \Omega, R_{2}=632 \mathrm{k} \Omega ; 9.484 \mathrm{~V}$ and -10.644 V
$12.413 .84 \Omega ; 384 \mathrm{mV} ; 0.94 \mu \mathrm{~A}$
$12.436 .5 \Omega ; 487.5 \mathrm{mV} ; 2.9 \mu \mathrm{~A}$
12.45 (b) $1.25 \mathrm{~V}, 1.56 \mathrm{~mA}$
12.47 (a) $Q_{1}: 35.6, Q_{2}: 88.9, Q_{N}: 356, Q_{P}: 889$; (b) -0.6 V ; (c) 1.38 V
$12.49 \pm 2.05 \mathrm{~V}$
12.51 (b) 0.15 V
12.53 (a) 533.3, 1333.3; (b) $10 \mathrm{~V} / \mathrm{V}$; (c) -5\%; (d) 1.85 V and -1.85 V ; (e) 0.3 V and -0.3 V ; (f) -1.77 V to +1.77 V
$12.55 R_{2}$ and $R_{3} ; R_{3} ; R_{2} ; R_{2}=33.3 \mathrm{k} \Omega$ and $R_{3}=1.33 \mathrm{k} \Omega$
$12.5716 \mathrm{~V} ; 2.7 \mathrm{~W} ; 13 \mathrm{~V} p-p$
$12.5930 \mathrm{k} \Omega, 40 \mathrm{k} \Omega$
$12.62+3 \mathrm{~V} ;-3 \mathrm{~V}$
12.64 (c) $8 \Omega, 5 \mathrm{~A}, 50 \mathrm{~W}$; (d) $6 \Omega, 5 \mathrm{~A}, 37.5 \mathrm{~W}$; (e) $3 \Omega, 5 \mathrm{~A}, 18.75 \mathrm{~W}$
$12.6612 .5^{\circ} \mathrm{C} / \mathrm{W} ; 8 \mathrm{~W} ; 112.5^{\circ} \mathrm{C}$
12.68 (a) $37.5^{\circ} \mathrm{C} / \mathrm{W}$; (b) 1.33 W ; (c) $62.5^{\circ} \mathrm{C}$
$12.7072^{\circ} \mathrm{C} ; 1.5^{\circ} \mathrm{C} / \mathrm{W} ; 4 \mathrm{~cm}$

# CHAPTER 13 

$13.1-0.8 \mathrm{~V}$ to $+1.2 \mathrm{~V} ;-0.8 \mathrm{~V}$ to +0.8 V
13.30 .15 V
$13.50 .45 \mu \mathrm{~m} ; 2000 \mathrm{~V} / \mathrm{V}$
13.7 (a) $10,000 \mathrm{~V} / \mathrm{V}$; (b) $10^{8} \mathrm{rad} / \mathrm{s}$ and $10^{7} \mathrm{rad} / \mathrm{s}$; (c) $10^{9} \mathrm{rad} / \mathrm{s}, 4 \mathrm{pF}, 25 \times 10^{3} \mathrm{rad} / \mathrm{s}$, $5 \times 10^{8} \mathrm{rad} / \mathrm{s}$
13.9 (a) 1.59 pF ; (b) $f_{P 1}=f_{t} / A_{0}, f_{P 2}=318 \mathrm{MHz}, f_{Z}=200 \mathrm{MHz}$; (c) $46^{\circ}$; (d) $500 \Omega, 72.5^{\circ}$;
(e) $722 \Omega$
$13.11125 .6 \mathrm{~V} / \mu \mathrm{s} ; 0.8 \mathrm{pF}$
13.13 (a) 2 pF ; (b) 1.51 pF
13.15 (a) 0.16 V ; (b) 2 pF ; (c) 78.1
13.17 (b) $0.45 \mu \mathrm{~m}$
$13.19250 \mu \mathrm{~A} ; 400 \mu \mathrm{~A} ; 200 \mu \mathrm{~A} ; 50 \mu \mathrm{~A}$
$13.2125,25,25,6.25,6.25,6.25,6.25,125,125,50$
$13.23100 \mu \mathrm{~A} ; 150 \mu \mathrm{~A} ; 15.92 \mathrm{MHz} ; 54.7^{\circ} ; 6.58 \mathrm{MHz} ; C_{L}=24.2 \mathrm{pF} ; 4.13 \mathrm{~V} / \mu \mathrm{s}$
$13.250 .12 \mathrm{~V} ; I_{B}=I=150 \mu \mathrm{~A} ; 15 \mathrm{~V} / \mu \mathrm{s} ; W / L: 26,26,65,65,26,26,26,26,130,130,52$
13.28 (a) -0.25 V to +1.3 V ; (b) -1.3 V to +0.25 V ; (c) -0.25 V to +0.25 V ;
(d) -1.3 V to +1.3 V
$13.30 C_{p}=0.176 C_{L}$
$13.33 V_{E B}=625 \mathrm{mV}$; A device: $7.3 \mathrm{~mA} / \mathrm{V}, 137 \Omega, 6.85 \mathrm{k} \Omega, 278 \mathrm{k} \Omega$; B device: $21.9 \mathrm{~mA} / \mathrm{V}$, $46 \Omega, 2.28 \mathrm{k} \Omega, 90.9 \mathrm{k} \Omega$
$13.35 I_{3}=I_{1}\left\{\left[\frac{1}{\sqrt{k_{1}}}+\frac{1}{\sqrt{k_{2}}}\right] /\left[\frac{1}{\sqrt{k_{3}}}+\frac{1}{\sqrt{k_{4}}}\right]\right\}^{2} ; 0.1 \mathrm{~mA}$
$13.37603 \mathrm{mV} ; 518 \mathrm{mV} ; 8.5 \mathrm{k} \Omega$
$13.394 .75 \mu \mathrm{~A} ; R_{4}=1.94 \mathrm{k} \Omega$
$13.4114 \mu \mathrm{~A}$
13.4353 .3 nA; 20.1 nA
$13.45-3 \mathrm{~V}$ to +4.8 V
$13.476 .4 \mathrm{k} \Omega ; 270 \mu \mathrm{~A}$
13.491 .68 mA ; 50.4 mW
$13.514 .63 \mathrm{k} \Omega$
13.5310 mV
$13.550 .691 \mu \mathrm{~A} ; 3.6 \mathrm{mV}$
$13.57 R=18.2 \mathrm{k} \Omega ; 15.55 \mathrm{M} \Omega$
$13.603 .1 \mathrm{M} \Omega, 9.38 \mathrm{~mA} / \mathrm{V}$
$13.62-3.6 \mathrm{~V}$ to +4.2 V
$13.6414 .4 \Omega$
13.66 20.2 mA ; double the value of $R_{7}$
13.685 .67 MHz
13.70180 Hz ; 0.7 pF
$13.73159 .2 \mathrm{kHz} ; 10^{8} \mathrm{rad} / \mathrm{s}$ or 15.9 MHz
13.75 (a) $0.05 \mathrm{~mA}, 0.05 \mathrm{~mA}, 0.05 \mathrm{~mA}, 0.05 \mathrm{~mA}, 1 \mathrm{~mA}, 1 \mathrm{~mA}, 1 \mathrm{~mA}$; (b) $100 \mathrm{k} \Omega$;
(c) $5 \times 10^{4} \mathrm{~V} / \mathrm{V}$ or 94 dB ; (d) 63.7 pF
$13.77 Q_{5}: Q_{1}=1 ; Q_{6}: Q_{1}=4 ; 3.47 \mathrm{k} \Omega ; 3 \mathrm{M} \Omega$ and $7 \mathrm{M} \Omega$
13.79 (a) 0.1 V to 2.2 V ; (b) 0.8 V to 2.9 V
$13.8112 .5 \mathrm{k} \Omega ; 0.8 \mathrm{~V}$ to $3.35 \mathrm{~V} ; 100 \mathrm{k} \Omega ; 10 \mu \mathrm{~A}, 50 \mathrm{k} \Omega$
$13.8336 .9 / I ; 1240 \mathrm{~V} / \mathrm{V} ; 1240\left(I R_{L}\right) /\left(I R_{L}+36.9\right) ; 5.1 \mu \mathrm{~A}, 11.8 \mu \mathrm{~A}$
13.85 (a) 0.1 V to 2.9 V ; (b) $20 \mathrm{k} \Omega$; (c) $0.2 \Omega$; (d) $12.3 \mathrm{~mA}, 0.3 \mathrm{~mA}, 1.6 \mathrm{k} \Omega$; (e) 0.3 mA , $12.3 \mathrm{~mA}, 2.4 \mathrm{k} \Omega$
$13.8810 .6 \mu \mathrm{~A} ; 0.3 \mathrm{~mA}$

# CHAPTER 14 

14.1 (a) $2.18 \mathrm{k} \Omega$; (b) $5.40 \mathrm{k} \Omega$; (c) 3.71
14.2 (a) 6 ; (b) $1.67 \mathrm{k} \Omega$
$14.160 .6 \mathrm{~V} ; 0.7 \mathrm{~V}$
$14.18 N M_{H}=0.2 V_{D D} ; N M_{L}=0.3 V_{D D} ; 0.2 V_{D D} ; 2 \mathrm{~V}$
14.20 (a) $0.12 \mathrm{~V}, 2.5 \mathrm{~V}, 1.5 \mathrm{~V}, 0.68 \mathrm{~V}$; (b) $V_{O H}=2.5-0.4 N, N M_{H}=1.5-0.4 N, N=2$;
(c) (i) 3 mW , (ii) 1 mW
14.22 $V_{I L}=0.776 \mathrm{~V}, V_{I H}=0.816 \mathrm{~V} ; N M_{H}=1.184 \mathrm{~V} ; N M_{L}=0.776 \mathrm{~V} ;-50 \mathrm{~V} / \mathrm{V}$
$14.24 V_{D D}=1.2 \mathrm{~V}, R_{D}=38.3 \mathrm{k} \Omega, W / L=1.5 ; 0 \mathrm{~W}, 36 \mu \mathrm{~W}$
$14.26 V_{D D}=1.2 \mathrm{~V}, R_{D}=23 \mathrm{k} \Omega, W / L=2.5 ; 0.435 \mathrm{~V}, 0.6 \mathrm{~V}, 0.7 \mathrm{~V}, 0.385 \mathrm{~V}, 0.5 \mathrm{~V}$
14.296 .84
14.31 (a) $244 \mathrm{~nm}, 22,181 \mathrm{~nm}^{2}$; (b) $1 \mathrm{~V}, 0 \mathrm{~V}, 0.5375 \mathrm{~V}, 0.4625 \mathrm{~V}, 0.4625 \mathrm{~V}, 0.4625 \mathrm{~V}$ (c) both equal; $2.18 \mathrm{k} \Omega$
14.331 .82
14.3540 .1
14.37 (a) $0.78 \mu \mathrm{~m}, 0.127 \mu \mathrm{~m}^{2}$; (b) $1.3 \mathrm{~V}, 0 \mathrm{~V}, 0.7125 \mathrm{~V}, 0.5875 \mathrm{~V}, 0.59 \mathrm{~V}, 0.59 \mathrm{~V}$, $0.0625 \mathrm{~V}, 1.24 \mathrm{~V}, 0.53 \mathrm{~V}, 0.53 \mathrm{~V}$; (c) $1.48 \mathrm{k} \Omega, 1.48 \mathrm{k} \Omega$; (d) $-5.8 \mathrm{~V} / \mathrm{V}, 0.762 \mathrm{~V}$, $0.538 \mathrm{~V}, 0.224 \mathrm{~V}$; (e) $0.57 \mathrm{~V},-0.08 \mathrm{~V}, 60 \%$; (f) $0.61 \mathrm{~V},-0.04 \mathrm{~V}, 40 \%$
14.39 (a) $v_{O}(t)=10 e^{-t / \tau}$; (b) $69 \mathrm{~ns}, 220 \mathrm{~ns}$
$14.4169 \mathrm{ps}, 35 \mathrm{ps}, 52 \mathrm{ps}$
14.43 (a) $1.2 \mathrm{~ns}, 0.6 \mathrm{~ns}$; (b) 1 pF ; (c) $C_{\text {out }}=0.6 \mathrm{pF}, C_{\text {load }}=0.4 \mathrm{pF}$
$14.4530 \mathrm{ps}, 60 \mathrm{ps}, 45 \mathrm{ps}$
$14.4757 .5 \mathrm{ps}, 69 \mathrm{ps}, 63.3 \mathrm{ps}$
$14.49(W / L)_{n} \geq 1.725,(W / L)_{p} \geq 4.14$
14.5134 .4 ps, $42.6 \mathrm{ps}, 38.5 \mathrm{ps} ; 13 \mathrm{GHz}$
$14.5336 .3 \mathrm{ps}, 36.3 \mathrm{ps}, 36.3 \mathrm{ps} ; 9.35 \mathrm{fF}$
14.55 (c) $14.66 \times 10^{3}\left(2 C_{u}+C_{w}\right)$; (d) $8.625 \times 10^{3}\left(3.4 C_{u}+C_{w}\right)$ (e) (i) In both cases, $t_{P}=29.32 \times 10^{3} C_{u}$, thus when $C$ is entirely intrinsic, scaling does not affect $t_{P}$; (ii) For $W_{p}=W_{n}, t_{P}=14.66 \times 10^{3} C_{w}$, and for $W_{p}=2.4 W_{n}, t_{P}=8.625 \times 10^{3} C_{w}$, thus using a matched design reduces $t_{P}$ only when $C$ is dominated by external capacitance.
14.60 (a) 2.65 V ; (b) 2.24 V
$14.6332 .4 \mathrm{fJ} ; 64.8 \mathrm{~W} ; 36 \mathrm{~A}$
$14.65 \quad 0.36 \mathrm{pF}$
14.67 32 pJ
14.69 (a) $t_{P}$ and the maximum operating frequency remain unchanged, $P D P$ is reduced by a factor of 0.52 ; (b) $t_{P}$ increases by a factor ( $1 / 0.72$ ) and the maximum operating frequency is reduced by the factor of 0.72 . The $P D P$ decreases by a factor of 0.72 .

# CHAPTER 15 

15.1 $4.88 \times 10^{8}$ or 488 million transistors
$15.3260 \mathrm{~cm}^{2} / \mathrm{Vs}, 144.4 \mathrm{~cm}^{2} / \mathrm{Vs} ; E_{c r}(\mathrm{NMOS})=3.85 \times 10^{4} \mathrm{~V} / \mathrm{cm} ; E_{c r}(\mathrm{PMOS})=$ $6.92 \times 10^{4} \mathrm{~V} / \mathrm{cm}$
15.5 (b) 0.62
15.7 (b) 2.75
15.9 (a) 207 pA ; (b) $207 \mathrm{~mA}, 207 \mathrm{~mW}$
15.11 (a) $270 \Omega$; (b) 0.1 pF ; (c) 93.2 ps
15.131 .3 V ; $0.095 \mathrm{~V} ; 40.5 \mu \mathrm{~A} ; 52.7 \mu \mathrm{~W}$
15.15167 ps; 36.9 ps; 102 ps
15.172 .1 ; $0.5 \mathrm{~V} ; 0.5 \mathrm{~V}, 0.47 \mathrm{~V}, 0.44 \mathrm{~V}$
15.191 .69 ; $0.58 \mathrm{~V} ; 152 \mu \mathrm{~W}$
15.231 .26
15.26 0.834 V
15.2825 .8 ps
15.302 .07 V, $0 \mathrm{~V} ; 10.4 \mu \mathrm{~A} ; 0.9 \mathrm{~ns} ; 0.5 \mathrm{~ns}$
$15.3413 .5 \mu \mathrm{~A} ; 351.6 \mu \mathrm{~A} ; 182.6 \mu \mathrm{~A} ; 0.18 \mathrm{~ns}$
15.36 (a) $1.2 \mathrm{~V}, 0 \mathrm{~V}$; (b) $240 \mu \mathrm{~A}, 60 \mu \mathrm{~A}, 7.8 \mu \mathrm{~A}, 56.25 \mu \mathrm{~A}, 49.4 \mathrm{ps}$; (c) $240 \mu \mathrm{~A}, 60 \mu \mathrm{~A}$, $225 \mu \mathrm{~A}, 1.9 \mu \mathrm{~A}, 34.2 \mathrm{ps}, 0.466 \mathrm{~V} ; 41.8 \mathrm{ps}$
$15.398 .3 \mathrm{k} \Omega ; 83 \mathrm{ps}$
15.450 .188 ns
15.470 .188 ns; 0.077 ns
15.49 (d) $0.35 \mathrm{~V}, 0.6 \mathrm{~V}$
15.512 GHz
$15.53-1.453 \mathrm{~V},-1.205 \mathrm{~V},-1.73 \mathrm{~V},-0.88 \mathrm{~V} ; 0.230 \mathrm{~V}, 0.325 \mathrm{~V}, 0.345 \mathrm{~V}$
15.5522 .45 mW
$15.571 \mathrm{~V} ;+5 \mathrm{~V} ;(A+B) \cdot(C+D)$
$15.592 .6 \mathrm{~V} ; 8.18 \mathrm{~mA}$

# CHAPTER 16 

16.1 $\mathrm{A}(0 \mathrm{~V}, 0 \mathrm{~V}), \mathrm{B}(2.5 \mathrm{~V}, 2.5 \mathrm{~V}), \mathrm{C}(5 \mathrm{~V}, 5 \mathrm{~V}) ; 25 \mathrm{~V} / \mathrm{V} ; 0.2 \mathrm{~V}$
$16.4\left(W / L)_{1,3}=0.13 \mu \mathrm{~m} / 0.13 \mu \mathrm{~m}, \quad(W / L)_{2,4}=0.52 \mu \mathrm{~m} / 0.13 \mu \mathrm{~m}, \quad(W / L)_{5,8}=\right.$ $0.26 \mu \mathrm{~m} / 0.13 \mu \mathrm{~m}$
$16.6\left(W / L)_{5,6}=3.83\right.$, higher than the values without velocity saturation to compensate for the current reduction resulting from velocity saturation.
$16.70 .4 \mu \mathrm{~m} / 0.13 \mu \mathrm{~m} ; 65 \mathrm{ps}$
16.11 4,294,967,296
16.1316
$16.1557 \%$
$16.17(W / L)_{a} \leq 4.5$
16.19 4.5; (i) $0.23 \mathrm{~V}, 121.8 \mu \mathrm{~A}$; (ii) $0.34 \mathrm{~V}, 158.7 \mu \mathrm{~A}$; (iii) $0.4 \mathrm{~V}, 180 \mu \mathrm{~A}$
16.22 1.75, greater than the value without velocity saturation because of the current reduction due to velocity saturation.
16.24 (a) 3 ; (b) 4.93 ns ; (c) 3.33 ns
16.263
$16.29 L=0.13 \mu \mathrm{~m},(W / L)_{a}=(W / L)_{p}=(W / L)_{a}=1$
16.31128 Mbits
$16.33 \quad 0.5 \mathrm{pA}$
$16.35 \quad 0.4 \mathrm{~mA} / \mathrm{V} ; 353 \mathrm{mV} ; 130 \mathrm{mV} ; 100 \%$ (doubling); 4 ns
$16.37(W / L)_{a}=3.33,(W / L)_{p}=13.32 ; 1.44 \mathrm{~ns} ; 2 \mathrm{~ns}$
16.39 (a) 0.4 V ; (b) $0.1 \mathrm{~V}, 0.3 \mathrm{~V}$; (c) $132 \mu \mathrm{~A}$; (d) $(W / L)_{1,2}=26.4,(W / L)_{3,4}=6.6$, $(W / L)_{5}=52.8$
$16.4110 ; 1024 ; 10,240 ; 1024 ; 12,288$
$16.4340 \mathrm{MHz}, 48 \%$
16.454
16.48 (a) 2.4 ns ; (b) $22 \mathrm{~ns}, 3.16 \mathrm{~V}$; (c) 1.9 ns

# CHAPTER 17 

17.2 (a) $0.995 \mathrm{~V},-5.7^{\circ}$; (b) $0.707 \mathrm{~V},-45^{\circ}$; (c) $0.1 \mathrm{~V},-84.3^{\circ}$; (d) $0.01 \mathrm{~V},-89.4^{\circ}$
17.4 $1 \mathrm{~V} / \mathrm{V} ; 0.977 \mathrm{~V} / \mathrm{V} ; 0.001 \mathrm{~V} / \mathrm{V}$
$17.60 .97 \mathrm{~dB} ; 14.15 \mathrm{~dB}$
17.10 (a) LP: $T(s)=10^{20} /\left(s+10^{4}\right)\left(s^{2}+0.618 \times 10^{4} s+10^{8}\right)\left(s^{2}+1.618 \times 10^{4} s+10^{8}\right)$
(b) HP: $T(s)=s^{5} /\left(s+10^{4}\right)\left(s^{2}+0.618 \times 10^{4} s+10^{8}\right)\left(s^{2}+1.618 \times 10^{4} s+10^{8}\right)$;
$17.12 T(s)=0.2656\left(s^{2}+4\right) /\left(s^{2}+0.5 s+1.0625\right) ; 0.2656$
$17.141 /\left(s^{3}+2 s^{2}+3 s+2\right) ;-1,-0.5 \pm j 1.323$
17.1735 .7 dB
$17.19 N=4 ; 2 \pi \times 10^{4}(-0.383 \pm j 0.924), 2 \pi \times 10^{4}(-0.924 \pm j 0.383) ; \omega_{0}^{4} /\left(s^{2}+\right.$ $\left.0.765 \omega_{0} s+\omega_{0}^{2}\right) \times\left(s^{2}+1.848 \omega_{0} s+\omega_{0}^{2}\right)$ where $\omega_{0}=2 \pi \times 10^{4} \mathrm{rad} / \mathrm{s} ; 38.2 \mathrm{~dB}$
$17.220 .975 \mathrm{rad} / \mathrm{s}, 0.782 \mathrm{rad} / \mathrm{s}, 0.434 \mathrm{rad} / \mathrm{s}, 0 \mathrm{rad} / \mathrm{s} ; 1 \mathrm{rad} / \mathrm{s}, 0.901 \mathrm{rad} / \mathrm{s}, 0.623 \mathrm{rad} / \mathrm{s}$, $0.223 \mathrm{rad} / \mathrm{s} ;-64.9 \mathrm{~dB} ; 42 \mathrm{~dB} /$ octave
17.24 (a) $N=10,4 \mathrm{~dB}$; (b) Normalized to $\omega_{p}=2 \pi \times 3.4 \times 10^{4} \mathrm{rad} / \mathrm{s}$, the poles are: $-0.0224 \pm j 0.9978 ;-0.0651 \pm j 0.9001 ;-0.1013 \pm j 0.7143 ;-0.1277 \pm$ $j 0.4586 ;-0.1415 \pm j 0.1580, T(s)=7.60 \times 10^{4} /\left(s^{2}+s 0.0448 \omega_{p}+0.9961 \omega_{p}^{2}\right)$ $\left(s^{2}+0.1302 \omega_{p}+0.8144 \omega_{p}^{2}\right)\left(s^{2}+s 0.2026 \omega_{p}+0.5205 \omega_{p}^{2}\right)\left(s^{2}+0.2554 \omega_{p}+\right.$ $\left.0.2266 \omega_{p}^{2}\right)\left(s^{2}+s 0.2830 \omega_{p}+0.0450 \omega_{p}^{2}\right)$
$17.26 R_{1}=120 \mathrm{k} \Omega ; C=6.63 \mathrm{nF} ; R_{2}=120 \mathrm{k} \Omega$
$17.28 R_{1}=10 \mathrm{k} \Omega, R_{2}=10 \mathrm{k} \Omega, C_{1}=0.16 \mu \mathrm{~F}, C_{2}=1.6 \mathrm{nF} ;$ High-frequency gain $=40 \mathrm{~dB}$
$17.30 T(s)=-\left(s-\omega_{0}\right) /\left(s+\omega_{0}\right)$ where $\omega_{0}=1 / C R ; T(j \omega)=\left(1-j \frac{\omega}{\omega_{0}}\right) /\left(1+j \frac{\omega}{\omega_{0}}\right)$; $-2 \tan ^{-1}\left(\omega / \omega_{0}\right) ; 5.36 \mathrm{k} \Omega, 11.55 \mathrm{k} \Omega, 20 \mathrm{k} \Omega, 34.60 \mathrm{k} \Omega, 74.63 \mathrm{k} \Omega$.
$17.33 T(s)=10^{8} /\left(s^{2}+5000 s+10^{8}\right) ; 9.354 \mathrm{krad} / \mathrm{s}, 2.066$
$17.35 T(s)=s^{2} /\left(s^{2}+\sqrt{2} s+1\right)$; Zeros: two at $s=0$; Poles: $-0.707 \pm j 0.707$
$17.37 T(s)=\pi \times 10^{4} s /\left[s^{2}+\pi \times 10^{3} s+\left(2 \pi \times 10^{4}\right)^{2}\right]$ Zeros: $s=0$ and $s=\infty$; Poles: $1.57 \times 10^{3} \times(-1 \pm j 39.988)$
$17.39\left[s^{2}+(2 \pi \times 60)^{2}\right] /\left[s^{2}+s(2 \pi \times 60)+(2 \pi \times 60)^{2}\right]$
$17.42 T(s)=(1 / L C) /\left[s^{2}+s / C R+(1 / L C)\right]$
17.44 (a) $-0.5 \%$; (b) $-0.5 \%$; (c) no change
$17.46 s^{2} /\left(s^{2}+\frac{1}{C R}+\frac{1}{L C}\right)$
$17.49 V_{o}=\left[s^{2} V_{y}+s\left(\frac{\omega_{0}}{Q}\right) V_{z}+\omega_{0}^{2} V_{x}\right)\right] /\left[s^{2}+s\left(\frac{\omega_{0}}{Q}\right)+\omega_{0}^{2}\right]$
$17.51 R_{1}=R_{2}=R_{3}=10 \mathrm{k} \Omega$; (a) $C_{4}=0.15 \mu \mathrm{~F}$; (b) $C_{4}=15 \mathrm{nF}$; (c) $C_{4}=1.5 \mathrm{nF}$
17.55 First-order section (Fig. 17.13a): $R_{1}=R_{2}=100 \mathrm{k} \Omega, C=10 \mathrm{nF}$; Second-order section (Fig. 17.22a): $C_{4}=C_{6}=10 \mathrm{nF}, R_{1}=R_{2}=R_{3}=R_{5}=100 \mathrm{k} \Omega, R_{6}=161.8 \mathrm{k} \Omega, K=1$; Second-order section (Fig. 17.22a): $C_{4}=C_{6}=10 \mathrm{nF}, R_{1}=R_{2}=R_{3}=R_{5}=100 \mathrm{k} \Omega$, $R_{6}=61.8 \mathrm{k} \Omega, K=1$
$17.57 C_{4}=C_{6}=1 \mathrm{nF}, R_{1}=R_{2}=R_{3}=R_{5}=79.6 \mathrm{k} \Omega, R_{6}=159.2 \mathrm{k} \Omega, r_{1}=r_{2}=10 \mathrm{k} \Omega$
17.60 (b) First-order section: $C=1 \mathrm{nF}, R_{1}=R_{2}=13.71 \mathrm{k} \Omega$, Second-order LPN section: $R_{1}=R_{2}=R_{3}=R_{5}=9.76 \mathrm{k} \Omega, C_{61}=618 \mathrm{pF}, C_{62}=382 \mathrm{pF}, R_{6}=35.9 \mathrm{k} \Omega, K=1$
17.62 (b) $C=1 \mathrm{nF}, R=10 \mathrm{k} \Omega, R_{1}=10 \mathrm{k} \Omega, R_{f}=10 \mathrm{k} \Omega, R_{2}=10 \mathrm{k} \Omega, R_{3}=70 \mathrm{k} \Omega$, $R_{L}=R_{H}=10 \mathrm{k} \Omega, R_{B}=40 \mathrm{k} \Omega, R_{F}=57.1 \mathrm{k} \Omega$
$17.641 \%$
17.67 (b) First-order section: $C=1 \mathrm{nF}, R_{1}=R_{2}=13.71 \mathrm{k} \Omega$, Second-order LPN section: $C=1 \mathrm{nF}, R=9.76 \mathrm{k} \Omega, R_{d}=35.9 \mathrm{k} \Omega, r=10 \mathrm{k} \Omega, C_{1}=618 \mathrm{pF}, R_{1}=R_{3}=\infty$, $R_{2}=9.76 \mathrm{k} \Omega$
$17.71 \omega_{0}=6 / C R, Q=3$, Center-frequency gain $=-18 \mathrm{~V} / \mathrm{V}$.
17.73 (a) $Q^{2}$; (b) $2 Q^{2}$
17.75 (b) Second-order section [Fig. 17.34(c)]: $R_{1}=R_{2}=10 \mathrm{k} \Omega, C_{3}=492 \mathrm{pF}, C_{4}=5.15 \mathrm{nF}$; Second-order section [Fig. 17.34(c)]: $R_{1}=R_{2}=10 \mathrm{k} \Omega, C_{3}=1.29 \mathrm{nF}, C_{4}=1.97 \mathrm{nF}$; First-order section (Fig. 17.13a): $R_{1}=R_{2}=10 \mathrm{k} \Omega, C=1.59 \mathrm{nF}$
$17.77 S_{L}^{\omega_{0}}=-\frac{1}{2}, S_{C}^{\omega_{0}}=-\frac{1}{2}, S_{R}^{\omega_{0}}=0 ; S_{L}^{Q}=-\frac{1}{2}, S_{C}^{Q}=\frac{1}{2}, S_{R}^{Q}=1$
$17.79 S_{A}^{\omega_{0}}=0, S_{A}^{Q}=2 Q^{2} / A$
$17.81 S_{C_{4}}^{\omega_{0}}=S_{C_{6}}^{\omega_{0}}=S_{R_{1}}^{\omega_{0}}=S_{R_{3}}^{\omega_{0}}=S_{R_{5}}^{\omega_{0}}=-\frac{1}{2}, S_{R_{2}}^{\omega_{0}}=+\frac{1}{2}, S_{R_{6}}^{Q}=+1, S_{C_{6}}^{Q}=S_{R_{2}}^{Q}=+\frac{1}{2}$, $S_{C_{4}}^{Q}=S_{R_{1}, R_{2}, R_{3}}^{Q}=-\frac{1}{2}$,
$17.831 \mathrm{~mA} / \mathrm{V} ; 0.99 \mathrm{k} \Omega$
$17.850 .314 \mathrm{~mA} / \mathrm{V}$
$17.87 G_{m 1}=2.51 \mathrm{~mA} / \mathrm{V} ; G_{m 2}=0.251 \mathrm{~mA} / \mathrm{V}$
$17.90 C_{1}=Q^{2} C ; G_{m}=\omega_{0} Q C$
$17.92 G_{m}=0.785 \mathrm{~mA} / \mathrm{V} ; G_{m 2}=0.785 \mathrm{~mA} / \mathrm{V} ; G_{m 3}=0.157 \mathrm{~mA} / \mathrm{V} ; G_{m 4}=0.785 \mathrm{~mA} / \mathrm{V}$
$17.941 \mathrm{pC} ; 0.1 \mu \mathrm{~A} ; 0.1 \mathrm{~V} ; 100$ cycles; $10^{4} \mathrm{~V} / \mathrm{s}$
$17.96 C_{3}=C_{4}=6.283 \mathrm{pF} ; C_{5}=0.126 \mathrm{pF} ; C_{6}=0.126 \mathrm{pF}$
$17.9880 .3 \mathrm{rad} / \mathrm{s} ; 83 ; 967 \mathrm{kHz} ; 66.7 \mathrm{~V} / \mathrm{V}$
$17.100838 .8 \mathrm{kHz} ; 47.4$
$17.103 A(\mathrm{~dB}): 7,8.5,9.3,9.8,10.1 ; W / B: 31.6,8.6,5.9,4.9,4.5$

# CHAPTER 18 

$18.1 \omega_{0} ; A K=1$
18.3 (a) $1 ;$ (b) 2
$18.50 .6 \mathrm{~mA} / \mathrm{V} ; 15.92 \mathrm{MHz}$
$18.7120^{\circ} ; \omega_{0}=\sqrt{3} / C R ; 2 / R$
$18.11 \omega_{0}=1 / C R ; Q=1 / 3 ;$ Gain $=1 / 3$
$18.13 \omega_{0}=1 / C R ; Q=1 /\left(2-\frac{R_{2}}{R_{1}}\right)$
$18.15 \omega_{0}=1 / C R ; R_{2} / R_{1} \geq 2$
18.177 .88 V
$18.19 f_{0}=406 \mathrm{~Hz} ; R_{f}=290 \mathrm{k} \Omega$
$18.229 .95 \mathrm{k} \Omega ; 3.6 \mathrm{~V}$; add a diode in series with each of the limiter diodes.
$18.24 \omega_{0}=1 / \sqrt{L\left(\frac{C_{1} C_{2}}{C_{1}+C_{2}}\right)}$; simplified condition: $g_{m} R_{L}>\frac{C_{2}}{C_{1}}$
18.26 $\omega_{0}=1 / \sqrt{L\left(\frac{C_{1} C_{2}}{C_{1}+C_{2}}\right)} ; g_{m} R_{L}^{\prime}>\frac{C_{1}}{C_{2}}$
18.28 (b) $\omega_{0}=1 / \sqrt{L C} ; I R_{C}>0.1 \mathrm{~V}$, (c) $(4 / \pi) \mathrm{V}$
18.302 .0165 MHz to 2.0173 MHz , a range of 800 Hz .
18.32 (a) $V_{T H}=\left(\frac{L_{+}}{R_{2}}+\frac{V}{R_{3}}\right)\left(R_{1}\left\|R_{2}\right\| R_{3}\right) ; V_{T L}=\left(\frac{L_{-}}{R_{2}}+\frac{V}{R_{3}}\right)\left(R_{1}\left\|R_{2}\right\| R_{3}\right)$;
(b) $R_{2}=656.7 \mathrm{k} \Omega, R_{3}=19.7 \mathrm{k} \Omega$
18.36 (a) Output will be either +12 V or -12 V ; (b) The output is a symmetric square wave $( \pm 12 \mathrm{~V})$ of frequency $f$ and it lags the sine wave by an angle of $65.4^{\circ} ; 0.1 \mathrm{~V}$.
18.381989 Hz
$18.40 V_{Z}=3.6 \mathrm{~V} ; R_{1}=R=25 \mathrm{k} \Omega ; R_{3}=5.83 \mathrm{k} \Omega ; C=0.01 \mu \mathrm{~F} ; R=25 \mathrm{k} \Omega$
18.42 $96 \mu \mathrm{~s}$
$18.44 C_{1}=1 \mathrm{nF}, C_{2}=0.1 \mathrm{nF}, R_{1}=R_{2}=100 \mathrm{k} \Omega, R_{3}=134.1 \mathrm{k} \Omega, R_{4}=470 \mathrm{k} \Omega ; 5.8 \mathrm{~V}$; $61.8 \mu \mathrm{~s}$
18.46 (a) $18.2 \mathrm{k} \Omega$; (b) 10.67 V
18.48 (b) $100.6 \mathrm{kHz}, 75 \%$; (c) $15.6 \mu \mathrm{~s}, 55.2 \mathrm{kHz}, 86.2 \% ; 3.90 \mu \mathrm{~s}, 156 \mathrm{kHz}, 61 \%$
18.501 .85 V# Example 3.2 continued 

The concentration of the minority holes is

$$
p_{n} \simeq \frac{n_{i}^{2}}{N_{D}}
$$

In Example 3.1 we found that at $T=300 \mathrm{~K}, n_{i}=1.5 \times 10^{10} / \mathrm{cm}^{3}$. Thus,

$$
\begin{aligned}
p_{n} & =\frac{\left(1.5 \times 10^{10}\right)^{2}}{10^{17}} \\
& =2.25 \times 10^{3} / \mathrm{cm}^{3}
\end{aligned}
$$

Observe that $n_{n} \gg n_{i}$ and that $n_{n}$ is vastly higher than $p_{n}$.

## EXERCISES

3.2 For the situation in Example 3.2, find the electron and hole concentrations at 350 K . You may use the value of $n_{i}$ at $T=350 \mathrm{~K}$ found in Exercise 3.1.
Ans. $n_{n}=10^{17} / \mathrm{cm}^{3}, p_{n}=1.72 \times 10^{6} / \mathrm{cm}^{3}$
3.3 For a silicon crystal doped with boron, what must $N_{A}$ be if at $T=300 \mathrm{~K}$ the electron concentration drops below the intrinsic level by a factor of $10^{6}$ ?
Ans. $N_{A}=1.5 \times 10^{10} / \mathrm{cm}^{3}$

### 3.3 Current Flow in Semiconductors

There are two distinctly different mechanisms for the movement of charge carriers and hence for current flow in semiconductors: drift and diffusion.

### 3.3.1 Drift Current

When an electrical field $E$ is established in a semiconductor crystal, holes are accelerated in the direction of $E$, and free electrons are accelerated in the direction opposite to that of $E$. This situation is illustrated in Fig. 3.5. The holes acquire a velocity $v_{p \text {-drift }}$ given by

$$
v_{p \text {-drift }}=\mu_{p} E
$$

where $\mu_{p}$ is a constant called the hole mobility: It represents the degree of ease by which holes move through the silicon crystal in response to the electrical field $E$. Since velocity has the units of centimeters per second and $E$ has the units of volts per centimeter, we see from Eq. (3.8) that the mobility $\mu_{p}$ must have the units of centimeters squared per volt-second $\left(\mathrm{cm}^{2} / \mathrm{V} \cdot \mathrm{s}\right)$. For intrinsic silicon $\mu_{p}=480 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$.


Figure 3.5 An electric field $E$ established in a bar of silicon causes the holes to drift in the direction of $E$ and the free electrons to drift in the opposite direction. Both the hole and electron drift currents are in the direction of $E$.

The free electrons acquire a drift velocity $v_{n \text {-drift }}$ given by

$$
v_{n \text {-drift }}=-\mu_{n} E
$$

where the result is negative because the electrons move in the direction opposite to $E$. Here $\mu_{n}$ is the electron mobility, which for intrinsic silicon is about $1350 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$. Note that $\mu_{n}$ is about 2.5 times $\mu_{p}$, signifying that electrons move with much greater ease through the silicon crystal than do holes.

Let's now return to the single-crystal silicon bar shown in Fig. 3.5. Let the concentration of holes be $p$ and that of free electrons $n$. We wish to calculate the current component due to the flow of holes. Consider a plane perpendicular to the $x$ direction. In one second, the hole charge that crosses that plane will be ( $A q p v_{p \text {-drift }}$ ) coulombs, where $A$ is the cross-sectional area of the silicon bar and $q$ is the magnitude of electron charge. This then must be the hole component of the drift current flowing through the bar,

$$
I_{p}=A q p v_{p \text {-drift }}
$$

Substituting for $v_{p \text {-drift }}$ from Eq. (3.8), we obtain

$$
I_{p}=A q p \mu_{p} E
$$

We are usually interested in the current density $J_{p}$, which is the current per unit crosssectional area,

$$
J_{p}=\frac{I_{p}}{A}=q p \mu_{p} E
$$

The current component due to the drift of free electrons can be found in a similar manner. Note, however, that electrons drifting from right to left result in a current component from left to right. This is because of the convention of taking the direction of current flow as the direction of flow of positive charge and opposite to the direction of flow of negative charge. Thus,

$$
I_{n}=-A q n v_{n \text {-drift }}
$$

Substituting for $v_{n \text {-drift }}$ from Eq. (3.9), we obtain the current density $J_{n}=I_{n} / A$ as

$$
J_{n}=q n \mu_{n} E
$$

The total drift current density can now be found by summing $J_{p}$ and $J_{n}$ from Eqs. (3.11) and (3.12),

$$
J=J_{p}+J_{n}=q\left(p \mu_{p}+n \mu_{n}\right) E
$$

This relationship can be written as

$$
J=\sigma E
$$
or

$$
J=E / \rho
$$

where the conductivity $\sigma$ is given by

$$
\sigma=q\left(p \mu_{p}+n \mu_{n}\right)
$$

and the resistivity $\rho$ is given by

$$
\rho \equiv \frac{1}{\sigma}=\frac{1}{q\left(p \mu_{p}+n \mu_{n}\right)}
$$

Observe that Eq. (3.15) is a form of Ohm's law and can be written alternately as

$$
\rho=\frac{E}{J}
$$

Thus the units of $\rho$ are obtained from: $\frac{\mathrm{V} / \mathrm{cm}}{\mathrm{A} / \mathrm{cm}^{2}}=\Omega \cdot \mathrm{cm}$.

# Example 3.3 

Find the resistivity of (a) intrinsic silicon and (b) $p$-type silicon with $N_{A}=10^{16} / \mathrm{cm}^{3}$. Use $n_{i}=1.5 \times$ $10^{10} / \mathrm{cm}^{2}$, and assume that for intrinsic silicon $\mu_{n}=1350 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$ and $\mu_{p}=480 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$, and for the doped silicon $\mu_{n}=1110 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$ and $\mu_{p}=400 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$. (Note that doping results in reduced carrier mobilities.)

## Solution

(a) For intrinsic silicon,

$$
p=n=n_{i}=1.5 \times 10^{10} / \mathrm{cm}^{3}
$$

Thus,

$$
\begin{aligned}
\rho & =\frac{1}{q\left(p \mu_{p}+n \mu_{n}\right)} \\
\rho & =\frac{1}{1.6 \times 10^{-19}\left(1.5 \times 10^{10} \times 480+1.5 \times 10^{10} \times 1350\right)} \\
& =2.28 \times 10^{5} \Omega \cdot \mathrm{~cm}
\end{aligned}
$$

(b) For the $p$-type silicon

$$
\begin{aligned}
& p_{p} \simeq N_{A}=10^{16} / \mathrm{cm}^{3} \\
& n_{p} \simeq \frac{n_{i}^{2}}{N_{A}}=\frac{\left(1.5 \times 10^{10}\right)^{2}}{10^{16}}=2.25 \times 10^{4} / \mathrm{cm}^{3}
\end{aligned}
$$
Thus,

$$
\begin{aligned}
\rho & =\frac{1}{q\left(p \mu_{p}+n \mu_{n}\right)} \\
& =\frac{1}{1.6 \times 10^{-19}\left(10^{16} \times 400+2.25 \times 10^{4} \times 1110\right)} \\
& \simeq \frac{1}{1.6 \times 10^{-19} \times 10^{16} \times 400}=1.56 \Omega \cdot \mathrm{~cm}
\end{aligned}
$$

Observe that the resistivity of the $p$-type silicon is determined almost entirely by the doping concentration. Also observe that doping the silicon reduces its resistivity by a factor of about $10^{4}$, a truly remarkable change.

# EXERCISE 

3.4 A uniform bar of $n$-type silicon of $2-\mu \mathrm{m}$ length has a voltage of 1 V applied across it. If $N_{D}=$ $10^{16} / \mathrm{cm}^{2}$ and $\mu_{n}=1350 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$, find (a) the electron drift velocity, (b) the time it takes an electron to cross the $2-\mu \mathrm{m}$ length, (c) the drift-current density, and (d) the drift current in the case that the silicon bar has a cross-sectional area of $0.25 \mu \mathrm{~m}^{2}$.
Ans. $6.75 \times 10^{6} \mathrm{~cm} / \mathrm{s} ; 30 \mathrm{ps} ; 1.08 \times 10^{4} \mathrm{~A} / \mathrm{cm}^{2} ; 27 \mu \mathrm{~A}$

### 3.3.2 Diffusion Current

Carrier diffusion occurs when the density of charge carriers in a piece of semiconductor is not uniform. For instance, if by some mechanism the concentration of, say, holes, is made higher in one part of a piece of silicon than in another, then holes will diffuse from the region of high concentration to the region of low concentration. Such a diffusion process is like that observed if one drops a few ink drops in a water-filled tank. The diffusion of charge carriers gives rise to a net flow of charge, or diffusion current.

As an example, consider the bar of silicon shown in Fig. 3.6(a): By some unspecified process, we have arranged to inject holes into its left side. This continuous hole injection gives rise to and maintains a hole concentration profile such as that shown in Fig. 3.6(b). This profile in turn causes holes to diffuse from left to right along the silicon bar, resulting in a hole current in the $x$ direction. The magnitude of the current at any point is proportional to the slope of the concentration profile, or the concentration gradient, at that point,

$$
J_{p}=-q D_{p} \frac{d p(x)}{d x}
$$


Figure 3.6 A bar of silicon (a) into which holes are injected, thus creating the hole concentration profile along the $x$ axis, shown in (b). The holes diffuse in the positive direction of $x$ and give rise to a hole diffusion current in the same direction. Note that we are not showing the circuit to which the silicon bar is connected.



Figure 3.7 If the electron concentration profile shown is established in a bar of silicon, electrons diffuse in the $x$ direction, giving rise to an electron diffusion current in the negative- $x$ direction.
where $J_{p}$ is the hole-current density $\left(\mathrm{A} / \mathrm{cm}^{2}\right), q$ is the magnitude of electron charge, $D_{p}$ is a constant called the diffusion constant or diffusivity of holes; and $p(x)$ is the hole concentration at point $x$. Note that the gradient $(d p / d x)$ is negative, resulting in a positive current in the $x$ direction, as should be expected.

In the case of electron diffusion resulting from an electron concentration gradient (see Fig. 3.7), a similar relationship applies, giving the electron-current density,

$$
J_{n}=q D_{n} \frac{d n(x)}{d x}
$$

where $D_{n}$ is the diffusion constant or diffusivity of electrons. Observe that a negative ( $d n / d x$ ) gives rise to a negative current, a result of the convention that the positive direction of current is taken to be that of the flow of positive charge (and opposite to that of the flow of negative
charge). For holes and electrons diffusing in intrinsic silicon, typical values for the diffusion constants are $D_{p}=12 \mathrm{~cm}^{2} / \mathrm{s}$ and $D_{n}=35 \mathrm{~cm}^{2} / \mathrm{s}$.

At this point the reader is probably wondering where the diffusion current in the silicon bar in Fig. 3.6(a) goes. A good question, as we are not showing how the right-side end of the bar is connected to the rest of the circuit. We will address this and related questions in detail in our discussion of the $p n$ junction in later sections.

# Example 3.4 

Consider a bar of silicon in which a hole concentration profile described by

$$
p(x)=p_{0} e^{-x / L_{p}}
$$

is established. Find the hole-current density at $x=0$. Let $p_{0}=10^{19} / \mathrm{cm}^{3}, L_{p}=1 \mu \mathrm{~m}$, and $D_{p}=12 \mathrm{~cm}^{2} / \mathrm{s}$. If the cross-sectional area of the bar is $100 \mu \mathrm{~m}^{2}$, find the current $I_{p}$.

## Solution

Thus,

$$
\begin{aligned}
J_{p} & =-q D_{p} \frac{d p(x)}{d x} \\
& =-q D_{p} \frac{d}{d x}\left[p_{0} e^{-x / L_{p}}\right] \\
& =q \frac{D_{p}}{L_{p}} p_{0} e^{-x / L_{p}}
\end{aligned}
$$

The current $I_{p}$ can be found from

$$
\begin{aligned}
I_{p} & =J_{p} \times A \\
& =192 \times 100 \times 10^{-8} \\
& =192 \mu \mathrm{~A}
\end{aligned}
$$

## EXERCISE

3.5 The linear electron-concentration profile shown in Fig. E3.5 has been established in a piece of silicon. If $n_{0}=10^{17} / \mathrm{cm}^{3}$ and $W=1 \mu \mathrm{~m}$, find the electron-current density in microamperes per micron squared $\left(\mu \mathrm{A} / \mu \mathrm{m}^{2}\right)$. If a diffusion current of 1 mA is required, what must the cross-sectional area (in a direction perpendicular to the page) be? Recall that $D_{n}=35 \mathrm{~cm}^{2} / \mathrm{s}$.


Figure E3.5

Ans. $56 \mu \mathrm{~A} / \mu \mathrm{m}^{2} ; 18 \mu \mathrm{~m}^{2}$

# 3.3.3 Relationship between $D$ and $\mu$ 

A simple but powerful relationship ties the diffusion constant with the mobility,

$$
\frac{D_{n}}{\mu_{n}}=\frac{D_{p}}{\mu_{p}}=V_{T}
$$

where $V_{T}=k T / q$. The parameter $V_{T}$ is known as the thermal voltage. At room temperature, $T \simeq 300 \mathrm{~K}$ and $V_{T}=25.9 \mathrm{mV}$. We will encounter $V_{T}$ repeatedly throughout this book. The relationship in Eq. (3.21) is known as the Einstein relationship.

## EXERCISE

3.6 Use the Einstein relationship to find $D_{n}$ and $D_{p}$ for intrinsic silicon using $\mu_{n}=1350 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$ and $\mu_{p}=480 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$.
Ans. $35 \mathrm{~cm}^{2} / \mathrm{s} ; 12.4 \mathrm{~cm}^{2} / \mathrm{s}$

### 3.4 The pn Junction

Having learned important semiconductor concepts, we are now ready to consider our first practical semiconductor structure-the $p n$ junction. As mentioned previously, the $p n$ junction implements the diode (Chapter 4) and plays the dominant role in the structure and operation of the bipolar junction transistor (BJT, Chapter 6). As well, understanding $p n$ junctions is very important to the study of the MOSFET operation (Chapter 5).


Figure 3.8 Simplified physical structure of the $p n$ junction. (Actual geometries are given in Appendix A.) As the $p n$ junction implements the junction diode, its terminals are labeled anode and cathode.

# 3.4.1 Physical Structure 

Figure 3.8 shows a simplified physical structure of the $p n$ junction. It consists of a $p$-type semiconductor (e.g., silicon) brought into close contact with an $n$-type semiconductor material (also silicon). In actual practice, both the $p$ and $n$ regions are part of the same silicon crystal; that is, the $p n$ junction is formed within a single silicon crystal by creating regions of different dopings ( $p$ and $n$ regions). Appendix A provides a description of the fabrication process of integrated circuits including $p n$ junctions. As indicated in Fig. 3.8, external wire connections are made to the $p$ and $n$ regions through metal (aluminum) contacts. If the $p n$ junction is used as a diode, these constitute the diode terminals and are therefore labeled "anode" and "cathode" in keeping with diode terminology. ${ }^{3}$

### 3.4.2 Operation with Open-Circuit Terminals

Figure 3.9 shows a $p n$ junction under open-circuit conditions-that is, the external terminals are left open. The " + " signs in the $p$-type material denote the majority holes. The charge of these holes is neutralized by an equal amount of bound negative charge associated with the acceptor atoms. For simplicity, these bound charges are not shown in the diagram. Also not shown are the minority electrons generated in the $p$-type material by thermal ionization.

In the $n$-type material the majority electrons are indicated by "-" signs. Here also, the bound positive charge, which neutralizes the charge of the majority electrons, is not shown in order to keep the diagram simple. The $n$-type material also contains minority holes generated by thermal ionization but not shown in the diagram.

The Diffusion Current $I_{D}$ Because the concentration of holes is high in the $p$ region and low in the $n$ region, holes diffuse across the junction from the $p$ side to the $n$ side. Similarly, electrons diffuse across the junction from the $n$ side to the $p$ side. These two current components add together to form the diffusion current $I_{D}$, whose direction is from the $p$ side to the $n$ side, as indicated in Fig. 3.9.

The Depletion Region The holes that diffuse across the junction into the $n$ region quickly recombine with some of the majority electrons present there and thus disappear from the scene. This recombination process results also in the disappearance of some free electrons from the

[^0]
[^0]:    ${ }^{3}$ This terminology in fact is a carryover from that used with vacuum-tube technology, which was the technology for making diodes and other electronic devices until the invention of the transistor in 1947. This event ushered in the era of solid-state electronics, which changed not only electronics, communications, and computers but indeed the world!


Figure 3.9 (a) The $p n$ junction with no applied voltage (open-circuited terminals). (b) The potential distribution along an axis perpendicular to the junction.
$n$-type material. Thus some of the bound positive charge will no longer be neutralized by free electrons, and this charge is said to have been uncovered. Since recombination takes place close to the junction, there will be a region close to the junction that is depleted of free electrons and contains uncovered bound positive charge, as indicated in Fig. 3.9.

The electrons that diffuse across the junction into the $p$ region quickly recombine with some of the majority holes there, and thus disappear from the scene. This results also in the disappearance of some majority holes, causing some of the bound negative charge to be uncovered (i.e., no longer neutralized by holes). Thus, in the $p$ material close to the junction, there will be a region depleted of holes and containing uncovered bound negative charge, as indicated in Fig. 3.9.

From the above it follows that a carrier-depletion region will exist on both sides of the junction, with the $n$ side of this region positively charged and the $p$ side negatively charged. This carrier-depletion region-or, simply, depletion region-is also called the space-charge region. The charges on both sides of the depletion region cause an electric field $E$ to be established across the region in the direction indicated in Fig. 3.9. Hence a potential difference results across the depletion region, with the $n$ side at a positive voltage relative to the $p$ side, as shown in Fig. 3.9(b). Thus the resulting electric field opposes the diffusion of holes into the $n$ region and electrons into the $p$ region. In fact, the voltage drop across the depletion region acts as a barrier that has to be overcome for holes to diffuse into the $n$ region and electrons to diffuse into the $p$ region. The larger the barrier voltage, the smaller the number of carriers that will be able to overcome the barrier, and hence the lower the magnitude of diffusion current. Thus it is the appearance of the barrier voltage $V_{0}$ that limits the carrier diffusion process. It follows that the diffusion current $I_{D}$ depends strongly on the voltage drop $V_{0}$ across the depletion region.
The Drift Current $I_{S}$ and Equilibrium In addition to the current component $I_{D}$ due to majority-carrier diffusion, a component due to minority-carrier drift exists across the junction. Specifically, some of the thermally generated holes in the $n$ material move toward the junction and reach the edge of the depletion region. There, they experience the electric field in the depletion region, which sweeps them across that region into the $p$ side. Similarly, some of the minority thermally generated electrons in the $p$ material move to the edge of the depletion region and get swept by the electric field in the depletion region across that region into the $n$ side. These two current components-electrons moved by drift from $p$ to $n$ and holes moved by drift from $n$ to $p$-add together to form the drift current $I_{S}$, whose direction is from the $n$ side to the $p$ side of the junction, as indicated in Fig. 3.9. Since the current $I_{S}$ is carried by thermally generated minority carriers, its value is strongly dependent on temperature; however, it is independent of the value of the depletion-layer voltage $V_{0}$. This is due to the fact that the drift current is determined by the number of minority carriers that make it to the edge of the depletion region; any minority carriers that manage to get to the edge of the depletion region will be swept across by $E$ irrespective of the value of $E$ or, correspondingly, of $V_{0}$.

Under open-circuit conditions (Fig. 3.9) no external current exists; thus the two opposite currents across the junction must be equal in magnitude:

$$
I_{D}=I_{S}
$$

This equilibrium condition ${ }^{4}$ is maintained by the barrier voltage $V_{0}$. Thus, if for some reason $I_{D}$ exceeds $I_{S}$, then more bound charge will be uncovered on both sides of the junction, the depletion layer will widen, and the voltage across it $\left(V_{0}\right)$ will increase. This in turn causes $I_{D}$ to decrease until equilibrium is achieved with $I_{D}=I_{S}$. On the other hand, if $I_{S}$ exceeds $I_{D}$, then the amount of uncovered charge will decrease, the depletion layer will narrow, and the voltage across it $\left(V_{0}\right)$ will decrease. This causes $I_{D}$ to increase until equilibrium is achieved with $I_{D}=I_{S}$.

The Junction Built-in Voltage With no external voltage applied, the barrier voltage $V_{0}$ across the $p n$ junction can be shown to be given by ${ }^{5}$

$$
V_{0}=V_{T} \ln \left(\frac{N_{A} N_{D}}{n_{i}^{2}}\right)
$$

where $N_{A}$ and $N_{D}$ are the doping concentrations of the $p$ side and $n$ side of the junction, respectively. Thus $V_{0}$ depends both on doping concentrations and on temperature. It is known as the junction built-in voltage. Typically, for silicon at room temperature, $V_{0}$ is in the range of 0.6 V to 0.9 V .

When the $p n$ junction terminals are left open-circuited, the voltage measured between them will be zero. That is, the voltage $V_{0}$ across the depletion region does not appear between the junction terminals. This is because of the contact voltages existing at the metal-semiconductor junctions at the terminals, which counter and exactly balance the barrier voltage. If this were not the case, we would have been able to draw energy from the isolated $p n$ junction, which would clearly violate the principle of conservation of energy.

Width of and Charge Stored in the Depletion Region Figure 3.10 provides further illustration of the situation that obtains in the $p n$ junction when the junction is in equilibrium.

[^0]
[^0]:    ${ }^{4}$ In fact, in equilibrum the equality of drift and diffusion currents applies not just to the total currents but also to their individual components. That is, the hole drift current must equal the hole diffusion current and, similarly, the electron drift current must equal the electron diffusion current.
    ${ }^{5}$ The derivation of this formula and of a number of others in this chapter can be found in textbooks dealing with devices, such as that by Streetman and Bannerjee (see the reading list in Appendix I).# INDEX 

References marked $\mathbf{P}$ are study Problems; $\mathbf{S}$ are points in the chapter Summaries; Appendix pages found in the book or on the website are shown as B17; and Additional Material found on the website is AM1.

## Numbers

1N4148 model, B19n2, B75
2-port network. See Two-port network
2-input NAND gate. See Two-input NAND gate
2-input NOR gate. See Two-input NOR gate
2-integrator-loop biquad. See Two-integrator-loop biquad
2-integrator-loop topology. See Two-integratorloop topology
2-stage CMOS op amp. See Two-stage CMOS op amp
3-dB frequency, 788S
bandwidth, 477, 478, 505P
determining, 704-705, 740-741
open-circuit time constants, 744-746
short-circuit time constants, 707
single-time-constant (STC) network, 36, 37, 38, 726
555 integrated circuit (IC), 1419-1420
555 timer, 1419, 1428S
astable multivibrator using, 1420, 1422, 1423
monostable multivibrator using, 1420, 1421
6 T cell, 1254
741 BJT op amp, 1028-1054, 1073-1074S, 1078-1083P
bias circuit, 1028
circuit (741), 1028-1031
characteristics of, B15-B18
dc analysis, 1032-1037
device parameters, 1031
frequency response, 1051-1053
input common-mode range, 1035
input stage, 1029, 1030, 1038-1041
input-stage bias, 1032-1034
output short-circuit protection, 1050
output stage, 1029, 1031, 1047-1049
output-stage bias, 1035-1036
overall voltage gain, 1050-1051
P5pice example, B15-B18
reference bias current, 1032
second stage, 1029, 1030-1031, 1045-1046
second-stage bias, 1035
short-circuit-protection circuitry, 1028
simplified model, 1052-1053
slew rate, 1053-1054
small-signal analysis, 1038-1051

## A

Abrupt junction, 165
Absolute-value circuit, AM74
Ac amplifier, 42
Accept, 140
Acceptor, 140
Access transistor, 1253, 1260
Ac circuit, 48P
Ac ground, 467
Active-filter design, 883

Active-filter-tuned oscillator, 1394-1395, 1396, B77-B79
Active loaded, 525
Active mode
BJT, 306, 307
NMOS and $n p n$ transistor, G4, G6
operation of $n p n$ transistor in, 307-313
Active model, BJT current-voltage relationships, 322
Active pixel sensory (APS), 1281
Active pull-down, AM31
Active pull-up, AM31
Active-RC filter, 1292
Ac voltages, precision rectifier circuits, AM71-AM72
ADC (analog-to-digital converter), 14, 44S
Address decoder, 1286-1287P
column-, 1273-1274
row-, 1271-1272
sense amplifiers and, 1262-1276, 1286-1287P
Admittance, 34, 1316, 1362
Advanced logic circuit
BiCMOS digital, 1181-1182, AM65-AM66
CMOS (complementary MOS), 1090-1098, 1154S, 1156-1157P
dynamic MOS, 1208-1217, 1233P
emitter-coupled logic (ECL), 1218-1223, 1227S, 1234P, AM47-AM62, AM67-AM68P
pass-transistor, 1192-1208, 1227S, 1230-1233P
pseudo-NMOS, 1183-1192, 1227S, 1229-1230P
All pass (AP), 36
first-order filter, 1310
second-order filtering, 1315
All-pass circuit, second-order active filter, 1325, 1329
All-pass filter, 1308
All-pass function, realization of, 1318, 1321
All-pole filter, 1299
Aluminum gallium nitride (AlGaN), A1
Amount of feedback, 808, 809
Amplification, 3
Amplifier, 3, 50P. See also Integrated-circuit (IC) amplifier; Transistor amplifier; Wideband amplifier configurations
amplifier circuit symbol, 16,17
amplifier power supplies, 18-20
BJT differential pair, 614-627
bridge, 966
cascode differential, 612-613
CB (common-base), 473-474, 537-546
CC (common-collector), 423, 424
CC-CB, 572-573
CC-CE, 567-569
CD-CE, 567-569
CD-CG, 572-573
CD-CS, 567-569
CE (common-emitter),428-429, 431
CE with emitter resistance, 431-437

CG (common-gate), 423, 424, 479S, 575S, 583-585P
characterizing, 424-426
circuit models for, 23-27, 50-54P
class D power, 967-970
common source (CS), 421, 427-428, 467-469
current gain, 17-18
examples of series-shunt feedback, 821-822
expressing gain in decibels, 18
feedback voltage, 820-828, 899-901P
folded-cascode amplifier, B43-B46
frequency response of, 33-42, 54-57P
gallium arsenide (GaAs), AM11-AM19
IC power, 961-966
MOS differential pair, 596-613
multistage, 659-672
power gain, 17-18
saturation, 21
signal amplification, 15-16
symbol convention, 22
tuned, 1359-1368, 1369S, 1377P
voltage gain, 17
Amplifier bandwidth, 34
Amplifier circuit symbol, 16, 17
Amplifier frequency response, 477-478
Amplifier gain, 16
Amplifier pole
characteristic equation, 876
effect of feedback on, 875-884, 917-918P
single-pole response, 877-878
stability and pole location, 875-876
three or more poles, 883-884
two-pole response, 878-883
Amplifier saturation, 21
Amplifier transmission, 33
Amplitude control
nonlinear, for sinusoidal oscillator, 1385
popular limiter circuit for, 1386-1388
Amplitude response, 33-34
Analog circuit, 12
Analog computation, 88
Analog filter, 1295
Analog signal, 12, 12-15, 44S, 49-50P
Analog-to-digital converter (A/D or ADC), 14, 44 S
Analog vs. digital circuit engineers, 15
Anisotropic etching, A4
Anode, 176
Antoniou inductance-simulation circuit, 1322-1323
Aspect ratio, 254
Astable, 1380
Astable multivibrator, 1412, 1412-1416, 1428S, 1434P
generation of triangular waveforms, 1415-1416
operation of, 1413-1414
using 555 IC, 1420, 1422, 1423
Atalla, Martin, 248
Attenuating, 18
Attenuation function, 1292
Audio band, 11
Autotransformer, 1363
Avalanche effect, 163

## B

Back gate, 397
Balanced, 608, 624
Bandgap energy, 138
Bandpass (BP), 1293, 1294
second-order filtering, 1313
Bandpass amplifier, 43
Bandpass filter, 43
Bandpass function, realization of, 1318, 1319
Bandstop (BS), 1293, 1294
Bandwidth, 478
3dB frequency, 477, 478, 505P amplifier, 34
circuit performance, 105-109, 132-133P full power, 114-115, 116S unity gain, 106, 720
Bandwidth extension, negative feedback, 816-817
Bandwidth-dirinkage factor, 1367
Bardeen, John, 320, 405
Barkhausen, Heinrich Georg, 1400
Barkhausen criterion, 1381
Barrier, 150
Base (B), 30, 306, 307
Base-charging capacitance, 717
Base current, $n p n$ transistor in active mode, 309
Base-current compensation, bipolar mirror with, $522-523$
Base-emitter junction capacitance, 717
Base-width modulation effect, 327
Basic gain cell, 575S, 580-583P
CS and CE amplifier with current-source loads, $525-527$
increasing gain of, 536-537
intrinsic gain, 527-529, G9-G10
output resistance of current-source load, $530-531$
Bell Labs, 248, 320, 405, 875
Bias circuit
741 circuit, 1028
two-stage CMOS op amp, 1010-1012
Bias current
dependence of BJT $\beta$ on, B26-B27
Multisim example of dependence of $\beta$ on, B84-B85
Bias design, BJT op amp, 1056-1057
Biasing, 454-466, 479S, 493-497P
bipolar junction transistor (BJT) case, 461-466
BJT circuit, 518-523
class AB circuit, 940-944, 985-986P
classical discrete-circuit bias arrangement, $461-463$
fixing $V_{N}$ and connecting resistance in source, $455-457$
fixing $V_{N V}, 455$
integrated circuit, 511-525, 575S, 576-580P
MOS current-steering circuit, 515-517
MOSFET case, 455-460
MOSFET current source, 512-514
obtaining linear amplification by, 371-374
small-circuit operation of current mirrors, $523-525$
two-power-supply version of classical bias arrangement, 464-465
using a drain-to-gate feedback resistor, 460
using collector-to-base feedback resistor, $465-466$
using diodes, 940-941
using $V_{N V}$ multiplier, 942-944
Bias point, 371
BiCMOS (bipolar CMOS) technology, A1, G17
digital circuit, 1223-1226, 1227S, 1235P inverter, 1224-1226
logic-circuit family, 1181-1182 process, A12
BiCMOS digital circuit, AM62-AM66, AM68P
BiCMOS inverter, AM63-AM64
BiCMOS logic gates, AM65-AM66
dynamic operation, AM65
BiCMOS logic gates, AM65-AM66
Bilinear transfer function, 1308
Binary, 13
Bipolar, 306
Bipolar and BiCMOS logic circuit, 1217-1226, 1227S, 1234-1235P
Bipolar cascade amplifier, high-frequency response of, 759-760
Bipolar differential amplifier
common-mode gain, 655-657
common-mode rejection ratio (CMRR), $655-657$
common-mode resistance, 634-636
with current-mirror load, 651-654
input bias current, 643
input offset current, 643
input offset voltage of, 640-642
Bipolar differential pair, current-mirror load, $651-654$
Bipolar junction transistor. See BJT (bipolar junction transistor)
Bipolar junction transistor (BJT) cascode, $557-558$
Bipolar junction transistor (BJT) circuit bipolar mirror with base-current compensation, $522-523$
current steering, 521
integrated-circuit, 518-523
simple current source, 520
Bipolar mirror, BJT circuit, 522-523
Bipolar op amp, 664-672
analysis using current gains, 670-672
four-stage, 664
Bipolar technology, 511
logic-circuit family, 1181
Biquad, 1330, 1369S
Biquadratic, 1311
Bistable, 1239, 1380
Bistable circuit, 1238
Bistable multivibrator, 1404-1411, 1412-1413, 1428S, 1433P
application of bistable circuit as comparator, 1409-1411
feedback loop, 1405
making output levels more precise, 1411
memory element, 1407-1408
with noninverting transfer characteristics, 1408-1409
transfer characteristics of bistable circuit, 1406-1407
triggering bistable circuit, 1407
Bit lines, 1251
BJT (bipolar junction transistor), 30, 305-306
active mode, 322
alternative form of common-emitter characteristics, 329-331
amplifier, 3
base-charging or diffusion capacitance $C_{B c}, 717$
base current, 309
base-emitter junction capacitance $C_{J}$, 717
circuits at dc, 333-351, 360-365P
circuit symbols and conventions, 320-322
collector-base junction capacitance $C_{b c}, 718$
collector-base reverse current $\left(I_{C B r}\right), 322$
collector current, 309
common-emitter current gain $\beta, 329$
current flow, 308-309
current-voltage characteristics, 320-333, $357-360 P$
cutoff frequency, 719-721
dependence of $i_{c}$ on collector voltage, 326-329
design parameters, G6, G14
device structure, 306, 307, 315-316, 355-357P
Early effect, 326-329
emitter current, 309-310
equivalent-circuit models, 312-313
graphical representation of transistor characteristics, 325-326
high-frequency model of, 717-722, G6, G12-G13
invention, 320
minority-carrier distribution, 310-312
models for operation of, in dc circuits, 334
npn transistor, 306-308, G3, G4-G6, G8-G9
operation in saturation mode, 316-318
operation of $n p n$ transistor in active mode, $307-313$
physical operation, 306-320, 355-357P
pnp transistor, 318-320, G3
recapitulation, 312-313
saturation resistance, 329-331
saturation voltage, 329-331
structure of actual transistors, 315-316
temperature effects, 353-354
transistor breakdown, 351-353
values of BJT parameters, G3-G4, K1
BJT (bipolar junction transistor) amplifier, 3
base current and input resistance at base, 402-403
basis for operation, 368-369
biasing, 461-466
biasing using collector-to-base feedback resistor, 465-466
characteristics of, 453
classical discrete-circuit bias arrangement, $461-463$
collector current, 400-401
dc bias point, 399, 400
emitter current and input resistance at emitter, $403-404$
high-frequency model of, 717-722
hybrid- $\sigma$ model, 407-408
obtaining linear amplification by biasing transistor, 371-374
separating signal and dc quantities, 406-407
small-signal analysis on circuit diagram, 418-419
small-signal models of, 422, G8-G9
small-signal models of pnp transistor, 409
small-signal operation, 399-417
small-signal voltage gain, 377-378
T model, 408-409, 410, G5
transconductance, 400-401
two-power-supply version of bias arrangement, $464-465$
voltage gain, 405-406
BJT differential amplifier, common-mode rejection, 634-636
BJT differential pair, 614-627, 678-682P
basic operation, 614-616
collector currents with $v_{c l}$ is applied, 620-621
differential half-circuit, 624-625
differential voltage gain, 623-624
input common-mode range, 616-617
input differential resistance, 622-623
large-signal operation, 617-619
small-signal operation, 620-627
BJT model
parameters, B12
SPICE, B9-B12
SPICE BJT model parameters, B11-B12
SPICE Gummel-Poon model of BJT, B11
BJT op amp. See also 741 BJT op amp
bias design, 1056-1057
buffer/driver stage, 1069-1070
common-mode feedback to control dc voltage at output of input stage, 1064-1066
device parameters, 1056
input stage to obtain rail-to-rail $V_{R / M^{\prime}}$ 1058-1061
near rail-to-rail output signal swing, 1056
output-stage design for near rail-to-rail output swing, 1069-1073
performance requirements, 1054-1056
quiescent current $I_{c}$ and minimum current in inactive transistor, 1070-1073
rail-to-rail input common-mode range, 1055
techniques for, 1054-1073, 1074S, 1083-1085S
Black, Harold, 807, 823
Bode, Hendrik, 37
Bode plot, 36, 37
s-domain analysis, F3-F6
stability study using, 885-889, 918P
Body, 249
Body effect, 249, 288-289
common-gate (CG) amplifier, 542-543
MOSFET, 288-289, 303P, 397-398
Body-effect parameter, 289
Body transconductance, 397
Bootstrapped follower, 504P
Bootstrapping, AM13, AM14
Bound charge, 139
Brattain, Walter, 320, 405
Braun, Karl Ferdinand, 219, 823
Breakdown diodes, 202
Breakdown region, junction diodes, 190
Breakdown voltage, 190
Break frequency, 36
Breakpoint method, nonlinear waveform-shaping circuit, 1424-1426
Brick-wall, 1293
Bridge amplifier, 966
Bridge rectifier, 212-213
Bridge rectifier circuit, instrumentation, AM75
Bridge-rectifier diode, 230S
Buffer amplifier, 25
Buffer/driver stage, design of BJT op amp, 1069-1070
Buffered diode field-effect transistor (BFL) logic, AM26
Buffered precision peak detector, AM76 AM77
Bush, Vannevar, 1348
Butterworth filter, 1300-1303, 1304, 1368S, 1370-1371P, 105P
Bypass capacitor, 467
selecting values for, 705-706, 710

## C

Camenzind, Hans, 968
Capacitance multiplication, 735
Capacitive effects in $p n$ junction, 164-167, 173P
depletion or junction capacitance, 164-165
diffusion capacitance, 166-167
Capacitively coupled amplifier, 42, 467
Capacitor, 510, A10-A11
clamped, 224-226, 242-245P
common-source amplifier, 705-706
filter, 213-219
storage, 1260
switched-, filter, 1354-1359, 1369S, 1376-1377P
Carrier concentration in intrinsic silicon, 169
Carrier concentration in $n$-type silicon, 169
Carrier concentration in $p$-type silicon, 169
Carrier-depletion region, 150
Carrier transport, B10
Cascaded amplifier, 25-27, 83, 424, 426, 507, 659
Cascading dynamics logic gates, 1215
Cascade
cascaded cathode, 547
MOS mirror, 559-560
tuned amplifier, 1366
Cascade amplifier, 575S, 585-589P, 788-789S
BJT cascode, 557-558
cascoding, 546-547
distribution of voltage gain in, 552-554
double cascoding, 555
folded cascode, 555-556
high-frequency response of bipolar, 759-760, 798-799P
high-frequency response of MOS, 754-759, 798-799P
MOS cascode amplifier, 547-550, 554
Cascade current source, gallium arsenide (GaAs) amplifier, AM12-AM13
Cascade differential amplifier, 612-613
Cascoding, 546-547, 555
Cathode, 149, 176, 202, 227
Cat's whisker, 219
Cauer, Wilhelm, 1348
CB. See Common-base (CB) amplifier; Common-base (CB) circuit
CC. See Common-collector (CC) amplifier
CC-CB configuration
transistor pairing, 572-573
tuned amplifier, 1366
wideband amplification, 786-788
CC-CE configuration
transistor pairing, 567-569
wideband amplification, 781
CD. See Common drain (CD) amplifier
CD-CE configuration
transistor pairing, 567-569
wideband amplification, 781
CD-CG configuration
transistor pairing, 572-573
wideband amplification, 786-788
CD-CS configuration
transistor pairing, 567-569
wideband amplification, 781
CE. See Common-emitter (CE) amplifier
Center frequency, 43, 1311
Center-tapped, 210
CG. See Common-gate (CG) amplifier; Common-gate (CG) circuit
Channel, 251
Channel-length modulation, 271, B96
Channel-length modulation effect, $327 n$
Channel pinch-off, 258
Characteristic equation, 876, 1382
Charge sharing, dynamic MOS logic circuits, 1213-1214
Charge stored in depletion layer, 151, 153, 170
Chebyshev filter, 1304-1306, 1368S, 1370-1371P
design of fifth-order, B69-B71
Chemical vapor deposition (CVD), IC fabrication, A5-A6
Chip power dissipation, G2n

Circuit, 45P
clamped capacitor, 224-226, 242-245P
DC restorer, 224-226
design data, 1328, 1335
folded-cascade CMOS op amp, 1016-1018
limiter, 221-224, 242-245P
MOSFET, at dc, 276-287, 299-303P
nonlinear waveform-shaping, 1424-1427, 1435-1436P
rectifier, 207-220
two-stage CMOS op amp, 997-998
Circuit analysis, 47P
Circuit ground, 16, 17
Circuit model
amplifiers, 50-54P
cascaded amplifier, 25-27
determining R, and $\mathrm{R}_{\mathrm{o}}, 29$
relationships between models, 28-29
unilateral model, 29
voltage amplifier, 23-25
Circuit operation
class AB output stage, 935-937
class B output stage, 929
CMOS inverter, 1114-1117
Circuit performance, finite open-loop gain and bandwidth, 105-109, 132-133P
Circuit symbol
amplifier, 16, 17
bipolar junction transistor (BJT), 320-322
gallium arsenide (GaAs) devices, AM9
junction field-effect transistor, AM1
MOSFET, 264-265
NMOS and npn transistor, G4
Clamped capacitor, 224-226
Clamping circuit, 221, 224-226, 230S, 242-245P, AM77
Class AB output stage, 935-937, 982S, 984-985P
biasing circuit, 940-944, 985-986P
biasing using diodes, 940-941
biasing using $V_{\text {BE }}$ multiplier, 942-944
circuit operation, 935-937
CMOS, 950-958, 982S, 989-991P
input emitter followers, 945-946
output resistance, 937
short-circuit protection, 949
thermal shutdown, 950
use of compound devices, 946-948
variations on AB configuration, 945-950, 986-989P
Class A output stage, 923-928, 982S, 983P
power-conversion efficiency, 928
power dissipation, 926-927
signal waveforms, 925-926
transfer characteristic, 924-925
Class B bipolar output stage
crossover distortion, B121
hand design, B116-B117
load power $\mathrm{P}_{\mathrm{b}}, \mathrm{B} 117-\mathrm{B} 118$
Multisim example, B116-B122
power-conversion efficiency, B119
simulation, B117-B122
supply power $\mathrm{P}_{\mathrm{b}}, \mathrm{B} 119$
total harmonic distortion (THD), B121-B122
transistor power dissipation $\mathrm{P}_{\mathrm{bt}}, \mathrm{B} 120-\mathrm{B} 121$
Class B output stage, 929-934, 982S, 983-984P
BJT, B50-B55
circuit operation, 929
power-conversion efficiency, 930-931
power dissipation, 931-932
reducing crossover distortion, 933-934
single-supply operation, 934
transfer characteristic, 929-930
Class D power amplifiers, 967-970, 982S, 992P
Classical sensitivity function, 1344, 1369S
Clear, A15
Clipper, 222
Clock feedthrough, dynamic MOS logic circuits, 1214
Closed-loop amplifier, frequency response of, 107-109
Closed-loop gain
feedback, 809-810
inverting configuration, 65-67
noninverting configuration, 73-74
Closed-loop response, phase margin, 886
Closed-loop transfer function, 871
Closure resistance, 381
CMOS (complementary MOS)
CS (common-source) amplifier, B30-B33, B40-B43
digital IC technology, 1180-1181
fabrication technology, A1
folded-cascade, op amp, 1016-1027, 1073S, 1077-1078P
general structure of CMOS logic, 1091-1094
graphics technology, 1213
image sensor, 1281-1282, 1073S, 1287P
implementation of SR flip-flop, 1241-1242
as switches, 1199-1205
technology, 511
transmission gate, 1193
two-stage, op amp, 996-1012, 1073S, 1074-1076P
values of device parameters, G1-G2, K1
CMOS (complementary MOS) class AB output stages, 950-958, 982S, 989-991P
classical configuration, 950-953
common-source transistors, 953-958
output resistance, 954-956
voltage-transfer characteristic, 956-958
CMOS (complementary MOS) CS (commonsource) amplifier, B30-B33, B40-B43
amplifier biasing, B91
dc voltage transfer characteristic, B91-B92
hand design, B90-B91
Multisim example, B89-B93
Multisim example of frequency response, B105-B107
sensitivity to process variations, B93 simulation, B91-B93
transient analysis to verify G $_{∞}$, B92, B93
CMOS (complementary MOS) digital logic circuit
CMOS inverter, 1114-1124, 1154S, 1155S, $1159-1160 P$
CMOS logic-gate circuits, 1090-1098, 1154S, $1156-1157 P$
digital logic inverters, 1100-1106, 1154S, $1157-1159 P$
dynamic operation of CMOS inverter, 1125-1139, 1154S, 1160-1162P
power dissipation, 1149-1153, 1154S, $1163-1165 P$
transistor sizing, 1139-1148, 1154S, $1162-1163 P$
CMOS (complementary MOS) inverter, 1114-1124, 1154S, 1159-1160P
characteristics of, 1155
circuit operation, 1114-1117
CMOS logic-gate circuit, 1091
dynamic operation of, 1125-1139, 1154S, $1160-1162 P$
hand design, B128-B129
Multisim example, B127-B131
operation of, B60-B63
photomasks, A16
propagation delay, B129
$Q_{0}$ and $Q_{p}$ not matching, 1120-1121
schematic, A15
simulation, B129-B131
static characteristics and design, 1121-1124
transistor sizing, 1139-1140
voltage-transfer characteristic (VTC), 1117-1120, B129-B131
CMOS (complementary MOS) logic-gate circuit, 1090-1098, 1154S, 1156-1157P
CMOS inverter, 1091
complex gate, 1096
exclusive-OR (XOR) function, 1097-1098
general structure of CMOS logic, 1091-1094
pull-down network (PDN) and pull-up network (PUN), 1092, 1096-1097
switch-level transistor model, 1190-1191
synthesis method, 1098
transistor sizing in, 1141-1145
two-input NAND gate, 1095-1096
two-input NOR gate, 1094-1095
CMRR (common-mode rejection ratio), 77, 630-631, B3
bipolar case, 658
BJT differential amplifier, 634-636
common-mode gain and, 655-658
MOS differential amplifier, 628-634
two-stage CMOS op amp, 1001, B100-B101
Coincidence function, 1157P
Collector (C), 30, 306, 307
Collector-base junction (CBJ), 306, 307, 316n.3, 354 S
Collector-base junction capacitance, 718
Collector-base reverse current, bipolar junction transistor, 322
Collector current
amplifier operation, 368, 400-401
BJT, 309
BJT differential pair, 620-621
npn transistor in active mode, 309, 354S
Collector voltage, bipolar junction transistor (BJT), 326-329
Colpitts, Edwin Henry, 1400
Colpitts oscillator, 1396-1400, 1428S
Column-address decoder, 1273-1274
Column decoder, 1252
Combinatorial circuits, 1237
Common-base (CB) amplifier, 423, 424, 473-474, 479S, 537-546, 575S, 583-585P configuration, 439-442
Common-base (CB) circuit
input resistance, 543-544
output resistance, 544-545
Common-base current gain, 310
Common-collector (CC) amplifier, 423, 424
Common drain (CD) amplifier, 423, 424
Common-emitter, 30
characteristics, 327, 329-331
configuration, 327
current gain, 309, 329
Common-emitter (CE) amplifier, 423, 424, 470-471, 479S
application of method of open-circuit time constants, 748
characteristic parameters of, 428-429, 431
with current-source loads, 525-527
with emitter resistance, 431-437, 471-473, B27-B30
high-frequency response, 728-730, 793-796P
low-frequency response, 707-710, 789-792P
method of short-circuit time constants, 707, 708-710

Multisim example of, with emitter resistance, B85-B89
output resistance, 546
PSpice example, B27-B30
wideband amplification, 778-780
Common-gate (CG) amplifier, 423, 424, 479S, 575S, 583-585P
body effect, 542-543
configuration, 439-442
high-frequency response of, 748-754, 798-799P
Common-gate (CG) circuit, 537-540
input resistance, 538-539
output resistance, 539-540
Common-mode feedback, 1043
design of BJT op amp, 1064-1066
Common-mode gain, 630
Common-mode half-circuit, 630, 634
Common-mode input resistance, 635-636, B3
Common-mode input voltage, MOS differential pair, 597-598
Common-mode rejection, 61, 627-637, 682-684P, 1267
BJT differential amplifier, 634-636
MOS differential amplifier, 628-634
Common-mode rejection ratio. See CMRR (common-mode rejection ratio)
Common-mode voltage, 597
Common-source (CS) amplifier, 423, 424, 479, B23-B25
amplifier biasing, B81
amplifier gain, B82
amplifier linearity, B83
application of method of open-circuit time constants, 744-747
characteristic parameters of, 426-427, 431
with current-source loads, 525-527
determining 3-dB frequency, 704-705
determining pole and zero frequencies by inspection, 705
frequency response when $R_{o q}$ is low, 735-739
hand design, B79-B81
high-frequency response of, 722-726, 793-796P
investigating amplifier bias stability, B82-B83
largest allowable input signal swing, B83
low-frequency response, 699-706, 789-792P
Multisim example, B79-B83, B102-B105
PSpice example, B23-B25
selecting values for coupling and bypass capacitors, 705-706
simulation, B81-B83
wideband amplification, 778-780
with source resistance, 431-437
Common-source transistor
circuit utilizing, 953-958
CMOS class AB output stage, 953-958
output resistance, 954-956
voltage-transfer characteristic, 956-958
Communication electronics, 875
Comparator, 967
bistable circuit, 1409-1411
Comparison circuit, 810
Compensated attenuator, 57P
Complementary, 608, 624, 1329
Complementary MOS, 263, 264. See also CMOS (complementary MOS)
Complementary pass-transistor logic (CPL), 1207
Complementary switch, 1105
Complementary transformation, 1341
Complex frequency variable, 35
Compound devices, class AB output stage, 946-948
Composite transistor, GaAs amplifier, AM15-AM17
Computation, op amps and analog, 88
Computer aid, 1182-1183
Computer simulation problem, 116P, 230P, 292P, 355P, 480P, 576P, 674P, 789P, 896P, 1074P, 1156P
Computer simulation problems, 674P
Concentration gradient, 145
Concentration profile, 145
Conduction interval, 216
Conductivity, 144
Conjugate pairs, F2
Constant-voltage-drop model, diode forward characteristic, 193-194
Corner frequency, 36, F3
Coupling capacitor, 41, 467
selecting values for, 705-706, 710
Covalent bond, 136
Cross-coupled LC oscillator, 1400-1402
Crossover distortion, 929
class B bipolar output stage, B121
class B output stage, 933-934
Crosstalk, AM38
Crystal detector, 219
Crystal oscillator, 1402-1404
CS. See Common-source (CS) amplifier
Current amplifier, 28
Current buffer, 536
Current buffering, 546
Current conveyor, 579P
Current-crowding, 973
Current density, AM15
Current divider, 46P
Current flow
diffusion current, 145-147
drift current, 142-144
MOSFET creating channel for, 250-252
npn transistor in active mode, 308-309
relationship between D and $\mu, 148$
semiconductor, 142-148, 171P
Current gain, 18, 513, 670-672
Current $I_{G}$ (quiescent), design of BJT op amp, 1070-1073
Current mirror, 513
cascade MOS mirrors, 559-560
small-signal operation of, 523-525
Wulfur current source, 565-567
Wilson current mirror, 560-562
Wilson MOS mirror, 563-564
Current-mirror circuit, 559-567, 576S, 589-591P
Current-mirror load, differential amplifier with, 644-658, 673S, 685-690P
Current-mirror-loaded MOS amplifier, 772-775, 789S
analysis of, 772-775
Current-mode, 1106
Current-mode logic (CML), 1181, AM49
Current spikes, AM38
Current sink, 516, 517
Current source, 516, 517
BJT circuit, 520
gallium arsenide (GaAs) amplifier, AM11-AM12
MOSFET, 512-514
Current-source load
differential amplifier with, 611-612
MOS cascade amplifier, 548-549
output resistance of, 530-531
Current-source loaded, 525
Current steering, 511, 1106
bipolar junction transistor (BJT) circuit, 521
metal-oxide-semiconductor (MOS) circuit, $515-517$
Current transfer ratio, 513
Current-voltage characteristic
bipolar junction transistor (BJT), 320-333, 357-360P
ideal diode, 176-177
junction field-effect transistor (JFET), AM2-AM4
MOSFET, 264-276, 294-298P
NMOS and npn transistor, G4, G7
Current-voltage relationship, 160, 170
Cut-in voltage, 187
Cut off, 176
Cutoff frequency, 719-721
Cutoff mode, 306, 307

## D

DAC (digital-to-analog converter), 14
Dark field, A15
Darlington, Sidney, 1348
Darlington configuration, 946-948, 982S
transistor pairing, 571-572
Darlington pair, 571
Dc amplifier, 42, 62
Dc analysis, 741 BJT op amp, 1032-1037, 1038
Dc bias point, dc bias point, 383, 399, 400
Dc circuit
bipolar junction transistor (BJT), 333-351, 334, 360-365P
MOSFET, 276-287, 299-303P
Dc collector current, 741 circuit, 1038
Dc emitter-degeneration resistor, B27
Dc imperfections, 130-132P
effect of $V_{\mathrm{oc}}$ and $I_{\mathrm{oc}}$ on operation of inverting integrator, 103-104
input bias current, 100-103
input offset current, 100-103
offset voltage, 96-100
Dc offset, 637-644, 684-685P
input bias and offset currents of bipolar differential amplifier, 643
input offset voltage of bipolar differential amplifier, 640-642
input offset voltage of MOS differential amplifier, 637-640
Dc operating point, 371
Dc power supply, B18-B21
Dc restoration, 225
Dc restorer, 224-226, 225
Dc voltage, design of BJT op amp, 1064-1066
BJT op amp, 1064-1066
gain in two-stage CMOS op amp, 999-1001
Dead band, 929
Decibel, expressing gain in, 18
Deep-submicron design, technology scaling, $1168-1179,1227-1229 P$
De Forest, Lee, 454
Degenerative feedback, 74
Delay equalizers, 1308
Deplete, 290
Depletion capacitance, 170
Depletion mode, 291
Depletion region, 150
$p n$ junction, 149-150
width of and charge stored in, 151, 153
Depletion-type MOSFET, 290-291
Derated, 977
Desensitivity factor, 815
Design
design abstraction, 1182-1183
parameters of MOSFET and BJT, G6, G14 pass-transistor logic circuits, 1193-1194 pseudo-NMOS inverter, 1189
Design rule checker (DRC), A14
Design trade-offs, two-stage CMOS op amp, 1009-1010
Device simulation examples. See Multisim examples; PSpice examples
Device structure
bipolar junction transistor (BJT), 306-307, $315-316,355-357 P$
MOSFET, 248-250, 292-293P
Device variety, 511
D flip-flop circuit, 1247-1249
DIBL (drain-induced barrier lowering), A17
Difference amplifier, 77-86, 116S, 125-128P
instrumentation amplifier, 82-85
single-op-amp, 78-81
superior circuit, 82-85
Difference-mode, 601
Differential, 608
Differential amplifier, 53P
analysis of, 772-775, 789S
bipolar differential pair, 651-654
CMRR (common-mode rejection ratio), 655-658
common-mode gain, 655-658
with current-mirror load, 644-658, 673S, $685-690 P$
differential gain of current-mirror-loaded MOS pair, 647-651
differential-to-single-ended conversion, $644-645$
gallium arsenide, AM18-AM19
high-frequency response of, 768-777, 800-801P
MOS differential pair, 645-646
multistage BJT, B33-B40
Differential data path, 1254
Differential gain, 62
differential gain at dc, B3
MOS differential pair, 607-609
Differential half-circuit, 625
BJT differential pair, 624-625
MOS differential pair, 609-610
Differential-in, differential-out, 644, 664
Differential-input, single-ended-output, 61
Differential input resistance, 81, B3
Differential input signal, 601
Differential input voltage, MOS differential pair, $601-602$
Differential-pair configuration
BJT differential pair, 614-625
MOS differential pair, 596-613
large-signal operation, 602-606, 617-619
small-signal operation, 607-610, 620-625
Differential voltage gain, BJT differential pair, $623-624$
Differentiator, 87-95, 128-130P
integrator and, 87-95
op-amp, 94-95
Differentiator time constant, 95
Diffusion, IC fabrication, A4-A5
Diffusion capacitance, 166-167, 170, 717
Diffusion constant, 146
Diffusion current, 145-147, 149, 168S
Diffusion current density, 169
Diffusion length, 158
Diffusivity, 146
Digital circuit, 14
BiCMOS, 1223-1226, 1227S, 1235P
gallium arsenide, AM19-AM26
Digital integrated-circuit design
BiCMOS, 1181-1182
BiCMOS digital circuits, 1223-1226, 1227S bipolar, 1181
bipolar and BiCMOS logic circuits, 1217-1226, 1227S, 1234-1235P CMOS, 1180-1181
deep-submicron design, 1168-1179, 1227-1229P
derivation of voltage-transfer characteristic (VTC), 1186-1188
design abstraction and computer aids, $1182-1183$
dynamic MOS logic circuits, 1208-1217, 1227S, 1233P
emitter-coupled logic (ECL), 1218-1223, 1227 S
gallium arsenide (GaAs), 1182
gate circuits, 1189-1190
pass-transistor logic circuits, 1192-1208, 1227S, 1230-1233P
pseudo-NMOS inverter, 1183-1184
pseudo-NMOS logic circuits, 1183-1192, 1227S, 1229-1230P
styles for digital system design, 1182
technologies and logic-circuit families, $1180-1182$
technology scaling, 1168-1179, 1227-1229P
Digital logic inverter, 1100-1106, 1154S, 1157-1159P
CMOS, 1091, 1114-1124, 1155
determining propagation delay of CMOS, $1129-1135$
driving a large capacitance, 1146-1148
dynamic operation of CMOS inverter, $1125-1139$
energy-delay product, 1152-1153
equivalent load capacitance, 1136-1139
ideal voltage-transfer characteristic (VTC), 1103
inverter implementation, 1103-1106
inverter sizing, 1139-1140
noise margins, 1101-1102
power-delay product, 1152-1153
power dissipation, 1149-1153
propagation delay, 1125-1128, 1145
pseudo-NMOS inverter, 1112-1114
resistively loaded MOS inverter, 1107-1111
transistor sizing, 1139-1148
voltage-transfer characteristic (VTC), $1100-1101$
Digital signal, 12-15, 44S, 49-50P
Digital system, 1087
Digital system design, 1182
Digital-to-analog converter (D/A or DAC), 14
Digitized, 13
Digit lines, 1251
Dimension, feedback principle, 841
Diode, 229-230S
biasing class AB circuit using, 940-941
breakdown region, 190
bridge rectifier, 212-213
clamped capacitor, 224-226
constant-voltage-drop model, 193-194
current-voltage characteristic, 176-177
diode logic gates, 180-181
exponential model, 190-191
forward-bias region, 184-189, G4
full-wave rectifier, 210-211, AM73-AM74
graphic analysis, 191
half-wave rectifier, 208-210
ideal, 176-181, 230-234P
iterative analysis, 191
laser, 229
light-emitting, 228-229
limiter circuits, 221-224, 242-245P
modeling diode forward characteristic, 190-201, 235-239P
operation in reverse breakdown region-zener diode, 202-207, 239-240P
peak rectifier, 213-219, AM76
photodiode, 228
precision half-wave rectifier, 219-220, AM69-AM70
rapid analysis, 192-193
rectifier, 177-178
rectifier circuit, 207-220, 240-242P
rectifier circuit with filter capacitor, 213-219
reverse-bias region, 189, G4
Schottky-Barrier diode (SBD), 227
small-signal model, 195-200
superdiode, 219-220, AM69-AM70, AM76
terminal characteristics of junction, 184-190, 234-235P
varactors, 228
voltage doubler, 226
voltage regulation, 200
zener, 202-207
Diode-connected transistor, 278
Diode logic gates, 180-181
Diode model, SPICE, B4-B5
Diode small-signal conductance, 197
Diode small-signal resistance, 197
Direct-coupled amplifier, 42, 62
Direct-coupled field-effect transistor (DCFL) logic, AM20-AM23
Discrete circuit, 5
Discrete-circuit bias, classical arrangement, 461-463
Discrete-circuit amplifier, 467-478, 479S, 497-505P
amplifier frequency response, 477-478
CB (common-base) amplifier, 473-474
CE (common-emitter) amplifier, 470-471
CE amplifier with emitter resistance, 471-473
CS (common-source) amplifier, 467-469
emitter follower, 475-476
Discrete CS amplifier
frequency response, B102-B105
hand analysis, B103-B104
high-frequency rolloff, B104
low-frequency poles and zero, B103-B104
midband gain, B103
simulation, B104-B105
Discrete-time signal, 12, 13
Discretized, 13
Distortion, 16
DMOS (double-diffused MOS) transistor, 974, 975
Dominant pole, 704
Dominant-pole response, 740
Domino CMOS logic, 1216-1217
Donor, 139
Dopants, A5
Doped semiconductors, 139-141, 171P
ntype, 139
ptype, 139
Doped silicon, 139
Doping, 136
Double-anode zener, 224
Double cascoding, 555, 575-576S
Double-diffused transistor, 974
Double limiter, 222
Drain, 248
Drain-induced barrier lowering (DIBL), A17
Drain-to-gate feedback resistor, biasing, 460

DRAM. See Dynamic random-access memory (DRAM) cell
Drift current, 142-144, 168S
pn junction, 151
Drift current density, 169
Driver, 1252
Driver circuit, AM31
Dry etching, A4
Dry oxidation, A2
Dummy cell, 1267
Duty cycle, 225, 1423
Dynamic memory, 1238
Dynamic MOS logic circuit, 1208-1217, 1233P
basic principle, 1209-1210
cascading dynamic logic gates, 1215
charge sharing, 1213-1214
clock feedthrough, 1214
domino CMOS logic, 1216-1217
noise margins, 1212-1213
nonideal effects, 1212-1215
output voltage decay due to leakage effects, 1213
Dynamic operation
BiCMOS inverter circuit, AM65
CMOS inverter, 1125-1139, 1154S, 1160-1162P
determining equivalent load capacitance, 1136-1139
determining propagation delay of, 1129-1135
propagation delay, 1125-1128
pseudo-NMOS inverter, 1188-1189
Dynamic power dissipation, 1149, AM42
Dynamic random-access memory (DRAM) cell, 1253, 1260-1262, 1283S
differential operation in, 1267-1268
Dynamic resistance, 203
Dynamic sequential circuits, 1238

## E

Early, J. M., 272, 327
Early effect, $327 n, 333,354 \mathrm{~S}$
dependence of current on collector voltage, $326-329$
small-signal models, 407, 409
Early saturation, AM16
Early voltage, 327, B11, B12
Ebers-Moll model, B9, B10
Eccles, William H., 1240
Edge triggered, 1247
Effective base width, 327
Effective voltage, 251
Efficiency ( $\eta$ ), 19
Einstein relationship, 148
Electronics, 139, 875
Electronics age, 454
Electronics Magazine, 288
Electron mobility, 143
Elmore delay formula, 1204
Emission coefficient, B4
Emitter (E), 30, 306, 307
Emitter-base junction (EBJ), 306, 307, 316n, 354S
Emitter-coupled logic (ECL), 1218-1223, 1227S, 1234P, AM47-AM62, AM67-AM68P
basic gate circuit, 1219-1223, AM49-AM52
basic principle, 1218-1219, AM47-AM48
families, AM48-AM49
fan-out, AM57
manufacturers' specifications, AM56-AM57
noise margins, AM55
NOR transfer curve, AM55-AM56
Emitter-coupled logic continued
OR transfer curve, AM53-AM54
power dissipation, AM58-AM59
QECL, B65e15
signal transmission, AM57-AM58
speed of operation, AM57-AM58
static and dynamic operation of, gate, B64-B69
thermal effects, AM59
voltage-transfer characteristics, AM52-AM57
wired-OR capability, 1223, AM62
Emitter current, $n p n$ transistor in active mode, 309-310
Emitter degeneration
resistance, 437
wideband amplification, 778-780
Emitter follower, 423, 442-449, 475-476
characteristic parameters of, 445-448
class AB output stage, 945-946
high-frequency response of, 767, 799-800P
Thévenin representation of, output, 448, 449
Emitter resistance, 404
common-emitter amplifier with, 431-437, 471-473
Energy-delay product, 1152-1153
Engineer, analog vs. digital circuit, 15
Enhancement-mode operation, 255
Enhancement-type MOSFET, 255
Epitaxial, A5
Epitaxy, A5
Equilibrium, pn junction, 151, 152
Equiripple, 1295
Equivalence, $1157 \mathbf{P}$
Equivalence load capacitance, CMOS inverter, 1136-1139
Equivalent circuit
BiCMOS inverter, 1224, 1225
feedback transconductance amplifier, 845
high frequency response, 722-725, 728-729
ideal op amp, 61, 62
Thévenin, 46P
two-stage CMOS op amp, 1004
Equivalent-circuit model
MOSFET amplifier, 386-388
npn transistor in active mode, 312-313
Equivalent-circuit representation, two-port network, C5-C6
Equivalent resistance, transmission gate, 1202-1205
Erasable programmable ROM (EPROM), 1276, 1279-1281, 1283S
Error amplifiers, 954
Error signal, 810
Error voltage, 954
Etching, A3, A4
Evaluation phase, 1209
Excess concentration, 158
Exclusive-OR (XOR) function, CMOS logic-gate circuit, 1097-1098
Exponential model
diode forward characteristic, 190-191
graphical analysis using, 191
iterative analysis using, 191

## F

Faggin, Federico, 1141
Fairchild Semiconductor, 288, 405, 1031, 1117
Fan-in, 1145
Fan-out
emitter-coupled logic (ECL), AM57
inverters, $1157 \mathbf{P}$
propagation delay, 1145

FDNR (frequency-dependent negative resistance), $1374 \mathbf{P}$
Feedback, 823, 807-895, 896-919P
amplifier poles, 875-884, 917-918P
amplifier types, 906-917P
analysis method, 871,872
bandwidth extension, 816-817
basic principles, 840-841
closed-loop gain, 809-810
current amplifier, 865-866, 872, 914-917P
feedback-analysis method, 871,872
frequency compensation, 889-893
gain desensitivity, 815
general structure, 808-814, 815, 896-897P
ideal case, 829-831
interference reduction, 817-819
loop gain, 810-811, 823-824
Miller compensation, 892-893
negative properties, 815-820
Nyquist plot, 873-875
poles of amplifier, 876-877
pole splitting, 892-893
practical case, 831-834
reduction in nonlinear distortion, 819-820
series-series transconductance amplifier, 844-846, 906-909P
series-shunt voltage amplifier, 820-822
shunt-series current amplifier, 865-866, 914-917P
shunt-shunt transresistance amplifier, 855-857, 909-914P
signal-flow diagram, 808-809
single-pole response, 877-878
stability and pole location, 875-876
stability problem, 871, 873-875
stability study using Bode plots, 885-889
systematic analysis of voltage amplifiers, 828-834
three or more poles, 883-884
topologies, 872
transconductance amplifier, 844-846, 872, 906-909P
transfer function of amplifier, 871,873
transresistance amplifier, 855-857, 872, 909-914P
two-pole response, 878-883
voltage amplifier, 820-828
Feedback amplifier, 896S
determining loop gain of, B46-B50
poles of, 876-877
transfer function of, 871,873
Feedback-analysis method, 871,872
Feedback factor, 809
Feedback loop
bistable multivibrator, 1405
generation of equivalent, 1341-1344
single-amplifier biquadratic active filter, 1336-1339
Feedback topology, 840-841
Feedback transfer function, 871
Feedback triple, 850
Feedback voltage amplifier, 820-828, 899-901P
analysis of, utilizing loop gain, 823-824
examples of series-shunt feedback amplifiers, 821-822
ideal case, 829-831
practical case, 831-834
series-shunt feedback topology, 820-821, 901-905P
systematic analysis of, 828-834
Feedforward, 1334-1335, 1354
Field-effect device, 248
Field-programmable gate array (FPGA), 1182

Fifth-order Chebyshev filter, B69-B71 Filter
analog, 1295
Butterworth, 1300-1303, 1368S, 1370-1371P
Chebyshev, 1304-1306, 1368S, 1370-1371P
first-order, 1308-1310
second-order, functions, 1311-1315
second-order active, based on inductor replacement, 1322-1329, 1373-1374P
second-order LCR resonator, 1316-1321
sensitivity, 1344-1347, 1369S, 1375P
single-amplifier biquadratic active, 1336-1344, 1369S, 1374-1375P
specification, 1293-1296
switched-capacitor, 1354-1359, 1369S, 1376-1377P
transconductance-C, 1347-1354, 1369S, 1375-1376P
transfer function, 1296-1299
Filter approximation, 1295
Filter capacitor, 213
rectifier with, 213-219
Filter design, 1291-1292
Filter order, 1297
Filter pioneers, 1348
Filter transfer function, 1292, 1296-1299, 1368S, $1370 \mathbf{P}$
Filter transmission, 1292-1293, 1368S, 1369-1370P
Filter type, 1293, 1368S, 1369-1370P
realization of, 1325, 1326-1328
FINFET technology, A17, A18
Finite op-amp bandwidth, two-integrator-loop filter, B71-B74
Finite open-loop gain
inverting configuration, 67-68
noninverting configuration, 75
First-order filter, 1308-1310, 1371-1372P
First-order functions, s-domain analysis, F2-F3
Flash, 1279-1281
Flash memory, 1281, 1282
Flat gain, 1312
Flip-flop circuit, 1240, 1282S, 1283-1284P
CMOS implementation of clocked SR (set/reset), 1242, 1247
CMOS implementation of SR (set/reset), 1241-1242
D flip-flop, 1247-1249
set/reset (S/R), 1240-1241
Floating gate, 1279
Floating-gate transistor, 1279
Flying wires, 511
Folded cascode, 555-556
Folded-cascode amplifier
hand design, B94-B96
Multisim example, B108-B110, B93-B96
sensitivity to channel-length modulation, B96 simulation, B96
verifying G,, B96
Folded-cascode CMOS op amp, 1016-1027, 1073S, 1077-1078P
circuit, 1016-1018
frequency response, 1021-1022
input common-mode range and output swing, 1018-1019
output voltage range, 1026-1027
PSpice example, B43-B46
rail-to-rail input operation, 1024-1026
slew rate, 1022
structure, 1017
voltage gain, 1020-1021
wide-swing current mirror, 1026-1027
Forced, 318
Forward base-transit time, 717
Forward-biased, 176
Forward-bias region, junction diode, 184-189, G4
Forward current, 170
Forward Early voltage, B11, B12
Fourier series, 9
Fourier transform, 9
Four-stage bipolar op amp, 664
Free electron, 136
Frequency compensation, 106, 883, 896S, $918-919 \mathbf{P}$
implementation, 891-892
Miller compensation, 892-893
pole splitting, 892-893
theory, 889-890
two-stage CMOS op amp, B55-B60, B122-B127
Frequency-dependence, open-loop gain, 105-107
Frequency-dependent negative resistance (FDNR), 1374P
Frequency of oscillation, 1381
Frequency response. See also High-frequency 741 BJT op amp, 1051-1053
closed-loop amplifier, 107-109
common-emitter (CE) amplifier, 707-710, $728-730$
common-source (CS) amplifier, 699-706, $722-726$
CS amplifier when $R_{r i q}$ is low, 735-739
direct-coupled (dc) amplifier, 699
discrete CS amplifier, B102-B105
emitter follower, 767
folded-cascode CMOS op amp, 1021-1022
high-, of CS and CE amplifiers, 722-739
high-frequency gain function, 739-740
high-frequency model of BJT, 717-722, 792-793P
high-frequency model of MOSFET, 711-716, 792-793P
internal capacitive effects, 711-722, 792-793P
low-, of discrete-circuit CS and CE amplifiers, 699-710, 789-792P
method of short-circuit time constants, 707
midband, 697, 698
Miller's theorem, 732-735
single-time-constant (STC) circuit, E6-E9
source follower, 761-765
tools for analysis of high-, of amplifiers, 739-748, 797-798P
two-stage CMOS op amp, 1002-1006
wideband amplifier configurations, 778-788, 801-805P
Frequency response of amplifier, 33-42, 54-57P amplifier bandwidth, 34
classification of, 41-42
evaluating, $34-35$
measuring, 33-34
single-time-constant networks, 35-38
Frequency-selection, 1293
Frequency-selective network, 1380
Frequency spectrum of signals, 9, 48-49P signals, 9-11
Fullagar, David, 1031
Full-power bandwidth, 114-115, 116S
full-wave rectifier, 210-211, AM73-AM74
Function generator, 1380
Fundamental frequency, 10

## G

Gain, 44S
741 op-amp circuit, 1050-1051
amplifier, 16
current gain, 17-18
distribution in MOS cascode amplifier, $552-554$
expressing in decibels, 18
with feedback, 809
increasing, of basic cell, 536-537
common-emitter amplifier, 309, 329
power gain, 17-18
single-time-constant (STC) circuit, 37-40
voltage gain, 17
Gain-bandwidth product, 106, 109, 478, 698, 737, G13
Gain desensitivity, 815
Gain function, 1292
Gain margin, 885
Galena, 219
Gallium arsenide (GaAs), 1182, A1
Gallium arsenide (GaAs) amplifier, AM11-AM19
cascode current source, AM12-AM13
composite transistor, AM15-AM17
current sources, AM11-AM12
differential amplifiers, AM18-AM19
output resistance by bootstrapping, AM13-AM15
simple cascode configuration, AM15-AM17
Gallium arsenide (GaAs) device, AM6-AM11
basic, AM6-AM7
device characteristics and models, AM8-AM9, AM11
device operation, AM7-AM8
metal semiconductor FET (MESFET), AM6-AM7
Gallium arsenide (GaAs) digital circuit, AM19-AM26
buffered FET logic (BFL), AM26
direct-coupled FET logic (DCFL), AM20-AM23
logic gates using depletion MESFETs, AM23-AM25
Schottky diode FET logic (SDFL), AM26
Gate-array chips, 1182
Gate circuit
emitter-coupled logic (ECL), 1219-1223
pseudo-NMOS inverter, 1189-1190
Gate electrode, 248
Generation, 138
Germanium, 136, 320, 511, 1226
Gertner, Jou, 875
Graded junction, 165
Gradient coefficient, 165
Grand-scale graphics, 1213
Graphical analysis, exponential model, 191
Graphical representation, bipolar junction transistor (BJT) characteristics, 325-326
Graphics, 1213
Grounded-emitter, 30
Gummel-Poon model of BJT, B11

## H

Half-wave rectifier, 208-210, 219-220, AM69-AM70
Hard limiter, 222
Hartley, Ralph, 1400
Hartley oscillator, 1396-1400
Heat sink, 971, 978-981
Heil, Oskar, 248
Heterojunction bipolar transistor (HBT), A13, A14
Hewlett, William, 1390
High-frequency. See also Frequency response analysis tools for amplifiers, 739-748, 797-798P
application of method of open-circuit time constants, 744-747
bipolar cascode amplifier, 759-760
BJT model, 718-719, 722, 792-793P, G6, G12-G13
CE (common-emitter) amplifier, 707-710, 728-730, 793-796P
CG (common-gate) amplifier, 748-754
CS (common-source) amplifier, 699-706, 722-726, 793-796P
current-mirror-loaded MOS amplifier, 772-775
determining 3-dB frequency, 740-741
differential amplifiers, 768-777, 800-801P
emitter-follower case, 767, 799-800P
gain function, 739-740
method of open-circuit time constants, 743-744
Miller's theorem, 732-735
MOS cascode amplifier, 754-759
MOSFET model, 713-714, 716, 792-793P, G6, G12-G13
resistively loaded MOS amplifier, 768-772
rolloff, B104
source-follower case, 761-765, 799-800P
High-input noise margin, 1102
High pass (HP), 36, 38, 1293, 1294
first-order filter, 1309
second-order filtering, 1313
High-pass (HP) circuit, E5
frequency response of single-time-constant (STC) circuits, E8-E9
pulse response of STC circuits, E14-E15
step response of STC circuit, E11
High-pass filter, 36, 1293, 1308, 1309, 1311, 1313
High-pass function, realization of, 1318, 1319
High-pass notch (HPN), second-order filtering, 1314
High-voltage process, G3
Hoff, Ted, 1141
Hole, 136
Hole lifetime, 166
Hole mobility, 142
Hot electrons, 1280, A8
Hot spots, 974
Hybrid characterization, two-port network, C4-C5
Hybrid- $n$ model, 395
bipolar junction transistor (BJT) amplifier, 407-408, 422
NMOS and sips transistor, G5
T model, 408-409, 410, G5
Hysteresis, 1407

## I

IC (integrated circuit) amplifier, 509-510, 575-576S, A1
basic gain cell, 525-537, 575S, 580-583P
basic MOSFET current source, 512-514
biasing, 511-525, 575S, 576-580P
BJT cascode, 557-558
BJT circuits, 518-523
cascode amplifier, 546-558, 575S, 576S, 585-589P
cascode MOS mirrors, 559-560
CB circuit, 543-545
CB (common-base) amplifier, 537-546, 583-585P
CC-CB and CD-CG configurations, 572-573
CC-CE, CD-CS, and CD-CE configurations, $567-569$
IC (integrated circuit) amplifier continued
CG circuit, 537-540
CG (common-gate) amplifier, 537-546, $583-585 \mathbf{P}$
CS and CE amplifiers with current-source loads, 525-527
current-mirror circuits, 559-567, 589-591P
Darlington configuration, 571-572
design philosophy, 510-511
double cascoding, 555
folded cascode, 555-556
increasing gain of basic cell, 536-537
intrinsic gain, 527-529, G9-G10
MOS cascode amplifier, 547-550
MOS current-steering circuit, 515-517
output resistance of current-source load, 530-531
output resistance of emitter-degenerated CE amplifier, 546
power, 961-966, 982S, 991P
small-signal operation of current mirrors, $523-525$
transistor pairings, 567-573, 576S, 591-593P
voltage gain distribution in cascode amplifier, 552-554
Wulfur current source, 565-567
Wilson current mirror, 560-562
Wilson MOS mirror, 563-564
IC (integrated circuit) chips, graphics, 1213
IC (integrated circuit) fabrication steps, A2-A6 chemical vapor deposition, A5-A6
diffusion, A4-A5
etching, A4
ion implantation, A5
metallization, A6
oxidation, A2-A3
packaging, A6
photolithography, A3-A4
silicon wafers, A2
The Idea Factory (Gertner), 875
Ideal diode, 229S, 230-234P
current-voltage characteristic, 176-177
diode logic gates, 180-181
rectifier, $177-178$
Ideal-diode model, diode forward characteristic, 194
Ideal operational amplifier (op amp), 60-63, $115 \mathrm{~S}, 116-117 \mathbf{P}$
differential and common-mode signals, 63
function and characteristics of, 61-62
op-amp terminals, 60-61
Identification, radio-frequency, 772
IGFET (insulated-gate field effect transistor), 250
Illumination, 229
Impedance, inverting configuration with general impedance, 87
Impedance converter, 1374
Inactive transistor, design of BJT op amp, 1070-1073
Incremental diffusion capacitance, 167
Incremental resistance, 197, 203
Inductorless filter, 1292
Inductor losses, tuned amplifier, 1362-1363
Inductor replacement, second-order active filter, 1322-1329, 1373-1374P
Input bias current, 100, B3
741 BJT op amp, 1032
bipolar differential amplifier, 643
Input circuit of transistor-transistor logic (TTL) gate, AM28-AM30
Input common-mode range, 598, B39
741 BJT op amp, 1035
BJT differential pair, 616-617
design of BJT op amp, 1055, 1058-1061
folded-cascode CMOS op amp, 1018-1019, 1024-1026
two-stage CMOS op amp, 998-999, B100
Input differencing circuit, 810
Input differential resistance, BJT differential pair, $622-623$
Input emitter follower, class AB output stage, 945-946
Input high current, AM35
Input low current, AM36
Input offset current, 100, B3
bipolar differential amplifier, 643
Input offset voltage, 97, 116S, 637, B2
bipolar differential amplifier, 640-642
MOS differential amplifier, 637-640
two-stage CMOS op amp, 663, B101-B102
Input resistance
CB (common-base) circuit, 543-544
CG (common-gate) circuit, 538-539
feedback principle, 841
inverting configuration, 68-69
noninverting configuration, 75
Input signal, single-amplifier biquadratic active filter, 1339-1340
Input stage
741 BJT op amp, 1038-1041
741 circuit, 1029, 1030
design of BJT op amp, 1058-1061
Input-stage bias, 741 BJT op amp, 1032-1034
Instantaneous power dissipation, 926
Instrumentation
amplifier, 82-85, 116S
bridge rectifier circuit, AM75
Insulated-gate field effect transistor (IGFET), 250
Integrated circuit (IC), 5, 135, 168S, 525
Integrated circuit amplifier. See IC (integrated circuit) amplifier
Integrated-circuit timers, 1419-1423, 1435P
555 circuit, 1419-1420
astable multivibrator using 555 IC, 1420, 1422, 1423
monostable multivibrator using 555 IC, 1420, 1421
Integrated devices, A9
Integrated instrumentation amplifier, 85
Integrator, 87-95, 128-130P
and differentiators, 87-95
integrator frequency, 90
inverting, 89-94
Integrator time constant, 90
Intel, 288
Interconnect, 1137
deep-submicron design, 1178-1179
Interference reduction, negative feedback, 817-819
Internal capacitance, 41
Internally compensated, 106
International Solid-State Circuits Conference (ISSCC), 659
Intrinsic gain, 527-529, G9-G10
Intrinsic semiconductors, 136-138, 171P
Invention, bipolar junction transistor (BJT), 320
Inverse active mode, AM29
Inverse-hybrid characterization, two-port network, C5
Inversion layer, 251
Inverter implementation, digital logic inverter, $1103-1106$
Inverting configuration, 64-73, 66, 117-122P
closed-loop gain, 65-67
effect of finite open-loop gain, 67-68
input and output resistance, 68-69
weighted summer, $71-72,73$
with general impedances, 87

Inverting input terminal, 61
Inverting integrator
offset current, 103-104
offset voltage, 103-104
op amp, 89-94
Invisible computer, 1182
Ion implantation, IC fabrication, A5
$I_{o}$ (quiescent current), design of BJT op amp, 1070-1073
Isotropic etching, A4
Iterative analysis, exponential model, 191

## J

JFET. See Junction field-effect transistor (JFET)
Jordan, Frank W., 1240
Julie, Loebe, 88
Junction breakdown, 163
Junction built-in voltage, 151, 169
Junction diode
breakdown region, 190
forward-bias region, 184-189, G4
$p n, \mathrm{~A} 11$
reverse-bias region, 189, G4
terminal characteristics of, 184-190, 234-235P
Junction field-effect transistor (JFET),
AM1-AM5
circuit symbol, AM1
current-voltage characteristics, AM2-AM4
device structure, AM1-AM2
JFET small-signal model, AM4
physical operation, AM2

## K

Kahng, Dawon, 248
Kerwin-Huelsman-Newcomb (KHN) biquad, 1332
KHN biquad, 1332
Kilby, Jack, 511, 525
Knee current, 203

## $\mathbf{L}$

Large-signal differential transfer characteristic, B35, B36
Large-signal equivalent circuit, 268
Large-signal models, 313
Large-signal operation
BJT differential pair, 617-619
MOS differential pair, 602-606
op amp, 110-115, 133P
Laser diode, 229
Latch, 1238-1240, 1283-1284P
Lateral $p n p$ transistor, A12, G3
LC and crystal oscillator, 1396-1404, 1431-1433P
Colpitts and Harteley oscillators, 1396-1400
Least significant bit (LSB), 13
Lehovac, Kurt, 525
Level-shifting, 664, AM15
Light-emitting diode (LED), 228-229
Lightly doped drain (LDD), A8
Lilienfeld, Julius E., 248
Limiter circuit, 221-224, 242-245P
amplitude control, 1386-1388
Linear amplification
biasing BJT, 371-374
biasing MOSFET, 371-374
Linear amplifier, 16
Linearity, 16
Linearized, 819
Linear macromodel, op-amp, B1-B3
Linear oscillator, 1380
Line regulation, 204
Line spectrum, 11
Liquid crystal displays (LCDs), 139
LM100, 996
LM101, 996
LM101A, 996
LM108, 996
LM12, 962
LM380, 962-966
Load, 7
Load capacitance, CMOS inverter, 1146-1148
Load line, 381
Load power, class B bipolar output stage, B117-B118
Load regulation, 204
Load resistance, 369
Load time, 191
Local oxidation of silicon (LOCOS), A7
Logarithmic amplifier, 1436P
Logic AND function, 181
Logic circuit. See Advanced logic circuit
Logic-circuit families
BiCMOS, 1181-1182
bipolar, 1181
CMOS technology, 1180-1181
Logic OR function, 180
Loop gain, 809, 895S, 896S
analysis of feedback voltage amplifier utilizing, 823-824
determining, of feedback amplifier, B46-B50
feedback, 810-811
feedback analysis, 841
Low frequency
3-dB frequency, 704-705
common-emitter amplifier, 707-710
common-source amplifier, 699-706
gain of amplifier vs., 698
Low pass (LP), 36, 37, 44S, 1293, 1294
first-order filter, 1309
second-order filtering, 1313
Low-pass amplifier, 43
Low-pass circuit, E5
frequency response of single-time-constant (STC) circuits, E6-E7
pulse response of STC circuits, E13-E14
step response of STC circuit, E10-E11
Low-pass filter, 36
Low-pass function, realization of, 1317, 1318, 1319
Low-pass notch (LPN), second-order filtering, 1314
Lowpass-to-bandpass transformation, H2
Low-voltage process, G3

## M

$\mu \mathrm{A} 702,996,1031$
$\mu \mathrm{A} 709,996,1031$
$\mu \mathrm{A} 723,996$
$\mu \mathrm{A} 741,1031$
Macromodel, B1
Magnitude, 33
Magnitude response, frequency response of STC networks, 37
Main memory, 1250
Majority, 140
Manufacturers' specifications
emitter-coupled logic (ECL), AM56-AM57 transistor-transistor logic (TTL), AM41

Mask-programmable read-only memory (ROM), 1278-1279
Mask programming, 1278
Mass-storage, 1250
Master-slave, 1248, 1249
Maximal flatness, 1368, H1
Maximally flat, 879, 1302, H5P
Maximum switching frequency, 1126
Mead, Carver, 288
Mean transit time, 167
Medium-scale-integrated (MSI), 1181
Memory, 1237
Memory access time, 1252
Memory cell, 1250
Memory-chip organization, 1250-1252
Memory-chip timing, 1252
Memory circuit
CMOS image sensor, 1281-1282
CMOS implementation of clocked SR (set/ reset) flip-flop, 1247
CMOS implementation of SR flip-flop, $1241-1242$
column-address decoder, 1273-1274
D flip-flop circuit, 1247-1249
dynamic memory (DRAM) cell, 1260-1262
latch, 1238-1240
mask-programmable read-only memory (ROM), 1278-1279
memory-chip organization, 1250-1252
memory-chip timing, 1252
MOS read-only memory (ROM), 1276-1278
programmable ROMs (PROMs, EPROMs, and flash), 1279-1281
pulse-generation circuit, 1274-1276
random-access memory (RAM) cells, 1253-1262
read-only memory (ROM), 1276-1281
row-address decoder, 1271-1272
semiconductor memories, 1249-1252
sense amplifier, 1263-1270
SR flip-flop, 1240-1241
static memory (SRAM) cell, 1253-1260
types and architectures, 1249-1252
Memory cycle time, 1252
Memory element, bistable, 1407-1408
Memory peripheral circuits, 1262
Metal-insulator-metal (MIM) capacitor, A10
Metallization, IC fabrication, A6
Metal-oxide-semiconductor. See MOS
Metal-oxide-semiconductor field-effect transistor. See MOSFET
Metal semiconductor field-effect transistor (MESFET)
gallium arsenide (GaAs) devices, AM6-AM11
logic gates using depletion MESFETs, AM23-AM25
Metastable state, 1405
Metric conversion factors, J2
Microcomputer, 5
Microcontrollers, 1182
Microelectronics, 5
Microprocessor, 5
Microprocessor electronics, 1141
Midband, 478, 697, 698
Midband gain, B103
Miller, John Milton, 735
Miller compensation, 892-893
Miller effect, 725, 735, 788S, 789S, 1365
Miller integrator, 90, 91, 92, 116S
Miller multiplication, 735, 749
Miller multiplier, 725
Miller's theorem, 732-735, B42
Minority, 140
Minority carrier, 308

Minority-carrier distribution, $n p n$ transistor in active mode, 310-312
Minority-carrier lifetime, 166, 170
Mirror pole and zero, 774
Mixed-mode, 15
Mixed-signal, 15
Mixed-signal circuit, 1008
Mixer, 810
Mixing, feedback principle, 840
MJE243 BJT, B50
MJE253 BJT, B50
Model, 23
741 op-amp circuit, 1040, 1045, 1048, 1052-1053
body effect, 397-398
cascaded amplifiers, 25-27
operation of BJT in dc circuits, 334
constant-voltage-drop, 193-194
diode forward characteristic, 200, 235-239P
exponential model, 190-191
graphical analysis using exponential model, 191
ideal-diode model, 194
interative analysis using exponential model, 191
need for rapid analysis, 192-193
small-signal, for diode, 195-200
small-signal, of 741 op-amp circuit, 1038-1040
unilateral, 29
two-stage CMOS op-amp, 1007-1008
voltage amplifiers, 23-25
zener diode, 203-204
Monolithic circuit, 135
Monostable, 1380
Monostable multivibrator, 1417-1418, 1428S, 1434-1435P
circuit, 1275-1276
using 555 IC, 1420, 1421
Moore, Gordon, 288, 405, A16
Moore's law, 288, 293P, 1168, A16
MOS (metal-oxide-semiconductor)
active-loaded MOS amplifier, 773
cascade amplifier, 547-550
cascade MOS mirror, 559-560
current-steering circuit, 515-517
differential pair, 596-613
double-diffused (DMOS) transistor, 974, 975
gain distribution, 554
high-frequency response of, 754-759
ideal case, 547-548
implementation of constant-current source load, 548-549
power transistors, 974-976
read-only memory (ROM), 1276-1278
resistively loaded MOS amplifier, 768-772
use of cascade current source, 549-550
Wilson MOS mirror, 563-564
MOS differential pair, 596-613, 672S, 674-678P
analysis of current-mirror-loaded, 772-775
analysis of resistively loaded, 768-772
cascade differential amplifier, 612-613
CMRR (common-mode rejection ratio), 628-634
common-mode gain, 628-634
configuration, 596
current-mirror-loaded, 645-646
differential amplifier with current-source loads, 611-612
differential gain, 607-609
differential gain of current-mirror loaded, 647-651
differential half-circuit, 609-610
differential vs. single-ended output, 633-634MOS differential pair continued
$g_{a}$ mismatch on common-mode rejection ratio (CMRR), 631
input offset voltage of, 637-640
large-signal operation, 602-606
operation with common-mode input voltage, 597-598
operation with differential input voltage, 601-602
$R_{a}$ mismatch, 630-631
small-signal operation, 607-610
MOSFET (metal-oxide-semiconductor field-effect transistor), 247-248, 291S
amplifier operation, 3, 368-369
applying a small $v_{\text {int }}, 252-255$
biasing, 455-460
body effect, 288-289, 303P
breakdown, 289
channel pinch-off, 258-260
characteristics of, 452
circuits at dc, 276-287, 299-303P
circuit symbol, 264-265
comparison to bipolar junction transistor (BJT), G4-G6
complimentary MOS (CMOS), 263, 264
creating a channel for current flow, 250-252
current saturation, 258-260
current source, 512-514
current-voltage characteristics, 264-276, 294-298P
dc bias point, 383
depletion-type, 290-291
design parameters, G6, G14
device structure, 248-250, 292-293P
finite output resistance in saturation, 271-273
high-frequency model of, 711-716, G6, G12-G13
$i_{p} \cdot v_{\text {int }}$ characteristics, 265-267
$i_{p} \cdot v_{\text {int }}$ characteristics, 267-268
input protection, 289
modeling body effect, 397-398
obtaining linear amplification by biasing transistor, 371-374
operating MOS transistor in subthreshold region, 264
operation as $v_{\text {int }} \geq V_{\text {ext }}, 258-260$
operation as $v_{\text {int }}$ is increased, 256-258
operation with zero gate voltage, 250
$p$-channel MOSFET, 261-263
$p$-channel MOSFET characteristics, 274-276
physical operation, 248-264, 292-293P
separating dc analysis and signal analysis, 386
small current in drain terminal, 384
small-signal equivalent-circuit models, 386-388
small-signal models of, 421
small-signal operation, 383-398
small-signal voltage gain, 374-375
SPICE model, B5-B9
square-law MOSFET model, B5, G17
temperature effects, 289
T equivalent-circuit model, 394-395
transconductance, 388-389
unity-gain frequency, 715-716
values of MOSFET parameters, G1-G2
velocity saturation, 290
VLSI technology, A9-A10
voltage gain, 385-386
MOSFET model (SPICE), B5-B9
CMOS technologies, B9
dimension and gate-capacitance parameters, B7-B9
diode parameters, B6-B7
model parameters, B6
MOSFET transconductance parameter, 255

MOSFET unity-gain frequency, 715-716
Most significant bit (MSB), 13
Moving-surface memory, 1250
Multiemitter transistor, AM43
Multisim examples, B79-B131. See also PSpice examples
CE amplifier with emitter resistance, B85-B89
class B bipolar output stage, B116-B122
CMOS CS amplifier, B89-B93
CMOS inverter, B127-B131
CS amplifier, B79-B83
dependence of $\beta$ on bias current, B84-B85
folded-cascode amplifier, B108-B110, B93-B96
frequency response of CMOS CS amplifier, B105-B107
frequency response of discrete CS amplifier, B102-B105
two-stage CMOS op amp, B97-B102
two-stage CMOS op amp with frequency compensation, B122-B127
two-stage CMOS op amp with series-shunt feedback, B110-B115
Multistage amplifier, 659-672, 673S, 690-695P
bipolar op amp, 664-672
differential BJT, B33-B40
frequency response, 760
two-stage CMOS op amp, 659-663
Multivibrator, 1404, 1428S
astable, 1412-1416, 1434P
bistable, 1404-1411, 1433P
monostable, 1417-1418

## N

$n$-channel MOSFET, 251
$n+$ source, 248
$n$-type silicon, 169, A2
$n$ type, 139
$n$ well, 263, A7, A8
NAND gate
pseudo-NMOS, 1189-1190
transistor-transistor logic (TTL), AM43-AM44
two-input, 1095-1096
Narrow-band, 1360
Narrow-band approximation, H1
Narrow band filters, H2-H4
National Semiconductor Corporation, 962
Natural devices, 1199
Natural modes, 1297, F2
resonator, 1316-1317
Near rail-to-rail output signal swing, design of BJT op amp, 1056, 1069-1073
Negative feedback, 64, 115S, 807, 895S, 897-899P
bandwidth extension, 816-817
gain desensitivity, 815
interference reduction, 817-819
properties of, 815-820
reduction in nonlinear distortion, 819-820
Negative-feedback loop, 1336-1339
Negative resistance, 1360
Network parameter. See Two-port network
Network theorem, D1-D5, D5-D6P
Norton's theorem, D1, D2
source-absorption theorem, D3
Thévenin's theorem, D1, D2
Neutralizing, 1365, 1400
NMOS transistor ( $n$-channel), 251, 253, G18-G19P
capacitance, G6
characteristics of, G4-G6
current-voltage characteristics, G4, G7
high-frequency model, G6
intrinsic gain, G5, G9-G10
low-frequency small-signal models, G5, G8-G9
operating conditions, G4, G6
output resistance, G5, G9
as switches, 1194-1196
transconductance, G5, G9
transition frequency, G6, G12
values, G1, K1
Node, 1168
Noise margin
CMOS inverter, 1155
digital logic inverter, 1101-1102
dynamic MOS logic circuits, 1212-1213
emitter-coupled logic (ECL), AM55
for low input, 1102
Nondestructive, 1254
Nonideal effects, dynamic MOS logic circuits, 1212-1215
Noninverting configuration, 73-76, 115-116S, 122-125P
closed-loop gain, 73-74
effect of finite open-loop gain, 75
input and output resistance, 75
performance of, amplifier, B13-B15
voltage follower, 75-76
Noninverting input terminal, 61
Noninverting transfer characteristic, 1407
bistable circuit with, 1408-1409
Nonlinear distortion, 16
Nonlinear macromodel, op-amp, B3-B4
Nonlinear oscillator, 1380
Nonlinear waveform-shaping circuit, 1424-1427, 1435-1436P
breakpoint method, 1424-1426
nonlinear-amplification method, 1426-1427
NOR gate
pseudo-NMOS, 1189-1190
two-input, 1094-1095
NOR transfer curve, AM55-AM56
Norton's theorem, D1, D2
Notch, 1312
second-order filtering, 1314
Notch frequency, 1312
Notch function, realization of, 1318, 1319-1321
Not-programmed state, 1279
Noyce, Robert, 405, 525
npn transistor, G4-G6, G18-G19P
BJT, 307
capacitance, G6
current-voltage characteristics, G4, G7
high-frequency model, G6
intrinsic gain, G5, G9-G10
low-frequency small-signal models, G5, G8-G9
operating conditions, G4, G6
operation in active mode, 307-313, G4
output resistance, G5, G9
transconductance, G5, G9
transition frequency, G6, G12
Nyquist, Harry, 875
Nyquist criterion, 874
Nyquist plot, 873-875

## O

Off, 176
Off current, 1177
Off-resistance, 1104
Offset-nulling, 642
Offset voltage, 96-100
Ohmic contacts, 227
Ohm's Law, 45P
On, 176
One-shot, 1275-1276, 1417
One-transistor cell, 1260
On-resistance, 1104
Op amp (operational amplifier), 54P
741 BJT op amp, 1028-1054, 1073-1074S, 1078-1083P
bandwidth, 114-115
bipolar, 664-672
circuit performance, 105-109, 132-133P
closed-loop gain, 65-67, 73-74
common-mode input signal, 63, 77
computation, 88
dc imperfections, 96-105
design of BJT op amps, 1054-1073, 1074S, 1083-1085S
difference amplifiers, 77-86, 116S, 125-128P
differential input signal, 601
differentiators, 87-95
finite open-loop gain, 67-68, 75, 105-109
folded-cascode CMOS op amp, 1016-1027, 1073S, 1077-1078P
frequency response of bipolar, 759-760
frequency response of two-stage CMOS, 1002-1006
ideal, 60-63, 115S, 116-117P
input resistance, 68-69, 81
integrators, 87-95
inverting configuration, 64-73, 66, 117-122P
inverting integrator operation, 89-94
large-signal operation of, 110-115, 133P
noninverting configuration, 73-76, 115-116S, $122-125 P$
offset voltage, 96-100
output current limits, 110
output resistance, 68-69
output voltage saturation, 110
power, 962
slew rate, 112-113
terminals of ideal, 60-61, 115S
two-stage CMOS op amp, 996-1012
voltage follower, 75-76
weighted-summer circuit, 71-72, 73
Op-amp circuit, 115S
741 BJT op amp, 1028-1054, 1073-1074S, 1078-1083P
design of BJT op amps, 1054-1073, 1074S, 1083-1085S
design of input stage to rail-to-rail VICM, 1058-1061
folded-cascode CMOS op amp, 1016-1027, 1073S, 1077-1078P
frequency response of 741, 1051-1053
gain of 741, 1030-1031, 1047, 1050-1051
output-stage design for near rail-to-rail output swing, 1069-1073
slew rate of 741, 1053-1054
small-signal analysis of 741, 1038-1051
two-stage CMOS op amp, 996-1012
Op-amp model, SPICE, B1-B4
linear macromodel, B1-B3
nonlinear macromodel, B3-B4
Op-amp-RC oscillator circuit, 1388-1396, 1430-1431P
active-filter-tuned oscillator, 1394-1395
phase-shift oscillator, 1391-1392
quadrature oscillator, 1392-1394
Wien-Bridge oscillator, 1388-1391
Op-amp-RC resonator, 1323-1325
Open-circuit impedance, two-port network, C3-C4
Open-circuit overall voltage gain, 1048
Open-circuit terminal, operation with, 149-155

Open-circuit time constant
application of method of, to CE amplifier, 748
application of method of, to CS amplifier, $744-747$
method of, 743-744
Open-circuit voltage gain, 23, 425, G9
Open-collector transistor-transistor logic, AM45
Open-loop gain, 62, 808
effect of finite, and bandwidth on circuit performance, 105-109, 132-133P
frequency dependence of, 105-107
inverting configuration, 67-68
noninverting configuration, 75
Open-loop transfer function, 871
Operating point, 191
Operation
bipolar junction transistor (BJT), 306-320, $355-357 P$
emitter-coupled logic (ECL), AM57-AM58
MOSFET, 248-264, 292-293P
Operational amplifier, See Op amp
Operational rectifier, 221
Operational transconductance amplifier (OTA), 1020
Operation region
enhancement NMOS transistor, 266
enhancement PMOS transistor, 275
Optoelectronics, 228
Optoisolator, 229
OR function, CMOS logic circuit, 1092, 1097-1098
OR transfer curve, AM53-AM54
Order of the network, F2
Oscillation criterion,1381-1382
Oscillator, 873
active-filter-tuned, 1394-1395, 1396, B77-B79
circuit, analysis of, 1382, 1384
Colpitts, 1396-1400
cross-coupled LC, 1400-1402
crystal, 1402-1404
feedback loop, 1380-1381
Hartley, 1396-1400
LC, 1396-1404, 1431-1433P
phase-shift, 1391-1392
Pierce, 1403
quadrature, 1392-1394
self-limiting, 1399
sinusoidal, 1380-1388, 1428-1430P
Wien-bridge, 1388-1391, B75-B77
Output circuit of transistor-transistor logic gate, AM30-AM31
Output dc offset voltage, 637
Output level, bistable circuit, 1411
Output resistance, 328, B3
bootstrapping by GaAs amplifier, AM13-AM15
class AB output stage, 937
CMOS class AB output stage, 954-956
CMOS inverter, 1155
common-base (CB) circuit, 544-545
common-emitter (CE) amplifier, 546
common-gate (CG) circuit, 539-540
common-source (CS) amplifier with source resistance, 541-542
current-source load, 530-531
feedback principle, 841
inverting configuration, 68-69
MOSFET and BJT, 453-454, G5, G9
noninverting configuration, 75
Output short-circuit protection,741 BJT op amp, 1050
Output signal swing, design of BJT op amp, 1056
Output stage, 982S
741 BJT op amp, 1047-1049

741 circuit, 1029, 1031
class A, 923-928, 983P
class $\mathrm{AB}, 935-937,984-985 P$
class B, 929-934, 983-984P, B50-B55
classification of, 922-923
CMOS class AB, 950-958, 982S, 989-991P
design of BJT op amp, 1069-1073
Output-stage bias, 741 BJT op amp, 1035-1036
Output swing
design of BJT op amp, 1069-1073
folded-cascode CMOS op amp, 1018-1019
two-stage CMOS op amp, 998-999
Output voltage decay, dynamic MOS logic circuits, 1213
Output voltage range
folded-cascode CMOS op amp, 1026-1027
two-stage CMOS op amp, B101
Output voltage saturation, 110
Overall voltage gain, 426
Overlap capacitance, MOSFET, 712
Overdrive voltage, 251
Oxidation, IC fabrication, A2-A3
Oxide capacitance, 252

## $P$

$p$-base resistor, A12-A13
$p$-channel, junction field-effect transistor (JFET), AM4
$p$-channel MOSFET, 261-263
$p$-channel MOSFET characteristics, 274-276
$p$-type silicon, 169, A2
p-well, A7, A8
Packaging, IC fabrication, A6
Pair
bipolar differential, 651-654
BJT differential, 614-627, 678-682P
MOS differential, 596-613
transistor, 567-573, 591-593P
Parameter
741 BJT, 1031
BJT device, G3-G4, G6, G14, K1
body effect, 289
CMOS device, G1-G2, K1
common-emitter amplifier, 428-429, 431
common-source amplifier, 426-427, 431
emitter follower, 445-448
MOSFET device, G1-G2, G6, G14
MOSFET transconductance, 255
power transistors, 972-973
source follower parameters, 443-445
two-port network, C1-C6, C7P
Passband, 1293, 1294
Passband ripple, 1295
Passing, 1293
Passive LC filters, 1292
Passive limiters, 222
Passive pull-up, AM31
Passive sensitivity, 1345
Pass-transistor logic (PTL), 1168
Pass-transistor logic circuit, 1192-1208, 1227S, 1230-1233P
CMOS transmission gates as switches, 1199-1205
design requirement, 1193-1194
equivalent resistance of transmission gate, 1202-1205
examples of, 1206-1208
operation with NMOS transistors as switches, 1194-1196
restoring value of $V_{\text {out }}$ to $V_{\text {out }}, 1198-1199$
PD (pull-down) switch, 1105
PDN (pull-down network), 1092, 1096-1097
Peak detector, 214, 218
Peak inverse voltage, 208
Peak rectifier, 213-219, 214, 218, AM76
buffered, AM76-AM77
precision, AM76
Phase margin, 885
closed-loop response, 886
stability using Bode plots, 885-889
two-stage CMOS op amp, 1005-1006
Phase response, 34
amplifier, $35,44 \mathrm{~S}$
frequency response of STC networks, 36, 37, 38
Phase-shift oscillator, 1391-1392
Phase splitter, AM35
Photodiode, 228
Photolithography, IC fabrication, A3-A4
Photonic, 228
Physical frequency, 35, F1
Piecewise linear, 176
Pierce oscillator, 1403
Pinched-base resistor, A12-A13
Pinch-off channel, 258-260, 265, 266, 275, G4
Pinch-off voltage, AM2
Pixel, 1281
Pixel circuit, 1281
PMOS transistors ( $p$-channel), 261, 262, G18P technology, 263, 264
values, G1, K1
$p n$ junction, 148-155, 168S, 172P
capacitive effects in, 164-167, 173P
depletion region, 149-150
diffusion current, 149
diodes, A11
drift current and equilibrium, 151
equilibrium, 152
junction built-in voltage, 151
operation with open-circuit terminals, 149-155
physical structure, 149
width of and charge stored in depletion region, 151, 153
$p n$ junction with applied voltage, 172-173P
current-voltage relationship of junction, $158-160$
qualitative description of junction operation, $155-157$
reverse breakdown, 162-164
pnp transistor, 321
741 op-amp circuit, 1028, 1030-1031
bipolar junction transistor (BJT), 318-320
compound, 946, 948, 964
lateral, A12, G3
operation in active mode, 306-307
small-signal model, 409
Pole
amplifier, 876-877
amplifier with single-pole response, 877-878
amplifier with three or more, 883-884
amplifier with two-pole response, 878-883
low-frequency, B103, B104
s-domain analysis, F2
splitting, 892-893
stability and, location, 875-876
Pole frequency, 36, 705, 879, 1311, F2
Pole Q, 1311
Pole Q factor, 879
Pole quality factor, 1311
Pole splitting, 892-893
PolySi (polycrystalline silicon), A5-A6
Popular limiter circuit, amplitude control, 1386-1388
Positive feedback, 1012
inverting configuration, 64
regenerative, 807
sense amplifier, 1263-1265

Positive-feedback loop, 1380
Power amplifier, 16
bridge, 966
class D, 967-970, 982S, 992P
fixed-gain IC, 962-966
IC, 961-966, 982S, 991P
Power-aware design, G2a
Power-balance equation, 19
Power BJTs
BJT safe operating area, 973-974
device parameters, 972-973
device structure, 972
heat sinks, 971
Power-conversion efficiency
class A output stage, 928
class B bipolar output stage, B119
class B output stage, 930-931
Power-delay product, 1152-1153
Power-derating curve, 977
Power dissipation, 1149-1153, 1154S, $1163-1165 \mathbf{P}$
class A output stage, 926-927
class B output stage, 931-932
emitter-coupled logic (ECL), AM58-AM59
power-delay and energy-delay products, $1152-1153$
power transistors, 977-978
sources of, 1149-1152
Power efficiency, 19
Power gain, 18
Power MOSFETs, 974-976
characteristics of, 975-976
structure of, 974-975
Power-op-amp, 962
Power supply, 510-511
design of BJT op amp, 1054-1055
design of dc, B18-B21
Power-supply hum, 818
Power-supply rejection ratio (PSRR), two-stage CMOS op amp, 1008-1009
Power-supply ripple, 198
Power transformer, 207
Power transistor, 972-981, 982S, 992-993P
packages and heat sinks, 971
power BJTs, 972-974
power dissipation vs. temperature, 977-978
power MOSFETs, 974-976
thermal considerations, 976-981
thermal resistance, 976-977
transistor case and heat sink, 978-981
Preamplifier, 16, 819
Precharge phase, 1209
Precharging, 1254
Precharging arrangement, sense amplifier, 1268, 1269
Precision rectifier circuit, AM69-AM77, AM77-AM78P
alternative circuit, AM70-AM71
bridge rectifier for instrumentation, AM75
buffered precision peak detector, AM76-AM77
full-wave rectifier, AM73-AM74
half-wave rectifier, 219-220, AM69-AM70
measuring ac voltages, AM71-AM72
precision clamping circuit, AM77
precision peak rectifiers, AM76
superdiode, AM69-AM70, AM76
Primary winding, 207
Process, 6
Process transconductance, 254
Process variations, 1178
Programmable read-only memory (PROMs), 1279-1281, 1283S
Propagation delay
calculating, of simple inverter, 1127-1128

CMOS inverter, 1125-1128, 1155, B129
CMOS logic gate, 1145
determining, of CMOS inverter, 1129-1135
transistor-transistor logic (TTL), AM42
Pseudo-NMOS logic circuit, 1183-1192, 1227S, $1229-1230 \mathbf{P}$
derivation of voltage-transfer characteristic (VTC), 1186-1188
design, 1189
dynamic operation, 1188-1189
gate circuits, 1189-1190
inverter, 1112-1114, 1183-1184
pseudo-NMOS inverter, 1183-1184
region I (segment AB), 1187
region II (segment BC), 1187
region III (segment CD), 1187
region IV (segment DE), 1187
regions of operation of inverter, 1187
static characteristics, 1184-1186
PSpice examples, B13-B79. See also Multisim examples
741 op amp, B15-B18
active-filter-tuned oscillator, B77-B79
CE amplifier with emitter resistance, B27-B30
class B BJT output stage, B50-B55
CMOS CS amplifier, B30-B33
CS amplifier, B23-B25
dependence of BJT $\beta$ on bias current, B26-B27
design of dc power supply, B18-B21
design of fifth-order Chebyshev filter, B69-B71
folded-cascade amplifier, B43-B46
frequency compensation of two-stage CMOS op amp, B55-B60
frequency response of CMOS CS amplifier, B40-B43
loop gain of feedback amplifier, B46-B50
multistage differential BJT amplifier, B33-B40
operation of CMOS inverter, B60-B63
operation of ECL gate, B64-B69
operation of two-integrator loop filter, B71-B74
performance of noninverting amplifier, B13-B15
voltage-doubler circuit, B21-B22
Wien-Bridge oscillator, B75-B77
$p$ type, 139
PU (pull-up) switch, 1105
Pull-down (PD) switch, 1105
Pull-down network (PDN), 1092, 1096-1097
Pull-up (PU) switch, 1105
Pull-up network (PUN), 1092, 1096-1097, 1168
Pull-up resistor, 1105
Pull-up transistor, AM31
Pulse-generation circuit, 1274-1276
one-shot or monostable multivibrator circuit, $1275-1276$
ring oscillator, 1274, 1275
Pulse response of single-time-constant (STC) circuit, E13-E15
Pulsewidth modulation, 225
PUN (pull-up network), 1092, 1096-1097, 1168
Punch-through, 289
Push-pull, 624, 929

## Q

Q2N3904 BJT, B26, B27, B34, B49, B84, B85, B88
Q2N3906 BJT, B34
QECL, B65o15
Q-enhancement, B73
QMJE243, B50o13
QMJE253, B50n13
Quadrature oscillator, 1392-1394
Quantization error, 13
Quantized, 13
Quasi-stable state, 1414, 1418
Quiescent current $I_{Q}$, design of BJT op amp, 1070-1073
Quiescent point, 198, 371

## $\mathbf{R}$

Radio-frequency choke, 1365
Radio-frequency identification (RFID), 772
Rail-to-rail input common-mode range, design of BJT op amp, 1055
Rail-to-rail input operation, folded-cascode CMOS op amp, 1024-1026
Random-access memory (RAM), 1250, 1282S
Random-access memory (RAM) cells, 1253-1262, 1283S, 1285-1286P
dynamic memory (DRAM) cell, 1260-1262
static memory (SRAM) cell, 1253-1260
Random offset, 663
Rapid analysis, diode forward characteristic, 192-193
Rated output voltage, 110
Rate of closure, 889
Reactance, 34
Reactive ion etching (RIE), A3
Read-only memory (ROM), 1250, 1276-1281, 1283S, 1287P
mask-programmable ROMs, 1278-1279
MOS ROM, 1276-1278
programmable, (PROMs, EPROMs, and flash), $1279-1281$
Read operation, 1251
static memory (SRAM) cell, 1254-1257
Read/write memory, 1250
Recapitulation, $n p n$ transistor in active mode, $312-313$
Recombination, 137
Recombination process, 308
Recovery period, 1418
Rectifier, 177-178, 230S
Rectifier circuit, 207-220, 240-242P
bridge, 212-213
full-wave, 210-211
half-wave, 208-210
peak, 213-219
precision half-wave, 219-220
rectifier with filter capacitor, 213-219
superdiode, 219-220
Rectifies, 178
Reduction in nonlinear distortion, negative feedback, 819-820
Reference bias current, 741 BJT op amp, 1032
Reference current, 511
Refresh, 1238, 1261
Regazzini, John R., 88
Regenerative process, 1405
Regions of operation, pseudo-NMOS inverter, 1187
Relationship between mobility and diffusivity, 148, 169
Resistance, standard values, J1
Resistance-reflection rule, 435
Resistively loaded MOS amplifier, 768-772
Resistively loaded MOS inverter, 1107-1111
Resistivity, 144, 169
Resistor, 45P, 510, A10
Reverse biased, 176
Reverse-bias region, junction diodes, 189, G4
Reverse breakdown, $p n$ junction, 162-164

Reverse breakdown region, zener diodes, 202-207, 239-240P
Reverse Early voltage, B12
R,
determining, 29
input resistance, 23
Ringing, AM56
Ring oscillator, 1274, 1275
Ripple, 208
Ripple bandwidth, 1295
Ripple voltage, 216
Rise and fall times, 1128
R,
determining, 29
input resistance, 23
ROM (read-only memory), 1250, 1283S
Root-locus diagram, 878, 883
Row-address decoder, 1271-1272
Row decoder, 1251

## S

s-domain analysis, F1-F6, F6-F7P
Bode plots, F3-F6
first-order functions, F2-F3
poles, F2
zeros, F2
Sallen-and-Key circuit, 1342, 1343
Sampling, 12
Saturate, 258
Saturation, finite output resistance in, 271-273
Saturation current, 160, 170, 186, 189, 309
Saturation mode
BJT, 306, 307
BJT operation in, 316-318
Saturation region, 259, 266, 275
Saturation resistance, 329-331
Saturation voltage, 329-331
Scale current, 160, 186, 312
Scaling
device and voltage, 1170
technology, 1169-1170
Schmitt trigger, 1408
Schottky-bartter diode (SBD), 227, 1066, AM6-AM7
Schottky diode field-effect transistor (SDFL) logic, AM26
Schottky transistor-transistor logic, AM46
Secondary winding, 207
Second-breakdown, 973
Second-order active filter
all-pass circuit, 1325, 1329
Antoniou inductance-simulation circuit, 1322-1323
design data, 1328, 1335
inductor replacement, 1322-1329, 1373-1374P
KHN biquad, 1332
op amp-RC resonator, 1323-1325
realization of filter types, 1325, 1326, 1326-1328
Tow-Thomas biquad, 1334, 1335
two-integrator-loop biquad, 1334-1335
two-integrator-loop topology, 1330-1335, 1369S, 1374P
Second-order filter functions, 1311-1315, 1326-1328, 1371-1372P
Second-order LCR resonator, 1316-1321, 1368-1369S, 1372-1373P
realization of all-pass function, 1318, 1321
realization of bandpass function, 1318, 1319
realization of high-pass function, 1318, 1319
realization of low-pass function, 1317, 1318, 1319
realization of notch functions, 1318, 1319-1321
realization of transmission zeros, 1317, 1318
resonator natural modes, 1316-1317
Second-order transconductance-C filter, 1351-1354
Second stage
741 BJT op amp, 1045-1046
741 circuit, 1029, 1030-1031
Second-stage bias, 741 BJT op amp, 1035
Selected, 1251
Select gate, 1279
Selectivity factor, 1293
Self-bootstrapped, AM16
Self-limiting oscillator, 1399
Semiconductor
capacitive effects in $p n$ junction, 164-167
current flow in, 142-148, 171P
diffusion current, 145-147
diode, 219
doped, 139-141, 171P
drift current, 142-144
Einstein relationship,
equations, 169, 170
integrated circuit, 135
intrinsic, 136-138, 171P
$p n$ junction with applied voltage, 155-164
$p n$ junction with open-circuit terminals, $149-153$
relationship between diffusion and mobility, 148
Semiconductor memory, 1249-1252, 1284-1285P
main memory, 1250
mass storage, 1250
memory-chip organization, 1250-1252
memory-chip timing, 1252
random-access memory (RAM), 1250
read-only memory, 1250
read/write, 1250
Sense amplifier, 1251, 1263-1270, 1286-1287P
alternative, 1268-1270
differential operation of dynamic RAMs, 1267-1268
operation of, 1265-1266
positive feedback, 1263-1265
precharging arrangements, 1268, 1269
Sensing, feedback principle, 840
Sensitivity, 1344-1347, 1369S, 1375P
Sequential circuit, 1237
Sequential memory, 1250
Serial memory, 1250
Series-series feedback, 906-909P
ideal transconductance amplifier, 844, 845
practical case, 844,846
topology, 872
transconductance amplifier, 844-855, 872, 906-909P
Series-shunt feedback, 820, 821-822, 872, 901-905P
ideal voltage amplifier, 829-831
Multisim of two-stage CMOS op amp with, B110-B115
practical voltage amplifier, 823-828
topology, 820-821, 865, 872
Set/reset (SR) flip-flop, 1240-1241
CMOS implementation of, 1241-1242
CMOS implementation of clocked, 1242, 1247
Shallow trench isolation (STI), A7, A8
Sheet resistance, 1228P
Shockley, William, 248, 320, 405
Shockley Semiconductor Laboratory, 405
Shoot-through current, 970
Short-base diode, 173P
Short-channel, 1171
Short-channel effects, G17
Short-circuit admittance, two-port network, C1-C3
Short-circuit protection, 927
741 circuit, 1028
class AB output stage, 949
Short-circuit-timeconstants, 707, 708-710
Shunt regulator, zener diode, 204-206
Shunt-series feedback
current amplifier, 865-870, 914-917P
ideal, 865,866
topology, 872
Shunt-shunt feedback
topology, 872
transresistance amplifier, 855-864, 909-914P
SiGe, 1226
BiCMOS process, A13, A14
Signal, 6-7, 9, 48P
amplification, $15-16$
amplifier, 16
analog and digital, 12-15
differential and common-mode, 63
frequency spectrum, $9-11$
load, 7
Norton form, 6
processing, 6
separating, and dc quantities, 386
source, 6-9
Thévenin form, 6
time-varying quantity, 9, 373
Signal-flow diagram, feedback, 808-809
Signal generator and waveform-shaping circuit
astable multivibrators, 1412-1416, 1434P
bistable multivibrators, 1404-1411, 1433P
crystal oscillators, 1396-1404, 1431-1433P
integrated-circuit (IC) timer, 1419-1423, 1435P
LC-tuned oscillators, 1396-1404, 1431-1433P
monostable multivibrator, 1417-1418, 1434-1435P
nonlinear waveform-shaping circuits, 1424-1427, 1435-1436P
op amp-RC oscillator circuits, 1388-1396, 1430-1431P
precision rectifier circuit, AM69-AM77, AM77-AM78P
sinusoidal oscillators, 1380-1388, 1428-1430P
Signal ground, 423
body effect, 397
common-base amplifier, 473
common-source amplifier, 467
Signal-to-interference ratio, 817, 818
Signal transmission, emitter-coupled logic, AM57-AM58
Signal waveform, class A output stage, 925-926
Silicon, A1
Silicon area, 1169
Silicon chip, 5
Silicon dioxide $\left(\mathrm{SiO}_{2}\right), \mathrm{A} 1, \mathrm{~A} 2$
Silicon germanium (SiGe), 1226, A13, A14
Silicon Valley, 405
Silicon wafers, IC fabrication, A2
Simulations. See Multisim examples; PSpice examples
Simple cascode configuration, GaAs amplifier, AM15-AM17
Simplified equivalent circuit, two-stage CMOS op amp, 1004
Simplified model, 741 BJT op amp, 1052-1053
Sine-wave shaper, 1424
Sine-wave signal, $9,10,44 \mathbf{S}$
Single-amplifier biquadratic active filter, 1336-1344, 1369S, 1374-1375P
generation of equivalent feedback loops, $1341-1344$
injecting the input signal, 1339-1340
synthesis of feedback loop, 1336-1339
Single-amplifier biquads (SABs), 1336
Single-ended outputs, 608
Single limiters, 222
Single-op-amp difference amplifier, 78-81
Single-pole model, 107
Single-pole response, amplifier with, 877-878
Single-supply operation, class B output stage, 934
Single-time-constant (STC) circuit, E16-E17P
classification of, E4-E5
evaluating time constant, E1-E3
frequency response of, E6-E9
high-pass circuits, E5, E8-E9, E11, E14-E15
low-pass circuits, E5, E6-E7, E10-E11, E13-E14
pulse response of, E13-E15
rules for finding type of, E4
step response of, E10-E11
Single-time-constant (STC) network, 35-38, 44S
Single-tuned amplifier, 1360
Sinusoidal oscillator
analysis of oscillator circuits, 1382, 1384
basic principles of, 1380-1388, 1428-1430P
nonlinear amplitude control, 1385
oscillation criterion, 1381-1382
oscillator feedback loop, 1380-1381
popular limiter circuit for amplitude control, $1386-1388$
SI unit prefixes, J2
Six-transistor cell, 1254
Slewing, 112
Slew rate (SR), 112-113
741 BJT op amp, 1053-1054
folded-cascade CMOS op amp, 1022
slew rate limited, 112
two-stage CMOS op amp, 1007-1008
Small-scale-integrated (SSI), 1181
Small-signal analysis, 741 BJT op amp, 1038-1051
Small-signal approximation, 197, 400
Small-signal condition, 384
Small-signal diffusion capacitance, 717
Small-signal emitter-degeneration resistance, B27
Small-signal equivalent circuit, 387
Small-signal model, 387, 4344
Small-signal operation and model, 383-422, 483-489P
base current and input resistance at base, $402-403$
BJT case, 399-419, G8-G9
BJT differential pair, 620-627
collector current, 400-401
current mirrors, 523-525
dc bias point, 383, 399, 400
diode forward characteristic, 195-200
emitter current and input resistance at emitter, $403-404$
hybrid- $\sigma$ model, 407-408
junction field-effect transistor (JFET), AM4
modeling the body effect, 397-398
MOS differential pair, 607-610
MOSFET case, 383-398, G8-G9
performing analysis on circuit diagram, $418-419$
pnp transistor, 409
separating dc analysis and signal analysis, 386
separating signal and dc quantities, 406-407
signal current in drain terminal, 384
small-signal equivalent circuit models, 386-388
summary tables, 420-422
T equivalent-circuit model, 394-395
T model, 408-409, 410, G5
transconductance, 388-389, 400-401
voltage gain, 385-386, 405-406
Small-signal voltage gain
bipolar junction transistor (BJT) amplifier, $377-378$

MOSFET amplifier, 374-375
Soft limiting, 222
Solar cell, 228
Solid circuit, 511
Source
n+, of MOSFET, 248
wideband amplification, 778-780
Source-absorption theorem, D3
Source degeneration, wideband amplification, $778-780$
Source-degeneration resistance, 433
Source follower, 423, 442-449
characteristic parameters of, 443-445
high-frequency response of, 761-765, 799-800P
transfer function, 761-763
transfer function analysis, 763-765
Space-charge region, 150
SPICE device models, B1-B12
BJT model, B9-B12
diode model, B4-B5
MOSFET models, B5-B9
Multisim examples, B79-B131
op-amp model, B1-B4
PSpice examples, B13-B79
zener diode model, B5
SPICE simulation, 116P, 193, 209, 230P, 292P,328, 333, 355P, 455, 480P, 576, 674P, 713, 719, 789P, 896, 963, 1074,1135, 1156P, 1176, 1183, 1335, G4
biasing, 493-497P, 576P
BJT circuit, 360P, 362P
CMOS cascode amplifier, 587P
CMOS inverter, 1159P, 1161P
common-mode rejection, 682P
current-mirror circuit, 589-590P
diodes, 230P, 240P
discrete-circuit amplifier, 497-498P
feedback, 902P, 909P, 916P, 919P
ideal op amp, 118P
MOS, 483P, 491-492P
MOS differential pair, 674P, 688-689P
MOSFET, 303P, 493P, 494P
output stages, 983P, 987P
Splitting pole, 892-893
Sprague Electric Company, 525
Square-law MOSFET model, B5, G17
SRAM (static memory) cell, 1253-1260, 1283 S
read operation, 1254-1257
write operation, 1257-1260
Stability problem, 917P
feedback, 871, 873-875
Nyquist plot, 873-875
transfer function of feedback amplifier, 871, 873
Stability study
alternative approach, 887-889
Bode plots, 885-889, 918P
effect of phase margin on closed-loop response, 886
gain and phase margins, 885
Stable circuit, F2
Stacked-gate cell, 1279
Stagger-tuned amplifier, 1367-1368, H1-H5
Standard cells, 1183
Standard resistance values, J1
Static characteristics, pseudo-NMOS inverter, $1184-1186$
Static power dissipation, 1149
Static random-access memory (SRAM) cell, 1253-1260, 1283S
read operation, 1254-1257
write operation, 1257-1260
Static sequential circuits, 1238
STC. See Single-time-constant (STC) circuit
Step response of single-time-constant (STC) circuit, E10-E11
Stopband, 1293, 1294
Stopping, 1293
Storage capacitor, 1260
Subthreshold conduction, deep-submicron design, $1177-1178$
Subthreshold region, 264, 528
Superdiode, 219-220, AM69-AM70, AM76
Superior circuit, difference amplifier, 82-85
Supply power, class B bipolar output stage, B119
Susceptance, 34
Sustained oscillation, 1382
Sustaining voltage, 352
Swartzel, Karl D. Jr., 88
Switch
CMOS transmission gates, 1199-1205
NMOS transistors, 1194-1196
Switched-capacitor filter, 1292, 1354-1359, 1369S, 1376-1377P
basic principle, 1354-1356
practical circuits, 1356-1359
Switch-level transistor model, CMOS logic-gate circuit, 1090-1091
Symbol convention, amplifier, 22
Synchronously tuned, 1367
Synchronous tuning, tuned amplifier, 1367-1368
Synthesis method, CMOS logic-gate circuit, 1098, 1099
Systematic analysis, feedback voltage amplifiers, 828-834, 901-905P
Systematic offset, 663
System on a chip, AM63
Systematic offset, B37
Systematic output dc offset, 998

## T

T model
BJT, 408-409, 410, 422
MOS, 628, 629
MOSFET, 394-395, 607, 608
MOSFET and BJT, G5
Taiwan Semiconductor Manufacturing Company, 1213
Technology generation, 1168
Technology scaling, 1178-1179, 1227-1229P
$t_{1 / 2}-t_{2 / 3}$ characteristics, 1172-1175
implications, 1169-1170
interconnect, 1178-1179
inverter characteristics, 1176
MOSFET model, 1176-1177
process variations, 1178
silicon area, 1169
subthreshold conduction, 1177-1178
temperature, 1178
velocity saturation, 1171-1177
voltage, 1178
wiring, 1178-1179
Telescopic cascode, $556 n$
Temco, 206
Temperature, 1178
bipolar junction transistor (BJT), 353-354
emitter-coupled logic (ECL), AM59
MOSFET, 289
Temperature coefficient TC, 206
T equivalent-circuit model, MOSFET amplifier, 394-395
Terminal characteristics of junction diodes, 184-190, 234-235P
Texas Instruments (TI), 511, 525
Thermal dissipation, BJT safe operating area, 973-974
Thermal resistance, power transistors, 976-977
Thermal runaway, 941, 974
Thermal shutdown, class AB output stage, 950
Thermal voltage, 148, 186
Thévenin equivalent circuit, 46P, D5P

Thévenin theorem, D1, D2, E2
Three-stage amplifier, 26, 27
Three-terminal device, 454
BJT, 305
MOSFET, 247, 250
Threshold voltage, 251
Time constant
evaluating, for single-time-constant (STC) circuit, E1-E3
method of short-circuit, 707, 708-710
Timer, integrated-circuit, 1419-1423, 1435P
Toggling, 1258
Topology, feedback, 820-821, 840-841, 872, 901-905P
Total harmonic distortion (THD), 921, 1426
class B bipolar output stage, B121-B122
Total instantaneous, 22
Totem-pole configuration, 1224, AM63
Totem-pole output stage, AM31
Tow-Thomas biquad, 1334, 1335, B73, B74
Traitorous Eight, 405
Transconductance amplifier, 28
feedback, 844-855, 872, 906-909P
feedback topology, 872
ideal, 844,845
practical, 844,846
topology, 872
Transconductance $\mathrm{g}_{\mathrm{tr}}, 384,401$
741 op-amp circuit, 1039
BJT, 325
body, 397
MOSFET, 384, 388-389, 421
MOSFET and BJT, 400-401
NMOS and opn transistor, G5, G9
two-stage CMOS op amp, 1010-1011
Transconductance-C filter, 1292, 1347-1354, 1369S, 1375-1376P
basic building blocks, 1349-1351
methods for IC filter implementation, 1347-1348
second-order, 1351-1354
transconductors, 1348-1349
Transconductor, transconductance-C filter, 1348-1349
Transducer, 6
Transfer characteristic, 17, 44S
bistable circuit, 1406-1407
class A output stage, 924-925
class B output stage, 929-930
transistor-transistor logic (TTL), AM39-AM41
Transfer function, 33, 44S, 1292
analysis of source-follower, 763-765
filter, 1292, 1296-1299, 1368S, 1370P
obtaining, 761-763
Transfer function pole, 1297, F2
Transfer function zero, 1297, F2
Transformer, tuned amplifier, 1363-1364
Transistor. See bipolar junction transistor (BJT); power transistor
Transistor amplifier
basic configurations, 423-454
basic principles, 368-382, 480-483P
basis for amplifier operation, 368-369
biasing, 454-466, 479S, 493-497P
bipolar junction transistor (BJT) case, 399-419
characterizing amplifiers, 424-426
common-base (CB) amplifier, 439-442
common-emitter (CE) amplifier, 428-429, 431
common-gate (CG) amplifier, 439-442
common-source (common-emitter) amplifier with source (emitter) resistance, 431-437
common-source (CS) amplifier, 421, 427-428
deciding on location for bias point Q, 381-382
determining voltage-transfer characteristic
(VTC) by graphical analysis, 380-381
discrete-circuit amplifier, 467-478, 497-505P
emitter follower parameters, 445-448
MOSFET case, 383-398
obtaining linear amplifier by biasing the transistor, 371-374
obtaining voltage amplifier, 369-370
output resistance, 453-454
small-signal models of BJT, 422, G8-G9
small-signal models of MOSFET, 421, G8-G9
small-signal operation and models, 383-422, 483-489P
small-signal voltage gain, 374-378
source and emitter followers, 442-449
source follower parameters, 443-445
summary tables, $420-422$
summary tables and comparisons, 452-453
systematic procedure for analysis of, 421
Thévenin representation of emitter-follower output, 448,449
three basic configurations, 423-424
voltage-transfer characteristic (VTC), 370-371
Transistor breakdown, bipolar junction transistor (BJT), 351-353
Transistor case, and heat sink, 978-981
Transistor Conference, 659
Transistor pairing, 567-573, 591-593P
CC-CB and CD-CG configurations, 572-573
CC-CE, CD-CS, and CD-CE configurations, 567-569
Darlington configuration, 571-572
integrated-circuit source follower, 568-569
Transistor power dissipation, class B bipolar output stage, B120-121
Transistor sizing, 1139-1148, 1154S, 1162-1163P
CMOS inverter, 1139-1140
CMOS logic gates, 1141-1145
driving a large capacitance, 1146-1148
fan-in and fan-out on propagation delay, 1145
Transistor-transistor logic (TTL or T²), AM27-AM38
analysis when input is high, AM35-AM36
analysis when input is low, AM36-AM38
characteristics of standard TTL, AM39-AM46
complete circuit of TTL gate, AM34-AM35
dynamic power dissipation, AM42
evolution of, from DTL, AM27
function of 130-D resistance, AM38
input circuit of TTL gate, AM28-AM30
logic circuits, AM44-AM46
manufacturers' specifications, AM41
output circuit of TTL gate, AM30-AM31
propagation delay, AM42
Schottky TTL, AM46
slow response of DTL, AM28
transfer characteristic, AM39-AM41
TTL families, AM46
TTL NAND gate, AM43-AM44
Transition band, 1293, 1294
Transition frequency, 715, 720, 1009, G6, G12
Transition region, 1101
Transition time, 1128
Transmission, filter, 1292-1293
Transmission line, B68
Transmission zeros, 1297, 1317, 1318, F2
Transresistance amplifier, 28, 44S
shunt-shunt feedback, 855-864, 909-914P topology, 872
Tree decoder, 1274
Triangular waveforms, 1415-1416
Trigger, 1407
Trigger signal, 1407
Triode region, 259, 266, 275
Tristate transistor-transistor logic, AM45
Truth table, 1241
TTL. See Transistor-transistor logic (TTL)
Tuned amplifier, 43, 1359-1368, 1369S, 1377P
amplifiers with multiple tuned circuits, 1365-1366
basic principle, 1360-1361
Tuned amplifier continued
cascode and CC-CB cascade, 1366
inductor losses, 1362-1363
stagger tuning, 1367-1368
synchronous tuning, 1367-1368
use of transformers, 1363-1364
Turned on, 176
Twin-well, A7, A8
Two-input NAND gate, CMOS logic-gate circuit, 1095-1096
Two-input NOR gate, CMOS logic-gate circuit, 1094-1095
Two-integrator-loop biquad
alternative, 1334-1335
circuit implementation, 1332-1333
derivation of, 1330-1332
Two-integrator-loop filter, finite op-amp bandwidth, B71-B74
Two-integrator-loop topology, second-order active filter, 1330-1335, 1369S, 1374P
Two-pole response, amplifier with, 878-883
Two-port network
characterization of linear, C1-C6, C7P
equivalent-circuit representation, C5-C6
$g$-parameter, C5
$h$-parameter, C4-C5
$y$-parameter, C1-C3
$z$-parameter, C3-C4
Two-power supply, classical bias arrangement, $464-465$
Two-stage CMOS op amp, 659-663, 996-1012, 1073S, 1074-1076P
bias circuit for, 1010-1012
circuit, 997-998
common-mode rejection ratio (CMRR), 1001, B100-B101
configuration, 660, 997
dc voltage gain, 999-1001
design trade-offs, 1009-1010
frequency compensation, B55-B60, B122-B127
frequency response, 1002-1006
hand design, B98-B99
input common-mode range, B100
input common-mode range and output swing, 998-999
input offset voltage, 663, B101-B102
Multisim examples, B97-B102, B122-B127
output voltage range, B101
phase margin, 1005-1006
power-supply rejection ratio (PSRR), 1008-1009
PSpice example, B55-B60
simplified equivalent circuit, 1004
slew rate, 1007-1008
simulation, B99-B102
verifying A,, B99-B100
voltage gain, 660-661
Two-stage CMOS op amp with series-shunt feedback, B110-B115
hand design, B111-B112
investigating effect of feedback, B115
Multisim example, B110-B115
simulation, B112-B115
verifying A, B112, B113
verifying A,, B114-B115
verifying A,, B112

## $\mathbf{U}$

Ultra-thin-body (UTB) device, A17
Unconditionally stable, 878
Uncovered, 150

Unilateral, 29, 425
Unit, 334
Unity-gain amplifier, 75
Unity-gain bandwidth, 106, 720, 1052, 1076P
Unity-gain frequency, B3, G13
Universal active filter, 1332

## V

Vacuum tubes, 59, 88, 149, 176
Varactor, 228
$V_{\text {ab }}$ multiplier, biasing class AB circuit, 942-944
Velocity saturation, 975
deep-submicron processes, 1171-1177
$i_{\mathrm{D}}-v_{\text {im }}$ characteristics, 1172-1175
inverter characteristics, 1176
MOSFET, 290
MOSFET model, 1176-1177
Vertical pnp transistor, G3
Very-large-scale-integrated, 1181. See also VLSI
Virtual ground, 65, 608, 1040
Virtual short circuit, 65
VLSI (very-large-scale integrated circuits), 1181 technology, A1
beyond 20 nm technology, A16-A18
BiCMOS process, A12
capacitors, A10-A11
integrated devices, A9
lateral pnp transistor, A12
layout, A14-A16
MOSFETs, A9-A10
$p$-base and pinched-based resistors, A12-A13
$p n$ junction diodes, A11
processes, A6-A13
resistors, A10
SiGe BiCMOS process, A13, A14
twin-well CMOS process, A7-A9
Voltage, 1178
Voltage amplifier
circuit model, 16, 23-25, 28
feedback topology, 820-821, 865, 872
ideal case, 829-831
MOSFET, 369
practical case, 823-838
series-shunt feedback, 820, 821-822, 872, 901-905P
Voltage buffer, 536
emitter follower, 442-443
Voltage-controlled switch, 1103
Voltage divider, 45-46P
Voltage doubler, 226, B21-B22
Voltage follower, noninverting configuration, $75-76$
Voltage gain, 17, 44S
741 BJT op amp, 1050-1051
BJT amplifier, 405-406
distribution in cascode amplifier, 552-554
folded-cascode CMOS op amp, 1020-1021
MOSFET amplifier, 385-386
two-stage CMOS op amp, 660-661
Voltage gain of amplifier proper, 426
Voltage-mixing, voltage-sampling, 820
Voltage regulator, 200
Voltage scaling, 1170
Voltage signal, 9
Voltage-transfer characteristic (VTC)
CMOS class AB output stage, 956-958
CMOS inverter, 1117-1120, 1155, B129-B131
derivation of, 1186-1188
determining by graphical analysis, 380-381
digital logic inverter, 1100-1101, 1103
emitter-coupled logic (ECL), AM52-AM57
transistor amplifier, 370-371

## W

Wafers, A2
Wanless, Frank Marion, 1117
Waveform, square and triangular, using astable multivibrator, 1412-1416
Waveform shaping, 1424
Waveform-shaping circuit. See also Signal generator and waveform-shaping circuit
nonlinear, 1424-1427, 1435-1436P
Weak avalanche, 289
Weighted-summer circuit, 71-72, 73
Western Electric Company, 807
Wet, A4
Wet etching, A4
Wet oxidation, A2
Wideband amplifier configurations, 778-788, 801-805P
CC-CB configuration, 786-788
CC-CE configuration, 781
CD-CE configuration, 781
CD-CG configuration, 786-788
CD-CSconfiguration, 781
source and emitter degeneration, 778-780
Wide-swing current mirror, folded-cascode CMOS op amp, 1026-1027
Widlar, Robert J., 565e, 962, 966
Widlar current source, 565-567, 576S
Width of depletion region, 151, 153, 169
Wien, Max, 1390
Wien-bridge oscillator, 1388-1391, 1428S, B75-B77
Wilson current mirror, 560-562, 576S
Wilson MOS mirror, 563-564
Wire, flying, 511
Wired-OR capability, emitter-coupled logic (ECL), 1223, AM62
Wiring, deep-submicron design, 1178-1179
Wiring capacitance, 1136
Word lines, 1251
Write operation
memory chip, 1252
static memory (SRAM) cell, 1257-1260

## $\mathbf{X}$

XOR function, CMOS logic circuit, 1097-1098

## Y

Yamatake, Mineo, 962

## Z

Zener diode, 202, 229S
reverse breakdown region, 202-207, 239-240P
specifying and modeling, 203-204
SPICE model, B5
temperature effects, 206-207
use as shunt regulator, 204-206
Zener effect, 163
Zero, B103, F2
Zero frequency, inspection, 705
Zero gate voltage, MOSFET operation, 250
Zero-threshold devices, 1199
# 9.7 DATA CONVERTERS-AN INTRODUCTION 

In this section we begin the study of another group of analog IC circuits of great importance; namely, data converters.

### 9.7.1 Digital Processing of Signals

Most physical signals, such as those obtained at transducer outputs, exist in analog form. Some of the processing required on these signals is most conveniently performed in an analog fashion. For instance, in instrumentation systems it is quite common to use a high-input-impedance, high-gain, high-CMRR differential amplifier right at the output of the transducer. This is usually followed by a filter whose purpose is to eliminate interference. However, further signal processing is usually required, which can range from simply obtaining a measurement of signal strength to performing some algebraic manipulations on this and related signals to obtain the value of a particular system parameter of interest, as is usually the case in systems intended to provide a complex control function. Another example of signal processing can be found in the common need for transmission of signals to a remote receiver.

Many such forms of signal processing can be performed by analog means. In earlier chapters we encountered circuits for implementing a number of such tasks. However, an attractive alternative exists: It is to convert, following some initial analog processing, the signal from analog to digital form and then use economical, accurate, and convenient digital ICs to perform digital signal processing. Such processing can in its simplest form provide us with a measure of the signal strength as an easy-to-read number (consider, e.g., the digital voltmeter). In more involved cases the digital signal processor can perform a variety of arithmetic and logic operations that implement a filtering algorithm. The resulting digital filter does many of the same tasks that an analog filter performs-namely, eliminate interference and noise. Yet another example of digital signal processing is found in digital communications systems, where signals are transmitted as a sequence of binary pulses, with the obvious advantage that corruption of the amplitudes of these pulses by noise is, to a large extent, of no consequence.

Once digital signal processing has been performed, we might be content to display the result in digital form, such as a printed list of numbers. Alternatively, we might require an analog output. Such is the case in a telecommunications system, where the usual output may be audible speech. If such an analog output is desired, then obviously we need to convert the digital signal back to an analog form.

It is not our purpose here to study the techniques of digital signal processing. Rather, we shall examine the interface circuits between the analog and digital domains. Specifically, we shall study the basic techniques and circuits employed to convert an analog signal to digital form (analog-to-digital or simply A/D conversion) and those used to convert a digital signal to analog form (digital-to-analog or simply D/A conversion). Digital circuits are studied in Chapters 10 and 11.

### 9.7.2 Sampling of Analog Signals

The principle underlying digital signal processing is that of sampling the analog signal. Figure 9.36 illustrates in a conceptual form the process of obtaining samples of an analog signal. The switch shown closes periodically under the control of a periodic pulse signal (clock). The closure time of the switch, $\tau$, is relatively short, and the samples obtained are

(a)


FIGURE 9.36 The process of periodically sampling an analog signal. (a) Sample-and-hold (S/H) circuit. The switch closes for a small part ( $\tau$ seconds) of every clock period $(T)$. (b) Input signal waveform. (c) Sampling signal (control signal for the switch). (d) Output signal (to be fed to A/D converter).
stored (held) on the capacitor. The circuit of Fig. 9.36 is known as a sample-and-hold (S/H) circuit. As indicated, the $\mathrm{S} / \mathrm{H}$ circuit consists of an analog switch that can be implemented by a MOSFET transmission gate (Section 10.5), a storage capacitor, and (not shown) a buffer amplifier.

Between the sampling intervals-that is, during the hold intervals-the voltage level on the capacitor represents the signal samples we are after. Each of these voltage levels is then fed to the input of an A/D converter, which provides an $N$-bit binary number proportional to the value of signal sample.

The fact that we can do our processing on a limited number of samples of an analog signal while ignoring the analog-signal details between samples is based on the Shannon's sampling theorem [see Lathi (1965)].
# 9.7.3 Signal Quantization 

Consider an analog signal whose values range from 0 to +10 V . Let us assume that we wish to convert this signal to digital form and that the required output is a 4-bit digital signal. ${ }^{4}$ We know that a 4-bit binary number can represent 16 different values, 0 to 15 ; it follows that the resolution of our conversion will be $10 \mathrm{~V} / 15=\frac{2}{3} \mathrm{~V}$. Thus an analog signal of 0 V will be represented by $0000, \frac{2}{3} \mathrm{~V}$ will be represented by $0001,6 \mathrm{~V}$ will be represented by 1001 , and 10 V will be represented by 1111 .

All these sample numbers are multiples of the basic increment $\left(\frac{2}{3} \mathrm{~V}\right)$. A question now arises regarding the conversion of numbers that fall between these successive incremental levels. For instance, consider the case of a $6.2-\mathrm{V}$ analog level. This falls between $18 / 3$ and 20/3. However, since it is closer to $18 / 3$ we treat it as if it were 6 V and code it as 1001 . This process is called quantization. Obviously errors are inherent in this process; such errors are called quantization errors. Using more bits to represent (encode or, simply, code) an analog signal reduces quantization errors but requires more complex circuitry.

### 9.7.4 The A/D and D/A Converters as Functional Blocks

Figure 9.37 depicts the functional block representations of A/D and D/A converters. As indicated, the A/D converter (also called an ADC) accepts an analog sample $v_{A}$ and produces an N -bit digital word. Conversely, the D/A converter (also called a DAC) accepts an $n$-bit digital word and produces an analog sample. The output samples of the D/A converter are often fed to a sample-and-hold circuit. At the output of the S/H circuit a staircase waveform, such as that in Fig. 9.38, is obtained. The staircase waveform can then be smoothed by a


FIGURE 9.37 The A/D and D/A converters as circuit blocks.


FIGURE 9.38 The analog samples at the output of a D/A converter are usually fed to a sample-and-hold circuit to obtain the staircase waveform shown. This waveform can then be filtered to obtain the smooth waveform, shown in color. The time delay usually introduced by the filter is not shown.

[^0]
[^0]:    ${ }^{4}$ Bit stands for binary digit.low-pass filter, giving rise to the smooth curve shown in color in Fig. 9.38. In this way an analog output signal is reconstructed. Finally, note that the quantization error of an A/D converter is equivalent to $\pm \frac{1}{2}$ least significant bit $\left(b_{N}\right)$.

# EXERCISE 

9.31 An analog signal in the range 0 to +10 V is to be converted to an 8 -bit digital signal. What is the resolution of the conversion in volts? What is the digital representation of an input of 6 V ? What is the representation of an input of 6.2 V ? What is the error made in the quantization of 6.2 V in absolute terms and as a percentage of the input? As a percentage of full scale? What is the largest possible quantization error as a percentage of full scale?
Ans. $0.0392 \mathrm{~V} ; 10011001 ; 10011110 ;-0.0064 \mathrm{~V} ;-0.1 \%;-0.064 \% ; 0.196 \%$

### 9.8 D/A CONVERTER CIRCUITS

### 9.8.1 Basic Circuit Using Binary-Weighted Resistors

Figure 9.39 shows a simple circuit for an $N$-bit D/A converter. The circuit consists of a reference voltage $V_{\text {REF }}, N$ binary-weighted resistors $R, 2 R, 4 R, 8 R, \ldots, 2^{N-1} R, N$ single-pole double-throw switches $S_{1}, S_{2}, \ldots, S_{N}$, and an op amp together with its feedback resistance $R_{f}=R / 2$.

The switches are controlled by an $N$-bit digital input word $D$,

$$
D=\frac{b_{1}}{2^{1}}+\frac{b_{2}}{2^{2}}+\cdots+\frac{b_{N}}{2^{N}}
$$

where $b_{1}, b_{2}$, and so on are bit coefficients that are either 1 or 0 . Note that the bit $b_{N}$ is the least significant bit (LSB) and $b_{1}$ is the most significant bit (MSB). In the circuit in Fig. 9.39, $b_{1}$ controls switch $S_{1}, b_{2}$ controls $S_{2}$, and so on. When $b_{i}$ is 0 , switch $S_{i}$ is in position 1 , and when $b_{i}$ is 1 switch $S_{i}$ is in position 2 .

Since position 1 of all switches is ground and position 2 is virtual ground, the current through each resistor remains constant. Each switch simply controls where its corresponding current goes: to ground (when the corresponding bit is 0 ) or to virtual ground (when the corresponding bit is 1 ). The currents flowing into the virtual ground add up, and the sum flows


FIGURE 9.39 An $N$-bit D/A converter using a binary-weighted resistive ladder network.
through the feedback resistance $R_{f}$. The total current $i_{O}$ is therefore given by

$$
\begin{aligned}
i_{O} & =\frac{V_{\mathrm{REF}}}{R} b_{1}+\frac{V_{\mathrm{REF}}}{2 R} b_{2}+\cdots+\frac{V_{\mathrm{REF}}}{2^{N-1} R} b_{N} \\
& =\frac{2 V_{\mathrm{REF}}}{R}\left(\frac{b_{1}}{2^{1}}+\frac{b_{2}}{2^{2}}+\cdots+\frac{b_{N}}{2^{N}}\right)
\end{aligned}
$$

Thus,

$$
i_{O}=\frac{2 V_{\mathrm{REF}}}{R} D
$$

and the output voltage $v_{O}$ is given by

$$
v_{O}=-i_{O} R_{f}=-V_{\mathrm{REF}} D
$$

which is directly proportional to the digital word $D$, as desired.
It should be noted that the accuracy of the DAC depends critically on (1) the accuracy of $V_{\text {REF }}$, (2) the precision of the binary-weighted resistors, and (3) the perfection of the switches. Regarding the third point, we should emphasize that these switches handle analog signals; thus their perfection is of considerable interest. While the offset voltage and the finite on resistance are not of critical significance in a digital switch, these parameters are of immense importance in analog switches. The use of MOSFETs to implement analog switches will be discussed in Chapter 10. Also, we shall shortly see that in practical circuit implementations of the DAC, the binary-weighted currents are generated by current sources. In this case the analog switch can be realized using the differential-pair circuit, as will be shown shortly.

A disadvantage of the binary-weighted resistor network is that for a large number of bits $(N>4)$ the spread between the smallest and largest resistances becomes quite large. This implies difficulties in maintaining accuracy in resistor values. A more convenient scheme exists utilizing a resistive network called the $R-2 R$ ladder.

# 9.8.2 $R$-2R Ladders 

Figure 9.40 shows the basic arrangement of a DAC using an $R-2 R$ ladder. Because of the small spread in resistance values, this network is usually preferred to the binary-weighted scheme discussed earlier, especially for $N>4$. Operation of the $R-2 R$ ladder is straightforward. First, it can be shown, by starting from the right and working toward the left, that the


FIGURE 9.40 The basic circuit configuration of a DAC utilizing an $R-2 R$ ladder network.
resistance to the right of each ladder node, such as that labeled X , is equal to $2 R$. Thus the current flowing to the right, away from each node, is equal to the current flowing downward to ground, and twice that current flows into the node from the left side. It follows that

$$
I_{1}=2 I_{2}=4 I_{3}=\cdots=2^{N-1} I_{N}
$$

Thus, as in the binary-weighted resistive network, the currents controlled by the switches are binary weighted. The output current $i_{O}$ will therefore be given by

$$
i_{O}=\frac{V_{\mathrm{REF}}}{R} D
$$

# 9.8.3 A Practical Circuit Implementation 

A practical circuit implementation of the DAC utilizing an $R-2 R$ ladder is shown in Fig. 9.41. The circuit utilizes BJTs to generate binary-weighted constant currents $I_{1}, I_{2}, \ldots, I_{N}$, which are switched between ground and virtual ground of an output summing op amp (not shown). We shall first show that the currents $I_{1}$ to $I_{N}$ are indeed binary-weighted, with $I_{1}$ corresponding to the MSB and $I_{N}$ corresponding to the LSB of the DAC.

Starting at the two rightmost transistors, $Q_{N}$ and $Q_{t}$, we see that if they are matched, their emitter currents will be equal and are denoted $\left(I_{N} / \alpha\right)$. Transistor $Q_{t}$ is included to provide proper termination of the $R-2 R$ network. The voltage between the base line of the BJTs and node $N$ will be

$$
V_{N}=V_{B E_{N}}+\left(\frac{I_{N}}{\alpha}\right)(2 R)
$$



FIGURE 9.41 A practical circuit implementation of a DAC utilizing an $R-2 R$ ladder network.
where $V_{B E_{N}}$ is the base-emitter voltage of $Q_{N}$. Since the current flowing through the resistor $R$ connected to node $N$ is $\left(2 I_{N} / \alpha\right)$, the voltage between node B and node $(N-1)$ will be

$$
V_{N-1}=V_{N}+\left(\frac{2 I_{N}}{\alpha}\right) R=V_{B E_{N}}+\frac{4 I_{N}}{\alpha} R
$$

Assuming, for the moment, that $V_{B E_{N-1}}=V_{B E_{N}}$, we see that a voltage of $\left(4 I_{N} / \alpha\right) R$ appears across the resistance $2 R$ in the emitter of $Q_{N-1}$. Thus $Q_{N-1}$ will have an emitter current of $\left(2 I_{N} / \alpha\right)$ and a collector current of $\left(2 I_{N}\right)$, twice the current in $Q_{N}$. The two transistors will have equal $V_{B E}$ drops if their junction areas are scaled in the same proportion as their currents, which is usually done in practice.

Proceeding in the manner above we can show that

$$
I_{1}=2 I_{2}=4 I_{3}=\cdots=2^{N-1} I_{N}
$$

under the assumption that the EBJ areas of $Q_{1}$ to $Q_{N}$ are scaled in a binary-weighted fashion.
Next consider op amp $A_{1}$, which, together with the reference transistor $Q_{\text {REF }}$, forms a negative-feedback loop. (Convince yourself that the feedback is indeed negative.) A virtual ground appears at the collector of $Q_{\text {REF }}$ forcing it to conduct a collector current $I_{\text {REF }}=$ $V_{\text {REF }} / R_{\text {REF }}$ independent of whatever imperfections $Q_{\text {REF }}$ might have. Now, if $Q_{\text {REF }}$ and $Q_{1}$ are matched, their collector currents will be equal,

$$
I_{1}=I_{\mathrm{REF}}
$$

Thus, the binary-weighted currents are directly related to the reference current, independent of the exact values of $V_{B E}$ and $\alpha$. Also observe that op amp $A_{1}$ supplies the base currents of all the BJTs.

# 9.8.4 Current Switches 

Each of the single-pole double-throw switches in the DAC circuit of Fig. 9.41 can be implemented by a circuit such as that shown in Fig. 9.42 for switch $S_{m}$. Here $I_{m}$ denotes the current flowing in the collector of the $m$ th-bit transistor. The circuit is a differential pair with the


FIGURE 9.42 Circuit implementation of switch $S_{m}$ in the DAC of Fig. 9.41. In a BiCMOS technology, $Q_{m s}$ and $Q_{m r}$ can be implemented using MOSFETs, thus avoiding the inaccuracy caused by the base current of BJTs.
base of the reference transistor $Q_{m r}$ connected to a suitable dc voltage $V_{\text {BIAS }}$, and the digital signal representing the $m$ th bit $b_{m}$ applied to the base of the other transistor $Q_{m s}$. If the voltage representing $b_{m}$ is higher than $V_{\text {BIAS }}$ by a few hundred millivolts, $Q_{m s}$ will turn on and $Q_{m r}$ will turn off. The bit current $I_{m}$ will flow through $Q_{m s}$ and onto the output summing line. On the other hand, when $b_{m}$ is low, $Q_{m s}$ will be off and $I_{m}$ will flow through $Q_{m r}$ to ground.

The current switch of Fig. 9.42 is simple and features high-speed operation. It suffers, however, from the fact that part of the current $I_{m}$ flows through the base of $Q_{m s}$ and thus does not appear on the output summing line. More elaborate circuits for current switches can be found in Grebene (1984). Also, in a BiCMOS technology the differential-pair transistors $Q_{m s}$ and $Q_{m r}$ can be replaced with MOSFETs, thus eliminating the base current problem.

# EXERCISES 

9.32 What is the maximum resistor ratio required by a 12-bit D/A converter utilizing a binary-weighted resistor network?
Ans. 2048
9.33 If the input bias current of an op amp, used as the output summer in a 10-bit DAC, is to be no more than that equivalent to $\frac{1}{4}$ LSB, what is the maximum current required to flow in $R_{f}$ for an op amp whose bias current is as great as $0.5 \mu \mathrm{~A}$ ?
Ans. 2.046 mA

### 9.9 A/D CONVERTER CIRCUITS

There exist a number of A/D conversion techniques varying in complexity and speed. We shall discuss four different approaches: two simple, but slow, schemes, one complex (in terms of the amount of circuitry required) but extremely fast method, and, finally, a method particularly suited for MOS implementation.

### 9.9.1 The Feedback-Type Converter

Figure 9.43 shows a simple A/D converter that employs a comparator, an up/down counter, and a D/A converter. The comparator circuit provides an output that assumes one of two


FIGURE 9.43 A simple feedback-type A/D converter.
distinct values: positive when the difference input signal is positive, and negative when the difference input signal is negative. We shall study comparator circuits in Chapter 13. An up/down counter is simply a counter that can count either up or down depending on the binary level applied at its up/down control terminal. Because the A/D converter of Fig. 9.43 employs a DAC in its feedback loop it is usually called a feedback-type A/D converter. It operates as follows: With a 0 count in the counter, the D/A converter output, $v_{O}$, will be zero and the output of the comparator will be high, instructing the counter to count the clock pulses in the up direction. As the count increases, the output of the DAC rises. The process continues until the DAC output reaches the value of the analog input signal, at which point the comparator switches and stops the counter. The counter output will then be the digital equivalent of the input analog voltage.

Operation of the converter of Fig. 9.43 is slow if it starts from zero. This converter however, tracks incremental changes in the input signal quite rapidly.

# 9.9.2 The Dual-Slope A/D Converter 

A very popular high-resolution (12- to 14-bit) (but slow) A/D conversion scheme is illustrated in Fig. 9.44. To see how it operates, refer to Fig. 9.44 and assume that the analog input signal $v_{A}$ is negative. Prior to the start of the conversion cycle, switch $S_{2}$ is closed, thus discharging capacitor $C$ and setting $v_{1}=0$. The conversion cycle begins with opening $S_{2}$ and connecting the integrator input through switch $S_{1}$ to the analog input signal. Since $v_{A}$ is negative, a current $I=v_{A} / R$ will flow through $R$ in the direction away from the integrator. Thus $v_{1}$ rises linearly with a slope of $I / C=v_{A} / R C$, as indicated in Fig. 9.44(b). Simultaneously, the counter is enabled and it counts the pulses from a fixed-frequency clock. This phase of the conversion process continues for a fixed duration $T_{1}$. It ends when the counter has accumulated a fixed count denoted $n_{\text {REF }}$. Usually, for an $N$-bit converter, $n_{\text {REF }}=2^{N}$. Denoting the peak voltage at the output of the integrator as $V_{\text {PEAK }}$, we can write with reference to Fig. 9.44(b)

$$
\frac{V_{\text {PEAK }}}{T_{1}}=\frac{v_{A}}{R C}
$$

At the end of this phase, the counter is reset to zero.
Phase II of the conversion begins at $t=T_{1}$ by connecting the integrator input through switch $S_{1}$ to the positive reference voltage $V_{\text {REF }}$. The current into the integrator reverses direction and is equal to $V_{\text {REF }} / R$. Thus $v_{1}$ decreases linearly with a slope of $\left(V_{\text {REF }} / R C\right)$. Simultaneously the counter is enabled and it counts the pulses from the fixed-frequency clock. When $v_{1}$ reaches zero volts, the comparator signals the control logic to stop the counter. Denoting the duration of phase II by $T_{2}$, we can write, by reference to Fig. 9.44(b),

$$
\frac{V_{\text {PEAK }}}{T_{2}}=\frac{V_{\text {REF }}}{R C}
$$

Equations (9.115) and (9.116) can be combined to yield

$$
T_{2}=T_{1}\left(\frac{v_{A}}{V_{\mathrm{REF}}}\right)
$$

Since the counter reading, $n_{\mathrm{REF}}$, at the end of $T_{1}$ is proportional to $T_{1}$ and the reading, $n$, at the end of $T_{2}$ is proportional to $T_{2}$, we have

$$
n=n_{\mathrm{REF}}\left(\frac{v_{A}}{V_{\mathrm{REF}}}\right)
$$


FIGURE 9.44 The dual-slope A/D conversion method. Note that $v_{A}$ is assumed to be negative.


FIGURE 9.45 Parallel, simultaneous, or flash A/D conversion.

Thus the content of the counter, ${ }^{5} n$, at the end of the conversion process is the digital equivalent of $v_{A}$.

The dual-slope converter features high accuracy, since its performance is independent of the exact values of $R$ and $C$. There exist many commercial implementations of the dualslope method, some of which utilize CMOS technology.

# 9.9.3 The Parallel or Flash Converter 

The fastest A/D conversion scheme is the simultaneous, parallel, or flash conversion process illustrated in Fig. 9.45. Conceptually, flash conversion is very simple. It utilizes $2^{N}-1$ comparators to compare the input signal level with each of the $2^{N}-1$ possible quantization levels. The outputs of the comparators are processed by an encoding-logic block to provide the $N$ bits of the output digital word. Note that a complete conversion can be obtained within one clock cycle.

Although flash conversion is very fast, the price paid is a rather complex circuit implementation. Variations on the basic technique have been successfully employed in the design of IC converters.

### 9.9.4 The Charge-Redistribution Converter

The last A/D conversion technique that we shall discuss is particularly suited for CMOS implementation. As shown in Fig. 9.46, the circuit utilizes a binary-weighted capacitor array, a voltage comparator, and analog switches; control logic (not shown in Fig. 9.46) is also required. The circuit shown is for a 5-bit converter; capacitor $C_{T}$ serves the purpose of terminating the capacitor array, making the total capacitance equal to the desired value of $2 C$.

Operation of the converter can be divided into three distinct phases, as illustrated in Fig. 9.46. In the sample phase (Fig. 9.46a) switch $S_{B}$ is closed, thus connecting the top plate of all capacitors to ground and setting $v_{O}$ to zero. Meanwhile, switch $S_{A}$ is connected to the analog input voltage $v_{A}$. Thus the voltage $v_{A}$ appears across the total capacitance of $2 C$, resulting in a stored charge of $2 C v_{A}$. Thus, during this phase, a sample of $v_{A}$ is taken and a proportional amount of charge is stored on the capacitor array.

[^0]
[^0]:    ${ }^{5}$ Note that $n$ is not a continuous function of $v_{A}$, as might be inferred from Eq. (9.118). Rather, $n$ takes on discrete values corresponding to one of the $2^{N}$ quantized levels of $v_{A}$.


FIGURE 9.46 Charge-redistribution A/D converter suitable for CMOS implementation: (a) sample phase, (b) hold phase, and (c) charge-redistribution phase.

During the hold phase (Fig. 9.46b), switch $S_{B}$ is opened and switches $S_{1}$ to $S_{5}$, and $S_{T}$ are thrown to the ground side. Thus the top plate of the capacitor array is open-circuited while their bottom plates are connected to ground. Since no discharge path has been provided, the capacitor charges must remain constant, with the total equal to $2 C v_{A}$. It follows that the voltage at the top plate must become $-v_{A}$. Finally, note that during the hold phase, $S_{A}$ is connected to $V_{\text {REF }}$ in preparation for the charge-redistribution phase.
Next, we consider the operation during the charge-redistribution phase illustrated in Fig. 9.46(c). First, switch $S_{1}$ is connected to $V_{\text {REF }}$ (through $S_{A}$ ). The circuit then consists of $V_{\text {REF }}$, a series capacitor $C$, and a total capacitance to ground of value $C$. This capacitive divider causes a voltage increment of $V_{\mathrm{REF}} / 2$ to appear on the top plates. Now, if $v_{A}$ is greater than $V_{\mathrm{REF}} / 2$, the net voltage at the top plate will remain negative, which means that $S_{1}$ will be left in its new position as we move on to switch $S_{2}$. If, on the other hand, $v_{A}$ was smaller than $V_{\mathrm{REF}} / 2$, then the net voltage at the top plate would become positive. The comparator will detect this situation and signal the control logic to return $S_{1}$ to its ground position and then to move on to $S_{2}$.

Next, switch $S_{2}$ is connected to $V_{\text {REF }}$, which causes a voltage increment of $V_{\mathrm{REF}} / 4$ to appear on the top plate. If the resulting voltage is still negative, $S_{2}$ is left in its new position; otherwise, $S_{2}$ is returned to its ground position. We then move on to switch $S_{3}$, and so on until all the bit switches $S_{1}$ to $S_{5}$ have been tried.

It can be seen that during the charge-redistribution phase the voltage on the top plate will be reduced incrementally to zero. The connection of the bit switches at the conclusion of this phase gives the output digital word; a switch connected to ground indicates a 0 value for the corresponding bit, whereas connection to $V_{\text {REF }}$ indicates a 1 . The particular switch configuration depicted in Fig. 9.46(c) is for $D=01101$. Observe that at the end of the conversion process, all the charge is stored in the capacitors corresponding to 1 bits; the capacitors of the 0 bits have been discharged.

The accuracy of this A/D conversion method is independent of the value of stray capacitances from the bottom plate of the capacitors to ground. This is because the bottom plates are connected either to ground or to $V_{\text {REF }}$; thus the charge on the stray capacitances will not flow into the capacitor array. Also, because both the initial and the final voltages on the top plate are zero, the circuit is also insensitive to the stray capacitances between the top plates and ground. ${ }^{6}$ The insensitivity to stray capacitances makes the charge-redistribution technique a reasonably accurate method capable of implementing A/D converters with as many as 10 bits.

# EXERCISES 

9.34 Consider the 5-bit charge-redistribution converter in Fig. 9.46 with $V_{\text {REF }}=4 \mathrm{~V}$. What is the voltage increment appearing on the top plate when $S_{5}$ is switched? What is the full-scale voltage of this converter? If $v_{A}=2.5 \mathrm{~V}$, which switches will be connected to $V_{\text {REF }}$ at the end of conversion?
Ans. $\frac{1}{8} \mathrm{~V} ; \frac{31}{8} \mathrm{~V} ; S_{1}$ and $S_{3}$
9.35 Express the maximum quantization error of an $N$-bit A/D converter in terms of its least-significant bit (LSB) and in terms of its full-scale analog input $V_{F S}$.
Ans. $\pm \frac{1}{2} \mathrm{LSB} ; V_{F S} / 2\left(2^{N}-1\right)$

### 9.10 SPICE SIMULATION EXAMPLE

We conclude this chapter with an example to illustrate the use of SPICE in the simulation of the two-stage CMOS op amp.

[^0]
[^0]:    ${ }^{6}$ More precisely, the final voltage can deviate from zero by as much as the analog equivalent of the LSB. Thus, the insensitivity to top-plate capacitance is not complete.# 5.11 THE JUNCTION FIELD-EFFECT TRANSISTOR (JFET) 

The junction field-effect transistor, or JFET, is perhaps the simplest transistor available. It has some important characteristics, notably a very high input resistance. Unfortunately, however (for the JFET), the MOSFET has an even higher input resistance. This, together with the many other advantages of MOS transistors, has made the JFET virtually obsolete. Currently, its applications are limited to discrete-circuit design, where it is used both as an amplifier and as a switch. Its integrated-circuit applications are limited to the design of the differential input stage of some operational amplifiers, where advantage is taken of its high input resistance (compared to the BJT). In this section, we briefly consider JFET operation and characteristics. Another important reason for including the JFET in the study of electronics is that it helps in understanding the operation of gallium arsenide devices, the subject of the next section.

## Device Structure

As with other FET types, the JFET is available in two polarities: $n$-channel and $p$-channel. Fig. 5.69(a) shows a simplified structure of the $n$-channel JFET. It consists of a slab of $n$-type silicon with $p$-type regions diffused on its two sides. The $n$ region is the channel, and the $p$-type regions are electrically connected together and form the gate. The device operation is based on reverse-biasing the $p n$ junction between gate and channel. Indeed, it is the reverse bias on this junction that is used to control the channel width and hence the current flow from drain to source. The major role that this $p n$ junction plays in the operation of this FET has given rise to its name: Junction Field-Effect Transistor (JFET).


FIGURE 5.69 (a) Basic structure of $n$-channel JFET. This is a simplified structure utilized to explain device operation. (b) Circuit symbol for the $n$-channel JFET. (c) Circuit symbol for the $p$-channel JFET.
It should be obvious that a $p$-channel device can be fabricated by simply reversing all the semiconductor types, thus using $p$-type silicon for the channel and $n$-type silicon for the gate regions.

Figures 5.69 (b) and (c) show the circuit symbols for JFETs of both polarities. Observe that the device polarity ( $n$-channel or $p$-channel) is indicated by the direction of the arrowhead on the gate line. This arrowhead points in the forward direction of the gate-channel pn junction. Although the JFET is a symmetrical device whose source and drain can be interchanged, it is useful in circuit design to designate one of these two terminals as source and the other as drain. The circuit symbol achieves this designation by placing the gate closer to the source than to the drain.

# Physical Operation 

Consider an $n$-channel JFET and refer to Fig. 5.70(a). (Note that to simplify matters, we will not show the electrical connection between the gate terminals; it is assumed, however, that the two terminals labeled G are joined together.) With $v_{G S}=0$, the application of a voltage $v_{D S}$ causes current to flow from the drain to the source. When a negative $v_{G S}$ is applied, the depletion region of the gate-channel junction widens and the channel becomes correspondingly narrower; thus the channel resistance increases and the current $i_{D}$ (for a given $v_{D S}$ ) decreases. Because $v_{D S}$ is small, the channel is almost of uniform width. The JFET is simply operating as a resistance whose value is controlled by $v_{G S}$. If we keep increasing $v_{G S}$ in the negative direction, a value is reached at which the depletion region occupies the entire channel. At this value of $v_{G S}$ the channel is completely depleted of charge carriers (electrons); the channel has in effect disappeared. This value of $v_{G S}$ is therefore the threshold voltage of the device, $V_{t}$, which is obviously negative for an $n$-channel JFET. For JFETs the threshold voltage is called the pinch-off voltage and is denoted $V_{P}$.

Consider next the situation depicted in Fig. 5.70(b). Here $v_{G S}$ is held constant at a value greater (that is, less negative) than $V_{P}$, and $v_{D S}$ is increased. Since $v_{D S}$ appears as a voltage drop across the length of the channel, the voltage increases as we move along the channel from source to drain. It follows that the reverse-bias voltage between gate and channel varies at different points along the channel and is highest at the drain end. Thus the channel acquires a tapered shape and the $i_{D}-v_{D S}$ characteristic becomes nonlinear. When the reverse bias at the drain end, $v_{G D}$, falls below the pinch-off voltage $V_{P}$, the channel is pinched off at the drain end and the drain current saturates. The remainder of the description of JFET operation follows closely that given for the depletion MOSFET.

The description above clearly indicates that the JFET is a depletion-type device. Its characteristics should therefore be similar to those of the depletion-type MOSFET. This is true with a very important exception: While it is possible to operate the depletion-type MOSFET in the enhancement mode (by simply applying a positive $v_{G S}$ if the device is $n$ channel) this is impossible in the JFET case. If we attempt to apply a positive $v_{G S}$, the gate-channel pn junction becomes forward biased and the gate ceases to control the channel. Thus the maximum $v_{G S}$ is limited to 0 V , though it is possible to go as high as 0.3 V or so since a $p n$ junction remains essentially cut off at such a small forward voltage.

## Current-Voltage Characteristics

The current-voltage characteristics of the JFET are identical to those of the depletion-mode MOSFET studied in Section 5.3 except that for the JFET the maximum $v_{G S}$ allowed is


FIGURE 5.70 Physical operation of the $n$-channel JFET: (a) For small $v_{D S}$ the channel is uniform and the device functions as a resistance whose value is controlled by $v_{G S}$. (b) Increasing $v_{D S}$ causes the channel to acquire a tapered shape and eventually pinch-off occurs. Note that, though not shown, the two gate regions are electrically connected.
normally 0 V . Furthermore, the JFET is specified in terms of the pinch-off voltage $V_{P}$ (equal to $V_{t}$ of the MOSFET) and the drain-to-source current with the gate shorted to the source, $I_{D S S}$, which corresponds to $\frac{1}{2} k_{0}^{\prime} V_{t}^{2}$ for the MOSFET. With these substitutions, the $n$-channel JFET characteristics can be described as follows:

Cutoff: $v_{G S} \leq V_{P}, i_{D}=0$
Triode region: $V_{P} \leq v_{G S} \leq 0, v_{D S} \leq v_{G S}-V_{P}$

$$
i_{D}=I_{D S S}\left[2\left(1-\frac{v_{G S}}{V_{P}}\right)\left(\frac{v_{D S}}{-V_{P}}\right)-\left(\frac{v_{D S}}{V_{P}}\right)^{2}\right]
$$

Saturation (pinch-off) region: $V_{P} \leq v_{G S} \leq 0, v_{D S} \geq v_{G S}-V_{P}$

$$
i_{D}=I_{D S S}\left(1-\frac{v_{G S}}{V_{P}}\right)^{2}\left(1+\lambda v_{D S}\right)
$$

where $\lambda$ is the inverse of the Early voltage; $\lambda=1 / V_{A}$, and $V_{A}$ and $\lambda$ are positive for $n$-channel devices.

Recalling that for an $n$-channel device, $V_{P}$ is negative, we see that operation in the pinch-off region is obtained when the drain voltage is greater than the gate voltage by at least $\left|V_{P}\right|$.

Since the gate-channel junction is always reverse-biased, only a leakage current flows through the gate terminal. From Chapter 3, we know that such a current is of the order of $10^{-9} \mathrm{~A}$. Although $i_{G}$ is very small, and is assumed zero in almost all applications, it should be noted that the gate current in a JFET is many orders of magnitude greater than the gate current in a MOSFET. Of course the latter is so tiny because of the insulated gate structure. Another complication arises in the JFET because of the strong dependence of gate leakage current on temperature-approximately doubling for every $10^{\circ} \mathrm{C}$ rise in temperature, just as in the case of a reverse-biased diode (see Chapter 3).

# The p-Channel JFET 

The current-voltage characteristics of the $p$-channel JFET are described by the same equations as the $n$-channel JFET. Note, however, that for the $p$-channel JFET, $V_{P}$ is positive, $0 \leq v_{G S} \leq V_{P}, v_{D S}$ is negative, $\lambda$ and $V_{A}$ are negative, and the current $i_{D}$ flows out of the drain terminal. To operate the $p$-channel JFET in pinch-off, $v_{D S} \leq v_{G S}-V_{P}$, which in words means that the drain voltage must be lower than the gate voltage by at least $\left|V_{P}\right|$. Otherwise, with $v_{D S} \geq v_{G S}-V_{P}$, the $p$-channel JFET operates in the triode region.

## The JFET Small-Signal Model

The JFET small-signal model is identical to that of the MOSFET [see Fig. 5.34(b)]. Here, $g_{m}$ is given by

$$
g_{m}=\left(\frac{2 I_{D S S}}{\left|V_{P}\right|}\right)\left(1-\frac{V_{G S}}{V_{P}}\right)
$$

or alternatively by

$$
g_{m}=\left(\frac{2 I_{D S S}}{\left|V_{P}\right|}\right)_{s} \sqrt{\frac{I_{D}}{I_{D S S}}}
$$

where $V_{G S}$ and $I_{D}$ are the dc bias quantities, and

$$
r_{o}=\frac{\left|V_{A}\right|}{I_{D}}
$$

At high frequencies, the equivalent circuit of Fig. 5.67(c) applies with $C_{g s}$ and $C_{g d}$ being both depletion capacitances. Typically, $C_{g s}=1$ to $3 \mathrm{pF}, C_{g d}=0.1$ to 0.5 pF , and $f_{T}=20$ to 100 MHz .
# EXERCISES 

In Exercises 5.43 to 5.46 , let the $n$-channel JFET have $V_{P}=-4 \mathrm{~V}$ and $I_{D S S}=10 \mathrm{~mA}$, and unless otherwise specified assume that in pinch-off (saturation) the output resistance is infinite.
5.43 For $v_{G S}=-2 \mathrm{~V}$, find the minimum $v_{D S}$ for the device to operate in pinch-off. Calculate $i_{D}$ for $v_{G S}=-2 \mathrm{~V}$ and $v_{D S}=3 \mathrm{~V}$.
Ans. $2 \mathrm{~V} ; 2.5 \mathrm{~mA}$
5.44 For $v_{D S}=3 \mathrm{~V}$, find the change in $i_{D}$ corresponding to a change in $v_{G S}$ from -2 to -1.6 V . Ans. 1.1 mA
5.45 For small $v_{D S}$, calculate the value of $r_{D S}$ at $v_{G S}=0 \mathrm{~V}$ and at $v_{G S}=-3 \mathrm{~V}$. Ans. $200 \Omega ; 800 \Omega$
5.46 If $V_{A}=100 \mathrm{~V}$, find the JFET output resistance $r_{o}$ when operating in pinch-off at a current of $1 \mathrm{~mA}, 2.5 \mathrm{~mA}$, and 10 mA .
Ans. $100 \mathrm{k} \Omega ; 40 \mathrm{k} \Omega ; 10 \mathrm{k} \Omega$
D5.47 The JFET in the circuit of Fig. E5.47 has $V_{P}=-3 \mathrm{~V}, I_{D S S}=9 \mathrm{~mA}$, and $\lambda=0$. Find the values of all resistors so that $V_{G}=5 \mathrm{~V}, I_{D}=4 \mathrm{~mA}$, and $V_{D}=11 \mathrm{~V}$. Design for 0.05 mA in the voltage divider.


FIGURE E5.47
Ans. $R_{G 1}=200 \mathrm{k} \Omega ; R_{G 2}=100 \mathrm{k} \Omega ; R_{S}=1.5 \mathrm{k} \Omega ; R_{D}=1 \mathrm{k} \Omega$
5.48 For the JFET circuit designed in Exercise 5.47, let an input signal $v_{i}$ be capacitively coupled to the gate, a large bypass capacitor be connected between the source and ground, and the output signal $v_{o}$ be taken from the drain through a large coupling capacitor. The resulting common-source amplifier is shown in Fig. E5.48. Calculate $g_{m}$ and $r_{o}$ (assuming $V_{A}=100 \mathrm{~V}$ ). Also find $R_{i}, A_{v} \equiv\left(v_{o} / v_{i}\right)$, and $R_{o}$.


Ans. $4 \mathrm{~mA} / \mathrm{V} ; 25 \mathrm{k} \Omega ; 66.7 \mathrm{k} \Omega ;-3.8 \mathrm{~V} / \mathrm{V} ; 962 \Omega$
# 5.12 GALLIUM ARSENIDE (GaAs) DEVICES-THE MESFET ${ }^{10}$ 

The devices discussed thus far, and indeed the devices used in most of the circuits studied in this book, are made of silicon. This reflects the situation that has existed in the microelectronics industry for at least three decades. Furthermore, owing to the advances that are continually being made in silicon device and circuit technologies, the dominance of silicon as the most useful semiconductor material is expected to continue for many years to come. Nevertheless, another semiconductor material has been making inroads into digital applications that require extremely high speeds of operation and analog applications that require very high operating frequencies. We refer to gallium arsenide (GaAs), a compound semiconductor formed of gallium, which is in the third column of the periodic table of elements, and arsenic, which is in the fifth column; thus GaAs is known as a III-V semiconductor.

The major advantage that GaAs offers over silicon is that electrons travel much faster in $n$-type GaAs than in silicon. This is a result of the fact that the electron drift mobility $\mu_{n}$ (which is the constant that relates the electron drift velocity to the electric field; velocity $=\mu_{n} E$ ) is five to ten times higher in GaAs than in silicon. Thus for the same input voltages, GaAs devices have higher output currents, and thus higher $g_{m}$, than the corresponding silicon devices. The larger output currents enable faster charging and discharging of load and parasitic capacitances and thus result in increased speeds of operation.

Gallium arsenide devices have been used for some years in the design of discretecomponent amplifiers for microwave applications (in the $10^{9} \mathrm{~Hz}$ or GHz frequency range). More recently, GaAs has begun to be employed in the design of very-high-speed digital integrated circuits and in analog ICs, such as op amps, that operate in the hundreds of MHz frequency range. Although the technology is still relatively immature, suffering from yield and reliability problems and generally limited to low levels of integration, it offers great potential. Therefore, this book includes a brief study of GaAs devices and circuits. Specifically, the basic GaAs devices are studied in this section; their basic amplifier circuit configurations are discussed in Section 6.8; and GaAs digital circuits are studied in Section 14.8.

## The Basic GaAs Devices

Although there are a number of GaAs technologies currently in various stages of development, we shall study the most mature of these technologies. The active device available in this technology is an $n$-channel field effect transistor known as the metal semiconductor FET or MESFET. The technology also provides a type of diode known as the Schottkybarrier diode (SBD). (Recall that the SBD was briefly introduced in Section 3.9.) The structure of these two basic devices is illustrated by their cross sections, depicted in Fig. 5.71. The GaAs circuit is formed on an undoped GaAs substrate. Since the conductivity of undoped GaAs is very low, the substrate is said to be semi-insulating. This turns out to be an advantage for GaAs technology as it simplifies the process of isolating the devices on the chip from one another, as well as resulting in smaller parasitic capacitances between the devices and the circuit ground.

As indicated in Fig. 5.71, a Schottky-barrier diode consists of a metal-semiconductor junction. The metal, referred to as the Schottky-barrier metal to distinguish it from the different kind of metal used to make a contact (see Long and Butner (1990) for a detailed explanation of the difference), forms the anode of the diode. The $n$-type GaAs forms the

[^0]
[^0]:    ${ }^{10}$ The material in this section is required only for the study of the GaAs circuits in Sections 6.8 and 14.8. Otherwise, this section can be skipped without loss of continuity.


FIGURE 5.71 Cross-section of a GaAs Schottky-barrier diode (SBD) and a MESFET.
cathode. Note that heavily doped $n$-type GaAs (indicated by $n^{+}$) is used between the $n$ region and the cathode metal contact in order to keep the parasitic series resistance low.

The gate of the MESFET is formed by Schottky-barrier metal in direct contact with the $n$-type GaAs that forms the channel region. The channel length $L$ is defined by the length of the gate electrode, and similarly for the width $W$ (in the direction perpendicular to the page). To reduce the parasitic resistances between the drain and source contacts and the channel, the two contacts are surrounded with heavily doped $\left(n^{+}\right)$GaAs.

Since the main reason for using GaAs circuits is to achieve high speed/frequency of operation, the channel length is made as small as possible. Typically $L=0.2-2 \mu \mathrm{~m}$. Also, usually all the transistors on the IC chip are made to have the same length, leaving only the width $W$ of each device to be specified by the circuit designer.

Only $n$-channel MESFETs are available in GaAs technology. This is because holes have a relatively low drift mobility in GaAs, making $p$-channel MESFETs unattractive. The lack of complementary transistors is a definite disadvantage of GaAs technology. Correspondingly, it makes the task of the circuit designer even more challenging than usual.

# Device Operation 

The MESFET operates in a very similar manner to the JFET, with the Schottky metal playing the role of the $p$-type gate of the JFET (refer to Fig. 5.69). Basically, a depletion region forms in the channel below the gate surface, and the thickness of the depletion region is controlled by the gate voltage $v_{G S}$. This in turn effects control over the channel dimensions and thus on the current that flows from drain to source in response to an applied $v_{D S}$. The latter voltage causes the channel to have a tapered shape, with pinch-off eventually occurring at the drain end of the channel.

The most common GaAs MESFETs available are of the depletion type with a threshold voltage $V_{t}$ (or, equivalently, pinch-off voltage $V_{P}$ ) in the range of -0.5 to -2.5 V . These devices can be operated with $v_{G S}$ values ranging from the negative $V_{t}$ to positive values as high as a few tenths of a volt. However, as $v_{G S}$ reaches 0.7 V or so, the Schottky-barrier diode between gate and channel conducts heavily and the gate voltage no longer effectively
controls the drain-to-source current. Gate conduction, which is not possible in MOSFETs, is another definite disadvantage of the MESFET.

Although less common, enhancement-mode MESFETs are available in certain technologies. These normally-off devices are obtained by arranging that the depletion region existing at $v_{G S}=0$ extends through the entire channel depth, thus blocking the channel and causing $i_{D}=0$. To cause current to flow from drain to source the channel must be opened by applying to the gate a positive voltage of sufficient magnitude to reduce the thickness of the depletion region below that of the channel region. Typically, the threshold voltage $V_{t}$ is between 0.1 and 0.3 V .

The above description of MESFET operation suggests that the $i_{D}-v_{D S}$ characteristics should saturate at $v_{D S}=v_{G S}-V_{t}$, as is the case in a silicon JFET. It has been observed, however, that the $i_{D}-v_{D S}$ characteristics of GaAs MESFETs saturate at lower values of $v_{D S}$ and, furthermore, that the saturation voltages $v_{D S \text { sat }}$ do not depend strongly on the value of $v_{G S}$. This "early saturation" phenomenon comes about because the velocity of the electrons in the channel does not remain proportional to the electric field (which in turn is determined by $v_{D S}$ and $L ; E=v_{D S} / L$ ) as is the case in silicon; rather, the electron velocity reaches a high peak value and then saturates (that is, becomes constant independent of $v_{D S}$ ). The velocitysaturation effect is even more pronounced in short-channel devices $(L \leq 1 \mu \mathrm{~m})$, occurring at values of $v_{D S}$ lower than $\left(v_{G S}-V_{t}\right)$.

Finally, a few words about the operation of the Schottky-barrier diode. Forward current is conducted by the majority carriers (electrons) flowing into the Schottky-barrier metal (the anode). Unlike the pn-junction diode, minority carriers play no role in the operation of the SBD. As a result, the SBD does not exhibit minority-carrier storage effects, which give rise to the diffusion capacitance of the pn-junction diode. Thus, the SBD has only one capacitive effect, that associated with the depletion-layer capacitance $C_{j}$.

# Device Characteristics and Models 

A first-order model for the MESFET, suitable for hand calculations, is obtained by neglecting the velocity-saturation effect, and thus the resulting model is almost identical to that of the JFET though expressed somewhat differently in order to correspond to the literature:

$$
\begin{aligned}
& i_{D}=0 \quad \text { for } v_{G S}<V_{t} \\
& i_{D}=\beta\left[2\left(v_{G S}-V_{t}\right) v_{D S}-v_{D S}^{2}\right]\left(1+\lambda v_{D S}\right) \quad \text { for } v_{G S} \geq V_{t}, v_{D S}<v_{G S}-V_{t} \\
& i_{D}=\beta\left(v_{G S}-V_{t}\right)^{2}\left(1+\lambda v_{D S}\right) \quad \text { for } v_{G S} \geq V_{t}, v_{D S} \geq v_{G S}-V_{t}
\end{aligned}
$$

The only differences between these equations and those for the JFETs are (1) the channellength modulation factor, $1+\lambda v_{D S}$, is included also in the equation describing the triode region (also called the ohmic region) simply because $\lambda$ of the MESFET is rather large and including this factor results in a better fit to measured characteristics; and (2) a transconductance parameter $\beta$ is used so as to correspond with the MESFET literature. Obviously, $\beta$ is related to $I_{D S S}$ of the JFET and $k^{\prime}(W / L)$ of the MOSFET. (Note, however, that this $\beta$ has absolutely nothing to do with $\beta$ of the BJT!)

A modification of this model to account for the early saturation effects is given in Hodges and Jackson (1988).

Figure 5.72(a) shows the circuit symbol for the depletion-type $n$-channel GaAs MESFET. Since only one type of transistor ( $n$ channel) is available, all devices will be drawn the

(a)

(b)

FIGURE 5.72 Circuit symbols for (a) an $n$-channel depletiontype GaAs MESFET, and (b) a Schottky-barrier diode (SBD).
same way, and there should be no confusion as to which terminal is the drain and which is the source.

The circuit symbol of the Schottky-barrier diode is depicted in Fig. 5.72(b). In spite of the fact that the physical operation of the SBD differs from that of the $p n$-junction diode, their $i-v$ characteristics are identical. Thus the $i-v$ characteristic of the SBD is given by the same exponential relationship studied in Chapter 3. For the GaAs SBD, the constant $n$ is typically in the range of 1 to 1.2 .

The small-signal model of the MESFET is identical to that of other FET types. The parameter values are given by

$$
\begin{aligned}
g_{m} & =2 \beta\left(V_{G S}-V_{t}\right)\left(1+\lambda V_{D S}\right) \\
r_{o} & \equiv\left[\frac{\partial i_{D}}{\partial v_{D S}}\right]^{-1} \\
& =1 / \lambda \beta\left(V_{G S}-V_{t}\right)^{2}
\end{aligned}
$$

The MESFET, however, has a rather high value for $\lambda\left(0.1\right.$ to $\left.0.3 \mathrm{~V}^{-1}\right)$ which results in a small output resistance $r_{o}$. This turns out to be a serious drawback of GaAs MESFET technology, resulting in low voltage-gain obtainable from each stage. Furthermore, it has been found that $r_{o}$ decreases at high frequencies. Circuit design techniques for coping with the low $r_{o}$ will be presented in Section 6.8.

For easy reference, Table 5.2 gives typical values for device parameters in a GaAs MESFET technology. The devices in this technology have a channel length $L=1 \mu \mathrm{~m}$. The values given are for a device with a width $W=1 \mu \mathrm{~m}$. The parameter values for actual devices can be obtained by appropriately scaling by the width $W$. This process is illustrated in the following example. Unless otherwise specified, the values of Table 5.2 are to be used for the exercises and the end-of-chapter problems.

TABLE 5.2 Typical Parameter Values for GaAs MESFETS and Schottky Diodes in $L=1 \mu \mathrm{~m}$ Technology, Normalized for $W=1 \mu \mathrm{~m}$

$$
\begin{aligned}
V_{t} & =-1.0 \mathrm{~V} \\
\beta & =10^{-4} \mathrm{~A} / \mathrm{V}^{2} \\
\lambda & =0.1 \mathrm{~V}^{-1} \\
I_{S} & =10^{-15} \mathrm{~A} \\
n & =1.1
\end{aligned}
$$
# EXAMPLE 5.11 

Figure 5.73 shows a simple GaAs MESFET amplifier, with the $W$ values of the transistors indicated. Assume that the dc component of $v_{I}$, that is $V_{G S 1}$, biases $Q_{1}$ at the current provided by the current source $Q_{2}$ so that both devices operate in saturation and that the dc output is at half of the supply voltage. Find:
(a) the $\beta$ values for $Q_{1}$ and $Q_{2}$;
(b) $V_{G S 1}$;
(c) $g_{m 1}, r_{o 1}$, and $r_{s 2}$; and
(d) the small-signal voltage gain.


FIGURE 5.73 Circuit for Example 5.11: a simple MESFET amplifier.

## Solution

(a) The values of $\beta$ can be obtained by scaling the value given in Table 5.2 using the specified values of $W$,

$$
\begin{aligned}
& \beta_{1}=100 \times 10^{-4}=10^{-2} \mathrm{~A} / \mathrm{V}^{2}=10 \mathrm{~mA} / \mathrm{V}^{2} \\
& \beta_{2}=50 \times 10^{-4}=5 \times 10^{-3} \mathrm{~A} / \mathrm{V}^{2}=5 \mathrm{~mA} / \mathrm{V}^{2}
\end{aligned}
$$

(b)

$$
\begin{aligned}
I_{D 2} & =\beta_{2}\left(V_{G S 2}-V_{t}\right)^{2}\left(1+\lambda V_{D S 2}\right) \\
& =5(0+1)^{2}(1+0.1 \times 5) \\
& =7.5 \mathrm{~mA} \\
I_{D 1} & =I_{D 2}=7.5 \mathrm{~mA} \\
7.5 & =\beta_{1}\left(V_{G S 1}-V_{t}\right)^{2}\left(1+\lambda V_{D S 1}\right) \\
& =10\left(V_{G S 1}+1\right)^{2}(1+0.1 \times 5)
\end{aligned}
$$

Thus,

$$
V_{G S 1}=-0.3 \mathrm{~V}
$$(c)

$$
\begin{aligned}
g_{m 1} & =2 \times 10(-0.3+1)(1+0.1 \times 5) \\
& =21 \mathrm{~mA} / \mathrm{V} \\
r_{o 1} & =\frac{1}{0.1 \times 10(-0.3+1)^{2}}=2 \mathrm{k} \Omega \\
r_{o 2} & =\frac{1}{0.1 \times 5(0+1)^{2}}=2 \mathrm{k} \Omega
\end{aligned}
$$

(d)

$$
\begin{aligned}
A_{v} & =-g_{m 1}\left(r_{o 1} / / r_{o 2}\right) \\
& =-21 \times(2 / / 2)=-21 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

# EXERCISE 

5.49 For a MESFET with the gate shorted to the source and having $W=10 \mu \mathrm{~m}$, find the minimum voltage between drain and source to operate in saturation. For $V_{D S}=5 \mathrm{~V}$, find the current $I_{D}$. What is the output resistance of this current source?
Ans. $1 \mathrm{~V} ; 1.5 \mathrm{~mA} ; 10 \mathrm{k} \Omega$

As already mentioned, the main reason for using GaAs devices and circuits is their high frequency and high speed of operation. A remark is therefore in order on the internal capacitances and $f_{T}$ of GaAs transistors. For a particular GaAs technology with $L=1 \mu \mathrm{~m}, C_{g s}$ (at $V_{G S}=0 \mathrm{~V}$ ) is $1.6 \mathrm{fF} / \mu \mathrm{m}$-width, and $C_{g d}$ (at $V_{D S}=2 \mathrm{~V}$ ) is $0.16 \mathrm{fF} / \mu \mathrm{m}$-width. Thus for a MESFET with $W=100 \mu \mathrm{~m}, C_{g s}=0.16 \mathrm{pF}$ and $C_{g d}=0.016 \mathrm{pF} . f_{T}$ typically ranges from 5 to 15 GHz .

### 6.8 GaAs AMPLIFIERS ${ }^{3}$

Gallium arsenide (GaAs) technology makes possible the design of amplifiers having very wide bandwidths, in the hundreds of megahertz or even gigahertz range. In this section we shall study some of the circuit design techniques that have been developed over the last few years for the design of GaAs amplifiers. As will be seen, these techniques aim to circumvent the major problem of the MESFET, namely, its low output resistance in saturation. Before proceeding with this section the reader is advised to review the material on GaAs devices presented in Section 5.12.

## Current Sources

Current sources play a fundamental role in the design of integrated-circuit amplifiers, being employed both for biasing and as active loads. In GaAs technology, the simplest way to implement a current source is to connect the gate of a depletion-type MESFET to its source,

[^0]
[^0]:    ${ }^{3}$ This section can be omitted with no loss in continuity.


FIGURE 6.39 (a) The basic MESFET current source; (b) equivalent circuit of the current source; (c) the current source connected to a positive power supply to source currents to loads at voltages $\leq V_{D D}-\left|V_{i}\right|$; (d) the current source connected to a negative power supply to sink currents from loads at voltages $\geq-V_{S S}+|V|$.
as shown in Fig. 6.39(a). Provided that $v_{D S}$ is maintained greater than $\left|V_{i}\right|$, the MESFET will operate in saturation and the current $i_{D}$ will be

$$
i_{D}=\beta V_{i}^{2}\left(1+\lambda v_{D S}\right)
$$

Thus the current source will have the equivalent circuit shown in Fig. 6.39(b), where the output resistance is the MESFET $r_{o}$,

$$
r_{o}=1 / \lambda \beta V_{i}^{2}
$$

In JFET terminology, $\beta V_{i}^{2}=I_{D S S}$ and $\lambda=1 /\left|V_{A}\right|$; thus

$$
r_{o}=\left|V_{A}\right| / I_{D S S}
$$

Since for the MESFET, $\lambda$ is relatively high ( 0.1 to $0.3 \mathrm{~V}^{-1}$ ) the output resistance of the current source of Fig. 6.39(a) is usually low, rendering this current-source realization inadequate for most applications. Before considering means for increasing the effective output resistance of the current source, we show in Fig. 6.39(c) how the basic current source can be connected to source currents to a load whose voltage can be as high as $V_{D D}-\left|V_{i}\right|$. Alternatively, the same device can be connected as shown in Fig. 6.39(d) to sink currents from a load whose voltage can be as low as $-V_{S S}+\left|V_{i}\right|$.

# EXERCISE 

6.23 Using the device data given in Table 5.2 (page 456), find the current provided by a $10-\mu$ m-wide MESFET connected in the current-source configuration. Let the source be connected to a $-5-\mathrm{V}$ supply and find the current when the drain voltage is -4 V . What is the output resistance of the current source? What change in current occurs if the drain voltage is raised by +4 V ?
Ans. $1.1 \mathrm{~mA} ; 10 \mathrm{k} \Omega ; 0.4 \mathrm{~mA}$

## A Cascode Current Source

The output resistance of the current source can be increased by utilizing the cascode configuration as shown in Fig. 6.40. The output resistance $R_{o}$ of the cascode current source can be


FIGURE 6.40 Adding the cascode transistor $Q_{2}$ increases the output resistance of the current source by the factor $g_{m 2} r_{o 2}$; that is, $R_{o}=g_{m 2} r_{o 2} r_{o 1}$.
found by using Eq. (6.116),

$$
R_{o} \approx g_{m 2} r_{o 2} r_{o 1}
$$

Thus, adding the cascode transistor $Q_{2}$ raises the output resistance of the current source by the factor $g_{m 2} r_{o 2}$, which is the intrinsic voltage gain of $Q_{2}$. For GaAs MESFETs, $g_{m 2} r_{o 2}$ is typically 10 to 40 . To allow a wide range of voltages at the output of the cascode current source, $V_{\text {BIAS }}$ should be the lowest value that results in $Q_{1}$ operating in saturation.

# EXERCISE 

D6.24 For the cascode current source of Fig. 6.40 let $V_{S S}=5 \mathrm{~V}, W_{1}=10 \mu \mathrm{~m}$, and $W_{2}=20 \mu \mathrm{~m}$, and assume that the devices have the typical parameter values given in Table 5.2. (a) Find the value of $V_{\text {BIAS }}$ that will result in $Q_{1}$ operating at the edge of the saturation region (i.e., $V_{D S 1}=\left|V_{1}\right|$ ) when the voltage at the output is -3 V . (b) What is the lowest allowable voltage at the current-source output? (c) What value of output current is obtained for $V_{O}=-3 \mathrm{~V}$ ? (d) What is the output resistance of the current source? (e) What change in output current results when the output voltage is raised from -3 V to +1 V ?
Ans. (a) -4.3 V ; (b) -3.3 V ; (c) 1.1 mA ; (d) $310 \mathrm{k} \Omega$; (e) 0.013 mA

## Increasing the Output Resistance by Bootstrapping

Another technique frequently employed to increase the effective output resistance of a MESFET, including the current-source-connected MESFET, is known as bootstrapping. The bootstrapping idea is illustrated in Fig. 6.41(a). Here the circuit inside the box senses the voltage at the bottom node of the current source, $v_{A}$, and causes a voltage $v_{B}$ to appear at the top node of a value

$$
v_{B}=V_{S}+\alpha v_{A}
$$

where $V_{S}$ is the dc voltage required to operate the current-source transistor in saturation $\left(V_{S} \geq\left|V_{1}\right|\right)$ and $\alpha$ is a constant $\leq 1$. The incremental output resistance of the bootstrapped current source can be found by causing the voltage $v_{A}$ to increase by an increment $v_{a}$. From Eq. (6.130) we find that the resulting increment in $v_{B}$ is $v_{b}=\alpha v_{a}$. The incremental current through the current source is therefore $\left(v_{a}-v_{b}\right) / r_{o}$ or $(1-\alpha) v_{a} / r_{o}$. Thus the output resistance $R_{o}$ is

$$
R_{o}=\frac{v_{a}}{(1-\alpha) v_{a} / r_{o}}=\frac{r_{o}}{1-\alpha}
$$


FIGURE 6.41 Bootstrapping of a MESFET current source $Q_{1}$ : (a) basic arrangement; (b) an implementation; (c) small-signal equivalent circuit model of the circuit in (b), for the purpose of determining the output resistance $R_{o}$.

Thus, bootstrapping increases the output resistance by the factor $1 /(1-\alpha)$, which increases as $\alpha$ approaches unity. Perfect bootstrapping is achieved with $\alpha=1$, resulting in $R_{o}=\infty$.

From the above we observe that the bootstrapping circuit senses whatever change occurs in the voltage at one terminal of the current source and causes an almost equal change to occur at the other terminal, thus maintaining an almost constant voltage across the current source and minimizing the change in current through the current-source transistor. The
action of the bootstrapping circuit can be likened to that of a person who attempts to lift himself off the ground by pulling on the straps of his boots (!), the origin of the name of this circuit technique, which, incidentally, predates GaAs technology. Bootstrapping is a form of positive feedback; the signal $v_{b}$ that is fed back by the bootstrapping circuit is in phase with (has the same polarity as) the signal that is being sensed, $v_{a}$. Feedback will be studied formally in Chapter 8.

An implementation of the bootstrapped current source is shown in Fig. 6.41(b). Here transistor $Q_{2}$ is a source follower used to buffer node A , whose voltage is being sensed. The width of $Q_{2}$ is half that of $Q_{1}$ and is operating at half the bias current. (Transistors $Q_{1}$ and $Q_{2}$ are said to operate at the same current density.) Thus $V_{G S}$ of $Q_{2}$ will be equal to that of $Q_{1}$-namely, zero-and hence $V_{C}=V_{A}$. The two Schottky diodes behave as a battery of approximately 1.4 V , resulting in the dc voltage at node E being 1.4 V higher than $V_{C}$. Note that the signal voltage at node C appears intact at node E; only the dc level is shifted. The diodes are said to perform level shifting, a common application of Schottky diodes in GaAs MESFET technology.

Transistor $Q_{3}$ is a source follower that is operating at the same current density as $Q_{1}$, and thus its $V_{G S}$ must be zero, resulting in $V_{B}=V_{E}$. The end result is that the bootstrapping circuit causes a dc voltage of 1.4 V to appear across the current-source transistor $Q_{1}$. Provided that $\left|V_{A}\right|$ of $Q_{1}$ is less than $1.4 \mathrm{~V}, Q_{1}$ will be operating in saturation as required.

To determine the output resistance of the bootstrapped current source, apply an incremental voltage $v_{a}$ to node A, as shown in Fig. 6.41(c). Note that this small-signal equivalent circuit is obtained by implicitly using the T model (including $r_{o}$ ) for each FET and assuming that the Schottky diodes act as a perfect level shifter (that is, as an ideal dc voltage of 1.4 V with zero internal resistance). Analysis of this circuit is straightforward and yields

$$
\alpha \equiv \frac{v_{b}}{v_{a}}=\frac{g_{m 3} r_{o 3} \frac{g_{m 2} r_{o 2}}{g_{m 2} r_{o 2}+1}+\frac{r_{o 3}}{r_{o 1}}}{g_{m 3} r_{o 3}+\frac{r_{o 2}}{r_{o 1}}+1}
$$

which is smaller than, but close to, unity, as required. The output resistance $R_{o}$ is then obtained as

$$
\begin{aligned}
R_{o} \equiv \frac{v_{a}}{i_{a}} & =\frac{r_{o 1}}{1-\alpha} \\
& =r_{o 1} \frac{g_{m 3} r_{o 3}+\left(r_{o 3} / r_{o 1}\right)+1}{g_{m 3} r_{o 3} /\left(g_{m 2} r_{o 2}+1\right)+1}
\end{aligned}
$$

For $r_{o 3}=r_{o 1}$, assuming that $g_{m 3} r_{o 3}$ and $g_{m 2} r_{o 2}$ are $\gg 1$, and using the relationships for $g_{m}$ and $r_{o}$ for $Q_{2}$ and $Q_{3}$, one can show that

$$
R_{o} \simeq r_{o 1}\left(g_{m 3} r_{o 3} / 2\right)
$$

which represents an increase of about an order of magnitude in output resistance. Unfortunately, however, the circuit is rather complex.

# A Simple Cascode Configuration-The Composite Transistor 

The rather low output resistance of the MESFET places a severe limitation on the performance of MESFET current sources and various MESFET amplifiers. This problem can be alleviated by using the composite MESFET configuration shown in Fig. 6.42(a) in place of a


FIGURE 6.42 (a) The composite MESFET and (b) its small-signal model.
single MESFET. This circuit is unique to GaAs MESFETs and works only because of the early-saturation phenomenon observed in these devices. Recall from the discussion in Section 5.12 that early saturation refers to the fact that in a GaAs MESFET the drain current saturates at a voltage $v_{D S \text { sat }}$ that is lower than $v_{G S}-V_{t}$.

In the composite MESFET of Fig. 6.42(a), $Q_{2}$ is made much wider than $Q_{1}$. It follows that since the two devices are conducting the same current, $Q_{2}$ will have a gate-to-source voltage $v_{G S 2}$ whose magnitude is much closer to $\left|V_{t}\right|$ than $\left|v_{G S 1}\right|$ is (thus, $\left|v_{G S 2}\right| \gg\left|v_{G S 1}\right|$ ). For instance, if we use the devices whose typical parameters are given in Table 5.2 and ignore for the moment channel-length modulation $(\lambda=0)$, we find that for $W_{1}=10 \mu \mathrm{~m}$ and $W_{2}=90 \mu \mathrm{~m}$, at a current of $1 \mathrm{~mA}, v_{G S 1}=0$ and $v_{G S 2}=-\frac{2}{3} \mathrm{~V}$. Now, since the drain-tosource voltage of $Q_{1}$ is $v_{D S 1}=-v_{G S 2}+v_{G S 1}$, we see that $v_{D S 1}$ will be positive and close to but lower than $v_{G S 1}-V_{t}\left(\frac{2}{3} \mathrm{~V}\right.$ in our example compared to 1 V$)$. Thus in the absence of early saturation, $Q_{1}$ would be operating in the triode region. With early saturation, however, it has been found that saturation-mode operation is achieved for $Q_{1}$ by making $Q_{2}$ 5 to 10 times wider.

The composite MESFET of Fig. 6.42(a) can be thought of as a cascode configuration, in which $Q_{2}$ is the cascode transistor, but without a separate bias line to feed the gate of the cascode transistor (as in Fig. 6.40). By replacing each of $Q_{1}$ and $Q_{2}$ with their smallsignal models one can show that the composite device can be represented with the equivalent circuit model of Fig. 6.42(b). Thus while $g_{m}$ of the composite device is equal to that of $Q_{1}$, the output resistance is increased by the intrinsic gain of $Q_{2}, g_{m 2} r_{o 2}$, which is typically in the range 10 to 40 . This is a substantial increase and is the reason for the attractiveness of the composite MESFET.

The composite MESFET can be employed in any of the applications that can benefit from its increased output resistance. Some examples are shown in Fig. 6.43. The circuit in Fig. 6.43(a) is that of a current source with increased output resistance. Another view of the operation of this circuit can be obtained by considering $Q_{2}$ as a source follower that causes the drain of $Q_{1}$ to follow the voltage changes at the current-source terminal (node A), thereby bootstrapping $Q_{1}$ and increasing the effective output resistance of the current source. This alternative interpretation of circuit operation has resulted in its alternative name: the self-bootstrapped current source.

The application of the composite MESFET as a source follower is depicted in Fig. 6.43(b). Assuming the bias-current source $I$ to be ideal, we can write for the gain of


FIGURE 6.43 Applications of the composite MESFET: (a) as a current source; (b) as a source follower; and (c) as a gain stage.
this follower

$$
\begin{aligned}
\frac{v_{o}}{v_{i}} & =\frac{r_{o, \mathrm{eff}}}{r_{o, \mathrm{eff}}+\left(1 / g_{m 1}\right)} \\
& =\frac{g_{m 2} r_{o 2} r_{o 1}}{g_{m 2} r_{o 2} r_{o 1}+\left(1 / g_{m 1}\right)}
\end{aligned}
$$

which is much closer to the ideal value of unity than is the gain of a single MESFET source follower.

# EXERCISE 

6.25 Using the device data given in Table 5.2, contrast the voltage gain of a source follower formed using a single MESFET having $W=10 \mu \mathrm{~m}$ with a composite MESFET follower with $W_{1}=10 \mu \mathrm{~m}$ and $W_{2}=$ $90 \mu \mathrm{~m}$. In both cases assume biasing at 1 mA and neglect $\lambda$ while calculating $g_{m}$ (for simplicity).
Ans. Single: $0.952 \mathrm{~V} / \mathrm{V}$; composite: $0.999 \mathrm{~V} / \mathrm{V}$

A final example of the application of the composite MESFET is shown in Fig. 6.43(c). The circuit is a gain stage utilizing a composite MESFET $\left(Q_{1}, Q_{2}\right)$ as a driver and another composite MESFET $\left(Q_{3}, Q_{4}\right)$ as a current-source load. The small-signal gain is given by

$$
\frac{v_{o}}{v_{i}}=-g_{m 1} R_{o}
$$

where $R_{o}$ is the output resistance,

$$
\begin{aligned}
R_{o} & =r_{o, \text { eff }}\left(Q_{1}, Q_{2}\right) / / r_{o, \text { eff }}\left(Q_{3}, Q_{4}\right) \\
& =g_{m 2} r_{o 2} r_{o 1} / / g_{m 4} r_{o 4} r_{o 3}
\end{aligned}
$$


FIGURE 6.44 A simple MESFET differential amplifier.

# Differential Amplifiers 

The simplest possible implementation of a differential amplifier in GaAs MESFET technology is shown in Fig. 6.44. Here $Q_{1}$ and $Q_{2}$ form the differential pair, $Q_{3}$ forms the bias current source, and $Q_{4}$ forms the active (current-source) load. The performance of the circuit is impaired by the low output resistances of $Q_{3}$ and $Q_{4}$. The voltage gain is given by

$$
\frac{v_{o}}{v_{i}}=-g_{m 2}\left(r_{o 2} / / r_{o 4}\right)
$$

The gain can be increased by using one of the improved current-source implementations discussed above. Also, a rather ingenious technique has been developed for enhancing the gain of the MESFET differential pair. The circuit is shown in Fig. 6.45(a). While the drain


FIGURE 6.45 (a) A MESFET differential amplifier whose gain is enhanced by the application of positive feedback through the source follower $Q_{3}$; (b) small-signal analysis of the circuit in (a).
of $Q_{2}$ is loaded with a current-source load (as before), the output signal developed is fed back to the drain of $Q_{1}$ via the source follower $Q_{3}$. The small-signal analysis of the circuit is illustrated in Fig. 6.45(b) where the current sources $I$ and $I / 2$ have been assumed ideal and thus replaced with open circuits. To determine the voltage gain, we have grounded the gate terminal of $Q_{2}$ and applied the differential input signal $v_{i}$ to the gate of $Q_{1}$. The analysis proceeds along the following steps:

1. From the output node we see that $i_{d 2}=0$.
2. From the sources node, since $i_{d 2}=0$, we find that $i_{d 1}=0$.
3. From the node at the drain of $Q_{1}$, since $i_{d 1}=0$, we find that $i_{d 3}=0$.
4. Writing for each transistor

$$
i_{d}=g_{m} v_{q s}+v_{d s} / r_{o}=0
$$

we obtain three equations in the three unknowns $v_{d 1}, v_{o}$, and $v_{o}$. The solution yields

$$
\frac{v_{o}}{v_{i}}=g_{m 1} r_{o 1} /\left[\frac{g_{m 1} r_{o 1}+1}{g_{m 2} r_{o 2}+1}-\frac{g_{m 3} r_{o 3}}{g_{m 3} r_{o 3}+1}\right]
$$

If all three transistors have the same geometry and are operating at equal dc currents, their $g_{m}$ and $r_{o}$ values will be equal and the expression in Eq. (6.139) reduces to

$$
\frac{v_{o}}{v_{i}} \approx\left(g_{m} r_{o}\right)^{2}
$$

Thus application of positive feedback through follower $Q_{3}$ enables one to obtain a gain equal to the square of that naturally available from a single stage!

# EXERCISE 

6.26 Using the device data given in Table 5.2, find the gain of the differential amplifier circuit of Fig. 6.45(a) for $I=10 \mathrm{~mA}$ and $W_{1}=W_{2}=W_{3}=100 \mu \mathrm{~m}$.
Ans. $784 \mathrm{~V} / \mathrm{V}$

### 14.8 GALLIUM-ARSENIDE DIGITAL CIRCUITS

We conclude our study of digital-circuit families with a discussion of logic circuits implemented using the emerging technology of gallium arsenide. An introduction to this technology and its two basic devices, the MESFET and the Schottky-barrier diode (SBD), was given in Section 5.12. We urge the reader to review Section 5.12 before proceeding with the study of this section.

The major advantage that GaAs technology offers is a higher speed of operation than currently achievable using silicon devices. Gate delays of 10 to 100 ps have been reported for GaAs circuits. The disadvantages are a relatively high power dissipation per gate ( 1 to 10 mW ); relatively small voltage swings and, correspondingly, narrow noise margins; low packing density, mostly as a result of the high-power dissipation per gate; and low manufacturing yield. The present state of affairs is that a few specialized manufacturers produce SSI, MSI, and some LSI digital circuits performing relatively specialized functions, with a cost per gate considerably higher than that of silicon digital ICs. Nevertheless, the very high


FIGURE 14.47 A DCFL GaAs gate implementing a two-input NOR function. The gate is shown driving the input transistor $Q_{3}$ of another gate.
speeds of operation achievable in GaAs circuits make it a worthwhile technology whose applications will possibly grow.

Unlike the CMOS logic circuits that we have studied in Chapter 13, and the bipolar logic families that we have studied in earlier sections of this chapter, there are no standard GaAs logic-circuit families. The lack of standards extends not only to the topology of the basic gates but also to the power-supply voltages used. In the following we present examples of the most popular GaAs logic gate circuits.

# Direct-Coupled FET Logic (DCFL) 

Direct-coupled FET logic (DCFL) is the simplest form of GaAs digital logic circuits. The basic gate is shown in Fig. 14.47. The gate utilizes enhancement MESFETs, $Q_{1}$ and $Q_{2}$, for the input switching transistors, and a depletion MESFET for the load transistor $Q_{L}$. The gate closely resembles the now obsolete depletion-load MOSFET circuit. The GaAs circuit of Fig. 14.47 implements a two-input NOR function.

To see how the MESFET circuit of Fig. 14.47 operates, ignore input $B$ and consider the basic inverter formed by $Q_{1}$ and $Q_{L}$. When the input voltage applied to node $A, v_{I}$, is lower than the threshold voltage of the enhancement MESFET $Q_{1}$, denoted $V_{t E}$, transistor $Q_{1}$ will be off. Recall that $V_{t E}$ is positive and for GaAs MESFETs is typically 0.1 to 0.3 V . Now if the gate output $Y$ is open circuited, the output voltage will be very close to $V_{D D}$. In practice, however, the gate will be driving another gate, as indicated in Fig. 14.47, where $Q_{3}$ is the input transistor of the subsequent gate. In such a case, current will flow from $V_{D D}$ through $Q_{L}$ and into the gate terminal of $Q_{3}$. Recalling that the gate to source of a GaAs MESFET is a Schottky-barrier diode that exhibits a voltage drop of about 0.7 V when conducting, we see that the gate conduction of $Q_{3}$ will clamp the output high voltage $\left(V_{O H}\right)$ to about 0.7 V . This is in sharp contrast to the MOSFET case, where no gate conduction takes place.

Figure 14.48 shows the DCFL inverter under study with the input of the subsequent gate represented by a Schottky diode $Q_{3}$. With $v_{I}<V_{t E}, i_{1}=0$ and $i_{L}$ flows through $Q_{3}$ resulting in $v_{O}=V_{O H} \simeq 0.7 \mathrm{~V}$. Since $V_{D D}$ is usually low ( 1.2 to 1.5 V ) and the threshold voltage of $Q_{L}$, $V_{t D}$, is typically -0.7 to $-1 \mathrm{~V}, Q_{L}$ will be operating in the triode region. (To simplify matters, we shall ignore in this discussion the early-saturation effect exhibited by GaAs MESFETs.)

As $v_{I}$ is increased above $V_{t E}, Q_{1}$ turns on and conducts a current denoted $i_{1}$. Initially, $Q_{1}$ will be in the saturation region. Current $i_{1}$ subtracts from $i_{L}$, thus reducing the current in $Q_{3}$. The voltage across $Q_{3}, v_{O}$, decreases slightly. However, for the present discussion we shall assume that $v_{O}$ will remain close to 0.7 V as long as $Q_{3}$ is conducting. This will continue until $v_{I}$ reaches the value that results in $i_{1}=i_{L}$. At this point, $Q_{3}$ ceases conduction

FIGURE 14.48 The DCFL gate with the input of the subsequent gate represented by a Schottky diode $Q_{3}$.
and can be ignored altogether. Further increase in $v_{I}$ results in $i_{1}$ increasing, $v_{O}$ decreasing, and $i_{L}=i_{1}$. When $\left(V_{D D}-v_{O}\right)$ exceeds $\left|V_{i D}\right|, Q_{L}$ saturates; and when $v_{O}$ falls below $v_{I}$ by $V_{i E}$, $Q_{1}$ enters the triode region. Eventually, when $v_{I}=V_{O H}=0.7 \mathrm{~V}, v_{O}=V_{O L}$, which is typically 0.1 to 0.2 V .

From the description above we see that the output voltage swing of the DCFL gate is limited by gate conduction to a value less than 0.7 V (typically 0.5 V or so). Further details on the operation of the DCFL gate are illustrated by the following example.

# EXAMPLE 14.3 

Consider a DCFL gate fabricated in a GaAs technology for which $L=1 \mu \mathrm{~m}, V_{i D}=-1 \mathrm{~V}, V_{i E}=$ $0.2 \mathrm{~V}, \beta$ (for $1-\mu \mathrm{m}$ width) $=10^{-4} \mathrm{~A} / \mathrm{V}^{2}$, and $\lambda=0.1 \mathrm{~V}^{-1}$. Let the widths of the input MESFETs be $50 \mu \mathrm{~m}$, and let the width of the load MESFET be $6 \mu \mathrm{~m} . V_{D D}=1.5 \mathrm{~V}$. Using a constant-voltagedrop model for the gate-source Schottky diode with $V_{D}=0.7 \mathrm{~V}$, and neglecting the earlysaturation effect of GaAs MESFETs (that is, using Eqs. 5.120 to describe MESFET operation), find $V_{O H}, V_{O L}, V_{I H}, N M_{H}, N M_{L}$, the static power dissipation, and the propagation delay for a total equivalent capacitance at the gate output of 30 fF .

## Solution

From the description above of the operation of the DCFL gate we found that $V_{O H}=0.7 \mathrm{~V}$. To obtain $V_{O L}$, we consider the inverter in the circuit of Fig. 14.48 and let $v_{I}=V_{O H}=0.7 \mathrm{~V}$. Since we expect $v_{O}=V_{O L}$ to be small, we assume $Q_{1}$ to be in the triode region and $Q_{L}$ to be in saturation. ( $Q_{3}$ is of course off.) Equating $i_{1}$ and $i_{L}$ gives the equation

$$
\beta_{1}\left[2(0.7-0.2) V_{O L}-V_{O L}^{2}\right]\left(1+0.1 V_{O L}\right)=\beta_{L}[0-(-1)]^{2}\left[1+0.1\left(1.5-V_{O L}\right)\right]
$$

To simplify matters, we neglect the terms $0.1 V_{O L}$ and substitute $\beta_{L} / \beta_{1}=W_{L} / W_{1}=6 / 50$ to obtain a quadratic equation in $V_{O L}$ whose solution gives $V_{O L} \simeq 0.17 \mathrm{~V}$.

Toward obtaining the value of $V_{I L}$ we shall first find the value of $v_{I}$ at which $i_{1}=i_{L}$, the diode $Q_{3}$ turns off, and $v_{O}$ begins to decrease. Since at this point $v_{O}=0.7 \mathrm{~V}$, we assume that $Q_{1}$ is in saturation. Transistor $Q_{L}$ has a $v_{D S}$ of 0.8 V , which is less than $\left|V_{i D}\right|$ and is thus in the triode region. Equating $i_{1}$ and $i_{L}$ gives

$$
\beta_{1}\left(v_{I}-0.2\right)^{2}(1+0.1 \times 0.7)=\beta_{L}\left[2(1)(1.5-0.7)-(1.5-0.7)^{2}\right][1+0.1(1.5-0.7)]
$$

Substituting $\beta_{L} / \beta_{1}=W_{L} / W_{1}=6 / 50$ and solving the resulting equation yields $v_{I}=0.54 \mathrm{~V}$. Figure 14.49 shows a sketch of the transfer characteristic of the inverter. The slope $d v_{O} / d v_{I}$ at


FIGURE 14.49 Transfer characteristic of the DCFL inverter of Fig. 14.48.
point A can be found to be $-14.2 \mathrm{~V} / \mathrm{V}$. We shall consider point A as the point at which the inverter begins to switch from the high-output state; thus $V_{I L} \simeq 0.54 \mathrm{~V}$.

To obtain $V_{I H}$, we find the co-ordinates of point B at which $d v_{O} / d v_{I}=-1$. This can be done using a procedure similar to that employed for the MOSFET inverters and assuming $Q_{1}$ to be in the triode region and $Q_{L}$ to be in saturation. Neglecting terms in $0.1 v_{O}$, the result is $V_{I H} \simeq 0.63 \mathrm{~V}$. The noise margins can now be found as

$$
\begin{aligned}
& N M_{H} \equiv V_{O H}-V_{I H}=0.7-0.63=0.07 \mathrm{~V} \\
& N M_{L} \equiv V_{I L}-V_{O L}=0.54-0.17=0.37 \mathrm{~V}
\end{aligned}
$$

The static power dissipation is determined by finding the supply current $I_{D D}$ in the outputhigh and the output-low cases. When the output is high (at 0.7 V ), $Q_{L}$ is in the triode region and the supply current is

$$
I_{D D}=\beta_{L}\left[2(0+1)(1.5-0.7)-(1.5-0.7)^{2}\right][1+0.1(1.5-0.7)]
$$

Substituting $\beta_{L}=10^{-4} \times W_{L}=0.6 \mathrm{~mA} / \mathrm{V}^{2}$ results in

$$
I_{D D}=0.61 \mathrm{~mA}
$$

When the output is low (at 0.17 V ), $Q_{L}$ is in saturation and the supply current is

$$
I_{D D}=\beta_{L}(0+1)^{2}[1+0.1(1.5-0.17)]=0.68 \mathrm{~mA}
$$

Thus the average supply current is

$$
I_{D D}=\frac{1}{2}(0.61+0.68)=0.645 \mathrm{~mA}
$$


FIGURE 14.50 Circuits for calculating the propagation delays of the DCFL inverter: (a) $t_{P H L}$; (b) $t_{P L H}$.
and the static power dissipation is

$$
P_{D}=0.645 \times 1.5 \simeq 1 \mathrm{~mW}
$$

The propagation delay $t_{P H L}$ is the time for the output voltage of the inverter to decrease from $V_{O H}=0.7 \mathrm{~V}$ to $\frac{1}{2}\left(V_{O H}+V_{O L}\right)=0.435 \mathrm{~V}$. During this time $v_{I}$ is at the high level of 0.7 V , and the capacitance $C$ (assumed to be 30 fempto Farads [fF]) is discharged by $\left(i_{1}-i_{L}\right)$; refer to Fig. 14.50(a). The average discharge current is found by calculating $i_{1}$ and $i_{L}$ at the beginning and at the end of the discharge interval. The result is that $i_{1}$ changes from 1.34 mA to 1.28 mA and $i_{L}$ changes from 0.61 mA to 0.66 mA . Thus the discharge current $\left(i_{1}-i_{L}\right)$ changes from 0.73 mA to 0.62 mA for an average value of 0.675 mA . Thus

$$
t_{P H L}=\frac{C \Delta V}{I}=\frac{30 \times 10^{-15}(0.7-0.435)}{0.675 \times 10^{-3}}=11.8 \mathrm{ps}
$$

To determine $t_{P L H}$ we refer to the circuit in Fig. 14.50(b) and note that during $t_{P L H}, v_{O}$ changes from $V_{O L}=0.17 \mathrm{~V}$ to $\frac{1}{2}\left(V_{O H}+V_{O L}\right)=0.435 \mathrm{~V}$. The charging current is the average value of $i_{L}$, which changes from 0.8 mA to 0.66 mA . Thus $i_{L \text { average }}=0.73 \mathrm{~mA}$ and

$$
t_{P L H}=\frac{30 \times 10^{-15} \times(0.435-0.17)}{0.73 \times 10^{-3}}=10.9 \mathrm{ps}
$$

The propagation delay of the DCFL gate can now be found as

$$
t_{P}=\frac{1}{2}\left(t_{P H L}+t_{P L H}\right)=11.4 \mathrm{ps}
$$

As a final remark, we note that the analysis above was done using simplified device models; our objective is to show how the circuit works rather than to find accurate performance measures. These can be obtained using SPICE simulation with more elaborate models [see Roberts and Sedra (1997)].

# Logic Gates Using Depletion MESFETs 

The DCFL circuits studied above require both enhancement and depletion devices and thus are somewhat difficult to fabricate. Also, owing to the fact that the voltage swings and noise margins are rather small, very careful control of the value of $V_{t E}$ is required in fabrication. As an alternative, we now present circuits that utilize depletion devices only.


FIGURE 14.51 An inverter circuit utilizing depletion-mode devices only. Schottky diodes are employed to shift the output logic levels to values compatible with the input levels required to turn the depletion MESFET $Q_{S}$ on and off. This circuit is known as FET logic (FL).

Figure 14.51 shows the basic inverter circuit of a family of GaAs logic circuits known at FET logic (FL). The heart of the FL inverter is formed by the switching transistor $Q_{S}$ and its load $Q_{L}$-both depletion-type MESFETs. Since the threshold voltage of a depletion MESFET, $V_{i D}$, is negative, a negative voltage $<V_{i D}$ is needed to turn $Q_{S}$ off. On the other hand the output low voltage at the drain of $Q_{S}$ will always be positive. It follows that the logic levels at the drain of $Q_{S}$ are not compatible with the levels required at the gate input. The incompatibility problem is solved by simply shifting the level of the voltage $v_{O}^{\prime}$ down by two diode drops, that is, by approximately 1.4 V . This level shifting is accomplished by the two Schottky diodes $\mathrm{D}_{1}$ and $\mathrm{D}_{2}$. The depletion transistor $Q_{P D}$ provides a constant-current bias for $\mathrm{D}_{1}$ and $\mathrm{D}_{2}$. To ensure that $Q_{P D}$ operates in the saturation region at all times, its source is connected to a negative supply $-V_{S S}$, and the value of $V_{S S}$ is selected to be equal to or greater than the lowest level of $v_{O}\left(V_{O L}\right)$ plus the magnitude of the threshold voltage, $\left|V_{i D}\right|$. Transistor $Q_{P D}$ also supplies the current required to discharge a load capacitance when the output voltage of the gate goes low, hence the name "pull-down" transistor and the subscript $P D$.

To see how the inverter of Fig. 14.51 operates, refer to its transfer characteristic, shown in Fig. 14.52. The circuit is usually designed using MESFETs having equal channel lengths (typically $1 \mu \mathrm{~m}$ ) and having widths $W_{S}=W_{L}=2 W_{P D}$. The transfer characteristic shown is for the case $V_{i D}=-0.9 \mathrm{~V}$. For $v_{I}$ lower than $V_{i D}, Q_{S}$ will be off and $Q_{L}$ will operate in saturation, supplying a constant current $I_{L}$ to $\mathrm{D}_{1}$ and $\mathrm{D}_{2}$. Transistor $Q_{P D}$ will also operate in saturation with a constant current $I_{P D}=\frac{1}{2} I_{L}$. The difference between the two currents will flow through the gate terminal of the input transistor of the next gate in the chain, $Q_{S 2}$. Thus the input Schottky diode of $Q_{S 2}$ clamps the output voltage $v_{O}$ to approximately 0.7 V , which is the output high level, $V_{O H}$. (Note that for this discussion we shall neglect the finite output resistance in saturation.)

As $v_{I}$ is raised above $V_{i D}, Q_{S}$ turns on. Since its drain is at $+2.1 \mathrm{~V}, Q_{S}$ will operate in the saturation region and will take away some of the current supplied by $Q_{L}$. Thus the current flowing into the gate of $Q_{S 2}$ decreases by an equal amount. If we keep increasing $v_{I}$, a value is reached for which the current in $Q_{S}$ equals $\frac{1}{2} I_{L}$, thus leaving no current to flow through the gate of $Q_{S 2}$. This corresponds to the point labeled A on the transfer characteristic. A further slight increase in $v_{I}$ will cause the voltage $v_{O}^{\prime}$ to fall to the point B where $Q_{S}$ enters the triode region. The segment AB of the transfer curve represents the high-gain region of operation, having a slope equal to $-g_{m s} R$ where $R$ denotes the total equivalent resistance at the drain node. Note that this segment is shown as vertical in Fig. 14.52 because we are neglecting the output resistance in saturation.


FIGURE 14.52 Transfer characteristic of the FL inverter of Fig. 14.51.

The segment BC of the transfer curve corresponds to $Q_{S}$ operating in the triode region. Here $Q_{L}$ and $Q_{P D}$ continue to operate in saturation and $\mathrm{D}_{1}$ and $\mathrm{D}_{2}$ remain conducting. Finally, for $v_{I}=V_{O H}=0.7 \mathrm{~V}, v_{O}=V_{O L}$, which for the case $V_{i D}=-0.9 \mathrm{~V}$ can be found to be -1.3 V .

# EXERCISE 

14.30 Verify that the co-ordinates of points A, B, and C of the transfer characteristic are as indicated in Fig. 14.52. Let $V_{i D}=-0.9 \mathrm{~V}$ and $\lambda=0$.

As indicated in Fig. 14.52, the FL inverter exhibits much higher noise margins than those for the DCFL circuit. The FL inverter, however, requires two power supplies.

The FL inverter can be used to construct a NOR gate by simply adding transistors with drain and source connected in parallel with those of $Q_{S}$.


FIGURE 14.53 (a) An SDFL inverter. (b) An SDFL NOR gate.

# Schottky Diode FET Logic (SDFL) 

If the diode level-shifting network of the FL inverter is connected at the input side of the gate, rather than at the output side, we obtain the circuit shown in Fig. 14.53(a). This inverter operates in much the same manner as the FL inverter. The modified circuit, however, has a very interesting feature: The NOR function can be implemented by simply connecting additional diodes, as shown in Fig. 14.53(b). This logic form is known as Schottky diode FET logic (SDFL). SDFL permits higher packing density than other forms of MESFET logic because only an additional diode, rather than an additional transistor, is required for each additional input, and diodes require much smaller areas than transistors.

## Buffered FET Logic (BFL)

Another variation on the basic FL inverter of Fig. 14.51 is possible. A source follower can be inserted between the drain of $Q_{S}$ and the diode level-shifting network. The resulting gate, shown for the case of a two-input NOR, is depicted in Fig. 14.54. This form of GaAs logic circuit is known as buffered FET logic (BFL). The source-follower transistor $Q_{S F}$ increases the output current-driving capability, thus decreasing the low-to-high propagation time. FL, BFL, and SDFL feature propagation delays of the order of 100 ps and power dissipation of the order of $10 \mathrm{~mW} /$ gate.


FIGURE 14.54 A BFL two-input NOR gate. The gate is formed by inserting a source-follower transistor $Q_{S F}$ between the inverting stage and the level-shifting stage.
# 14.3 TRANSISTOR-TRANSISTOR LOGIC (TTL OR T ${ }^{2}$ L) 

For more than two decades (late 1960s to late 1980s) TTL enjoyed immense popularity. Indeed, the bulk of digital systems applications employing SSI and MSI packages were designed using TTL.

We shall begin this section with a study of the evolution of TTL from DTL. In this way we shall explain the function of each of the stages of the complete TTL gate circuit. Characteristics of standard TTL gates will be studied in Section 14.4. Standard TTL, however, has now been virtually replaced with more advanced forms of TTL that feature improved performance. These will be discussed in Section 14.5.

## Evolution of TTL from DTL

The basic DTL gate circuit in discrete form was discussed in the previous section (see Fig. 14.6). The integrated-circuit form of the DTL gate is shown in Fig. 14.7 with only one input indicated. As a prelude to introducing TTL, we have drawn the input diode as a diodeconnected transistor $\left(Q_{1}\right)$, which corresponds to how diodes are made in IC form.

This circuit differs from the discrete DTL circuit of Fig. 14.6 in two important aspects. First, one of the steering diodes is replaced by the base-emitter junction of a transistor $\left(Q_{2}\right)$ that is either cut off (when the input is low) or in the active mode (when the input is high). This is done to reduce the input current and thereby increase the fan-out capability of the gate. A detailed explanation of this point, however, is not relevant to our study of TTL. Second, the resistance $R_{B}$ is returned to ground rather than to a negative supply, as was done in the earlier discrete circuit. An obvious advantage of this is the elimination of the additional power supply. The disadvantage, however, is that the reverse base current available to remove the excess charge stored in the base of $Q_{3}$ is rather small. We shall elaborate on this point below.


FIGURE 14.7 IC form of the DTL gate with the input diode shown as a diode-connected transistor $\left(Q_{1}\right)$. Only one input terminal is shown.
# EXERCISE 

14.4 Consider the DTL gate circuit shown in Fig. 14.7 and assume that $\beta\left(Q_{2}\right)=\beta\left(Q_{3}\right)=50$. (a) When $v_{I}=$ 0.2 V , find the input current. (b) When $v_{I}=+5 \mathrm{~V}$, find the base current of $Q_{3}$.

Ans. (a) 1.1 mA ; (b) 1.6 mA

## Reasons for the Slow Response of DTL

The DTL gate has relatively good noise margins and reasonably good fan-out capability. Its response, however, is rather slow. There are two reasons for this: first, when the input goes low and $Q_{2}$ and D turn off, the charge stored in the base of $Q_{3}$ has to leak through $R_{B}$ to ground. The initial value of the reverse base current that accomplishes this "base discharging" process is approximately $0.7 \mathrm{~V} / R_{B}$, which is about 0.14 mA . Because this current is quite small in comparison to the forward base current, the time required for the removal of base charge is rather long, which contributes to lengthening the gate delay.

The second reason for the relatively slow response of DTL derives from the nature of the output circuit of the gate, which is simply a common-emitter transistor. Figure 14.8 shows the output transistor of a DTL gate driving a capacitive load $C_{L}$. The capacitance $C_{L}$ represents the input capacitance of another gate and/or the wiring and parasitic capacitances that are inevitably present in any circuit. When $Q_{3}$ is turned on, its collector voltage cannot instantaneously fall because of the existence of $C_{L}$. Thus $Q_{3}$ will not immediately saturate but rather will operate in the active region. The collector of $Q_{3}$ will therefore act as a constant-current source and will sink a relatively large current $\left(\beta I_{B}\right)$. This large current will rapidly discharge $C_{L}$. We thus see that the common-emitter output stage features a short turn-on time. However, turnoff is another matter.

Consider next the operation of the common-emitter output stage when $Q_{3}$ is turned off. The output voltage will not rise immediately to the high level $\left(V_{C C}\right)$. Rather, $C_{L}$ will charge up to $V_{C C}$ through $R_{C}$. This is a rather slow process, and it results in lengthening the DTL gate delay (and similarly the RTL gate delay).

Having identified the two reasons for the slow response of DTL, we shall see in the following how these problems are remedied in TTL.

## Input Circuit of the TTL Gate

Figure 14.9 shows a conceptual TTL gate with only one input terminal indicated. The most important feature to note is that the input diode has been replaced by a transistor. One can


FIGURE 14.8 The output circuit of a DTL gate driving a capacitive load $C_{L}$.


FIGURE 14.9 Conceptual form of TTL gate. Only one input terminal is shown.


FIGURE 14.10 Analysis of the conceptual TTL gate when the input is high.
think of this simply as if the short circuit between base and collector of $Q_{1}$ in Fig. 14.7 has been removed.

To see how the conceptual TTL circuit of Fig. 14.9 works, let the input $v_{I}$ be high (say, $v_{I}=V_{C C}$ ). In this case current will flow from $V_{C C}$ through $R$, thus forward-biasing the basecollector junction of $Q_{1}$. Meanwhile, the base-emitter junction of $Q_{1}$ will be reverse-biased. Therefore $Q_{1}$ will be operating in the inverse active mode-that is, in the active mode but with the roles of emitter and collector interchanged. The voltages and currents will be as indicated in Fig. 14.10, where the current $I$ can be calculated from

$$
I=\frac{V_{C C}-1.4}{R}
$$

In actual TTL circuits $Q_{1}$ is designed to have a very low reverse $\beta\left(\beta_{R} \simeq 0.02\right)$. Thus the gate input current will be very small, and the base current of $Q_{3}$ will be approximately equal to $I$. This current will be sufficient to drive $Q_{3}$ into saturation, and the output voltage will be low $(0.1$ to 0.2 V$)$.

Next let the gate input voltage be brought down to the logic-0 level (say, $v_{I} \simeq 0.2 \mathrm{~V}$ ). The current $I$ will then be diverted to the emitter of $Q_{1}$. The base-emitter junction of $Q_{1}$ will become forward-biased, and the base voltage of $Q_{1}$ will therefore drop to 0.9 V . Since $Q_{3}$ was in saturation, its base voltage will remain at +0.7 V pending the removal of the excess charge stored in the base region. Figure 14.11 indicates the various voltage and current values immediately after the input is lowered. We see that $Q_{1}$ will be operating in the normal


FIGURE 14.11 Voltage and current values in the conceptual TTL circuit immediately after the input voltage is lowered.


FIGURE 14.12 An emitter-follower output stage with capacitive load.
active mode ${ }^{3}$ and its collector will carry a large current $\left(\beta_{F} I\right)$. This large current rapidly discharges the base of $Q_{3}$ and drives it into cutoff. We thus see the action of $Q_{1}$ in speeding up the turn-off process.

As $Q_{3}$ turns off, the voltage at its base is reduced, and $Q_{1}$ enters the saturation mode. Eventually the collector current of $Q_{1}$ will become negligibly small, which implies that its $V_{C E s a t}$ will be approximately 0.1 V and the base of $Q_{3}$ will be at about 0.3 V , which keeps $Q_{3}$ in cutoff.

# Output Circuit of the TTL Gate 

The above discussion illustrates how one of the two problems that slow down the operation of DTL is solved in TTL. The second problem, the long rise time of the output waveform, is solved by modifying the output stage, as we shall now explain.

First, recall that the common-emitter output stage provides fast discharging of load capacitance but rather slow charging. The opposite is obtained in the emitter-follower output stage shown in Fig. 14.12. Here, as $v_{I}$ goes high, the transistor turns on and provides a low output resistance (characteristic of emitter followers), which results in fast charging of $C_{L}$. On the other hand, when $v_{I}$ goes low, the transistor turns off and $C_{L}$ is then left to discharge slowly through $R_{E}$.

[^0]
[^0]:    ${ }^{3}$ Although the collector voltage of $Q_{1}$ is lower than its base voltage by 0.2 V , the collector-base junction will in effect be cut off and $Q_{1}$ will be operating in the active mode.

FIGURE 14.13 The totem-pole output stage.

It follows that an optimum output stage would be a combination of the common-emitter and the emitter-follower configurations. Such an output stage, shown in Fig. 14.13, has to be driven by two complementary signals $v_{I 1}$ and $v_{I 2}$. When $v_{I 1}$ is high $v_{I 2}$ will be low, and in this case $Q_{3}$ will be on and saturated, and $Q_{4}$ will be off. The common-emitter transistor $Q_{3}$ will then provide the fast discharging of load capacitance and in steady state provide a low resistance ( $R_{C E s a t}$ ) to ground. Thus when the output is low, the gate can sink substantial amounts of current through the saturated transistor $Q_{3}$.

When $v_{I 1}$ is low and $v_{I 2}$ is high, $Q_{3}$ will be off and $Q_{4}$ will be conducting. The emitter follower $Q_{4}$ will then provide fast charging of load capacitance. It also provides the gate with a low output resistance in the high state and hence with the ability to source a substantial amount of load current.

Because of the appearance of the circuit in Fig. 14.13, with $Q_{4}$ stacked on top of $Q_{3}$, the circuit has been given the name totem-pole output stage. Also, because of the action of $Q_{4}$ in pulling up the output voltage to the high level, $Q_{4}$ is referred to as the pull-up transistor. Since the pulling up is achieved here by an active element $\left(Q_{4}\right)$, the circuit is said to have an active pull-up. This is in contrast to the passive pull-up of RTL and DTL gates. Of course, the common-emitter transistor $Q_{3}$ provides the circuit with active pull-down. Finally, note that a special driver circuit is needed to generate the two complementary signals $v_{I 1}$ and $v_{I 2}$.

# EXAMPLE 14.1 

We wish to analyze the circuit shown together with its driving waveforms in Fig. 14.14 to determine the waveform of the output signal $v_{O}$. Assume that $Q_{3}$ and $Q_{4}$ have $\beta=50$.

## Solution

Consider first the situation before $v_{I 1}$ goes high—that is, at time $t<0$. In this case $Q_{3}$ is off and $Q_{4}$ is on, and the circuit can be simplified to that shown in Fig. 14.15. In this simplified circuit we have replaced the voltage divider $\left(R_{1}, R_{2}\right)$ by its Thévenin equivalent. In the steady state, $C_{L}$ will be charged to the output voltage $v_{O}$, whose value can be obtained as follows:

$$
5=10 \times I_{B}+V_{B E}+I_{E} \times 0.5+2.5
$$

Substituting $V_{B E} \approx 0.7 \mathrm{~V}$ and $I_{B}=I_{E} /(\beta+1)=I_{E} / 51$ gives $I_{E}=2.59 \mathrm{~mA}$. Thus the output voltage $v_{O}$ is given by

$$
v_{O}=2.5+I_{E} \times 0.5=3.79 \mathrm{~V}
$$


FIGURE 14.14 Circuit and input waveforms for Example 14.1.


FIGURE 14.15 The circuit of Fig. 14.14 when $Q_{3}$ is off.

We next consider the circuit as $v_{I 1}$ goes high and $v_{I 2}$ goes low. Transistor $Q_{3}$ turns on and transistor $Q_{4}$ turns off, and the circuit simplifies to that shown in Fig. 14.16. Again we have used the Thévenin equivalent of the divider $\left(R_{1}, R_{2}\right)$. We shall also assume that the switching times of the transistors are negligibly small. Thus at $t=0+$ the base current of $Q_{3}$ becomes

$$
I_{B}=\frac{5-0.7}{10}=0.43 \mathrm{~mA}
$$

Since at $t=0$ the collector voltage of $Q_{3}$ is 3.79 V , and since this value cannot change instantaneously because of $C_{L}$, we see that at $t=0+$ transistor $Q_{3}$ will be in the active mode. The collector current of $Q_{3}$ will be $\beta I_{B}$, which is 21.5 mA , and the circuit will have the equivalent shown in Fig. 14.17(a). A simpler version of this equivalent circuit, obtained using Thévenin's theorem, is shown in Fig. 14.17(b).

The equivalent circuit of Fig. 14.17 applies as long as $Q_{3}$ remains in the active mode. This condition persists while $C_{L}$ is being discharged and until $v_{O}$ reaches about +0.3 V , at which time $Q_{3}$ enters saturation. This is illustrated by the waveform in Fig. 14.18. The time for the output


FIGURE 14.16 The circuit of Fig. 14.14 when $Q_{4}$ is off.


FIGURE 14.17 (a) Equivalent circuit for the circuit in Fig. 14.16 when $Q_{3}$ is in the active mode. (b) Simpler version of the circuit in (a) obtained using Thévenin's theorem.


FIGURE 14.18 Details of the output voltage waveform for the circuit in Fig. 14.14.
voltage to fall from +3.79 V to +0.3 V , which can be considered the fall time $t_{f}$, can be obtained from

$$
-8.25-(-8.25-3.79) e^{-t_{f} / \tau}=0.3
$$

which results in

$$
t_{f} \simeq 0.34 \tau
$$

where

$$
\tau=C_{L} \times 0.5 \mathrm{k} \Omega=10 \mathrm{~ns}
$$

Thus $t_{f}=3.4 \mathrm{~ns}$.
After $Q_{3}$ enters saturation, the capacitor discharges further to the final steady-state value of $V_{C E s a t}(\simeq 0.2 \mathrm{~V})$. The transistor model that applies during this interval is more complex; since the interval in question is quite short, we shall not pursue the matter further.

Consider next the situation as $v_{f 1}$ goes low and $v_{f 2}$ goes high at $t=T$. Transistor $Q_{3}$ turns off as $Q_{4}$ turns on. We shall assume that this occurs immediately, and thus at $t=T+$ the circuit simplifies to that in Fig. 14.15. We have already analyzed this circuit in the steady state and thus know that eventually $v_{O}$ will reach +3.79 V . Thus $v_{O}$ rises exponentially from +0.2 V toward +3.79 V with a time constant of $C_{L}\{0.5 \mathrm{k} \Omega / /[10 \mathrm{k} \Omega /(\beta+1)]\}$, where we have neglected the emitter resistance $r_{e}$. Denoting this time constant $\tau_{1}$, we obtain $\tau_{1}=2.8 \mathrm{~ns}$. Defining the rise time $t_{r}$ as the time for $v_{O}$ to reach $90 \%$ of the final value, we obtain $3.79-(3.79-0.2) e^{-t_{r} / \tau_{1}}=0.9 \times 3.79$, which results in $t_{r}=6.4 \mathrm{~ns}$. Figure 14.18 illustrates the details of the output voltage waveform.

# The Complete Circuit of the TTL Gate 

Figure 14.19 shows the complete TTL gate circuit. It consists of three stages: the input transistor $Q_{1}$, whose operation has already been explained, the driver stage $Q_{2}$, whose function is to generate the two complementary voltage signals required to drive the totem-pole circuit,


FIGURE 14.19 The complete TTL gate circuit with only one input terminal indicated.
which is the third (output) stage of the gate. The totem-pole circuit in the TTL gate has two additional components: the $130-\Omega$ resistance in the collector circuit of $Q_{4}$ and the diode D in the emitter circuit of $Q_{4}$. The function of these two additional components will be explained shortly. Notice that the TTL gate is shown with only one input terminal indicated. Inclusion of additional input terminals will be considered in Section 14.4.

Because the driver stage $Q_{2}$ provides two complementary (that is, out-of-phase) signals, it is known as a phase splitter.

We shall now provide a detailed analysis of the TTL gate circuit in its two extreme states: one with the input high and one with the input low.

# Analysis When the Input Is High 

When the input is high (say, +5 V ), the various voltages and currents of the TTL circuit will have the values indicated in Fig. 14.20. The analysis illustrated in Fig. 14.20 is quite straightforward, and the order of the steps followed is indicated by the circled numbers. As expected, the input transistor is operating in the inverse active mode, and the input current, called the input high current $I_{I H}$, is small; that is,

$$
I_{I H}=\beta_{R} I \simeq 15 \mu \mathrm{~A}
$$

where we assume that $\beta_{R} \simeq 0.02$.
The collector current of $Q_{1}$ flows into the base of $Q_{2}$, and its value is sufficient to saturate the phase-splitter transistor $Q_{2}$. The latter supplies the base of $Q_{3}$ with sufficient current to drive it into saturation and lower its output voltage to $V_{C E s a t}(0.1$ to 0.2 V$)$. The voltage at the collector of $Q_{2}$ is $V_{B E 3}+V_{C E s a t}\left(Q_{2}\right)$, which is approximately +0.9 V . If diode D were not included, this voltage would be sufficient to turn $Q_{4}$ on, which is contrary to the proper operation of the totem-pole circuit. Including diode D ensures that both $Q_{4}$ and D remain off.


FIGURE 14.20 Analysis of the TTL gate with the input high. The circled numbers indicate the order of the analysis steps.


FIGURE 14.21 The $v_{O}-i_{L}$ characteristic of the TTL gate when the output is low.
The saturated transistor $Q_{3}$ then establishes the low output voltage of the gate ( $V_{C E s a t}$ ) and provides a low impedance to ground.

In the low-output state the gate can sink a load current $i_{L}$, provided that the value of $i_{L}$ does not exceed $\beta \times 2.6 \mathrm{~mA}$, which is the maximum collector current that $Q_{3}$ can sustain while remaining in saturation. Obviously the greater the value of $i_{L}$, the greater the output voltage will be. To maintain the logic- 0 level below a certain specified limit, a corresponding limit has to be placed on the load current $i_{L}$. As will be seen shortly, it is this limit that determines the maximum fan-out of the TTL gate.

Figure 14.21 shows a sketch of the output voltage $v_{O}$ versus the load current $i_{L}$ of the TTL gate when the output is low. This is simply the $v_{C E}-i_{C}$ characteristic curve of $Q_{3}$ measured with a base current of 2.6 mA . Note that at $i_{L}=0, v_{O}$ is the offset voltage, which is about 100 mV .

# EXERCISE 

14.5 Assume that the saturation portion of the $v_{O}-i_{L}$ characteristic shown in Fig. 14.21 can be approximated by a straight line (of slope $=8 \Omega$ ) that intersects the $v_{O}$ axis at 0.1 V . Find the maximum load current that the gate is allowed to sink if the logic- 0 level is specified to be $\leq 0.3 \mathrm{~V}$.
Ans. 25 mA

## Analysis When the Input Is Low

Consider next the operation of the TTL gate when the input is at the logic- 0 level ( $\simeq 0.2 \mathrm{~V}$ ). The analysis is illustrated in Fig. 14.22, from which we see that the base-emitter junction of $Q_{1}$ will be forward-biased and the base voltage will be approximately +0.9 V . Thus the current $I$ can be found to be approximately 1 mA . Since 0.9 V is insufficient to forward-bias the series combination of the collector-base junction of $Q_{1}$ and the base-emitter junction of $Q_{2}$ (at least 1.2 V would be required), the latter will be off. Therefore the collector current of $Q_{1}$ will be almost zero and $Q_{1}$ will be saturated, with $V_{C E s a t} \simeq 0.1 \mathrm{~V}$. Thus the base of $Q_{2}$ will be at approximately +0.3 V , which is indeed insufficient to turn $Q_{2}$ on.

The gate input current in the low state, called input-low current $I_{I L}$, is approximately equal to the current $I(\simeq 1 \mathrm{~mA})$ and flows out of the emitter of $Q_{1}$. If the TTL gate is driven


FIGURE 14.22 Analysis of the TTL gate when the input is low. The circled numbers indicate the order of the analysis steps.
by another TTL gate, the output transistor $Q_{3}$ of the driving gate should sink this current $I_{I L}$. Since the output current that a TTL gate can sink is limited to a certain maximum value, the maximum fan-out of the gate is directly determined by the value of $I_{I L}$.

# EXERCISES 

14.6 Consider the TTL gate analyzed in Exercise 14.5. Find its maximum allowable fan-out using the value of $I_{I L}$ calculated above.
Ans. 25
14.7 Use Eq. (4.114) to find $V_{C E \text { sat }}$ of transistor $Q_{1}$ when the input of the gate is low $(0.2 \mathrm{~V})$. Assume that $\beta_{F}=50$ and $\beta_{R}=0.02$.
Ans. 98 mV

Let us continue with our analysis of the TTL gate. When the input is low, we see that both $Q_{2}$ and $Q_{3}$ will be off. Transistor $Q_{4}$ will be on and will supply (source) the load current $i_{L}$. Depending on the value of $i_{L}, Q_{4}$ will be either in the active mode or in the saturation mode.

With the gate output terminal open, the current $i_{L}$ will be very small (mostly leakage) and the two junctions (base-emitter junction of $Q_{4}$ and diode D) will be barely conducting. Assuming that each junction has a $0.65-\mathrm{V}$ drop and neglecting the voltage drop across the $1.6-\mathrm{k} \Omega$ resistance, we find that the output voltage will be

$$
v_{O} \simeq 5-0.65-0.65=3.7 \mathrm{~V}
$$
As $i_{L}$ is increased, $Q_{4}$ and D conduct more heavily, but for a range of $i_{L}, Q_{4}$ remains in the active mode, and $v_{O}$ is given by

$$
v_{O}=V_{C C}-\frac{i_{L}}{\beta+1} \times 1.6 \mathrm{k} \Omega-V_{B E 4}-V_{D}
$$

If we keep increasing $i_{L}$, a value will be reached at which $Q_{4}$ saturates. Then the output voltage becomes determined by the $130-\Omega$ resistance according to the approximate relationship

$$
v_{O} \simeq V_{C C}-i_{L} \times 130-V_{C E \text { sat }}\left(Q_{4}\right)-V_{D}
$$

# Function of the $130-\Omega$ Resistance 

At this point the reason for including the $130-\Omega$ resistance should be evident: It is simply to limit the current that flows through $Q_{4}$, especially in the event that the output terminal is accidentally short-circuited to ground. This resistance also limits the supply current in another circumstance, namely, when $Q_{4}$ turns on while $Q_{3}$ is still in saturation. To see how this occurs, consider the case where the gate input was high and then is suddenly brought down to the low level. Transistor $Q_{2}$ will turn off relatively fast because of the availability of a large reverse current supplied to its base terminal by the collector of $Q_{1}$. On the other hand, the base of $Q_{3}$ will have to discharge through the $1-\mathrm{k} \Omega$ resistance, and thus $Q_{3}$ will take some time to turn off. Meanwhile $Q_{4}$ will turn on, and a large current pulse will flow through the series combination of $Q_{4}$ and $Q_{3}$. Part of this current will serve the useful purpose of charging up any load capacitance to the logic-1 level. The magnitude of the current pulse will be limited by the $130-\Omega$ resistance to about 30 mA .

The occurrence of these current pulses of short duration (called current spikes) raises another important issue. The current spikes have to be supplied by the $V_{C C}$ source and, because of its finite source resistance, will result in voltage spikes (or "glitches") superimposed on $V_{C C}$. These voltage spikes could be coupled to other gates and flip-flops in the digital system and thus might produce false switching in other parts of the system. This effect, which might loosely be called crosstalk, is a problem in TTL systems. To reduce the size of the voltage spikes, capacitors (called bypass capacitors) should be connected between the supply rail and ground at frequent locations. These capacitors lower the impedance of the supply-voltage source and hence reduce the magnitude of the voltage spikes. Alternatively, one can think of the bypass capacitors as supplying the impulsive current spikes.

## EXERCISES

14.8 Assuming that $Q_{4}$ has $\beta=50$ and that at the verge of saturation $V_{C E \text { sat }}=0.3 \mathrm{~V}$, find the value of $i_{L}$ at which $Q_{4}$ saturates.
Ans. 4.16 mA
14.9 Assuming that at a current of 1 mA the voltage drops across the emitter-base junction of $Q_{4}$ and the diode D are each 0.7 V , find $v_{O}$ when $i_{L}=1 \mathrm{~mA}$ and 10 mA . (Note the result of the previous exercise.)
Ans. $3.6 \mathrm{~V} ; 2.7 \mathrm{~V}$
14.10 Find the maximum current that can be sourced by a TTL gate while the output high level $\left(V_{O H}\right)$ remains greater than the minimum guaranteed value of 2.4 V .
Ans. 12.3 mA ; or, more accurately, taking the base current of $Q_{4}$ into account, 13.05 mA
# 14.4 CHARACTERISTICS OF STANDARD TTL 

Because of its historical popularity and continued importance, TTL will be studied further in this and the next sections. In this section we shall consider some of the important characteristics of standard TTL gates. Special improved forms of TTL will be dealt with in Section 14.5 .

## Transfer Characteristic

Figure 14.23 shows the TTL gate together with a sketch of its voltage transfer characteristic drawn in a piecewise-linear fashion. The actual characteristic is, of course, a smooth curve. We shall now explain the transfer characteristic and calculate the various break-points and slopes. It will be assumed that the output terminal of the gate is open.

Segment $A B$ is obtained when transistor $Q_{1}$ is saturated, $Q_{2}$ and $Q_{3}$ are off, and $Q_{4}$ and D are on. The output voltage is approximately two diode drops below $V_{C C}$. At point $B$ the phase splitter $\left(Q_{2}\right)$ begins to turn on because the voltage at its base reaches $0.6 \mathrm{~V}\left(0.5 \mathrm{~V}+V_{\text {CEsat }}\right.$ of $\left.Q_{1}\right)$.

Over segment $B C$, transistor $Q_{1}$ remains saturated, but more and more of its base current $I$ gets diverted to its base-collector junction and into the base of $Q_{2}$, which operates as a linear amplifier. Transistor $Q_{4}$ and diode D remain on, with $Q_{4}$ acting as an emitter follower. Meanwhile the voltage at the base of $Q_{3}$, although increasing, remains insufficient to turn $Q_{3}$ on (less than 0.6 V ).

Let us now find the slope of segment $B C$ of the transfer characteristic. Let the input $v_{I}$ increase by an increment $\Delta v_{I}$. This increment appears at the collector of $Q_{1}$, since the saturated $Q_{1}$ behaves (approximately) as a three-terminal short circuit as far as signals are


FIGURE 14.23 The TTL gate and its voltage transfer characteristic.
concerned. Thus at the base of $Q_{2}$ we have a signal $\Delta v_{I}$. Neglecting the loading of emitter follower $Q_{4}$ on the collector of $Q_{2}$, we can find the gain of the phase splitter from

$$
\frac{v_{c 2}}{v_{b 2}}=\frac{-\alpha_{2} R_{1}}{r_{e 2}+R_{2}}
$$

The value of $r_{e 2}$ will obviously depend on the current in $Q_{2}$. This current will range from zero (as $Q_{2}$ begins to turn on) to the value that results in a voltage of about 0.6 V at the emitter of $Q_{2}$ (the base of $Q_{3}$ ). This value is about 0.6 mA and corresponds to point $C$ on the transfer characteristic. Assuming an average current in $Q_{2}$ of 0.3 mA , we obtain $r_{e 2} \simeq 83 \Omega$. For $\alpha=0.98$, Eq. (14.6) results in a gain value of 1.45 . Since the gain of the output follower $Q_{4}$ is close to unity, the overall gain of the gate, which is the slope of the $B C$ segment, is about -1.45 .

As already implied, breakpoint $C$ is determined by $Q_{3}$ starting to conduct. The corresponding input voltage can be found from

$$
\begin{aligned}
v_{I}(C) & =V_{B E 3}+V_{B E 2}-V_{C E s a t}\left(Q_{1}\right) \\
& =0.6+0.7-0.1=1.2 \mathrm{~V}
\end{aligned}
$$

At this point the emitter current of $Q_{2}$ is approximately 0.6 mA . The collector current of $Q_{2}$ is also approximately 0.6 mA ; neglecting the base current of $Q_{4}$, the voltage at the collector of $Q_{2}$ is

$$
v_{C 2}(C)=5-0.6 \times 1.6 \cong 4 \mathrm{~V}
$$

Thus $Q_{2}$ is still in the active mode. The corresponding output voltage is

$$
v_{O}(C)=4-0.65-0.65=2.7 \mathrm{~V}
$$

As $v_{I}$ is increased past the value of $v_{I}(C)=1.2 \mathrm{~V}, Q_{3}$ begins to conduct and operates in the active mode. Meanwhile, $Q_{1}$ remains saturated, and $Q_{2}$ and $Q_{4}$ remain in the active mode. The circuit behaves as an amplifier until $Q_{2}$ and $Q_{3}$ saturate and $Q_{4}$ cuts off. This occurs at point $D$ on the transfer characteristic, which corresponds to an input voltage $v_{I}(D)$ obtained from

$$
\begin{aligned}
v_{I}(D) & =V_{B E 3}+V_{B E 2}+V_{B C 1}-V_{B E 1} \\
& =0.7+0.7+0.7-0.7=1.4 \mathrm{~V}
\end{aligned}
$$

Note that we have in effect assumed that at point $D$ transistor $Q_{1}$ is still saturated, but with $V_{C E s a t} \simeq 0$. To see how this comes about, note that from point $B$ on, more and more of the base current of $Q_{1}$ is diverted to its base-collector junction. Thus while the drop across the base-collector junction increases, that across the base-emitter junction decreases. At point $D$ these drops become almost equal. For $v_{I}>v_{I}(D)$ the base-emitter junction of $Q_{1}$ cuts off; thus $Q_{1}$ leaves saturation and enters the inverse active mode.

Calculation of gain over the segment $C D$ is a relatively complicated task. This is due to the fact that there are two paths from input to output: one through $Q_{3}$ and one through $Q_{4}$. A simple but gross approximation for the gain of this segment can be obtained from the coordinates of points $C$ and $D$ in Fig. 14.23(b), as follows:

$$
\begin{aligned}
\text { Gain } & =-\frac{v_{O}(C)-v_{O}(D)}{v_{I}(D)-v_{I}(C)} \\
& =-\frac{2.7-0.1}{1.4-1.2}=-13 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$From the transfer curve of Fig. 14.23(b) we can determine the critical points and the noise margins as follows: $V_{O H}=3.7 \mathrm{~V} ; V_{I L}$ is somewhere in the range of 0.5 V to 1.2 V , and thus a conservative estimate would be $0.5 \mathrm{~V} ; V_{O L}=0.1 \mathrm{~V} ; V_{I H}=1.4 \mathrm{~V} ; N M_{H}=V_{O H}-V_{I H}=$ 2.3 V ; and $N M_{L}=V_{I L}-V_{O L}=0.4 \mathrm{~V}$. It should be noted that these values are computed assuming that the gate is not loaded and without taking into account power-supply or temperature variations.

# EXERCISE 

14.11 Taking into account the fact that the voltage across a forward-biased $p n$ junction changes by about $-2 \mathrm{mV} /{ }^{\circ} \mathrm{C}$, find the coordinates of points $A, B, C$, and $D$ of the gate transfer characteristic at $-55^{\circ} \mathrm{C}$ and at $+125^{\circ} \mathrm{C}$. Assume that the characteristic in Fig. 14.23(b) applies at $25^{\circ} \mathrm{C}$, and neglect the small temperature coefficient of $V_{\text {CEsat }}$.
Ans. At $-55^{\circ} \mathrm{C}:(0,3.38),(0.66,3.38),(1.52,2.16),(1.72,0.1)$; at $+125^{\circ} \mathrm{C}:(0,4.1),(0.3,4.1),(0.8,3.46)$, $(1.0,0.1)$

## Manufacturers' Specifications

Manufacturers of TTL usually provide curves for the gate transfer characteristic, the input $i-v$ characteristic, and the output $i-v$ characteristic, measured at the limits of the specified operating temperature range. In addition, guaranteed values are usually given for the parameters $V_{O L}, V_{O H}, V_{I L}$, and $V_{I H}$. For standard TTL (known as the 74 series) these values are $V_{O L}=$ $0.4 \mathrm{~V}, V_{O H}=2.4 \mathrm{~V}, V_{I L}=0.8 \mathrm{~V}$, and $V_{I H}=2 \mathrm{~V}$. These limit values are guaranteed for a specified tolerance in power-supply voltage and for a maximum fan-out of 10 . From our discussion in Section 14.3 we know that the maximum fan-out is determined by the maximum current that $Q_{3}$ can sink while remaining in saturation and while maintaining a saturation voltage lower than a guaranteed maximum $\left(V_{O L}=0.4 \mathrm{~V}\right)$. Calculations performed in Section 14.3 indicate the possibility of a maximum fan-out of 20 to 30 . Thus the figure specified by the manufacturer is appropriately conservative.

The parameters $V_{O L}, V_{O H}, V_{I L}$, and $V_{I H}$ can be used to compute the noise margins as follows:

$$
\begin{aligned}
& N M_{H}=V_{O H}-V_{I H}=0.4 \mathrm{~V} \\
& N M_{L}=V_{I L}-V_{O L}=0.4 \mathrm{~V}
\end{aligned}
$$

## EXERCISES

14.12 In Section 14.3 we found that when the gate input is high, the base current of $Q_{3}$ is approximately 2.6 mA . Assume that this value applies at $25^{\circ} \mathrm{C}$ and that at this temperature $V_{B E} \simeq 0.7 \mathrm{~V}$. Taking into account the $-2-\mathrm{mV} /{ }^{\circ} \mathrm{C}$ temperature coefficient of $V_{B E}$ and neglecting all other changes, find the base current of $Q_{3}$ at $-55^{\circ} \mathrm{C}$ and at $+125^{\circ} \mathrm{C}$.
Ans. $2.2 \mathrm{~mA} ; 3 \mathrm{~mA}$
14.13 Figure E14.13 shows sketches of the $i_{L}-v_{O}$ characteristics of a TTL gate when the output is low. Use these characteristics together with the results of Exercise 14.12 to calculate the value of $\beta$ of transistor $Q_{3}$ at $-55^{\circ} \mathrm{C},+25^{\circ} \mathrm{C}$, and $+125^{\circ} \mathrm{C}$.


FIGURE E14.13
Ans. 16; 25; 28

# Propagation Delay 

The propagation delay of TTL gates is defined conventionally as the time between the 1.5-V points of corresponding edges of the input and output waveforms. For standard TTL (also known as medium-speed TTL) $t_{P}$ is typically about 10 ns .

As far as power dissipation is concerned it can be shown (see Exercise 14.14) that when the gate output is high the gate dissipates 5 mW , and when the output is low the dissipation is 16.7 mW . Thus the average dissipation is 11 mW , resulting in a delay-power product of about 100 pJ .

## EXERCISE

14.14 Calculate the value of the supply current $\left(I_{C C}\right)$, and hence the power dissipated in the TTL gate, when the output terminal is open and the input is (a) low at 0.2 V (see Fig. 14.22) and (b) high at +5 V (see Fig. 14.20).
Ans. (a) $1 \mathrm{~mA}, 5 \mathrm{~mW}$; (b) $3.33 \mathrm{~mA}, 16.7 \mathrm{~mW}$

## Dynamic Power Dissipation

In Section 14.3 the occurrence of supply current spikes was explained. These spikes give rise to additional power drain from the $V_{C C}$ supply. This dynamic power is also dissipated in the gate circuit. It can be evaluated by multiplying the average current due to the spikes by $V_{C C}$, as illustrated by the solution of Exercise 14.15.
# EXERCISE 

14.15 Consider a TTL gate that is switched on and off at the rate of 1 MHz . Assume that each time the gate is turned off (that is, the output goes high) a supply-current pulse of $30-\mathrm{mA}$ amplitude and 2 -ns width occurs. Also assume that no current spike occurs when the gate is turned on. Calculate the average supply current due to the spikes, and the dynamic power dissipation.
Ans. $60 \mu \mathrm{~A} ; 0.3 \mathrm{~mW}$

## The TTL NAND Gate

Figure 14.24 shows the basic TTL gate. Its most important feature is the multiemitter transistor $Q_{1}$ used at the input. Figure 14.25 shows the structure of the multiemitter transistor.

It can be easily verified that the gate of Fig. 14.24 performs the NAND function. The output will be high if one (or both) of the inputs is (are) low. The output will be low in only


FIGURE 14.24 The TTL NAND gate.


FIGURE 14.25 Structure of the multiemitter transistor $Q_{1}$.


FIGURE 14.26 A TTL AND-OR-INVERT gate.
one case: when both inputs are high. Extension to more than two inputs is straightforward and is achieved by diffusing additional emitter regions.

Although theoretically an unused input terminal may be left open-circuited, this is generally not a good practice. An open-circuit input terminal acts as an "antenna" that "picks up" interfering signals and thus could cause erroneous gate switching. An unused input terminal should therefore be connected to the positive power supply through a resistance (of, say, $1 \mathrm{k} \Omega$ ). In this way the corresponding base-emitter junction of $Q_{1}$ will be reverse-biased and thus will have no effect on the operation of the gate. The series resistance is included in order to limit the current in case of breakdown of the base-emitter junction due to transients on the power supply.

# Other TTL Logic Circuits 

On a TTL MSI chip there are many cases in which logic functions are implemented using "stripped-down" versions of the basic TTL gate. As an example we show in Fig. 14.26 the TTL implementation of the AND-OR-INVERT function. As shown, the phase-splitter transistors of two gates are connected in parallel, and a single output stage is used. The reader is urged to verify that the logic function realized is as indicated.

At this point it should be noted that the totem-pole output stage of TTL does not allow connecting the output terminals of two gates to realize the AND function of their outputs (known as the wired-AND connection). To see the reason for this, consider two gates whose outputs are connected together, and let one gate have a high output and the other have a low output. Current will flow from $Q_{4}$ of the first gate through $Q_{3}$ of the second gate. The current value will fortunately be limited by the $130-\Omega$ resistance. Obviously, however, no useful logic function is realized by this connection.

The lack of wired-AND capability is a drawback of TTL. Nevertheless, the problem is solved in a number of ways, including doing the paralleling at the phase-splitter stage, as illustrated in Fig. 14.26. Another solution consists of deleting the emitter-follower transistor
altogether. The result is an output stage consisting solely of the common-emitter transistor $Q_{3}$ without even a collector resistance. Obviously, one can connect the outputs of such gates together to a common collector resistance and achieve a wired-AND capability. TTL gates of this type are known as open-collector TTL. The obvious disadvantage is the slow rise time of the output waveform.

Another useful variant of TTL is the tristate output arrangement explored in Exercise 14.16.

# EXERCISE 

14.16 The circuit shown in Fig. E14.16 is called tristate TTL. Verify that when the terminal labeled Third state is high, the gate functions normally and that when this terminal is low, both transistors $Q_{3}$ and $Q_{4}$ cut off and the output of the gate is an open circuit. The latter state is the third state, or the high-outputimpedance state.


FIGURE E14.16

Tristate TTL enables the connection of a number of TTL gates to a common output line (or bus). At any particular time the signal on the bus will be determined by the one TTL gate
that is enabled (by raising its third-state input terminal). All other gates will be in the third state and thus will have no control of the bus.

# 14.5 TTL FAMILIES WITH IMPROVED PERFORMANCE 

The standard TTL circuits studied in the two previous sections were introduced in the mid1960s. Since then, several improved versions have been developed. In this section we shall discuss some of these improved TTL subfamilies. As will be seen the improvements are in two directions: increasing speed and reducing power dissipation.

The speed of the standard TTL gate of Fig. 14.24 is limited by two mechanisms: first, transistors $Q_{1}, Q_{2}$, and $Q_{3}$ saturate, and hence we have to contend with their finite storage time. Although $Q_{2}$ is discharged reasonably quickly because of the active mode of operation of $Q_{1}$, as already explained, this is not true for $Q_{3}$, whose base charge has to leak out through the $1-\mathrm{k} \Omega$ resistance in its base circuit. Second, the resistances in the circuit, together with the various transistor and wiring capacitances, form relatively long time constants, which contribute to lengthening the gate delay.

It follows that there are two approaches to speeding up the operation of TTL. The first is to prevent transistor saturation and the second is to reduce the values of all resistances. Both approaches are utilized in the Schottky TTL circuit family.

## Schottky TTL

In Schottky TTL, transistors are prevented from saturation by connecting a low-voltagedrop diode between base and collector, as shown in Fig. 14.27. These diodes, formed as a metal-to-semiconductor junction, are called Schottky diodes and have a forward voltage drop of about 0.5 V . We have briefly discussed Schottky diodes in Section 3.9. Schottky diodes ${ }^{4}$ are easily fabricated and do not increase chip area. In fact, the Schottky TTL fabrication process has been designed to yield transistors with smaller areas and thus higher $\beta$ and $f_{T}$ than those produced by the standard TTL process. Figure 14.27 also shows the symbol used to represent the combination of a transistor and a Schottky diode, referred to as a Schottky transistor.


FIGURE 14.27 (a) A transistor with a Schottky diode clamp. (b) Circuit symbol for the connection in (a), known as a Schottky transistor.

[^0]
[^0]:    ${ }^{4}$ Note that silicon Schottky diodes exhibit voltage drops of about 0.5 V , whereas GaAs Schottky diodes (Section 5.12) exhibit voltage drops of about 0.7 V .


FIGURE 14.28 A Schottky TTL (known as STTL) NAND gate.

The Schottky transistor does not saturate since some of its base current drive is shunted away from the base by the Schottky diode. The latter then conducts and clamps the basecollector junction voltage to about 0.5 V . This voltage is smaller than the value required to forward-bias the collector-base junction of these small-sized transistors. In fact, a Schottky transistor begins to conduct when its $v_{B E}$ is about 0.7 V , and the transistor is fully conducting when $v_{B E}$ is about 0.8 V . With the Schottky diode clamping $v_{B C}$ to about 0.5 V , the collector-to-emitter voltage is about 0.3 V and the transistor is still operating in the active mode. By avoiding saturation, the Schottky-clamped transistor exhibits a very short turnoff time.

Figure 14.28 shows a Schottky-clamped, or simply Schottky, TTL NAND gate. Comparing this circuit to that of standard TTL shown in Fig. 14.24 reveals a number of variations. First and foremost, Schottky clamps have been added to all transistors except $Q_{4}$. As will be seen shortly, transistor $Q_{4}$ can never saturate and thus does not need a Schottky clamp. Second, all resistances have been reduced to almost half the values used in the standard circuit. These two changes result in a much shorter gate delay. The reduction in resistance values, however, increases the gate power dissipation (by a factor of about 2).

The Schottky TTL gate features three other circuit techniques that further improve performance. These are as follows:

1. The diode D needed to prevent $Q_{4}$ from conducting when the gate output is low is replaced by transistor $Q_{5}$, which together with $Q_{4}$ forms a Darlington pair. This
Darlington stage provides increased current gain and hence increased current-sourcing capability. This, together with the lower output resistance of the gate (in the outputhigh state), yields a reduction in the time required to charge the load capacitance to the high level. Note that transistor $Q_{4}$ never saturates because

$$
\begin{aligned}
V_{C E 4} & =V_{C E 5}+V_{R E 4} \\
& \simeq 0.3+0.8=1.1 \mathrm{~V}
\end{aligned}
$$

2. Input clamping diodes, $\mathrm{D}_{A}$ and $\mathrm{D}_{B}$, are included. ${ }^{5}$ These diodes conduct only when the input voltages go below ground level. This could happen due to "ringing" on the wires connecting the input of the gate to the output of another gate. Ringing occurs because such connecting wires behave as transmission lines that are not properly terminated. Without the clamping diodes, ringing can cause the input voltage to transiently go sufficiently negative so as to cause the substrate-to-collector junction of $Q_{1}$ (see Fig. 14.25) to become forward-biased. This in turn would result in improper gate operation. Also, ringing can cause the input voltage to go sufficiently positive to result in false gate switching. The input diodes clamp the negative excursions of the input ringing signal (to -0.5 V ). Their conduction also provides a power loss in the transmission line, which results in damping of the ringing waveform and thus a reduction in its positive-going part.
3. The resistance between the base of $Q_{3}$ and ground has been replaced by a nonlinear resistance realized by transistor $Q_{6}$, and two resistors, $R_{2}$ and $R_{5}$. This nonlinear resistance is known as an active pull-down, in analogy to the active pull-up provided by the emitter-follower part of the totem-pole output stage. This feature is an ingenious one, and we shall discuss it in more detail.

Active Pull-Down Figure 14.29 shows a sketch of the $i-v$ characteristic of the nonlinear network composed of $Q_{6}$ and its two associated resistors, $R_{2}$ and $R_{5}$. Also shown for comparison


FIGURE 14.29 Comparison of the $i-v$ characteristic of the active pull-down with that of a $600-\Omega$ resistor.

[^0]
[^0]:    ${ }^{5}$ Some standard TTL circuits also include input clamping diodes. Note, however, that in Schottky TTL, the input clamping diodes are of the Schottky type and function at a lower voltage and have no minority-carrier stored charge.


FIGURE 14.30 Voltage transfer characteristic of the Schottky TTL gate.
is the linear $i-v$ characteristic of a resistor that would be connected between the base of $Q_{3}$ and ground if the active pull-down were not used.

The first characteristic to note of the active pull-down is that it conducts negligible current (and thus behaves as a high resistance) until the voltage across it reaches a $V_{B E}$ drop. Thus the gain of the phase splitter (as a linear amplifier) will remain negligibly small until a $V_{B E}$ drop develops between its emitter and ground, which is the onset of conduction of $Q_{3}$. In other words, $Q_{2}, Q_{3}$, and $Q_{6}$ will turn on almost simultaneously. Thus segment $B C$ of the transfer characteristic (see Fig. 14.23b) will be absent and the gate transfer characteristic will become much sharper, as shown in Fig. 14.30. Since the active pull-down circuit causes the transfer characteristic to become "squarer," it is also known as a "squaring circuit." The result is an increase in noise margins.

The active pull-down circuit also speeds up the turn-on and turnoff of $Q_{3}$. To see how this comes about observe that the active pull-down draws a negligible current over a good part of its characteristic. Thus the current supplied by the phase splitter will initially be diverted into the base of $Q_{3}$, thereby speeding up the turn-on of $Q_{3}$. On the other hand, during turnoff the active pull-down transistor $Q_{6}$ will be operating in the active mode. Its large collector current will flow through the base of $Q_{3}$ in the reverse direction, thus quickly discharging the base-emitter capacitance of $Q_{3}$ and turning it off fast.

Finally, the function of the $250-\Omega$ collector resistance of $Q_{6}$ should be noted; without it the base-emitter voltage of $Q_{3}$ would be clamped to $V_{C E 6}$, which is about 0.3 V .

# EXERCISES 

14.17 Show that the values of $V_{O H}, V_{I L}, V_{I H}$, and $V_{O L}$ of the Schottky TTL gate are as given in Fig. 14.30. Assume that the gate output current is small and that a Schottky transistor conducts at $v_{B E}=0.7 \mathrm{~V}$ and is fully conducting at $v_{B E}=0.8 \mathrm{~V}$. (Hint: $V_{I L}$ is the input voltage at which $Q_{3}$ and $Q_{3}$ begin to turn on; $V_{I H}$ is the value at which $Q_{3}$ and $Q_{3}$ are fully conducting.)
14.18 Calculate the input current of a Schottky TTL gate with the input voltage low (at 0.3 V ). Ans. 1.4 mA
14.19 For the Schottky TTL gate calculate the current drawn from the power supply with the input low at 0.3 V (remember to include the current in the $3.5-\mathrm{k} \Omega$ resistor) and with the input high at 3.6 V . Hence calculate the gate power dissipation in both states and the average power dissipation.
Ans. $2.6 \mathrm{~mA} ; 5.4 \mathrm{~mA} ; 13 \mathrm{~mW} ; 27 \mathrm{~mW} ; 20 \mathrm{~mW}$

Performance Characteristics Schottky TTL (known as Series 74S) is specified to have the following worst-case parameters:

$$
\begin{array}{rlr}
V_{O H} & =2.7 \mathrm{~V} & V_{O L}=0.5 \mathrm{~V} \\
V_{I H} & =2.0 \mathrm{~V} & V_{I L}=0.8 \mathrm{~V} \\
t_{P} & =3 \mathrm{~ns} & P_{D}=20 \mathrm{~mW}
\end{array}
$$

Note that the delay-power product is 60 pJ , as compared with about 100 pJ for standard TTL.

# EXERCISE 

14.20 Use the values given above to calculate the noise margins $N M_{H}$ and $N M_{L}$ for a Schottky TTL gate. Ans. $0.7 \mathrm{~V} ; 0.3 \mathrm{~V}$

## Low-Power Schottky TTL

Although Schottky TTL achieves a very low propagation delay, the gate power dissipation is rather high. This limits the number of gates that can be included per package. The need therefore arose for a modified version that achieves a lower gate dissipation, possibly at the expense of an increase in gate delay. This is obtained in the low-power Schottky (LS) TTL subfamily, represented by the two-input NAND gate shown in Fig. 14.31.

The low-power Schottky circuit of Fig. 14.31 differs from that of the regular Schottky TTL of Fig. 14.28 in several ways: most important, note that the resistances used are about ten times larger, with the result that the power dissipation is only about a tenth of that of the Schottky circuit ( 2 mW versus 20 mW ). However, as expected, the use of larger resistances is accompanied by a reduction in the speed of operation. To help compensate for this speed reduction, some circuit design innovations are employed: First, the input multiemitter transistor has been eliminated in favor of Schottky diodes, which occupy a smaller silicon area and hence have smaller parasitic capacitances. In this regard it should be recalled that the main advantage of the input multiemitter transistor is that it rapidly removes the charge stored in the base of $Q_{3}$. In Schottky-clamped circuits, however, transistor $Q_{2}$ does not saturate, eliminating this aspect of the need for $Q_{1}$.

Second, two Schottky diodes, $\mathrm{D}_{3}$ and $\mathrm{D}_{4}$, have been added to the output stage to help speed up the turnoff of $Q_{4}$ and the turn-on of $Q_{3}$ and hence the transition of the output from high to low. Specifically, as the gate input is raised and $Q_{2}$ begins to turn on, some of its collector current will flow through diode $\mathrm{D}_{3}$. This current constitutes a reverse base current for $Q_{4}$ and thus aids in the rapid turnoff of $Q_{4}$. Simultaneously, the emitter current of $Q_{2}$ will be supplied to the base of $Q_{3}$, thus causing it to turn on faster. Some of the collector current of $Q_{2}$ will also flow through $\mathrm{D}_{4}$. This current will help discharge the gate load capacitance and thus shorten the transition time from high to low. Both $\mathrm{D}_{3}$ and $\mathrm{D}_{4}$ will be cut off under static conditions.

FIGURE 14.31 A low-power Schottky TTL (known as LSTTL) gate.
Finally, observe that the other terminal of the emitter resistor of $Q_{5}$ is now connected to the gate output. It follows that when the gate output is high, the output current will be first supplied by $Q_{5}$ through $R_{4}$. Transistor $Q_{4}$ will turn on only when a $0.7-\mathrm{V}$ drop develops across $R_{4}$, and thereafter it sources additional load current. However, when the gate is supplying a small load current, $Q_{4}$ will be off and the output voltage will be approximately.

$$
V_{O H}=V_{C C}-V_{B E 5}
$$

which is higher than the value obtained in the regular Schottky TTL gate.

# EXERCISES 

14.21 The voltage transfer characteristic of the low-power Schottky TTL gate of Fig. 14.31 has the same shape as that of the regular Schottky TTL gate, shown in Fig. 14.30. Calculate the values of $V_{O H}, V_{I L}$, $V_{I H}$, and $V_{O L}$. Assume that a Schottky transistor conducts at $v_{B E}=0.7 \mathrm{~V}$ and is fully conducting at $v_{B E}=$ 0.8 V , and that a Schottky diode has a $0.5-\mathrm{V}$ drop. Also assume that the gate output current is very small. Ans. $4.3 \mathrm{~V} ; 0.9 \mathrm{~V} ; 1.1 \mathrm{~V} ; 0.3 \mathrm{~V}$
14.22 For the low-power Schottky TTL gate, using the specifications given in Exercise 14.21, calculate the supply current in both states. Hence calculate the average power dissipation.
Ans. $0.21 \mathrm{~mA} ; 0.66 \mathrm{~mA} ; 2 \mathrm{~mW}$
TABLE 14.1 Performance Comparison of TTL Families

|  | Standard TTL <br> (Series 74) | Schottky TTL <br> (Series 74S) | Low-Power <br> Schottky TTL <br> (Series 74LS) | Advanced <br> Schottky TTL <br> (Series 74AS) | Advanced Low-Power <br> Schottky TTL <br> (Series 74ALS) |
| :-- | :--: | :--: | :--: | :--: | :--: |
| $t_{P}$, ns | 10 | 3 | 10 | 1.5 | 4 |
| $P_{D}, \mathrm{~mW}$ | 10 | 20 | 2 | 20 | 1 |
| $D P, \mathrm{pJ}$ | 100 | 60 | 20 | 30 | 4 |

Although the guaranteed voltage levels and noise margins of low-power Schottky TTL (known as Series 74LS) are similar to those of the regular Schottky TTL, the gate delay and power dissipation are

$$
t_{P}=10 \mathrm{~ns} \quad P_{D}=2 \mathrm{~mW}
$$

Thus although the power dissipation has been reduced by a factor of 10 , the delay has been increased by only a factor of 3 . The result is a delay-power product of only 20 pJ .

# Further-Improved TTL Families 

There are other TTL families with further improved characteristics. Of particular interest is the advanced Schottky (Series 74AS) and the advanced low-power Schottky (Series 74ALS). We shall not discuss the circuit details of these families here. Table 14.1 provides a comparison of the TTL subfamilies based on gate delay and power dissipation.

Observe that advanced low-power Schottky offers a very small delay-power product. In conclusion, we note that at the present time TTL, although no longer as popular as it once was, is still utilized in systems assembled using SSI and MSI chips. This is particularly the case for the advanced Schottky family whose speed of operation is rivaled only by that achieved in emitter-coupled logic (ECL). TTL, however, is not used in VLSI design.
# 15.4 Emitter-Coupled Logic (ECL) 

Emitter-coupled logic (ECL) is the fastest logic circuit family available for conventional logic-system design. ${ }^{4}$ High speed is achieved by operating all bipolar transistors out of saturation, thus avoiding storage-time delays, and by keeping the logic signal swings relatively small (about 0.8 V or less), thus reducing the time required to charge and discharge the various load and parasitic capacitances. Saturation in ECL is avoided by using the BJT differential pair as a current switch. ${ }^{5}$ The BJT differential pair was studied in Chapter 9, and we urge the reader to review the introduction given in Section 9.2 before proceeding with the study of ECL.

### 15.4.1 The Basic Principle

Emitter-coupled logic is based on the use of the current-steering switch introduced in Section 15.6. Such a switch can be most conveniently realized using the differential pair shown in Fig. 15.25. The pair is biased with a constant-current source $I$, and one side is connected to a reference voltage $V_{R}$. As shown in Section 9.2, the current $I$ can be steered to either $Q_{1}$ or $Q_{2}$ under the control of the input signal $v_{I}$. Specifically, when $v_{I}$ is greater than $V_{R}$ by about $4 V_{T}(\simeq 100 \mathrm{mV})$, nearly all the current $I$ is conducted by $Q_{1}$, and thus for $\alpha_{1} \simeq 1, v_{O 1}=V_{C C}-I R_{C}$. Simultaneously, the current through $Q_{2}$ will be nearly zero, and thus $v_{O 2}=V_{C C}$. Conversely, when $v_{I}$ is lower than $V_{R}$ by about $4 V_{T}$, most of the current $I$ will flow through $Q_{2}$ and the current through $Q_{1}$ will be nearly zero. Thus $v_{O 1}=V_{C C}$ and $v_{O 2}=V_{C C}-I R_{C}$.


Figure 15.25 The basic element of ECL is the differential pair. Here, $V_{R}$ is a reference voltage.

[^0]
[^0]:    ${ }^{4}$ Although higher speeds of operation can be obtained with gallium arsenide (GaAs) circuits, the latter are not available as off-the-shelf components for conventional digital system design. GaAs digital circuits are not covered in this book; however, a substantial amount of material on this subject can be found on the disc accompanying the book and on the website.
    ${ }^{5}$ This is in sharp contrast to the technique utilized in a nonsaturating variant of transistor-transistor logic (TTL) known as Schottky TTL. There, a Schottky diode is placed across the CBJ junction to shunt away some of the base current and, owing to the low voltage drop of the Schottky diode, the CBJ is prevented from becoming forward biased.
The preceding description suggests that as a logic element, the differential pair realizes an inversion function at $v_{O 1}$ and simultaneously provides the complementary output signal at $v_{O 2}$. The output logic levels are $V_{O H}=V_{C C}$ and $V_{O L}=V_{C C}-I R_{C}$, and thus the output logic swing is $I R_{C}$. A number of additional remarks can be made concerning this circuit:

1. The differential nature of the circuit makes it less susceptible to picked-up noise. In particular, an interfering signal will tend to affect both sides of the differential pair similarly and thus will not result in current switching. This is the common-mode rejection property of the differential pair (see Section 9.2).
2. The current drawn from the power supply remains constant during switching. Thus, unlike CMOS (and TTL), no supply current spikes occur in ECL, eliminating an important source of noise in digital circuits. This is a definite advantage, especially since ECL is usually designed to operate with small signal swings and has correspondingly low noise margins.
3. The output signal levels are both referenced to $V_{C C}$ and thus can be made particularly stable by operating the circuit with $V_{C C}=0$ : in other words, by utilizing a negative power supply and connecting the $V_{C C}$ line to ground. In this case, $V_{O H}=0$ and $V_{O L}=-I R_{C}$.
4. Some means must be provided to make the output signal levels compatible with those at the input so that one gate can drive another. As we shall see shortly, practical ECL gate circuits incorporate a level-shifting arrangement that serves to center the output signal levels on the value of $V_{R}$.
5. The availability of complementary outputs considerably simplifies logic design with ECL.

# EXERCISE 

15.11 For the circuit in Fig. 15.25, let $V_{C C}=0, I=4 \mathrm{~mA}, R_{C}=220 \Omega, V_{R}=-1.32 \mathrm{~V}$, and assume $\alpha \simeq 1$. Determine $V_{O H}$ and $V_{O L}$. By how much should the output levels be shifted so that the values of $V_{O H}$ and $V_{O L}$ become centered on $V_{R}$ ? What will the shifted values of $V_{O H}$ and $V_{O L}$ be?
Ans. $0 ;-0.88 \mathrm{~V} ;-0.88 \mathrm{~V} ;-0.88 \mathrm{~V},-1.76 \mathrm{~V}$

### 15.4.2 ECL Families

Currently there are two popular forms of commercially available ECL—namely, ECL 10K and ECL 100K. The ECL 100 K series features gate delays on the order of 0.75 ns and dissipates about $40 \mathrm{~mW} /$ gate, for a delay-power product of 30 pJ . Although its power dissipation is relatively high, the 100 K series provides the shortest available gate delay in small- and medium-scale integrated circuit packages.

The ECL 10 K series is slightly slower; it features a gate propagation delay of 2 ns and a power dissipation of 25 mW for a delay-power product of 50 pJ . Although the value of $P D P$ is higher than that obtained in the 100 K series, the 10 K series is easier to use. This is because the rise and fall times of the pulse signals are deliberately made longer, thus reducing signal coupling, or cross talk, between adjacent signal lines. ECL 10K has an "edge speed"
of about 3.5 ns , compared with the approximately 1 ns of ECL 100K. To give concreteness to our study of ECL, in the following we shall consider the popular ECL 10K in some detail. The same techniques, however, can be applied to other types of ECL.

In addition to its usage in SSI and MSI circuit packages, ECL is also employed in large-scale and VLSI applications. A variant of ECL known as current-mode logic (CML) is utilized in VLSI applications (see Treadway, 1989, and Wilson, 1990).

# 15.4.3 The Basic Gate Circuit 

The basic gate circuit of the ECL 10K family is shown in Fig. 15.26. The circuit consists of three parts. The network composed of $Q_{1}, D_{1}, D_{2}, R_{1}, R_{2}$, and $R_{3}$ generates a reference voltage $V_{R}$ whose value at room temperature is -1.32 V . As will be shown, the value of this reference voltage is made to change with temperature in a predetermined manner to keep the noise margins almost constant. Also, the reference voltage $V_{R}$ is made relatively insensitive to variations in the power-supply voltage $V_{E E}$.

## EXERCISE

15.12 Figure E15.12 shows the circuit that generates the reference voltage $V_{R}$. Assuming that the voltage drop across each of $D_{1}, D_{2}$, and the base-emitter junction of $Q_{1}$ is 0.75 V , calculate the value of $V_{R}$. Neglect the base current of $Q_{1}$.


Figure E15.12

Ans. -1.32 V

The second part, and the heart of the gate, is the differential amplifier formed by $Q_{R}$ and either $Q_{A}$ or $Q_{B}$. This differential amplifier is biased not by a constant-current source, as was done in the circuit of Fig. 15.25, but with a resistance $R_{E}$ connected to the negative supply $-V_{E E}$. Nevertheless, we will shortly show that the current in $R_{E}$ remains approximately


Figure 15.26 Basic circuit of the ECL 10K logic-gate family.
constant over the normal range of operation of the gate. One side of the differential amplifier consists of the reference transistor $Q_{R}$, whose base is connected to the reference voltage $V_{R}$. The other side consists of a number of transistors (two in the case shown), connected in parallel, with separated bases, each connected to a gate input. If the voltages applied to $A$ and $B$ are at the logic- 0 level, which, as we will soon find out, is about 0.4 V below $V_{R}$, both $Q_{A}$ and $Q_{B}$, will be off and the current $I_{E}$ in $R_{E}$ will flow through the reference transistor $Q_{R}$. The resulting voltage drop across $R_{C 2}$ will cause the collector voltage of $Q_{R}$ to be low.

On the other hand, when the voltage applied to $A$ or $B$ is at the logic-1 level, which, as we will show shortly, is about 0.4 V above $V_{R}$, transistor $Q_{A}$ or $Q_{B}$, or both, will be on and $Q_{R}$ will be off. Thus the current $I_{E}$ will flow through $Q_{A}$ or $Q_{B}$, or both, and an almost equal current will flow through $R_{C 1}$. The resulting voltage drop across $R_{C 1}$ will cause the collector voltage to drop. Meanwhile, since $Q_{R}$ is off, its collector voltage rises. We thus see that the voltage at the collector of $Q_{R}$ will be high if $A$ or $B$, or both, is high, and thus at the collector of $Q_{R}$, the OR logic function, $A+B$, is realized. On the other hand, the common collector of $Q_{A}$ and $Q_{B}$ will be high only when $A$ and $B$ are simultaneously low. Thus at the common collector of $Q_{A}$ and $Q_{B}$, the logic function $\overline{A B}=\overline{A+B}$ is realized. We therefore conclude that the two-input gate of Fig. 15.26 realizes the OR function and its complement, the NOR function. The availability of complementary outputs is an important advantage of ECL; it simplifies logic design and avoids the use of additional inverters with associated time delay.

It should be noted that the resistance connecting each of the gate input terminals to the negative supply enables the user to leave an unused input terminal open: An open input terminal will be pulled down to the negative supply voltage, and its associated transistor will be off.

# EXERCISE 

15.13 With input terminals $A$ and $B$ in Fig. 15.26 left open, find the current $I_{E}$ through $R_{E}$. Also find the voltages at the collector of $Q_{R}$ and at the common collector of the input transistors $Q_{A}$ and $Q_{B}$. Use $V_{R}=-1.32 \mathrm{~V}, V_{B E}$ of $Q_{R} \simeq 0.75 \mathrm{~V}$, and assume that $\beta$ of $Q_{R}$ is very high.
Ans. $4 \mathrm{~mA} ;-1 \mathrm{~V} ; 0 \mathrm{~V}$

The third part of the ECL gate circuit is composed of the two emitter followers, $Q_{2}$ and $Q_{3}$. The emitter followers do not have on-chip loads, since in many applications of high-speed logic circuits the gate output drives a transmission line terminated at the other end, as indicated in Fig. 15.27. (More on this later in Section 15.4.6.)

The emitter followers have two purposes: First, they shift the level of the output signals by one $V_{B E}$ drop. Thus, using the results of Exercise 15.13, we see that the output levels become approximately -1.75 V and -0.75 V . These shifted levels are centered approximately around the reference voltage ( $V_{R}=-1.32 \mathrm{~V}$ ), which means that one gate can drive another. This compatibility of logic levels at input and output is an essential requirement in the design of gate circuits.

The second function of the output emitter followers is to provide the gate with low output resistances and with the large output currents required for charging load capacitances. Since these large transient currents can cause spikes on the power-supply line, the collectors of


Figure 15.27 The proper way to connect high-speed logic gates such as ECL. Properly terminating the transmission line connecting the two gates eliminates the "ringing" that would otherwise corrupt the logic signals. (See Section 15.4.6.)
the emitter followers are connected to a power-supply terminal $V_{C C 1}$ separate from that of the differential amplifier and the reference-voltage circuit, $V_{C C 2}$. Here we note that the supply current of the differential amplifier and the reference circuit remains almost constant. The use of separate power-supply terminals prevents the coupling of power-supply spikes from the output circuit to the gate circuit and thus lessens the likelihood of false gate switching. Both $V_{C C 1}$ and $V_{C C 2}$ are of course connected to the same system ground, external to the chip.

# 15.4.4 Voltage-Transfer Characteristics 

Having provided a qualitative description of the operation of the ECL gate, we shall now derive its voltage-transfer characteristics. This will be done under the conditions that the outputs are terminated in the manner indicated in Fig. 15.27. Assuming that the $B$ input is low and thus $Q_{B}$ is off, the circuit simplifies to that shown in Fig. 15.28. We wish to analyze this circuit to determine $v_{O B}$ versus $v_{I}$ and $v_{\text {NOR }}$ versus $v_{I}$ (where $v_{I} \equiv v_{A}$ ).


Figure 15.28 Simplified version of the ECL gate for the purpose of finding transfer characteristics.
In the analysis to follow we shall make use of the exponential $i_{C}-v_{B E}$ characteristic of the BJT. Since the BJTs used in ECL circuits have small areas (in order to have small capacitances and hence high $f_{T}$ ), their scale currents $I_{S}$ are small. We will therefore assume that at an emitter current of 1 mA , an ECL transistor has a $V_{B E}$ drop of 0.75 V .

The OR Transfer Curve Figure 15.29 is a sketch of the OR transfer characteristic, $v_{O R}$ versus $v_{I}$, with the parameters $V_{O L}, V_{O H}, V_{I L}$, and $V_{I H}$ indicated. However, to simplify the calculation of $V_{I L}$ and $V_{I H}$, we shall use an alternative to the unity-gain definition. Specifically, we shall assume that at point $x$, transistor $Q_{A}$ is conducting $1 \%$ of $I_{E}$ while $Q_{R}$ is conducting $99 \%$ of $I_{E}$. The reverse will be assumed for point $y$. Thus at point $x$ we have

$$
\left.\frac{I_{E}\right|_{Q_{R}}}{\left.I_{E}\right|_{Q_{A}}}=99
$$

Using the exponential $i_{E}-v_{B E}$ relationship, we obtain

$$
\left.V_{B E}\right|_{Q_{R}}-\left.V_{B E}\right|_{Q_{A}}=V_{T} \ln 99=115 \mathrm{mV}
$$

which gives

$$
V_{I L}=-1.32-0.115=-1.435 \mathrm{~V}
$$

Assuming $Q_{A}$ and $Q_{R}$ to be matched, we can write

$$
V_{I H}-V_{R}=V_{R}-V_{I L}
$$

which can be used to find $V_{I H}$ as

$$
V_{I H}=-1.205 \mathrm{~V}
$$

To obtain $V_{O L}$, we note that $Q_{A}$ is off and $Q_{R}$ carries the entire current $I_{E}$, given by

$$
I_{E}=\frac{V_{R}-\left.V_{B E}\right|_{Q_{R}}+V_{E E}}{R_{E}}
$$



Figure 15.29 The OR transfer characteristic $v_{O R}$ versus $v_{I}$, for the circuit in Fig. 15.28.
$$
\begin{aligned}
& =\frac{-1.32-0.75+5.2}{0.779} \\
& \simeq 4 \mathrm{~mA}
\end{aligned}
$$

(If we wish, we can iterate to determine a better estimate of $\left.V_{B E}\right|_{Q_{R}}$ and hence of $I_{E}$.) Assuming that $Q_{R}$ has a high $\beta$ so that its $\alpha \simeq 1$, its collector current will be approximately 4 mA . If we neglect the base current of $Q_{2}$, we obtain for the collector voltage of $Q_{R}$

$$
\left.V_{C}\right|_{Q_{R}} \simeq-4 \times 0.245=-0.98 \mathrm{~V}
$$

Thus a first approximation for the value of the output voltage $V_{O L}$ is

$$
\begin{aligned}
V_{O L} & =\left.V_{C}\right|_{Q_{R}}-\left.V_{B E}\right|_{Q_{2}} \\
& \simeq-0.98-0.75=-1.73 \mathrm{~V}
\end{aligned}
$$

We can use this value to find the emitter current of $Q_{2}$ and then iterate to determine a better estimate of its base-emitter voltage. The result is $V_{B E 2} \simeq 0.79 \mathrm{~V}$ and, correspondingly,

$$
V_{O L} \simeq-1.77 \mathrm{~V}
$$

At this value of output voltage, $Q_{2}$ supplies a load current of about 4.6 mA .
To find the value of $V_{O H}$ we assume that $Q_{R}$ is completely cut off (because $v_{I}>V_{I H}$ ). Thus the circuit for determining $V_{O H}$ simplifies to that in Fig. 15.30. Analysis of this circuit, assuming $\beta_{2}=100$, results in $V_{B E 2} \simeq 0.83 \mathrm{~V}, I_{E 2}=22.4 \mathrm{~mA}$, and

$$
V_{O H} \simeq-0.88 \mathrm{~V}
$$



Figure 15.30 Circuit for determining $V_{O H}$.

# EXERCISE 

15.14 For the circuit in Fig. 15.28, determine the values of $I_{E}$ obtained when $v_{I}=V_{I L}, V_{R}$, and $V_{I H}$. Also, find the value of $v_{O R}$ corresponding to $v_{I}=V_{R}$. Assume that $v_{B E}=0.75 \mathrm{~V}$ at a current of 1 mA . Ans. $3.97 \mathrm{~mA} ; 4.00 \mathrm{~mA} ; 4.12 \mathrm{~mA} ;-1.31 \mathrm{~V}$Noise Margins The results of Exercise 15.14 indicate that the bias current $I_{E}$ remains approximately constant. Also, the output voltage corresponding to $v_{I}=V_{R}$ is approximately equal to $V_{R}$. Notice further that this is also approximately the midpoint of the logic swing; specifically,

$$
\frac{V_{O L}+V_{O H}}{2}=-1.325 \simeq V_{R}
$$

Thus the output logic levels are centered around the midpoint of the input transition band. This is an ideal situation from the point of view of noise margins, and it is one of the reasons for selecting the rather arbitrary-looking numbers $\left(V_{R}=-1.32 \mathrm{~V}\right.$ and $\left.V_{E E}=5.2 \mathrm{~V}\right)$ for reference and supply voltages.

The noise margins can now be evaluated as follows:

$$
\begin{aligned}
N M_{H} & =V_{O H}-V_{I H} & N M_{L} & =V_{I L}-V_{O L} \\
& =-0.88-(-1.205)=0.325 \mathrm{~V} & & =-1.435-(-1.77)=0.335 \mathrm{~V}
\end{aligned}
$$

Note that these values are approximately equal.
The NOR Transfer Curve The NOR transfer characteristic, which is $v_{\text {NOR }}$ versus $v_{I}$ for the circuit in Fig. 15.28, is sketched in Fig. 15.31. The values of $V_{I L}$ and $V_{I H}$ are identical to those found earlier for the OR characteristic. To emphasize this, we have labeled the threshold points $x$ and $y$, the same letters used in Fig. 15.29.

For $v_{I}<V_{I L}, Q_{A}$ is off and the output voltage $v_{\text {NOR }}$ can be found by analyzing the circuit composed of $R_{C 1}, Q_{3}$, and its $50-\Omega$ termination. Except that $R_{C 1}$ is slightly smaller than $R_{C 2}$, this circuit is identical to that in Fig. 15.30. Thus the output voltage will be only slightly greater than the value $V_{O H}$ found earlier. In the sketch of Fig. 15.31 we have assumed that the output voltage is approximately equal to $V_{O H}$.

For $v_{I}>V_{I H}, Q_{A}$ is on and is conducting the entire bias current. The circuit then simplifies to that in Fig. 15.32. This circuit can be easily analyzed to obtain $v_{\text {NOR }}$ versus $v_{I}$ for the range


Figure 15.31 The NOR transfer characteristic, $v_{\text {NOR }}$ versus $v_{I}$, for the circuit in Fig. 15.28.


Figure 15.32 Circuit for finding $v_{\mathrm{NOR}}$ versus $v_{I}$ for the range $v_{I}>V_{I H}$.
$v_{I} \geq V_{I H}$. A number of observations are in order. First, note that $v_{I}=V_{I H}$ results in an output voltage slightly higher than $V_{O L}$. This is because $R_{C 2}$ is smaller than $R_{C 2}$. In fact, $R_{C 1}$ is chosen lower in value than $R_{C 2}$ so that with $v_{I}$ equal to the normal logic-1 value (i.e., $V_{O H}$, which is approximately -0.88 V ), the output will be equal to the $V_{O L}$ value found earlier for the OR output.

Second, note that as $v_{I}$ exceeds $V_{I H}$, transistor $Q_{A}$ operates in the active mode and the circuit of Fig. 15.32 can be analyzed to find the gain of this amplifier, which is the slope of the segment $y z$ of the transfer characteristic. At point $z$, transistor $Q_{A}$ saturates. Further increments in $v_{I}$ (beyond the point $v_{I}=V_{S}$ ) cause the collector voltage and hence $v_{\mathrm{NOR}}$ to increase. The slope of the segment of the transfer characteristic beyond point $z$, however, is not unity, but is about 0.5 , because as $Q_{A}$ is driven deeper into saturation, a portion of the increment in $v_{I}$ appears as an increment in the base-collector forward-bias voltage. The reader is urged to solve Exercise 15.15, which is concerned with the details of the NOR transfer characteristic.

# EXERCISE 

15.15 Consider the circuit in Fig. 15.32. (a) For $v_{I}=V_{I H}=-1.205 \mathrm{~V}$, find $v_{\mathrm{NOR}}$. (b) For $v_{I}=V_{O H}=-0.88 \mathrm{~V}$, find $v_{\text {NOR }}$. (c) Find the slope of the transfer characteristic at the point $v_{I}=V_{O H}=-0.88 \mathrm{~V}$. (d) Find the value of $v_{I}$ at which $Q_{A}$ saturates (i.e., $V_{S}$ ). Assume that $V_{B E}=0.75 \mathrm{~V}$ at a current of $1 \mathrm{~mA}, V_{C E \text { sat }} \simeq 0.3 \mathrm{~V}$, and $\beta=100$.
Ans. (a) -1.70 V ; (b) -1.79 V ; (c) $-0.24 \mathrm{~V} / \mathrm{V}$; (d) -0.58 V

Manufacturers' Specifications ECL manufacturers supply gate transfer characteristics of the form shown in Figs. 15.29 and 15.31. A manufacturer usually provides such curves measured at a number of temperatures. In addition, at each relevant temperature, worst-case values for the parameters $V_{I L}, V_{I H}, V_{O L}$, and $V_{O H}$ are given. These worst-case values are specified with the inevitable component tolerances taken into account. As an example, Motorola specifies that for MECL 10,000 at $25^{\circ} \mathrm{C}$, the following worst-case
values apply ${ }^{6}$

$$
\begin{array}{ll}
V_{I L \max }=-1.475 \mathrm{~V} & V_{I H \min }=-1.105 \mathrm{~V} \\
V_{O L \max }=-1.630 \mathrm{~V} & V_{O H \min }=-0.980 \mathrm{~V}
\end{array}
$$

These values can be used to determine worst-case noise margins,

$$
N M_{L}=0.155 \mathrm{~V} \quad N M_{H}=0.125 \mathrm{~V}
$$

which are about half the typical values previously calculated.
For additional information on MECL specifications the interested reader is referred to the Motorola $(1988,1989)$ publications listed in the bibliography in Appendix I.

# 15.4.5 Fan-Out 

When the input signal to an ECL gate is low $\left(V_{O L}\right)$, the input current is equal to the current that flows in the $50-\mathrm{k} \Omega$ pull-down resistor. Thus,

$$
I_{I L}=\frac{-1.77+5.2}{50} \simeq 69 \mu \mathrm{~A}
$$

When the input is high $\left(V_{O H}\right)$, the input current is greater because of the base current of the input transistor. Thus, assuming a transistor $\beta$ of 100 , we obtain

$$
I_{I H}=\frac{-0.88+5.2}{50}+\frac{4}{101} \simeq 126 \mu \mathrm{~A}
$$

Both these current values are quite small, which, coupled with the very small output resistance of the ECL gate, ensures that little degradation of logic-signal levels results from the input currents of fan-out gates. It follows that the fan-out of ECL gates is not limited by logic-level considerations but rather by the degradation of the circuit speed (rise and fall times). This latter effect is due to the capacitance that each fan-out gate presents to the driving gate (approximately 3 pF ). Thus while the $d c$ fan-out can be as high as 90 and thus does not represent a design problem, the ac fan-out is limited by considerations of circuit speed to 10 or so.

### 15.4.6 Speed of Operation and Signal Transmission

The speed of operation of a logic family is measured by the delay of its basic gate and by the rise and fall times of the output waveforms. Typical values of these parameters for ECL have already been given. Here we should note that because the output circuit is an emitter follower, the rise time of the output signal is shorter than its fall time, since on the rising edge of the output pulse, the emitter follower functions and provides the output current required to charge up the load and parasitic capacitances. On the other hand, as the signal at the base of the emitter follower falls, the emitter follower cuts off, and the load capacitance discharges through the combination of load and pull-down resistances.

To take full advantage of the very high speed of operation possible with ECL, special attention should be paid to the method of interconnecting the various logic gates in a system. To appreciate this point, we shall briefly discuss the problem of signal transmission.

ECL deals with signals whose rise times may be 1 ns or even less, the time it takes for light to travel only 30 cm or so. For such signals, a wire and its environment become a relatively complex circuit element along which signals propagate with finite speed (perhaps half the speed of light—i.e., $15 \mathrm{~cm} / \mathrm{ns}$ ). Unless special care is taken, energy that reaches the end

[^0]
[^0]:    ${ }^{6}$ MECL is the trade name used by Motorola (now Freescale Semiconductors) for its ECL.
of such a wire is not absorbed but rather returns as a reflection to the transmitting end, where (without special care) it may be re-reflected. The result of this process of reflection is what can be observed as ringing, a damped oscillatory excursion of the signal about its final value.

Unfortunately, ECL is particularly sensitive to ringing because the signal levels are so small. Thus it is important that transmission of signals be well controlled, and surplus energy absorbed, to prevent reflections. The accepted technique is to limit the nature of connecting wires in some way. One way is to insist that they be very short, where "short" is taken to mean with respect to the signal rise time. The reason for this is that if the wire connection is so short that reflections return while the input is still rising, the result becomes only a somewhat slowed and "bumpy" rising edge.

If, however, the reflection returns after the rising edge, it produces not simply a modification of the initiating edge but an independent second event. This is clearly bad! Thus the time taken for a signal to go from one end of a line and back is restricted to less than the rise time of the driving signal by some factor-say, 5 . Thus for a signal with a 1 -ns rise time and for propagation at the speed of light ( $30 \mathrm{~cm} / \mathrm{ns}$ ), a double path of only $0.2-\mathrm{ns}$ equivalent length, or 6 cm , would be allowed, representing in the limit a wire only 3 cm from end to end.

Such is the restriction on ECL 100K. However, ECL 10K has an intentionally slower rise time of about 3.5 ns . Using the same rules, wires can accordingly be as long as about 10 cm for ECL 10K.

If greater lengths are needed, then transmission lines must be used. These are simply wires in a controlled environment in which the distance to a ground reference plane or a second wire is highly controlled. Thus they might simply be twisted pairs of wires, one of which is grounded, or parallel ribbon wires, every second of which is grounded, or so-called microstrip lines on a printed-circuit board. The latter are simply copper strips of controlled geometry on one side of a thin printed-circuit board, the other side of which consists of a grounded plane.

Such transmission lines have a characteristic impedance, $R_{0}$, that ranges from a few tens of ohms to hundreds of ohms. Signals propagate on such lines somewhat more slowly than the speed of light, perhaps half as fast. When a transmission line is terminated at its receiving end in a resistance equal to its characteristic impedance, $R_{0}$, all the energy sent on the line is absorbed at the receiving end, and no reflections occur (since the termination acts as a limitless length of transmission line). Thus, signal integrity is maintained. Such transmission lines are said to be properly terminated. A properly terminated line appears at its sending end as a resistor of value $R_{0}$. The followers of ECL 10 K with their open emitters and low output resistances (specified to be $7 \Omega$ maximum) are ideally suited for driving transmission lines. ECL is also good as a line receiver. The simple gate with its high $(50-\mathrm{k} \Omega)$ pull-down input resistor represents a very high resistance to the line. Thus a few such gates can be connected to a terminated line with little difficulty. Both these ideas are represented in Fig. 15.27.

# 15.4.7 Power Dissipation 

Because of the differential-amplifier nature of ECL, the gate current remains approximately constant and is simply steered from one side of the gate to the other depending on the input logic signals. Thus, the supply current and hence the gate power dissipation of unterminated ECL remain relatively constant independent of the logic state of the gate. It follows that no voltage spikes are introduced on the supply line. Such spikes can be a dangerous source of noise in a digital system. It follows that in ECL the need for supply-line bypassing ${ }^{\dagger}$ is not as great as in, say, TTL. This is another advantage of ECL.

[^0]
[^0]:    ${ }^{\dagger}$ Achieved by connecting capacitances to ground at frequent intervals along the power-supply line on a printed-circuit board.
At this juncture we should reiterate a point we made earlier, namely, that although an ECL gate would operate with $V_{E E}=0$ and $V_{C C}=+5.2 \mathrm{~V}$, the selection of $V_{E E}=-5.2 \mathrm{~V}$ and $V_{C C}=0 \mathrm{~V}$ is recommended, because in the circuit, all signal levels are referenced to $V_{C C}$, and ground is certainly an excellent reference.

# EXERCISE 

15.16 For the ECL gate in Fig. 15.26, calculate an approximate value for the power dissipated in the circuit under the condition that all inputs are low and that the emitters of the output followers are left open. Assume that the reference circuit supplies four identical gates, and hence only a quarter of the power dissipated in the reference circuit should be attributed to a single gate.
Ans. 22.4 mW

### 15.4.8 Thermal Effects

In our analysis of the ECL gate of Fig. 15.26, we found that at room temperature the reference voltage $V_{R}$ is -1.32 V . We have also shown that the midpoint of the output logic swing is approximately equal to this voltage, which is an ideal situation in that it results in equal high and low noise margins. In Example 15.4, we shall derive expressions for the temperature coefficients of the reference voltage and of the output low and high voltages. In this way, it will be shown that the midpoint of the output logic swing varies with temperature at the same rate as the reference voltage. As a result, although the magnitudes of the high and low noise margins change with temperature, their values remain equal. This is an added advantage of ECL and provides a demonstration of the high degree of design optimization of this gate circuit.

## Example 15.4

We wish to determine the temperature coefficient of the reference voltage $V_{R}$ and of the midpoint between $V_{o L}$ and $V_{o H}$.

## Solution

To determine the temperature coefficient of $V_{R}$, consider the circuit in Fig. E15.12 and assume that the temperature changes by $+1^{\circ} \mathrm{C}$. Denoting the temperature coefficient of the diode and transistor voltage drops by $\delta$, where $\delta \simeq-2 \mathrm{mV} /{ }^{\circ} \mathrm{C}$, we obtain the equivalent circuit shown in Fig. 15.33. In the latter circuit, the changes in device voltage drops are considered as signals, and hence the power supply is shown as a signal ground.

In the circuit of Fig. 15.33 we have two signal generators, and we wish to analyze the circuit to determine $\Delta V_{R}$, the change in $V_{R}$. We shall do so using the principle of superposition. ${ }^{8}$ Consider first the branch $R_{1}, D_{1}, D_{2}, 2 \delta$, and $R_{2}$, and neglect the signal base current of $Q_{1}$. The voltage signal at the base of $Q_{1}$ can be easily obtained from

[^0]
[^0]:    ${ }^{8}$ Although the circuit contains diodes and a transistor, which are nonlinear elements, we can use superposition because we are dealing with small changes in voltages and currents, and thus the diodes and the transistor are replaced by their linear small-signal models.


Figure 15.33 Equivalent circuit for determining the temperature coefficient of the reference voltage $V_{R}$.

$$
v_{b 1}=\frac{2 \delta \times R_{1}}{R_{1}+r_{d 1}+r_{d 2}+R_{2}}
$$

where $r_{d 1}$ and $r_{d 2}$ denote the incremental resistances of diodes $D_{1}$ and $D_{2}$, respectively. The dc bias current through $D_{1}$ and $D_{2}$ is approximately 0.64 mA , and thus $r_{d 1}=r_{d 2}=39.5 \Omega$. Hence $v_{b 1} \simeq 0.3 \delta$. Since the gain of the emitter follower $Q_{1}$ is approximately unity, it follows that the component of $\Delta V_{R}$ due to the generator $2 \delta$ is approximately equal to $v_{b 1}$, that is, $\Delta V_{R 1}=0.3 \delta$.

Consider next the component of $\Delta V_{R}$ due to the generator $\delta$. Reflection into the emitter circuit of the total resistance of the base circuit, $\left[R_{1} \|\left(r_{d 1}+r_{d 2}+R_{2}\right)\right]$, by dividing it by $\beta+1$ (with $\beta \simeq 100$ ) results in the following component of $\Delta V_{R}$ :

$$
\Delta V_{R 2}=-\frac{\delta \times R_{3}}{\left[R_{R} /(\beta+1)\right]+r_{e 1}+R_{3}}
$$

Here $R_{R}$ denotes the total resistance in the base circuit, and $r_{e 1}$ denotes the emitter resistance of $Q_{1}(\simeq 40 \Omega)$. This calculation yields $\Delta V_{R 2} \simeq-\delta$. Adding this value to that due to the generator $2 \delta$ gives $\Delta V_{\mathrm{R}} \simeq-0.7 \delta$. Thus for $\delta=-2 \mathrm{mV} /{ }^{\circ} \mathrm{C}$ the temperature coefficient of $V_{R}$ is $+1.4 \mathrm{mV} /{ }^{\circ} \mathrm{C}$.

We next consider the determination of the temperature coefficient of $V_{O L}$. The circuit on which to perform this analysis is shown in Fig. 15.34. Here we have three generators whose contributions can be considered separately and the resulting components of $\Delta V_{O L}$ summed. The result is

$$
\begin{aligned}
\Delta V_{O L}= & \Delta V_{R} \frac{-R_{C 2}}{r_{e R}+R_{E}} \frac{R_{T}}{R_{T}+r_{e 2}} \\
& -\delta \frac{-R_{C 2}}{r_{e R}+R_{E}} \frac{R_{T}}{R_{T}+r_{e 2}} \\
& -\delta \frac{R_{T}}{R_{T}+r_{e 2}+R_{C 2} /(\beta+1)}
\end{aligned}
$$
# Example 15.4 continued 

Substituting the values given and those obtained throughout the analysis of this section, we find

$$
\Delta V_{O L} \simeq-0.43 \delta
$$

The circuit for determining the temperature coefficient of $V_{O H}$ is shown in Fig. 15.35, from which we obtain

$$
\Delta V_{O H}=-\delta \frac{R_{T}}{R_{T}+r_{e 2}+R_{C 2} /(\beta+1)}=-0.93 \delta
$$

We now can obtain the variation of the midpoint of the logic swing as

$$
\frac{\Delta V_{O L}+\Delta V_{O H}}{2}=-0.68 \delta
$$

which is approximately equal to that of the reference voltage $V_{R}(-0.7 \delta)$.


Figure 15.34 Equivalent circuit for determining the temperature coefficient of $V_{O L}$.


Figure 15.35 Equivalent circuit for determining the temperature coefficient of $V_{O H}$.
# 15.4.9 The Wired-OR Capability 

The emitter-follower output stage of the ECL family allows an additional level of logic to be performed at very low cost by simply wiring the outputs of several gates in parallel. This is illustrated in Fig. 15.36, where the outputs of two gates are wired together. Note that the base-emitter diodes of the output followers realize an OR function: This wired-OR connection can be used to provide gates with high fan-in as well as to increase the flexibility of ECL in logic design.


Figure 15.36 The wired-OR capability of ECL.

### 15.4.10 Final Remarks

We have chosen to study ECL by focusing on a commercially available circuit family. As has been demonstrated, a great deal of design optimization has been applied to create a very-high-performance family of SSI and MSI logic circuits. As already mentioned, ECL and some of its variants are also used in VLSI circuit design. Applications include very-high-speed processors such as those used in supercomputers, as well as high-speed and high-frequency communication systems. When employed in VLSI design, current-source biasing is almost always utilized. Further, a variety of circuit configurations are employed (see Rabaey, 1996).

## 15.5 BiCMOS Digital Circuits

In this section, we provide an introduction to a VLSI circuit technology that is becoming increasingly popular, BiCMOS. As its name implies, BiCMOS technology combines bipolar and CMOS circuits on one IC chip. The aim is to combine the low-power, high-input impedance and wide noise margins of CMOS with the high current-driving capability of bipolar transistors. Specifically, CMOS, although a nearly ideal logic-circuit technology in many respects, has a limited current-driving capability. This is not a serious problem when the CMOS gate has to drive a few other CMOS gates. It becomes a serious issue, however, when relatively large capacitive loads (e.g., greater than 0.5 pF or so) are present. In such cases, one has to either resort to the use of elaborate CMOS buffer circuits or face the usually unacceptable consequence of long propagation delays. On the other hand, we know that by virtue of its much larger transconductance, the BJT is capable of large output currents. We have seen a practical illustration of that in the emitter-follower output stage of ECL.
Indeed, the high current-driving capability contributes to making ECL two to five times faster than CMOS (under equivalent conditions) - of course, at the expense of high power dissipation. In summary, then, BiCMOS seeks to combine the best of the CMOS and bipolar technologies to obtain a class of circuits that is particularly useful when output currents that are higher than possible with CMOS are needed. Furthermore, since BiCMOS technology is well suited for the implementation of high-performance analog circuits (see, e.g., Section 8.3), it makes possible the realization of both analog and digital functions on the same IC chip, making the "system on a chip" an attainable goal. The price paid is a more complex, and hence more expensive (than CMOS) processing technology.

# 15.5.1 The BiCMOS Inverter 

A variety of BiCMOS inverter circuits have been proposed and are in use. All of these are based on the use of $n p n$ transistors to increase the output current available from a CMOS inverter. This can be most simply achieved by cascading each of the $Q_{N}$ and $Q_{P}$ devices of the CMOS inverter with an npn transistor, as shown in Fig. 15.37(a). Observe that this circuit can be thought of as utilizing the pair of complementary composite MOS-BJT devices shown in Fig. 15.37(b). These composite devices ${ }^{9}$ retain the high input impedance of the MOS transistor while in effect multiplying its rather low $g_{m}$ by the $\beta$ of the BJT. It is also useful to observe that the output stage formed by $Q_{1}$ and $Q_{2}$ has what is known as the totem-pole configuration utilized by TTL. ${ }^{10}$

The circuit of Fig. 15.37(a) operates as follows: When $v_{I}$ is low, both $Q_{N}$ and $Q_{2}$ are off while $Q_{P}$ conducts and supplies $Q_{1}$ with base current, thus turning it on. Transistor $Q_{1}$ then provides a large output current to charge the load capacitance. The result is a very fast charging of the load capacitance and correspondingly a short low-to-high propagation delay, $t_{P L H}$. Transistor $Q_{1}$ turns off when $v_{O}$ reaches a value of about $V_{D D}-V_{B E 1}$, and thus the output high level is lower than $V_{D D}$, a disadvantage. When $v_{I}$ goes high, $Q_{P}$ and $Q_{1}$ turn off, and $Q_{N}$ turns on, providing its drain current into the base of $Q_{2}$. Transistor $Q_{2}$ then turns on and provides a large output current that quickly discharges the load capacitance. Here again the result is a short high-to-low propagation delay, $t_{P H L}$. On the negative side, $Q_{2}$ turns off when $v_{O}$ reaches a value of about $V_{B E 2}$, and thus the output low level is greater than zero, a disadvantage.

Thus, while the circuit of Fig. 15.37(a) features large output currents and short propagation delays, it has the disadvantage of reduced logic swing and, correspondingly, reduced noise margins. There is also another and perhaps more serious disadvantage, namely, the relatively long turn-off delays of $Q_{1}$ and $Q_{2}$ arising from the absence of circuit paths along which the base charge can be removed. This problem can be solved by adding a resistor between the base of each of $Q_{1}$ and $Q_{2}$ and ground, as shown in Fig. 15.37(c). Now when either $Q_{1}$ or $Q_{2}$ is turned off, its stored base charge is removed to ground through $R_{1}$ or $R_{2}$, respectively. Resistor $R_{2}$ provides an additional benefit: With $v_{I}$ high, and after $Q_{2}$ cuts off, $v_{O}$ continues to fall below $V_{B E 2}$, and the output node is pulled to ground through the series path of $Q_{N}$ and $R_{2}$. Thus $R_{2}$ functions as a pull-down resistor. The $Q_{N}-R_{2}$ path, however, is a high-impedance one with the result that pulling $v_{O}$ to ground is a rather slow process. Incorporating the resistor $R_{1}$, however, is disadvantageous from a static power-dissipation standpoint: When $v_{I}$ is low, a dc path exists between $V_{D D}$ and ground through the conducting $Q_{P}$ and $R_{1}$. Finally, it should

[^0]
[^0]:    ${ }^{9}$ It is interesting to note that these composite devices were proposed as early as 1969 (see Lin et al., 1969).
    ${ }^{10}$ Refer to the book's website for a description of the basic TTL logic-gate circuit and its totem-pole output stage.


Figure 15.37 Development of the BiCMOS inverter circuit. (a) The basic concept is to use an additional bipolar transistor to increase the output current drive of each of $Q_{N}$ and $Q_{P}$ of the CMOS inverter. (b) The circuit in (a) can be thought of as utilizing these composite devices. (c) To reduce the turn-off times of $Q_{1}$ and $Q_{2}$, "bleeder resistors" $R_{1}$ and $R_{2}$ are added. (d) Implementation of the circuit in (c) using NMOS transistors to realize the resistors. (e) An improved version of the circuit in (c) obtained by connecting the lower end of $R_{1}$ to the output node.
be noted that $R_{1}$ and $R_{2}$ take some of the drain currents of $Q_{P}$ and $Q_{N}$ away from the bases of $Q_{1}$ and $Q_{2}$ and thus slightly reduce the gate output current available to charge and discharge the load capacitance.

Figure 15.37(d) shows the way in which $R_{1}$ and $R_{2}$ are usually implemented. As indicated, NMOS devices $Q_{R 1}$ and $Q_{R 2}$ are used to realize $R_{1}$ and $R_{2}$. As an added innovation, these two transistors are made to conduct only when needed. Thus, $Q_{R 1}$ will conduct only when $v_{I}$ rises, at which time its drain current constitutes a reverse base current for $Q_{1}$, speeding up its turn-off. Similarly, $Q_{R 2}$ will conduct only when $v_{I}$ falls and $Q_{P}$ conducts, pulling the gate of $Q_{R 2}$ high. The drain current of $Q_{R 2}$ then constitutes a reverse base current for $Q_{2}$, speeding up its turn-off.

As a final circuit for the BiCMOS inverter, we show the so-called $R$-circuit in Fig. 15.37(e). This circuit differs from that in Fig. 15.37(c) in only one respect: Rather than returning $R_{1}$ to ground, we have connected $R_{1}$ to the output node of the inverter. This simple change has two benefits. First, the problem of static power dissipation is now solved. Second, $R_{1}$ now functions as a pull-up resistor, pulling the output node voltage up to $V_{D D}$ (through the conducting $Q_{P}$ ) after $Q_{1}$ has turned off. Thus, the $R$ circuit in Fig. 15.37(e) does in fact have output levels very close to $V_{D D}$ and ground.

As a final remark on the BiCMOS inverter, we note that the circuit is designed so that transistors $Q_{1}$ and $Q_{2}$ are never simultaneously conducting and neither is allowed to saturate. Unfortunately, sometimes the resistance of the collector region of the BJT in conjunction with large capacitive-charging currents causes saturation to occur. Specifically, at large output currents, the voltage developed across $r_{C}$ (which can be of the order of $100 \Omega$ ) can lower the voltage at the intrinsic collector terminal and cause the CBJ to become forward biased. As the reader will recall, saturation is a harmful effect for two reasons: It limits the collector current to a value less than $\beta I_{B}$, and it slows down the transistor turn-off.

Figure 3.10 (a) A $p n$ junction with the terminals open-circuited. (b) Carrier concentrations; note that $N_{A}>N_{D}$. (c) The charge stored in both sides of the depletion region; $Q_{J}=\left|Q_{+}\right|=\left|Q_{-}\right|$. (d) The built-in voltage $V_{0}$.
In Fig. 3.10(a) we show a junction in which $N_{A}>N_{D}$, a typical situation in practice. This is borne out by the carrier concentration on both sides of the junction, as shown in Fig. 3.10(b). Note that we have denoted the minority-carrier concentrations in both sides by $n_{p 0}$ and $p_{a 0}$, with the additional subscript " 0 " signifying equilibrium (i.e., before external voltages are applied, as will be seen in the next section). Observe that the depletion region extends in both the $p$ and $n$ materials and that equal amounts of charge exist on both sides ( $Q_{+}$and $Q_{-}$ in Fig. 3.10c). However, since usually unequal dopings $N_{A}$ and $N_{D}$ are used, as in the case illustrated in Fig. 3.10, the width of the depletion layer will not be the same on the two sides. Rather, to uncover the same amount of charge, the depletion layer will extend deeper into the more lightly doped material. Specifically, if we denote the width of the depletion region in the $p$ side by $x_{p}$ and in the $n$ side by $x_{n}$, we can express the magnitude of the charge on the $n$ side of the junction as

$$
\left|Q_{+}\right|=q A x_{n} N_{D}
$$

and that on the $p$ side of the junction as

$$
\left|Q_{-}\right|=q A x_{p} N_{A}
$$

where $A$ is the cross-sectional area of the junction in the plane perpendicular to the page. The charge equality condition can now be written as

$$
q A x_{n} N_{D}=q A x_{p} N_{A}
$$

which can be rearranged to yield

$$
\frac{x_{n}}{x_{p}}=\frac{N_{A}}{N_{D}}
$$

In actual practice, it is usual for one side of the junction to be much more heavily doped than the other, with the result that the depletion region exists almost entirely on one side (the lightly doped side).

The width $W$ of the depletion layer can be shown to be given by

$$
W=x_{n}+x_{p}=\sqrt{\frac{2 \epsilon_{s}}{q}\left(\frac{1}{N_{A}}+\frac{1}{N_{D}}\right) V_{0}}
$$

where $\epsilon_{s}$ is the electrical permittivity of silicon $=11.7 \epsilon_{0}=11.7 \times 8.85 \times 10^{-14} \mathrm{~F} / \mathrm{cm}=1.04 \times$ $10^{-12} \mathrm{~F} / \mathrm{cm}$. Typically $W$ is in the range $0.1 \mu \mathrm{~m}$ to $1 \mu \mathrm{~m}$. Eqs. (3.25) and (3.26) can be used to obtain $x_{n}$ and $x_{p}$ in terms of $W$ as

$$
\begin{aligned}
& x_{n}=W \frac{N_{A}}{N_{A}+N_{D}} \\
& x_{p}=W \frac{N_{D}}{N_{A}+N_{D}}
\end{aligned}
$$

The charge stored on either side of the depletion region can be expressed in terms of $W$ by utilizing Eqs. (3.23) and (3.27) to obtain

$$
\begin{aligned}
& Q_{J}=\left|Q_{+}\right|=\left|Q_{-}\right| \\
& Q_{J}=A q\left(\frac{N_{A} N_{D}}{N_{A}+N_{D}}\right) W
\end{aligned}
$$

Finally, we can substitute for $W$ from Eq. (3.26) to obtain

$$
Q_{J}=A \sqrt{2 \epsilon_{s} q\left(\frac{N_{A} N_{D}}{N_{A}+N_{D}}\right) V_{0}}
$$

These expressions for $Q_{J}$ will prove useful in subsequent sections.
# Example 3.5 

Consider a $p n$ junction in equilibrium at room temperature ( $T=300 \mathrm{~K}$ ) for which the doping concentrations are $N_{A}=10^{18} / \mathrm{cm}^{3}$ and $N_{D}=10^{16} / \mathrm{cm}^{3}$ and the cross-sectional area $A=10^{-4} \mathrm{~cm}^{2}$. Calculate $p_{p}, n_{p 0}, n_{u}, p_{u 0}, V_{0}, W, x_{u}, x_{p}$, and $Q_{J}$. Use $n_{t}=1.5 \times 10^{10} / \mathrm{cm}^{3}$.

## Solution

$$
\begin{aligned}
p_{p} & \simeq N_{A}=10^{18} \mathrm{~cm}^{-3} \\
n_{p 0} & =\frac{n_{t}^{2}}{p_{p}} \simeq \frac{n_{t}^{2}}{N_{A}}=\frac{\left(1.5 \times 10^{10}\right)^{2}}{10^{18}}=2.25 \times 10^{2} \mathrm{~cm}^{-3} \\
n_{u} & \simeq N_{D}=10^{16} \mathrm{~cm}^{-3} \\
p_{u 0} & =\frac{n_{t}^{2}}{n_{u}} \simeq \frac{n_{t}^{2}}{N_{D}}=\frac{\left(1.5 \times 10^{10}\right)^{2}}{10^{16}}=2.25 \times 10^{4} \mathrm{~cm}^{-3}
\end{aligned}
$$

To find $V_{0}$ we use Eq. (3.22),

$$
V_{O}=V_{T} \ln \left(\frac{N_{A} N_{D}}{n_{t}^{2}}\right)
$$

where

$$
\begin{aligned}
V_{T} & =\frac{k T}{q}=\frac{8.62 \times 10^{-5} \times 300(\mathrm{eV})}{q} \\
& =25.9 \times 10^{-3} \mathrm{~V}
\end{aligned}
$$

Thus,

$$
\begin{aligned}
V_{0} & =25.9 \times 10^{-3} \ln \left(\frac{10^{18} \times 10^{16}}{2.25 \times 10^{20}}\right) \\
& =0.814 \mathrm{~V}
\end{aligned}
$$

To determine $W$ we use Eq. (3.26):

$$
\begin{aligned}
W & =\sqrt{\frac{2 \times 1.04 \times 10^{-12}}{1.6 \times 10^{-19}}\left(\frac{1}{10^{18}}+\frac{1}{10^{16}}\right) \times 0.814} \\
& =3.27 \times 10^{-5} \mathrm{~cm}=0.327 \mu \mathrm{~m}
\end{aligned}
$$

To determine $x_{u}$ and $x_{p}$ we use Eqs. (3.27) and (3.28), respectively:

$$
\begin{aligned}
x_{u} & =W \frac{N_{A}}{N_{A}+N_{D}} \\
& =0.327 \frac{10^{18}}{10^{18}+10^{16}}=0.324 \mu \mathrm{~m} \\
x_{p} & =W \frac{N_{D}}{N_{A}+N_{D}} \\
& =0.327 \frac{10^{16}}{10^{18}+10^{16}}=0.003 \mu \mathrm{~m}
\end{aligned}
$$

Finally, to determine the charge stored on either side of the depletion region, we use Eq. (3.29):

$$
\begin{aligned}
Q_{J} & =10^{-4} \times 1.6 \times 10^{-19}\left(\frac{10^{18} \times 10^{16}}{10^{18}+10^{16}}\right) \times 0.327 \times 10^{-4} \\
& =5.18 \times 10^{-12} \mathrm{C}=5.18 \mathrm{pC}
\end{aligned}
$$
# EXERCISES 

3.7 Show that

$$
V_{0}=\frac{1}{2}\left(\frac{q}{\varepsilon_{s}}\right)\left(\frac{N_{A} N_{D}}{N_{A}+N_{D}}\right) W^{2}
$$

3.8 Show that for a $p n$ junction in which the $p$ side is much more heavily doped than the $n$ side (i.e., $N_{A} \gg N_{D}$ ), referred to as a $p^{+} n$ diode, Eqs. (3.26), (3.27), (3.28), (3.29), and (3.30) can be simplified as follows:

$$
\begin{aligned}
W & \simeq \sqrt{\frac{2 \epsilon_{s}}{q N_{D}} V_{0}} \\
x_{n} & \simeq W \\
x_{p} & \simeq W /\left(N_{A} / N_{D}\right) \\
Q_{J} & \simeq A q N_{D} W \\
Q_{J} & \simeq A \sqrt{2 \epsilon_{s} q N_{D} V_{0}}
\end{aligned}
$$

3.9 If in the fabrication of the $p n$ junction in Example 3.5, it is required to increase the minority-carrier concentration in the $n$ region by a factor of 2 , what must be done?
Ans. Lower $N_{D}$ by a factor of 2 .

### 3.5 The pn Junction with an Applied Voltage

Having studied the open-circuited $p n$ junction in detail, we are now ready to apply a dc voltage between its two terminals to find its electrical conduction properties. If the voltage is applied so that the $p$ side is made more positive than the $n$ side, it is referred to as a forward-bias ${ }^{6}$ voltage. Conversely, if our applied dc voltage is such that it makes the $n$ side more positive than the $p$ side, it is said to be a reverse-bias voltage. As will be seen, the $p n$ junction exhibits vastly different conduction properties in its forward and reverse directions.

Our plan is as follows. We begin by a simple qualitative description in Section 3.5.1 and then consider an analytical description of the $i-v$ characteristic of the junction in Section 3.5.2.

### 3.5.1 Qualitative Description of Junction Operation

Figure 3.11 shows the $p n$ junction under three different conditions: (a) the open-circuit or equilibrium condition studied in the previous section; (b) the reverse-bias condition, where a dc voltage $V_{R}$ is applied; and (c) the forward-bias condition, where a dc voltage $V_{F}$ is applied.

[^0]
[^0]:    ${ }^{6}$ For the time being, we take the term bias to refer simply to the application of a dc voltage. We will see in later chapters that it has a deeper meaning in the design of electronic circuits.


Figure 3.11 The $p n$ junction in: (a) equilibrium; (b) reverse bias; (c) forward bias.
Observe that in the open-circuit case, a barrier voltage $V_{0}$ develops, making $n$ more positive than $p$, and limiting the diffusion current $I_{D}$ to a value exactly equal to the drift current $I_{S}$, thus resulting in a zero current at the junction terminals, as should be the case, since the terminals are open-circuited. Also, as mentioned previously, the barrier voltage $V_{0}$, though it establishes the current equilibrium across the junction, does not in fact appear between the junction terminals.

Consider now the reverse-bias case in (b). The externally applied reverse-bias voltage $V_{R}$ is in the direction to add to the barrier voltage, and it does, thus increasing the effective barrier voltage to $\left(V_{0}+V_{R}\right)$ as shown. This reduces the number of holes that diffuse into the $n$ region and the number of electrons that diffuse into the $p$ region. The end result is that the diffusion current $I_{D}$ is dramatically reduced. As will be seen shortly, a reverse-bias voltage of a volt or so is sufficient to cause $I_{D} \simeq 0$, and the current across the junction and through the external circuit will be equal to $I_{S}$. Recalling that $I_{S}$ is the current due to the drift across the depletion region of the thermally generated minority carriers, we expect $I_{S}$ to be very small and to be strongly dependent on temperature. We will show this to be the case very shortly. We thus conclude that in the reverse direction, the $p n$ junction conducts a very small and almost-constant current equal to $I_{S}$.

Before leaving the reverse-bias case, observe that the increase in barrier voltage will be accompanied by a corresponding increase in the stored uncovered charge on both sides of the depletion region. This in turn means a wider depletion region, needed to uncover the additional charge required to support the larger barrier voltage $\left(V_{0}+V_{R}\right)$. Analytically, these results can be obtained easily by a simple extension of the results of the equilibrium case. Thus the width of the depletion region can be obtained by replacing $V_{0}$ in Eq. (3.26) by $\left(V_{0}+V_{R}\right)$,

$$
W=x_{n}+x_{p}=\sqrt{\frac{2 \epsilon_{s}}{q}\left(\frac{1}{N_{A}}+\frac{1}{N_{D}}\right)\left(V_{0}+V_{R}\right)}
$$

and the magnitude of the charge stored on either side of the depletion region can be determined by replacing $V_{0}$ in Eq. (3.30) by $\left(V_{0}+V_{R}\right)$,

$$
Q_{J}=A \sqrt{2 \epsilon_{s} q\left(\frac{N_{A} N_{D}}{N_{A}+N_{D}}\right)\left(V_{0}+V_{R}\right)}
$$

We next consider the forward-bias case shown in Fig. 3.11(c). Here the applied voltage $V_{F}$ is in the direction that subtracts from the built-in voltage $V_{0}$, resulting in a reduced barrier voltage $\left(V_{0}-V_{F}\right)$ across the depletion region. This reduced barrier voltage will be accompanied by reduced depletion-region charge and correspondingly narrower depletion-region width $W$. Most importantly, the lowering of the barrier voltage will enable more holes to diffuse from $p$ to $n$ and more electrons to diffuse from $n$ to $p$. Thus the diffusion current $I_{D}$ increases substantially and, as will be seen shortly, can become many orders of magnitude larger than the drift current $I_{S}$. The current $I$ in the external circuit is of course the difference between $I_{D}$ and $I_{S}$,

$$
I=I_{D}-I_{S}
$$

and it flows in the forward direction of the junction, from $p$ to $n$. We thus conclude that the $p n$ junction can conduct a substantial current in the forward-bias region and that current is mostly a diffusion current whose value is determined by the forward-bias voltage $V_{F}$.
# 3.5.2 The Current-Voltage Relationship of the Junction 

We are now ready to find an analytical expression that describes the current-voltage relationship of the $p n$ junction. In the following we consider a junction operating with a forward applied voltage $V$ and derive an expression for the current $I$ that flows in the forward direction (from $p$ to $n$ ). However, our derivation is general and will be seen to yield the reverse current when the applied voltage $V$ is made negative.

From the qualitative description above we know that a forward-bias voltage $V$ subtracts from the built-in voltage $V_{0}$, thus resulting in a lower barrier voltage $\left(V_{0}-V\right)$. The lowered barrier in turn makes it possible for a greater number of holes to overcome the barrier and diffuse into the $n$ region. A similar statement can be made about electrons from the $n$ region diffusing into the $p$ region.

Let us now consider the holes injected into the $n$ region. The concentration of holes in the $n$ region at the edge of the depletion region will increase considerably. In fact, an important result from device physics shows that the steady-state concentration at the edge of the depletion region will be

$$
p_{n}\left(x_{n}\right)=p_{n 0} e^{V / V_{T}}
$$

That is, the concentration of the minority holes increases from the equilibrium value of $p_{n 0}$ (see Fig. 3.10) to the much larger value determined by the value of $V$, given by Eq. (3.33).

We describe this situation as follows: The forward-bias voltage $V$ results in an excess concentration of minority holes at $x=x_{n}$, given by

$$
\begin{aligned}
\text { Excess concentration } & =p_{n 0} e^{V / V_{T}}-p_{n 0} \\
& =p_{n 0}\left(e^{V / V_{T}}-1\right)
\end{aligned}
$$

The increase in minority-carrier concentration in Eqs. (3.33) and (3.34) occurs at the edge of the depletion region $\left(x=x_{n}\right)$. As the injected holes diffuse into the $n$ material, some will recombine with the majority electrons and disappear. Thus, the excess hole concentration will decay exponentially with distance. As a result, the total hole concentration in the $n$ material will be given by

$$
p_{n}(x)=p_{n 0}+(\text { Excess concentration }) e^{-\left(x-x_{n}\right) / d_{T}}
$$

Substituting for the "Excess concentration" from Eq. (3.34) gives

$$
p_{n}(x)=p_{n 0}+p_{n 0}\left(e^{V / V_{T}}-1\right) e^{-\left(x-x_{n}\right) / d_{T}}
$$

The exponential decay is characterized by the constant $L_{p}$, which is called the diffusion length of holes in the $n$ material. The smaller the value of $L_{p}$, the faster the injected holes will recombine with the majority electrons, resulting in a steeper decay of minority-carrier concentration.

Figure 3.12 shows the steady-state minority-carrier concentration profiles on both sides of a $p n$ junction in which $N_{A} \gg N_{D}$. Let's stay a little longer with the diffusion of holes into the $n$ region. Note that the shaded region under the exponential represents the excess minority carriers (holes). From our study of diffusion in Section 3.3, we know that the establishment of a carrier concentration profile such as that in Fig. 3.12 is essential to support a steady-state diffusion current. In fact, we can now find the value of the hole-diffusion current density by applying Eq. (3.19),

$$
J_{p}(x)=-q D_{p} \frac{d p_{n}(x)}{d x}
$$


Figure 3.12 Minority-carrier distribution in a forward-biased $p n$ junction. It is assumed that the $p$ region is more heavily doped than the $n$ region; $N_{A} \gg N_{D}$.

Substituting for $p_{n}(x)$ from Eq. (3.35) gives

$$
J_{p}(x)=q\left(\frac{D_{p}}{L_{p}}\right) p_{n 0}\left(e^{3 / 4_{T}}-1\right) e^{-\left(x-x_{n}\right) / L_{p}}
$$

As expected, $J_{p}(x)$ is highest at $x=x_{n}$,

$$
J_{p}\left(x_{n}\right)=q\left(\frac{D_{p}}{L_{p}}\right) p_{n 0}\left(e^{3 / 4_{T}}-1\right)
$$

and decays exponentially for $x>x_{n}$, as the minority holes recombine with the majority electrons. This recombination, however, means that the majority electrons will have to be replenished by a current that injects electrons from the external circuit into the $n$ region of the junction. This latter current component has the same direction as the hole current (because electrons moving from right to left give rise to current in the direction from left to right). It follows that as $J_{p}(x)$ decreases, the electron current component increases by exactly the same amount, making the total current in the $n$ material constant at the value given by Eq. (3.37).

An exactly parallel development can be applied to the electrons that are injected from the $n$ to the $p$ region, resulting in an electron diffusion current given by a simple adaptation of Eq. (3.37),

$$
J_{n}\left(-x_{p}\right)=q\left(\frac{D_{n}}{L_{n}}\right) n_{p 0}\left(e^{3 / 4_{T}}-1\right)
$$

Now, although the currents in Eqs. (3.37) and (3.38) are found at the two edges of the depletion region, their values do not change in the depletion region. Thus we can drop the location descriptors $\left(x_{n}\right),\left(-x_{p}\right)$, add the two current densities, and multiply by the junction area $A$ to
obtain the total current $I$ as

$$
\begin{aligned}
& I=A\left(J_{p}+J_{n}\right) \\
& I=A q\left(\frac{D_{p}}{L_{p}} p_{n 0}+\frac{D_{n}}{L_{n}} n_{p 0}\right)\left(e^{V / V_{T}}-1\right)
\end{aligned}
$$

Substituting for $p_{n 0}=n_{i}^{2} / N_{D}$ and for $n_{p 0}=n_{i}^{2} / N_{A}$ gives

$$
I=A q n_{i}^{2}\left(\frac{D_{p}}{L_{p} N_{D}}+\frac{D_{n}}{L_{n} N_{A}}\right)\left(e^{V / V_{T}}-1\right)
$$

From this equation we note that for a negative $V$ (reverse bias) with a magnitude of a few times $V_{T}(25.9 \mathrm{mV})$, the exponential term becomes essentially zero, and the current across the junction becomes negative and constant. From our qualitative description in Section 3.5.1, we know that this current must be $I_{S}$. Thus,

$$
I=I_{S}\left(e^{V / V_{T}}-1\right)
$$

where

$$
I_{S}=A q n_{i}^{2}\left(\frac{D_{p}}{L_{p} N_{D}}+\frac{D_{n}}{L_{n} N_{A}}\right)
$$

Figure 3.13 shows the $I-V$ characteristic of the $p n$ junction (Eq. 3.40). Observe that in the reverse direction the current saturates at a value equal to $-I_{S}$. For this reason, $I_{S}$ is given the name saturation current. From Eq. (3.41) we see that $I_{S}$ is directly proportional to the cross-sectional area $A$ of the junction. Thus, another name for $I_{S}$, one we prefer to use in this book, is the junction scale current. Typical values for $I_{S}$, for junctions of various areas, range from $10^{-18} \mathrm{~A}$ to $10^{-12} \mathrm{~A}$.

Besides being proportional to the junction area $A$, the expression for $I_{S}$ in Eq. (3.41) indicates that $I_{S}$ is proportional to $n_{i}^{2}$, which is a very strong function of temperature (see Eq. 3.2).


Figure 3.13 The $p n$ junction $I-V$ characteristic.
# Example 3.6 

For the $p n$ junction considered in Example 3.5 for which $N_{A}=10^{18} / \mathrm{cm}^{3}, N_{D}=10^{16} / \mathrm{cm}^{3}, A=10^{-4} \mathrm{~cm}^{2}$, and $n_{i}=1.5 \times 10^{10} / \mathrm{cm}^{3}$, let $L_{p}=5 \mu \mathrm{~m}, L_{n}=10 \mu \mathrm{~m}, D_{p}$ (in the $n$ region) $=10 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$, and $D_{n}$ (in the $p$ region) $=18 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$. The $p n$ junction is forward biased and conducting a current $I=0.1 \mathrm{~mA}$. Calculate: (a) $I_{S}$; (b) the forward-bias voltage $V$; and (c) the component of the current $I$ due to hole injection and that due to electron injection across the junction.

## Solution

(a) Using Eq. (3.41), we find $I_{S}$ as

$$
\begin{aligned}
I_{S}= & 10^{-4} \times 1.6 \times 10^{-19} \times\left(1.5 \times 10^{16}\right)^{2} \\
& \times\left(\frac{10}{5 \times 10^{-4} \times 10^{16}}+\frac{18}{10 \times 10^{-4} \times 10^{18}}\right) \\
= & 7.3 \times 10^{-15} \mathrm{~A}
\end{aligned}
$$

(b) In the forward direction,

$$
\begin{aligned}
I & =I_{S}\left(e^{V / V_{T}}-1\right) \\
& \simeq I_{S} e^{V / V_{T}}
\end{aligned}
$$

Thus,

$$
V=V_{T} \ln \left(\frac{I}{I_{S}}\right)
$$

For $I=0.1 \mathrm{~mA}$,

$$
\begin{aligned}
V & =25.9 \times 10^{-3} \ln \left(\frac{0.1 \times 10^{-3}}{7.3 \times 10^{-15}}\right) \\
& =0.605 \mathrm{~V}
\end{aligned}
$$

(c) The hole-injection component of $I$ can be found using Eq. (3.37)

$$
\begin{aligned}
I_{p} & =A q \frac{D_{p}}{L_{p}} p_{a 0}\left(e^{V / V_{T}}-1\right) \\
& =A q \frac{D_{p}}{L_{p}} \frac{n_{i}^{2}}{N_{D}}\left(e^{V / V_{T}}-1\right)
\end{aligned}
$$

Similarly, $I_{n}$ can be found using Eq. (3.39),

$$
I_{n}=A q \frac{D_{n}}{L_{n}} \frac{n_{i}^{2}}{N_{A}}\left(e^{V / V_{T}}-1\right)
$$

Thus,

$$
\frac{I_{p}}{I_{n}}=\left(\frac{D_{p}}{D_{n}}\right)\left(\frac{L_{n}}{L_{p}}\right)\left(\frac{N_{A}}{N_{D}}\right)
$$

For our case,

$$
\frac{I_{p}}{I_{n}}=\frac{10}{18} \times \frac{10}{5} \times \frac{10^{18}}{10^{16}}=1.11 \times 10^{2}=111
$$

Figure 15.37 continued

# 15.5.2 Dynamic Operation 

A detailed analysis of the dynamic operation of the BiCMOS inverter circuit is a rather complex undertaking. Nevertheless, an estimate of its propagation delay can be obtained by considering only the time required to charge and discharge a load capacitance $C$. Such an approximation is justified when $C$ is relatively large and thus its effect on inverter dynamics is dominant: in other words, when we are able to neglect the time required to charge the parasitic capacitances present at internal circuit nodes. Fortunately, this is usually the case in practice, for if the load capacitance is not large, one would use the simpler CMOS inverter. In fact, it has been shown (Embabi, Bellaouar, and Elmasry, 1993) that the speed advantage of Bi-CMOS (over CMOS) becomes evident only when the gate is required to drive a large fan-out or a large load capacitance. For instance, at a load capacitance of 50 fF to 100 fF , BiCMOS and CMOS typically feature equal delays. However, at a load capacitance of $1 \mathrm{pF}, t_{p}$ of a BiCMOS inverter is 0.3 ns , whereas that of an otherwise comparable CMOS inverter is about 1 ns .

Finally, in Fig. 15.38, we show simplified equivalent circuits that can be employed in obtaining rough estimates of $t_{P L H}$ and $t_{P H L}$ of the $R$-type BiCMOS inverter (see Problem 15.49).

### 15.5.3 BiCMOS Logic Gates

In BiCMOS, the logic is performed by the CMOS part of the gate, with the bipolar portion simply functioning as an output stage. It follows that BiCMOS logic-gate circuits can be generated following the same approach used in CMOS. As an example, we show in Fig. 15.39 a BiCMOS two-input NAND gate.

As a final remark, we note that BiCMOS technology is applied in a variety of products including microprocessors, static RAMs, and gate arrays (see Alvarez, 1993).


Figure 15.38 Equivalent circuits for charging and discharging a load capacitance $C$. Note that $C$ includes all the capacitances present at the output node.


Figure 15.39 A BiCMOS two-input NAND gate.

# EXERCISE 

D15.17 The threshold voltage of the BiCMOS inverter of Fig. 15.37(e) is the value of $v_{I}$ at which both $Q_{N}$ and $Q_{P}$ are conducting equal currents and operating in the saturation region. At this value of $v_{I}, Q_{2}$ will be on, causing the voltage at the source of $Q_{N}$ to be approximately 0.7 V . It is required to design the circuit so that the threshold voltage is equal to $V_{D D} / 2$. For $V_{D D}=5 \mathrm{~V},\left|V_{t}\right|=0.6 \mathrm{~V}$, and assuming equal channel lengths for $Q_{N}$ and $Q_{P}$ and that $\mu_{n} \simeq 2.5 \mu_{p}$, find the required ratio of widths, $W_{p} / W_{n}$. Ans. 1
## Section 15.4: Emitter-Coupled Logic (ECL)

D 15.34 For the ECL circuit in Fig. P15.34, the transistors exhibit $V_{B E}$ of 0.75 V at an emitter current $I$ and have very high $\beta$.
(a) Find $V_{O H}$ and $V_{O L}$.
(b) For the input at $B$ that is sufficiently negative for $Q_{B}$ to be cut off, what voltage at $A$ causes a current of $I / 2$ to flow in $Q_{B}$ ?
(c) Repeat (b) for a current in $Q_{B}$ of $0.99 I$.
(d) Repeat (c) for a current in $Q_{B}$ of $0.01 I$.
(e) Use the results of (c) and (d) to specify $V_{I L}$ and $V_{I H}$.
(f) Find $N M_{H}$ and $N M_{L}$.
(g) Find the value of $I R$ that makes the noise margins equal to the width of the transition region, $V_{I H}-V_{I L}$.
(h) Using the $I R$ value obtained in (g), give numerical values for $V_{O H}, V_{O L}, V_{I H}, V_{I L}$, and $V_{R}$ for this ECL gate.
*15.35 Three logic inverters are connected in a ring. Specifications for this family of gates indicate a typical propagation delay of 3 ns for high-to-low output transitions and 7 ns for low-to-high transitions. Assume that for some reason the input to one of the gates undergoes a low-to-high transition. By sketching the waveforms at the outputs of the three gates and keeping track of their relative positions, show that the circuit functions as an oscillator. What is the frequency of oscillation of this ring oscillator? In each cycle, how long is the output high? low?
*15.36 Following the idea of a ring oscillator introduced in Problem 15.35, consider an implementation using a ring of five ECL 100K inverters. Assume that the inverters have linearly rising and falling edges (and thus the waveforms are trapezoidal in shape). Let the 0 to $100 \%$ rise and fall times be equal to 1 ns . Also, let the propagation delay (for both transitions) be equal to 1 ns . Provide a labeled sketch of the five output signals, taking care that relevant phase information is provided. What is the frequency of oscillation?

D*15.37 Using the logic and circuit flexibility of ECL indicated by Figs. 15.26 and 15.36, sketch an ECL logic circuit that realizes the exclusive OR function, $Y=\bar{A} B+A \bar{B}$. Give a logic diagram (as opposed to a circuit diagram).
*15.38 For the circuit in Fig. 15.28 whose transfer characteristic is shown in Fig. 15.29, calculate the incremental voltage gain from input to the OR output at points $x, m$, and $y$ of the transfer characteristic. Assume $\beta=100$. Use the results of Exercise 15.14, and let the output at $x$ be -1.77 V and that at $y$ be -0.88 V . (Hint: Recall that $x$ and $y$ are defined by a $1 \%$, $99 \%$ current split.)
15.39 For the circuit in Fig. 15.28 whose transfer characteristic is shown in Fig. 15.29, find $V_{I L}$ and $V_{I H}$ if $x$ and $y$ are defined as the points at which
(a) $90 \%$ of the current $I_{E}$ is switched.
(b) $99.9 \%$ of the current $I_{E}$ is switched.
15.40 For the symmetrically loaded circuit of Fig. 15.28 and for typical output signal levels $\left(V_{O H}=-0.88 \mathrm{~V}\right.$ and


Figure P15.34
$\left.V_{O L}=-1.77 \mathrm{~V}\right)$, calculate the power lost in both load resistors $R_{T}$ and both output followers. What then is the total power dissipation of a single ECL gate, including its symmetrical output terminations?
15.41 Considering the circuit of Fig. 15.30, what is the value of $\beta$ of $Q_{2}$, for which the high noise margin $\left(N M_{H}\right)$ is reduced by $50 \%$ ?
*15.42 Consider an ECL gate whose inverting output is terminated in a $50-\Omega$ resistance connected to a $-2-\mathrm{V}$ supply. Let the total load capacitance be denoted $C$. As the input of the gate rises, the output emitter follower cuts off and the load capacitance $C$ discharges through the $50-\Omega$ load (until the emitter follower conducts again). Find the value of $C$ that will result in a discharge time of 1 ns . Assume that the two output levels are -0.88 V and -1.77 V .
15.43 For signals whose rise and fall times are 3.5 ns , what length of unterminated gate-to-gate wire interconnect can be used if a ratio of rise time to return time of 5 to 1 is required? Assume the environment of the wire to be such that the signal propagates at two-thirds the speed of light (which is $30 \mathrm{~cm} / \mathrm{ns})$.
*15.44 For the circuit in Fig. P15.44, let the levels of the inputs $A, B, C$, and $D$ be 0 and +5 V . For all inputs low at 0 V , what is the voltage at $E$ ? If $A$ and $C$ are raised to +5 V , what is the voltage at $E$ ? Assume $\left|V_{B E}\right|=0.7 \mathrm{~V}$ and $\beta=50$. Express $E$ as a logic function of $A, B, C$, and $D$.


Figure P15.44

## Section 15.5: BiCMOS Digital Circuits

15.45 Consider the conceptual BiCMOS circuit of Fig. 15.37(a), for the conditions that $V_{D D}=5 \mathrm{~V},\left|V_{i}\right|=1 \mathrm{~V}$, $V_{B E}=0.7 \mathrm{~V}, \beta=100, k_{n}^{\prime}=2.5 k_{p}^{\prime}=100 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $(W L)_{n}=2 \mu \mathrm{~m} / 1 \mu \mathrm{~m}$. For $v_{I}=v_{O}=V_{D D} / 2$, find $(W L)_{p}$ so that $I_{E Q 1}=I_{E Q 2}$. What is this totem-pole transient current?
15.46 Consider the conceptual BiCMOS circuit of Fig. 15.37(a) for the conditions stated in Problem 15.45. What is the threshold voltage of the inverter if both $Q_{N}$ and $Q_{P}$ have $W L=2 \mu \mathrm{~m} / 1 \mu \mathrm{~m}$ ? What totem-pole current flows at $v_{I}$ equal to the threshold voltage?
D *15.47 Consider the choice of values for $R_{1}$ and $R_{2}$ in the circuit of Fig. 15.37(c). An important consideration in making this choice is that the loss of base drive current will be limited. This loss becomes particularly acute when the current through $Q_{N}$ and $Q_{P}$ becomes small. This in turn happens near the end of the output signal swing when the associated MOS device is deeply in triode operation (say at $\left|v_{D S}\right|=\left|V_{i}\right| / 3$ ). Determine values for $R_{1}$ and $R_{2}$ so that the loss in base current is limited to $50 \%$. What is the ratio $R_{1} / R_{2}$ ? Repeat for a $20 \%$ loss in base drive.
*15.48 For the circuit of Fig. 15.37(a) with parameters as in Problem 15.45 and with $(W L)_{p}=(W L)_{n}$, estimate the propagation delays $t_{P L H}, t_{P H L}$ and $t_{P}$ obtained for a load capacitance of 2 pF . Assume that the internal node capacitances do not contribute much to this result. Use average values for the charging and discharging currents.
*15.49 Repeat Problem 15.48 for the circuit in Fig. 15.37(e), assuming that $R_{1}=R_{2}=5 \mathrm{k} \Omega$.

D 15.50 Consider the dynamic response of the NAND gate of Fig. 15.39 with a large external capacitive load. If the worst-case response is to be identical to that of the inverter of Fig. 15.37(e), how must the $W L$ ratios of $Q_{N A}, Q_{N B}, Q_{N}, Q_{P A}$, $Q_{P B}$, and $Q_{P}$ be related?

D 15.51 Sketch the circuit of a BiCMOS two-input NOR gate. If, when loaded with a large capacitance, the gate is to have worst-case delays equal to the corresponding values of the inverter of Fig. 15.37(e), find $W L$ of each transistor in terms of $(W L)_{n}$ and $(W L)_{p}$.
# 18.9 Precision Rectifier Circuits 

Rectifier circuits were studied in Chapter 4, where the emphasis was on their application in power-supply design. In such applications, the voltages being rectified are usually much greater than the diode voltage drop, rendering the exact value of the diode drop unimportant to the proper operation of the rectifier. Other applications exist, however, where this is not the case. For instance, in instrumentation applications, the signal to be rectified can be of a very small amplitude, say 0.1 V , making it impossible to employ the conventional rectifier circuits. Also, in instrumentation applications, the need arises for rectifier circuits with very precise transfer characteristics.

Here we study circuits that combine diodes and op amps to implement a variety of rectifier circuits with precise characteristics. Precision rectifiers, which can be considered a special class of wave-shaping circuits, find application in the design of instrumentation systems. An introduction to precision rectifiers was presented in Section 4.5.5. This material, however, is repeated here for the reader's convenience.

### 18.9.1 Precision Half-Wave Rectifier: The "Superdiode"

Figure 18.35(a) shows a precision half-wave-rectifier circuit consisting of a diode placed in the negative-feedback path of an op amp, with $R$ being the rectifier load resistance. The circuit works as follows: If $v_{I}$ goes positive, the output voltage $v_{A}$ of the op amp will go positive and the diode will conduct, thus establishing a closed feedback path between the op amp's output terminal and the negative input terminal. This negative-feedback path will cause a virtual short circuit to appear between the two input terminals of the op amp. Thus the voltage at the negative input terminal, which is also the output voltage $v_{O}$, will equal (to within a few millivolts) that at the positive input terminal, which is the input voltage $v_{I}$,

$$
v_{O}=v_{I} \quad v_{I} \geq 0
$$

Note that the offset voltage ( $\simeq 0.5 \mathrm{~V}$ ) exhibited in the simple half-wave-rectifier circuit is no longer present. For the op-amp circuit to start operation, $v_{I}$ has to exceed only a negligibly small voltage equal to the diode drop divided by the op amp's open-loop gain. In other words, the straight-line transfer characteristic $v_{O}-v_{I}$ almost passes through the origin. This makes this circuit suitable for applications involving very small signals.

Consider now the case when $v_{I}$ goes negative. The op amp's output voltage $v_{A}$ will tend to follow and go negative. This will reverse-bias the diode, and no current will flow through resistance $R$, so that $v_{O}$ remains equal to 0 V . Thus for $v_{I}<0, v_{O}=0$. Since in this case the diode is off, the op amp will be operating in an open-loop fashion and its output will be at the negative saturation level.

The transfer characteristic of this circuit will be that shown in Fig. 18.35(b), which is almost identical to the ideal characteristic of a half-wave rectifier. The nonideal diode characteristics have been almost completely masked by placing the diode in the negative-feedback path of an op amp. This is another dramatic application of negative feedback. The combination of diode and op amp, shown in the dashed box in Fig. 18.35(a), is appropriately referred to as a "superdiode."

As usual, though, not all is well. The circuit of Fig. 18.35 has some disadvantages: When $v_{I}$ goes negative and $v_{O}=0$, the entire magnitude of $v_{I}$ appears between the two input terminals of the op amp. If this magnitude is greater than a few volts, the op amp may be damaged unless it is equipped with what is called "overvoltage protection" (a feature that most modern IC


Figure 18.35 (a) The "superdiode" precision half-wave rectifier; (b) its almost ideal transfer characteristic. Note that when $v_{l}>0$ and the diode conducts, the op amp supplies the load current, and the source is conveniently buffered, an added advantage.


Figure 18.36 (a) An improved version of the precision half-wave rectifier: Diode $D_{2}$ is included to keep the feedback loop closed around the op amp during the off times of the rectifier diode $D_{1}$, thus preventing the op amp from saturating. (b) The transfer characteristic for $R_{2}=R_{1}$.
op amps have). Another disadvantage is that when $v_{l}$ is negative, the op amp will be saturated. Although not harmful to the op amp, saturation should usually be avoided, since getting the op amp out of the saturation region and back into its linear region of operation requires some time. This time delay will obviously slow down circuit operation and limit the frequency of operation of the superdiode half-wave-rectifier circuit.

# 18.9.2 An Alternative Circuit 

An alternative precision rectifier circuit that does not suffer from the disadvantages mentioned above is shown in Fig. 18.36. The circuit operates in the following manner: For positive $v_{l}$, diode $D_{2}$ conducts and closes the negative-feedback loop around the op amp. A virtual ground therefore will appear at the inverting input terminal, and the op amp's output will be clamped at one diode drop below ground. This negative voltage will keep diode $D_{1}$ off, and no current will flow in the feedback resistance $R_{2}$. It follows that the rectifier output voltage will be zero.

As $v_{l}$ goes negative, the voltage at the inverting input terminal will tend to go negative, causing the voltage at the op amp's output terminal to go positive. This will cause $D_{2}$ to be
reverse-biased and hence to be cut off. Diode $D_{1}$, however, will conduct through $R_{2}$, thus establishing a negative-feedback path around the op amp and forcing a virtual ground to appear at the inverting input terminal. The current through the feedback resistance $R_{2}$ will be equal to the current through the input resistance $R_{1}$. Thus for $R_{1}=R_{2}$ the output voltage $v_{O}$ will be

$$
v_{O}=-v_{I} \quad v_{I} \leq 0
$$

The transfer characteristic of the circuit is shown in Fig. 18.36(b). Note that unlike the situation for the circuit shown in Fig. 18.35, here the slope of the characteristic can be set to any desired value, including unity, by selecting appropriate values for $R_{1}$ and $R_{2}$.

As mentioned before, the major advantage of the improved half-wave-rectifier circuit is that the feedback loop around the op amp remains closed at all times. Hence the op amp remains in its linear operating region, avoiding the possibility of saturation and the associated time delay required to "get out" of saturation. Diode $D_{2}$ "catches" the op-amp output voltage as it goes negative and clamps it to one diode drop below ground; hence $D_{2}$ is called a "catching diode."

# 18.9.3 An Application: Measuring AC Voltages 

As one of the many possible applications of the precision rectifier circuits discussed in this section, consider the basic ac voltmeter circuit shown in Fig. 18.37. The circuit consists of a half-wave rectifier-formed by op amp $\mathrm{A}_{1}$, diodes $D_{1}$ and $D_{2}$, and resistors $R_{1}$ and $R_{2}$-and a first-order low-pass filter-formed by op amp $\mathrm{A}_{2}$, resistors $R_{3}$ and $R_{4}$, and capacitor $C$. For an input sinusoid having a peak amplitude $V_{p}$ the output $v_{1}$ of the rectifier will consist of a half sine wave having a peak amplitude of $V_{p} R_{2} / R_{1}$. It can be shown using Fourier series analysis that the waveform of $v_{1}$ has an average value of $\left(V_{p} / \pi\right)\left(R_{2} / R_{1}\right)$ in addition to


Figure 18.37 A simple ac voltmeter consisting of a precision half-wave rectifier followed by a first-order low-pass filter.

## EXERCISES

18.27 Consider the operational rectifier or superdiode circuit of Fig. 18.35(a), with $R=1 \mathrm{k} \Omega$. For $v_{I}=10 \mathrm{mV}$, 1 V , and -1 V , what are the voltages that result at the rectifier output and at the output of the op amp?
Assume that the op amp is ideal and that its output saturates at $\pm 12 \mathrm{~V}$. The diode has a $0.7-\mathrm{V}$ drop at $1-\mathrm{mA}$ current, and the voltage drop changes by 0.1 V per decade of current change.
Ans. $10 \mathrm{mV}, 0.51 \mathrm{~V} ; 1 \mathrm{~V}, 1.7 \mathrm{~V} ; 0 \mathrm{~V},-12 \mathrm{~V}$
18.28 If the diode in the circuit of Fig. 18.35(a) is reversed, what is the transfer characteristic $v_{O}$ as a function of $v_{I}$ ?
Ans. $v_{O}=0$ for $v_{I} \geq 0 ; v_{O}=v_{I}$ for $v_{I} \leq 0$
18.29 Consider the circuit in Fig. 18.36(a) with $R_{1}=1 \mathrm{k} \Omega$ and $R_{2}=10 \mathrm{k} \Omega$. Find $v_{O}$ and the voltage at the amplifier output for $v_{I}=+1 \mathrm{~V},-10 \mathrm{mV}$, and -1 V . Assume the op amp to be ideal with saturation voltages of $\pm 12 \mathrm{~V}$. The diodes have $0.7-\mathrm{V}$ voltage drops at 1 mA , and the voltage drop changes by 0.1 V per decade of current change.

Ans. $0 \mathrm{~V},-0 . \mathrm{vm} 7 \mathrm{~V} ; 0.1 \mathrm{~V}, 0.6 \mathrm{~V} ; 10 \mathrm{~V}, 10.7 \mathrm{~V}$
18.30 If the diodes in the circuit of Fig. 18.36(a) are reversed, what is the transfer characteristic $v_{O}$ as a function of $v_{I}$ ?
Ans. $v_{O}=-\left(R_{2} / R_{1}\right) v_{I}$ for $v_{I} \geq 0 ; v_{O}=0$ for $v_{I} \leq 0$
18.31 Find the transfer characteristic for the circuit in Fig. E18.31.


Figure E18.31
Ans. $v_{O}=0$ for $v_{I} \geq-5 \mathrm{~V} ; v_{O}=-v_{I}-5$ for $v_{I} \leq-5 \mathrm{~V}$
harmonics of the frequency $\omega$ of the input signal. To reduce the amplitudes of all these harmonics to negligible levels, the corner frequency of the low-pass filter should be chosen to be much smaller than the lowest expected frequency $\omega_{\min }$ of the input sine wave. This leads to

$$
\frac{1}{C R_{4}} \ll \omega_{\min }
$$

Then the output voltage $v_{2}$ will be mostly dc, with a value

$$
V_{2}=-\frac{V_{p}}{\pi} \frac{R_{2}}{R_{1}} \frac{R_{4}}{R_{3}}
$$

where $R_{4} / R_{3}$ is the dc gain of the low-pass filter. Note that this voltmeter essentially measures the average value of the negative parts of the input signal but can be calibrated to provide rms readings for input sinusoids.
# 18.9.4 Precision Full-Wave Rectifier 

We now derive a circuit for a precision full-wave rectifier. From Chapter 4 we know that full-wave rectification is achieved by inverting the negative halves of the input-signal waveform and applying the resulting signal to another diode rectifier. The outputs of the two rectifiers are then joined to a common load. Such an arrangement is depicted in Fig. 18.38, which also shows the waveforms at various nodes. Now replacing diode $D_{\mathrm{A}}$ with a superdiode, and replacing diode $D_{\mathrm{B}}$ and the inverting amplifier with the inverting precision half-wave rectifier of Fig. 18.36 but without the catching diode, we obtain the precision full-wave-rectifier circuit of Fig. 18.39(a).

To see how the circuit of Fig. 18.39(a) operates, consider first the case of positive input at A. The output of $\mathrm{A}_{2}$ will go positive, turning $D_{2}$ on, which will conduct through $R_{L}$ and thus close the feedback loop around $\mathrm{A}_{2}$. A virtual short circuit will thus be established between the two input terminals of $\mathrm{A}_{2}$, and the voltage at the negative-input terminal, which is the output voltage of the circuit, will become equal to the input. Thus no current will flow through $R_{1}$ and $R_{2}$, and the voltage at the inverting input of $\mathrm{A}_{1}$ will be equal to the input and hence positive. Therefore the output terminal $(\mathrm{F})$ of $\mathrm{A}_{1}$ will go negative until $\mathrm{A}_{1}$ saturates. This causes $D_{1}$ to be turned off.

Next consider what happens when A goes negative. The tendency for a negative voltage at the negative input of $\mathrm{A}_{1}$ causes F to rise, making $D_{1}$ conduct to supply $R_{L}$ and allowing the feedback loop around $\mathrm{A}_{1}$ to be closed. Thus a virtual ground appears at the negative input of $\mathrm{A}_{1}$, and the two equal resistances $R_{1}$ and $R_{2}$ force the voltage at C , which is the output

## EXERCISES

18.32 In the full-wave rectifier circuit of Fig. 18.39(a), let $R_{1}=R_{2}=R_{L}=10 \mathrm{k} \Omega$ and assume the op amps to be ideal except for output saturation at $\pm 12 \mathrm{~V}$. When conducting a current of 1 mA , each diode exhibits a voltage drop of 0.7 V , and this voltage changes by 0.1 V per decade of current change. Find $v_{O}, v_{E}$, and $v_{F}$ corresponding to $v_{I}=+0.1 \mathrm{~V},+1 \mathrm{~V},+10 \mathrm{~V},-0.1 \mathrm{~V}$, and -10 V .
Ans. $+0.1 \mathrm{~V},+0.6 \mathrm{~V},-12 \mathrm{~V} ;+1 \mathrm{~V},+1.6 \mathrm{~V},-12 \mathrm{~V} ;+10 \mathrm{~V},+10.7 \mathrm{~V},-12 \mathrm{~V} ;+0.1 \mathrm{~V},-12 \mathrm{~V},+$ $0.63 \mathrm{~V} ;+1 \mathrm{~V},-12 \mathrm{~V},+1.63 \mathrm{~V} ;+10 \mathrm{~V},-12 \mathrm{~V},+10.73 \mathrm{~V}$


Figure 18.38 Principle of full-wave rectification.
D18.33 The block diagram shown in Fig. E18.33(a) gives another possible arrangement for implementing the absolute-value or full-wave-rectifier operation depicted symbolically in Fig. E18.33(b). The block diagram consists of two boxes: a half-wave rectifier, which can be implemented by the circuit in Fig. 18.36(a) after reversing both diodes, and a weighted inverting summer. Convince yourself that this block diagram does in fact realize the absolute-value operation. Then draw a complete circuit diagram, giving reasonable values for all resistors.


Figure E18.33
voltage, to be equal to the negative of the input voltage at A and thus positive. The combination of positive voltage at C and negative voltage at A causes the output of $\mathrm{A}_{2}$ to saturate in the negative direction, thus keeping $D_{2}$ off.

The overall result is perfect full-wave rectification, as represented by the transfer characteristic in Fig. 18.39(b). This precision is, of course, a result of placing the diodes in op-amp feedback loops, thus masking their nonidealities. This circuit is one of many possible precision full-wave-rectifier or absolute-value circuits. Another related implementation of this function is examined in Exercise 18.33.


Figure 18.39 (a) Precision full-wave rectifier based on the conceptual circuit of Fig. 18.38. (b) Transfer characteristic of the circuit in (a).

Figure 18.40 Use of the diode bridge in the design of an ac voltmeter.

# 18.9.5 A Precision Bridge Rectifier for Instrumentation Applications 

The bridge rectifier circuit studied in Section 4.5.3 can be combined with an op amp to provide useful precision circuits. One such arrangement is shown in Fig. 18.40. This circuit causes a current equal to $\left|v_{A}\right| / R$ to flow through the moving-coil meter M . Thus the meter provides a reading that is proportional to the average of the absolute value of the input voltage $v_{A}$. All the nonidealities of the meter and of the diodes are masked by placing the bridge circuit in the negative-feedback loop of the op amp. Observe that when $v_{A}$ is positive, current flows from the op-amp output through $D_{1}, \mathrm{M}, D_{3}$, and $R$. When $v_{A}$ is negative, current flows into the op-amp output through $R, D_{2}, \mathrm{M}$, and $D_{4}$. Thus the feedback loop remains closed for both polarities of $v_{A}$. The resulting virtual short circuit at the input terminals of the op amp causes a replica of $v_{A}$ to appear across $R$. The circuit of Fig. 18.40 provides a relatively accurate high-input-impedance ac voltmeter using an inexpensive moving-coil meter.

## EXERCISE

D18.34 In the circuit of Fig. 18.40, find the value of $R$ that would cause the meter to provide a full-scale reading when the input voltage is a sine wave of 5 V rms . Let meter M have a $1-\mathrm{mA}, 50-\Omega$ movement (i.e., its resistance is $50 \Omega$, and it provides full-scale deflection when the average current through it is 1 mA ). What are the approximate maximum and minimum voltages at the op amp's output? Assume that the diodes have constant $0.7-\mathrm{V}$ drops when conducting. Ans. $4.5 \mathrm{k} \Omega ;+8.55 \mathrm{~V} ;-8.55 \mathrm{~V}$
# 18.9.6 Precision Peak Rectifiers 

Including the diode of the peak rectifier studied in Section 4.5.4 inside the negative-feedback loop of an op amp, as shown in Fig. 18.41, results in a precision peak rectifier. The diode-op-amp combination will be recognized as the superdiode of Fig. 18.35(a). Operation of the circuit in Fig. 18.41 is quite straightforward. For $v_{I}$ greater than the output voltage, the op amp will drive the diode on, thus closing the negative-feedback path and causing the op amp to act as a follower. The output voltage will therefore follow that of the input, with the op amp supplying the capacitor-charging current. This process continues until the input reaches its peak value. Beyond the positive peak, the op amp will see a negative voltage between its input terminals. Thus its output will go negative to the saturation level and the diode will turn off. Except for possible discharge through the load resistance, the capacitor will retain a voltage equal to the positive peak of the input. Inclusion of a load resistance is essential if the circuit is required to detect reductions in the magnitude of the positive peak.

### 18.9.7 A Buffered Precision Peak Detector

When the peak detector is required to hold the value of the peak for a long time, the capacitor should be buffered, as shown in the circuit of Fig. 18.42. Here op amp $\mathrm{A}_{2}$, which should have high input impedance and low input bias current, is connected as a voltage follower. The remainder of the circuit is quite similar to the half-wave-rectifier circuit of Fig. 18.42. While diode $D_{1}$ is the essential diode for the peak-rectification operation, diode $D_{2}$ acts as a catching diode to prevent negative saturation, and the associated delays, of op amp $\mathrm{A}_{1}$. During the holding state, follower $\mathrm{A}_{2}$ supplies $D_{2}$ with a small current through $R$. The output of op amp $\mathrm{A}_{1}$ will then be clamped at one diode drop below the input voltage. Now if the input $v_{I}$


Figure 18.41 A precision peak rectifier obtained by placing the diode in the feedback loop of an op amp.


Figure 18.42 A buffered precision peak rectifier.


Figure 18.43 A precision clamping circuit.
increases above the value stored on $C$, which is equal to the output voltage $v_{O}$, op amp $\mathrm{A}_{1}$ sees a net positive input that drives its output toward the positive saturation level, turning off diode $D_{2}$. Diode $D_{1}$ is then turned on and capacitor $C$ is charged to the new positive peak of the input, after which time the circuit returns to the holding state. Finally, note that this circuit has a low-impedance output.

# 18.9.8 A Precision Clamping Circuit 

By replacing the diode in the clamping circuit studied in Section 4.6.2 with a "superdiode," the precision clamp of Fig. 18.43 is obtained. Operation of this circuit should be self-explanatory.

## Section 18.9: Precision Rectifier Circuits

18.54 Two superdiode circuits connected to a common-load resistor and having the same input signal have their diodes reversed, one with cathode to the load, the other with anode to the load. For a sine-wave input of 10 V peak to peak, what is the output waveform? Note that each half-cycle of the load current is provided by a separate amplifier, and that while one amplifier supplies the load current, the other amplifier idles. This idea, called class B operation (see Chapter 12), is important in the implementation of power amplifiers.

D 18.55 The superdiode circuit of Fig. 18.35(a) can be made to have gain by connecting a resistor $R_{2}$ in place of the short circuit between the cathode of the diode and the negative-input terminal of the op amp, and a resistor $R_{1}$ between the negative-input terminal and ground. Design the circuit for a gain of 2 . For a $10-\mathrm{V}$ peak-to-peak input sine wave, what is the average output voltage resulting?
D 18.56 Provide a design of the inverting precision rectifier shown in Fig. 18.36(a) in which the gain is -2 for negative inputs and zero otherwise, and the input resistance is $100 \mathrm{k} \Omega$. What values of $R_{1}$ and $R_{2}$ do you choose?

D *18.57 Provide a design for a voltmeter circuit similar to the one in Fig. 18.37, which is intended to function at frequencies of 10 Hz and above. It should be calibrated for sine-wave input signals to provide an output of +10 V for an input of 1 V rms . The input resistance should be as high as possible. To extend the bandwidth of operation, keep the gain in the ac part of the circuit reasonably small. As well, the design should result in reduction of the size of the capacitor $C$ required. The largest value of resistor available is $1 \mathrm{M} \Omega$.
18.58 Plot the transfer characteristic of the circuit in Fig. P18.58.
18.59 Plot the transfer characteristics $v_{O 1}-v_{I}$ and $v_{O 2}-v_{I}$ of the circuit in Fig. P18.59.
18.60 Sketch the transfer characteristics of the circuit in Fig. P18.60.


Figure P18.58



Figure P18.59



Figure P18.60
D 18.61 A circuit related to that in Fig. 18.40 is to be used to provide a current proportional to $v_{A}\left(v_{A} \geq 0\right)$ to a light-emitting diode (LED). The value of the current is to be independent of the diode's nonlinearities and variability. Indicate how this may be done easily.
*18.62 In the precision rectifier of Fig. 18.40, the resistor $R$ is replaced by a capacitor $C$. What happens? For equivalent performance with a sine-wave input of $60-\mathrm{Hz}$ frequency with $R=1 \mathrm{k} \Omega$, what value of $C$ should be used? What is the response of the modified circuit at 120 Hz ? At 180 Hz ? If the amplitude of $v_{A}$ is kept fixed, what new function does this circuit perform? Now consider the effect of a waveform change on both circuits (the one with $R$ and the one with $C$ ). For a triangular-wave input of $60-\mathrm{Hz}$ frequency that produces an average meter current of 1 mA in the circuit with $R$, what does the average meter current become when $R$ is replaced with the $C$ whose value was just calculated?
*18.63 A positive-peak rectifier utilizing a fast op amp and a junction diode in a superdiode configuration, and a $10-\mu \mathrm{F}$ capacitor initially uncharged, is driven by a series of $10-\mathrm{V}$ pulses of $10-\mu \mathrm{s}$ duration. If the maximum output current that the op amp can supply is 10 mA , what is the voltage on the capacitor following one pulse? Two pulses? Ten pulses? How many pulses are required to reach $0.5 \mathrm{~V} ? 1.0 \mathrm{~V}$ ? 2.0 V ?

D 18.64 Consider the buffered precision peak rectifier shown in Fig. 18.42 when connected to a triangular input of 1-V peak-to-peak amplitude and $1000-\mathrm{Hz}$ frequency. It utilizes an op amp whose bias current (directed into $\mathrm{A}_{2}$ ) is 10 nA and diodes whose reverse leakage current is 1 nA . What is the smallest capacitor that can be used to guarantee an output ripple less than $1 \%$ ?# Example 3.6 continued 

Thus most of the current is conducted by holes injected into the $n$ region.
Specifically,

$$
\begin{aligned}
& I_{p}=\frac{111}{112} \times 0.1=0.0991 \mathrm{~mA} \\
& I_{n}=\frac{1}{112} \times 0.1=0.0009 \mathrm{~mA}
\end{aligned}
$$

This stands to reason, since the $p$ material has a doping concentration 100 times that of the $n$ material.

## EXERCISES

3.10 Show that if $N_{A} \gg N_{D}$,

$$
I_{S} \simeq A q n_{i}^{2} \frac{D_{p}}{L_{p} N_{D}}
$$

3.11 For the $p n$ junction in Example 3.6, find the value of $I_{S}$ and that of the current $I$ at $V=0.605 \mathrm{~V}$ (same voltage found in Example 3.6 at a current $I=0.1 \mathrm{~mA}$ ) if $N_{D}$ is reduced by a factor of 2 .
Ans. $1.46 \times 10^{-14} \mathrm{~A} ; 0.2 \mathrm{~mA}$
3.12 For the $p n$ junction considered in Examples 3.5 and 3.6, find the width of the depletion region $W$ corresponding to the forward-bias voltage found in Example 3.6. (Hint: Use the formula in Eq. (3.31) with $V_{B}$ replaced with $-V_{F}$.)
Ans. $0.166 \mu \mathrm{~m}$
3.13 For the $p n$ junction considered in Examples 3.5 and 3.6, find the width of the depletion region $W$ and the charge stored in the depletion region $Q_{J}$ when a 2-V reverse bias is applied. Also find the value of the reverse current $I$.
Ans. $0.608 \mu \mathrm{~m} ; 9.63 \mathrm{pC} ; 7.3 \times 10^{-15} \mathrm{~A}$

### 3.5.3 Reverse Breakdown

The description of the operation of the $p n$ junction in the reverse direction, and the $I-V$ relationship of the junction in Eq. (3.40), indicate that at a reverse-bias voltage $-V$, with $V \gg V_{T}$, the reverse current that flows across the junction is approximately equal to $I_{S}$ and thus is very small. However, as the magnitude of the reverse-bias voltage $V$ is increased, a value is reached at which a very large reverse current flows as shown in Fig. 3.14. Observe that as $V$ reaches the value $V_{Z}$, the dramatic increase in reverse current is accompanied by a very small increase in the reverse voltage; that is, the reverse voltage across the junction


Figure 3.14 The $I-V$ characteristic of the $p n$ junction showing the rapid increase in reverse current in the breakdown region.
remains very close to the value $V_{Z}$. The phenomenon that occurs at $V=V_{Z}$ is known as junction breakdown. It is not a destructive phenomenon. That is, the $p n$ junction can be repeatedly operated in the breakdown region without a permanent effect on its characteristics. This, however, is predicated on the assumption that the magnitude of the reverse-breakdown current is limited by the external circuit to a "safe" value. The "safe" value is one that results in the limitation of the power dissipated in the junction to a safe, allowable level.

There are two possible mechanisms for $p n$ junction breakdown: the zener effect ${ }^{7}$ and the avalanche effect. If a $p n$ junction breaks down with a breakdown voltage $V_{Z}<5 \mathrm{~V}$, the breakdown mechanism is usually the zener effect. Avalanche breakdown occurs when $V_{Z}$ is greater than approximately 7 V . For junctions that break down between 5 V and 7 V , the breakdown mechanism can be either the zener or the avalanche effect or a combination of the two.

Zener breakdown occurs when the electric field in the depletion layer increases to the point of breaking covalent bonds and generating electron-hole pairs. The electrons generated in this way will be swept by the electric field into the $n$ side and the holes into the $p$ side. Thus these electrons and holes constitute a reverse current across the junction. Once the zener effect starts, a large number of carriers can be generated, with a negligible increase in the junction voltage. Thus the reverse current in the breakdown region will be large and its value must be determined by the external circuit, while the reverse voltage appearing between the diode terminals will remain close to the specified breakdown voltage $V_{Z}$.

The other breakdown mechanism, avalanche breakdown, occurs when the minority carriers that cross the depletion region under the influence of the electric field gain sufficient kinetic energy to be able to break covalent bonds in atoms with which they collide. The carriers liberated by this process may have sufficiently high energy to be able to cause other carriers to be liberated in another ionizing collision. This process keeps repeating in the fashion of an avalanche, with the result that many carriers are created that are able to support any value of

[^0]
[^0]:    ${ }^{7}$ Named after an early worker in the area. Note that the subscript $Z$ in $V_{Z}$ denotes zener. We will use $V_{Z}$ to denote the breakdown voltage whether the breakdown mechanism is the zener effect or the avalanche effect.
reverse current, as determined by the external circuit, with a negligible change in the voltage drop across the junction.

As will be seen in Chapter 4, some $p n$ junction diodes are fabricated to operate specifically in the breakdown region, where use is made of the nearly constant voltage $V_{Z}$.

# 3.6 Capacitive Effects in the pn Junction 

There are two charge-storage mechanisms in the $p n$ junction. One is associated with the charge stored in the depletion region, and the other is associated with the minority-carrier charge stored in the $n$ and $p$ materials as a result of the concentration profiles established by carrier injection. While the first is easier to see when the $p n$ junction is reverse biased, the second is in effect only when the junction is forward biased.

### 3.6.1 Depletion or Junction Capacitance

When a $p n$ junction is reverse biased with a voltage $V_{R}$, the charge stored on either side of the depletion region is given by Eq. (3.32),

$$
Q_{J}=A \sqrt{2 \epsilon_{r} q \frac{N_{A} N_{D}}{N_{A}+N_{D}}\left(V_{0}+V_{R}\right)}
$$

Thus, for a given $p n$ junction,

$$
Q_{J}=\alpha \sqrt{V_{0}+V_{R}}
$$

where $\alpha$ is given by

$$
\alpha=A \sqrt{2 \epsilon_{r} q \frac{N_{A} N_{D}}{N_{A}+N_{D}}}
$$

Thus $Q_{J}$ is nonlinearly related to $V_{R}$, as shown in Fig. 3.15. This nonlinear relationship makes it difficult to define a capacitance that accounts for the need to change $Q_{J}$ whenever $V_{R}$ is


Figure 3.15 The charge stored on either side of the depletion layer as a function of the reverse voltage $V_{R}$.
changed. We can, however, assume that the junction is operating at a point such as $Q$, as indicated in Fig. 3.15, and define a capacitance $C_{j}$ that relates the change in the charge $Q_{J}$ to a change in the voltage $V_{R}$,

$$
C_{j}=\left.\frac{d Q_{J}}{d V_{R}}\right|_{V_{R}=V_{Q}}
$$

This incremental-capacitance approach turns out to be quite useful in electronic circuit design, as we shall see throughout this book.

Using Eq. (3.44) together with Eq. (3.42) yields

$$
C_{j}=\frac{\alpha}{2 \sqrt{V_{0}+V_{R}}}
$$

The value of $C_{j}$ at zero reverse bias can be obtained from Eq. (3.45) as

$$
C_{j 0}=\frac{\alpha}{2 \sqrt{V_{0}}}
$$

which enables us to express $C_{j}$ as

$$
C_{j}=\frac{C_{j 0}}{\sqrt{1+\frac{V_{R}}{V_{0}}}}
$$

where $C_{j 0}$ is given by Eq. (3.46) or alternatively if we substitute for $\alpha$ from Eq. (3.43) by

$$
C_{j 0}=A \sqrt{\left(\frac{\epsilon_{r} q}{2}\right)\left(\frac{N_{A} N_{D}}{N_{A}+N_{D}}\right)\left(\frac{1}{V_{0}}\right)}
$$

Before leaving the subject of depletion-region or junction capacitance we point out that in the $p n$ junction we have been studying, the doping concentration is made to change abruptly at the junction boundary. Such a junction is known as an abrupt junction. There is another type of $p n$ junction in which the carrier concentration is made to change gradually from one side of the junction to the other. To allow for such a graded junction, the formula for the junction capacitance (Eq. 3.47) can be written in the more general form

$$
C_{j}=\frac{C_{j 0}}{\left(1+\frac{V_{R}}{V_{0}}\right)^{m}}
$$

where $m$ is a constant called the grading coefficient, whose value ranges from $1 / 3$ to $1 / 2$ depending on the manner in which the concentration changes from the $p$ to the $n$ side.
# EXERCISE 

3.14 For the $p n$ junction considered in Examples 3.5 and 3.6, find $C_{j 0}$ and $C_{j}$ at $V_{B}=2 \mathrm{~V}$. Recall that $V_{0}=0.814 \mathrm{~V}, N_{A}=10^{18} / \mathrm{cm}^{3}, N_{D}=10^{16} / \mathrm{cm}^{3}$, and $A=10^{-4} \mathrm{~cm}^{3}$.
Ans. $3.2 \mathrm{pF} ; 1.7 \mathrm{pF}$

### 3.6.2 Diffusion Capacitance

Consider a forward-biased $p n$ junction. In steady state, minority-carrier distributions in the $p$ and $n$ materials are established, as shown in Fig. 3.12. Thus a certain amount of excess minority-carrier charge is stored in each of the $p$ and $n$ bulk regions (outside the depletion region). If the terminal voltage $V$ changes, this charge will have to change before a new steady state is achieved. This charge-storage phenomenon gives rise to another capacitive effect, distinctly different from that due to charge storage in the depletion region.

To calculate the excess minority-carrier charge, refer to Fig. 3.12. The excess hole charge stored in the $n$ region can be found from the shaded area under the exponential as follows: ${ }^{8}$

$$
\begin{aligned}
Q_{p} & =A q \times \text { shaded area under the } p_{n}(x) \text { curve } \\
& =A q\left[p_{n}\left(x_{n}\right)-p_{n 0}\right] L_{p}
\end{aligned}
$$

Substituting for $p_{n}\left(x_{n}\right)$ from Eq. (3.33) and using Eq. (3.37) enables us to express $Q_{p}$ as

$$
Q_{p}=\frac{L_{p}^{2}}{D_{p}} I_{p}
$$

The factor $\left(L_{p}^{2} / D_{p}\right)$ that relates $Q_{p}$ to $I_{p}$ is a useful device parameter that has the dimension of time (s) and is denoted $\tau_{p}$

$$
\tau_{p}=\frac{L_{p}^{2}}{D_{p}}
$$

Thus,

$$
Q_{p}=\tau_{p} I_{p}
$$

The time constant $\tau_{p}$ is known as the excess minority-carrier (hole) lifetime. It is the average time it takes for a hole injected into the $n$ region to recombine with a majority electron. This definition of $\tau_{p}$ implies that the entire charge $Q_{p}$ disappears and has to be replenished every $\tau_{p}$ seconds. The current that accomplishes the replenishing is $I_{p}=Q_{p} / \tau_{p}$. This is an alternate derivation for Eq. (3.52).

[^0]
[^0]:    ${ }^{8}$ Recall that the area under an exponential curve $A e^{-s / B}$ is equal to $A B$.
A relationship similar to that in Eq. (3.52) can be developed for the electron charge stored in the $p$ region,

$$
Q_{n}=\tau_{n} I_{n}
$$

where $\tau_{n}$ is the electron lifetime in the $p$ region. The total excess minority-carrier charge can be obtained by adding together $Q_{p}$ and $Q_{n}$,

$$
Q=\tau_{p} I_{p}+\tau_{n} I_{n}
$$

This charge can be expressed in terms of the diode current $I=I_{p}+I_{n}$ as

$$
Q=\tau_{T} I
$$

where $\tau_{T}$ is called the mean transit time of the junction. Obviously, $\tau_{T}$ is related to $\tau_{p}$ and $\tau_{n}$. Furthermore, for most practical devices, one side of the junction is much more heavily doped than the other. For instance, if $N_{A} \gg N_{D}$, one can show that $I_{p} \gg I_{n}, I \simeq I_{p}, Q_{p} \gg Q_{n}, Q \simeq Q_{p}$, and thus $\tau_{T} \simeq \tau_{p}$.

For small changes around a bias point, we can define an incremental diffusion capacitance $C_{d}$ as

$$
C_{d}=\frac{d Q}{d V}
$$

and can show that

$$
C_{d}=\left(\frac{\tau_{T}}{V_{T}}\right) I
$$

where $I$ is the forward-bias current. Note that $C_{d}$ is directly proportional to the forward current $I$ and thus is negligibly small when the diode is reverse biased. Also note that to keep $C_{d}$ small, the transit time $\tau_{T}$ must be made small, an important requirement for a $p n$ junction intended for high-speed or high-frequency operation.

# EXERCISES 

3.15 Use the definition of $C_{d}$ in Eq. (3.56) to derive the expression in Eq. (3.57) by means of Eqs. (3.55) and (3.40).
3.16 For the $p n$ junction considered in Examples 3.5 and 3.6 for which $D_{p}=10 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$, and $L_{p}=5 \mu \mathrm{~m}$, find $\tau_{p}$ and $C_{d}$ at a forward-bias current of 0.1 mA . Recall that for this junction, $I_{p} \simeq I$. Ans. $25 \mathrm{~ns} ; 96.5 \mathrm{pF}$
## Summary

- Today's microelectronics technology is almost entirely based on the semiconductor material silicon. If a circuit is to be fabricated as a monolithic integrated circuit (IC) it is made using a single silicon crystal, no matter how large the circuit is (a recent chip contains 4.31 billion transistors).
- In a crystal of intrinsic or pure silicon, the atoms are held in position by covalent bonds. At very low temperatures, all the bonds are intact, and no charge carriers are available to conduct electrical current. Thus, at such low temperatures, silicon behaves as an insulator.
- At room temperature, thermal energy causes some of the covalent bonds to break, thus generating free electrons and holes that become available for current conduction.
- Current in semiconductors is carried by free electrons and holes. Their numbers are equal and relatively small in intrinsic silicon.
- The conductivity of silicon can be increased dramatically by introducing small amounts of appropriate impurity materials into the silicon crystal in a process called doping.
- There are two kinds of doped semiconductor: $n$-type, in which electrons are abundant, and $p$-type, in which holes are abundant.
- There are two mechanisms for the transport of charge carriers in semiconductors: drift and diffusion.
- Carrier drift results when an electric field $E$ is applied across a piece of silicon. The electric field accelerates the holes in the direction of $E$ and the electrons in the direction opposite to $E$. These two current components add together to produce a drift current in the direction of $E$.
- Carrier diffusion occurs when the concentration of charge carriers is made higher in one part of the silicon crystal than in other parts. To establish a steady-state diffusion current, a carrier concentration gradient must be maintained in the silicon crystal.
- A basic semiconductor structure is the $p n$ junction. It is fabricated in a silicon crystal by creating a $p$ region in close proximity to an $n$ region. The $p n$ junction is a diode and plays a dominant role in the structure and operation of transistors.
- When the terminals of the $p n$ junction are left open, no current flows externally. However, two equal and
opposite currents, $I_{D}$ and $I_{S}$, flow across the junction, and equilibrium is maintained by a built-in voltage $V_{0}$ that develops across the junction, with the $n$ side positive relative to the $p$ side. Note, however, that the voltage across an open junction is 0 V , since $V_{0}$ is canceled by potentials appearing at the metal-to-semiconductor connection interfaces.
- The voltage $V_{0}$ appears across the depletion region, which extends on both sides of the junction.
- The diffusion current $I_{D}$ is carried by holes diffusing from $p$ to $n$ and electrons diffusing from $n$ to $p . I_{D}$ flows from $p$ to $n$, which is the forward direction of the junction. Its value depends on $V_{0}$.
- The drift current $I_{S}$ is carried by thermally generated minority electrons in the $p$ material that are swept across the depletion layer into the $n$ side, and by thermally generated minority holes in the $n$ side that are swept across the depletion region into the $p$ side. $I_{S}$ flows from $n$ to $p$, in the reverse direction of the junction, and its value is a strong function of temperature but independent of $V_{0}$.
- Forward biasing the $p n$ junction, that is, applying an external voltage $V$ that makes $p$ more positive than $n$, reduces the barrier voltage to $V_{0}-V$ and results in an exponential increase in $I_{D}$ while $I_{S}$ remains unchanged. The net result is a substantial current $I=I_{D}-I_{S}$ that flows across the junction and through the external circuit.
- Applying a negative $V$ reverse biases the junction and increases the barrier voltage, with the result that $I_{D}$ is reduced to almost zero and the net current across the junction becomes the very small reverse current $I_{S}$.
- If the reverse voltage is increased in magnitude to a value $V_{Z}$ specific to the particular junction, the junction breaks down, and a large reverse current flows. The value of the reverse current must be limited by the external circuit.
- Whenever the voltage across a $p n$ junction is changed, some time has to pass before steady state is reached. This is due to the charge-storage effects in the junction, which are modeled by two capacitances: the junction capacitance $C_{j}$ and the diffusion capacitance $C_{d}$.
- For future reference, we present in Table 3.1 a summary of pertinent relationships and the values of physical constants.
Table 3.1 Summary of Important Equations

| Quantity | Relationship | Values of Constants and Parameters (for Intrinsic Si at $T=300 \mathrm{~K}$ ) |
| :--: | :--: | :--: |
| Carrier concentration in intrinsic silicon $\left(\mathrm{cm}^{-3}\right)$ | $n_{i}=B T^{3 / 2} e^{-E_{g} / 2 k T}$ | $\begin{aligned} & B=7.3 \times 10^{15} \mathrm{~cm}^{-3} \mathrm{~K}^{-3 / 2} \\ & E_{g}=1.12 \mathrm{eV} \\ & k=8.62 \times 10^{-5} \mathrm{eV} / \mathrm{K} \\ & n_{i}=1.5 \times 10^{10} / \mathrm{cm}^{3} \end{aligned}$ |
| Diffusion current density $\left(\mathrm{A} / \mathrm{cm}^{2}\right)$ | $\begin{aligned} & J_{p}=-q D_{p} \frac{d p}{d x} \\ & J_{n}=q D_{n} \frac{d n}{d x} \end{aligned}$ | $\begin{aligned} & q=1.60 \times 10^{-19} \text { coulomb } \\ & D_{p}=12 \mathrm{~cm}^{2} / \mathrm{s} \\ & D_{n}=34 \mathrm{~cm}^{2} / \mathrm{s} \end{aligned}$ |
| Drift current density $\left(\mathrm{A} / \mathrm{cm}^{2}\right)$ | $J_{\text {drift }}=q\left(p \mu_{p}+n \mu_{n}\right) E$ | $\begin{aligned} & \mu_{p}=480 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{~s} \\ & \mu_{n}=1350 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{~s} \end{aligned}$ |
| Resistivity $(\Omega \cdot \mathrm{cm})$ | $\rho=1 /\left[q\left(p \mu_{p}+n \mu_{n}\right)\right]$ | $\mu_{p}$ and $\mu_{n}$ decrease with the increase in doping concentration |
| Relationship between mobility and diffusivity | $\frac{D_{p}}{\mu_{n}}=\frac{D_{p}}{\mu_{p}}=V_{T}$ | $V_{T}=k T / q \simeq 25.9 \mathrm{mV}$ |
| Carrier concentration in $n$-type silicon $\left(\mathrm{cm}^{-3}\right)$ | $\begin{aligned} & n_{a 0} \simeq N_{D} \\ & p_{a 0}=n_{i}^{2} / N_{D} \end{aligned}$ |  |
| Carrier concentration in $p$-type silicon $\left(\mathrm{cm}^{-3}\right)$ | $\begin{aligned} & p_{p 0} \simeq N_{A} \\ & n_{p 0}=n_{i}^{2} / N_{A} \end{aligned}$ |  |
| Junction built-in voltage (V) | $V_{0}=V_{T} \ln \left(\frac{N_{A} N_{D}}{n_{i}^{2}}\right)$ |  |
| Width of depletion region (cm) | $\begin{aligned} & \frac{x_{n}}{x_{p}}=\frac{N_{A}}{N_{D}} \\ & W=x_{n}+x_{p} \end{aligned}$ | $\begin{aligned} & \epsilon_{s}=11.7 \epsilon_{0} \\ & \epsilon_{0}=8.854 \times 10^{-14} \mathrm{~F} / \mathrm{cm} \end{aligned}$ |
| Quantity | Relationship | Values of Constants and Parameters (for Intrinsic Si at $T=300 \mathrm{~K}$ ) |
| :--: | :--: | :--: |
| Charge stored in depletion layer (coulomb) | $Q_{J}=q \frac{N_{A} N_{D}}{N_{A}+N_{D}} A W$ |  |
| Forward current (A) | $\begin{aligned} & I=I_{p}+I_{n} \\ & I_{p}=A q n_{i}^{2} \frac{D_{p}}{L_{p} N_{D}}\left(e^{1 / V_{T}}-1\right) \\ & I_{n}=A q n_{i}^{2} \frac{D_{n}}{L_{n} N_{A}}\left(e^{1 / V_{T}}-1\right) \end{aligned}$ |  |
| Saturation current (A) | $I_{S}=A q n_{i}^{2}\left(\frac{D_{p}}{L_{p} N_{D}}+\frac{D_{n}}{L_{n} N_{A}}\right)$ |  |
| $I-V$ relationship | $I=I_{S}\left(e^{1 / V_{T}}-1\right)$ |  |
| Minority-carrier lifetime (s) | $\tau_{p}=L_{p}^{2} / D_{p} \quad \tau_{n}=L_{n}^{2} / D_{n} \quad \begin{aligned} & L_{p}, L_{n}=1 \mu \mathrm{~m} \text { to } 100 \mu \mathrm{~m} \\ & \tau_{p}, \tau_{n}=1 \mathrm{~ns} \text { to } 10^{4} \mathrm{~ns} \end{aligned}$ |  |
| Minority-carrier charge storage (coulomb) | $\begin{aligned} & Q_{p}=\tau_{p} I_{p} \quad Q_{n}=\tau_{n} I_{n} \\ & Q=Q_{p}+Q_{n}=\tau_{T} I \end{aligned}$ |  |
| Depletion capacitance ( F ) | $\begin{aligned} C_{f 0} & =A \sqrt{\left(\frac{\epsilon_{c} q}{2}\right)\left(\frac{N_{A} N_{D}}{N_{A}+N_{D}}\right) \frac{1}{V_{0}}} \\ C_{f} & =C_{f 0} /\left(1+\frac{V_{0}}{V_{0}}\right)^{m} \end{aligned}$ | $m=\frac{1}{3}$ to $\frac{1}{2}$ |
| Diffusion capacitance ( F ) | $C_{d}=\left(\frac{\tau_{T}}{V_{T}}\right) I$ |  |
If in the following problems the need arises for the values of particular parameters or physical constants that are not stated, please consult Table 3.1.

## Section 3.1: Intrinsic Semiconductors

3.1 Find values of the intrinsic carrier concentration $n_{i}$ for silicon at $-55^{\circ} \mathrm{C}, 0^{\circ} \mathrm{C}, 20^{\circ} \mathrm{C}, 75^{\circ} \mathrm{C}$, and $125^{\circ} \mathrm{C}$. At each temperature, what fraction of the atoms is ionized? Recall that a silicon crystal has approximately $5 \times 10^{22}$ atoms $/ \mathrm{cm}^{3}$.
3.2 Calculate the value of $n_{i}$ for gallium arsenide (GaAs) at $T=300 \mathrm{~K}$. The constant $B=3.56 \times 10^{14} \mathrm{~cm}^{-3} \mathrm{~K}^{-1 / 2}$ and the bandgap voltage $E_{g}=1.42 \mathrm{eV}$.

## Section 3.2: Doped Semiconductors

3.3 For a $p$-type silicon in which the dopant concentration $N_{A}=5 \times 10^{19} / \mathrm{cm}^{3}$, find the hole and electron concentrations at $T=300 \mathrm{~K}$.
3.4 For a silicon crystal doped with phosphorus, what must $N_{D}$ be if at $T=300 \mathrm{~K}$ the hole concentration drops below the intrinsic level by a factor of $10^{8}$ ?
3.5 In a phosphorus-doped silicon layer with impurity concentration of $10^{17} / \mathrm{cm}^{3}$, find the hole and electron concentrations at $27^{\circ} \mathrm{C}$ and $125^{\circ} \mathrm{C}$.

## Section 3.3: Current Flow in Semiconductors

3.6 A young designer, aiming to develop intuition concerning conducting paths within an integrated circuit, examines the end-to-end resistance of a connecting bar $10-\mu \mathrm{m}$ long, $3-\mu \mathrm{m}$ wide, and $1 \mu \mathrm{~m}$ thick, made of various materials. The designer considers:
(a) intrinsic silicon
(b) $n$-doped silicon with $N_{D}=5 \times 10^{10} / \mathrm{cm}^{3}$
(c) $n$-doped silicon with $N_{D}=5 \times 10^{18} / \mathrm{cm}^{3}$
(d) $p$-doped silicon with $N_{A}=5 \times 10^{16} / \mathrm{cm}^{3}$
(e) aluminum with resistivity of $2.8 \mu \Omega \cdot \mathrm{~cm}$

Find the resistance in each case. For intrinsic silicon, use the data in Table 3.1. For doped silicon, assume $\mu_{n}=3 \mu_{p}=$ $1200 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$. (Recall that $R=\rho L / A$.)
3.7 Contrast the electron and hole drift velocities through a $10-\mu \mathrm{m}$ layer of intrinsic silicon across which a voltage
of 3 V is imposed. Let $\mu_{n}=1350 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$ and $\mu_{p}=$ $480 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$.
3.8 Find the current that flows in a silicon bar of $10-\mu \mathrm{m}$ length having a $5-\mu \mathrm{m} \times 4-\mu \mathrm{m}$ cross-section and having free-electron and hole densities of $10^{4} / \mathrm{cm}^{3}$ and $10^{10} / \mathrm{cm}^{3}$, respectively, when a 1 V is applied end-to-end. Use $\mu_{n}=$ $1200 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$ and $\mu_{p}=500 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$.
3.9 In a $10-\mu \mathrm{m}$-long bar of donor-doped silicon, what donor concentration is needed to realize a current density of $2 \mathrm{~mA} / \mu \mathrm{m}^{2}$ in response to an applied voltage of 1 V ? (Note: Although the carrier mobilities change with doping concentration, as a first approximation you may assume $\mu_{n}$ to be constant and use $1350 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$, the value for intrinsic silicon.)
3.10 Holes are being steadily injected into a region of $n$-type silicon (connected to other devices, the details of which are not important for this question). In the steady state, the excess-hole concentration profile shown in Fig. P3.10 is established in the $n$-type silicon region. Here "excess" means over and above the thermal-equilibrium concentration (in the absence of hole injection), denoted $p_{n 0}$. If $N_{D}=10^{19} / \mathrm{cm}^{3}$, $n_{i}=1.5 \times 10^{10} / \mathrm{cm}^{3}, D_{p}=12 \mathrm{~cm}^{2} / \mathrm{s}$, and $W=50 \mathrm{~nm}$, find the density of the current that will flow in the $x$ direction.


Figure P3.10
3.11 Both the carrier mobility and the diffusivity decrease as the doping concentration of silicon is increased. Table P3.11 provides a few data points for $\mu_{n}$ and $\mu_{p}$ versus doping concentration. Use the Einstein relationship to obtain the corresponding values for $D_{n}$ and $D_{p}$.Table P3.11

| Doping Concentration <br> $\left(\right.$ carriers $\left./ \mathrm{cm}^{3}\right)$ | $\mu_{\mathrm{n}}\left(\mathrm{cm}^{2} / \mathrm{V} \cdot \mathrm{s}\right)$ | $\mu_{p}\left(\mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}\right)$ | $D_{n}\left(\mathrm{~cm}^{2} / \mathrm{s}\right)$ | $D_{p}\left(\mathrm{~cm}^{2} / \mathrm{s}\right)$ |
| :-- | :--: | :--: | :--: | :--: |
| Intrinsic | 1350 | 480 |  |  |
| $10^{16}$ | 1200 | 400 |  |  |
| $10^{17}$ | 750 | 260 |  |  |
| $10^{18}$ | 380 | 160 |  |  |

## Section 3.4: The pn Junction

3.12 Calculate the built-in voltage of a junction in which the $p$ and $n$ regions are doped equally with $5 \times 10^{16}$ atoms $/ \mathrm{cm}^{3}$. Assume $n_{i}=1.5 \times 10^{16} / \mathrm{cm}^{3}$. With the terminals left open, what is the width of the depletion region, and how far does it extend into the $p$ and $n$ regions? If the cross-sectional area of the junction is $20 \mu \mathrm{~m}^{2}$, find the magnitude of the charge stored on either side of the junction.
3.13 If, for a particular junction, the acceptor concentration is $10^{17} / \mathrm{cm}^{3}$ and the donor concentration is $10^{16} / \mathrm{cm}^{3}$, find the junction built-in voltage. Assume $n_{i}=1.5 \times 10^{10} / \mathrm{cm}^{3}$. Also, find the width of the depletion region $(W)$ and its extent in each of the $p$ and $n$ regions when the junction terminals are left open. Calculate the magnitude of the charge stored on either side of the junction. Assume that the junction area is $100 \mu \mathrm{~m}^{2}$.
3.14 Estimate the total charge stored in a $0.1-\mu \mathrm{m}$ depletion layer on one side of a $10-\mu \mathrm{m} \times 10-\mu \mathrm{m}$ junction. The doping concentration on that side of the junction is $10^{16} / \mathrm{cm}^{3}$.
3.15 In a $p n$ junction for which $N_{A} \gg N_{D}$, and the depletion layer exists mostly on the shallowly doped side with $W=$ $0.2 \mu \mathrm{~m}$, find $V_{0}$ if $N_{D}=10^{16} / \mathrm{cm}^{3}$. Also calculate $Q_{J}$ for the case $A=10 \mu \mathrm{~m}^{2}$.
3.16 By how much does $V_{0}$ change if $N_{A}$ or $N_{D}$ is increased by a factor of 10 ?

## Section 3.5: The pn Junction with an Applied Voltage

3.17 If a 3-V reverse-bias voltage is applied across the junction specified in Problem 3.13, find $W$ and $Q_{J}$.
3.18 Show that for a $p n$ junction reverse-biased with a voltage $V_{R}$, the depletion-layer width $W$ and the
charge stored on either side of the junction, $Q_{J}$, can be expressed as

$$
\begin{aligned}
& W=W_{0} \sqrt{1+\frac{V_{R}}{V_{0}}} \\
& Q_{J}=Q_{J 0} \sqrt{1+\frac{V_{R}}{V_{0}}}
\end{aligned}
$$

where $W_{0}$ and $Q_{J 0}$ are the values in equilibrium.
3.19 In a forward-biased $p n$ junction show that the ratio of the current component due to hole injection across the junction to the component due to electron injection is given by

$$
\frac{I_{p}}{I_{n}}=\frac{D_{n}}{D_{n}} \frac{L_{n}}{L_{p}} \frac{N_{A}}{N_{D}}
$$

Evaluate this ratio for the case $N_{A}=10^{18} / \mathrm{cm}^{3}, N_{D}=$ $10^{16} / \mathrm{cm}^{3}, L_{p}=5 \mu \mathrm{~m}, L_{n}=10 \mu \mathrm{~m}, D_{n}=10 \mathrm{~cm}^{2} / \mathrm{s}$, and $D_{n}=20 \mathrm{~cm}^{2} / \mathrm{s}$, and hence find $I_{p}$ and $I_{n}$ for the case in which the $p n$ junction is conducting a forward current $I=100 \mu \mathrm{~A}$.
3.20 Calculate $I_{S}$ and the current $I$ for $V=750 \mathrm{mV}$ for a $p n$ junction for which $N_{A}=10^{17} / \mathrm{cm}^{3}, N_{D}=10^{16} / \mathrm{cm}^{3}$, $A=100 \mu \mathrm{~m}^{2}, n_{i}=1.5 \times 10^{10} / \mathrm{cm}^{3}, L_{p}=5 \mu \mathrm{~m}, L_{n}=10 \mu \mathrm{~m}$, $D_{p}=10 \mathrm{~cm}^{2} / \mathrm{s}$, and $D_{n}=18 \mathrm{~cm}^{2} / \mathrm{s}$.
3.21 Assuming that the temperature dependence of $I_{S}$ arises mostly because $I_{S}$ is proportional to $n_{i}^{2}$, use the expression for $n_{i}$ in Eq. (3.2) to determine the factor by which $n_{i}^{2}$ changes as $T$ changes from 300 K to 305 K . This will be approximately the same factor by which $I_{S}$ changes for a $5^{\circ} \mathrm{C}$ rise in temperature. What is the factor?

[^0]
[^0]:    3.18 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
3.22 A $p^{+} n$ junction is one in which the doping concentration in the $p$ region is much greater than that in the $n$ region. In such a junction, the forward current is mostly due to hole injection across the junction. Show that

$$
I \simeq I_{p}=A q n_{i}^{2} \frac{D_{p}}{L_{p} N_{D}}\left(e^{3 / V_{T}}-1\right)
$$

For the specific case in which $N_{D}=10^{17} / \mathrm{cm}^{3}, D_{p}=10 \mathrm{~cm}^{3} / \mathrm{s}$, $L_{p}=10 \mu \mathrm{~m}$, and $A=10^{4} \mu \mathrm{~m}^{3}$, find $I_{g}$ and the voltage $V$ obtained when $I=1 \mathrm{~mA}$. Assume operation at 300 K where $n_{i}=1.5 \times 10^{10} / \mathrm{cm}^{3}$.
3.23 A $p n$ junction for which the breakdown voltage is 12 V has a rated (i.e., maximum allowable) power dissipation of 0.25 W . What continuous current in the breakdown region will raise the dissipation to half the rated value? If breakdown occurs for only 10 ms in every 20 ms , what average breakdown current is allowed?

## Section 3.6: Capacitive Effects in the pn Junction

3.24 For the $p n$ junction specified in Problem 3.13, find $C_{j 0}$ and $C_{j}$ at $V_{R}=3 \mathrm{~V}$.
3.25 For a particular junction for which $C_{j 0}=0.4 \mathrm{pF}, V_{0}=$ 0.75 V , and $m=1 / 3$, find $C_{j}$ at reverse-bias voltages of 1 V and 10 V .
3.26 The junction capacitance $C_{j}$ can be thought of as that of a parallel-plate capacitor and thus given by

$$
C_{j}=\frac{\epsilon A}{W}
$$

Show that this approach leads to a formula identical to that obtained by combining Eqs. (3.43) and (3.45) [or equivalently, by combining Eqs. (3.47) and (3.48)].
3.27 A $p n$ junction operating in the forward-bias region with a current $I$ of 1 mA is found to have a diffusion capacitance of 5 pF . What diffusion capacitance do you expect this junction
to have at $I=0.1 \mathrm{~mA}$ ? What is the mean transit time for this junction?
3.28 For the $p^{+} n$ junction specified in Problem 3.22, find $\tau_{p}$ and calculate the excess minority-carrier charge and the value of the diffusion capacitance at $I=0.1 \mathrm{~mA}$.
*3.29 A short-base diode is one where the widths of the $p$ and $n$ regions are much smaller than $L_{n}$ and $L_{p}$, respectively. As a result, the excess minority-carrier distribution in each region is a straight line rather than the exponentials shown in Fig. 3.12.
(a) For the short-base diode, sketch a figure corresponding to Fig. 3.12 and assume as in Fig. 3.12 that $N_{A} \gg N_{D}$.
(b) Following a derivation similar to that given in Section 3.5.2, show that if the widths of the $p$ and $n$ regions are denoted $W_{p}$ and $W_{n}$ then

$$
I=A q n_{i}^{2}\left[\frac{D_{p}}{\left(W_{n}-x_{n}\right) N_{D}}+\frac{D_{n}}{\left(W_{p}-x_{p}\right) N_{A}}\right]\left(e^{3 / V_{T}}-1\right)
$$

and

$$
\begin{aligned}
Q_{p} & =\frac{1}{2} \frac{\left(W_{n}-x_{n}\right)^{2}}{D_{p}} I_{p} \\
& \simeq \frac{1}{2} \frac{W_{n}^{2}}{D_{p}} I_{p}, \text { for } W_{n} \gg x_{n}
\end{aligned}
$$

(c) Also, assuming $Q \simeq Q_{p}, I \simeq I_{p}$, show that

$$
C_{d}=\frac{\tau_{T}}{V_{T}} I
$$

where

$$
\tau_{T}=\frac{1}{2} \frac{W_{n}^{2}}{D_{p}}
$$

(d) If a designer wishes to limit $C_{d}$ to 8 pF at $I=1 \mathrm{~mA}$, what should $W_{n}$ be? Assume $D_{p}=10 \mathrm{~cm}^{3} / \mathrm{s}$.
# CHAPTER 4 

## Diodes

Introduction 175
4.1 The Ideal Diode 176
4.2 Terminal Characteristics of Junction Diodes 184
4.3 Modeling the Diode Forward Characteristic 190
4.4 Operation in the Reverse Breakdown Region-Zener Diodes 202
4.5 Rectifier Circuits 207
4.6 Limiting and Clamping Circuits 221
4.7 Special Diode Types 227

Summary 229
Problems 230
# IN THIS CHAPTER YOU WILL LEARN 

1. The characteristics of the ideal diode and how to analyze and design circuits containing multiple ideal diodes together with resistors and dc sources to realize useful and interesting nonlinear functions.
2. The details of the $i-v$ characteristic of the junction diode (which was derived in Chapter 3) and how to use it to analyze diode circuits operating in the various bias regions:forward, reverse, and breakdown.
3. A simple but effective model of the diode $i-v$ characteristic in the forward direction: the constant-voltage-drop model.
4. A powerful technique for the application and modeling of the diode (and in later chapters, transistors): dc-biasing the diode and modeling its operation for small signals around the dc operating point by means of the small-signal model.
5. The use of a string of forward-biased diodes and of diodes operating in the breakdown region (zener diodes), to provide constant dc voltages (voltage regulators).
6. Application of the diode in the design of rectifier circuits, which convert ac voltages to dc as needed for powering electronic equipment.
7. A number of other practical and important applications of diodes.

## Introduction

In Chapters 1 and 2 we dealt almost entirely with linear circuits; any nonlinearity, such as that introduced by amplifier output saturation, was treated as a problem to be solved by the circuit designer. However, there are many other signal-processing functions that can be implemented only by nonlinear circuits. Examples include the generation of dc voltages from the ac power supply, and the generation of signals of various waveforms (e.g., sinusoids, square waves, pulses). Also, digital logic and memory circuits constitute a special class of nonlinear circuits.

The simplest and most fundamental nonlinear circuit element is the diode. Just like a resistor, the diode has two terminals; but unlike the resistor, which has a linear (straight-line) relationship between the current flowing through it and the voltage appearing across it, the diode has a nonlinear $i-v$ characteristic.

This chapter is concerned with the study of diodes. In order to understand the essence of the diode function, we begin with a fictitious element, the ideal diode. We then introduce the silicon junction diode, explain its terminal characteristics, and provide techniques for the
analysis of diode circuits. The latter task involves the important subject of device modeling. Our study of modeling the diode characteristics will lay the foundation for our study of modeling transistor operation in the next three chapters.

Of the many applications of diodes, their use in the design of rectifiers (which convert ac to dc) is the most common. Therefore we shall study rectifier circuits in some detail and briefly look at a number of other diode applications. Further nonlinear circuits that utilize diodes and other devices will be found throughout the book, but particularly in Chapter 18.

The junction diode is nothing more than the $p n$ junction we studied in Chapter 3, and most of this chapter is concerned with the study of silicon $p n$-junction diodes. In the last section, however, we briefly consider some specialized diode types, including the photodiode and the light-emitting diode.

# 4.1 The Ideal Diode 

### 4.1.1 Current-Voltage Characteristic

The ideal diode may be considered to be the most fundamental nonlinear circuit element. It is a two-terminal device having the circuit symbol of Fig. 4.1(a) and the $i-v$ characteristic shown in Fig. 4.1(b). The terminal characteristic of the ideal diode can be interpreted as follows: If a negative voltage (relative to the reference direction indicated in Fig. 4.1a) is applied to the diode, no current flows and the diode behaves as an open circuit (Fig. 4.1c). Diodes operated in this mode are said to be reverse biased, or operated in the reverse direction. An ideal diode has zero current when operated in the reverse direction and is said to be cut off, or simply off.

On the other hand, if a positive current (relative to the reference direction indicated in Fig. 4.1(a) is applied to the ideal diode, zero voltage drop appears across the diode. In other words, the ideal diode behaves as a short circuit in the forward direction (Fig. 4.1d); it passes any current with zero voltage drop. A forward-biased diode is said to be turned on, or simply on.

From the above description it should be noted that the external circuit must be designed to limit the forward current through a conducting diode, and the reverse voltage across a cutoff diode, to predetermined values. Figure 4.2 shows two diode circuits that illustrate this point. In the circuit of Fig. 4.2(a) the diode is obviously conducting. Thus its voltage drop will be zero, and the current through it will be determined by the $+10-\mathrm{V}$ supply and the $1-\mathrm{k} \Omega$ resistor as 10 mA . The diode in the circuit of Fig. 4.2(b) is obviously cut off, and thus its current will be zero, which in turn means that the entire $10-\mathrm{V}$ supply will appear as reverse bias across the diode.

The positive terminal of the diode is called the anode and the negative terminal the cathode, a carryover from the days of vacuum-tube diodes. The $i-v$ characteristic of the ideal diode (conducting in one direction and not in the other) should explain the choice of its arrow-like circuit symbol.

As should be evident from the preceding description, the $i-v$ characteristic of the ideal diode is highly nonlinear; although it consists of two straight-line segments, they are at $90^{\circ}$ to one another. A nonlinear curve that consists of straight-line segments is said to be piecewise linear. If a device having a piecewise-linear characteristic is used in a particular application in such a way that the signal across its terminals swings along only one of the linear segments, then the device can be considered a linear circuit element as far as that particular circuit


Figure 4.1 The ideal diode: (a) diode circuit symbol; (b) $i-v$ characteristic; (c) equivalent circuit in the reverse direction; (d) equivalent circuit in the forward direction.

(a)
(b)

Figure 4.2 The two modes of operation of ideal diodes and the use of an external circuit to limit (a) the forward current and (b) the reverse voltage.
application is concerned. On the other hand, if signals swing past one or more of the break points in the characteristic, linear analysis is no longer possible.

# 4.1.2 A Simple Application: The Rectifier 

A fundamental application of the diode, one that makes use of its severely nonlinear $i-v$ curve, is the rectifier circuit shown in Fig. 4.3(a). The circuit consists of the series connection of a diode $D$ and a resistor $R$. Let the input voltage $v_{i}$ be the sinusoid shown in Fig. 4.3(b), and assume the diode to be ideal. During the positive half-cycles of the input sinusoid, the positive
$v_{I}$ will cause current to flow through the diode in its forward direction. It follows that the diode voltage $v_{D}$ will be very small—ideally zero. Thus the circuit will have the equivalent shown in Fig. 4.3(c), and the output voltage $v_{O}$ will be equal to the input voltage $v_{I}$. On the other hand, during the negative half-cycles of $v_{I}$, the diode will not conduct. Thus the circuit will have the equivalent shown in Fig. 4.3(d), and $v_{O}$ will be zero. Thus the output voltage will have the waveform shown in Fig. 4.3(e). Note that while $v_{I}$ alternates in polarity and has a zero average value, $v_{O}$ is unidirectional and has a finite average value or a $d c$ component. Thus the circuit of Fig. 4.3(a) rectifies the signal and hence is called a rectifier. It can be used to generate dc from ac. We will study rectifier circuits in Section 4.5.


Figure 4.3 (a) Rectifier circuit. (b) Input waveform. (c) Equivalent circuit when $v_{I} \geq 0$. (d) Equivalent circuit when $v_{I} \leq 0$. (e) Output waveform.
# EXERCISES 

4.1 For the circuit in Fig. 4.3(a), sketch the transfer characteristic $v_{O}$ versus $v_{I}$. Ans. See Fig. E4.1


Figure E4.1
4.2 For the circuit in Fig. 4.3(a), sketch the waveform of $v_{D}$. Ans. $v_{D}=v_{I}-v_{O}$, resulting in the waveform in Fig. E4.2


Figure E4.2
4.3 In the circuit of Fig. 4.3(a), let $v_{I}$ have a peak value of 10 V and $R=1 \mathrm{k} \Omega$. Find the peak value of $i_{D}$ and the dc component of $v_{O}$. (Hint: The average value of half-sine waves is $V_{p} / \pi$.) Ans. $10 \mathrm{~mA} ; 3.18 \mathrm{~V}$
# Example 4.1 

Figure 4.4(a) shows a circuit for charging a 12-V battery. If $v_{S}$ is a sinusoid with 24-V peak amplitude, find the fraction of each cycle during which the diode conducts. Also, find the peak value of the diode current and the maximum reverse-bias voltage that appears across the diode.

(a)

(b)

Figure 4.4 Circuit and waveforms for Example 4.1.

## Solution

The diode conducts when $v_{S}$ exceeds 12 V , as shown in Fig. 4.4(b). The conduction angle is $2 \theta$, where $\theta$ is given by

$$
24 \cos \theta=12
$$

Thus $\theta=60^{\circ}$ and the conduction angle is $120^{\circ}$, or one-third of a cycle.
The peak value of the diode current is given by

$$
I_{d}=\frac{24-12}{100}=0.12 \mathrm{~A}
$$

The maximum reverse voltage across the diode occurs when $v_{S}$ is at its negative peak and is equal to $24+12=36 \mathrm{~V}$

### 4.1.3 Another Application: Diode Logic Gates

Diodes together with resistors can be used to implement digital logic functions. Figure 4.5 shows two diode logic gates. To see how these circuits function, consider a positive-logic system in which voltage values close to 0 V correspond to logic 0 (or low) and voltage values close to +5 V correspond to logic 1 (or high). The circuit in Fig. 4.5(a) has three inputs, $v_{A}$, $v_{B}$, and $v_{C}$. It is easy to see that diodes connected to $+5-\mathrm{V}$ inputs will conduct, thus clamping the output $v_{Y}$ to a value equal to +5 V . This positive voltage at the output will keep the diodes whose inputs are low (around 0 V ) cut off. Thus the output will be high if one or more of the inputs are high. The circuit therefore implements the logic OR function, which in Boolean

(a)

(b)

Figure 4.5 Diode logic gates: (a) OR gate; (b) AND gate (in a positive-logic system).
notation is expressed as

$$
Y=A+B+C
$$

Similarly, the reader is encouraged to show that using the same logic system mentioned above, the circuit of Fig. 4.5(b) implements the logic AND function,

$$
Y=A \cdot B \cdot C
$$

# Example 4.2 

Assuming the diodes to be ideal, find the values of $I$ and $V$ in the circuits of Fig. 4.6.

(a)

(b)

Figure 4.6 Circuits for Example 4.2.# New to the Seventh Edition 

While maintaining the philosophy and pedagogical approach of the first six editions, several changes have been made to both organization and coverage. Our goal in making structural changes has been to increase modularity and thus flexibility for the instructor, without causing disturbance to courses currently using the sixth edition. Changes in coverage are necessitated by the continuing advances in technology which make some topics of greater relevance and others of less interest. As well, advances in IC process technology require that the numbers used in the examples, exercises and end-of-chapter problems be updated to reflect the parameters of newer generations of IC technologies (e.g., some problems utilize the parameters of the $65-\mathrm{nm}$ CMOS process). This ensures that students are acquiring a real-world perspective on technology.

To improve presentation, a number of chapters and sections have been rewritten for greater clarity. Specific, noteworthy changes are:

1. New End-of-Chapter Problems and a New Instructor's Solutions Manual. The number of the end-of-chapter problems has increased by about 50 . Of the resulting 1532 problems, 176 are entirely new and 790 have new data. The new Instructor's Solutions Manual is written by Adel Sedra.
2. Expand-Your-Perspective Notes. This is a new feature providing historical and application perspectives. About two such notes are included in each chapter. Most are focused on notable circuit engineers and key inventions.
3. Greater Flexibility in Presenting the MOSFET and the BJT. Two short and completely parallel chapters present the MOSFET (Chapter 5) and the BJT (Chapter 6). Here the focus is on the device structure and its physical operation, its current-voltage characteristics, and its application in dc circuits. The order of coverage of these two chapters is entirely at the instructor's discretion as they have been written to be completely independent of each other.
4. A Unified Treatment of Transistor Amplifiers. The heart of a first course in electronics is the study of transistor amplifiers. The seventh edition provides a new approach to this subject: A new Chapter 7 begins with the basic principles that underlie the operation of a transistor of either type as an amplifier, and presents such concepts as small-signal operation and modeling. This is followed by the classical configurations of transistor amplifiers, biasing methods, and practical discrete-circuit amplifiers. The combined presentation emphasizes the unity of the basic principles while allowing for separate treatment of the two device types where this is warranted. Very importantly, we are able to compare the two devices and to draw conclusions about their unique areas of application.
5. Improved Presentation of Cascoding. Chapter 8 dealing with the basic building blocks of IC amplifiers has been rewritten to improve presentation. Specifically, the development of cascoding and the key circuit building blocks, the cascode amplifier and the cascode current source, is now much clearer.
6. Clearer and Simplified Study of Feedback. The feedback chapter has been rewritten to improve, simplify and clarify the presentation of this key subject.
7. Streamlined Presentation of Frequency Response. While keeping the treatment of frequency response all together, the chapter has been rewritten to streamline its flow, and simplify and clarify the presentation.
8. Updated Treatment of Output Stages and Power Amplifiers. Here, we have updated the material on MOS power transistors and added a new section on the increasingly important class-D switching power amplifier.
9. A More Contemporary Approach to Operational Amplifier Circuits. While maintaining coverage of some of the enduring features and subcircuits of the classical 741 op amp, its total coverage is somewhat reduced to make room for modern IC op amp design techniques.
10. Better Organized and Modernized Coverage of Digital IC Design. Significant improvements have been made to the brief but comprehensive coverage of digital IC design in Part III. These include a better motivated study of CMOS logic circuits (Chapter 14) which now begins with logic gate circuits. The material on logic circuit technologies and design methodologies as well as the advanced topic of technology scaling and its implications have been moved to Chapter 15. This modularly structured chapter now deals with a selection of advanced and somewhat specialized topics. Since bipolar is hardly ever used in new digital design, coverage of ECL has been significantly reduced. Similarly, BiCMOS has become somewhat of a specialty topic and its coverage has been correspondingly reduced. Nevertheless, the complete material on both ECL and BiCMOS is now available on the book's website. Finally, we have added a new section on image sensors to Chapter 16 (Memory Circuits).
11. Increased Emphasis on Integrated-Circuit Filters and Oscillators. A section on a popular approach to integrated-circuit filter design, namely, Transconductance-C filters, has been added to Chapter 17. To make room for this new material, the subsection on stagger-tuned amplifiers has been removed and placed in Appendix H, on the website. The cross-coupled LC oscillator, popular in IC design, has been added to Chapter 18. The section on precision diode circuits has been removed but is still made available on the website.
12. A Useful and Insightful Comparison of the MOSFET and the BJT. This is now included in Appendix G, available on the website.

# The Book's Website 

A Companion Website for the book has been set up at www.oup.com/us/sedrasmith. Its content will change frequently to reflect new developments. The following material is available on the website:

1. Data sheets for hundreds of useful devices to help in laboratory experiments as well as in design projects.
2. Links to industrial and academic websites of interest.
3. A message center to communicate with the authors and with Oxford University Press.
4. Links to the student versions of both Cadence PSpice ${ }^{\circledR}$ and National Instruments Multisim ${ }^{\mathrm{TM}}$.
5. The input files for all the PSpice ${ }^{\circledR}$ and Multisim ${ }^{\mathrm{TM}}$ examples of Appendix B.
6. Step-by-step guidance to help with the simulation examples and the end-of-chapter problems identified with a SIM icon.
7. Bonus text material of specialized topics which are either not covered or covered briefly in the current edition of the textbook. These include:

- Junction Field-Effect Transistors (JFETs)
- Gallium Arsenide (GaAs) Devices and Circuits
- Transistor-Transistor Logic (TTL) Circuits
- Emitter-Coupled Logic (ECL) Circuits
- BiCMOS Circuits
- Precision Rectifier Circuits

8. Appendices for the Book:

- Appendix A: VLSI Fabrication Technology
- Appendix B: SPICE Device Models and Design and Simulation Examples Using PSpice ${ }^{\circledR}$ and Multisim ${ }^{\mathrm{TM}}$
- Appendix C: Two-Port Network Parameters
- Appendix D: Some Useful Network Theorems
- Appendix E: Single-Time-Constant Circuits
- Appendix F: $s$-domain Analysis: Poles, Zeros, and Bode Plots
- Appendix G: Comparison of the MOSFET and the BJT
- Appendix H: Design of Stagger-Tuned Amplifiers
- Appendix I: Bibliography
- Appendix L: Answers to Selected Problems


# Exercises and End-of-Chapter Problems 

Over 475 Exercises are integrated throughout the text. The answer to each exercise is given below the exercise so students can check their understanding of the material as they read. Solving these exercises should enable the reader to gauge his or her grasp of the preceding material. In addition, more than 1530 end-of-chapter Problems, $65 \%$ of which are new or revised in this edition, are provided. The problems are keyed to the individual chapter sections and their degree of difficulty is indicated by a rating system: difficult problems are marked with an asterisk (*); more difficult problems with two asterisks (**); and very difficult (and/or time consuming) problems with three asterisks $\left({ }^{* * *}\right)$. We must admit, however, that this classification is by no means exact. Our rating no doubt depended to some degree on our thinking (and mood!) at the time a particular problem was created. Answers to sample problems are given in Appendix L (on the website), so students have a checkpoint to tell if they are working out the problems correctly. Complete solutions for all exercises and problems are included in the Instructor's Solutions Manual, which is available from the publisher to those instructors who adopt the book.

As in the previous six editions, many examples are included. The examples, and indeed most of the problems and exercises, are based on real circuits and anticipate the applications encountered in designing real-life circuits. This edition continues the use of numbered solution steps in the figures for many examples, as an attempt to recreate the dynamics of the classroom.

## Course Organization

The book contains sufficient material for a sequence of two single-semester courses, each of 40-50 lecture hours. The modular organization of the book provides considerable flexibility for course design. In the following, we suggest content for a sequence of two classical or standard courses. We also describe some variations on the content of these two courses and specify supplemental material for a possible third course.

## The First Course

The first course is based on Part I of the book, that is, Chapters 1-7. It can be taught, most simply by starting at the beginning of Chapter 1 and concluding with the end of Chapter 7. However, as guidance to instructors who wish to follow a different order of presentation or a somewhat modified coverage, or to deal with situations where time might be constrained, we offer the following remarks:

The core of the first course is the study of the two transistor types, Chapters 5 and 6, in whatever order the instructor wishes, and transistor amplifiers in Chapter 7. These three chapters must be covered in full.

Another important part of the first course is the study of diodes (Chapter 4). Here, however, if time does not permit, some of the applications in the later part of the chapter can be skipped.

We have found it highly motivational to cover op amps (Chapter 2) near the beginning of the course. This provides the students with the opportunity to work with a practical integrated circuit and to experiment with non-trivial circuits.

Coverage of Chapter 1, at least of the amplifier sections, should prove helpful. Here the sections on signals can be either covered in class or assigned as reading material. Section 1.6 on frequency response is needed if the frequency-response of op-amp circuits is to be studied; otherwise this section can be delayed to the second course.
Finally, if the students have not taken a course on physical electronics, Chapter 3 needs to be covered. Otherwise, it can be used as review material or skipped altogether.

# The Second Course 

The main subject of the second course is integrated-circuit amplifiers and is based on Part II of the book, that is, Chapters 8-13. Here also, the course can be taught most simply by beginning with Chapter 8 and concluding with Chapter 13. However, this being a second course, considerable flexibility in coverage is possible to satisfy particular curriculum designs and/or to deal with time constraints.

First, however, we note that the core material is presented in Chapters 8-11 and these four chapters must be covered, though not necessarily in their entirety. For instance, some of the sections near the end of a chapter and identified by the "advanced material" icon can be skipped, usually with no loss of continuity.

Beyond the required chapters, (8-11), the instructor has many possibilities for the remainder of the course. These include one or both of the two remaining chapters in Part II, namely, Output Stages and Power Amplifier (Chapter 12), and Op-Amp Circuits (Chapter 13).

Another possibility, is to include an introduction to digital integrated circuits by covering Chapter 14 , and if time permits, selected topics of Chapters 15 and 16.

Yet another possibility for the remainder of the second course is selected topics from the filters chapter (17) and/or the oscillators chapter (18).

## A Digitally Oriented First Course

A digitally-oriented first course can include the following: Chapter 1 (without Section 1.6), Chapter 2, Chapter 3 (if the students have not had any exposure to physical electronics), Chapter 4 (perhaps without some of the later applications sections), Chapter 5, selected topics from Chapter 7 emphasizing the basics of the application of the MOSFET as an amplifier, Chapter 14, and selected topics from Chapters 15 and 16. Such a course would be particularly suited for Computer Engineering students.

## Supplemental Material/Third Course

Depending on the selection of topics for the first and second courses, some material will remain and can be used for part of a third course or as supplemental material to support student design projects. These can include Chapter 12 (Output Stages and Power Amplifiers), Chapter 13 (Op-Amp Circuits), Chapter 17 (Filters) and Chapter 18 (Oscillators), which can be used to support a third course on analog circuits. These can also include Chapters 14, 15 and 16 which can be used for a portion of a senior-level course on digital IC design.

## The Accompanying Laboratory

Courses in electronic circuits are usually accompanied by laboratory experiments. To support the laboratory component for courses using this book, Professor Vincent Gaudet of the University of Waterloo has, in collaboration with K.C. Smith, authored a laboratory manual. Laboratory Explorations, together with an Instructor's Manual, is available from Oxford University Press.

Another innovative laboratory instruction system, designed to accompany this book, has been recently developed. Specifically, Illuster Technologies Inc. has developed a digitally controlled lab platform, AELabs. The platform is realized on printed circuit boards using surface mount devices. A wide variety of circuits can be configured on this platform through a custom graphical user interface. This allows students to conduct many experiments relatively quickly. More information is available from Illuster (see link on the Companion Website).
# An Outline for the Reader 

Part I, Devices and Basic Circuits, includes the most fundamental and essential topics for the study of electronic circuits. At the same time, it constitutes a complete package for a first course on the subject.

Chapter 1. The book starts with an introduction to the basic concepts of electronics in Chapter 1. Signals, their frequency spectra, and their analog and digital forms are presented. Amplifiers are introduced as circuit building blocks and their various types and models are studied. This chapter also establishes some of the terminology and conventions used throughout the text.

Chapter 2. Chapter 2 deals with operational amplifiers, their terminal characteristics, simple applications, and practical limitations. We chose to discuss the op amp as a circuit building block at this early stage simply because it is easy to deal with and because the student can experiment with op-amp circuits that perform nontrivial tasks with relative ease and with a sense of accomplishment. We have found this approach to be highly motivating to the student. We should point out, however, that part or all of this chapter can be skipped and studied at a later stage (for instance, in conjunction with Chapter 9, Chapter 11, and/or Chapter 13) with no loss of continuity.

Chapter 3. Chapter 3 provides an overview of semiconductor concepts at a level sufficient for understanding the operation of diodes and transistors in later chapters. Coverage of this material is useful in particular for students who have had no prior exposure to device physics. Even those with such a background would find a review of Chapter 3 beneficial as a refresher. The instructor can choose to cover this material in class or assign it for outside reading.

Chapter 4. The first electronic device, the diode, is studied in Chapter 4. The diode terminal characteristics, the circuit models that are used to represent it, and its circuit applications are presented. Depending on the time available in the course, some of the diode applications (e.g. Section 4.6) can be skipped. Also, the brief description of special diode types (Section 4.7) can be left for the student to read.

Chapters 5 and 6. The foundation of electronic circuits is established by the study of the two transistor types in use today: the MOS transistor in Chapter 5 and the bipolar transistor in Chapter 6. These two chapters have been written to be completely independent of one another and thus can be studied in either order, as desired. Furthermore, the two chapters have the same structure, making it easier and faster to study the second device, as well as to draw comparisons between the two device types.

Each of Chapters 5 and 6 begins with a study of the device structure and its physical operation, leading to a description of its terminal characteristics. Then, to allow the student to become very familiar with the operation of the transistor as a circuit element, a large number of examples are presented of dc circuits utilizing the device. The last section of each of Chapters 5 and 6 deals with second-order effects that are included for completeness, but that can be skipped if time does not permit detailed coverage.

Chapter 7. The heart of a first course in electronics is the study of transistor amplifiers. Chapter 7 (new to this edition) presents a unified treatment of the subject. It begins with the basic principles that underlie the operation of a transistor, of either type, as an amplifier, and proceeds to present the important concepts of small-signal operation and modeling. This is followed by a study of the basic configurations of single-transistor amplifiers. After a presentation of dc biasing methods, the chapter concludes with practical examples of discrete-circuit amplifiers. The combined presentation emphasizes the unity of the basic principles while allowing for separate treatment of the two device types where this is warranted. Very importantly, we are able to compare the two devices and to draw conclusions about their unique areas of application.

After the study of Part I, the reader will be fully prepared to study either integrated-circuit amplifiers in Part II, or digital integrated circuits in Part III.

Part II, Integrated-Circuit Amplifiers, is devoted to the study of practical amplifier circuits that can be fabricated in the integrated-circuit (IC) form. Its six chapters constitute a coherent treatment of IC amplifier design and can thus serve as a second course in electronic circuits.

MOS and Bipolar. Throughout Part II, both MOS and bipolar circuits are presented side-by-side. Because the MOSFET is by far the dominant device, its circuits are presented first. Bipolar circuits are discussed to the same depth but occasionally more briefly.
Chapter 8. Beginning with a brief introduction to the philosophy of IC design, Chapter 8 presents the basic circuit building blocks that are used in the design of IC amplifiers. These include current mirrors, current sources, gain cells, and cascode amplifiers.

Chapter 9. The most important IC building block, the differential pair, is the main topic of Chapter 9. The last section of Chapter 9 is devoted to the study of multistage amplifiers.

Chapter 10. Chapter 10 presents a comprehensive treatment of the important subject of amplifier frequency response. Here, Sections 10.1, 10.2, and 10.3 contain essential material; Section 10.4 provides an in-depth treatment of very useful new tools; and Sections 10.5 to 10.8 present the frequency response analysis of a variety of amplifier configurations that can be studied as and when needed. A selection of the latter sections can be made depending on the time available and the instructor's preference.

Chapter 11. The fourth of the essential topics of Part II, feedback, is the subject of Chapter 11. Both the theory of negative feedback and its application in the design of practical feedback amplifiers are presented. We also discuss the stability problem in feedback amplifiers and treat frequency compensation in some detail.

Chapter 12. In Chapter 12 we switch gears from dealing with small-signal amplifiers to those that are required to handle large signals and large amounts of power. Here we study the different amplifier classes-A, B, and AB - and their realization in bipolar and CMOS technologies. We also consider power BJTs and power MOSFETs, and study representative IC power amplifiers. A brief study of the increasingly popular Class D amplifier is also presented. Depending on the availability of time, some of the later sections can be skipped in a first reading.

Chapter 13. Finally, Chapter 13 brings together all the topics of Part II in an important application; namely, the design of operational amplifier circuits. We study both CMOS and bipolar op amps. In the latter category, besides the classical and still timely 741 circuit, we present modern techniques for the design of low-voltage op amps (Section 13.4).

Part III, Digital Integrated Circuits, provides a brief but nonetheless comprehensive and sufficiently detailed study of digital IC design. Our treatment is almost self-contained, requiring for the most part only a thorough understanding of the MOSFET material presented in Chapter 5. Thus, Part III can be studied right after Chapter 5. The only exceptions to this are the last section in Chapter 15 which requires knowledge of the BJT (Chapter 6). Also, knowledge of the MOSFET internal capacitances (Section 10.2.2) will be needed.

Chapter 14. Chapter 14 is the foundation of Part III. It begins with the motivating topic of CMOS logic-gate circuits. Then, following a detailed study of digital logic inverters, we concentrate on the CMOS inverter; its static and dynamic characteristics and its design. Transistor sizing and power dissipation round out the topics of Chapter 14. The material covered in this chapter is the minimum needed to learn something meaningful about digital circuits.

Chapter 15. Chapter 15 has a modular structure and presents six topics of somewhat advanced nature. It begins with a presentation of Moore's law and the technology scaling that has made the multi-billion-transistor chip possible. This is followed by an overview of digital IC technologies, and the design methodologies that make the design of super-complex digital ICs possible. Four different logic-circuit types are then presented. Only the last of these includes bipolar transistors.

Chapter 16. Digital circuits can be broadly divided into logic and memory circuits. The latter is the subject of Chapter 16.

Part IV, Filters and Oscillators, is intentionally oriented toward applications and systems. The two topics illustrate powerfully and dramatically the application of both negative and positive feedback.

Chapter 17. Chapter 17 deals with the design of filters, which are important building blocks of communication and instrumentation systems. A comprehensive, design-oriented treatment of the subject is presented. The material provided should allow the reader to perform a complete filter design, starting from specification and ending with a complete circuit realization. A wealth of design tables is included.

Chapter 18. Chapter 18 deals with circuits for the generation of signals with a variety of waveforms: sinusoidal, square, and triangular. We also present circuits for the nonlinear shaping of waveforms.
Appendices. The twelve appendices contain much useful background and supplementary material. We wish to draw the reader's attention in particular to the first two: Appendix A provides a concise introduction to the important topic of IC fabrication technology including IC layout. Appendix B provides SPICE device models as well as a large number of design and simulation examples in PSpice ${ }^{\circledR}$ and Multisim ${ }^{\mathrm{TM}}$. The examples are keyed to the book chapters. These Appendices and a great deal more material on these simulation examples can be found on the Companion Website.

# Ancillaries 

A complete set of ancillary materials is available with this text to support your course.

## For the Instructor

The Ancillary Resource Center (ARC) at www.oup-arc.com/sedrasmith is a convenient destination for all the instructor resources that accompany Microelectronic Circuits. Accessed online through individual user accounts, the ARC provides instructors with access to up-to-date ancillaries at any time while guaranteeing the security of grade-significant resources. The ARC replaces the Instructor's Resource CD that accompanied the sixth edition. On the ARC, you will find:

- An electronic version of the Instructor's Solutions Manual.
- PowerPoint-based figure slides that feature all the images and summary tables from the text, with their captions, so they can easily be displayed and explained in class.
- Detailed instructor's support for the SPICE circuit simulations in Multisim ${ }^{\mathrm{TM}}$ and PSpice ${ }^{\circledR}$.

The Instructor's Solutions Manual (ISBN 978-0-19-933915-0), written by Adel Sedra, contains detailed solutions to all in-text exercises and end-of-chapter problems found in Microelectronic Circuits. The Instructor's Solutions Manual for Laboratory Explorations to Accompany Microelectronic Circuits (ISBN 978-0-19-933926-6) contains detailed solutions to all the exercises and problems found in this student's laboratory guide.

## For the Student and Instructor

A Companion Website at www.oup.com/us/sedrasmith features permanently cached versions of device datasheets, so students can design their own circuits in class. The website also contains SPICE circuit simulation examples and lessons. Bonus text topics and the Appendices are also featured on the website.

The Laboratory Explorations to Accompany Microelectronic Circuits (ISBN 978-0-19-933925-9) invites students to explore the realm of real-world engineering through practical, hands-on experiments. Keyed to sections in the text and taking a "learn-by-doing" approach, it presents labs that focus on the development of practical engineering skills and design practices.

## Acknowledgments

Many of the changes in this seventh edition were made in response to feedback received from instructors who adopted the sixth edition. We are grateful to all those who took the time to write to us. In addition, many of the reviewers provided detailed commentary on the sixth edition and suggested a number of the changes that we have incorporated in this edition. They are listed later; to all of them, we extend our sincere thanks. Adel Sedra is also grateful for the feedback received from the students who have taken his electronics courses over the past number of years at the University of Waterloo.
A number of individuals made significant contributions to this edition. Vincent Gaudet of the University of Waterloo contributed to Part III as well as co-authoring the laboratory manual. WaiTung Ng of the University of Toronto contributed to Chapter 12 and updated Appendix A (of which he is the original author). Muhammad Faisal of the University of Michigan updated Appendix B, which he helped create for the sixth edition; helped in obtaining the cover photo, and has over a number of years been the source of many good ideas. Olivier Trescases and his students at the University of Toronto pioneered the laboratory system described elsewhere in the Preface. Jennifer Rodrigues typed all the revisions, as she did for a number of the previous editions, with tremendous skill and good humour. Chris Schroeder was of great assistance to Adel Sedra with local logistics. Laura Fujino assisted in many ways and in particular with the "Expand-Your-Perspective" notes. To all of these friends and colleagues we say thank you.

Over the recent years we have benefited greatly from discussions with a number of colleagues and friends. In particular we are very grateful to the following: James Barby, University of Waterloo; David Nairn, University of Waterloo; Anthony Chan Carusone, University of Toronto; David Johns, University of Toronto; Ken Martin, University of Toronto; Khoman Phang, University of Toronto; Gordon Roberts, McGill University; Ali Sheikholeslami, University of Toronto; and Amir Yazdani, Ryerson University.

The cover photograph shows a 3D IC system, which demonstrates the concept of wireless power delivery and communication through multiple layers of CMOS chips. The communication circuits were demonstrated in an IBM 45 nm SOI CMOS process. This technology is designed to serve a multi-Gb/s interconnect between cores spread across several IC layers for high-performance processors. We are grateful to Professor David Wentzloff, Director of the Wireless Integrated Circuits Group at the University of Michigan, who allowed us to use this image, and to Muhammad Faisal, Founder of Movellus Circuits Incorporated, who edited the image.

A large number of people at Oxford University Press contributed to the development of this edition and its various ancillaries. We would like to specifically mention Marketing Manager David Jurman, Marketing Director Frank Mortimer, Higher Ed Sales Director Bill Marting, Copywriter Kristin Maffei, Art Director Michele Laseau, Production Manager Lisa Grzan, Team Leader Amy Whitmer, and Senior Production Editor Jane Lee.

We wish to extend special thanks to our Publisher at Oxford University Press, John Challice, and the Editorial Director, Patrick Lynch. Both have always shown great interest in this book and have provided considerable guidance and support throughout the process of preparing this edition. The Senior Acquisitions Editor, Nancy Blaine, and Associate Editor, Christine Mahon, have done a truly outstanding job. It has been a pleasure to work with both of them, both as professionals and as highly thoughtful individuals; we owe them much gratitude. On the production side, Barbara Mathieu, Senior Production Editor, has been superb: her attention to detail and emphasis on quality is without par.

Finally, we wish to thank our families for their support and understanding, and to thank all the students and instructors who have valued this book throughout its history.

Adel S. Sedra
Kenneth C. (KC) Smith
Waterloo, Ontario, Canada
August 2014
## Reviewers of Seventh Edition

Junseok Chae, Arizona State University, Tempe, AZ
Liang Dong, Baylor University, Waco, TX
Muhammad Faisal, University of Michigan, Ann Arbor, MI
Patrick Fay, University of Notre Dame, Notre Dame, IN
Vincent Gaudet, University of Waterloo, Waterloo, Canada
Elmer A Grubbs, Northern Arizona University, Flagstaff, AZ
Serhiy Levkov, New Jersey Institute of Technology, Newark, NJ
Leda Lunardi, North Carolina State University, Raleigh, NC
Phyllis R. Nelson, California State Polytechnic University, Pomona, CA
Robert W. Newcomb, University of Maryland, College Park, MD
Toshikazu Nishida, University of Florida, Gainesville, FL
Matthew Swabey, Purdue University, West Lafayette, IN
Khalid Hasan Tantawi, University of Alabama, Huntsville, AL
Farid M. Tranjan, University of North Carolina, Charlotte, NC
Mustapha C.E. Yagoub, University of Ottawa, Ottawa, Canada
Justin Jackson, Weber State University, Ogden, UT
John Mankowski, Texas Tech University, Lubbock, TX
Chris Mi, University of Michigan, Dearborn, MI

## Reviewers of Prior Editions

Maurice Aburdene, Bucknell University, Lewisburg, PA
Michael Bartz, University of Memphis, TN
Elizabeth Brauer, Northern Arizona University, Flagstaff, AZ
Martin Brooke, Duke University, Durham, NC
Patrick L. Chapman, University of Illinois, Urbana-
Champaign, IL
Yun Chiu, University of Illinois, Urbana-Champaign, IL
Roy H. Cornely, New Jersey Institute of Technology, Newark, NJ
Norman Cox, Missouri University of Science and Technology, Rolla, MO
Dale L. Critchlow, University of Vermont, Burlingon, VT
Robert Bruce Darling, University of Washington, Seattle, WA
Artice Davis, San Jose State University, CA
John Davis, University of Texas, Austin, TX
Christopher DeMarco, University of Wisconsin, Madison, WI
Robert Engelken, Arkansas State University, Jonesboro, AR
Ethan Farquhar, University of Tennessee, Knoxville, TN
Eby G. Friedman, University of Rochester, NY
Paul M. Furth, New Mexico State University, Las Cruces, NM
Rhett T. George, Jr., Duke University, Durham, NC
Roobik Gharabagi, St. Louis University, MO
George Giakos, University of Akron, OH
John Gilmer, Wilkes University, Wilkes-Barre, PA
Michael Green, University of California, Irvine, CA
Steven de Haas, California State University, Sacramento, CA
Anas Hamoui, McGill University, Montreal, Canada
Reza Hashemian, Northern Illinois University, DeKalb, IL
William Harrell, Clemson University, SC
Reid Harrison, University of Utah, Salt Lake City, UT
Ward J. Helms, University of Washington, Seattle, WA
Richard Hornsey, York University, Toronto, Canada
Timothy Horiuchi, University of Maryland, College Park, MD

Hsiung Hsu, The Ohio State University, Columbus, OH
Robert Irvine, California State Polytechnic University, Pomona, CA
Mohammed Ismail, The Ohio State University, Columbus, OH
Paul Israelsen, Utah State University, Logan UT
Steve Jantzi, Broadcom, CA
Zhenhua Jiang, University of Miami, FL
Marian Kazimierczuk, Wright State University, Dayton, OH
John Khoury, Columbia University, New York, NY
Jacob B. Khurgin, The Johns Hopkins University, Baltimore, MD
Seongsin M. Kim, University of Alabama, Tuscaloosa, AL
Roger King, University of Toledo, OH
Clark Kinnaird, Southern Methodist University, Dallas, TX
Robert J. Krueger, University of Wisconsin, Milwaukee, WI
Joy Laskar, Georgia Institute of Technology, Atlanta, GA
Tsu-Jae King Liu, University of California, Berkeley, CA
Yicheng Lu, Rutgers University, Piscataway, NJ
David Luke, University of New Brunswick, Fredericton, Canada
Thomas Matthews, California State University, Sacramento, CA
Un-Ku Moon, Oregon State University, Corvallis, OR
Bahram Nabet, Drexel University, Philadelphia, PA
Dipankar Nagchoudhuri, Indian Institute of Technology, Delhi, India
David Nairn, University of Waterloo, Waterloo, Canada
Joseph H. Nevin, University of Cincinnati, OH
Ken Noren, University of Idaho, Moscow, ID
Brita Olson, California Polytechnic University, Pomona, CA
Martin Peckerar, University of Maryland, College Park, MD
Khoman Phang, University of Toronto, Canada
Mahmudur Rahman, Santa Clara University, CA
Rabin Raut, Concordia University, Montreal, Canada
John A. Ringo, Washington State University, Pullman, WA
Zvi S. Roth, Florida Atlantic University, Boca Raton, FL
Mulukutla Sarma, Northeastern University, Boston, MA
John Scalzo, Louisiana State University, Baton Rouge, LA
Norman Scheinberg, City College, New York, NY
Pierre Schmidt, Florida International University, Miami, FL
Richard Schreier, Analog Devices, Toronto, Canada
Dipankar Sengupta, Royal Melbourne Institute of Technology, Australia
Ali Sheikholeslami, University of Toronto, Canada
Kuang Sheng, Rutgers University, Piscataway, NJ
Michael L. Simpson, University of Tennessee, Knoxville, TN
Karl A. Spuhl, Washington University in St. Louis, MO
Charles Sullivan, Dartmouth College, Hanover, NH
Andrew Szeto, San Diego State University, CA
Joel Therrien, University of Massachusetts, Lowell, MA
Len Trombetta, University of Houston, TX
Daniel van der Weide, University of Delaware, Newark, DE
Gregory M. Wierzba, Michigan State University, East Lansing, MI
Donna Yu, North Carolina State University, Raleigh, NC
Jiann-Shiun Yuan, University of Central Florida, Orlando, FL
Sandra Yost, University of Detroit, Mercy, MI
Alex Zaslavsky, Brown University, Providence, RI
Jianhua (David) Zhang, University of Illinois, Urbana-
Champaign, IL
# Microelectronic Circuits# Example 4.2 continued 

## Solution

In these circuits it might not be obvious at first sight whether none, one, or both diodes are conducting. In such a case, we make a plausible assumption, proceed with the analysis, and then check whether we end up with a consistent solution. For the circuit in Fig. 4.6(a), we shall assume that both diodes are conducting. It follows that $V_{B}=0$ and $V=0$. The current through $D_{2}$ can now be determined from

$$
I_{D 2}=\frac{10-0}{10}=1 \mathrm{~mA}
$$

Writing a node equation at B,

$$
I+1=\frac{0-(-10)}{5}
$$

results in $I=1 \mathrm{~mA}$. Thus $D_{1}$ is conducting as originally assumed, and the final result is $I=1 \mathrm{~mA}$ and $V=0 \mathrm{~V}$.

For the circuit in Fig. 4.6(b), if we assume that both diodes are conducting, then $V_{B}=0$ and $V=0$. The current in $D_{2}$ is obtained from

$$
I_{D 2}=\frac{10-0}{5}=2 \mathrm{~mA}
$$

The node equation at B is

$$
I+2=\frac{0-(-10)}{10}
$$

which yields $I=-1 \mathrm{~mA}$. Since this is not possible, our original assumption is not correct. We start again, assuming that $D_{1}$ is off and $D_{2}$ is on. The current $I_{D 2}$ is given by

$$
I_{D 2}=\frac{10-(-10)}{15}=1.33 \mathrm{~mA}
$$

and the voltage at node B is

$$
V_{B}=-10+10 \times 1.33=+3.3 \mathrm{~V}
$$

Thus $D_{1}$ is reverse biased as assumed, and the final result is $I=0$ and $V=3.3 \mathrm{~V}$.
# EXERCISES 

4.4 Find the values of $I$ and $V$ in the circuits shown in Fig. E4.4.


Figure E4.4

Ans. (a) $2 \mathrm{~mA}, 0 \mathrm{~V}$; (b) $0 \mathrm{~mA}, 5 \mathrm{~V}$; (c) $0 \mathrm{~mA}, 5 \mathrm{~V}$; (d) $2 \mathrm{~mA}, 0 \mathrm{~V}$; (e) $3 \mathrm{~mA},+3 \mathrm{~V}$; (f) $4 \mathrm{~mA},+1 \mathrm{~V}$
4.5 Figure E4.5 shows a circuit for an ac voltmeter. It utilizes a moving-coil meter that gives a full-scale reading when the average current flowing through it is 1 mA . The moving-coil meter has a $50-\Omega$ resistance.


Figure E4.5

Find the value of $R$ that results in the meter indicating a full-scale reading when the input sine-wave voltage $v_{1}$ is 20 V peak-to-peak. (Hint: The average value of half-sine waves is $V_{p} / \pi$.)
Ans. $3.133 \mathrm{k} \Omega$

# 4.2 Terminal Characteristics of Junction Diodes 

The most common implementation of the diode utilizes a $p n$ junction. We have studied the physics of the $p n$ junction and derived its $i-v$ characteristic in Chapter 3. That the $p n$ junction is used to implement the diode function should come as no surprise: the $p n$ junction can conduct substantial current in the forward direction and almost no current in the reverse direction. In this section we study the $i-v$ characteristic of the $p n$ junction diode in detail in order to prepare ourselves for diode circuit applications.

Figure 4.7 shows the $i-v$ characteristic of a silicon junction diode. The same characteristic is shown in Fig. 4.8 with some scales expanded and others compressed to reveal details. Note that the scale changes have resulted in the apparent discontinuity at the origin.

As indicated, the characteristic curve consists of three distinct regions:

1. The forward-bias region, determined by $v>0$
2. The reverse-bias region, determined by $v<0$
3. The breakdown region, determined by $v<-V_{Z K}$

These three regions of operation are described in the following sections.

### 4.2.1 The Forward-Bias Region

The forward-bias-or simply forward-region of operation is entered when the terminal voltage $v$ is positive. In the forward region the $i-v$ relationship is closely approximated by

$$
i=I_{S}\left(e^{v / V_{T}}-1\right)
$$

In this equation ${ }^{1} I_{S}$ is a constant for a given diode at a given temperature. A formula for $I_{S}$ in terms of the diode's physical parameters and temperature was given in Eq. (3.41). The current

[^0]
[^0]:    ${ }^{1}$ Equation (4.1), the diode equation, is sometimes written to include a constant $n$ in the exponential,

    $$
    i=I_{S}\left(e^{v / n V_{T}}-1\right)
    $$

    with $n$ having a value between 1 and 2 , depending on the material and the physical structure of the diode. Diodes using the standard integrated-circuit fabrication process exhibit $n=1$ when operated under normal conditions. For simplicity, we shall use $n=1$ throughout this book, unless otherwise specified.


Figure 4.7 The $i-v$ characteristic of a silicon junction diode.


Figure 4.8 The diode $i-v$ relationship with some scales expanded and others compressed in order to reveal details.
$I_{S}$ is usually called the saturation current (for reasons that will become apparent shortly). Another name for $I_{S}$, and one that we will occasionally use, is the scale current. This name arises from the fact that $I_{S}$ is directly proportional to the cross-sectional area of the diode. Thus doubling of the junction area results in a diode with double the value of $I_{S}$ and, as the diode equation indicates, double the value of current $i$ for a given forward voltage $v$. For "small-signal" diodes, which are small-size diodes intended for low-power applications, $I_{S}$ is on the order of $10^{-15} \mathrm{~A}$. The value of $I_{S}$ is, however, a very strong function of temperature. As a rule of thumb, $I_{S}$ doubles in value for every $5^{\circ} \mathrm{C}$ rise in temperature.

The voltage $V_{T}$ in Eq. (4.1) is a constant called the thermal voltage and is given by

$$
V_{T}=\frac{k T}{q}
$$

where
$k=$ Boltzmann's constant $=8.62 \times 10^{-5} \mathrm{eV} / \mathrm{K}=1.38 \times 10^{-23}$ joules $/ \mathrm{kelvin}$
$T=$ the absolute temperature in kelvins $=273+$ temperature in ${ }^{\circ} \mathrm{C}$
$q=$ the magnitude of electronic charge $=1.60 \times 10^{-19}$ coulomb
Substituting $k=8.62 \times 10^{-5} \mathrm{eV} / \mathrm{K}$ into Eq. (4.2) gives

$$
V_{T}=0.0862 T, \mathrm{mV}
$$

Thus, at room temperature $\left(20^{\circ} \mathrm{C}\right)$ the value of $V_{T}$ is 25.3 mV . In rapid approximate circuit analysis we shall use $V_{T} \simeq 25 \mathrm{mV}$ at room temperature. ${ }^{2}$

For appreciable current $i$ in the forward direction, specifically for $i \gg I_{S}$, Eq. (4.1) can be approximated by the exponential relationship

$$
i \simeq I_{S} e^{v / V_{T}}
$$

This relationship can be expressed alternatively in the logarithmic form

$$
v=V_{T} \ln \frac{i}{I_{S}}
$$

where $\ln$ denotes the natural (base $e$ ) logarithm.
The exponential relationship of the current $i$ to the voltage $v$ holds over many decades of current (a span of as many as seven decades-i.e., a factor of $10^{7}$-can be found). This is quite a remarkable property of junction diodes, one that is also found in bipolar junction transistors and that has been exploited in many interesting applications.

Let us consider the forward $i-v$ relationship in Eq. (4.3) and evaluate the current $I_{1}$ corresponding to a diode voltage $V_{1}$ :

$$
I_{1}=I_{S} e^{V_{1} / V_{T}}
$$

Similarly, if the voltage is $V_{2}$, the diode current $I_{2}$ will be

$$
I_{2}=I_{S} e^{V_{2} / V_{T}}
$$

[^0]
[^0]:    ${ }^{2}$ A slightly higher ambient temperature $\left(25^{\circ} \mathrm{C}\right.$ or so) is usually assumed for electronic equipment operating inside a cabinet. At this temperature, $V_{T} \simeq 25.8 \mathrm{mV}$. Nevertheless, for the sake of simplicity and to promote rapid circuit analysis, we shall use the more arithmetically convenient value of $V_{T} \simeq 25 \mathrm{mV}$ throughout this book.
These two equations can be combined to produce

$$
\frac{I_{2}}{I_{1}}=e^{\left(V_{2}-V_{1}\right) / V_{T}}
$$

which can be rewritten as

$$
V_{2}-V_{1}=V_{T} \ln \frac{I_{2}}{I_{1}}
$$

or, in terms of base-10 logarithms,

$$
V_{2}-V_{1}=2.3 V_{T} \log \frac{I_{2}}{I_{1}}
$$

This equation simply states that for a decade (factor of 10) change in current, the diode voltage drop changes by $2.3 V_{T}$, which is approximately 60 mV . This also suggests that the diode $i-v$ relationship is most conveniently plotted on semilog paper. Using the vertical, linear axis for $v$ and the horizontal, $\log$ axis for $i$, one obtains a straight line with a slope of 60 mV per decade of current.

A glance at the $i-v$ characteristic in the forward region (Fig. 4.8) reveals that the current is negligibly small for $v$ smaller than about 0.5 V . This value is usually referred to as the cut-in voltage. It should be emphasized, however, that this apparent threshold in the characteristic is simply a consequence of the exponential relationship. Another consequence of this relationship is the rapid increase of $i$. Thus, for a "fully conducting" diode, the voltage drop lies in a narrow range, approximately 0.6 V to 0.8 V . This gives rise to a simple "model" for the diode where it is assumed that a conducting diode has approximately a $0.7-\mathrm{V}$ drop across it. Diodes with different current ratings (i.e., different areas and correspondingly different $I_{S}$ ) will exhibit the $0.7-\mathrm{V}$ drop at different currents. For instance, a small-signal diode may be considered to have a $0.7-\mathrm{V}$ drop at $i=1 \mathrm{~mA}$, while a higher-power diode may have a $0.7-\mathrm{V}$ drop at $i=1 \mathrm{~A}$. We will study the topics of diode-circuit analysis and diode models in the next section.

# Example 4.3 

A silicon diode said to be a $1-\mathrm{mA}$ device displays a forward voltage of 0.7 V at a current of 1 mA . Evaluate the junction scaling constant $I_{S}$. What scaling constants would apply for a 1-A diode of the same manufacture that conducts 1 A at 0.7 V ?

## Solution

Since

$$
i=I_{S} e^{v / V_{T}}
$$

then

$$
I_{S}=i e^{-v / V_{T}}
$$
# Example 4.3 continued 

For the 1-mA diode:

$$
I_{S}=10^{-3} e^{-706 / 25}=6.9 \times 10^{-16} \mathrm{~A}
$$

The diode conducting 1 A at 0.7 V corresponds to one-thousand 1-mA diodes in parallel with a total junction area 1000 times greater. Thus $I_{S}$ is also 1000 times greater,

$$
I_{S}=6.9 \times 10^{-13} \mathrm{~A}
$$

Since both $I_{S}$ and $V_{T}$ are functions of temperature, the forward $i-v$ characteristic varies with temperature, as illustrated in Fig. 4.9. At a given constant diode current, the voltage drop across the diode decreases by approximately 2 mV for every $1^{\circ} \mathrm{C}$ increase in temperature. The change in diode voltage with temperature has been exploited in the design of electronic thermometers.


Figure 4.9 Temperature dependence of the diode forward characteristic. At a constant current, the voltage drop decreases by approximately 2 mV for every $1^{\circ} \mathrm{C}$ increase in temperature.

## EXERCISES

4.6 Find the change in diode voltage if the current changes from 0.1 mA to 10 mA . Ans. 120 mV
4.7 A silicon junction diode has $v=0.7 \mathrm{~V}$ at $i=1 \mathrm{~mA}$. Find the voltage drop at $i=0.1 \mathrm{~mA}$ and $i=10 \mathrm{~mA}$. Ans. $0.64 \mathrm{~V} ; 0.76 \mathrm{~V}$
4.8 Using the fact that a silicon diode has $I_{S}=10^{-14} \mathrm{~A}$ at $25^{\circ} \mathrm{C}$ and that $I_{S}$ increases by $15 \%$ per ${ }^{\circ} \mathrm{C}$ rise in temperature, find the value of $I_{S}$ at $125^{\circ} \mathrm{C}$.
Ans. $1.17 \times 10^{-8} \mathrm{~A}$
# 4.2.2 The Reverse-Bias Region 

The reverse-bias region of operation is entered when the diode voltage $v$ is made negative. Equation (4.1) predicts that if $v$ is negative and a few times larger than $V_{T}(25 \mathrm{mV})$ in magnitude, the exponential term becomes negligibly small compared to unity, and the diode current becomes

$$
i \simeq-I_{S}
$$

That is, the current in the reverse direction is constant and equal to $I_{S}$. This constancy is the reason behind the term saturation current.

Real diodes exhibit reverse currents that, though quite small, are much larger than $I_{S}$. For instance, a small-signal diode whose $I_{S}$ is on the order of $10^{-14} \mathrm{~A}$ to $10^{-15} \mathrm{~A}$ could show a reverse current on the order of 1 nA . The reverse current also increases somewhat with the increase in magnitude of the reverse voltage. Note that because of the very small magnitude of the current, these details are not clearly evident on the diode $i-v$ characteristic of Fig. 4.8.

A large part of the reverse current is due to leakage effects. These leakage currents are proportional to the junction area, just as $I_{S}$ is. Their dependence on temperature, however, is different from that of $I_{S}$. Thus, whereas $I_{S}$ doubles for every $5^{\circ} \mathrm{C}$ rise in temperature, the corresponding rule of thumb for the temperature dependence of the reverse current is that it doubles for every $10^{\circ} \mathrm{C}$ rise in temperature.

## EXERCISE

4.9 The diode in the circuit of Fig. E4.9 is a large high-current device whose reverse leakage is reasonably independent of voltage. If $V=1 \mathrm{~V}$ at $20^{\circ} \mathrm{C}$, find the value of $V$ at $40^{\circ} \mathrm{C}$ and at $0^{\circ} \mathrm{C}$.


Figure E4.9

Ans. $4 \mathrm{~V} ; 0.25 \mathrm{~V}$
# 4.2.3 The Breakdown Region 

The third distinct region of diode operation is the breakdown region, which can be easily identified on the diode $i-v$ characteristic in Fig. 4.8. The breakdown region is entered when the magnitude of the reverse voltage exceeds a threshold value that is specific to the particular diode, called the breakdown voltage. This is the voltage at the "knee" of the $i-v$ curve in Fig. 4.8 and is denoted $V_{Z K}$, where the subscript $Z$ stands for zener (see Section 3.5.3) and $K$ denotes knee.

As can be seen from Fig. 4.8, in the breakdown region the reverse current increases rapidly, with the associated increase in voltage drop being very small. Diode breakdown is normally not destructive, provided the power dissipated in the diode is limited by external circuitry to a "safe" level. This safe value is normally specified on the device data sheets. It therefore is necessary to limit the reverse current in the breakdown region to a value consistent with the permissible power dissipation.

The fact that the diode $i-v$ characteristic in breakdown is almost a vertical line enables it to be used in voltage regulation. This subject will be studied in Section 4.5.

### 4.3 Modeling the Diode Forward Characteristic

Having studied the diode terminal characteristics we are now ready to consider the analysis of circuits employing forward-conducting diodes. Figure 4.10 shows such a circuit. It consists of a dc source $V_{D D}$, a resistor $R$, and a diode. We wish to analyze this circuit to determine the diode voltage $V_{D}$ and current $I_{D}$. To aid in our analysis, we need to represent the diode with a model. There are a variety of diode models, of which we now know two: the ideal-diode model and the exponential model. In the following discussion we shall assess the suitability of these two models in various analysis situations. Also, we shall develop and comment on other models. This material, besides being useful in the analysis and design of diode circuits, establishes a foundation for the modeling of transistor operation that we will study in the next three chapters.

### 4.3.1 The Exponential Model

The most accurate description of the diode operation in the forward region is provided by the exponential model. Unfortunately, however, its severely nonlinear nature makes this model the most difficult to use. To illustrate, let's analyze the circuit in Fig. 4.10 using the exponential diode model.

Assuming that $V_{D D}$ is greater than 0.5 V or so, the diode current will be much greater than $I_{S}$, and we can represent the diode $i-v$ characteristic by the exponential relationship,


Figure 4.10 A simple circuit used to illustrate the analysis of circuits in which the diode is forward conducting.
resulting in

$$
I_{D}=I_{S} e^{V_{D} / V_{T}}
$$

The other equation that governs circuit operation is obtained by writing a Kirchhoff loop equation, resulting in

$$
I_{D}=\frac{V_{D D}-V_{D}}{R}
$$

Assuming that the diode parameter $I_{S}$ is known, Eqs. (4.6) and (4.7) are two equations in the two unknown quantities $I_{D}$ and $V_{D}$. Two alternative ways for obtaining the solution are graphical analysis and iterative analysis.

# 4.3.2 Graphical Analysis Using the Exponential Model 

Graphical analysis is performed by plotting the relationships of Eqs. (4.6) and (4.7) on the $i-v$ plane. The solution can then be obtained as the coordinates of the point of intersection of the two graphs. A sketch of the graphical construction is shown in Fig. 4.11. The curve represents the exponential diode equation (Eq. 4.6), and the straight line represents Eq. (4.7). Such a straight line is known as the load line, a name that will become more meaningful in later chapters. The load line intersects the diode curve at point $Q$, which represents the operating point of the circuit. Its coordinates give the values of $I_{D}$ and $V_{D}$.

Graphical analysis aids in the visualization of circuit operation. However, the effort involved in performing such an analysis, particularly for complex circuits, is too great to be justified in practice.


Figure 4.11 Graphical analysis of the circuit in Fig. 4.10 using the exponential diode model.

### 4.3.3 Iterative Analysis Using the Exponential Model

Equations (4.6) and (4.7) can be solved using a simple iterative procedure, as illustrated in the following example.# Example 4.4 

Determine the current $I_{D}$ and the diode voltage $V_{D}$ for the circuit in Fig. 4.10 with $V_{D D}=5 \mathrm{~V}$ and $R=1 \mathrm{k} \Omega$. Assume that the diode has a current of 1 mA at a voltage of 0.7 V .

## Solution

To begin the iteration, we assume that $V_{D}=0.7 \mathrm{~V}$ and use Eq. (4.7) to determine the current,

$$
\begin{aligned}
I_{D} & =\frac{V_{D D}-V_{D}}{R} \\
& =\frac{5-0.7}{1}=4.3 \mathrm{~mA}
\end{aligned}
$$

We then use the diode equation to obtain a better estimate for $V_{D}$. This can be done by employing Eq. (4.5), namely,

$$
V_{2}-V_{1}=2.3 V_{T} \log \frac{I_{2}}{I_{1}}
$$

Substituting $2.3 V_{T}=60 \mathrm{mV}$, we have

$$
V_{2}=V_{1}+0.06 \log \frac{I_{2}}{I_{1}}
$$

Substituting $V_{1}=0.7 \mathrm{~V}, I_{1}=1 \mathrm{~mA}$, and $I_{2}=4.3 \mathrm{~mA}$ results in $V_{2}=0.738 \mathrm{~V}$. Thus the results of the first iteration are $I_{D}=4.3 \mathrm{~mA}$ and $V_{D}=0.738 \mathrm{~V}$. The second iteration proceeds in a similar manner:

$$
\begin{aligned}
I_{D} & =\frac{5-0.738}{1}=4.262 \mathrm{~mA} \\
V_{2} & =0.738+0.06 \log \left[\frac{4.262}{4.3}\right] \\
& =0.738 \mathrm{~V}
\end{aligned}
$$

Thus the second iteration yields $I_{D}=4.262 \mathrm{~mA}$ and $V_{D}=0.738 \mathrm{~V}$. Since these values are very close to the values obtained after the first iteration, no further iterations are necessary, and the solution is $I_{D}=4.262 \mathrm{~mA}$ and $V_{D}=0.738 \mathrm{~V}$.

### 4.3.4 The Need for Rapid Analysis

The iterative analysis procedure utilized in the example above is simple and yields accurate results after two or three iterations. Nevertheless, there are situations in which the effort and time required are still greater than can be justified. Specifically, if one is doing a pencil-and-paper design of a relatively complex circuit, rapid circuit analysis is a necessity.
Through quick analysis, the designer is able to evaluate various possibilities before deciding on a suitable circuit design. To speed up the analysis process, one must be content with less precise results. This, however, is seldom a problem, because the more accurate analysis can be postponed until a final or almost-final design is obtained. Accurate analysis of the almost-final design can be performed with the aid of a computer circuit-analysis program such as SPICE (see Appendix B and the website). The results of such an analysis can then be used to further refine or "fine-tune" the design.

To speed up the analysis process, we must find a simpler model for the diode forward characteristic.

# 4.3.5 The Constant-Voltage-Drop Model 

The simplest and most widely used diode model is the constant-voltage-drop model. This model is based on the observation that a forward-conducting diode has a voltage drop that varies in a relatively narrow range, say, 0.6 to 0.8 V . The model assumes this voltage to be constant at a value, say, 0.7 V . This development is illustrated in Fig. 4.12.

The constant-voltage-drop model is the one most frequently employed in the initial phases of analysis and design. This is especially true if at these stages one does not have detailed information about the diode characteristics, which is often the case.


Figure 4.12 Development of the diode constant-voltage-drop model: (a) the exponential characteristic; (b) approximating the exponential characteristic by a constant voltage, usually about $0.7 \mathrm{~V}_{i}$; (c) the resulting model of the forward-conducting diodes.
Finally, note that if we employ the constant-voltage-drop model to solve the problem in Example 4.4, we obtain

$$
V_{D}=0.7 \mathrm{~V}
$$

and

$$
\begin{aligned}
I_{D} & =\frac{V_{D D}-0.7}{R} \\
& =\frac{5-0.7}{1}=4.3 \mathrm{~mA}
\end{aligned}
$$

which are not very different from the values obtained before with the more elaborate exponential model.

# 4.3.6 The Ideal-Diode Model 

In applications that involve voltages much greater than the diode voltage drop $(0.6 \mathrm{~V}-0.8 \mathrm{~V})$, we may neglect the diode voltage drop altogether while calculating the diode current. The result is the ideal-diode model, which we studied in Section 4.1. For the circuit in Example 4.4 (i.e., Fig. 4.10 with $V_{D D}=5 \mathrm{~V}$ and $R=1 \mathrm{k} \Omega$ ), utilization of the ideal-diode model leads to

$$
\begin{aligned}
& V_{D}=0 \mathrm{~V} \\
& I_{D}=\frac{5-0}{1}=5 \mathrm{~mA}
\end{aligned}
$$

which for a very quick analysis would not be bad as a gross estimate. However, with almost no additional work, the $0.7-\mathrm{V}$-drop model yields much more realistic results. We note, however, that the greatest utility of the ideal-diode model is in determining which diodes are on and which are off in a multidiode circuit, such as those considered in Section 4.1.

## EXERCISES

4.10 For the circuit in Fig. 4.10, find $I_{D}$ and $V_{D}$ for the case $V_{D D}=5 \mathrm{~V}$ and $R=10 \mathrm{k} \Omega$. Assume that the diode has a voltage of 0.7 V at $1-\mathrm{mA}$ current. Use (a) iteration and (b) the constant-voltage-drop model with $V_{D}=0.7 \mathrm{~V}$.
Ans. (a) $0.43 \mathrm{~mA}, 0.68 \mathrm{~V}$; (b) $0.43 \mathrm{~mA}, 0.7 \mathrm{~V}$
D4.11 Design the circuit in Fig. E4.11 to provide an output voltage of 2.4 V . Assume that the diodes available have $0.7-\mathrm{V}$ drop at 1 mA .


Figure E4.11

Ans. $R=139 \Omega$
4.12 Repeat Exercise 4.4 using the $0.7-\mathrm{V}$-drop model to obtain better estimates of $I$ and $V$ than those found in Exercise 4.4 (using the ideal-diode model).
Ans. (a) $1.72 \mathrm{~mA}, 0.7 \mathrm{~V}$; (b) $0 \mathrm{~mA}, 5 \mathrm{~V}$; (c) $0 \mathrm{~mA}, 5 \mathrm{~V}$; (d) $1.72 \mathrm{~mA}, 0.7 \mathrm{~V}$; (e) $2.3 \mathrm{~mA},+2.3 \mathrm{~V}$; (f) $3.3 \mathrm{~mA},+1.7 \mathrm{~V}$

# 4.3.7 The Small-Signal Model 

Consider the situation in Fig. 4.13(a), where a dc voltage $V_{D D}$ establishes a dc current $I_{D}$ through the series combination of a resistance $R$ and a diode $D$. The resulting diode voltage is denoted $V_{D}$. As mentioned above, values of $I_{D}$ and $V_{D}$ can be obtained by solving the circuit using the diode exponential characteristic or, much more quickly, approximate values can be found using the diode constant-voltage-drop model.

Next, consider the situation of $V_{D D}$ undergoing a small change $\Delta V_{D D}$, as shown in Fig. 4.13(b). As indicated, the current $I_{D}$ changes by an increment $\Delta I_{D}$, and the diode voltage $V_{D}$ changes by an increment $\Delta V_{D}$. We wish to find a quick way to determine the values of these incremental changes. Toward that end, we develop a "small-signal" model for the diode.


Figure 4.13 (a) A simple diode circuit; (b) the situation when $V_{D D}$ changes by $\Delta V_{D D}$.


Figure 4.14 Development of the diode small-signal model.

Here the word signal emphasizes that in general, $\Delta V_{D D}$ can be a time-varying quantity. The qualifier "small" indicates that this diode model applies only when $\Delta V_{D}$ is kept sufficiently small, with "sufficiently" to be quantified shortly.

To develop the diode small-signal model, refer to Fig. 4.14. We express the voltage across the diode as the sum of the dc voltage $V_{D}$ and the time-varying signal $v_{d}(t)$,

$$
v_{D}(t)=V_{D}+v_{d}(t)
$$

Correspondingly, the total instantaneous diode current $i_{D}(t)$ will be

$$
i_{D}(t)=I_{S} e^{v_{D} / v_{T}}
$$

Substituting for $v_{D}$ from Eq. (4.8) gives

$$
i_{D}(t)=I_{S} e^{\left(v_{D}+v_{d}\right) / v_{T}}
$$

which can be rewritten

$$
i_{D}(t)=I_{S} e^{v_{D} / v_{T}} e^{v_{d} / v_{T}}
$$
In the absence of the signal $v_{d}(t)$, the diode voltage is equal to $V_{D}$, and the diode current is $I_{D}$, given by

$$
I_{D}=I_{S} e^{V_{D} / V_{T}}
$$

Thus, $i_{D}(t)$ in Eq. (4.10) can be expressed as

$$
i_{D}(t)=I_{D} e^{v_{d} / V_{T}}
$$

Now if the amplitude of the signal $v_{d}(t)$ is kept sufficiently small such that

$$
\frac{v_{d}}{V_{T}} \ll 1
$$

then we may expand the exponential of Eq. (4.12) in a series and truncate the series after the first two terms to obtain the approximate expression

$$
i_{D}(t) \simeq I_{D}\left(1+\frac{v_{d}}{V_{T}}\right)
$$

This is the small-signal approximation. It is valid for signals whose amplitudes are smaller than about 5 mV (see Eq. 4.13, and recall that $V_{T}=25 \mathrm{mV}$ ). ${ }^{3}$

From Eq. (4.14) we have

$$
i_{D}(t)=I_{D}+\frac{I_{D}}{V_{T}} v_{d}
$$

Thus, superimposed on the dc current $I_{D}$, we have a signal current component directly proportional to the signal voltage $v_{d}$. That is,

$$
i_{D}=I_{D}+i_{d}
$$

where

$$
i_{d}=\frac{I_{D}}{V_{T}} v_{d}
$$

The quantity relating the signal current $i_{d}$ to the signal voltage $v_{d}$ has the dimensions of conductance, mhos (G), and is called the diode small-signal conductance. The inverse of this parameter is the diode small-signal resistance, or incremental resistance, $r_{d}$,

$$
r_{d}=\frac{V_{T}}{I_{D}}
$$

Note that the value of $r_{d}$ is inversely proportional to the bias current $I_{D}$.

[^0]
[^0]:    ${ }^{3}$ For $v_{d}=5 \mathrm{mV}, v_{d} / V_{T}=0.2$. Thus the next term in the series expansion of the exponential will be $\frac{1}{2} \times 0.2^{2}=0.02$, a factor of 10 lower than the linear term we kept.
Additional insight into the small-signal approximation and the small-signal diode model can be obtained by considering again the graphical construction in Fig. 4.14. Here the diode is seen to be operating at a dc bias point $Q$ characterized by the dc voltage $V_{D}$ and the corresponding dc current $I_{D}$. Superimposed on $V_{D}$ we have a signal $v_{d}(t)$, assumed (arbitrarily) to have a triangular waveform.

It is easy to see that using the small-signal approximation is equivalent to assuming that the signal amplitude is sufficiently small such that the excursion along the $i-v$ curve is limited to a short almost-linear segment. The slope of this segment, which is equal to the slope of the tangent to the $i-v$ curve at the operating point $Q$, is equal to the small-signal conductance. The reader is encouraged to prove that the slope of the $i-v$ curve at $i=I_{D}$ is equal to $I_{D} / V_{T}$, which is $1 / r_{d}$; that is,

$$
r_{d}=1 /\left[\frac{\partial i_{D}}{\partial v_{D}}\right]_{i_{D}=I_{D}}
$$

From the preceding we conclude that superimposed on the quantities $V_{D}$ and $I_{D}$ that define the dc bias point, or quiescent point, of the diode will be the small-signal quantities $v_{d}(t)$ and $i_{d}(t)$, which are related by the diode small-signal resistance $r_{d}$ evaluated at the bias point (Eq. 4.18). Thus the small-signal analysis can be performed separately from the dc bias analysis, a great convenience that results from the linearization of the diode characteristics inherent in the small-signal approximation. Specifically, after the dc analysis is performed, the small-signal equivalent circuit is obtained by eliminating all dc sources (i.e., short-circuiting dc voltage sources and open-circuiting dc current sources) and replacing the diode by its small-signal resistance. Thus, for the circuit in Fig. 4.13(b), the dc analysis is obtained by using the circuit in Fig. 4.13(a), while the incremental quantities $\Delta I_{D}$ and $\Delta V_{D}$ can be determined by using the small-signal equivalent circuit shown in Fig. 4.15. The following example should further illustrate the application of the small-signal model.


Figure 4.15 Circuit for determining the incremental quantities $\Delta I_{D}$ and $\Delta V_{D}$ for the circuit in Figure 4.13(b). Note that replacing the diode with its small-signal resistance $r_{d}$ results in a linear circuit.

# Example 4.5 

Consider the circuit shown in Fig. 4.16(a) for the case in which $R=10 \mathrm{k} \Omega$. The power supply $V^{+}$has a dc value of 10 V on which is superimposed a $60-\mathrm{Hz}$ sinusoid of $1-\mathrm{V}$ peak amplitude. (This "signal" component of the power-supply voltage is an imperfection in the power-supply design. It is known as the power-supply ripple. More on this later.) Calculate both the dc voltage of the diode and the amplitude of the sine-wave signal appearing across it. Assume the diode to have a $0.7-\mathrm{V}$ drop at $1-\mathrm{mA}$ current.

(a)

(b)

(c)

Figure 4.16 (a) Circuit for Example 4.5. (b) Circuit for calculating the dc operating point. (c) Small-signal equivalent circuit.

# Solution 

Considering dc quantities only, we assume $V_{D} \simeq 0.7 \mathrm{~V}$ and calculate the diode dc current

$$
I_{D}=\frac{10-0.7}{10}=0.93 \mathrm{~mA}
$$

Since this value is very close to 1 mA , the diode voltage will be very close to the assumed value of 0.7 V . At this operating point, the diode incremental resistance $r_{d}$ is

$$
r_{d}=\frac{V_{T}}{I_{D}}=\frac{25}{0.93}=26.9 \Omega
$$

The signal voltage across the diode can be found from the small-signal equivalent circuit in Fig. 4.16(c). Here $v_{s}$ denotes the $60-\mathrm{Hz} 1-\mathrm{V}$ peak sinusoidal component of $V^{+}$, and $v_{d}$ is the corresponding signal across the diode. Using the voltage divider rule provides the peak amplitude of $v_{d}$ as follows:

$$
\begin{aligned}
v_{d}(\text { peak }) & =\hat{V}_{s} \frac{r_{d}}{R+r_{d}} \\
& =1 \frac{0.0269}{10+0.0269}=2.68 \mathrm{mV}
\end{aligned}
$$

Finally, we note that since this value is quite small, our use of the small-signal model of the diode is justified.

From the above we see that for a diode circuit that involves both dc and signal quantities, a small-signal equivalent circuit can be obtained by eliminating the dc sources and replacing each diode with its small-signal resistance $r_{d}$. Such a circuit is linear and can be solved using linear circuit analysis.

Finally, we note that while $r_{d}$ models the small-signal operation of the diode at low frequencies, its dynamic operation is modeled by the capacitances $C_{j}$ and $C_{d}$, which we
studied in Section 3.6 and which also are small-signal parameters. A complete model of the diode includes $C_{j}$ and $C_{d}$ in parallel with $r_{d}$.

# 4.3.8 Use of the Diode Forward Drop in Voltage Regulation 

A further application of the diode small-signal model is found in a popular diode application, namely, the use of diodes to create a regulated voltage. A voltage regulator is a circuit whose purpose is to provide a constant dc voltage between its output terminals. The output voltage is required to remain as constant as possible in spite of (a) changes in the load current drawn from the regulator output terminal and (b) changes in the dc power-supply voltage that feeds the regulator circuit. Since the forward-voltage drop of the diode remains almost constant at approximately 0.7 V while the current through it varies by relatively large amounts, a forward-biased diode can make a simple voltage regulator. For instance, we have seen in Example 4.5 that while the $10-\mathrm{V}$ dc supply voltage had a ripple of 2 V peak-to-peak (a $\pm 10 \%$ variation), the corresponding ripple in the diode voltage was only about $\pm 2.7 \mathrm{mV}$ (a $\pm 0.4 \%$ variation). Regulated voltages greater than 0.7 V can be obtained by connecting a number of diodes in series. For example, the use of three forward-biased diodes in series provides a voltage of about 2 V . One such circuit is investigated in the following example, which utilizes the diode small-signal model to quantify the efficacy of the voltage regulator that is realized.

## Example 4.6

Consider the circuit shown in Fig. 4.17. A string of three diodes is used to provide a constant voltage of about 2.1 V . We want to calculate the percentage change in this regulated voltage caused by (a) a $\pm 10 \%$ change in the power-supply voltage, and (b) connection of a $1-\mathrm{k} \Omega$ load resistance.


Figure 4.17 Circuit for Example 4.6.

## Solution

With no load, the nominal value of the current in the diode string is given by

$$
I=\frac{10-2.1}{1}=7.9 \mathrm{~mA}
$$
Thus each diode will have an incremental resistance of

$$
r_{d}=\frac{V_{T}}{I}
$$

Thus,

$$
r_{d}=\frac{25}{7.9}=3.2 \Omega
$$

The three diodes in series will have a total incremental resistance of

$$
r=3 r_{d}=9.6 \Omega
$$

This resistance, along with the resistance $R$, forms a voltage divider whose ratio can be used to calculate the change in output voltage due to a $\pm 10 \%$ (i.e., $\pm 1-\mathrm{V}$ ) change in supply voltage. Thus the peak-to-peak change in output voltage will be

$$
\Delta v_{O}=2 \frac{r}{r+R}=2 \frac{0.0096}{0.0096+1}=19 \mathrm{mV} \text { peak-to-peak }
$$

That is, corresponding to the $\pm 1-\mathrm{V}( \pm 10 \%)$ change in supply voltage, the output voltage will change by $\pm 9.5 \mathrm{mV}$ or $\pm 0.5 \%$. Since this implies a change of about $\pm 3.2 \mathrm{mV}$ per diode, our use of the small-signal model is justified.

When a load resistance of $1 \mathrm{k} \Omega$ is connected across the diode string, it draws a current of approximately 2.1 mA . Thus the current in the diodes decreases by 2.1 mA , resulting in a decrease in voltage across the diode string given by

$$
\Delta v_{O}=-2.1 \times r=-2.1 \times 9.6=-20 \mathrm{mV}
$$

Since this implies that the voltage across each diode decreases by about 6.7 mV , our use of the small-signal model is not entirely justified. Nevertheless, a detailed calculation of the voltage change using the exponential model results in $\Delta v_{O}=-23 \mathrm{mV}$, which is not too different from the approximate value obtained using the incremental model.

# EXERCISES 

4.13 Find the value of the diode small-signal resistance $r_{d}$ at bias currents of $0.1 \mathrm{~mA}, 1 \mathrm{~mA}$, and 10 mA . Ans. $250 \Omega ; 25 \Omega ; 2.5 \Omega$
4.14 Consider a diode biased at 1 mA . Find the change in current as a result of changing the voltage by (a) -10 mV , (b) -5 mV , (c) +5 mV , and (d) +10 mV . In each case, do the calculations (i) using the small-signal model and (ii) using the exponential model.
Ans. (a) $-0.40,-0.33 \mathrm{~mA} ;$ (b) $-0.20,-0.18 \mathrm{~mA} ;$ (c) $+0.20,+0.22 \mathrm{~mA} ;$ (d) $+0.40,+0.49 \mathrm{~mA}$
D4.15 Design the circuit of Fig. E4.15 so that $V_{O}=3 \mathrm{~V}$ when $I_{L}=0$, and $V_{O}$ changes by 20 mV per 1 mA of load current.
(a) Use the small-signal model of the diode to find the value of $R$.
(b) Specify the value of $I_{S}$ of each of the diodes.(c) For this design, use the diode exponential model to determine the actual change in $V_{O}$ when a current $I_{L}=1 \mathrm{~mA}$ is drawn from the regulator.


Figure E4.15
Ans. (a) $R=2.4 \mathrm{k} \Omega$; (b) $I_{S}=4.7 \times 10^{-16} \mathrm{~A}$; (c) -23 mV

# 4.4 Operation in the Reverse Breakdown Region-Zener Diodes 

The very steep $i-v$ curve that the diode exhibits in the breakdown region (Fig. 4.8) and the almost-constant voltage drop that this indicates suggest that diodes operating in the breakdown region can be used in the design of voltage regulators. From the previous section, the reader will recall that voltage regulators are circuits that provide a constant dc output voltage in the face of changes in their load current and in the system power-supply voltage. This in fact turns out to be an important application of diodes operating in the reverse breakdown region, and special diodes are manufactured to operate specifically in the breakdown region. Such diodes are called breakdown diodes or, more commonly, as noted earlier, zener diodes.

Figure 4.18 shows the circuit symbol of the zener diode. In normal applications of zener diodes, current flows into the cathode, and the cathode is positive with respect to the anode. Thus $I_{Z}$ and $V_{Z}$ in Fig. 4.18 have positive values.


Figure 4.18 Circuit symbol for a zener diode.
# 4.4.1 Specifying and Modeling the Zener Diode 

Figure 4.19 shows details of the diode $i-v$ characteristic in the breakdown region. We observe that for currents greater than the knee current $I_{Z K}$ (specified on the data sheet of the zener diode), the $i-v$ characteristic is almost a straight line. The manufacturer usually specifies the voltage across the zener diode $V_{Z}$ at a specified test current, $I_{Z T}$. We have indicated these parameters in Fig. 4.19 as the coordinates of the point labeled $Q$. Thus a $6.8-\mathrm{V}$ zener diode will exhibit a $6.8-\mathrm{V}$ drop at a specified test current of, say, 10 mA . As the current through the zener deviates from $I_{Z T}$, the voltage across it will change, though only slightly. Figure 4.19 shows that corresponding to current change $\Delta I$ the zener voltage changes by $\Delta V$, which is related to $\Delta I$ by

$$
\Delta V=r_{z} \Delta I
$$

where $r_{z}$ is the inverse of the slope of the almost-linear $i-v$ curve at point $Q$. Resistance $r_{z}$ is the incremental resistance of the zener diode at operating point $Q$. It is also known as the dynamic resistance of the zener, and its value is specified on the device data sheet. Typically, $r_{z}$ is in the range of a few ohms to a few tens of ohms. Obviously, the lower the value of $r_{z}$ is, the more constant the zener voltage remains as its current varies, and thus the more ideal its performance becomes in the design of voltage regulators. In this regard, we observe from Fig. 4.19 that while $r_{z}$ remains low and almost constant over a wide range of current, its value increases considerably in the vicinity of the knee. Therefore, as a general design guideline, one should avoid operating the zener in this low-current region.

Zener diodes are fabricated with voltages $V_{Z}$ in the range of a few volts to a few hundred volts. In addition to specifying $V_{Z}$ (at a particular current $I_{Z T}$ ), $r_{z}$, and $I_{Z K}$, the manufacturer


Figure 4.19 The diode $i-v$ characteristic with the breakdown region shown in some detail.


Figure 4.20 Model for the zener diode.
also specifies the maximum power that the device can safely dissipate. Thus a $0.5-\mathrm{W}, 6.8-\mathrm{V}$ zener diode can operate safely at currents up to a maximum of about 70 mA .

The almost-linear $i-v$ characteristic of the zener diode suggests that the device can be modeled as indicated in Fig. 4.20. Here $V_{Z 0}$ denotes the point at which the straight line of slope $1 / r_{z}$ intersects the voltage axis (refer to Fig. 4.19). Although $V_{Z 0}$ is shown in Fig. 4.19 to be slightly different from the knee voltage $V_{Z K}$, in practice their values are almost equal. The equivalent circuit model of Fig. 4.20 can be analytically described by

$$
V_{Z}=V_{Z 0}+r_{z} I_{Z}
$$

and it applies for $I_{Z}>I_{Z K}$ and, obviously, $V_{Z}>V_{Z 0}$.

# 4.4.2 Use of the Zener as a Shunt Regulator 

We now illustrate, by way of an example, the use of zener diodes in the design of shunt regulators, so named because the regulator circuit appears in parallel (shunt) with the load.

## Example 4.7

The 6.8-V zener diode in the circuit of Fig. 4.21(a) is specified to have $V_{Z}=6.8 \mathrm{~V}$ at $I_{Z}=5 \mathrm{~mA}, r_{z}=20 \Omega$, and $I_{Z K}=0.2 \mathrm{~mA}$. The supply voltage $V^{+}$is nominally 10 V but can vary by $\pm 1 \mathrm{~V}$.
(a) Find $V_{O}$ with no load and with $V^{+}$at its nominal value.
(b) Find the change in $V_{O}$ resulting from the $\pm 1-\mathrm{V}$ change in $V^{+}$. Note that $\left(\Delta V_{O} / \Delta V^{+}\right)$, usually expressed in $\mathrm{mV} / \mathrm{V}$, is known as line regulation.
(c) Find the change in $V_{O}$ resulting from connecting a load resistance $R_{L}$ that draws a current $I_{L}=1 \mathrm{~mA}$, and hence find the load regulation $\left(\Delta V_{O} / \Delta I_{L}\right)$ in $\mathrm{mV} / \mathrm{mA}$.
(d) Find the change in $V_{O}$ when $R_{L}=2 \mathrm{k} \Omega$.
(e) Find the value of $V_{O}$ when $R_{L}=0.5 \mathrm{k} \Omega$.
(f) What is the minimum value of $R_{L}$ for which the diode still operates in the breakdown region?


Figure 4.21 (a) Circuit for Example 4.7. (b) The circuit with the zener diode replaced with its equivalent circuit model.

# Solution 

First we must determine the value of the parameter $V_{Z 0}$ of the zener diode model. Substituting $V_{Z}=6.8 \mathrm{~V}$, $I_{Z}=5 \mathrm{~mA}$, and $r_{z}=20 \Omega$ in Eq. (4.20) yields $V_{Z 0}=6.7 \mathrm{~V}$. Figure 4.21 (b) shows the circuit with the zener diode replaced with its model.
(a) With no load connected, the current through the zener is given by

$$
\begin{aligned}
I_{Z} & =I=\frac{V^{+}-V_{Z 0}}{R+r_{z}} \\
& =\frac{10-6.7}{0.5+0.02}=6.35 \mathrm{~mA}
\end{aligned}
$$

Thus,

$$
\begin{aligned}
V_{O} & =V_{Z 0}+I_{Z} r_{z} \\
& =6.7+6.35 \times 0.02=6.83 \mathrm{~V}
\end{aligned}
$$

(b) For a $\pm 1-\mathrm{V}$ change in $V^{+}$, the change in output voltage can be found from

$$
\begin{aligned}
\Delta V_{O} & =\Delta V^{+} \frac{r_{z}}{R+r_{z}} \\
& = \pm 1 \times \frac{20}{500+20}= \pm 38.5 \mathrm{mV}
\end{aligned}
$$

Thus,
Line regulation $=38.5 \mathrm{mV} / \mathrm{V}$
# Example 4.7 continued 

(c) When a load resistance $R_{L}$ that draws a load current $I_{L}=1 \mathrm{~mA}$ is connected, the zener current will decrease by 1 mA . The corresponding change in zener voltage can be found from

$$
\begin{aligned}
\Delta V_{O} & =r_{z} \Delta I_{Z} \\
& =20 \times-1=-20 \mathrm{mV}
\end{aligned}
$$

Thus the load regulation is

$$
\text { Load regulation } \equiv \frac{\Delta V_{O}}{\Delta I_{L}}=-20 \mathrm{mV} / \mathrm{mA}
$$

(d) When a load resistance of $2 \mathrm{k} \Omega$ is connected, the load current will be approximately $6.8 \mathrm{~V} / 2 \mathrm{k} \Omega=$ 3.4 mA . Thus the change in zener current will be $\Delta I_{Z}=-3.4 \mathrm{~mA}$, and the corresponding change in zener voltage (output voltage) will thus be

$$
\begin{aligned}
\Delta V_{O} & =r_{z} \Delta I_{Z} \\
& =20 \times-3.4=-68 \mathrm{mV}
\end{aligned}
$$

This value could have been obtained by multiplying the load regulation by the value of $I_{L}(3.4 \mathrm{~mA})$.
(e) An $R_{L}$ of $0.5 \mathrm{k} \Omega$ would draw a load current of $6.8 / 0.5=13.6 \mathrm{~mA}$. This is not possible, because the current $I$ supplied through $R$ is only 6.4 mA (for $V^{+}=10 \mathrm{~V}$ ). Therefore, the zener must be cut off. If this is indeed the case, then $V_{O}$ is determined by the voltage divider formed by $R_{L}$ and $R$ (Fig. 4.21a),

$$
\begin{aligned}
V_{O} & =V^{+} \frac{R_{L}}{R+R_{L}} \\
& =10 \frac{0.5}{0.5+0.5}=5 \mathrm{~V}
\end{aligned}
$$

Since this voltage is lower than the breakdown voltage of the zener, the diode is indeed no longer operating in the breakdown region.
(f) For the zener to be at the edge of the breakdown region, $I_{Z}=I_{Z K}=0.2 \mathrm{~mA}$ and $V_{Z} \simeq V_{Z K} \simeq 6.7 \mathrm{~V}$. At this point the lowest (worst-case) current supplied through $R$ is $(9-6.7) / 0.5=4.6 \mathrm{~mA}$, and thus the load current is $4.6-0.2=4.4 \mathrm{~mA}$. The corresponding value of $R_{L}$ is

$$
R_{L}=\frac{6.7}{4.4} \simeq 1.5 \mathrm{k} \Omega
$$

### 4.4.3 Temperature Effects

The dependence of the zener voltage $V_{Z}$ on temperature is specified in terms of its temperature coefficient TC, or temco as it is commonly known, which is usually expressed in $\mathrm{mV} /{ }^{\circ} \mathrm{C}$. The value of TC depends on the zener voltage, and for a given diode the TC varies with the operating current. Zener diodes whose $V_{Z}$ are lower than about 5 V exhibit a negative TC. On the other hand, zeners with higher voltages exhibit a positive TC. The TC of a zener diode with a $V_{Z}$ of about 5 V can be made zero by operating the diode at a specified current. Another commonly used technique for obtaining a reference voltage with low temperature coefficient
is to connect a zener diode with a positive temperature coefficient of about $2 \mathrm{mV} /{ }^{\circ} \mathrm{C}$ in series with a forward-conducting diode. Since the forward-conducting diode has a voltage drop of $\simeq 0.7 \mathrm{~V}$ and a TC of about $-2 \mathrm{mV} /{ }^{\circ} \mathrm{C}$, the series combination will provide a voltage of $\left(V_{Z}+0.7\right)$ with a TC of about zero.

# EXERCISES 

4.16 A zener diode whose nominal voltage is 10 V at 10 mA has an incremental resistance of $50 \Omega$. What voltage do you expect if the diode current is halved? Doubled? What is the value of $V_{Z 0}$ in the zener model?
Ans. $9.75 \mathrm{~V} ; 10.5 \mathrm{~V} ; 9.5 \mathrm{~V}$
4.17 A zener diode exhibits a constant voltage of 5.6 V for currents greater than five times the knee current. $I_{Z K}$ is specified to be 1 mA . The zener is to be used in the design of a shunt regulator fed from a $15-\mathrm{V}$ supply. The load current varies over the range of 0 mA to 15 mA . Find a suitable value for the resistor $R$. What is the maximum power dissipation of the zener diode?
Ans. $470 \Omega ; 112 \mathrm{~mW}$
4.18 A shunt regulator utilizes a zener diode whose voltage is 5.1 V at a current of 50 mA and whose incremental resistance is $7 \Omega$. The diode is fed from a supply of $15-\mathrm{V}$ nominal voltage through a $200-\Omega$ resistor. What is the output voltage at no load? Find the line regulation and the load regulation. Ans. $5.1 \mathrm{~V} ; 33.8 \mathrm{mV} / \mathrm{V} ;-7 \mathrm{mV} / \mathrm{mA}$

### 4.4.4 A Final Remark

Though simple and useful, zener diodes have lost a great deal of their popularity in recent years. They have been virtually replaced in voltage-regulator design by specially designed integrated circuits (ICs) that perform the voltage-regulation function much more effectively and with greater flexibility than zener diodes.

### 4.5 Rectifier Circuits

One of the most important applications of diodes is in the design of rectifier circuits. A diode rectifier forms an essential building block of the dc power supplies required to power electronic equipment. A block diagram of such a power supply is shown in Fig. 4.22. As indicated, the power supply is fed from the $120-\mathrm{V}$ (rms) $60-\mathrm{Hz}$ ac line, and it delivers a dc voltage $V_{O}$ (usually in the range of 4 V to 20 V ) to an electronic circuit represented by the load block. The dc voltage $V_{O}$ is required to be as constant as possible in spite of variations in the ac line voltage and in the current drawn by the load.

The first block in a dc power supply is the power transformer. It consists of two separate coils wound around an iron core that magnetically couples the two windings. The primary winding, having $N_{1}$ turns, is connected to the $120-\mathrm{V}$ ac supply, and the secondary winding, having $N_{2}$ turns, is connected to the circuit of the dc power supply. Thus an ac voltage $v_{S}$ of $120\left(N_{2} / N_{1}\right) \mathrm{V}$ (rms) develops between the two terminals of the secondary winding. By


Figure 4.22 Block diagram of a dc power supply.
selecting an appropriate turns ratio $\left(N_{1} / N_{2}\right)$ for the transformer, the designer can step the line voltage down to the value required to yield the particular dc voltage output of the supply. For instance, a secondary voltage of $8-\mathrm{V}$ rms may be appropriate for a dc output of 5 V . This can be achieved with a 15:1 turns ratio.

In addition to providing the appropriate sinusoidal amplitude for the dc power supply, the power transformer provides electrical isolation between the electronic equipment and the power-line circuit. This isolation minimizes the risk of electric shock to the equipment user.

The diode rectifier converts the input sinusoid $v_{S}$ to a unipolar output, which can have the pulsating waveform indicated in Fig. 4.22. Although this waveform has a nonzero average or a dc component, its pulsating nature makes it unsuitable as a dc source for electronic circuits, hence the need for a filter. The variations in the magnitude of the rectifier output are considerably reduced by the filter block in Fig. 4.22. In this section we shall study a number of rectifier circuits and a simple implementation of the output filter.

The output of the rectifier filter, though much more constant than without the filter, still contains a time-dependent component, known as ripple. To reduce the ripple and to stabilize the magnitude of the dc output voltage against variations caused by changes in load current, a voltage regulator is employed. Such a regulator can be implemented using the zener shunt regulator configuration studied in Section 4.4. Alternatively, and much more commonly at present, an integrated-circuit regulator can be used.

# 4.5.1 The Half-Wave Rectifier 

The half-wave rectifier utilizes alternate half-cycles of the input sinusoid. Figure 4.23(a) shows the circuit of a half-wave rectifier. This circuit was analyzed in Section 4.1 (see Fig. 4.3) assuming an ideal diode. Using the more realistic constant-voltage-drop diode model, we obtain

$$
\begin{array}{ll}
v_{O}=0, & v_{S}<V_{D} \\
v_{O}=v_{S}-V_{D}, & v_{S} \geq V_{D}
\end{array}
$$

The transfer characteristic represented by these equations is sketched in Fig. 4.23(b), where $V_{D}=0.7 \mathrm{~V}$ or 0.8 V . Figure 4.23(c) shows the output voltage obtained when the input $v_{S}$ is a sinusoid.

In selecting diodes for rectifier design, two important parameters must be specified: the current-handling capability required of the diode, determined by the largest current the diode is expected to conduct, and the peak inverse voltage (PIV) that the diode must be able to


Figure 4.23 (a) Half-wave rectifier. (b) Transfer characteristic of the rectifier circuit. (c) Input and output waveforms.
withstand without breakdown, determined by the largest reverse voltage that is expected to appear across the diode. In the rectifier circuit of Fig. 4.23(a), we observe that when $v_{S}$ is negative the diode will be cut off and $v_{O}$ will be zero. It follows that the PIV is equal to the peak of $v_{S}$,

$$
\mathrm{PIV}=V_{s}
$$

It is usually prudent, however, to select a diode that has a reverse breakdown voltage at least $50 \%$ greater than the expected PIV.

Before leaving the half-wave rectifier, the reader should note two points. First, it is possible to use the diode exponential characteristic to determine the exact transfer characteristic of the rectifier (see Problem 4.68). However, the amount of work involved is usually too great to be justified in practice. Of course, such an analysis can be easily done using a computer circuit-analysis program such as SPICE.

Second, whether we analyze the circuit accurately or not, it should be obvious that this circuit does not function properly when the input signal is small. For instance, this circuit cannot be used to rectify an input sinusoid of $100-\mathrm{mV}$ amplitude. For such an application one
resorts to a so-called precision rectifier, a circuit utilizing diodes in conjunction with op amps. One such circuit is presented in Section 4.5.5.

# EXERCISE 

4.19 For the half-wave rectifier circuit in Fig. 4.23(a), show the following: (a) For the half-cycles during which the diode conducts, conduction begins at an angle $\theta=\sin ^{-1}\left(V_{D} / V_{s}\right)$ and terminates at $(\pi-\theta)$, for a total conduction angle of $(\pi-2 \theta)$. (b) The average value (dc component) of $v_{O}$ is $V_{O} \simeq(1 / \pi) V_{s}-V_{D} / 2$. (c) The peak diode current is $\left(V_{s}-V_{D}\right) / R$.

Find numerical values for these quantities for the case of $12-\mathrm{V}$ (rms) sinusoidal input, $V_{D} \simeq 0.7 \mathrm{~V}$, and $R=100 \Omega$. Also, give the value for PIV.
Ans. (a) $\theta=2.4^{\circ}$, conduction angle $=175^{\circ}$; (b) 5.05 V ; (c) $163 \mathrm{~mA} ; 17 \mathrm{~V}$

### 4.5.2 The Full-Wave Rectifier

The full-wave rectifier utilizes both halves of the input sinusoid. To provide a unipolar output, it inverts the negative halves of the sine wave. One possible implementation is shown in Fig. 4.24(a). Here the transformer secondary winding is center-tapped to provide two equal voltages $v_{S}$ across the two halves of the secondary winding with the polarities indicated. Note that when the input line voltage (feeding the primary) is positive, both of the signals labeled $v_{S}$ will be positive. In this case $D_{1}$ will conduct and $D_{2}$ will be reverse biased. The current through $D_{1}$ will flow through $R$ and back to the center tap of the secondary. The circuit then behaves like a half-wave rectifier, and the output during the positive half-cycles when $D_{1}$ conducts will be identical to that produced by the half-wave rectifier.

Now, during the negative half-cycle of the ac line voltage, both of the voltages labeled $v_{S}$ will be negative. Thus $D_{1}$ will be cut off while $D_{2}$ will conduct. The current conducted by $D_{2}$ will flow through $R$ and back to the center tap. It follows that during the negative half-cycles while $D_{2}$ conducts, the circuit behaves again as a half-wave rectifier. The important point, however, is that the current through $R$ always flows in the same direction, and thus $v_{O}$ will be unipolar, as indicated in Fig. 4.24(c). The output waveform shown is obtained by assuming that a conducting diode has a constant voltage drop $V_{D}$. Thus the transfer characteristic of the full-wave rectifier takes the shape shown in Fig. 4.24(b).

The full-wave rectifier obviously produces a more "energetic" waveform than that provided by the half-wave rectifier. In almost all rectifier applications, one opts for a full-wave type of some kind.

To find the PIV of the diodes in the full-wave rectifier circuit, consider the situation during the positive half-cycles. Diode $D_{1}$ is conducting, and $D_{2}$ is cut off. The voltage at the cathode of $D_{2}$ is $v_{O}$, and that at its anode is $-v_{S}$. Thus the reverse voltage across $D_{2}$ will be $\left(v_{O}+v_{S}\right)$, which will reach its maximum when $v_{O}$ is at its peak value of $\left(V_{s}-V_{D}\right)$, and $v_{S}$ is at its peak value of $V_{s}$; thus,

$$
\mathrm{PIV}=2 V_{s}-V_{D}
$$

which is approximately twice that for the case of the half-wave rectifier.


Figure 4.24 Full-wave rectifier utilizing a transformer with a center-tapped secondary winding: (a) circuit; (b) transfer characteristic assuming a constant-voltage-drop model for the diodes; (c) input and output waveforms.

# EXERCISE 

4.20 For the full-wave rectifier circuit in Fig. 4.24(a), show the following: (a) The output is zero for an angle of $2 \sin ^{-1}\left(V_{D} / V_{s}\right)$ centered around the zero-crossing points of the sine-wave input. (b) The average value (dc component) of $v_{O}$ is $V_{O} \simeq(2 / \pi) V_{s}-V_{D}$. (c) The peak current through each diode is $\left(V_{s}-V_{D}\right) / R$. Find the fraction (percentage) of each cycle during which $v_{O}>0$, the value of $V_{O}$, the peak diode current, and the value of PIV, all for the case in which $v_{S}$ is a $12-\mathrm{V}$ (rms) sinusoid, $V_{D} \simeq 0.7 \mathrm{~V}$, and $R=100 \Omega$.
Ans. $97.4 \% ; 10.1 \mathrm{~V} ; 163 \mathrm{~mA} ; 33.2 \mathrm{~V}$# 4.5.3 The Bridge Rectifier 

An alternative implementation of the full-wave rectifier is shown in Fig. 4.25(a). This circuit, known as the bridge rectifier because of the similarity of its configuration to that of the Wheatstone bridge, does not require a center-tapped transformer, a distinct advantage over the full-wave rectifier circuit of Fig. 4.24. The bridge rectifier, however, requires four diodes as compared to two in the previous circuit. This is not much of a disadvantage, because diodes are inexpensive and one can buy a diode bridge in one package.

The bridge-rectifier circuit operates as follows: During the positive half-cycles of the input voltage, $v_{S}$ is positive, and thus current is conducted through diode $D_{1}$, resistor $R$, and diode $D_{2}$. Meanwhile, diodes $D_{3}$ and $D_{4}$ will be reverse biased. Observe that there are two diodes in series in the conduction path, and thus $v_{O}$ will be lower than $v_{S}$ by two diode drops (compared to one drop in the circuit previously discussed). This is somewhat of a disadvantage of the bridge rectifier.

Next, consider the situation during the negative half-cycles of the input voltage. The secondary voltage $v_{S}$ will be negative, and thus $-v_{S}$ will be positive, forcing current through $D_{3}, R$, and $D_{4}$. Meanwhile, diodes $D_{1}$ and $D_{2}$ will be reverse biased. The important point to note, though, is that during both half-cycles, current flows through $R$ in the same direction (from right to left), and thus $v_{O}$ will always be positive, as indicated in Fig. 4.25(b).

To determine the peak inverse voltage (PIV) of each diode, consider the circuit during the positive half-cycles. The reverse voltage across $D_{3}$ can be determined from the loop formed


Figure 4.25 The bridge rectifier: (a) circuit; (b) input and output waveforms.
by $D_{3}, R$, and $D_{2}$ as

$$
v_{D 3}(\text { reverse })=v_{O}+v_{D 2}(\text { forward })
$$

Thus the maximum value of $v_{D 3}$ occurs at the peak of $v_{O}$ and is given by

$$
\mathrm{PIV}=V_{s}-2 V_{D}+V_{D}=V_{s}-V_{D}
$$

Observe that here the PIV is about half the value for the full-wave rectifier with a center-tapped transformer. This is another advantage of the bridge rectifier.

Yet one more advantage of the bridge-rectifier circuit over that utilizing a center-tapped transformer is that only about half as many turns are required for the secondary winding of the transformer. Another way of looking at this point can be obtained by observing that each half of the secondary winding of the center-tapped transformer is utilized for only half the time. These advantages have made the bridge rectifier the most popular rectifier circuit configuration.

# EXERCISE 

4.21 For the bridge-rectifier circuit of Fig. 4.25(a), use the constant-voltage-drop diode model to show that (a) the average (or dc component) of the output voltage is $V_{O} \simeq(2 / \pi) V_{s}-2 V_{D}$ and (b) the peak diode current is $\left(V_{s}-2 V_{D}\right) / R$. Find numerical values for the quantities in (a) and (b) and the PIV for the case in which $v_{S}$ is a $12-\mathrm{V}$ (rms) sinusoid, $V_{D} \simeq 0.7 \mathrm{~V}$, and $R=100 \Omega$.
Ans. $9.4 \mathrm{~V} ; 156 \mathrm{~mA} ; 16.3 \mathrm{~V}$

### 4.5.4 The Rectifier with a Filter Capacitor—The Peak Rectifier

The pulsating nature of the output voltage produced by the rectifier circuits discussed above makes it unsuitable as a dc supply for electronic circuits. A simple way to reduce the variation of the output voltage is to place a capacitor across the load resistor. It will be shown that this filter capacitor serves to reduce substantially the variations in the rectifier output voltage.

To see how the rectifier circuit with a filter capacitor works, consider first the simple circuit shown in Fig. 4.26. Let the input $v_{I}$ be a sinusoid with a peak value $V_{p}$, and assume the diode to be ideal. As $v_{I}$ goes positive, the diode conducts and the capacitor is charged so that $v_{O}=v_{I}$. This situation continues until $v_{I}$ reaches its peak value $V_{p}$. Beyond the peak, as $v_{I}$ decreases, the diode becomes reverse biased and the output voltage remains constant at the value $V_{p}$. In fact, theoretically speaking, the capacitor will retain its charge and hence its voltage indefinitely, because there is no way for the capacitor to discharge. Thus the circuit provides a dc voltage output equal to the peak of the input sine wave. This is a very encouraging result in view of our desire to produce a dc output.

Next, we consider the more practical situation where a load resistance $R$ is connected across the capacitor $C$, as depicted in Fig. 4.27(a). However, we will continue to assume the diode to be ideal. As before, for a sinusoidal input, the capacitor charges to the peak of the input $V_{p}$. Then the diode cuts off, and the capacitor discharges through the load resistance $R$. The capacitor discharge will continue for almost the entire cycle, until the time at which $v_{I}$


Figure 4.26 (a) A simple circuit used to illustrate the effect of a filter capacitor. (b) Input and output waveforms assuming an ideal diode. Note that the circuit provides a dc voltage equal to the peak of the input sine wave. The circuit is therefore known as a peak rectifier or a peak detector.
exceeds the capacitor voltage. Then the diode turns on again and charges the capacitor up to the peak of $v_{I}$, and the process repeats itself. Observe that to keep the output voltage from decreasing too much during capacitor discharge, one selects a value for $C$ so that the time constant $C R$ is much greater than the discharge interval.

We are now ready to analyze the circuit in detail. Figure 4.27(b) shows the steady-state input and output voltage waveforms under the assumption that $C R \gg T$, where $T$ is the period of the input sinusoid. The waveforms of the load current

$$
i_{L}=v_{O} / R
$$

and of the diode current (when it is conducting)

$$
\begin{aligned}
i_{D} & =i_{C}+i_{L} \\
& =C \frac{d v_{I}}{d t}+i_{L}
\end{aligned}
$$

are shown in Fig. 4.27(c). The following observations are in order:

1. The diode conducts for a brief interval, $\Delta t$, near the peak of the input sinusoid and supplies the capacitor with charge equal to that lost during the much longer discharge interval. The latter is approximately equal to the period $T$.


Figure 4.27 Voltage and current waveforms in the peak-rectifier circuit with $C R \gg T$. The diode is assumed ideal.
2. Assuming an ideal diode, the diode conduction begins at time $t_{1}$, at which the input $v_{I}$ equals the exponentially decaying output $v_{o}$. Conduction stops at $t_{2}$ shortly after the peak of $v_{I}$; the exact value of $t_{2}$ can be determined by setting $i_{D}=0$ in Eq. (4.25).
3. During the diode-off interval, the capacitor $C$ discharges through $R$, and thus $v_{O}$ decays exponentially with a time constant $C R$. The discharge interval begins just past the peak of $v_{I}$. At the end of the discharge interval, which lasts for almost the entire period $T, v_{o}=V_{p}-V_{r}$, where $V_{r}$ is the peak-to-peak ripple voltage. When $C R \gg T$, the value of $V_{r}$ is small.
4. When $V_{r}$ is small, $v_{O}$ is almost constant and equal to the peak value of $v_{I}$. Thus the dc output voltage is approximately equal to $V_{p}$. Similarly, the current $i_{L}$ is almost constant, and its dc component $I_{L}$ is given by

$$
I_{L}=\frac{V_{p}}{R}
$$

If desired, a more accurate expression for the output dc voltage can be obtained by taking the average of the extreme values of $v_{O}$,

$$
V_{O}=V_{p}-\frac{1}{2} V_{r}
$$

With these observations in hand, we now derive expressions for $V_{r}$ and for the average and peak values of the diode current. During the diode-off interval, $v_{O}$ can be expressed as

$$
v_{O}=V_{p} e^{-t / C R}
$$

At the end of the discharge interval we have

$$
V_{p}-V_{r} \simeq V_{p} e^{-T / C R}
$$

Now, since $C R \gg T$, we can use the approximation $e^{-T / C R} \simeq 1-T / C R$ to obtain

$$
V_{r} \simeq V_{p} \frac{T}{C R}
$$

We observe that to keep $V_{r}$ small we must select a capacitance $C$ so that $C R \gg T$. The ripple voltage $V_{r}$ in Eq. (4.28) can be expressed in terms of the frequency $f=1 / T$ as

$$
V_{r}=\frac{V_{p}}{f C R}
$$

Using Eq. (4.26) we can express $V_{r}$ by the alternate expression

$$
V_{r}=\frac{I_{L}}{f C}
$$

Note that an alternative interpretation of the approximation made above is that the capacitor discharges by means of a constant current $I_{L}=V_{p} / R$. This approximation is valid as long as $V_{r} \ll V_{p}$.

Assuming that diode conduction ceases almost at the peak of $v_{I}$, we can determine the conduction interval $\Delta t$ from

$$
V_{p} \cos (\omega \Delta t)=V_{p}-V_{r}
$$

where $\omega=2 \pi f=2 \pi / T$ is the angular frequency of $v_{I}$. Since $(\omega \Delta t)$ is a small angle, we can employ the approximation $\cos (\omega \Delta t) \simeq 1-\frac{1}{2}(\omega \Delta t)^{2}$ to obtain

$$
\omega \Delta t \simeq \sqrt{2 V_{r} / V_{p}}
$$

We note that when $V_{r} \ll V_{p}$, the conduction angle $\omega \Delta t$ will be small, as assumed.
To determine the average diode current during conduction, $i_{D a v}$, we equate the charge that the diode supplies to the capacitor,

$$
Q_{\text {supplied }}=i_{C a v} \Delta t
$$
where from Eq. (4.24),

$$
i_{C a v}=i_{D a v}-I_{L}
$$

to the charge that the capacitor loses during the discharge interval,

$$
Q_{\text {lost }}=C V_{r}
$$

to obtain, using Eqs. (4.30) and (4.29a),

$$
i_{D a v}=I_{L}\left(1+\pi \sqrt{2 V_{p} / V_{r}}\right)
$$

Observe that when $V_{r} \ll V_{p}$, the average diode current during conduction is much greater than the dc load current. This is not surprising, since the diode conducts for a very short interval and must replenish the charge lost by the capacitor during the much longer interval in which it is discharged by $I_{L}$.

The peak value of the diode current, $i_{D \max }$, can be determined by evaluating the expression in Eq. (4.25) at the onset of diode conduction-that is, at $t=t_{1}=-\Delta t$ (where $t=0$ is at the peak). Assuming that $i_{L}$ is almost constant at the value given by Eq. (4.26), we obtain

$$
i_{D \max }=I_{L}\left(1+2 \pi \sqrt{2 V_{p} / V_{r}}\right)
$$

From Eqs. (4.31) and (4.32), we see that for $V_{r} \ll V_{p}, i_{D \max } \simeq 2 i_{D a v}$, which correlates with the fact that the waveform of $i_{D}$ is almost a right-angle triangle (see Fig. 4.27c).

# Example 4.8 

Consider a peak rectifier fed by a $60-\mathrm{Hz}$ sinusoid having a peak value $V_{p}=100 \mathrm{~V}$. Let the load resistance $R=10 \mathrm{k} \Omega$. Find the value of the capacitance $C$ that will result in a peak-to-peak ripple of 2 V . Also, calculate the fraction of the cycle during which the diode is conducting and the average and peak values of the diode current.

## Solution

From Eq. (4.29a) we obtain the value of $C$ as

$$
C=\frac{V_{p}}{V_{r} f R}=\frac{100}{2 \times 60 \times 10 \times 10^{3}}=83.3 \mu \mathrm{~F}
$$

The conduction angle $\omega \Delta t$ is found from Eq. (4.30) as

$$
\omega \Delta t=\sqrt{2 \times 2 / 100}=0.2 \mathrm{rad}
$$

Thus the diode conducts for $(0.2 / 2 \pi) \times 100=3.18 \%$ of the cycle. The average diode current is obtained from Eq. (4.31), where $I_{L}=100 / 10=10 \mathrm{~mA}$, as

$$
i_{D a v}=10(1+\pi \sqrt{2 \times 100 / 2})=324 \mathrm{~mA}
$$

The peak diode current is found using Eq. (4.32),

$$
i_{D \max }=10(1+2 \pi \sqrt{2 \times 100 / 2})=638 \mathrm{~mA}
$$


Figure 4.28 Waveforms in the full-wave peak rectifier.

The circuit of Fig. 4.27(a) is known as a half-wave peak rectifier. The full-wave rectifier circuits of Figs. 4.24(a) and 4.25(a) can be converted to peak rectifiers by including a capacitor across the load resistor. As in the half-wave case, the output dc voltage will be almost equal to the peak value of the input sine wave (Fig. 4.28). The ripple frequency, however, will be twice that of the input. The peak-to-peak ripple voltage, for this case, can be derived using a procedure identical to that above but with the discharge period $T$ replaced by $T / 2$, resulting in

$$
V_{r}=\frac{V_{p}}{2 f C R}
$$

While the diode conduction interval, $\Delta t$, will still be given by Eq. (4.30), the average and peak currents in each of the diodes will be given by

$$
\begin{aligned}
i_{\text {Das }} & =I_{L}\left(1+\pi \sqrt{V_{p} / 2 V_{r}}\right) \\
i_{\text {Dmas }} & =I_{L}\left(1+2 \pi \sqrt{V_{p} / 2 V_{r}}\right)
\end{aligned}
$$

Comparing these expressions with the corresponding ones for the half-wave case, we note that for the same values of $V_{p}, f, R$, and $V_{r}$ (and thus the same $I_{L}$ ), we need a capacitor half the size of that required in the half-wave rectifier. Also, the current in each diode in the full-wave rectifier is approximately half that which flows in the diode of the half-wave circuit.

The analysis above assumed ideal diodes. The accuracy of the results can be improved by taking the diode voltage drop into account. This can be easily done by replacing the peak voltage $V_{p}$ to which the capacitor charges with $\left(V_{p}-V_{D}\right)$ for the half-wave circuit and the full-wave circuit using a center-tapped transformer and with $\left(V_{p}-2 V_{D}\right)$ for the bridge-rectifier case.

We conclude this section by noting that peak-rectifier circuits find application in signal-processing systems where it is required to detect the peak of an input signal. In such a case, the circuit is referred to as a peak detector. A particularly popular application of the peak detector is in the design of a demodulator for amplitude-modulated (AM) signals. We shall not discuss this application further here.
# EXERCISES 

4.22 Derive the expressions in Eqs. (4.33), (4.34), and (4.35).
4.23 Consider a bridge-rectifier circuit with a filter capacitor $C$ placed across the load resistor $R$ for the case in which the transformer secondary delivers a sinusoid of 12 V (rms) having a $60-\mathrm{Hz}$ frequency and assuming $V_{D}=0.8 \mathrm{~V}$ and a load resistance $R=100 \Omega$. Find the value of $C$ that results in a ripple voltage no larger than 1 V peak-to-peak. What is the dc voltage at the output? Find the load current. Find the diodes' conduction angle. Provide the average and peak diode currents. What is the peak reverse voltage across each diode? Specify the diode in terms of its peak current and its PIV.
Ans. $1281 \mu \mathrm{~F} ; 15.4 \mathrm{~V}$ or (a better estimate) $14.9 \mathrm{~V} ; 0.15 \mathrm{~A} ; 0.36 \mathrm{rad}\left(20.7^{\circ}\right) ; 1.45 \mathrm{~A} ; 2.74 \mathrm{~A} ; 16.2 \mathrm{~V}$. Thus select a diode with 3.5-A to 4-A peak current and a 20-V PIV rating.

## THE EARLIEST SEMICONDUCTOR DIODE:

The cat's whisker or crystal detector was the first electronic diode to be commercialized as an envelope detector for the radio-frequency signals used in radio telephony. The earliest diode, invented in Germany by Karl Ferdinand Braun, consisted of a small slab of galena (lead sulfide) to which contact was made by sharpened spring wire, which could be adjusted. For this and other contributions to early radios, Braun received the Nobel Prize in Physics in 1909. The silicon-based point-contact diode, later refined and packaged, was an important solid-state component of radar equipment during World War II.

### 4.5.5 Precision Half-Wave Rectifier—The Superdiode ${ }^{4}$

The rectifier circuits studied thus far suffer from having one or two diode drops in the signal paths. Thus these circuits work well only when the signal to be rectified is much larger than the voltage drop of a conducting diode ( 0.7 V or so). In such a case, the details of the diode forward characteristics or the exact value of the diode voltage do not play a prominent role in determining circuit performance. This is indeed the case in the application of rectifier circuits in power-supply design. There are other applications, however, where the signal to be rectified is small (e.g., on the order of 100 mV or so) and thus clearly insufficient to turn on a diode. Also, in instrumentation applications, the need arises for rectifier circuits with very precise and predictable transfer characteristics. For these applications, a class of circuits has been developed utilizing op amps (Chapter 2) together with diodes to provide precision rectification. In the following discussion, we study one such circuit. A comprehensive study of op amp-diode circuits is available on the website.

[^0]
[^0]:    ${ }^{4}$ This section requires knowledge of operational amplifiers (Chapter 2).


Figure 4.29 (a) The "superdiode" precision half-wave rectifier and (b) its almost-ideal transfer characteristic. Note that when $v_{I}>0$ and the diode conducts, the op amp supplies the load current, and the source is conveniently buffered, an added advantage. Not shown are the op-amp power supplies.

Figure 4.29(a) shows a precision half-wave rectifier circuit consisting of a diode placed in the negative-feedback path of an op amp, with $R$ being the rectifier load resistance. The op amp, of course, needs power supplies for its operation. For simplicity, these are not shown in the circuit diagram. The circuit works as follows: If $v_{I}$ goes positive, the output voltage $v_{A}$ of the op amp will go positive and the diode will conduct, thus establishing a closed feedback path between the op amp's output terminal and the negative input terminal. This negative-feedback path will cause a virtual short circuit to appear between the two input terminals of the op amp. Thus the voltage at the negative input terminal, which is also the output voltage $v_{O}$, will equal (to within a few millivolts) that at the positive input terminal, which is the input voltage $v_{I}$,

$$
v_{O}=v_{I} \quad v_{I} \geq 0
$$

Note that the offset voltage ( $\simeq 0.7 \mathrm{~V}$ ) exhibited in the simple half-wave rectifier circuit of Fig. 4.23 is no longer present. For the op-amp circuit to start operation, $v_{I}$ has to exceed only a negligibly small voltage equal to the diode drop divided by the op amp's open-loop gain. In other words, the straight-line transfer characteristic $v_{O}-v_{I}$ almost passes through the origin. This makes this circuit suitable for applications involving very small signals.

Consider now the case when $v_{I}$ goes negative. The op amp's output voltage $v_{A}$ will tend to follow and go negative. This will reverse-bias the diode, and no current will flow through resistance $R$, causing $v_{O}$ to remain equal to 0 V . Thus, for $v_{I}<0, v_{O}=0$. Since in this case the diode is off, the op amp will be operating in an open-loop fashion, and its output will be at its negative saturation level.

The transfer characteristic of this circuit will be that shown in Fig. 4.29(b), which is almost identical to the ideal characteristic of a half-wave rectifier. The nonideal diode characteristics have been almost completely masked by placing the diode in the negative-feedback path of an op amp. This is another dramatic application of negative feedback, a subject we will study formally in Chapter 11. The combination of diode and op amp, shown in the dashed box in Fig. 4.29(a), is appropriately referred to as a "superdiode."
# EXERCISES 

4.24 Consider the operational rectifier or superdiode circuit of Fig. 4.29(a), with $R=1 \mathrm{k} \Omega$. For $v_{t}=$ $10 \mathrm{mV}, 1 \mathrm{~V}$, and -1 V , what are the voltages that result at the rectifier output and at the output of the op amp? Assume that the op amp is ideal and that its output saturates at $\pm 12 \mathrm{~V}$. The diode has a $0.7-\mathrm{V}$ drop at $1-\mathrm{mA}$ current.
Ans. $10 \mathrm{mV}, 0.59 \mathrm{~V} ; 1 \mathrm{~V}, 1.7 \mathrm{~V} ; 0 \mathrm{~V},-12 \mathrm{~V}$
4.25 If the diode in the circuit of Fig. 4.29(a) is reversed, find the transfer characteristic $v_{o}$ as a function of $v_{t}$.
Ans. $v_{o}=0$ for $v_{t} \geq 0 ; v_{o}=v_{t}$ for $v_{t} \leq 0$

### 4.6 Limiting and Clamping Circuits

In this section, we shall present additional nonlinear circuit applications of diodes.

### 4.6.1 Limiter Circuits

Figure 4.30 shows the general transfer characteristic of a limiter circuit. As indicated, for inputs in a certain range, $L_{-} / K \leq v_{t} \leq L_{+} / K$, the limiter acts as a linear circuit, providing an output proportional to the input, $v_{o}=K v_{t}$. Although in general $K$ can be greater than 1 , the


Figure 4.30 General transfer characteristic for a limiter circuit.circuits discussed in this section have $K \leq 1$ and are known as passive limiters. (Examples of active limiters will be presented in Chapter 18.) If $v_{l}$ exceeds the upper threshold $\left(L_{+} / K\right)$, the output voltage is limited or clamped to the upper limiting level $L_{+}$. On the other hand, if $v_{l}$ is reduced below the lower limiting threshold $\left(L_{-} / K\right)$, the output voltage $v_{O}$ is limited to the lower limiting level $L_{-}$.

The general transfer characteristic of Fig. 4.30 describes a double limiter-that is, a limiter that works on both the positive and negative peaks of an input waveform. Single limiters, of course, exist. Finally, note that if an input waveform such as that shown in Fig. 4.31 is fed to a double limiter, its two peaks will be clipped off. Limiters therefore are sometimes referred to as clippers.

The limiter whose characteristics are depicted in Fig. 4.30 is described as a hard limiter. Soft limiting is characterized by smoother transitions between the linear region and the saturation regions and a slope greater than zero in the saturation regions, as illustrated in Fig. 4.32. Depending on the application, either hard or soft limiting may be preferred.

Limiters find application in a variety of signal-processing systems. One of their simplest applications is in limiting the voltage between the two input terminals of an op amp to a value lower than the breakdown voltage of the transistors that make up the input stage of the op-amp circuit. We will have more to say on this and other limiter applications at later points in this book.

Diodes can be combined with resistors to provide simple realizations of the limiter function. A number of examples are depicted in Fig. 4.33. In each part of the figure both the circuit and its transfer characteristic are given. The transfer characteristics are obtained using the constant-voltage-drop $\left(V_{D}=0.7 \mathrm{~V}\right)$ diode model but assuming a smooth transition between the linear and saturation regions of the transfer characteristic.

The circuit in Fig. 4.33(a) is that of the half-wave rectifier except that here the output is taken across the diode. For $v_{I}<0.5 \mathrm{~V}$, the diode is cut off, no current flows, and the voltage drop across $R$ is zero; thus $v_{O}=v_{I}$. As $v_{I}$ exceeds 0.5 V , the diode turns on, eventually limiting


Figure 4.31 Applying a sine wave to a limiter can result in clipping off its two peaks.


Figure 4.32 Soft limiting.


Figure 4.33 A variety of basic limiting circuits.
$v_{O}$ to one diode drop ( 0.7 V ). The circuit of Fig. 4.33(b) is similar to that in Fig. 4.33(a) except that the diode is reversed.

Double limiting can be implemented by placing two diodes of opposite polarity in parallel, as shown in Fig. 4.33(c). Here the linear region of the characteristic is obtained for $-0.5 \mathrm{~V} \leq v_{I} \leq 0.5 \mathrm{~V}$. For this range of $v_{I}$, both diodes are off and $v_{O}=v_{I}$. As $v_{I}$ exceeds 0.5 V , $D_{1}$ turns on and eventually limits $v_{O}$ to +0.7 V . Similarly, as $v_{I}$ goes more negative than -0.5 V , $D_{2}$ turns on and eventually limits $v_{O}$ to -0.7 V .

The thresholds and saturation levels of diode limiters can be controlled by using strings of diodes and/or by connecting a dc voltage in series with the diode(s). The latter idea is illustrated in Fig. 4.33(d). Finally, rather than strings of diodes, we may use two zener diodes in series, as shown in Fig. 4.33(e). In this circuit, limiting occurs in the positive direction at a voltage of $V_{Z 2}+0.7$, where 0.7 V represents the voltage drop across zener diode $Z_{1}$ when conducting in the forward direction. For negative inputs, $Z_{1}$ acts as a zener, while $Z_{2}$ conducts
in the forward direction. It should be mentioned that pairs of zener diodes connected in series are available commercially for applications of this type under the name double-anode zener.

More flexible limiter circuits are possible if op amps are combined with diodes and resistors. Examples of such circuits are discussed in Chapter 18.

# EXERCISE 

4.26 Assuming the diodes to be ideal, describe the transfer characteristic of the circuit shown in Fig. E4.26.


Figure E4.26

Ans. $v_{o}=v_{t} \quad$ for $-5 \leq v_{t} \leq+5$
$v_{o}=\frac{1}{2} v_{t}-2.5 \quad$ for $v_{t} \leq-5$
$v_{o}=\frac{1}{2} v_{t}+2.5 \quad$ for $v_{t} \geq+5$

### 4.6.2 The Clamped Capacitor or DC Restorer

If in the basic peak-rectifier circuit, the output is taken across the diode rather than across the capacitor, an interesting circuit with important applications results. The circuit, called a dc restorer, is shown in Fig. 4.34 fed with a square wave. Because of the polarity in which the diode is connected, the capacitor will charge to a voltage $v_{C}$ with the polarity indicated in Fig. 4.34 and equal to the magnitude of the most negative peak of the input signal. Subsequently, the diode turns off and the capacitor retains its voltage indefinitely. If,


Figure 4.34 The clamped capacitor or dc restorer with a square-wave input and no load.
for instance, the input square wave has the arbitrary levels -6 V and +4 V , then $v_{C}$ will be equal to 6 V . Now, since the output voltage $v_{O}$ is given by

$$
v_{O}=v_{I}+v_{C}
$$

it follows that the output waveform will be identical to that of the input, except that it is shifted upward by $v_{C}$ volts. In our example the output will thus be a square wave with levels of 0 V and +10 V .

Another way of visualizing the operation of the circuit in Fig. 4.34 is to note that because the diode is connected across the output with the polarity shown, it prevents the output voltage from going below 0 V (by conducting and charging up the capacitor, thus causing the output to rise to 0 V ), but this connection will not constrain the positive excursion of $v_{O}$. The output waveform will therefore have its lowest peak clamped to 0 V , which is why the circuit is called a clamped capacitor. It should be obvious that reversing the diode polarity will provide an output waveform whose highest peak is clamped to 0 V . In either case, the output waveform will have a finite average value or dc component. This dc component is entirely unrelated to the average value of the input waveform. As an application, consider a pulse signal being transmitted through a capacitively coupled or ac-coupled system. The capacitive coupling will cause the pulse train to lose whatever dc component it originally had. Feeding the resulting pulse waveform to a clamping circuit provides it with a well-determined dc component, a process known as dc restoration. This is why the circuit is also called a dc restorer.

Restoring dc is useful because the dc component or average value of a pulse waveform is an effective measure of its duty cycle. ${ }^{5}$ The duty cycle of a pulse waveform can be modulated (in a process called pulsewidth modulation) and made to carry information. In such a system, detection or demodulation could be achieved simply by feeding the received pulse waveform to a dc restorer and then using a simple $R C$ low-pass filter to separate the average of the output waveform from the superimposed pulses.

When a load resistance $R$ is connected across the diode in a clamping circuit, as shown in Fig. 4.35, the situation changes significantly. While the output is above ground, a current must flow in $R$. Since at this time the diode is off, this current obviously comes from the capacitor,



Figure 4.35 The clamped capacitor with a load resistance $R$.

[^0]
[^0]:    ${ }^{5}$ The duty cycle of a pulse waveform is the proportion of each cycle occupied by the pulse. In other words, it is the pulse width expressed as a fraction of the pulse period.
thus causing the capacitor to discharge and the output voltage to fall. This is shown in Fig. 4.35 for a square-wave input. During the interval $t_{0}$ to $t_{1}$, the output voltage falls exponentially with time constant $C R$. At $t_{1}$ the input decreases by $V_{a}$ volts, and the output attempts to follow. This causes the diode to conduct heavily and to quickly charge the capacitor. At the end of the interval $t_{1}$ to $t_{2}$, the output voltage would normally be a few tenths of a volt negative (e.g., $-0.5 \mathrm{~V}$ ). Then, as the input rises by $V_{a}$ volts (at $t_{2}$ ), the output follows, and the cycle repeats itself. In the steady state the charge lost by the capacitor during the interval $t_{0}$ to $t_{1}$ is recovered during the interval $t_{1}$ to $t_{2}$. This charge equilibrium enables us to calculate the average diode current as well as the details of the output waveform.

# 4.6.3 The Voltage Doubler 

Figure 4.36(a) shows a circuit composed of two sections in cascade: a clamped capacitor formed by $C_{1}$ and $D_{1}$, and a peak rectifier formed by $D_{2}$ and $C_{2}$. When excited by a sinusoid of amplitude $V_{p}$ the clamping section provides the voltage waveform $v_{D 1}$ shown, assuming ideal diodes, in Fig. 4.36(b). Note that while the positive peaks are clamped to 0 V , the negative peak reaches $-2 V_{p}$. In response to this waveform, the peak-detector section provides across capacitor $C_{2}$ a dc voltage equal to the negative peak of $v_{D 1}$, that is, $-2 V_{p}$. Because the output voltage is double the input peak, the circuit is known as a voltage doubler. The technique can be extended to provide output dc voltages that are higher multiples of $V_{p}$.

(a)

(b)

Figure 4.36 Voltage doubler: (a) circuit; (b) waveforms of the input voltage, the voltage across $D_{1}$, and the output voltage $v_{o}=-2 V_{p}$.
# EXERCISE 

4.27 If the diode in the circuit of Fig. 4.34 is reversed, what will the dc component of $v_{O}$ become? Ans. $\sim 5 \mathrm{~V}$

### 4.7 Special Diode Types

In this section, we discuss briefly some important special types of diodes.

### 4.7.1 The Schottky-Barrier Diode (SBD)

The Schottky-barrier diode (SBD) is formed by bringing metal into contact with a moderately doped $n$-type semiconductor material. The resulting metal-semiconductor junction behaves like a diode, conducting current in one direction (from the metal anode to the semiconductor cathode) and acting as an open circuit in the other, and is known as the Schottky-barrier diode or simply the Schottky diode. In fact, the current-voltage characteristic of the SBD is remarkably similar to that of a $p n$-junction diode, with two important exceptions:

1. In the SBD, current is conducted by majority carriers (electrons). Thus the SBD does not exhibit the minority-carrier charge-storage effects found in forward-biased pn junctions. As a result, Schottky diodes can be switched from on to off, and vice versa, much faster than is possible with $p n$-junction diodes.
2. The forward voltage drop of a conducting SBD is lower than that of a $p n$-junction diode. For example, an SBD made of silicon exhibits a forward voltage drop of 0.3 V to 0.5 V , compared to the 0.6 V to 0.8 V found in silicon $p n$-junction diodes. SBDs can also be made of gallium arsenide ( GaAs ) and, in fact, play an important role in the design of GaAs circuits. ${ }^{6}$ Gallium-arsenide SBDs exhibit forward voltage drops of about 0.7 V .
Apart from GaAs circuits, Schottky diodes find application in the design of a special form of bipolar-transistor logic circuits, known as Schottky-TTL, where TTL stands for transistor-transistor logic.

Before leaving the subject of Schottky-barrier diodes, it is important to note that not every metal-semiconductor contact is a diode. In fact, metal is commonly deposited on the semiconductor surface in order to make terminals for the semiconductor devices and to connect different devices in an integrated-circuit chip. Such metal-semiconductor contacts are known as ohmic contacts to distinguish them from the rectifying contacts that result in SBDs. Ohmic contacts are usually made by depositing metal on very heavily doped (and thus low-resistivity) semiconductor regions. (Recall that SBDs use moderately doped material.)

[^0]
[^0]:    ${ }^{6}$ The website accompanying this text contains material on GaAs circuits.
# 4.7.2 Varactors 

In Chapter 3 we learned that reverse-biased $p n$ junctions exhibit a charge-storage effect that is modeled with the depletion-layer or junction capacitance $C_{j}$. As Eq. (3.49) indicates, $C_{j}$ is a function of the reverse-bias voltage $V_{R}$. This dependence turns out to be useful in a number of applications, such as the automatic tuning of radio receivers. Special diodes are therefore fabricated to be used as voltage-variable capacitors known as varactors. These devices are optimized to make the capacitance a strong function of voltage by arranging that the grading coefficient $m$ is 3 or 4 .

### 4.7.3 Photodiodes

If a reverse-biased $p n$ junction is illuminated-that is, exposed to incident light-the photons impacting the junction cause covalent bonds to break, and thus electron-hole pairs are generated in the depletion layer. The electric field in the depletion region then sweeps the liberated electrons to the $n$ side and the holes to the $p$ side, giving rise to a reverse current across the junction. This current, known as photocurrent, is proportional to the intensity of the incident light. Such a diode, called a photodiode, can be used to convert light signals into electrical signals.

Photodiodes are usually fabricated using a compound semiconductor ${ }^{7}$ such as gallium arsenide. The photodiode is an important component of a growing family of circuits known as optoelectronics or photonics. As the name implies, such circuits utilize an optimum combination of electronics and optics for signal processing, storage, and transmission. Usually, electronics is the preferred means for signal processing, whereas optics is most suited for transmission and storage. Examples include fiber-optic transmission of telephone and television signals and the use of optical storage in CD-ROM computer discs. Optical transmission provides very wide bandwidths and low signal attenuation. Optical storage allows vast amounts of data to be stored reliably in a small space.

Finally, we should note that without reverse bias, the illuminated photodiode functions as a solar cell. Usually fabricated from low-cost silicon, a solar cell converts light to electrical energy.

### 4.7.4 Light-Emitting Diodes (LEDs)

The light-emitting diode (LED) performs the inverse of the function of the photodiode; it converts a forward current into light. The reader will recall from Chapter 3 that in a forward-biased $p n$ junction, minority carriers are injected across the junction and diffuse into the $p$ and $n$ regions. The diffusing minority carriers then recombine with the majority carriers. Such recombination can be made to give rise to light emission. This can be done by fabricating the $p n$ junction using a semiconductor of the type known as direct-bandgap materials. Gallium arsenide belongs to this group and can thus be used to fabricate light-emitting diodes.

The light emitted by an LED is proportional to the number of recombinations that take place, which in turn is proportional to the forward current in the diode.

[^0]
[^0]:    ${ }^{7}$ Whereas an elemental semiconductor, such as silicon, uses an element from column IV of the periodic table, a compound semiconductor uses a combination of elements from columns III and V or II and VI. For example, GaAs is formed of gallium (column III) and arsenic (column V) and is thus known as a III-V compound.
LEDs are very popular devices. They find application in the design of numerous types of displays, including the displays of laboratory instruments such as digital voltmeters. They can be made to produce light in a variety of colors. Furthermore, LEDs can be designed so as to produce coherent light with a very narrow bandwidth. The resulting device is a laser diode. Laser diodes find application in optical communication systems and in DVD players, among other things.

Combining an LED with a photodiode in the same package results in a device known as an optoisolator. The LED converts an electrical signal applied to the optoisolator into light, which the photodiode detects and converts back to an electrical signal at the output of the optoisolator. Use of the optoisolator provides complete electrical isolation between the electrical circuit that is connected to the isolator's input and the circuit that is connected to its output. Such isolation can be useful in reducing the effect of electrical interference on signal transmission within a system, and thus optoisolators are frequently employed in the design of digital systems. They can also be used in the design of medical instruments to reduce the risk of electrical shock to patients.

Note that the optical coupling between an LED and a photodiode need not be accomplished inside a small package. Indeed, it can be implemented over a long distance using an optical fiber, as is done in fiber-optic communication links.

## FROM INDICATION TO ILLUMINATION:

Light-emitting diodes (LEDs), which once served only as low-powered status indicators, are now lighting our way! Increasingly, automotive lighting uses LEDs; increasingly, too, LED bulbs of higher and higher power are replacing both incandescent and fluorescent lighting in homes and offices. Incandescent bulbs are only $5 \%$ efficient in the conversion of electricity into light-the other $95 \%$ is dissipated as heat. The light conversion efficiency of LEDs, however, is $60 \%$. Moreover, LEDs last 25 times longer ( 25,000 hours) than incandescent bulbs and 3 times longer than fluorescents.

# Summary 

- In the forward direction, the ideal diode conducts any current forced by the external circuit while displaying a zero voltage drop. The ideal diode does not conduct in the reverse direction; any applied voltage appears as reverse bias across the diode.
- The unidirectional-current-flow property makes the diode useful in the design of rectifier circuits.
- The forward conduction of practical silicon-junction diodes is accurately characterized by the relationship $i=I_{S} e^{z / V_{T}}$.
- A silicon diode conducts a negligible current until the forward voltage is at least 0.5 V . Then the current increases rapidly, with the voltage drop increasing by 60 mV for every decade of current change.
- In the reverse direction, a silicon diode conducts a current on the order of $10^{-9} \mathrm{~A}$. This current is much greater than $I_{S}$ because of leakage effects and increases with the magnitude of reverse voltage.
- Beyond a certain value of reverse voltage (that depends on the diode), breakdown occurs, and current increases rapidly with a small corresponding increase in voltage.
- Diodes designed to operate in the breakdown region are called zener diodes. They are employed in the design of voltage regulators whose function is to provide a constant dc voltage that varies little with variations in power-supply voltage and/or load current.
- In many applications, a conducting diode is modeled as having a constant voltage drop, usually approximately 0.7 V .
- A diode biased to operate at a dc current $I_{D}$ has a small-signal resistance $r_{d}=V_{T} / I_{D}$.
- Rectifiers convert ac voltages into unipolar voltages. Half-wave rectifiers do this by passing the voltage in half of each cycle and blocking the opposite-polarity voltage in the other half of the cycle. Full-wave rectifiers accomplish the task by passing the voltage in half of each cycle and inverting the voltage in the other half-cycle.
- The bridge-rectifier circuit is the preferred full-wave rectifier configuration.
- The variation of the output waveform of the rectifier is reduced considerably by connecting a capacitor $C$ across the output load resistance $R$. The resulting circuit is the peak rectifier. The output waveform then consists of a dc voltage almost equal to the peak of the input sine
wave, $V_{p}$, on which is superimposed a ripple component of frequency $2 f$ (in the full-wave case) and of peak-to-peak amplitude $V_{c}=V_{p} / 2 f C R$. To reduce this ripple voltage further, a voltage regulator is employed.
- Combination of diodes, resistors, and possibly reference voltages can be used to design voltage limiters that prevent one or both extremities of the output waveform from going beyond predetermined values, the limiting level(s).
- Applying a time-varying waveform to a circuit consisting of a capacitor in series with a diode and taking the output across the diode provides a clamping function. Specifically, depending on the polarity of the diode, either the positive or negative peaks of the signal will be clamped to the voltage at the other terminal of the diode (usually ground). In this way the output waveform has a nonzero average or dc component, and the circuit is known as a dc restorer.
- By cascading a clamping circuit with a peak-rectifier circuit, a voltage doubler is realized.


# PROBLEMS 

## Computer Simulation Problems

TIE Problems identified by the Multisim/PSpice icon are intended to demonstrate the value of using SPICE simulation to verify hand analysis and design, and to investigate important issues such as allowable signal swing and amplifier nonlinear distortion. Instructions to assist in setting up PSPice and Multisim simulations for all the indicated problems can be found in the corresponding files on the website. Note that if a particular parameter value is not specified in the problem statement, you are to make a reasonable assumption.

## Section 4.1: The Ideal Diode

4.1 An AA flashlight cell, whose Thévenin equivalent is a voltage source of 1.5 V and a resistance of $1 \Omega$, is connected
to the terminals of an ideal diode. Describe two possible situations that result. What are the diode current and terminal voltage when (a) the connection is between the diode cathode and the positive terminal of the battery and (b) the anode and the positive terminal are connected?
4.2 For the circuits shown in Fig. P4.2 using ideal diodes, find the values of the voltages and currents indicated.
4.3 For the circuits shown in Fig. P4.3 using ideal diodes, find the values of the labeled voltages and currents.
4.4 In each of the ideal-diode circuits shown in Fig. P4.4, $v_{I}$ is a $1-\mathrm{kHz}, 5-\mathrm{V}$ peak sine wave. Sketch the waveform resulting at $v_{H}$. What are its positive and negative peak values?


Figure P4.2


Figure P4.3


Figure P4.4

[^0]
[^0]:    $\mathrm{SHI}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; $\mathrm{D}=$ design problem

Figure P4.4 continued
4.5 The circuit shown in Fig. P4.5 is a model for a battery charger. Here $v_{t}$ is a $6-\mathrm{V}$ peak sine wave, $D_{1}$ and $D_{2}$ are ideal diodes, $I$ is a $60-\mathrm{mA}$ current source, and $B$ is a $3-\mathrm{V}$ battery. Sketch and label the waveform of the battery current $i_{B}$. What is its peak value? What is its average value? If the peak value of $v_{t}$ is reduced by $10 \%$, what do the peak and average values of $i_{B}$ become?


Figure P4.5
4.6 The circuits shown in Fig. P4.6 can function as logic gates for input voltages that are either high or low. Using " 1 " to denote the high value and " 0 " to denote the low value, prepare a table with four columns including all possible input combinations and the resulting values of $X$ and $Y$. What logic function is $X$ of $A$ and $B$ ? What logic function is $Y$ of $A$ and $B$ ? For what values of $A$ and $B$ do $X$ and $Y$ have the same value? For what values of $A$ and $B$ do $X$ and $Y$ have opposite values?


Figure P4.6

[^0]
[^0]:    3110 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
D 4.7 For the logic gate of Fig. 4.5(a), assume ideal diodes and input voltage levels of 0 V and +5 V . Find a suitable value for $R$ so that the current required from each of the input signal sources does not exceed 0.2 mA .

D 4.8 Repeat Problem 4.7 for the logic gate of Fig. 4.5(b).
4.9 Assuming that the diodes in the circuits of Fig. P4.9 are ideal, find the values of the labeled voltages and currents.


Figure P4.9
4.10 Assuming that the diodes in the circuits of Fig. P4.10 are ideal, utilize Thévenin's theorem to simplify the circuits and thus find the values of the labeled currents and voltages.


Figure P4.10
D 4.11 For the rectifier circuit of Fig. 4.3(a), let the input sine wave have $120-\mathrm{V}$ rms value and assume the diode to
be ideal. Select a suitable value for $R$ so that the peak diode current does not exceed 40 mA . What is the greatest reverse voltage that will appear across the diode?
4.12 Consider the rectifier circuit of Fig. 4.3(a) in the event that the input source $v_{I}$ has a source resistance $R_{s}$. For the case $R_{s}=R$ and assuming the diode to be ideal, sketch and clearly label the transfer characteristic $v_{O}$ versus $v_{I}$.
4.13 A symmetrical square wave of $5-\mathrm{V}$ peak-to-peak amplitude and zero average is applied to a circuit resembling that in Fig. 4.3(a) and employing a $100-\Omega$ resistor. What is the peak output voltage that results? What is the average output voltage that results? What is the peak diode current? What is the average diode current? What is the maximum reverse voltage across the diode?
4.14 Repeat Problem 4.13 for the situation in which the average voltage of the square wave is 1 V , while its peak-to-peak value remains at 5 V .

D *4.15 Design a battery-charging circuit, resembling that in Fig. 4.4(a) and using an ideal diode, in which current flows to the $12-\mathrm{V}$ battery $25 \%$ of the time with an average value of 100 mA . What peak-to-peak sine-wave voltage is required? What resistance is required? What peak diode current flows? What peak reverse voltage does the diode endure? If resistors can be specified to only one significant digit, and the peak-to-peak voltage only to the nearest volt, what design would you choose to guarantee the required charging current? What fraction of the cycle does diode current flow? What is the average diode current? What is the peak diode current? What peak reverse voltage does the diode endure?
4.16 The circuit of Fig. P4.16 can be used in a signaling system using one wire plus a common ground return. At any moment, the input has one of three values: $+3 \mathrm{~V}, 0 \mathrm{~V},-3 \mathrm{~V}$.


Figure P4.16

[^0]
[^0]:    4.14 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
What is the status of the lamps for each input value? (Note that the lamps can be located apart from each other and that there may be several of each type of connection, all on one wire!)

## Section 4.2: Terminal Characteristics of Junction Diodes

4.17 Calculate the value of the thermal voltage, $V_{T}$, at $-55^{\circ} \mathrm{C}, 0^{\circ} \mathrm{C},+40^{\circ} \mathrm{C}$, and $+125^{\circ} \mathrm{C}$. At what temperature is $V_{T}$ exactly 25 mV ?
4.18 At what forward voltage does a diode conduct a current equal to $10,000 I_{S}$ ? In terms of $I_{S}$, what current flows in the same diode when its forward voltage is 0.7 V ?
4.19 A diode for which the forward voltage drop is 0.7 V at 1.0 mA is operated at 0.5 V . What is the value of the current?
4.20 A particular diode is found to conduct 1 mA with a junction voltage of 0.7 V . What current will flow in this diode if the junction voltage is raised to 0.71 V ? To 0.8 V ? If the junction voltage is lowered to 0.69 V ? To 0.6 V ? What change in junction voltage will increase the diode current by a factor of 10 ?
4.21 The following measurements are taken on particular junction diodes for which $V$ is the terminal voltage and $I$ is the diode current. For each diode, estimate values of $I_{S}$ and the terminal voltage at $10 \%$ of the measured current.
(a) $V=0.700 \mathrm{~V}$ at $I=1.00 \mathrm{~A}$
(b) $V=0.650 \mathrm{~V}$ at $I=1.00 \mathrm{~mA}$
(c) $V=0.650 \mathrm{~V}$ at $I=10 \mu \mathrm{~A}$
(d) $V=0.700 \mathrm{~V}$ at $I=100 \mathrm{~mA}$
4.22 Listed below are the results of measurements taken on several different junction diodes. For each diode, the data provided are the diode current $I$ and the corresponding diode voltage $V$. In each case, estimate $I_{S}$, and the diode voltage at $10 I$ and $I / 10$.
(a) $10.0 \mathrm{~mA}, 700 \mathrm{mV}$
(b) $1.0 \mathrm{~mA}, 700 \mathrm{mV}$
(c) $10 \mathrm{~A}, 800 \mathrm{mV}$
(d) $1 \mathrm{~mA}, 700 \mathrm{mV}$
(e) $10 \mu \mathrm{~A}, 600 \mathrm{mV}$
4.23 The circuit in Fig. P4.23 utilizes three identical diodes having $I_{S}=10^{-14} \mathrm{~A}$. Find the value of the current $I$ required to obtain an output voltage $V_{O}=2.0 \mathrm{~V}$. If a current of 1 mA is drawn away from the output terminal by a load, what is the change in output voltage?


Figure P4.23
4.24 A junction diode is operated in a circuit in which it is supplied with a constant current $I$. What is the effect on the forward voltage of the diode if an identical diode is connected in parallel?
4.25 Two diodes with saturation currents $I_{S 1}$ and $I_{S 2}$ are connected in parallel with their cathodes joined together and connected to grounds. The two anodes are joined together and fed with a constant current $I$. Find the currents $I_{D 1}$ and $I_{D 2}$ that flow through the two diodes, and the voltage $V_{D}$ that appears across their parallel combination.
4.26 Four diodes are connected in parallel: anodes joined together and fed with a constant current $I$, and cathodes joined together and connected to ground. What relative junction areas should these diodes have if their currents must have binary-weighted ratios, with the smallest being 0.1 mA ? What value of $I$ is needed?
4.27 In the circuit shown in Fig. P4.27, $D_{1}$ has 10 times the junction area of $D_{2}$. What value of $V$ results? To obtain a value for $V$ of 60 mV , what current $I_{2}$ is needed?


Figure P4.27
4.28 For the circuit shown in Fig. P4.28, both diodes are identical. Find the value of $R$ for which $V=50 \mathrm{mV}$.


Figure P4.28
4.29 A diode fed with a constant current $I=1 \mathrm{~mA}$ has a voltage $V=690 \mathrm{mV}$ at $20^{\circ} \mathrm{C}$. Find the diode voltage at $-20^{\circ} \mathrm{C}$ and at $+85^{\circ} \mathrm{C}$.
4.30 In the circuit shown in Fig. P4.30, $D_{1}$ is a large-area, high-current diode whose reverse leakage is high and independent of applied voltage, while $D_{2}$ is a much smaller, low-current diode. At an ambient temperature of $20^{\circ} \mathrm{C}$, resistor $R_{1}$ is adjusted to make $V_{R 1}=V_{2}=520 \mathrm{mV}$. Subsequent measurement indicates that $R_{1}$ is $520 \mathrm{k} \Omega$. What do you expect the voltages $V_{R 1}$ and $V_{2}$ to become at $0^{\circ} \mathrm{C}$ and at $40^{\circ} \mathrm{C}$ ?


Figure P4.30
4.31 When a 10-A current is applied to a particular diode, it is found that the junction voltage immediately becomes 700 mV . However, as the power being dissipated in the diode raises its temperature, it is found that the voltage decreases and eventually reaches 600 mV . What is the apparent rise in
junction temperature? What is the power dissipated in the diode in its final state? What is the temperature rise per watt of power dissipation? (This is called the thermal resistance.)
*4.32 A designer of an instrument that must operate over a wide supply-voltage range, noting that a diode's junction-voltage drop is relatively independent of junction current, considers the use of a large diode to establish a small relatively constant voltage. A power diode, for which the nominal current at 0.8 V is 10 A , is available. If the current source feeding the diode changes in the range 1 mA to 3 mA and if, in addition, the temperature changes by $\pm 20^{\circ} \mathrm{C}$, what is the expected range of diode voltage?
*4.33 As an alternative to the idea suggested in Problem 4.32, the designer considers a second approach to producing a relatively constant small voltage from a variable current supply: It relies on the ability to make quite accurate copies of any small current that is available (using a process called current mirroring). The designer proposes to use this idea to supply two diodes of different junction areas with equal currents and to measure their junction-voltage difference. Two types of diodes are available: for a forward voltage of 700 mV , one conducts 0.1 mA , while the other conducts 1 A . Now, for identical currents in the range of 1 mA to 3 mA supplied to each, what range of difference voltages result? What is the effect of a temperature change of $\pm 20^{\circ} \mathrm{C}$ on this arrangement?

## Section 4.3: Modeling the Diode Forward Characteristic

*4.34 Consider the graphical analysis of the diode circuit of Fig. 4.10 with $V_{D D}=1 \mathrm{~V}, R=1 \mathrm{k} \Omega$, and a diode having $I_{S}=10^{-15} \mathrm{~A}$. Calculate a small number of points on the diode characteristic in the vicinity of where you expect the load line to intersect it, and use a graphical process to refine your estimate of diode current. What value of diode current and voltage do you find? Analytically, find the voltage corresponding to your estimate of current. By how much does it differ from the graphically estimated value?
4.35 Use the iterative-analysis procedure to determine the diode current and voltage in the circuit of Fig. 4.10 for $V_{D D}=1 \mathrm{~V}, R=1 \mathrm{k} \Omega$, and a diode having $I_{S}=10^{-15} \mathrm{~A}$.
4.36 A "1-mA diode" (i.e., one that has $v_{D}=0.7 \mathrm{~V}$ at $i_{D}=$ 1 mA ) is connected in series with a $500-\Omega$ resistor to a 1.0 V supply.

[^0]
[^0]:    3111 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
(a) Provide a rough estimate of the diode current you would expect.
(b) Estimate the diode current more closely using iterative analysis.

D 4.37 Assuming the availability of diodes for which $v_{D}=$ 0.75 V at $i_{D}=1 \mathrm{~mA}$, design a circuit that utilizes four diodes connected in series, in series with a resistor $R$ connected to a $15-\mathrm{V}$ power supply. The voltage across the string of diodes is to be 3.3 V .
4.38 A diode operates in a series circuit with a resistance $R$ and a dc source $V$. A designer, considering using a constant-voltage model, is uncertain whether to use 0.7 V or 0.6 V for $V_{D}$. For what value of $V$ is the difference in the calculated values of current only $1 \%$ ? For $V=3 \mathrm{~V}$ and $R=1 \mathrm{k} \Omega$, what two current estimates would result from the use of the two values of $V_{D}$ ? What is their percentage difference?
4.39 A designer has a supply of diodes for which a current of 2 mA flows at 0.7 V . Using a $1-\mathrm{mA}$ current source, the designer wishes to create a reference voltage of 1.3 V . Suggest a combination of series and parallel diodes that will do the job as well as possible. How many diodes are needed? What voltage is actually achieved?
4.40 Solve the problems in Example 4.2 using the constant-voltage-drop $\left(V_{D}=0.7 \mathrm{~V}\right)$ diode model.
4.41 For the circuits shown in Fig. P4.2, using the constant-voltage-drop ( $V_{D}=0.7 \mathrm{~V}$ ) diode model, find the voltages and currents indicated.
4.42 For the circuits shown in Fig. P4.3, using the constant-voltage-drop $\left(V_{D}=0.7 \mathrm{~V}\right)$ diode model, find the voltages and currents indicated.
4.43 For the circuits in Fig. P4.9, using the constant-voltage-drop $\left(V_{D}=0.7 \mathrm{~V}\right)$ diode model, find the values of the labeled currents and voltages.
4.44 For the circuits in Fig. P4.10, utilize Thévenin's theorem to simplify the circuits and find the values of the labeled currents and voltages. Assume that conducting diodes can be represented by the constant-voltage-drop model $\left(V_{D}=0.7 \mathrm{~V}\right)$.

D 4.45 Repeat Problem 4.11, representing the diode by the constant-voltage-drop $\left(V_{D}=0.7 \mathrm{~V}\right)$ model. How different is the resulting design?
4.46 The small-signal model is said to be valid for voltage variations of about 5 mV . To what percentage current change does this correspond? (Consider both positive and negative signals.) What is the maximum allowable voltage signal (positive or negative) if the current change is to be limited to $10 \%$ ?
4.47 In a particular circuit application, ten " $20-\mathrm{mA}$ diodes" (a $20-\mathrm{mA}$ diode is a diode that provides a $0.7-\mathrm{V}$ drop when the current through it is 20 mA ) connected in parallel operate at a total current of 0.1 A . For the diodes closely matched, what current flows in each? What is the corresponding small-signal resistance of each diode and of the combination? Compare this with the incremental resistance of a single diode conducting 0.1 A . If each of the $20-\mathrm{mA}$ diodes has a series resistance of $0.2 \Omega$ associated with the wire bonds to the junction, what is the equivalent resistance of the 10 parallel-connected diodes? What connection resistance would a single diode need in order to be totally equivalent? (Note: This is why the parallel connection of real diodes can often be used to advantage.)
4.48 In the circuit shown in Fig. P4.48, $I$ is a dc current and $v_{s}$ is a sinusoidal signal. Capacitors $C_{1}$ and $C_{2}$ are very large; their function is to couple the signal to and from the diode but block the dc current from flowing into the signal source or the load (not shown). Use the diode small-signal model to show that the signal component of the output voltage is

$$
v_{o}=v_{s} \frac{V_{T}}{V_{T}+I R_{s}}
$$

If $v_{s}=10 \mathrm{mV}$, find $v_{o}$ for $I=1 \mathrm{~mA}, 0.1 \mathrm{~mA}$, and $1 \mu \mathrm{~A}$. Let $R_{s}=1 \mathrm{k} \Omega$. At what value of $I$ does $v_{o}$ become one-half of $v_{s}$ ? Note that this circuit functions as a signal attenuator with the attenuation factor controlled by the value of the dc current $I$.


Figure P4.48
4.49 In the attenuator circuit of Fig. P4.48, let $R_{s}=10 \mathrm{k} \Omega$. The diode is a $1-\mathrm{mA}$ device; that is, it exhibits a voltage drop of 0.7 V at a dc current of 1 mA . For small input signals, what value of current $I$ is needed for $v_{o} / v_{s}=0.50$ ? 0.10 ? 0.01 ? 0.001 ? In each case, what is the largest input signal that can be used while ensuring that the signal component of the diode current is limited to $\pm 10 \%$ of its dc current? What output signals correspond?
4.50 In the capacitor-coupled attenuator circuit shown in Fig. P4.50, $I$ is a dc current that varies from 0 mA to 1 mA , and $C_{1}$ and $C_{2}$ are large coupling capacitors. For very small input signals, so that the diodes can be represented by their small-signal resistances $r_{d 1}$ and $r_{d 2}$, give the small-signal equivalent circuit and thus show that $\frac{v_{o}}{v_{i}}=\frac{r_{d 2}}{r_{d 1}+r_{d 2}}$ and hence that $\frac{v_{o}}{v_{i}}=I$, where $I$ is in mA . Find $v_{o} / v_{i}$ for $I=0 \mu \mathrm{~A}, 1 \mu \mathrm{~A}$, $10 \mu \mathrm{~A}, 100 \mu \mathrm{~A}, 500 \mu \mathrm{~A}, 600 \mu \mathrm{~A}, 900 \mu \mathrm{~A}, 990 \mu \mathrm{~A}$, and 1 mA . Note that this is a signal attenuator whose transmission is linearly controlled by the dc current $I$.


Figure P4.50
*4.51 In the circuit shown in Fig. P4.51, diodes $D_{1}$ through $D_{4}$ are identical, and each exhibits a voltage drop of 0.7 V at a $1-\mathrm{mA}$ current.
(a) For small input signals (e.g., $10-\mathrm{mV}$ peak), find the small-signal equivalent circuit and use it to determine values of the small-signal transmission $v_{o} / v_{i}$ for various values of $I: 0 \mu \mathrm{~A}, 1 \mu \mathrm{~A}, 10 \mu \mathrm{~A}, 100 \mu \mathrm{~A}, 1 \mathrm{~mA}$, and 10 mA .
(b) For a forward-conducting diode, what is the largest signal-voltage magnitude that it can support while the corresponding signal current is limited to $10 \%$ of the dc bias current? Now, for the circuit in Fig. P4.51, for $10-\mathrm{mV}$ peak input, what is the smallest value of $I$ for which the diode currents remain within $\pm 10 \%$ of their dc values?
(c) For $I=1 \mathrm{~mA}$, what is the largest possible output signal for which the diode currents deviate by at most $10 \%$ of their dc values? What is the corresponding peak input? What is the total current in each diode?


Figure P4.51
**4.52 In Problem 4.51 we investigated the operation of the circuit in Fig. P4.51 for small input signals. In this problem we wish to find the voltage-transfer characteristic (VTC) $v_{O}$ versus $v_{I}$ for $-12 \mathrm{~V} \leq v_{I} \leq 12 \mathrm{~V}$ for the case $I=1 \mathrm{~mA}$ and each of the diodes exhibits a voltage drop of 0.7 V at a current of 1 mA . Toward this end, use the diode exponential characteristic to construct a table that gives the values of: the current $i_{O}$ in the $10-\mathrm{k} \Omega$ resistor, the current in each of the four diodes, the voltage drop across each of the four diodes, and the input voltage $v_{I}$, for $v_{O}=0,+1 \mathrm{~V},+2 \mathrm{~V},+5 \mathrm{~V},+9 \mathrm{~V}$, $+9.9 \mathrm{~V},+9.99 \mathrm{~V},+10.5 \mathrm{~V},+11 \mathrm{~V}$, and +12 V . Use these data, with extrapolation to negative values of $v_{I}$ and $v_{O}$, to sketch the required VTC. Also sketch the VTC that results if $I$ is reduced to 0.5 mA . (Hint: From symmetry, observe that as $v_{O}$ increases and $i_{O}$ correspondingly increases, $i_{D 3}$ and $i_{D 2}$ increase by equal amounts and $i_{D 4}$ and $i_{D 1}$ decrease by (the same) equal amounts.)

[^0]
[^0]:    3.49 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
TIE *4.53 In the circuit shown in Fig. P4.53, $I$ is a dc current and $v_{i}$ is a sinusoidal signal with small amplitude (less than 10 mV ) and a frequency of 100 kHz . Representing the diode by its small-signal resistance $r_{d}$, which is a function of $I$, sketch the small-signal equivalent circuit and use it to determine the sinusoidal output voltage $V_{o}$, and thus find the phase shift between $V_{i}$ and $V_{o}$. Find the value of $I$ that will provide a phase shift of $-45^{\circ}$, and find the range of phase shift achieved as $I$ is varied over the range of 0.1 times to 10 times this value.


Figure P4.53
*4.54 Consider the voltage-regulator circuit shown in Fig. P4.54. The value of $R$ is selected to obtain an output voltage $V_{O}$ (across the diode) of 0.7 V .


Figure P4.54
(a) Use the diode small-signal model to show that the change in output voltage corresponding to a change of 1 V in $V^{+}$is

$$
\frac{\Delta V_{O}}{\Delta V^{+}}=\frac{V_{T}}{V^{+}+V_{T}-0.7}
$$

This quantity is known as the line regulation and is usually expressed in $\mathrm{mV} / \mathrm{V}$.
(b) Generalize the expression above for the case of $m$ diodes connected in series and the value of $R$ adjusted so that the voltage across each diode is 0.7 V (and $V_{O}=0.7 \mathrm{~m} \mathrm{~V}$ ).
(c) Calculate the value of line regulation for the case $V^{+}=$ 15 V (nominally) and (i) $m=1$ and (ii) $m=4$.
*4.55 Consider the voltage-regulator circuit shown in Fig P4.54 under the condition that a load current $I_{L}$ is drawn from the output terminal.
(a) If the value of $I_{L}$ is sufficiently small that the corresponding change in regulator output voltage $\Delta V_{O}$ is small enough to justify using the diode small-signal model, show that

$$
\frac{\Delta V_{O}}{I_{L}}=-\left(r_{d} \| R\right)
$$

This quantity is known as the load regulation and is usually expressed in $\mathrm{mV} / \mathrm{mA}$.
(b) If the value of $R$ is selected such that at no load the voltage across the diode is 0.7 V and the diode current is $I_{D}$, show that the expression derived in (a) becomes

$$
\frac{\Delta V_{O}}{I_{L}}=-\frac{V_{T}}{I_{D}} \frac{V^{+}-0.7}{V^{+}-0.7+V_{T}}
$$

Select the lowest possible value for $I_{D}$ that results in a load regulation whose magnitude is $\leq 5 \mathrm{mV} / \mathrm{mA}$. If $V^{+}$ is nominally 15 V , what value of $R$ is required? Also, specify the diode required in terms of its $I_{Y}$.
(c) Generalize the expression derived in (b) for the case of $m$ diodes connected in series and $R$ adjusted to obtain $V_{O}=0.7 \mathrm{~m} \mathrm{~V}$ at no load.

D *4.56 Design a diode voltage regulator to supply 1.5 V to a $1.5-\mathrm{k} \Omega$ load. Use two diodes specified to have a $0.7-\mathrm{V}$ drop at a current of 1 mA . The diodes are to be connected to a $+5-\mathrm{V}$ supply through a resistor $R$. Specify the value for $R$. What is the diode current with the load connected? What is the increase resulting in the output voltage when the load is disconnected? What change results if the load resistance is reduced to $1 \mathrm{k} \Omega$ ? To $750 \Omega$ ? To $500 \Omega$ ? (Hint: Use the small-signal diode model to calculate all changes in output voltage.)

D *4.57 A voltage regulator consisting of two diodes in series fed with a constant-current source is used as a replacement for a single carbon-zinc cell (battery) of nominal voltage 1.5 V . The regulator load current varies from 2 mA to

[^0]
[^0]:    TIE = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
7 mA . Constant-current supplies of $5 \mathrm{~mA}, 10 \mathrm{~mA}$, and 15 mA are available. Which would you choose, and why? What change in output voltage would result when the load current varies over its full range?
**4.58 A particular design of a voltage regulator is shown in Fig. P4.58. Diodes $D_{1}$ and $D_{2}$ are $10-\mathrm{mA}$ units; that is, each has a voltage drop of 0.7 V at a current of 10 mA . Use the diode exponential model and iterative analysis to answer the following questions:


Figure P4.58
(a) What is the regulator output voltage $V_{O}$ with the $150-\Omega$ load connected?
(b) Find $V_{O}$ with no load.
(c) With the load connected, to what value can the 5-V supply be lowered while maintaining the loaded output voltage within 0.1 V of its nominal value?
(d) What does the loaded output voltage become when the $5-\mathrm{V}$ supply is raised by the same amount as the drop found in (c)?
(e) For the range of changes explored in (c) and (d), by what percentage does the output voltage change for each percentage change of supply voltage in the worst case?

## Section 4.4: Operation in the Reverse Breakdown Region-Zener Diodes

4.59 Partial specifications of a collection of zener diodes are provided below. For each, identify the missing parameter and estimate its value. Note from Fig. 4.19 that $V_{Z K} \simeq V_{Z 0}$ and $I_{Z K}$ is very small.
(a) $V_{Z}=10.0 \mathrm{~V}, V_{Z K}=9.6 \mathrm{~V}$, and $I_{Z T}=50 \mathrm{~mA}$
(b) $I_{Z T}=10 \mathrm{~mA}, V_{Z}=9.1 \mathrm{~V}$, and $r_{z}=30 \Omega$
(c) $r_{z}=2 \Omega, V_{Z}=6.8 \mathrm{~V}$, and $V_{Z K}=6.6 \mathrm{~V}$
(d) $V_{Z}=18 \mathrm{~V}, I_{Z T}=5 \mathrm{~mA}$, and $V_{Z K}=17.6 \mathrm{~V}$
(e) $I_{Z T}=200 \mathrm{~mA}, V_{Z}=7.5 \mathrm{~V}$, and $r_{z}=1.5 \Omega$

Assuming that the power rating of a breakdown diode is established at about twice the specified zener current $\left(I_{Z T}\right)$, what is the power rating of each of the diodes described above?

D 4.60 A designer requires a shunt regulator of approximately 20 V . Two kinds of zener diodes are available: $6.8-\mathrm{V}$ devices with $r_{z}$ of $10 \Omega$ and $5.1-\mathrm{V}$ devices with $r_{z}$ of $25 \Omega$. For the two major choices possible, find the load regulation. In this calculation neglect the effect of the regulator resistance $R$.
4.61 A shunt regulator utilizing a zener diode with an incremental resistance of $8 \Omega$ is fed through an $82-\Omega$ resistor. If the raw supply changes by 1.0 V , what is the corresponding change in the regulated output voltage?
4.62 A 9.1-V zener diode exhibits its nominal voltage at a test current of 20 mA . At this current the incremental resistance is specified as $10 \Omega$. Find $V_{Z 0}$ of the zener model. Find the zener voltage at a current of 10 mA and at 50 mA .

D 4.63 Design a 7.5-V zener regulator circuit using a 7.5-V zener specified at 10 mA . The zener has an incremental resistance $r_{z}=30 \Omega$ and a knee current of 0.5 mA . The regulator operates from a $10-\mathrm{V}$ supply and has a $1.5-\mathrm{k} \Omega$ load. What is the value of $R$ you have chosen? What is the regulator output voltage when the supply is $10 \%$ high? Is $10 \%$ low? What is the output voltage when both the supply is $10 \%$ high and the load is removed? What is the smallest possible load resistor that can be used while the zener operates at a current no lower than the knee current while the supply is $10 \%$ low? What is the load voltage in this case?

D 4.64 Provide two designs of shunt regulators utilizing the 1 N 5235 zener diode, which is specified as follows: $V_{Z}=6.8 \mathrm{~V}$ and $r_{z}=5 \Omega$ for $I_{Z}=20 \mathrm{~mA}$; at $I_{Z}=0.25 \mathrm{~mA}$ (nearer the knee), $r_{z}=750 \Omega$. For both designs, the supply voltage is nominally 9 V and varies by $\pm 1 \mathrm{~V}$. For the first design, assume that the availability of supply current is not a problem, and thus operate the diode at 20 mA . For the second design, assume that the current from the raw supply is limited, and therefore you are forced to operate the diode at 0.25 mA . For the purpose of these initial designs, assume no load. For each design find the value of $R$ and the line regulation.

D *4.65 A zener shunt regulator employs a 9.1-V zener diode for which $V_{Z}=9.1 \mathrm{~V}$ at $I_{Z}=9 \mathrm{~mA}$, with $r_{z}=40 \Omega$ and

[^0]
[^0]:    3.14 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
$I_{Z K}=0.5 \mathrm{~mA}$. The available supply voltage of 15 V can vary as much as $\pm 10 \%$. For this diode, what is the value of $V_{Z 0}$ ? For a nominal load resistance $R_{L}$ of $1 \mathrm{k} \Omega$ and a nominal zener current of 10 mA , what current must flow in the supply resistor $R$ ? For the nominal value of supply voltage, select a value for resistor $R$, specified to one significant digit, to provide at least that current. What nominal output voltage results? For a $\pm 10 \%$ change in the supply voltage, what variation in output voltage results? If the load current is reduced by $50 \%$, what increase in $V_{O}$ results? What is the smallest value of load resistance that can be tolerated while maintaining regulation when the supply voltage is low? What is the lowest possible output voltage that results? Calculate values for the line regulation and for the load regulation for this circuit using the numerical results obtained in this problem.

D *4.66 It is required to design a zener shunt regulator to provide a regulated voltage of about 10 V . The available $10-\mathrm{V}$, 1-W zener of type 1 N 4740 is specified to have a $10-\mathrm{V}$ drop at a test current of 25 mA . At this current, its $r_{s}$ is $7 \Omega$. The raw supply, $V_{S}$, available has a nominal value of 20 V but can vary by as much as $\pm 25 \%$. The regulator is required to supply a load current of 0 mA to 20 mA . Design for a minimum zener current of 5 mA .
(a) Find $V_{Z 0}$.
(b) Calculate the required value of $R$.
(c) Find the line regulation. What is the change in $V_{O}$ expressed as a percentage, corresponding to the $\pm 25 \%$ change in $V_{S}$ ?
(d) Find the load regulation. By what percentage does $V_{O}$ change from the no-load to the full-load condition?
(e) What is the maximum current that the zener in your design is required to conduct? What is the zener power dissipation under this condition?

## Section 4.5: Rectifier Circuits

4.67 Consider the half-wave rectifier circuit of Fig. 4.23(a) with the diode reversed. Let $v_{S}$ be a sinusoid with $10-\mathrm{V}$ peak amplitude, and let $R=1 \mathrm{k} \Omega$. Use the constant-voltage-drop diode model with $V_{D}=0.7 \mathrm{~V}$.
(a) Sketch the transfer characteristic.
(b) Sketch the waveform of $v_{O}$.
(c) Find the average value of $v_{O}$.
(d) Find the peak current in the diode.
(e) Find the PIV of the diode.
4.68 Using the exponential diode characteristic, show that for $v_{S}$ and $v_{O}$ both greater than zero, the circuit of Fig. 4.23(a) has the transfer characteristic

$$
v_{O}=v_{S}-v_{D}\left(\text { at } i_{D}=1 \mathrm{~mA}\right)-V_{T} \ln \left(v_{O} / R\right)
$$

where $v_{S}$ and $v_{O}$ are in volts and $R$ is in kilohms. Note that this relationship can be used to obtain the voltage transfer characteristic $v_{O}$ vs. $v_{S}$ by finding $v_{S}$ corresponding to various values of $v_{O}$.

III 4.69 Consider a half-wave rectifier circuit with a triangular-wave input of $5-\mathrm{V}$ peak-to-peak amplitude and zero average, and with $R=1 \mathrm{k} \Omega$. Assume that the diode can be represented by the constant-voltage-drop model with $V_{D}=0.7 \mathrm{~V}$. Find the average value of $v_{O}$.
4.70 A half-wave rectifier circuit with a $1-\mathrm{k} \Omega$ load operates from a $120-\mathrm{V}$ (rms) $60-\mathrm{Hz}$ household supply through a 12-to-1 step-down transformer. It uses a silicon diode that can be modeled to have a $0.7-\mathrm{V}$ drop for any current. What is the peak voltage of the rectified output? For what fraction of the cycle does the diode conduct? What is the average output voltage? What is the average current in the load?
4.71 A full-wave rectifier circuit with a $1-\mathrm{k} \Omega$ load operates from a $120-\mathrm{V}$ (rms) $60-\mathrm{Hz}$ household supply through a 6-to-1 transformer having a center-tapped secondary winding. It uses two silicon diodes that can be modeled to have a $0.7-\mathrm{V}$ drop for all currents. What is the peak voltage of the rectified output? For what fraction of a cycle does each diode conduct? What is the average output voltage? What is the average current in the load?
4.72 A full-wave bridge-rectifier circuit with a $1-\mathrm{k} \Omega$ load operates from a $120-\mathrm{V}$ (rms) $60-\mathrm{Hz}$ household supply through a 12-to-1 step-down transformer having a single secondary winding. It uses four diodes, each of which can be modeled to have a $0.7-\mathrm{V}$ drop for any current. What is the peak value of the rectified voltage across the load? For what fraction of a cycle does each diode conduct? What is the average voltage across the load? What is the average current through the load?

D 4.73 It is required to design a full-wave rectifier circuit using the circuit of Fig. 4.24 to provide an average output voltage of:
(a) 10 V
(b) 100 V

[^0]
[^0]:    4.72 A full-wave bridge-rectifier circuit with a $1-\mathrm{k} \Omega$ load operates from a $120-\mathrm{V}$ (rms) $60-\mathrm{Hz}$ household supply through a 12-to-1 step-down transformer having a single secondary winding. It uses four diodes, each of which can be modeled to have a $0.7-\mathrm{V}$ drop for any current. What is the peak value of the rectified voltage across the load? For what fraction of a cycle does each diode conduct? What is the average voltage across the load? What is the average current through the load?

    D 4.73 It is required to design a full-wave rectifier circuit using the circuit of Fig. 4.24 to provide an average output voltage of:
    (a) 10 V
    (b) 100 V


Figure P4.76

In each case find the required turns ratio of the transformer. Assume that a conducting diode has a voltage drop of 0.7 V . The ac line voltage is 120 V rms .

D 4.74 Repeat Problem 4.73 for the bridge-rectifier circuit of Fig. 4.25.

D 4.75 Consider the full-wave rectifier in Fig. 4.24 when the transformer turns ratio is such that the voltage across the entire secondary winding is 20 V rms . If the input ac line voltage ( 120 V rms ) fluctuates by as much as $\pm 10 \%$, find the required PIV of the diodes. (Remember to use a factor of safety in your design.)
4.76 The circuit in Fig. P4.76 implements a complementary-output rectifier. Sketch and clearly label the waveforms of $v_{o}^{\prime}$ and $v_{o}^{\prime \prime}$. Assume a $0.7-\mathrm{V}$ drop across each conducting diode. If the magnitude of the average of each output is to be 12 V , find the required amplitude of the sine wave across the entire secondary winding. What is the PIV of each diode?
4.77 Augment the rectifier circuit of Problem 4.70 with a capacitor chosen to provide a peak-to-peak ripple voltage of (i) $10 \%$ of the peak output and (ii) $1 \%$ of the peak output. In each case:
(a) What average output voltage results?
(b) What fraction of the cycle does the diode conduct?
(c) What is the average diode current?
(d) What is the peak diode current?
4.78 Repeat Problem 4.77 for the rectifier in Problem 4.71.
4.79 Repeat Problem 4.77 for the rectifier in Problem 4.72.

D *4.80 It is required to use a peak rectifier to design a dc power supply that provides an average dc output voltage of 12 V on which a maximum of $\pm 1-\mathrm{V}$ ripple is allowed. The rectifier feeds a load of $200 \Omega$. The rectifier is fed from the line voltage ( $120 \mathrm{~V} \mathrm{rms}, 60 \mathrm{~Hz}$ ) through a transformer. The diodes available have $0.7-\mathrm{V}$ drop when conducting. If the designer opts for the half-wave circuit:
(a) Specify the rms voltage that must appear across the transformer secondary.
(b) Find the required value of the filter capacitor.
(c) Find the maximum reverse voltage that will appear across the diode, and specify the PIV rating of the diode.
(d) Calculate the average current through the diode during conduction.
(e) Calculate the peak diode current.

D *4.81 Repeat Problem 4.80 for the case in which the designer opts for a full-wave circuit utilizing a center-tapped transformer.

D *4.82 Repeat Problem 4.80 for the case in which the designer opts for a full-wave bridge-rectifier circuit.

D *4.83 Consider a half-wave peak rectifier fed with a voltage $v_{s}$ having a triangular waveform with $24-\mathrm{V}$ peak-to-peak amplitude, zero average, and 1-kHz frequency. Assume that the diode has a $0.7-\mathrm{V}$ drop when conducting. Let the load resistance $R=100 \Omega$ and the filter capacitor $C=100 \mu \mathrm{~F}$. Find the average dc output voltage, the time interval during which the diode conducts, the average diode current during conduction, and the maximum diode current.D *4.84 Consider the circuit in Fig. P4.76 with two equal filter capacitors placed across the load resistors $R$. Assume that the diodes available exhibit a $0.7-\mathrm{V}$ drop when conducting. Design the circuit to provide $\pm 12-\mathrm{V}$ dc output voltages with a peak-to-peak ripple no greater than 1 V . Each supply should be capable of providing $100-\mathrm{mA}$ dc current to its load resistor $R$. Completely specify the capacitors, diodes, and the transformer.
4.85 The op amp in the precision rectifier circuit of Fig. P4.85 is ideal with output saturation levels of $\pm 13 \mathrm{~V}$. Assume that when conducting the diode exhibits a constant voltage drop of 0.7 V . Find $v_{-}, v_{o}$, and $v_{A}$ for:
(a) $v_{I}=+1 \mathrm{~V}$
(b) $v_{I}=+3 \mathrm{~V}$
(c) $v_{I}=-1 \mathrm{~V}$
(d) $v_{I}=-3 \mathrm{~V}$

Also, find the average output voltage obtained when $v_{I}$ is a symmetrical square wave of $1-\mathrm{kHz}$ frequency, $5-\mathrm{V}$ amplitude, and zero average.


Figure P4.85
4.86 The op amp in the circuit of Fig. P4.86 is ideal with output saturation levels of $\pm 12 \mathrm{~V}$. The diodes exhibit a constant $0.7-\mathrm{V}$ drop when conducting. Find $v_{-}, v_{A}$, and $v_{o}$ for:
(a) $v_{I}=+1 \mathrm{~V}$
(b) $v_{I}=+3 \mathrm{~V}$
(c) $v_{I}=-1 \mathrm{~V}$
(d) $v_{I}=-3 \mathrm{~V}$


Figure P4.86

## Section 4.6: Limiting and Clamping Circuits

4.87 Sketch the transfer characteristic $v_{o}$ versus $v_{I}$ for the limiter circuits shown in Fig. P4.87. All diodes begin conducting at a forward voltage drop of 0.5 V and have voltage drops of 0.7 V when conducting a current $i_{D} \geq 1 \mathrm{~mA}$.

(a)

(b)

Figure P4.87


Figure P4.87 continued
4.88 The circuits in Fig. P4.87(a) and (d) are connected as follows: The two input terminals are tied together, and the two output terminals are tied together. Sketch the transfer characteristic of the circuit resulting, assuming that the cut-in voltage of the diodes is 0.5 V and their voltage drop when conducting a current $i_{D} \geq 1 \mathrm{~mA}$ is 0.7 V .
4.89 Repeat Problem 4.88 for the two circuits in Fig. P4.87(a) and (b) connected together as follows: The two input terminals are tied together, and the two output terminals are tied together.
4.90 Sketch and clearly label the transfer characteristic of the circuit in Fig. P4.90 for $-15 \mathrm{~V} \leq v_{I} \leq+15 \mathrm{~V}$. Assume that


Figure P4.90
the diodes can be represented by the constant-voltage-drop model with $V_{D}=0.7 \mathrm{~V}$. Also assume that the zener voltage is 6.8 V and that $r_{z}$ is negligibly small.
*4.91 Plot the transfer characteristic of the circuit in Fig. P4.91 by evaluating $v_{I}$ corresponding to $v_{O}=0.5 \mathrm{~V}$, $0.6 \mathrm{~V}, 0.7 \mathrm{~V}, 0.8 \mathrm{~V}, 0 \mathrm{~V},-0.5 \mathrm{~V},-0.6 \mathrm{~V},-0.7 \mathrm{~V}$, and -0.8 V . Use the exponential model for the diodes, and assume that they have $0.7-\mathrm{V}$ drops at $1-\mathrm{mA}$ currents. Characterize the circuit as a hard or soft limiter. What is the value of $K$ ? Estimate $L_{+}$ and $L_{-}$.


Figure P4.91
4.92 Design limiter circuits using only diodes and $10-\mathrm{k} \Omega$ resistors to provide an output signal limited to the range:
(a) -0.7 V and above
(b) +2.1 V and below
(c) $\pm 1.4 \mathrm{~V}$

Assume that each diode has a $0.7-\mathrm{V}$ drop when conducting.
4.93 Design a two-sided limiting circuit using a resistor, two diodes, and two power supplies to feed a $1-\mathrm{k} \Omega$ load with nominal limiting levels of $\pm 2.2 \mathrm{~V}$. Use diodes modeled by a constant 0.7 V . In the nonlimiting region, the voltage gain should be at least $0.94 \mathrm{~V} / \mathrm{V}$.
**4.94 In the circuit shown in Fig. P4.94, the diodes exhibit a $0.7-\mathrm{V}$ drop at 0.1 mA . For inputs over the range of $\pm 5 \mathrm{~V}$, use the diode exponential model to provide a calibrated sketch of the voltages at outputs B and C versus $v_{A}$. For a $5-\mathrm{V}$ peak,
$100-\mathrm{Hz}$ sinusoid applied at A , sketch the signals at nodes B and C.


Figure P4.94
**4.95 Sketch and label the voltage-transfer characteristic $v_{i j}$ versus $v_{l}$ of the circuit shown in Fig. P4.95 over a $\pm 10-\mathrm{V}$ range of input signals. Use the diode exponential model and assume that all diodes are $1-\mathrm{mA}$ units (i.e., each exhibits a $0.7-\mathrm{V}$ drop at a current of 1 mA ). What are the slopes of the characteristics at the extreme $\pm 10-\mathrm{V}$ levels?


Figure P4.95
4.96 A clamped capacitor using an ideal diode with cathode grounded is supplied with a sine wave of $5-\mathrm{V}$ rms. What is the average (dc) value of the resulting output?
*4.97 For the circuits in Fig. P4.97, each utilizing an ideal diode (or diodes), sketch the output for the input shown. Label the most positive and most negative output levels. Assume $C R \gg T$.


Figure P4.97
# CHAPTER 5 

## MOS Field-Effect Transistors (MOSFETs)

Introduction 247
5.1 Device Structure and Physical Operation 248
5.2 Current-Voltage Characteristics 264
5.3 MOSFET Circuits at DC 276
5.4 The Body Effect and Other Topics 288

Summary 291
Problems 292
# IN THIS CHAPTER YOU WILL LEARN 

1. The physical structure of the MOS transistor and how it works.
2. How the voltage between two terminals of the transistor controls the current that flows through the third terminal, and the equations that describe these current-voltage characteristics.
3. How to analyze and design circuits that contain MOS transistors, resistors, and dc sources.

## Introduction

Having studied the junction diode, which is the most basic two-terminal semiconductor device, we now turn our attention to three-terminal semiconductor devices. Three-terminal devices are far more useful than two-terminal ones because they can be used in a multitude of applications, ranging from signal amplification to digital logic and memory. The basic principle involved is the use of the voltage between two terminals to control the current flowing in the third terminal. In this way a three-terminal device can be used to realize a controlled source, which as we have learned in Chapter 1 is the basis for amplifier design. Also, in the extreme, the control signal can be used to cause the current in the third terminal to change from zero to a large value, thus allowing the device to act as a switch. As we shall see in Chapter 14, the switch is the basis for the realization of the logic inverter, the basic element of digital circuits.

There are two major types of three-terminal semiconductor devices: the metal-oxidesemiconductor field-effect transistor (MOSFET), which is studied in this chapter, and the bipolar junction transistor (BJT), which we shall study in Chapter 6. Although each of the two transistor types offers unique features and areas of application, the MOSFET has become by far the most widely used electronic device, especially in the design of integrated circuits (ICs), which are entire circuits fabricated on a single silicon chip.

Compared to BJTs, MOSFETs can be made quite small (i.e., requiring a small area on the silicon IC chip), and their manufacturing process is relatively simple (see Appendix A). Also, their operation requires comparatively little power. Furthermore, circuit designers have found ingenious ways to implement digital and analog functions utilizing MOSFETs almost exclusively (i.e., with very few or no resistors). All of these properties have made it possible to pack large numbers of MOSFETs (as many as 4 billion!) on a single IC chip to implement very sophisticated, very-large-scale-integrated (VLSI) digital circuits such as those for memory and microprocessors. Analog circuits such as amplifiers and filters can also be implemented in MOS technology, albeit in smaller, less-dense chips. Also, both analog and digital functions are increasingly being implemented on the same IC chip, in what is known as mixed-signal design.
## THE FIRST FIELD-EFFECT DEVICES:

The objective of this chapter is to develop in the reader a high degree of familiarity with the MOSFET: its physical structure and operation, terminal characteristics, and dc circuit applications. This will provide a solid foundation for the application of the MOSFET in amplifier design (Chapter 7) and in digital circuit design (Chapter 14). Although discrete MOS transistors exist, and the material studied in this chapter will enable the reader to design discrete MOS circuits, our study of the MOSFET is strongly influenced by the fact that most of its applications are in integrated-circuit design. The design of IC analog and digital MOS circuits occupies a large proportion of the remainder of this book.

In 1925 a patent for solid-state electric-field-controlled conductor was filed in Canada by Julius E. Lilienfeld, a physicist at the University of Leipzig, Germany. Other patent refinements followed in the United States in 1926 and 1928. Regrettably, no research papers were published. Consequently, in 1934 Oskar Heil, a German physicist working at the University of Cambridge, U.K., filed a patent on a similar idea. But all these early concepts of electric-field control of a semiconducting path languished because suitable technology was not available.

The invention of the bipolar transistor in 1947 at Bell Telephone Laboratories resulted in the speedy development of bipolar devices, a circumstance that further delayed the development of field-effect transistors. Although the field-effect device was described in a paper by William Shockley in 1952, it was not until 1960 that a patent on an insulated-gate field-effect device, the MOSFET, was filed by Dawon Kahng and Martin Atalla, also at Bell Labs. Clearly, the idea of field-effect control for amplification and switching has changed the world. With integrated-circuit chips today containing billions of MOS devices, MOS dominates the electronics world!

### 5.1 Device Structure and Physical Operation

The enhancement-type MOSFET is the most widely used field-effect transistor. Except for the last section, this chapter is devoted to the study of the enhancement-type MOSFET. We begin in this section by learning about its structure and physical operation. This will lead to the current-voltage characteristics of the device, studied in the next section.

### 5.1.1 Device Structure

Figure 5.1 shows the physical structure of the $n$-channel enhancement-type MOSFET. The meaning of the names "enhancement" and " $n$-channel" will become apparent shortly. The transistor is fabricated on a $p$-type substrate, which is a single-crystal silicon wafer that provides physical support for the device (and for the entire circuit in the case of an integrated circuit). Two heavily doped $n$-type regions, indicated in the figure as the $n^{+}$source ${ }^{1}$ and the $n^{+}$drain regions, are created in the substrate. A thin layer of silicon dioxide $\left(\mathrm{SiO}_{2}\right)$ of thickness $t_{\mathrm{ox}}$ (typically 1 nm to 10 nm ), ${ }^{2}$ which is an excellent electrical insulator, is grown on the surface of the substrate, covering the area between the source and drain regions. Metal is deposited on top of the oxide layer to form the gate electrode of the device. Metal contacts are

[^0]
[^0]:    ${ }^{1}$ The notation $n^{+}$indicates heavily doped $n$-type silicon. Conversely, $n^{-}$is used to denote lightly doped $n$-type silicon. Similar notation applies for $p$-type silicon.
    ${ }^{2} \mathrm{~A}$ nanometer $(\mathrm{nm})$ is $10^{-9} \mathrm{~m}$ or $0.001 \mu \mathrm{~m}$. A micrometer $(\mu \mathrm{m})$, or micron, is $10^{-6} \mathrm{~m}$. Sometimes the oxide thickness is expressed in angstroms. An angstrom $(\AA)$ is $10^{-7} \mathrm{~nm}$, or $10^{-10} \mathrm{~m}$.


Figure 5.1 Physical structure of the enhancement-type NMOS transistor: (a) perspective view; (b) cross section. Typically $L=0.03 \mu \mathrm{~m}$ to $1 \mu \mathrm{~m}, W=0.05 \mu \mathrm{~m}$ to $100 \mu \mathrm{~m}$, and the thickness of the oxide layer $\left(t_{o x}\right)$ is in the range of 1 to 10 nm .
also made to the source region, the drain region, and the substrate, also known as the body. ${ }^{3}$ Thus four terminals are brought out: the gate terminal (G), the source terminal (S), the drain terminal (D), and the substrate or body terminal (B).

[^0]
[^0]:    ${ }^{3}$ In Fig. 5.1, the contact to the body is shown on the bottom of the device. This will prove helpful in Section 5.4 in explaining a phenomenon known as the "body effect." It is important to note, however, that in actual ICs, contact to the body is made at a location on the top of the device.
At this point it should be clear that the name of the device (metal-oxide-semiconductor FET) is derived from its physical structure. The name, however, has become a general one and is used also for FETs that do not use metal for the gate electrode. In fact, most modern MOSFETs are fabricated using a process known as silicon-gate technology, in which a certain type of silicon, called polysilicon, is used to form the gate electrode (see Appendix A). Our description of MOSFET operation and characteristics applies irrespective of the type of gate electrode.

Another name for the MOSFET is the insulated-gate FET or IGFET. This name also arises from the physical structure of the device, emphasizing the fact that the gate electrode is electrically insulated from the device body (by the oxide layer). It is this insulation that causes the current in the gate terminal to be extremely small (of the order of $10^{-15} \mathrm{~A}$ ).

Observe that the substrate forms $p n$ junctions with the source and drain regions. In normal operation these $p n$ junctions are kept reverse biased at all times. Since, as we shall see shortly, the drain will always be at a positive voltage relative to the source, the two $p n$ junctions can be effectively cut off by simply connecting the substrate terminal to the source terminal. We shall assume this to be the case in the following description of MOSFET operation. Thus, here, the substrate will be considered as having no effect on device operation, and the MOSFET will be treated as a three-terminal device, with the terminals being the gate (G), the source (S), and the drain (D). It will be shown that a voltage applied to the gate controls current flow between source and drain. This current will flow in the longitudinal direction from drain to source in the region labeled "channel region." Note that this region has a length $L$ and a width $W$, two important parameters of the MOSFET. Typically, $L$ is in the range of $0.03 \mu \mathrm{~m}$ to $1 \mu \mathrm{~m}$, and $W$ is in the range of $0.05 \mu \mathrm{~m}$ to $100 \mu \mathrm{~m}$. Finally, note that the MOSFET is a symmetrical device; thus its source and drain can be interchanged with no change in device characteristics.

# 5.1.2 Operation with Zero Gate Voltage 

With zero voltage applied to the gate, two back-to-back diodes exist in series between drain and source. One diode is formed by the $p n$ junction between the $n^{+}$drain region and the $p$-type substrate, and the other diode is formed by the $p n$ junction between the $p$-type substrate and the $n^{+}$source region. These back-to-back diodes prevent current conduction from drain to source when a voltage $v_{D S}$ is applied. In fact, the path between drain and source has a very high resistance (of the order of $10^{12} \Omega$ ).

### 5.1.3 Creating a Channel for Current Flow

Consider next the situation depicted in Fig. 5.2. Here we have grounded the source and the drain and applied a positive voltage to the gate. Since the source is grounded, the gate voltage appears in effect between gate and source and thus is denoted $v_{G S}$. The positive voltage on the gate causes, in the first instance, the free holes (which are positively charged) to be repelled from the region of the substrate under the gate (the channel region). These holes are pushed downward into the substrate, leaving behind a carrier-depletion region. The depletion region is populated by the bound negative charge associated with the acceptor atoms. These charges are "uncovered" because the neutralizing holes have been pushed downward into the substrate.

As well, the positive gate voltage attracts electrons from the $n^{+}$source and drain regions (where they are in abundance) into the channel region. When a sufficient number of electrons accumulate near the surface of the substrate under the gate, an $n$ region is in effect created, connecting the source and drain regions, as indicated in Fig. 5.2. Now if a voltage is applied between drain and source, current flows through this induced $n$ region, carried by the mobile


Figure 5.2 The enhancement-type NMOS transistor with a positive voltage applied to the gate. An $n$ channel is induced at the top of the substrate beneath the gate.
electrons. The induced $n$ region thus forms a channel for current flow from drain to source and is aptly called so. Correspondingly, the MOSFET of Fig. 5.2 is called an $\boldsymbol{n}$-channel MOSFET or, alternatively, an NMOS transistor. Note that an $n$-channel MOSFET is formed in a $p$-type substrate: The channel is created by inverting the substrate surface from $p$ type to $n$ type. Hence the induced channel is also called an inversion layer.

The value of $v_{G S}$ at which a sufficient number of mobile electrons accumulate in the channel region to form a conducting channel is called the threshold voltage and is denoted $V_{t}{ }^{4}$ Obviously, $V_{t}$ for an $n$-channel FET is positive. The value of $V_{t}$ is controlled during device fabrication and typically lies in the range of 0.3 V to 1.0 V .

The gate and the channel region of the MOSFET form a parallel-plate capacitor, with the oxide layer acting as the capacitor dielectric. The positive gate voltage causes positive charge to accumulate on the top plate of the capacitor (the gate electrode). The corresponding negative charge on the bottom plate is formed by the electrons in the induced channel. An electric field thus develops in the vertical direction. It is this field that controls the amount of charge in the channel, and thus it determines the channel conductivity and, in turn, the current that will flow through the channel when a voltage $v_{D S}$ is applied. This is the origin of the name "field-effect transistor" (FET).

The voltage across this parallel-plate capacitor, that is, the voltage across the oxide, must exceed $V_{t}$ for a channel to form. When $v_{D S}=0$, as in Fig. 5.2, the voltage at every point along the channel is zero, and the voltage across the oxide (i.e., between the gate and the points along the channel) is uniform and equal to $v_{G S}$. The excess of $v_{G S}$ over $V_{t}$ is termed the effective voltage or the overdrive voltage and is the quantity that determines the charge in the channel. In this book, we shall denote $\left(v_{G S}-V_{t}\right)$ by $v_{O V}$,

$$
v_{G S}-V_{t} \equiv v_{O V}
$$

[^0]
[^0]:    ${ }^{4}$ Some texts use $V_{T}$ to denote the threshold voltage. We use $V_{t}$ to avoid confusion with the thermal voltage $V_{T}$.We can express the magnitude of the electron charge in the channel by

$$
|Q|=C_{o x}(W L) v_{O V}
$$

where $C_{o x}$, called the oxide capacitance, is the capacitance of the parallel-plate capacitor per unit gate area (in units of $\mathrm{F} / \mathrm{m}^{2}$ ), $W$ is the width of the channel, and $L$ is the length of the channel. The oxide capacitance $C_{o x}$ is given by

$$
C_{o x}=\frac{\epsilon_{o x}}{t_{o x}}
$$

where $\epsilon_{o x}$ is the permittivity of the silicon dioxide,

$$
\epsilon_{o x}=3.9 \epsilon_{0}=3.9 \times 8.854 \times 10^{-12}=3.45 \times 10^{-11} \mathrm{~F} / \mathrm{m}
$$

The oxide thickness $t_{o x}$ is determined by the process technology used to fabricate the MOSFET. As an example, for a process with $t_{o x}=4 \mathrm{~nm}$,

$$
C_{o x}=\frac{3.45 \times 10^{-11}}{4 \times 10^{-9}}=8.6 \times 10^{-3} \mathrm{~F} / \mathrm{m}^{2}
$$

It is much more convenient to express $C_{o x}$ per micron squared. For our example, this yields $8.6 \mathrm{fF} / \mu \mathrm{m}^{2}$, where fF denotes femtofarad $\left(10^{-15} \mathrm{~F}\right)$. For a MOSFET fabricated in this technology with a channel length $L=0.18 \mu \mathrm{~m}$ and a channel width $W=0.72 \mu \mathrm{~m}$, the total capacitance between gate and channel is

$$
C=C_{o x} W L=8.6 \times 0.18 \times 0.72=1.1 \mathrm{fF}
$$

Finally, note from Eq. (5.2) that as $v_{O V}$ is increased, the magnitude of the channel charge increases proportionately. Sometimes this is depicted as an increase in the depth of the channel; that is, the larger the overdrive voltage, the deeper the channel.

# 5.1.4 Applying a Small $v_{D S}$ 

Having induced a channel, we now apply a positive voltage $v_{D S}$ between drain and source, as shown in Fig. 5.3. We first consider the case where $v_{D S}$ is small (i.e., 50 mV or so). The voltage $v_{D S}$ causes a current $i_{D}$ to flow through the induced $n$ channel. Current is carried by free electrons traveling from source to drain (hence the names source and drain). By convention, the direction of current flow is opposite to that of the flow of negative charge. Thus the current in the channel, $i_{D}$, will be from drain to source, as indicated in Fig. 5.3.

We now wish to calculate the value of $i_{D}$. Toward that end, we first note that because $v_{D S}$ is small, we can continue to assume that the voltage between the gate and various points along the channel remains approximately constant and equal to the value at the source end, $v_{G S}$. Thus, the effective voltage between the gate and the various points along the channel remains equal to $v_{O V}$, and the channel charge $Q$ is still given by Eq. (5.2). Of particular interest


Figure 5.3 An NMOS transistor with $v_{G S}>V_{i}$ and with a small $v_{D S}$ applied. The device acts as a resistance whose value is determined by $v_{G S}$. Specifically, the channel conductance is proportional to $v_{G S}-V_{i}$, and thus $i_{D}$ is proportional to $\left(v_{G S}-V_{i}\right) v_{D S}$. Note that the depletion region is not shown (for simplicity).
in calculating the current $i_{D}$ is the charge per unit channel length, which can be found from Eq. (5.2) as

$$
\frac{|Q|}{\text { unit channel length }}=C_{o s} W v_{O V}
$$

The voltage $v_{D S}$ establishes an electric field $E$ across the length of the channel,

$$
|E|=\frac{v_{D S}}{L}
$$

This electric field in turn causes the channel electrons to drift toward the drain with a velocity given by

$$
\text { Electron drift velocity }=\mu_{u}|E|=\mu_{u} \frac{v_{D S}}{L}
$$

where $\mu_{u}$ is the mobility of the electrons at the surface of the channel. It is a physical parameter whose value depends on the fabrication process technology. The value of $i_{D}$ can now be found by multiplying the charge per unit channel length (Eq. 5.4) by the electron drift velocity (Eq. 5.6),

$$
i_{D}=\left[\left(\mu_{u} C_{o s}\right)\left(\frac{W}{L}\right) v_{O V}\right] v_{D S}
$$
Thus, for small $v_{D S}$, the channel behaves as a linear resistance whose value is controlled by the overdrive voltage $v_{O V}$, which in turn is determined by $v_{G S}$ :

$$
i_{D}=\left[\left(\mu_{n} C_{o s}\right)\left(\frac{W}{L}\right)\left(v_{G S}-V_{t}\right)\right] v_{D S}
$$

The conductance $g_{D S}$ of the channel can be found from Eq. (5.7) or (5.8) as

$$
g_{D S}=\left(\mu_{n} C_{o s}\right)\left(\frac{W}{L}\right) v_{O V}
$$

or

$$
g_{D S}=\left(\mu_{n} C_{o s}\right)\left(\frac{W}{L}\right)\left(v_{G S}-V_{t}\right)
$$

Observe that the conductance is determined by the product of three factors: $\left(\mu_{n} C_{o s}\right),(W / L)$, and $v_{O V}$ (or equivalently, $v_{G S}-V_{t}$ ). To gain insight into MOSFET operation, we consider each of the three factors in turn.

The first factor, $\left(\mu_{n} C_{o s}\right)$, is determined by the process technology used to fabricate the MOSFET. It is the product of the electron mobility, $\mu_{n}$, and the oxide capacitance, $C_{o s}$. It makes physical sense for the channel conductance to be proportional to each of $\mu_{n}$ and $C_{o s}$ (why?) and hence to their product, which is termed the process transconductance parameter ${ }^{5}$ and given the symbol $k_{n}^{\prime}$, where the subscript $n$ denotes $n$ channel,

$$
k_{n}^{\prime}=\mu_{n} C_{o s}
$$

It can be shown that with $\mu_{n}$ having the dimensions of meters squared per volt-second $\left(\mathrm{m}^{2} / \mathrm{V} \cdot \mathrm{s}\right)$ and $C_{o s}$ having the dimensions of farads per meter squared $\left(\mathrm{F} / \mathrm{m}^{2}\right)$, the dimensions of $k_{n}^{\prime}$ are amperes per volt squared $\left(\mathrm{A} / \mathrm{V}^{2}\right)$.

The second factor in the expression for the conductance $g_{D S}$ in Eqs. (5.9) and (5.10) is the transistor aspect ratio $(W / L)$. That the channel conductance is proportional to the channel width $W$ and inversely proportional to the channel length $L$ should make perfect physical sense. The $(W / L)$ ratio is obviously a dimensionless quantity that is determined by the device designer. Indeed, the values of $W$ and $L$ can be selected by the device designer to give the device the $i-v$ characteristics desired. For a given fabrication process, however, there is a minimum channel length, $L_{\min }$. In fact, the minimum channel length that is possible with a given fabrication process is used to characterize the process and is being continually reduced as technology advances. For instance, in 2014 the state-of-the-art in commercially available MOS technology was a $32-\mathrm{nm}$ process, meaning that for this process the minimum channel length possible was 32 nm . Finally, we should note that the oxide thickness $t_{o s}$ scales down with $L_{\text {min }}$. Thus, for a $0.13-\mu \mathrm{m}$ technology, $t_{o s}$ is 2.7 nm , but for the currently popular $65-\mathrm{nm}$ technology, $t_{o s}$ is about 2.2 nm .

[^0]
[^0]:    ${ }^{5}$ This name arises from the fact that $\left(\mu_{n} C_{o s}\right)$ determines the transconductance of the MOSFET, as will be seen shortly.
The product of the process transconductance parameter $k_{n}^{\prime}$ and the transistor aspect ratio $(W / L)$ is the MOSFET transconductance parameter $k_{n}$,

$$
k_{n}=k_{n}^{\prime}(W / L)
$$

or

$$
k_{n}=\left(\mu_{n} C_{o s}\right)(W / L)
$$

The MOSFET parameter $k_{n}$ has the dimensions of $\mathrm{A} / \mathrm{V}^{2}$.
The third term in the expression of the channel conductance $g_{D S}$ is the overdrive voltage $v_{O V}$. This is hardly surprising, since $v_{O V}$ directly determines the magnitude of electron charge in the channel. As will be seen, $v_{O V}$ is a very important circuit-design parameter. In this book, we will use $v_{O V}$ and $v_{G S}-V_{t}$ interchangeably.

We conclude this subsection by noting that with $v_{D S}$ kept small, the MOSFET behaves as a linear resistance $r_{D S}$ whose value is controlled by the gate voltage $v_{G S}$,

$$
\begin{aligned}
& r_{D S}=\frac{1}{g_{D S}} \\
& r_{D S}=\frac{1}{\left(\mu_{n} C_{o s}\right)(W / L) v_{O V}} \\
& r_{D S}=\frac{1}{\left(\mu_{n} C_{o s}\right)(W / L)\left(v_{G S}-V_{t}\right)}
\end{aligned}
$$

The operation of the MOSFET as a voltage-controlled resistance is further illustrated in Fig. 5.4, which is a sketch of $i_{D}$ versus $v_{D S}$ for various values of $v_{G S}$. Observe that the resistance is infinite for $v_{G S} \leq V_{t}$ and decreases as $v_{G S}$ is increased above $V_{t}$. It is interesting to note that although $v_{G S}$ is used as the parameter for the set of graphs in Fig. 5.4, the graphs in fact depend only on $v_{O V}$ (and, of course, $k_{n}$ ).

The description above indicates that for the MOSFET to conduct, a channel has to be induced. Then, increasing $v_{G S}$ above the threshold voltage $V_{t}$ enhances the channel, hence the names enhancement-mode operation and enhancement-type MOSFET. Finally, we note that the current that leaves the source terminal $\left(i_{S}\right)$ is equal to the current that enters the drain terminal $\left(i_{D}\right)$, and the gate current $i_{G}=0$.


Figure 5.4 The $i_{D}-v_{D S}$ characteristics of the MOSFET in Fig. 5.3 when the voltage applied between drain and source, $v_{D S}$, is kept small. The device operates as a linear resistance whose value is controlled by $v_{G S}$.
# EXERCISE 

5.1 A $0.18-\mu \mathrm{m}$ fabrication process is specified to have $t_{o s}=4 \mathrm{~nm}, \mu_{\mathrm{u}}=450 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$, and $V_{t}=0.5 \mathrm{~V}$. Find the value of the process transconductance parameter $k_{u}^{\prime}$. For a MOSFET with minimum length fabricated in this process, find the required value of $W$ so that the device exhibits a channel resistance $r_{D S}$ of $1 \mathrm{k} \Omega$ at $v_{G S}=1 \mathrm{~V}$.
Ans. $388 \mu \mathrm{~A} / \mathrm{V}^{2} ; 0.93 \mu \mathrm{~m}$

### 5.1.5 Operation as $v_{D S}$ Is Increased

We next consider the situation as $v_{D S}$ is increased. For this purpose, let $v_{G S}$ be held constant at a value greater than $V_{t}$; that is, let the MOSFET be operated at a constant overdrive voltage $V_{O V}$. Refer to Fig. 5.5, and note that $v_{D S}$ appears as a voltage drop across the length of the channel. That is, as we travel along the channel from source to drain, the voltage (measured relative to the source) increases from zero to $v_{D S}$. Thus the voltage between the gate and points along the channel decreases from $v_{G S}=V_{t}+V_{O V}$ at the source end to $v_{G D}=v_{G S}-v_{D S}=V_{t}+V_{O V}-v_{D S}$ at the drain end. Since the channel depth depends on this voltage, and specifically on the amount by which this voltage exceeds $V_{t}$, we find that the channel is no longer of uniform depth; rather, the channel will take the tapered shape shown in Fig. 5.5, being deepest at the source end (where the depth is proportional to $V_{O V}$ ) and shallowest at the drain end ${ }^{6}$ (where the depth is proportional to $V_{O V}-v_{D S}$ ). This point is further illustrated in Fig. 5.6.

As $v_{D S}$ is increased, the channel becomes more tapered and its resistance increases correspondingly. Thus, the $i_{D}-v_{D S}$ curve does not continue as a straight line but bends as shown in Fig. 5.7. The equation describing this portion of the $i_{D}-v_{D S}$ curve can be easily derived by utilizing the information in Fig. 5.6. Specifically, note that the charge in the tapered channel is proportional to the channel cross-sectional area shown in Fig. 5.6(b). This area in turn can be easily seen as proportional to $\frac{1}{2}\left[V_{O V}+\left(V_{O V}-v_{D S}\right)\right]$ or $\left(V_{O V}-\frac{1}{2} v_{D S}\right)$. Thus, the relationship between $i_{D}$ and $v_{D S}$ can be found by replacing $V_{O V}$ in Eq. (5.7) by $\left(V_{O V}-\frac{1}{2} v_{D S}\right)$,

$$
i_{D}=k_{u}^{\prime}\left(\frac{W}{L}\right)\left(V_{O V}-\frac{1}{2} v_{D S}\right) v_{D S}
$$

This relationship describes the semiparabolic portion of the $i_{D}-v_{D S}$ curve in Fig. 5.7. It applies to the entire segment down to $v_{D S}=0$. Specifically, note that as $v_{D S}$ is reduced, we can neglect $\frac{1}{2} v_{D S}$ relative to $V_{O V}$ in the factor in parentheses, and the expression reduces to that in Eq. (5.7). The latter of course is an approximation and applies only for small $v_{D S}$ (i.e., near the origin).

There is another useful interpretation of the expression in Eq. (5.14). From Fig. 5.6(a) we see that the average voltage along the channel is $\frac{1}{2} v_{D S}$. Thus, the average voltage that gives rise to channel charge and hence to $i_{D}$ is no longer $V_{O V}$ but $\left(V_{O V}-\frac{1}{2} v_{D S}\right)$, which is indeed the factor that appears in Eq. (5.14). Finally, we note that Eq. (5.14) is frequently written in the

[^0]
[^0]:    ${ }^{6}$ For simplicity, we do not show in Fig. 5.5 the depletion region. Physically speaking, it is the widening of the depletion region as a result of the increased $v_{D S}$ that makes the channel shallower near the drain.


Figure 5.5 Operation of the enhancement NMOS transistor as $v_{D S}$ is increased. The induced channel acquires a tapered shape, and its resistance increases as $v_{D S}$ is increased. Here, $v_{G S}$ is kept constant at a value $>V_{t} ; v_{G S}=V_{t}+V_{O V}$.


Figure 5.6 (a) For a MOSFET with $v_{G S}=V_{t}+V_{O V}$, application of $v_{D S}$ causes the voltage drop along the channel to vary linearly, with an average value of $\frac{1}{2} v_{D S}$ at the midpoint. Since $v_{G D}>V_{t}$, the channel still exists at the drain end. (b) The channel shape corresponding to the situation in (a). While the depth of the channel at the source end is still proportional to $V_{O V}$, that at the drain end is proportional to $\left(V_{O V}-v_{D S}\right)$.


Figure 5.7 The drain current $i_{D}$ versus the drain-to-source voltage $v_{D S}$ for an enhancement-type NMOS transistor operated with $v_{G S}=V_{t}+V_{O V}$.
alternate form

$$
i_{D}=k_{u}^{\prime}\left(\frac{W}{L}\right)\left(V_{O V} v_{D S}-\frac{1}{2} v_{D S}^{2}\right)
$$

Furthermore, for an arbitrary value of $V_{O V}$, we can replace $V_{O V}$ by $\left(v_{G S}-V_{t}\right)$ and rewrite Eq. (5.15) as

$$
i_{D}=k_{u}^{\prime}\left(\frac{W}{L}\right)\left[\left(v_{G S}-V_{t}\right) v_{D S}-\frac{1}{2} v_{D S}^{2}\right]
$$

# 5.1.6 Operation for $v_{D S} \geq V_{O V}$ : Channel Pinch-Off and Current Saturation 

The above description of operation assumed that even though the channel became tapered, it still had a finite (nonzero) depth at the drain end. This in turn is achieved by keeping $v_{D S}$ sufficiently small that the voltage between the gate and the drain, $v_{G D}$, exceeds $V_{t}$. This is indeed the situation shown in Fig. 5.6(a). Note that for this situation to obtain, $v_{D S}$ must not exceed $V_{O V}$, for as $v_{D S}=V_{O V}, v_{G D}=V_{t}$, and the channel depth at the drain end reduces to zero.

Figure 5.8 shows $v_{D S}$ reaching $V_{O V}$ and $v_{G D}$ correspondingly reaching $V_{t}$. The zero depth of the channel at the drain end gives rise to the term channel pinch-off. Increasing $v_{D S}$ beyond this value (i.e., $v_{D S}>V_{O V}$ ) has no effect on the channel shape and charge, and the current through the channel remains constant at the value reached for $v_{D S}=V_{O V}$. The drain current thus saturates at the value found by substituting $v_{D S}=V_{O V}$ in Eq. (5.14),

$$
i_{D}=\frac{1}{2} k_{u}^{\prime}\left(\frac{W}{L}\right) V_{O V}^{2}
$$


Figure 5.8 Operation of MOSFET with $v_{G S}=V_{t}+V_{O V}$, as $v_{D S}$ is increased to $V_{O V}$. At the drain end, $v_{G D}$ decreases to $V_{t}$ and the channel depth at the drain end reduces to zero (pinch-off). At this point, the MOSFET enters the saturation mode of operation. Further increasing $v_{D S}$ (beyond $V_{D S \text { sat }}=V_{O V}$ ) has no effect on the channel shape and $i_{D}$ remains constant.

The MOSFET is then said to have entered the saturation region (or, equivalently, the saturation mode of operation). The voltage $v_{D S}$ at which saturation occurs is denoted $V_{D S \text { sat }}$,

$$
V_{D S \text { sat }}=V_{O V}=V_{G S}-V_{t}
$$

It should be noted that channel pinch-off does not mean channel blockage: Current continues to flow through the pinched-off channel, and the electrons that reach the drain end of the channel are accelerated through the depletion region that exists there (not shown in Fig. 5.5) and into the drain terminal. Any increase in $v_{D S}$ above $V_{D S \text { sat }}$ appears as a voltage drop across the depletion region. Thus, both the current through the channel and the voltage drop across it remain constant in saturation.

The saturation portion of the $i_{D}-v_{D S}$ curve is, as expected, a horizontal straight line, as indicated in Fig. 5.7. Also indicated in Fig. 5.7 is the name of the region of operation obtained with a continuous (non-pinched-off) channel, the triode region. This name is a carryover from the days of vacuum-tube devices, whose operation a FET resembles.

Finally, we note that the expression for $i_{D}$ in saturation can be generalized by replacing the constant overdrive voltage $V_{O V}$ by a variable one, $v_{O V}$ :

$$
i_{D}=\frac{1}{2} h_{n}\left(\frac{W}{L}\right) v_{O V}^{2}
$$
Also, $v_{O V}$ can be replaced by $\left(v_{G S}-V_{i}\right)$ to obtain the alternate expression for saturationmode $i_{D}$,

$$
i_{D}=\frac{1}{2} k_{n}^{\prime}\left(\frac{W}{L}\right)\left(v_{G S}-V_{i}\right)^{2}
$$

# Example 5.1 

Consider a process technology for which $L_{\min }=0.4 \mu \mathrm{~m}, t_{o s}=8 \mathrm{~nm}, \mu_{n}=450 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$, and $V_{i}=0.7 \mathrm{~V}$.
(a) Find $C_{o s}$ and $k_{n}^{\prime}$.
(b) For a MOSFET with $W / L=8 \mu \mathrm{~m} / 0.8 \mu \mathrm{~m}$, calculate the values of $V_{O V}, V_{G S}$, and $V_{D S \min }$ needed to operate the transistor in the saturation region with a dc current $I_{D}=100 \mu \mathrm{~A}$.
(c) For the device in (b), find the values of $V_{O V}$ and $V_{G S}$ required to cause the device to operate as a $1000-\Omega$ resistor for very small $v_{D S}$.

## Solution

(a)

$$
\begin{aligned}
C_{o s} & =\frac{\varepsilon_{o s}}{t_{o s}}=\frac{3.45 \times 10^{-11}}{8 \times 10^{-9}}=4.32 \times 10^{-3} \mathrm{~F} / \mathrm{m}^{2} \\
& =4.32 \mathrm{fF} / \mu \mathrm{m}^{2} \\
k_{n}^{\prime} & =\mu_{n} C_{o s}=450\left(\mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{~s}\right) \times 4.32\left(\mathrm{fF} / \mu \mathrm{m}^{2}\right) \\
& =450 \times 10^{8}\left(\mu \mathrm{~m}^{2} / \mathrm{V} \cdot \mathrm{~s}\right) \times 4.32 \times 10^{-15}\left(\mathrm{~F} / \mu \mathrm{m}^{2}\right) \\
& =194 \times 10^{-6}(\mathrm{~F} / \mathrm{V} \cdot \mathrm{~s}) \\
& =194 \mu \mathrm{~A} / \mathrm{V}^{2}
\end{aligned}
$$

(b) For operation in the saturation region,

$$
i_{D}=\frac{1}{2} k_{n}^{\prime} \frac{W}{L} V_{O V}^{2}
$$

Thus,

$$
100=\frac{1}{2} \times 194 \times \frac{8}{0.8} V_{O V}^{2}
$$

which results in

$$
V_{O V}=0.32 \mathrm{~V}
$$

Thus,

$$
V_{G S}=V_{i}+V_{O V}=1.02 \mathrm{~V}
$$

and

$$
V_{D S \min }=V_{O V}=0.32 \mathrm{~V}
$$
(c) For the MOSFET in the triode region with $v_{D S}$ very small,

$$
r_{D S}=\frac{1}{k_{b}^{\prime} \frac{W}{L} V_{O V}}
$$

Thus

$$
1000=\frac{1}{194 \times 10^{-6} \times 10 \times V_{O V}}
$$

which yields

$$
V_{O V}=0.52 \mathrm{~V}
$$

Thus,

$$
V_{G S}=1.22 \mathrm{~V}
$$

# EXERCISES 

5.2 For a $0.18-\mu \mathrm{m}$ process technology for which $t_{e s}=4 \mathrm{~nm}$ and $\mu_{n}=450 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$, find $C_{o s}, k_{b}^{\prime}$, and the overdrive voltage $V_{O V}$ required to operate a transistor having $W / L=20$ in saturation with $I_{D}=0.3 \mathrm{~mA}$. What is the minimum value of $V_{D S}$ needed?
Ans. $8.6 \mathrm{fF} / \mu \mathrm{m}^{2} ; 387 \mu \mathrm{~A} / \mathrm{V}^{2} ; 0.28 \mathrm{~V} ; 0.28 \mathrm{~V}$
D5.3 A circuit designer intending to operate a MOSFET in saturation is considering the effect of changing the device dimensions and operating voltages on the drain current $I_{D}$. Specifically, by what factor does $I_{D}$ change in each of the following cases?
(a) The channel length is doubled.
(b) The channel width is doubled.
(c) The overdrive voltage is doubled.
(d) The drain-to-source voltage is doubled.
(e) Changes (a), (b), (c), and (d) are made simultaneously.

Which of these cases might cause the MOSFET to leave the saturation region?
Ans. 0.5; 2; 4; no change; 4; case (c) if $v_{D S}$ is smaller than $2 V_{O V}$

### 5.1.7 The $p$-Channel MOSFET

Figure 5.9(a) shows a cross-sectional view of a $p$-channel enhancement-type MOSFET. The structure is similar to that of the NMOS device except that here the substrate is $n$ type and the source and the drain regions are $p^{+}$type; that is, all semiconductor regions are reversed in polarity relative to their counterparts in the NMOS case. The PMOS and NMOS transistors are said to be complementary devices.

Figure 5.9 (a) Physical structure of the PMOS transistor. Note that it is similar to the NMOS transistor shown in Fig. 5.1(b) except that all semiconductor regions are reversed in polarity. (b) A negative voltage $v_{G S}$ of magnitude greater than $\left|V_{i p}\right|$ induces a $p$ channel, and a negative $v_{D S}$ causes a current $i_{D}$ to flow from source to drain.

To induce a channel for current flow between source and drain, a negative voltage is applied to the gate, that is, between gate and source, as indicated in Fig. 5.9(b). By increasing the magnitude of the negative $v_{G S}$ beyond the magnitude of the threshold voltage $V_{i p}$, which by convention is negative, a $p$ channel is established as shown in Fig. 5.9(b). This condition can be described as

$$
v_{G S} \leq V_{i p}
$$

or, to avoid dealing with negative signs,

$$
\left|v_{G S}\right| \geq\left|V_{i p}\right|
$$
Now, to cause a current $i_{D}$ to flow in the $p$ channel, a negative voltage $v_{D S}$ is applied to the drain. ${ }^{7}$ The current $i_{D}$ is carried by holes and flows through the channel from source to drain. As we have done for the NMOS transistor, we define the process transconductance parameter for the PMOS device as

$$
k_{p}^{\prime}=\mu_{p} C_{o s}
$$

where $\mu_{p}$ is the mobility of the holes in the induced $p$ channel. Typically, $\mu_{p}=0.25 \mu_{n}$ to $0.5 \mu_{n}$ and is process-technology dependent. The transistor transconductance parameter $k_{p}$ is obtained by multiplying $k_{p}^{\prime}$ by the aspect ratio $W / L$,

$$
k_{p}=k_{p}^{\prime}(W / L)
$$

The remainder of the description of the physical operation of the $p$-channel MOSFET follows that for the NMOS device, except of course for the sign reversals of all voltages. We will present the complete current-voltage characteristics of both NMOS and PMOS transistors in the next section.

PMOS technology originally dominated MOS integrated-circuit manufacturing, and the original microprocessors utilized PMOS transistors. As the technological difficulties of fabricating NMOS transistors were solved, NMOS completely supplanted PMOS. The main reason for this change is that electron mobility $\mu_{n}$ is higher by a factor of 2 to 4 than the hole mobility $\mu_{p}$, resulting in NMOS transistors having greater gains and speeds of operation than PMOS devices. Subsequently, a technology was developed that permits the fabrication of both NMOS and PMOS transistors on the same chip. Appropriately called complementary MOS, or CMOS, this technology is currently the dominant electronics technology.

# 5.1.8 Complementary MOS or CMOS 

As the name implies, complementary MOS technology employs MOS transistors of both polarities. Although CMOS circuits are somewhat more difficult to fabricate than NMOS, the availability of complementary devices makes possible many powerful circuit configurations. Indeed, at the present time CMOS is the most widely used of all the IC technologies. This statement applies to both analog and digital circuits. CMOS technology has virtually replaced designs based on NMOS transistors alone. Furthermore, by 2014 CMOS technology had taken over many applications that just a few years earlier were possible only with bipolar devices. Throughout this book, we will study many CMOS circuit techniques.

Figure 5.10 shows a cross section of a CMOS chip illustrating how the PMOS and NMOS transistors are fabricated. Observe that while the NMOS transistor is implemented directly in the $p$-type substrate, the PMOS transistor is fabricated in a specially created $n$ region, known as an $\boldsymbol{n}$ well. The two devices are isolated from each other by a thick region of oxide that functions as an insulator. Not shown on the diagram are the connections made to the $p$-type body and to the $n$ well. The latter connection serves as the body terminal for the PMOS transistor.

[^0]
[^0]:    ${ }^{7}$ If a positive voltage is applied to the drain, the $p n$ junction between the drain region and the substrate will become forward biased, and the device will no longer operate as a MOSFET. Proper MOSFET operation is predicated on the $p n$ junctions between the source and drain regions and the substrate being always reverse biased.


Figure 5.10 Cross section of a CMOS integrated circuit. Note that the PMOS transistor is formed in a separate $n$-type region, known as an $n$ well. Another arrangement is also possible in which an $n$-type substrate (body) is used and the $n$ device is formed in a $p$ well. Not shown are the connections made to the $p$-type body and to the $n$ well; the latter functions as the body terminal for the $p$-channel device.

# 5.1.9 Operating the MOS Transistor in the Subthreshold Region 

The above description of the $n$-channel MOSFET operation implies that for $v_{G S}<V_{t}$, no current flows and the device is cut off. This is not entirely true, for it has been found that for values of $v_{G S}$ smaller than but close to $V_{t}$, a small drain current flows. In this subthreshold region of operation, the drain current is exponentially related to $v_{G S}$, much like the $i_{C}-v_{B E}$ relationship of a BJT, as will be shown in the next chapter.

Although in most applications the MOS transistor is operated with $v_{G S}>V_{t}$, there are special, but a growing number of, applications that make use of subthreshold operation. In Chapter 14, we will briefly consider subthreshold operation.

### 5.2 Current-Voltage Characteristics

Building on the physical foundation established in the previous section for the operation of the enhancement MOS transistor, in this section we present its complete current-voltage characteristics. These characteristics can be measured at dc or at low frequencies and thus are called static characteristics. The dynamic effects that limit the operation of the MOSFET at high frequencies and high switching speeds will be discussed in Chapter 10.

### 5.2.1 Circuit Symbol

Figure 5.11(a) shows the circuit symbol for the $n$-channel enhancement-type MOSFET. Observe that the spacing between the two vertical lines that represent the gate and the channel indicates the fact that the gate electrode is insulated from the body of the device. The polarity of the $p$-type substrate (body) and the $n$ channel is indicated by the arrowhead on the line representing the body (B). This arrowhead also indicates the polarity of the transistor, namely, that it is an $n$-channel device.

Although the MOSFET is a symmetrical device, it is often useful in circuit design to designate one terminal as the source and the other as the drain (without having to write $S$ and


Figure 5.11 (a) Circuit symbol for the $n$-channel enhancement-type MOSFET. (b) Modified circuit symbol with an arrowhead on the source terminal to distinguish it from the drain and to indicate device polarity (i.e., $n$ channel). (c) Simplified circuit symbol to be used when the source is connected to the body or when the effect of the body on device operation is unimportant.

D beside the terminals). This objective is achieved in the modified circuit symbol shown in Fig. 5.11(b). Here an arrowhead is placed on the source terminal, thus distinguishing it from the drain terminal. The arrowhead points in the normal direction of current flow and thus indicates the polarity of the device (i.e., $n$ channel). Observe that in the modified symbol, there is no need to show the arrowhead on the body line. Although the circuit symbol of Fig. 5.11(b) clearly distinguishes the source from the drain, in practice it is the polarity of the voltage impressed across the device that determines source and drain; the drain is always positive relative to the source in an n-channel FET.

In applications where the source is connected to the body of the device, a further simplification of the circuit symbol is possible, as indicated in Fig. 5.11(c). This symbol is also used in applications when the effect of the body on circuit operation is not important, as will be seen later.

# 5.2.2 The $i_{D}-v_{D S}$ Characteristics 

Table 5.1 provides a compilation of the conditions and the formulas for the operation of the NMOS transistor in each of the three possible regions: the cutoff region, the triode region, and the saturation region. The first two are useful if the MOSFET is to be utilized as a switch. On the other hand, if the MOSFET is to be used to design an amplifier, it must be operated in the saturation region. The rationale for these choices will be addressed in Chapter 7.

At the top of Table 5.1 we show a circuit consisting of an NMOS transistor and two dc supplies providing $v_{G S}$ and $v_{D S}$. This conceptual circuit can be used to measure the $i_{D}-v_{D S}$ characteristic curves of the NMOS transistor. Each curve is measured by setting $v_{G S}$ to a desired constant value, varying $v_{D S}$, and measuring the corresponding $i_{D}$. Two of these characteristic curves are shown in the accompanying diagram: one for $v_{G S}<V_{t n}$ and the other for $v_{G S}=V_{t n}+v_{O V}$. (Note that we now use $V_{t n}$ to denote the threshold voltage of the NMOS transistor, to distinguish it from that of the PMOS transistor, denoted $V_{t p}$.)

As Table 5.1 shows, the boundary between the triode region and the saturation region is determined by whether $v_{D S}$ is less or greater than the overdrive voltage $v_{O V}$ at which the transistor is operating. An equivalent way to check for the region of operation is to examine the relative values of the drain and gate voltages. To operate in the triode region, the gate voltage must exceed the drain voltage by at least $V_{t n}$ volts, which ensures that the channel remains continuous (not pinched off). On the other hand, to operate in saturation, the channel must be
Table 5.1 Regions of Operation of the Enhancement NMOS Transistor

$v_{G S}<V_{t m}:$ no channel; transistor in cutoff; $i_{D}=0$
■ $v_{G S}=V_{t n}+v_{O V}$ : a channel is induced; transistor operates in the triode region or the saturation region depending on whether the channel is continuous or pinched off at the drain end;

Triode Region
Continuous channel, obtained by:

$$
v_{G D}>V_{t n}
$$

or equivalently:

$$
v_{D S}<v_{O V}
$$

Then,

$$
i_{D}=k_{n}^{\prime}\left(\frac{W}{L}\right)\left[\left(v_{G S}-V_{t n}\right) v_{D S}-\frac{1}{2} v_{D S}^{2}\right]
$$

or equivalently,

$$
i_{D}=k_{n}^{\prime}\left(\frac{W}{L}\right)\left(v_{O V}-\frac{1}{2} v_{D S}\right) v_{D S}
$$

## Saturation Region

Pinched-off channel, obtained by:

$$
v_{G D} \leq V_{t n}
$$

or equivalently:

$$
v_{D S} \geq v_{O V}
$$

Then

$$
i_{D}=\frac{1}{2} k_{n}^{\prime}\left(\frac{W}{L}\right)\left(v_{G S}-V_{t n}\right)^{2}
$$

or equivalently,

$$
i_{D}=\frac{1}{2} k_{n}^{\prime}\left(\frac{W}{L}\right) v_{O V}^{2}
$$

pinched off at the drain end; pinch-off is achieved here by keeping $v_{D}$ higher than $v_{G}-V_{t n}$, that is, not allowing $v_{D}$ to fall below $v_{G}$ by more than $V_{t n}$ volts. The graphical construction of Fig. 5.12 should serve to remind the reader of these conditions.

A set of $i_{D}-v_{D S}$ characteristics for the NMOS transistor is shown in Fig. 5.13. Observe that each graph is obtained by setting $v_{G S}$ above $V_{t n}$ by a specific value of overdrive voltage, denoted $V_{O V 1}, V_{O V 2}, V_{O V 3}$, and $V_{O V 4}$. This in turn is the value of $v_{D S}$ at which the corresponding graph saturates, and the value of the resulting saturation current is directly determined by the value of $v_{O V}$, namely, $\frac{1}{2} k_{n} V_{O V 1}^{2}, \frac{1}{2} k_{n} V_{O V 2}^{2}, \ldots$ The reader is advised to commit to memory both the structure of these graphs and the coordinates of the saturation points.

Finally, observe that the boundary between the triode and the saturation regions, that is, the locus of the saturation points, is a parabolic curve described by

$$
i_{D}=\frac{1}{2} k_{n}^{\prime}\left(\frac{W}{L}\right) v_{D S}^{2}
$$


Figure 5.12 The relative levels of the terminal voltages of the enhancement NMOS transistor for operation in the triode region and in the saturation region.


Figure 5.13 The $i_{D}-v_{D S}$ characteristics for an enhancement-type NMOS transistor.

# 5.2.3 The $i_{D}-v_{G S}$ Characteristic 

When the MOSFET is used to design an amplifier, it is operated in the saturation region. As Fig. 5.13 indicates, in saturation the drain current is constant determined by $v_{G S}$ (or $v_{O V}$ ) and is independent of $v_{D S}$. That is, the MOSFET operates as a constant-current source where the value of the current is determined by $v_{G S}$. In effect, then, the MOSFET operates as a voltage-controlled current source with the control relationship described by

$$
i_{D}=\frac{1}{2} k_{n}^{\prime}\left(\frac{W}{L}\right)\left(v_{G S}-V_{m}\right)^{2}
$$

or in terms of $v_{O V}$,

$$
i_{D}=\frac{1}{2} k_{n}^{\prime}\left(\frac{W}{L}\right) v_{O V}^{2}
$$
This is the relationship that underlies the application of the MOSFET as an amplifier. That it is nonlinear should be of concern to those interested in designing linear amplifiers. Nevertheless, in Chapter 7, we will see how one can obtain linear amplification from this nonlinear control or transfer characteristic.

Figure 5.14 shows the $i_{D}-v_{G S}$ characteristic of an NMOS transistor operating in saturation. Note that if we are interested in a plot of $i_{D}$ versus $v_{O V}$, we simply shift the origin to the point $v_{G S}=V_{m}$.

The view of the MOSFET in the saturation region as a voltage-controlled current source is illustrated by the equivalent-circuit representation shown in Fig. 5.15. For reasons that will become apparent shortly, the circuit in Fig. 5.15 is known as a large-signal equivalent circuit. Note that the current source is ideal, with an infinite output resistance representing the independence, in saturation, of $i_{D}$ from $v_{D S}$. This, of course, has been assumed in the idealized model of device operation utilized thus far. We are about to rectify an important shortcoming of this model. First, however, we present an example.


Figure 5.14 The $i_{D}-v_{G S}$ characteristic of an NMOS transistor operating in the saturation region. The $i_{D}-v_{O V}$ characteristic can be obtained by simply relabeling the horizontal axis, that is, shifting the origin to the point $v_{G S}=V_{m}$.


Figure 5.15 Large-signal, equivalent-circuit model of an $n$-channel MOSFET operating in the saturation region.
# Example 5.2 

Consider an NMOS transistor fabricated in a $0.18-\mu \mathrm{m}$ process with $L=0.18 \mu \mathrm{~m}$ and $W=2 \mu \mathrm{~m}$. The process technology is specified to have $C_{o s}=8.6 \mathrm{fF} / \mu \mathrm{m}^{2}, \mu_{n}=450 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$, and $V_{t n}=0.5 \mathrm{~V}$.
(a) Find $V_{G S}$ and $V_{D S}$ that result in the MOSFET operating at the edge of saturation with $I_{D}=100 \mu \mathrm{~A}$.
(b) If $V_{G S}$ is kept constant, find $V_{D S}$ that results in $I_{D}=50 \mu \mathrm{~A}$.
(c) To investigate the use of the MOSFET as a linear amplifier, let it be operating in saturation with $V_{D S}=0.3 \mathrm{~V}$. Find the change in $i_{D}$ resulting from $v_{G S}$ changing from 0.7 V by +0.01 V and by -0.01 V .

## Solution

First we determine the process transconductance parameter $k_{u}^{\prime}$,

$$
\begin{aligned}
k_{u}^{\prime} & =\mu_{n} C_{o s} \\
& =450 \times 10^{-4} \times 8.6 \times 10^{-15} \times 10^{12} \mathrm{~A} / \mathrm{V}^{2} \\
& =387 \mu \mathrm{~A} / \mathrm{V}^{2}
\end{aligned}
$$

and the transistor transconductance parameter $k_{n}$,

$$
\begin{aligned}
k_{u} & =k_{u}^{\prime}\left(\frac{W}{L}\right) \\
& =387\left(\frac{2}{0.18}\right)=4.3 \mathrm{~mA} / \mathrm{V}^{2}
\end{aligned}
$$

(a) With the transistor operating in saturation,

$$
I_{D}=\frac{1}{2} k_{u} V_{O V}^{2}
$$

Thus,

$$
100=\frac{1}{2} \times 4.3 \times 10^{3} \times V_{O V}^{2}
$$

which results in

$$
V_{O V}=0.22 \mathrm{~V}
$$

Thus,

$$
V_{G S}=V_{t n}+V_{O V}=0.5+0.22=0.72 \mathrm{~V}
$$

and since operation is at the edge of saturation,

$$
V_{D S}=V_{O V}=0.22 \mathrm{~V}
$$
# Example 5.2 continued 

(b) With $V_{G S}$ kept constant at 0.72 V and $I_{D}$ reduced from the value obtained at the edge of saturation, the MOSFET will now be operating in the triode region, thus

$$
\begin{aligned}
& I_{D}=k_{\mathrm{s}}\left[V_{O V} V_{D S}-\frac{1}{2} V_{D S}^{2}\right] \\
& 50=4.3 \times 10^{3}\left[0.22 V_{D S}-\frac{1}{2} V_{D S}^{2}\right]
\end{aligned}
$$

which can be rearranged to the form

$$
V_{D S}^{2}-0.44 V_{D S}+0.023=0
$$

This quadratic equation has two solutions

$$
V_{D S}=0.06 \mathrm{~V} \quad \text { and } \quad V_{D S}=0.39 \mathrm{~V}
$$

The second answer is greater than $V_{O V}$ and thus is physically meaningless, since we know that the transistor is operating in the triode region. Thus we have

$$
V_{D S}=0.06 \mathrm{~V}
$$

(c) For $v_{G S}=0.7 \mathrm{~V}, V_{O V}=0.2 \mathrm{~V}$, and since $V_{D S}=0.3 \mathrm{~V}$, the transistor is operating in saturation and

$$
\begin{aligned}
I_{D} & =\frac{1}{2} k_{\mathrm{s}} V_{O V}^{2} \\
& =\frac{1}{2} \times 4300 \times 0.04 \\
& =86 \mu \mathrm{~A}
\end{aligned}
$$

Now for $v_{G S}=0.710 \mathrm{~V}, v_{O V}=0.21 \mathrm{~V}$ and

$$
i_{D}=\frac{1}{2} \times 4300 \times 0.21^{2}=94.8 \mu \mathrm{~A}
$$

and for $v_{G S}=0.690 \mathrm{~V}, v_{O V}=0.19 \mathrm{~V}$, and

$$
i_{D}=\frac{1}{2} \times 4300 \times 0.19^{2}=77.6 \mu \mathrm{~A}
$$

Thus, with $\Delta v_{G S}=+0.01 \mathrm{~V}, \Delta i_{D}=8.8 \mu \mathrm{~A}$; and for $\Delta v_{G S}=-0.01 \mathrm{~V}, \Delta i_{D}=-8.4 \mu \mathrm{~A}$.
We conclude that the two changes are almost equal, an indication of almost-linear operation when the changes in $v_{G S}$ are kept small. This is just a preview of the "small-signal operation" of the MOSFET studied in Chapter 7.
# EXERCISES 

5.4 An NMOS transistor is operating at the edge of saturation with an overdrive voltage $V_{O V}$ and a drain current $I_{D}$. If $V_{O V}$ is doubled, and we must maintain operation at the edge of saturation, what should $V_{D S}$ be changed to? What value of drain current results?
Ans. $2 V_{O V} ; 4 I_{D}$
5.5 An $n$-channel MOSFET operating with $V_{O V}=0.5 \mathrm{~V}$ exhibits a linear resistance $r_{D S}=1 \mathrm{k} \Omega$ when $v_{D S}$ is very small. What is the value of the device transconductance parameter $k_{b}$ ? What is the value of the current $I_{D}$ obtained when $v_{D S}$ is increased to 0.5 V ? and to 1 V ?
Ans. $2 \mathrm{~mA} / \mathrm{V}^{2} ; 0.25 \mathrm{~mA} ; 0.25 \mathrm{~mA}$

### 5.2.4 Finite Output Resistance in Saturation

Equation (5.21) and the corresponding large-signal equivalent circuit in Fig. 5.15, as well as the graphs in Fig. 5.13, indicate that in saturation, $i_{D}$ is independent of $v_{D S}$. Thus, a change $\Delta v_{D S}$ in the drain-to-source voltage causes a zero change in $i_{D}$, which implies that the incremental resistance looking into the drain of a saturated MOSFET is infinite. This, however, is an idealization based on the premise that once the channel is pinched off at the drain end, further increases in $v_{D S}$ have no effect on the channel's shape. But, in practice, increasing $v_{D S}$ beyond $v_{O V}$ does affect the channel somewhat. Specifically, as $v_{D S}$ is increased, the channel pinch-off point is moved slightly away from the drain, toward the source. This is illustrated in Fig. 5.16, from which we note that the voltage across the channel remains constant at $v_{O V}$, and the additional voltage applied to the drain appears as a voltage drop across the narrow depletion region between the end of the channel and the drain region. This voltage accelerates the electrons that reach the drain end of the channel and sweeps them across the depletion region into the drain. Note, however, that (with depletion-layer widening) the channel length is in effect reduced, from $L$ to $L-\Delta L$, a phenomenon known as channel-length modulation. Now, since $i_{D}$ is inversely proportional to the channel length (Eq. 5.21), $i_{D}$ increases with $v_{D S}$.


Figure 5.16 Increasing $v_{D S}$ beyond $v_{D S \text { on }}$ causes the channel pinch-off point to move slightly away from the drain, thus reducing the effective channel length (by $\Delta L$ ).This effect can be accounted for in the expression for $i_{D}$ by including a factor $1+\lambda\left(v_{D S}-v_{O V}\right)$ or, for simplicity, $\left(1+\lambda v_{D S}\right)$,

$$
i_{D}=\frac{1}{2} k_{n}^{\prime}\left(\frac{W}{L}\right)\left(v_{G S}-V_{m}\right)^{2}\left(1+\lambda v_{D S}\right)
$$

Here $\lambda$ is a device parameter having the units of reciprocal volts $\left(\mathrm{V}^{-1}\right)$. The value of $\lambda$ depends both on the process technology used to fabricate the device and on the channel length $L$ that the circuit designer selects. Specifically, the value of $\lambda$ is much larger for newer submicron technologies than for older technologies. This makes intuitive sense: Newer technologies have very short channels, and are thus much more greatly impacted by the channel-length modulation effect. Also, for a given process technology, $\lambda$ is inversely proportional to $L$.

A typical set of $i_{D}-v_{D S}$ characteristics showing the effect of channel-length modulation is displayed in Fig. 5.17. The observed linear dependence of $i_{D}$ on $v_{D S}$ in the saturation region is represented in Eq. (5.23) by the factor $\left(1+\lambda v_{D S}\right)$. From Fig. 5.17 we observe that when the straight-line $i_{D}-v_{D S}$ characteristics are extrapolated, they intercept the $v_{D S}$ axis at the point, $v_{D S}=-V_{A}$, where $V_{A}$ is a positive voltage. Equation (5.23), however, indicates that $i_{D}=0$ at $v_{D S}=-1 / \lambda$. It follows that

$$
V_{A}=\frac{1}{\lambda}
$$

and thus $V_{A}$ is a device parameter with the dimensions of V. For a given process, $V_{A}$ is proportional to the channel length $L$ that the designer selects for a MOSFET. We can isolate the dependence of $V_{A}$ on $L$ by expressing it as

$$
V_{A}=V_{A}^{\prime} L
$$

where $V_{A}^{\prime}$ is entirely process-technology dependent, with the dimensions of volts per micron. Typically, $V_{A}^{\prime}$ falls in the range of $5 \mathrm{~V} / \mu \mathrm{m}$ to $50 \mathrm{~V} / \mu \mathrm{m}$. The voltage $V_{A}$ is usually referred to as the Early voltage, after J. M. Early, who discovered a similar phenomenon for the BJT (Chapter 6).


Figure 5.17 Effect of $v_{D S}$ on $i_{D}$ in the saturation region. The MOSFET parameter $V_{A}$ depends on the process technology and, for a given process, is proportional to the channel length $L$.
Equation (5.23) indicates that when channel-length modulation is taken into account, the saturation values of $i_{D}$ depend on $v_{D S}$. Thus, for a given $v_{G S}$, a change $\Delta v_{D S}$ yields a corresponding change $\Delta i_{D}$ in the drain current $i_{D}$. It follows that the output resistance of the current source representing $i_{D}$ in saturation is no longer infinite. Defining the output resistance $r_{o}$ as $^{8}$

$$
r_{o} \equiv\left[\frac{\partial i_{D}}{\partial v_{D S}}\right]_{v_{G S} \text { constant }}^{-1}
$$

and using Eq. (5.23) results in

$$
r_{o}=\left[\lambda \frac{k_{n}^{\prime}}{2} \frac{W}{L}\left(V_{G S}-V_{t n}\right)^{2}\right]^{-1}
$$

which can be written as

$$
r_{o}=\frac{1}{\lambda I_{D}}
$$

or, equivalently,

$$
r_{o}=\frac{V_{A}}{I_{D}^{\prime}}
$$

where $I_{D}^{\prime}$ is the drain current without channel-length modulation taken into account; that is,

$$
I_{D}^{\prime}=\frac{1}{2} k_{n}^{\prime} \frac{W}{L}\left(V_{G S}-V_{t n}\right)^{2}
$$

Thus the output resistance is inversely proportional to the drain current. ${ }^{9}$ Finally, we show in Fig. 5.18 the large-signal, equivalent-circuit model incorporating $r_{o}$.


Figure 5.18 Large-signal, equivalent-circuit model of the $n$-channel MOSFET in saturation, incorporating the output resistance $r_{o}$. The output resistance models the linear dependence of $i_{D}$ on $v_{D S}$ and is given by Eq. (5.27).

[^0]
[^0]:    ${ }^{8}$ In this book we use $r_{o}$ to denote the output resistance in saturation, and $r_{D S}$ to denote the drain-to-source resistance in the triode region, for small $v_{D S}$.
    ${ }^{9}$ In applying Eq. (5.27) we will usually drop the prime on $I_{D}$ and simply use $r_{o}=V_{A} / I_{D}$ where $I_{D}$ is the drain current without channel-length modulation.
# EXERCISE 

5.6 An NMOS transistor is fabricated in a $0.4-\mu \mathrm{m}$ process having $\mu_{o} C_{o s}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{A}^{\prime}=50 \mathrm{~V} / \mu \mathrm{m}$ of channel length. If $L=0.8 \mu \mathrm{~m}$ and $W=16 \mu \mathrm{~m}$, find $V_{A}$ and $\lambda$. Find the value of $I_{D}$ that results when the device is operated with an overdrive voltage $V_{O V}=0.5 \mathrm{~V}$ and $V_{D S}=1 \mathrm{~V}$. Also, find the value of $r_{o}$ at this operating point. If $V_{D S}$ is increased by 2 V , what is the corresponding change in $I_{D}$ ? Ans. $40 \mathrm{~V} ; 0.025 \mathrm{~V}^{-1} ; 0.51 \mathrm{~mA} ; 80 \mathrm{k} \Omega ; 0.025 \mathrm{~mA}$

### 5.2.5 Characteristics of the $p$-Channel MOSFET

The circuit symbol for the $p$-channel enhancement-type MOSFET is shown in Fig. 5.19(a). Figure 5.19(b) shows a modified circuit symbol in which an arrowhead pointing in the normal direction of current flow is included on the source terminal. For the case where the source is connected to the substrate, the simplified symbol of Fig. 5.19(c) is usually used.


Figure 5.19 (a) Circuit symbol for the $p$-channel enhancement-type MOSFET. (b) Modified symbol with an arrowhead on the source lead. (c) Simplified circuit symbol for the case where the source is connected to the body.

The regions of operation of the PMOS transistor and the corresponding conditions and expression for $i_{D}$ are shown in Table 5.2. Observe that the equations are written in a way that emphasizes physical intuition and avoids the confusion of negative signs. Thus while $V_{i p}$ is by convention negative, we use $\left|V_{i p}\right|$, and the voltages $v_{S G}$ and $v_{S D}$ are positive. Also, in all of our circuit diagrams we will always draw $p$-channel devices with their sources on top so that current flows from top to bottom. Finally, we note that PMOS devices also suffer from the channel-length modulation effect. This can be taken into account by including a factor $\left(1+|\lambda| v_{S D}\right)$ in the saturation-region expression for $i_{D}$ as follows

$$
i_{D}=\frac{1}{2} k_{p}^{\prime}\left(\frac{W}{L}\right)\left(v_{S G}-\left|V_{i p}\right|\right)^{2}\left(1+|\lambda| v_{S D}\right)
$$
Table 5.2 Regions of Operation of the Enhancement PMOS Transistor


- $v_{S G}<\left|V_{t p}\right|$ : no channel; transistor in cutoff; $i_{D}=0$
- $v_{S G}=\left|V_{t p}\right|+\left|v_{O V}\right|$ : a channel is induced; transistor operates in the triode region or in the saturation region depending on whether the channel is continuous or pinched off at the drain end;

Triode Region
Continuous channel, obtained by:

$$
v_{D G}>\left|V_{t p}\right|
$$

or equivalently

$$
v_{S D}<\left|v_{O V}\right|
$$

Then

$$
i_{D}=k_{p}^{\prime}\left(\frac{W}{L}\right)\left[\left(v_{S G}-\left|V_{t p}\right|\right) v_{S D}-\frac{1}{2} v_{S D}^{2}\right]
$$

or equivalently

$$
i_{D}=k_{p}^{\prime}\left(\frac{W}{L}\right)\left(\left|v_{O V}\right|-\frac{1}{2} v_{S D}\right) v_{S D}
$$

Saturation Region
Pinched-off channel, obtained by:

$$
v_{D G} \leq\left|V_{t p}\right|
$$

or equivalently

$$
v_{S D} \geq\left|v_{O V}\right|
$$

Then

$$
i_{D}=\frac{1}{2} k_{p}^{\prime}\left(\frac{W}{L}\right)\left(v_{S G}-\left|V_{t p}\right|\right)^{2}
$$

or equivalently

$$
i_{D}=\frac{1}{2} k_{p}^{\prime}\left(\frac{W}{L}\right) v_{O V}^{2}
$$

or equivalently

$$
i_{D}=\frac{1}{2} k_{p}^{\prime}\left(\frac{W}{L}\right)\left(v_{S G}-\left|V_{t p}\right|\right)^{2}\left(1+\frac{v_{S D}}{\left|V_{A}\right|}\right)
$$

where $\lambda$ and $V_{A}$ (the Early voltage for the PMOS transistor) are by convention negative quantities, hence we use $|\lambda|$ and $\left|V_{A}\right|$.

Finally, we should note that for a given CMOS fabrication process $\lambda_{n}$ and $\left|\lambda_{p}\right|$ are generally not equal, and similarly for $V_{A n}$ and $\left|V_{A p}\right|$.

To recap, to turn a PMOS transistor on, the gate voltage has to be made lower than that of the source by at least $\left|V_{s p}\right|$. To operate in the triode region, the drain voltage has to exceed that of the gate by at least $\left|V_{s p}\right|$; otherwise, the PMOS operates in saturation. Finally, Fig. 5.20 provides a pictorial representation of these operating conditions.


Figure 5.20 The relative levels of the terminal voltages of the enhancement-type PMOS transistor for operation in the triode region and in the saturation region.

# EXERCISE 

5.7 The PMOS transistor shown in Fig. E5.7 has $V_{i p}=-1 \mathrm{~V}, k_{p}^{\prime}=60 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $W / L=10$.
(a) Find the range of $V_{G}$ for which the transistor conducts.
(b) In terms of $V_{G}$, find the range of $V_{D}$ for which the transistor operates in the triode region.
(c) In terms of $V_{G}$, find the range of $V_{D}$ for which the transistor operates in saturation.
(d) Neglecting channel-length modulation (i.e., assuming $\lambda=0$ ), find the values of $\left|V_{O V}\right|$ and $V_{G}$ and the corresponding range of $V_{D}$ to operate the transistor in the saturation mode with $I_{D}=75 \mu \mathrm{~A}$.
(e) If $\lambda=-0.02 \mathrm{~V}^{-1}$, find the value of $r_{\infty}$ corresponding to the overdrive voltage determined in (d).
(f) For $\lambda=-0.02 \mathrm{~V}^{-1}$ and for the value of $V_{O V}$ determined in (d), find $I_{D}$ at $V_{D}=+3 \mathrm{~V}$ and at $V_{D}=0 \mathrm{~V}$; hence, calculate the value of the apparent output resistance in saturation. Compare to the value found in (e).


Figure E5.7
Ans. (a) $V_{G} \leq+4 \mathrm{~V}$; (b) $V_{D} \geq V_{G}+1$; (c) $V_{D} \leq V_{G}+1$; (d) $0.5 \mathrm{~V}, 3.5 \mathrm{~V}, \leq 4.5 \mathrm{~V}$; (e) $0.67 \mathrm{M} \Omega$; (f) $78 \mu \mathrm{~A}$, $82.5 \mu \mathrm{~A}, 0.67 \mathrm{M} \Omega$ (same)

### 5.3 MOSFET Circuits at DC

Having studied the current-voltage characteristics of MOSFETs, we now consider circuits in which only dc voltages and currents are of concern. Specifically, we shall present a series of design and analysis examples of MOSFET circuits at dc. The objective is to instill in the
reader a familiarity with the device and the ability to perform MOSFET circuit analysis both rapidly and effectively.

In the following examples, to keep matters simple and thus focus attention on the essence of MOSFET circuit operation, we will generally neglect channel-length modulation; that is, we will assume $\lambda=0$. We will find it convenient to work in terms of the overdrive voltage; $V_{O V}=V_{G S}-V_{i n}$ for NMOS and $\left|V_{O V}\right|=V_{S G}-\left|V_{i p}\right|$ for PMOS.

# Example 5.3 

Design the circuit of Fig. 5.21: that is, determine the values of $R_{D}$ and $R_{S}$ so that the transistor operates at $I_{D}=0.4 \mathrm{~mA}$ and $V_{D}=+0.5 \mathrm{~V}$. The NMOS transistor has $V_{i}=0.7 \mathrm{~V}, \mu_{n} C_{o s}=100 \mu \mathrm{~A} / \mathrm{V}^{2}, L=1 \mu \mathrm{~m}$, and $W=32 \mu \mathrm{~m}$. Neglect the channel-length modulation effect (i.e., assume that $\lambda=0$ ).


Figure 5.21 Circuit for Example 5.3.

## Solution

To establish a dc voltage of +0.5 V at the drain, we must select $R_{D}$ as follows:

$$
\begin{aligned}
R_{D} & =\frac{V_{D D}-V_{D}}{I_{D}} \\
& =\frac{2.5-0.5}{0.4}=5 \mathrm{k} \Omega
\end{aligned}
$$

To determine the value required for $R_{S}$, we need to know the voltage at the source, which can be easily found if we know $V_{G S}$. This in turn can be determined from $V_{O V}$. Toward that end, we note that since $V_{D}=0.5 \mathrm{~V}$ is greater than $V_{G}$, the NMOS transistor is operating in the saturation region, and we can use the saturation-region expression of $i_{D}$ to determine the required value of $V_{O V}$,

$$
I_{D}=\frac{1}{2} \mu_{n} C_{o s} \frac{W}{L} V_{O V}^{2}
$$

Then substituting $I_{D}=0.4 \mathrm{~mA}=400 \mu \mathrm{~A}, \mu_{n} C_{o s}=100 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $W / L=32 / 1$ gives

$$
400=\frac{1}{2} \times 100 \times \frac{32}{1} V_{O V}^{2}
$$
# Example 5.3 continued 

which results in

$$
V_{O V}=0.5 \mathrm{~V}
$$

Thus,

$$
V_{G S}=V_{t}+V_{O V}=0.7+0.5=1.2 \mathrm{~V}
$$

Referring to Fig. 5.21, we note that the gate is at ground potential. Thus, the source must be at -1.2 V , and the required value of $R_{S}$ can be determined from

$$
\begin{aligned}
R_{S} & =\frac{V_{S}-V_{S S}}{I_{D}} \\
& =\frac{-1.2-(-2.5)}{0.4}=3.25 \mathrm{k} \Omega
\end{aligned}
$$

## EXERCISE

D5.8 Redesign the circuit of Fig. 5.21 for the following case: $V_{D D}=-V_{S S}=2.5 \mathrm{~V}, V_{t}=1 \mathrm{~V}, \mu_{n} C_{o s}=$ $60 \mu \mathrm{~A} / \mathrm{V}^{2}, W / L=120 \mu \mathrm{~m} / 3 \mu \mathrm{~m}, I_{D}=0.3 \mathrm{~mA}$, and $V_{D}=+0.4 \mathrm{~V}$.
Ans. $R_{D}=7 \mathrm{k} \Omega ; R_{S}=3.3 \mathrm{k} \Omega$

## Example 5.4

Figure 5.22 shows an NMOS transistor with its drain and gate terminals connected together. Find the $i-v$ relationship of the resulting two-terminal device in terms of the MOSFET parameters $k_{b}=k_{b}^{\prime}(W / L)$ and $V_{t v}$. Neglect channel-length modulation (i.e., $\lambda=0$ ). Note that this two-terminal device is known as a diode-connected transistor.


Figure 5.22
# Solution 

Since $v_{D}=v_{G}$ implies operation in the saturation mode,

$$
i_{D}=\frac{1}{2} k_{e}^{\prime}\left(\frac{W}{L}\right)\left(v_{G S}-V_{m}\right)^{2}
$$

Now, $i=i_{D}$ and $v=v_{G S}$, thus

$$
i=\frac{1}{2} k_{e}^{\prime}\left(\frac{W}{L}\right)\left(v-V_{m}\right)^{2}
$$

Replacing $k_{e}^{\prime}\left(\frac{W}{L}\right)$ by $k_{a}$ results in

$$
i=\frac{1}{2} k_{e}\left(v-V_{m}\right)^{2}
$$

## EXERCISES

D5.9 For the circuit in Fig. E5.9, find the value of $R$ that results in $V_{D}=0.7 \mathrm{~V}$. The MOSFET has $V_{m}=0.5 \mathrm{~V}, \mu_{n} C_{o s}=0.4 \mathrm{~mA} / \mathrm{V}^{2}, W / L=\frac{0.72 \mu \mathrm{~m}}{0.18 \mu \mathrm{~m}}$, and $\lambda=0$.
Ans. $34.4 \mathrm{k} \Omega$


Figure E5.9

D5.10 Figure E5.10 shows a circuit obtained by augmenting the circuit of Fig. E5.9 considered in Exercise 5.9 with a transistor $Q_{2}$ identical to $Q_{1}$ and a resistance $R_{2}$. Find the value of $R_{2}$ that results in $Q_{2}$ operating at the edge of the saturation region. Use your solution to Exercise 5.9.
Ans. $50 \mathrm{k} \Omega$


Figure E5.10

# Example 5.5 

Design the circuit in Fig. 5.23 to establish a drain voltage of 0.1 V . What is the effective resistance between drain and source at this operating point? Let $V_{m}=1 \mathrm{~V}$ and $k_{n}^{\prime}(W / L)=1 \mathrm{~mA} / \mathrm{V}^{2}$.


Figure 5.23 Circuit for Example 5.5.

## Solution

Since the drain voltage is lower than the gate voltage by 4.9 V and $V_{m}=1 \mathrm{~V}$, the MOSFET is operating in the triode region. Thus the current $I_{D}$ is given by

$$
\begin{aligned}
I_{D} & =k_{n}^{\prime} \frac{W}{L}\left[\left(V_{G S}-V_{m}\right) V_{D S}-\frac{1}{2} V_{D S}^{2}\right] \\
I_{D} & =1 \times\left[(5-1) \times 0.1-\frac{1}{2} \times 0.01\right] \\
& =0.395 \mathrm{~mA}
\end{aligned}
$$
The required value for $R_{D}$ can be found as follows:

$$
\begin{aligned}
R_{D} & =\frac{V_{D D}-V_{D}}{I_{D}} \\
& =\frac{5-0.1}{0.395}=12.4 \mathrm{k} \Omega
\end{aligned}
$$

In a practical discrete-circuit design problem, one selects the closest standard value available for, say, $5 \%$ resistors-in this case, $12 \mathrm{k} \Omega$; see Appendix J. Since the transistor is operating in the triode region with a small $V_{D S}$, the effective drain-to-source resistance can be determined as follows:

$$
\begin{aligned}
r_{D S} & =\frac{V_{D S}}{I_{D}} \\
& =\frac{0.1}{0.395}=253 \Omega
\end{aligned}
$$

Alternatively, we can determine $r_{D S}$ by using the formula

$$
r_{D S}=\frac{1}{k_{n} V_{D V}}
$$

to obtain

$$
r_{D S}=\frac{1}{1 \times(5-1)}=0.25 \mathrm{k} \Omega=250 \Omega
$$

which is close to the value found above.

# EXERCISE 

5.11 If in the circuit of Example 5.5 the value of $R_{D}$ is doubled, find approximate values for $I_{D}$ and $V_{D}$. Ans. $0.2 \mathrm{~mA} ; 0.05 \mathrm{~V}$

## Example 5.6

Analyze the circuit shown in Fig. 5.24(a) to determine the voltages at all nodes and the currents through all branches. Let $V_{m}=1 \mathrm{~V}$ and $k_{n}^{\prime}(W / L)=1 \mathrm{~mA} / \mathrm{V}^{2}$. Neglect the channel-length modulation effect (i.e., assume $\lambda=0$ ).# PART I 

## Devices and Basic Circuits

CHAPTER 1
Signals and Amplifiers 4

CHAPTER 2
Operational Amplifiers 58

CHAPTER 3
Semiconductors 134

CHAPTER 4
Diodes 174

CHAPTER 5
MOS Field-Effect Transistors (MOSFETs) 246

CHAPTER 6
Bipolar Junction Transistors (BJTs) 304

CHAPTER 7
Transistor Amplifiers 366
Part I, Devices and Basic Circuits, includes the most fundamental and essential topics for the study of electronic circuits. At the same time, it constitutes a complete package for a first course on the subject.

The heart of Part I is the study of the three basic semiconductor devices: the diode (Chapter 4), the MOS transistor (Chapter 5), and the bipolar transistor (Chapter 6). In each case, we study the device operation, its characterization, and its basic circuit applications. Chapter 7 then follows with a study of the most fundamental application of the two transistor types; namely, their use in amplifier design. This side-by-side study of MOSFET and BJT amplifiers allows us to see similarities between these amplifiers and to compare them, which in turn highlights the distinct areas of applicability of each, as well as showing the unity of the basic principles that underlie the use of transistors as amplifiers.

For those who have not had a prior course on device physics, Chapter 3 provides an overview of semiconductor concepts at a level sufficient for the study of electronic circuits. A review of Chapter 3 should prove useful even for those with prior knowledge of semiconductors.

Since the purpose of electronic circuits is the processing of signals, it is essential to understand signals, their characterization in the time and frequency domains, and their analog and digital representations. The basis for such understanding is provided in Chapter 1, which also introduces the most common signal-processing function, amplification, and the characterization and types of amplifiers.

Besides diodes and transistors, the basic electronic devices, the op amp is studied in Part I. Although not an electronic device in the most fundamental sense, the op amp is commercially available as an integrated circuit (IC) package and has well-defined terminal characteristics. Thus, even though the op amp's internal circuit is complex, typically incorporating 20 or more transistors, its almost-ideal terminal behavior makes it possible to treat the op amp as a circuit element and to use it in the design of powerful circuits, as we do in Chapter 2, without any knowledge of its internal construction. We should mention, however, that the study of op amps can be delayed until a later point, and Chapter 2 can be skipped with no loss of continuity.

The foundation of this book, and of any electronics course, is the study of the two transistor types in use today: the MOS transistor in Chapter 5 and the bipolar transistor in Chapter 6. These two chapters have been written to be completely independent of each other and thus can be studied in either order, as desired.

After the study of Part I, the reader will be fully prepared to undertake the study of either integrated-circuit amplifiers in Part II or digital integrated circuits in Part III.
# CHAPTER 1 

## Signals and Amplifiers

Introduction 5
1.1 Signals 6
1.2 Frequency Spectrum of Signals 9
1.3 Analog and Digital Signals 12
1.4 Amplifiers 15
1.5 Circuit Models for Amplifiers 23
1.6 Frequency Response of Amplifiers 33

Summary 44
Problems 45
# IN THIS CHAPTER YOU WILL LEARN 

1. That electronic circuits process signals, and thus understanding electrical signals is essential to appreciating the material in this book.
2. The Thévenin and Norton representations of signal sources.
3. The representation of a signal as the sum of sine waves.
4. The analog and digital representations of a signal.
5. The most basic and pervasive signal-processing function: signal amplification, and correspondingly, the signal amplifier.
6. How amplifiers are characterized (modeled) as circuit building blocks independent of their internal circuitry.
7. How the frequency response of an amplifier is measured, and how it is calculated, especially in the simple but common case of a single-time-constant (STC) type response.

## Introduction

The subject of this book is modern electronics, a field that has come to be known as microelectronics. Microelectronics refers to the integrated-circuit (IC) technology that at the time of this writing is capable of producing circuits that contain billions of components in a small piece of silicon (known as a silicon chip) whose area is on the order of $100 \mathrm{~mm}^{2}$. One such microelectronic circuit, for example, is a complete digital computer, which accordingly is known as a microcomputer or, more generally, a microprocessor. The microelectronic circuits you will learn to design in this book are used in almost every device we encounter in our daily lives: in the appliances we use in our homes; in the vehicles and transportation systems we use to travel; in the cell phones we use to communicate; in the medical equipment we need to care for our health; in the computers we use to do our work; and in the audio and video systems, the radio and TV sets, and the multitude of other digital devices we use to entertain ourselves. Indeed, it is difficult to conceive of modern life without microelectronic circuits.

In this book we shall study electronic devices that can be used singly (in the design of discrete circuits) or as components of an integrated-circuit (IC) chip. We shall study the design and analysis of interconnections of these devices, which form discrete and integrated
circuits of varying complexity and perform a wide variety of functions. We shall also learn about available IC chips and their application in the design of electronic systems.

The purpose of this first chapter is to introduce some basic concepts and terminology. In particular, we shall learn about signals and about one of the most important signal-processing functions electronic circuits are designed to perform, namely, signal amplification. We shall then look at circuit representations or models for linear amplifiers. These models will be employed in subsequent chapters in the design and analysis of actual amplifier circuits.

In addition to motivating the study of electronics, this chapter serves as a bridge between the study of linear circuits and that of the subject of this book: the design and analysis of electronic circuits.

# 1.1 Signals 

Signals contain information about a variety of things and activities in our physical world. Examples abound: Information about the weather is contained in signals that represent the air temperature, pressure, wind speed, etc. The voice of a radio announcer reading the news into a microphone provides an acoustic signal that contains information about world affairs. To monitor the status of a nuclear reactor, instruments are used to measure a multitude of relevant parameters, each instrument producing a signal.

To extract required information from a set of signals, the observer (be it a human or a machine) invariably needs to process the signals in some predetermined manner. This signal processing is usually most conveniently performed by electronic systems. For this to be possible, however, the signal must first be converted into an electrical signal, that is, a voltage or a current. This process is accomplished by devices known as transducers. A variety of transducers exist, each suitable for one of the various forms of physical signals. For instance, the sound waves generated by a human can be converted into electrical signals by using a microphone, which is in effect a pressure transducer. It is not our purpose here to study transducers; rather, we shall assume that the signals of interest already exist in the electrical domain and represent them by one of the two equivalent forms shown in Fig. 1.1. In Fig. 1.1(a) the signal is represented by a voltage source $v_{s}(t)$ having a source resistance $R_{s}$. In the alternate representation of Fig. 1.1(b) the signal is represented by a current source $i_{s}(t)$ having a source resistance $R_{s}$. Although the two representations are equivalent, that in Fig. 1.1(a) (known as the Thévenin form) is preferred when $R_{s}$ is low. The representation of Fig. 1.1(b) (known as the Norton form) is preferred when $R_{s}$ is high. The reader will come to appreciate this point later in this chapter when we study the different types of amplifiers. For the time being, it is important to be familiar with Thévenin's and Norton's theorems (for a


Figure 1.1 Two alternative representations of a signal source: (a) the Thévenin form; (b) the Norton form.
brief review, see Appendix D) and to note that for the two representations in Fig. 1.1 to be equivalent, their parameters are related by

$$
v_{s}(t)=R_{s} i_{s}(t)
$$

# Example 1.1 

The output resistance of a signal source, although inevitable, is an imperfection that limits the ability of the source to deliver its full signal strength to a load. To see this point more clearly, consider the signal source when connected to a load resistance $R_{L}$ as shown in Fig. 1.2. For the case in which the source is represented by its Thévenin equivalent form, find the voltage $v_{o}$ that appears across $R_{L}$, and hence the condition that $R_{s}$ must satisfy for $v_{o}$ to be close to the value of $v_{s}$. Repeat for the Norton-represented source; in this case finding the current $i_{o}$ that flows through $R_{L}$ and hence the condition that $R_{s}$ must satisfy for $i_{o}$ to be close to the value of $i_{s}$.


Figure 1.2 Circuits for Example 1.1.

## Solution

For the Thévenin-represented signal source shown in Fig. 1.2(a), the output voltage $v_{o}$ that appears across the load resistance $R_{L}$ can be found from the ratio of the voltage divider formed by $R_{s}$ and $R_{L}$,

$$
v_{o}=v_{s} \frac{R_{L}}{R_{L}+R_{s}}
$$

From this equation we see that for

$$
v_{o} \simeq v_{s}
$$

the source resistance $R_{s}$ must be much lower than the load resistance $R_{L}$,

$$
R_{s} \ll R_{L}
$$

Thus, for a source represented by its Thévenin equivalent, ideally $R_{s}=0$, and as $R_{s}$ is increased, relative to the load resistance $R_{L}$ with which this source is intended to operate, the voltage $v_{o}$ that appears across the load becomes smaller, not a desirable outcome.
# Example 1.1 continued 

Next, we consider the Norton-represented signal source in Fig. 1.2(b). To obtain the current $i_{o}$ that flows through the load resistance $R_{L}$, we utilize the ratio of the current divider formed by $R_{s}$ and $R_{L}$,

$$
i_{o}=i_{s} \frac{R_{s}}{R_{s}+R_{L}}
$$

From this relationship we see that for

$$
i_{o} \simeq i_{s}
$$

the source resistance $R_{s}$ must be much larger than $R_{L}$,

$$
R_{s} \gg R_{L}
$$

Thus for a signal source represented by its Norton equivalent, ideally $R_{s}=\infty$, and as $R_{s}$ is reduced, relative to the load resistance $R_{L}$ with which this source is intended to operate, the current $i_{o}$ that flows through the load becomes smaller, not a desirable outcome.

Finally, we note that although circuit designers cannot usually do much about the value of $R_{s}$, they may have to devise a circuit solution that minimizes or eliminates the loss of signal strength that results when the source is connected to the load.

## EXERCISES

1.1 For the signal-source representations shown in Figs. 1.1(a) and 1.1(b), what are the open-circuit output voltages that would be observed? If, for each, the output terminals are short-circuited (i.e., wired together), what current would flow? For the representations to be equivalent, what must the relationship be between $v_{s}, i_{s}$, and $R_{s}$ ?
Ans. For (a), $v_{\text {oc }}=v_{s}(t)$; for (b), $v_{\text {oc }}=R_{s} i_{s}(t)$; for (a), $i_{\text {sc }}=v_{s}(t) / R_{s}$; for (b), $i_{\text {sc }}=i_{s}(t)$; for equivalency, $v_{s}(t)=R_{s} i_{s}(t)$
1.2 A signal source has an open-circuit voltage of 10 mV and a short-circuit current of $10 \mu \mathrm{~A}$. What is the source resistance?
Ans. $1 \mathrm{k} \Omega$
1.3 A signal source that is most conveniently represented by its Thévenin equivalent has $v_{s}=10 \mathrm{mV}$ and $R_{s}=1 \mathrm{k} \Omega$. If the source feeds a load resistance $R_{L}$, find the voltage $v_{o}$ that appears across the load for $R_{L}=100 \mathrm{k} \Omega, 10 \mathrm{k} \Omega, 1 \mathrm{k} \Omega$, and $100 \Omega$. Also, find the lowest permissible value of $R_{L}$ for which the output voltage is at least $80 \%$ of the source voltage.
Ans. $9.9 \mathrm{mV} ; 9.1 \mathrm{mV} ; 5 \mathrm{mV} ; 0.9 \mathrm{mV} ; 4 \mathrm{k} \Omega$
1.4 A signal source that is most conveniently represented by its Norton equivalent form has $i_{s}=10 \mu \mathrm{~A}$ and $R_{s}=100 \mathrm{k} \Omega$. If the source feeds a load resistance $R_{L}$, find the current $i_{o}$ that flows through the load for $R_{L}=1 \mathrm{k} \Omega, 10 \mathrm{k} \Omega, 100 \mathrm{k} \Omega$, and $1 \mathrm{M} \Omega$. Also, find the largest permissible value of $R_{L}$ for which the load current is at least $80 \%$ of the source current.
Ans. $9.9 \mu \mathrm{~A} ; 9.1 \mu \mathrm{~A} ; 5 \mu \mathrm{~A} ; 0.9 \mu \mathrm{~A} ; 25 \mathrm{k} \Omega$


Figure 1.3 An arbitrary voltage signal $v_{s}(t)$.

From the discussion above, it should be apparent that a signal is a time-varying quantity that can be represented by a graph such as that shown in Fig. 1.3. In fact, the information content of the signal is represented by the changes in its magnitude as time progresses; that is, the information is contained in the "wiggles" in the signal waveform. In general, such waveforms are difficult to characterize mathematically. In other words, it is not easy to describe succinctly an arbitrary-looking waveform such as that of Fig. 1.3. Of course, such a description is of great importance for the purpose of designing appropriate signal-processing circuits that perform desired functions on the given signal. An effective approach to signal characterization is studied in the next section.

# 1.2 Frequency Spectrum of Signals 

An extremely useful characterization of a signal, and for that matter of any arbitrary function of time, is in terms of its frequency spectrum. Such a description of signals is obtained through the mathematical tools of Fourier series and Fourier transform. ${ }^{1}$ We are not interested here in the details of these transformations; suffice it to say that they provide the means for representing a voltage signal $v_{s}(t)$ or a current signal $i_{s}(t)$ as the sum of sine-wave signals of different frequencies and amplitudes. This makes the sine wave a very important signal in the analysis, design, and testing of electronic circuits. Therefore, we shall briefly review the properties of the sinusoid.

Figure 1.4 shows a sine-wave voltage signal $v_{a}(t)$,

$$
v_{a}(t)=V_{a} \sin \omega t
$$

where $V_{a}$ denotes the peak value or amplitude in volts and $\omega$ denotes the angular frequency in radians per second; that is, $\omega=2 \pi f \mathrm{rad} / \mathrm{s}$, where $f$ is the frequency in hertz, $f=1 / T \mathrm{~Hz}$, and $T$ is the period in seconds.

The sine-wave signal is completely characterized by its peak value $V_{a}$, its frequency $\omega$, and its phase with respect to an arbitrary reference time. In the case depicted in Fig. 1.4, the time

[^0]
[^0]:    ${ }^{1}$ The reader who has not yet studied these topics should not be alarmed. No detailed application of this material will be made until Chapter 10. Nevertheless, a general understanding of Section 1.2 should be very helpful in studying early parts of this book.


Figure 1.4 Sine-wave voltage signal of amplitude $V_{u}$ and frequency $f=1 / T \mathrm{~Hz}$. The angular frequency $\omega=2 \pi f \mathrm{rad} / \mathrm{s}$.


Figure 1.5 A symmetrical square-wave signal of amplitude $V$.
origin has been chosen so that the phase angle is 0 . It should be mentioned that it is common to express the amplitude of a sine-wave signal in terms of its root-mean-square (rms) value, which is equal to the peak value divided by $\sqrt{2}$. Thus the rms value of the sinusoid $v_{u}(t)$ of Fig. 1.4 is $V_{u} / \sqrt{2}$. For instance, when we speak of the wall power supply in our homes as being 120 V , we mean that it has a sine waveform of $120 \sqrt{2}$ volts peak value.

Returning now to the representation of signals as the sum of sinusoids, we note that the Fourier series is utilized to accomplish this task for the special case of a signal that is a periodic function of time. On the other hand, the Fourier transform is more general and can be used to obtain the frequency spectrum of a signal whose waveform is an arbitrary function of time.

The Fourier series allows us to express a given periodic function of time as the sum of an infinite number of sinusoids whose frequencies are harmonically related. For instance, the symmetrical square-wave signal in Fig. 1.5 can be expressed as

$$
v(t)=\frac{4 V}{\pi}\left(\sin \omega_{0} t+\frac{1}{3} \sin 3 \omega_{0} t+\frac{1}{5} \sin 5 \omega_{0} t+\cdots\right)
$$

where $V$ is the amplitude of the square wave and $\omega_{0}=2 \pi / T$ ( $T$ is the period of the square wave) is called the fundamental frequency. Note that because the amplitudes of the harmonics progressively decrease, the infinite series can be truncated, with the truncated series providing an approximation to the square waveform.

The sinusoidal components in the series of Eq. (1.2) constitute the frequency spectrum of the square-wave signal. Such a spectrum can be graphically represented as in Fig. 1.6, where the horizontal axis represents the angular frequency $\omega$ in radians per second.


Figure 1.6 The frequency spectrum (also known as the line spectrum) of the periodic square wave of Fig. 1.5.


Figure 1.7 The frequency spectrum of an arbitrary waveform such as that in Fig. 1.3.

The Fourier transform can be applied to a nonperiodic function of time, such as that depicted in Fig. 1.3, and provides its frequency spectrum as a continuous function of frequency, as indicated in Fig. 1.7. Unlike the case of periodic signals, where the spectrum consists of discrete frequencies (at $\omega_{0}$ and its harmonics), the spectrum of a nonperiodic signal contains in general all possible frequencies. Nevertheless, the essential parts of the spectra of practical signals are usually confined to relatively short segments of the frequency ( $\omega$ ) axis-an observation that is very useful in the processing of such signals. For instance, the spectrum of audible sounds such as speech and music extends from about 20 Hz to about 20 kHz -a frequency range known as the audio band. Here we should note that although some musical tones have frequencies above 20 kHz , the human ear is incapable of hearing frequencies that are much above 20 kHz . As another example, analog video signals have their spectra in the range of 0 MHz to 4.5 MHz .

We conclude this section by noting that a signal can be represented either by the manner in which its waveform varies with time, as for the voltage signal $v_{n}(t)$ shown in Fig. 1.3, or in terms of its frequency spectrum, as in Fig. 1.7. The two alternative representations are known as the time-domain representation and the frequency-domain representation, respectively. The frequency-domain representation of $v_{n}(t)$ will be denoted by the symbol $V_{n}(\omega)$.# Example 5.6 continued 



Figure 5.24 (a) Circuit for Example 5.6. (b) The circuit with some of the analysis details shown.

## Solution

Since the gate current is zero, the voltage at the gate is simply determined by the voltage divider formed by the two $10-\mathrm{M} \Omega$ resistors,

$$
V_{G}=V_{D D} \frac{R_{G 2}}{R_{G 2}+R_{G 1}}=10 \times \frac{10}{10+10}=+5 \mathrm{~V}
$$

With this positive voltage at the gate, the NMOS transistor will be turned on. We do not know, however, whether the transistor will be operating in the saturation region or in the triode region. We shall assume saturation-region operation, solve the problem, and then check the validity of our assumption. Obviously, if our assumption turns out not to be valid, we will have to solve the problem again for triode-region operation.

Refer to Fig. 5.24(b). Since the voltage at the gate is 5 V and the voltage at the source is $I_{D}(\mathrm{~mA}) \times$ $6(\mathrm{k} \Omega)=6 I_{D}(\mathrm{~V})$, we have

$$
V_{G S}=5-6 I_{D}
$$

Thus $I_{D}$ is given by

$$
\begin{aligned}
I_{D} & =\frac{1}{2} k_{0}^{\prime} \frac{W}{L}\left(V_{G S}-V_{m}\right)^{2} \\
& =\frac{1}{2} \times 1 \times\left(5-6 I_{D}-1\right)^{2}
\end{aligned}
$$
which results in the following quadratic equation in $I_{D}$ :

$$
18 I_{D}^{2}-25 I_{D}+8=0
$$

This equation yields two values for $I_{D}: 0.89 \mathrm{~mA}$ and 0.5 mA . The first value results in a source voltage of $6 \times 0.89=5.34 \mathrm{~V}$, which is greater than the gate voltage and does not make physical sense as it would imply that the NMOS transistor is cut off. Thus,

$$
\begin{aligned}
I_{D} & =0.5 \mathrm{~mA} \\
V_{S} & =0.5 \times 6=+3 \mathrm{~V} \\
V_{G S} & =5-3=2 \mathrm{~V} \\
V_{D} & =10-6 \times 0.5=+7 \mathrm{~V}
\end{aligned}
$$

Since $V_{D}>V_{G}-V_{w}$, the transistor is operating in saturation, as initially assumed.

# EXERCISES 

5.12 For the circuit of Fig. 5.24, what is the largest value that $R_{D}$ can have while the transistor remains in the saturation mode?
Ans. $12 \mathrm{k} \Omega$
D5.13 Redesign the circuit of Fig. 5.24 for the following requirements: $V_{D D}=+5 \mathrm{~V}, I_{D}=0.32 \mathrm{~mA}$, $V_{S}=1.6 \mathrm{~V}, V_{D}=3.4 \mathrm{~V}$, with a $1-\mu \mathrm{A}$ current through the voltage divider $R_{G 1}, R_{G 2}$. Assume the same MOSFET as in Example 5.6.
Ans. $R_{G 1}=1.6 \mathrm{M} \Omega ; R_{G 2}=3.4 \mathrm{M} \Omega, R_{S}=R_{D}=5 \mathrm{k} \Omega$

## Example 5.7

Design the circuit of Fig. 5.25 so that the transistor operates in saturation with $I_{D}=0.5 \mathrm{~mA}$ and $V_{D}=+3 \mathrm{~V}$. Let the PMOS transistor have $V_{w}=-1 \mathrm{~V}$ and $k_{e}^{\prime}(W / L)=1 \mathrm{~mA} / \mathrm{V}^{2}$. Assume $\lambda=0$. What is the largest value that $R_{D}$ can have while maintaining saturation-region operation?
# Example 5.7 continued 



Figure 5.25 Circuit for Example 5.7.

## Solution

Since the MOSFET is to be in saturation, we can write

$$
I_{D}=\frac{1}{2} k_{p}^{\prime} \frac{W}{L}\left|V_{O V}\right|^{2}
$$

Substituting $I_{D}=0.5 \mathrm{~mA}$ and $k_{p}^{\prime} W / L=1 \mathrm{~mA} / \mathrm{V}^{2}$, we obtain

$$
\left|V_{O V}\right|=1 \mathrm{~V}
$$

and

$$
V_{S G}=\left|V_{s p}\right|+\left|V_{O V}\right|=1+1=2 \mathrm{~V}
$$

Since the source is at +5 V , the gate voltage must be set to +3 V . This can be achieved by the appropriate selection of the values of $R_{G 1}$ and $R_{G 2}$. A possible selection is $R_{G 1}=2 \mathrm{M} \Omega$ and $R_{G 2}=3 \mathrm{M} \Omega$.

The value of $R_{D}$ can be found from

$$
R_{D}=\frac{V_{D}}{I_{D}}=\frac{3}{0.5}=6 \mathrm{k} \Omega
$$

Saturation-mode operation will be maintained up to the point that $V_{D}$ exceeds $V_{G}$ by $\left|V_{s p}\right|$; that is, until

$$
V_{D_{\max }}=3+1=4 \mathrm{~V}
$$

This value of drain voltage is obtained with $R_{D}$ given by

$$
R_{D}=\frac{4}{0.5}=8 \mathrm{k} \Omega
$$
# EXERCISE 

D5.14 For the circuit in Fig. E5.14, find the value of $R$ that results in the PMOS transistor operating with an overdrive voltage $\left|V_{O V}\right|=0.6 \mathrm{~V}$. The threshold voltage is $V_{t p}=-0.4 \mathrm{~V}$, the process transconductance parameter $k_{p}^{\prime}=0.1 \mathrm{~mA} / \mathrm{V}^{2}$, and $W / L=10 \mu \mathrm{~m} / 0.18 \mu \mathrm{~m}$.
Ans. $800 \Omega$


Figure E5.14

## Example 5.8

The NMOS and PMOS transistors in the circuit of Fig. 5.26(a) are matched, with $k_{n}^{\prime}\left(W_{n} / L_{n}\right)=$ $k_{p}^{\prime}\left(W_{p} / L_{p}\right)=1 \mathrm{~mA} / \mathrm{V}^{2}$ and $V_{t n}=-V_{t p}=1 \mathrm{~V}$. Assuming $\lambda=0$ for both devices, find the drain currents $i_{D N}$ and $i_{D P}$, as well as the voltage $v_{O}$, for $v_{I}=0 \mathrm{~V},+2.5 \mathrm{~V}$, and -2.5 V .


Figure 5.26 Circuits for Example 5.8.
# Example 5.8 continued 



Figure 5.26 continued

## Solution

Figure 5.26(b) shows the circuit for the case $v_{I}=0 \mathrm{~V}$. We note that since $Q_{N}$ and $Q_{P}$ are perfectly matched and are operating at equal values of $\left|V_{G S}\right|=2.5 \mathrm{~V}$, the circuit is symmetrical, which dictates that $v_{O}=0 \mathrm{~V}$. Thus both $Q_{N}$ and $Q_{P}$ are operating with $\left|V_{D G}\right|=0$ and, hence, in saturation. The drain currents can now be found from

$$
I_{D P}=I_{D N}=\frac{1}{2} \times 1 \times(2.5-1)^{2}=1.125 \mathrm{~mA}
$$

Next, we consider the circuit with $v_{I}=+2.5 \mathrm{~V}$. Transistor $Q_{P}$ will have a $V_{S G}$ of zero and thus will be cut off, reducing the circuit to that shown in Fig. 5.26(c). We note that $v_{O}$ will be negative, and thus $v_{G D}$ will be greater than $V_{s s}$, causing $Q_{N}$ to operate in the triode region. For simplicity we shall assume that $v_{D S}$ is small and thus use

$$
\begin{aligned}
I_{D N} & \simeq k_{a}^{\prime}\left(W_{a} / L_{a}\right)\left(V_{G S}-V_{s s}\right) V_{D S} \\
& =1[2.5-(-2.5)-1]\left[v_{O}-(-2.5)\right]
\end{aligned}
$$

From the circuit diagram shown in Fig. 5.26(c), we can also write

$$
I_{D N}(\mathrm{~mA})=\frac{0-v_{O}}{10(\mathrm{k} \Omega)}
$$
These two equations can be solved simultaneously to yield

$$
I_{D N}=0.244 \mathrm{~mA} \quad v_{O}=-2.44 \mathrm{~V}
$$

Note that $V_{D S}=-2.44-(-2.5)=0.06 \mathrm{~V}$, which is small as assumed.
Finally, the situation for the case $v_{I}=-2.5 \mathrm{~V}$ [Fig. 5.26(d)] will be the exact complement of the case $v_{I}=+2.5 \mathrm{~V}$ : Transistor $Q_{N}$ will be off. Thus $I_{D N}=0, Q_{P}$ will be operating in the triode region with $I_{D P}=0.244 \mathrm{~mA}$ and $v_{O}=+2.44 \mathrm{~V}$.

# EXERCISE 

5.15 The NMOS and PMOS transistors in the circuit of Fig. E5.15 are matched with $k_{N}^{\prime}\left(W_{n} / L_{n}\right)=$ $k_{p}^{\prime}\left(W_{p} / L_{p}\right)=1 \mathrm{~mA} / \mathrm{V}^{2}$ and $V_{t n}=-V_{t p}=1 \mathrm{~V}$. Assuming $\lambda=0$ for both devices, find the drain currents $i_{D N}$ and $i_{D P}$ and the voltage $v_{O}$ for $v_{I}=0 \mathrm{~V},+2.5 \mathrm{~V}$, and -2.5 V .
Ans. $v_{I}=0 \mathrm{~V}: 0 \mathrm{~mA}, 0 \mathrm{~mA}, 0 \mathrm{~V} ; v_{I}=+2.5 \mathrm{~V}: 0.104 \mathrm{~mA}, 0 \mathrm{~mA}, 1.04 \mathrm{~V} ; v_{I}=-2.5 \mathrm{~V}: 0 \mathrm{~mA}$, $0.104 \mathrm{~mA},-1.04 \mathrm{~V}$


Figure E5. 15

Concluding Remark If a MOSFET is conducting but its mode of operation (saturation or triode) is not known, we assume operation in the saturation region, solve the problem, and check whether the conditions for saturation-mode operation are satisfied. If not, then the MOSFET is operating in the triode region and the analysis is done accordingly.
## GORDON MOOREHIS LAW:

A half-century ago, Gordon Moore, who would go on to become a cofounder first of Fairchild Semiconductor and then of Intel, presented a startling idea in the issue of Electronics Magazine dated April 19, 1965. Moore, who had a doctorate in chemistry, had projected the potential growth of the integrated-circuit industry based on five points spanning a seven-year period from 1958 to 1965. The conclusion he reached-that the number of transistors per chip had been increasing and would continue to increase by a factor of 2 every two years or so-was destined to propel progress in integrated circuits over the succeeding decades into the twenty-first century. Doubling of the number of transistors was predicted on the basis of another prediction: the continuing shrinkage of transistor dimensions. In early recognition of the importance of this prediction, Carver Mead, a pioneer in very large scale integration (VLSI), soon began to refer to this prediction as "Moore's law." (See Chapter 15, Section 15.1, for the implications of Moore's law).

# 5.4 The Body Effect and Other Topics 

In this section we briefly consider a number of important though secondary issues.

### 5.4.1 The Role of the Substrate-The Body Effect

In many applications the source terminal is connected to the substrate (or body) terminal B, which results in the $p n$ junction between the substrate and the induced channel (review Fig. 5.5) having a constant zero (cutoff) bias. In such a case the substrate does not play any role in circuit operation and its existence can be ignored altogether.

In integrated circuits, however, the substrate is usually common to many MOS transistors. In order to maintain the cutoff condition for all the substrate-to-channel junctions, the substrate is usually connected to the most negative power supply in an NMOS circuit (the most positive in a PMOS circuit). The resulting reverse-bias voltage between source and body ( $V_{S B}$ in an $n$-channel device) will have an effect on device operation. To appreciate this fact, consider an NMOS transistor and let its substrate be made negative relative to the source. The reverse-bias voltage will widen the depletion region (refer to Fig. 5.2). This in turn reduces the channel depth. To return the channel to its former state, $v_{G S}$ has to be increased.

The effect of $V_{S B}$ on the channel can be most conveniently represented as a change in the threshold voltage $V_{t}$. Specifically, it has been shown that increasing the reverse substrate bias voltage $V_{S B}$ results in an increase in $V_{t}$ according to the relationship

$$
V_{t}=V_{t 0}+\gamma\left[\sqrt{2 \phi_{f}+V_{S B}}-\sqrt{2 \phi_{f}}\right]
$$

where $V_{t 0}$ is the threshold voltage for $V_{S B}=0 ; \phi_{f}$ is a physical parameter with $\left(2 \phi_{f}\right)$ typically $0.6 \mathrm{~V} ; \gamma$ is a fabrication-process parameter given by

$$
\gamma=\frac{\sqrt{2 q N_{A} \epsilon_{s}}}{C_{o x}}
$$

where $q$ is the magnitude of the electron charge $\left(1.6 \times 10^{-19} \mathrm{C}\right), N_{A}$ is the doping concentration of the $p$-type substrate, and $\epsilon_{s}$ is the permittivity of silicon $\left(11.7 \epsilon_{0}=11.7 \times 8.854 \times 10^{-14}=\right.$ $\left.1.04 \times 10^{-12} \mathrm{~F} / \mathrm{cm}\right)$. The parameter $\gamma$ has the dimension of $\sqrt{\mathrm{V}}$ and is typically $0.4 \mathrm{~V}^{1 / 2}$. Finally, note that Eq. (5.30) applies equally well for $p$-channel devices with $V_{S B}$ replaced by
the reverse bias of the substrate, $V_{B S}$ (or, alternatively, replace $V_{S B}$ by $\left|V_{S B}\right|$ ) and note that $\gamma$ is negative. Also, in evaluating $\gamma, N_{A}$ must be replaced with $N_{D}$, the doping concentration of the $n$ well in which the PMOS is formed. For $p$-channel devices, $2 \phi_{f}$ is typically 0.75 V , and $\gamma$ is typically $-0.5 \mathrm{~V}^{1 / 2}$.

# EXERCISE 

5.16 An NMOS transistor has $V_{t 0}=0.8 \mathrm{~V}, 2 \phi_{f}=0.7 \mathrm{~V}$, and $\gamma=0.4 \mathrm{~V}^{1 / 2}$. Find $V_{i}$ when $V_{S B}=3 \mathrm{~V}$. Ans. 1.23 V

Equation (5.30) indicates that an incremental change in $V_{S B}$ gives rise to an incremental change in $V_{i}$, which in turn results in an incremental change in $i_{D}$ even though $v_{G S}$ might have been kept constant. It follows that the body voltage controls $i_{D}$; thus the body acts as another gate for the MOSFET, a phenomenon known as the body effect. Here we note that the parameter $\gamma$ is known as the body-effect parameter.

### 5.4.2 Temperature Effects

Both $V_{i}$ and $k^{\prime}$ are temperature sensitive. The magnitude of $V_{i}$ decreases by about 2 mV for every $1^{\circ} \mathrm{C}$ rise in temperature. This decrease in $\left|V_{i}\right|$ gives rise to a corresponding increase in drain current as temperature is increased. However, because $k^{\prime}$ decreases with temperature and its effect is a dominant one, the overall observed effect of a temperature increase is a decrease in drain current. This very interesting result is put to use in applying the MOSFET in power circuits (Chapter 12).

### 5.4.3 Breakdown and Input Protection

As the voltage on the drain is increased, a value is reached at which the $p n$ junction between the drain region and substrate suffers avalanche breakdown (see Section 3.5.3). This breakdown usually occurs at voltages of 20 V to 150 V and results in a somewhat rapid increase in current (known as a weak avalanche).

Another breakdown effect that occurs at lower voltages (about 20 V ) in modern devices is called punch-through. It occurs in devices with relatively short channels when the drain voltage is increased to the point that the depletion region surrounding the drain region extends through the channel to the source. The drain current then increases rapidly. Normally, punch-through does not result in permanent damage to the device.

Yet another kind of breakdown occurs when the gate-to-source voltage exceeds about 30 V . This is the breakdown of the gate oxide and results in permanent damage to the device. Although 30 V may seem high, it must be remembered that the MOSFET has a very high input resistance and a very small input capacitance, and thus small amounts of static charge accumulating on the gate capacitor can cause its breakdown voltage to be exceeded.

To prevent the accumulation of static charge on the gate capacitor of a MOSFET, gate-protection devices are usually included at the input terminals of MOS integrated circuits. The protection mechanism invariably makes use of clamping diodes.
# 5.4.4 Velocity Saturation 

At high longitudinal electric fields, the drift velocity of charge carriers in the channel reaches an upper limit (approximately $10^{7} \mathrm{~cm} / \mathrm{s}$ for electrons and holes in silicon). This effect, which in modern very-short-channel devices can occur for $v_{D S}$ lower than 1 V , is called velocity saturation. It can be shown that when velocity saturation occurs, the current $i_{D}$ will no longer be related to $v_{G S}$ by the square-law relationship. Rather, $i_{D}$ becomes linearly dependent on $v_{G S}$ and the transconductance $g_{m}$ becomes constant and independent of $v_{G S}$. In Chapter 15, we shall consider velocity saturation in our study of deep-submicron (i.e., $L<0.25 \mu \mathrm{~m}$ ) CMOS digital circuits.

### 5.4.5 The Depletion-Type MOSFET

We conclude this section with a brief discussion of another type of MOSFET, the depletion-type MOSFET. Its structure is similar to that of the enhancement-type MOSFET with one important difference: The depletion MOSFET has a physically implanted channel. Thus an $n$-channel depletion-type MOSFET has an $n$-type silicon region connecting the $n^{+}$ source and the $n^{+}$drain regions at the top of the $p$-type substrate. Thus if a voltage $v_{D S}$ is applied between drain and source, a current $i_{D}$ flows for $v_{G S}=0$. In other words, there is no need to induce a channel, unlike the case of the enhancement MOSFET.

The channel depth and hence its conductivity can be controlled by $v_{G S}$ in exactly the same manner as in the enhancement-type device. Applying a positive $v_{G S}$ enhances the channel by attracting more electrons into it. Here, however, we also can apply a negative $v_{G S}$, which causes electrons to be repelled from the channel, and thus the channel becomes shallower and its conductivity decreases. The negative $v_{G S}$ is said to deplete the channel of its charge carriers,


Figure 5.27 The circuit symbol (a) and the $i_{D} \sim_{G S}$ characteristic in saturation (b) for an $n$-channel depletion-type MOSFET.
and this mode of operation (negative $v_{G S}$ ) is called depletion mode. As the magnitude of $v_{G S}$ is increased in the negative direction, a value is reached at which the channel is completely depleted of charge carriers and $i_{D}$ is reduced to zero even though $v_{D S}$ may be still applied. This negative value of $v_{G S}$ is the threshold voltage of the $n$-channel depletion-type MOSFET.

The description above suggests (correctly) that a depletion-type MOSFET can be operated in the enhancement mode by applying a positive $v_{G S}$ and in the depletion mode by applying a negative $v_{G S}$. This is illustrated in Fig. 5.27, which shows both the circuit symbol for the depletion NMOS transistor (Fig. 5.27a) and its $i_{D}-v_{G S}$ characteristic. Observe that here the threshold voltage $V_{m}$ is negative. The $i_{D}-v_{D S}$ characteristics (not shown) are similar to those for the enhancement-type MOSFET except for the negative $V_{m}$. Finally, note that the device symbol denotes the existing channel via the shaded area next to the vertical line.

Depletion-type MOSFETs can be fabricated on the same IC chip as enhancement-type devices, resulting in circuits with improved characteristics, as will be shown in a later chapter. The depletion-type MOSFET, however, is a specialty device and is not commonly used.

# EXERCISE 

5.17 For a depletion-type NMOS transistor with $V_{i}=-2 \mathrm{~V}$ and $k_{b}^{\prime}(W / L)=2 \mathrm{~mA} / \mathrm{V}^{2}$, find the minimum $v_{D S}$ required to operate in the saturation region when $v_{G S}=+1 \mathrm{~V}$. What is the corresponding value of $i_{D}$ ?
Ans. $3 \mathrm{~V} ; 9 \mathrm{~mA}$

## Summary

- The enhancement-type MOSFET is currently the most widely used semiconductor device. It is the basis of CMOS technology, which is the most popular IC fabrication technology at this time. CMOS provides both $n$-channel (NMOS) and $p$-channel (PMOS) transistors, which increases design flexibility. The minimum MOSFET channel length achievable with a given CMOS process is used to characterize the process. This figure has been continually reduced and is currently 32 nm .
- The overdrive voltage, $\left|v_{O V}\right| \equiv\left|v_{G S}\right|-\left|V_{i}\right|$, is the key quantity that governs the operation of the MOSFET. For the MOSFET to operate in the saturation region, which is the region for amplifier application, $\left|v_{D S}\right| \geq\left|v_{O V}\right|$, and the resulting $i_{D}=\frac{1}{2} \mu_{n} C_{o v}(W / L) v_{O V}^{2}$ (for NMOS; replace $\mu_{n}$ with $\mu_{p}$ for PMOS). If $\left|v_{D S}\right|<\left|v_{O V}\right|$, the MOSFET operates in the triode region, which together with cutoff is used for operating the MOSFET as a switch.
- Tables 5.1 and 5.2 provide summaries of the conditions and relationships that describe the operation of NMOS and PMOS transistors, respectively.
- In saturation, $i_{D}$ shows some linear dependence on $v_{D S}$ as a result of the change in channel length. This channel-length modulation phenomenon becomes more pronounced as $L$ decreases. It is modeled by ascribing an output resistance $r_{o}=\left|V_{A}\right| / I_{D}$ to the MOSFET model. Here, the Early voltage $\left|V_{A}\right|=\left|V_{A}^{\prime}\right| L$, where $\left|V_{A}^{\prime}\right|$ is a process-dependent parameter.
- In the analysis of dc MOSFET circuits, if a MOSFET is conducting, but its region of operation (saturation or triode) is not known, one assumes saturation-mode operation. Then, one solves the problem and checks to determine whether the assumption was justified. If not, then the transistor is operating in the triode region, and the analysis is done accordingly.
- The depletion-type MOSFET has an implanted channel and thus can be operated in either the depletion or enhancement mode. It is characterized by the same equations used for the enhancement device except for having a negative $V_{m}$ (positive $V_{i p}$ for depletion PMOS transistors).## Computer Simulations Problems

5.10 Problems identified by the Multisim/PSpice icon are intended to demonstrate the value of using SPICE simulation to verify hand analysis and design, and to investigate important issues such as allowable signal swing and amplifier nonlinear distortion. Instructions to assist in setting up PSPice and Multisim simulations for all the indicated problems can be found in the corresponding files on the website. Note that if a particular parameter value is not specified in the problem statement, you are to make a reasonable assumption.

## Section 5.1: Device Structure and Physical Operation

5.1 MOS technology is used to fabricate a capacitor, utilizing the gate metallization and the substrate as the capacitor electrodes. Find the area required per 1-pF capacitance for oxide thickness ranging from 2 nm to 10 nm . For a square plate capacitor of 10 pF , what dimensions are needed?
5.2 Calculate the total charge stored in the channel of an NMOS transistor having $C_{o s}=9 \mathrm{fF} / \mu \mathrm{m}^{2}, L=0.36 \mu \mathrm{~m}$, and $W=3.6 \mu \mathrm{~m}$, and operated at $V_{O V}=0.2 \mathrm{~V}$ and $V_{D S}=0 \mathrm{~V}$.
5.3 Use dimensional analysis to show that the units of the process transconductance parameter $k_{n}^{\prime}$ are $\mathrm{A} / \mathrm{V}^{2}$. What are the dimensions of the MOSFET transconductance parameter $k_{n}$ ?
5.4 An NMOS transistor that is operated with a small $v_{D S}$ is found to exhibit a resistance $r_{D S}$. By what factor will $r_{D S}$ change in each of the following situations?
(a) $V_{O V}$ is doubled.
(b) The device is replaced with another fabricated in the same technology but with double the width.
(c) The device is replaced with another fabricated in the same technology but with both the width and length doubled.
(d) The device is replaced with another fabricated in a more advanced technology for which the oxide thickness is halved and similarly for $W$ and $L$ (assume $\mu_{w}$ remains unchanged).

D 5.5 An NMOS transistor fabricated in a technology for which $k_{n}^{\prime}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{i}=0.5 \mathrm{~V}$ is required to operate with a small $v_{D S}$ as a variable resistor ranging in value from $250 \Omega$ to $1 \mathrm{k} \Omega$. Specify the range required for the control voltage $V_{G S}$ and the required transistor width $W$. It is required to use the smallest possible device, as limited by the minimum channel length of this technology ( $L_{\min }=0.18 \mu \mathrm{~m}$ ) and the maximum allowed voltage of 1.8 V .
5.6 Sketch a set of $i_{D}-v_{D S}$ characteristic curves for an NMOS transistor operating with a small $v_{D S}$ (in the manner shown in Fig. 5.4). Let the MOSFET have $k_{n}=5 \mathrm{~mA} / \mathrm{V}^{2}$ and $V_{o s}=$ 0.5 V . Sketch and clearly label the graphs for $V_{G S}=0.5,1.0$, $1.5,2.0$, and 2.5 V . Let $V_{D S}$ be in the range 0 to 50 mV . Give the value of $r_{D S}$ obtained for each of the five values of $V_{G S}$. Although only a sketch, your diagram should be drawn to scale as much as possible.

D 5.7 An $n$-channel MOS device in a technology for which oxide thickness is 4 nm , minimum channel length is $0.18 \mu \mathrm{~m}$, $k_{n}^{\prime}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $V_{i}=0.5 \mathrm{~V}$ operates in the triode region, with small $v_{D S}$ and with the gate-source voltage in the range 0 V to +1.8 V . What device width is needed to ensure that the minimum available resistance is $1 \mathrm{k} \Omega$ ?
5.8 Consider an NMOS transistor operating in the triode region with an overdrive voltage $V_{O V}$. Find an expression for the incremental resistance

$$
r_{d s} \equiv 1 /\left.\frac{\partial i_{D}}{\partial v_{D S}}\right|_{v_{D S}=v_{D S}}
$$
Give the values of $r_{d s}$ in terms of $k_{n}$ and $V_{O V}$ for $V_{D S}=0$, $0.2 V_{O V}, 0.5 V_{O V}, 0.8 V_{O V}$, and $V_{O V}$.
5.9 An NMOS transistor with $k_{n}=4 \mathrm{~mA} / \mathrm{V}^{2}$ and $V_{s}=0.5 \mathrm{~V}$ is operated with $V_{G S}=1.0 \mathrm{~V}$. At what value of $V_{D S}$ does the transistor enter the saturation region? What value of $I_{D}$ is obtained in saturation?
5.10 Consider a CMOS process for which $L_{\min }=0.25 \mu \mathrm{~m}$, $t_{o s}=6 \mathrm{~nm}, \mu_{n}=460 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$, and $V_{s}=0.5 \mathrm{~V}$.
(a) Find $C_{o s}$ and $k_{n}^{\prime}$.
(b) For an NMOS transistor with $W / L=20 \mu \mathrm{~m} / 0.25 \mu \mathrm{~m}$, calculate the values of $V_{O V}, V_{G S}$, and $V_{D S \text { min }}$ needed to operate the transistor in the saturation region with a dc current $I_{D}=0.5 \mathrm{~mA}$.
(c) For the device in (b), find the values of $V_{O V}$ and $V_{G S}$ required to cause the device to operate as a $100-\Omega$ resistor for very small $v_{D S}$.
5.11 A $p$-channel MOSFET with a threshold voltage $V_{t p}=$ -0.7 V has its source connected to ground.
(a) What should the gate voltage be for the device to operate with an overdrive voltage of $\left|V_{O V}\right|=0.4 \mathrm{~V}$ ?
(b) With the gate voltage as in (a), what is the highest voltage allowed at the drain while the device operates in the saturation region?
(c) If the drain current obtained in (b) is 0.5 mA , what would the current be for $V_{D}=-20 \mathrm{mV}$ and for $V_{D}=-2 \mathrm{~V}$ ?
5.12 With the knowledge that $\mu_{p}=0.4 \mu_{n}$, what must be the relative width of $n$-channel and $p$-channel devices having equal channel lengths if they are to have equal drain currents when operated in the saturation mode with overdrive voltages of the same magnitude?
5.13 An $n$-channel device has $k_{n}^{\prime}=100 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{s}=0.7 \mathrm{~V}$, and $W / L=20$. The device is to operate as a switch for small $v_{D S}$, utilizing a control voltage $v_{G S}$ in the range 0 V to 5 V . Find the switch closure resistance, $r_{D S}$, and closure
voltage, $V_{D S}$, obtained when $v_{G S}=5 \mathrm{~V}$ and $i_{D}=1 \mathrm{~mA}$. If $\mu_{p} \simeq 0.4 \mu_{n}$, what must $W / L$ be for a $p$-channel device that provides the same performance as the $n$-channel device in this application?
5.14 Consider an $n$-channel MOSFET with $t_{o s}=6 \mathrm{~nm}, \mu_{n}=$ $460 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}, V_{s}=0.5 \mathrm{~V}$, and $W / L=10$. Find the drain current in the following cases:
(a) $v_{G S}=2.5 \mathrm{~V}$ and $v_{D S}=1 \mathrm{~V}$
(b) $v_{G S}=2 \mathrm{~V}$ and $v_{D S}=1.5 \mathrm{~V}$
(c) $v_{G S}=2.5 \mathrm{~V}$ and $v_{D S}=0.2 \mathrm{~V}$
(d) $v_{G S}=v_{D S}=2.5 \mathrm{~V}$
*5.15 This problem illustrates the central point in the electronics revolution that has been in effect for the past four decades: By continually reducing the MOSFET size, we are able to pack more devices on an IC chip. Gordon Moore, co-founder of Intel Corporation, predicted this exponential growth of chip-packing density very early in the history of the development of the integrated circuit in the formulation that has become known as Moore's law.

The table on the next page shows four technology generations, each characterized by the minimum possible MOSFET channel length (row 1). In going from one generation to another, both $L$ and $t_{o s}$ are scaled by the same factor. The power supply utilized $V_{D D}$ is also scaled by the same factor, to keep the magnitudes of all electrical fields within the device unchanged. Unfortunately, but for good reasons, $V_{s}$ cannot be scaled similarly.

Complete the table entries, noting that row 5 asks for the transconductance parameter of an NMOS transistor with $W / L=10$; row 9 asks for the value of $I_{D}$ obtained with $V_{G S}=V_{D S}=V_{D D}$; row 10 asks for the power $P=V_{D D} I_{D}$ dissipated in the circuit. An important quantity is the power density, $P / A$, asked for in row 11. Finally, you are asked to find the number of transistors that can be placed on an IC chip fabricated in each of the technologies in terms of the number obtained with the $0.5-\mu \mathrm{m}$ technology $(n)$.
| 1 | $L(\mu \mathrm{~m})$ | 0.5 | 0.25 | 0.18 | 0.13 |
| :-- | :-- | :--: | :--: | :--: | :--: |
| 2 | $t_{\text {os }}(\mathrm{nm})$ | 10 |  |  |  |
| 3 | $C_{\text {os }}\left(\mathrm{fF} / \mu \mathrm{m}^{2}\right)$ |  |  |  |  |
| 4 | $k_{n}^{\prime}\left(\mu \mathrm{A} / \mathrm{V}^{2}\right)$ <br> $\left(\mu_{n}=500 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}\right)$ |  |  |  |  |
| 5 | $k_{n}\left(\mathrm{~mA} / \mathrm{V}^{2}\right)$ <br> For $W / L=10$ |  |  |  |  |
| 6 | Device area, $A\left(\mu \mathrm{~m}^{2}\right)$ |  |  |  |  |
| 7 | $V_{D D}(\mathrm{~V})$ | 5 |  |  |  |
| 8 | $V_{s}(\mathrm{~V})$ | 0.7 | 0.5 | 0.4 | 0.4 |
| 9 | $I_{D}(\mathrm{~mA})$ <br> For $V_{G S}=V_{D S}=V_{D D}$ |  |  |  |  |
| 10 | $P(\mathrm{~mW})$ |  |  |  |  |
| 11 | $P / A\left(\mathrm{~mW} / \mu \mathrm{m}^{2}\right)$ |  |  |  |  |
| 12 | Devices per chip | $n$ |  |  |  |

## Section 5.2: Current-Voltage Characteristics

In the following problems, when $\lambda$ is not specified, assume it is zero.
5.16 Show that when channel-length modulation is neglected (i.e., $\lambda=0$ ), plotting $i_{D} / k_{n}$ versus $v_{D S}$ for various values of $v_{O V}$, and plotting $i_{D} / k_{n}$ versus $v_{O V}$ for $v_{D S} \geq v_{O V}$, results in universal representation of the $i_{D}-v_{D S}$ and $i_{D}-v_{G S}$ characteristics of the NMOS transistor. That is, the resulting graphs are both technology and device independent. Furthermore, these graphs apply equally well to the PMOS transistor by a simple relabeling of variables. (How?) What is the slope at $v_{D S}=0$
of each of the $i_{D} / k_{n}$ versus $v_{D S}$ graphs? For the $i_{D} / k_{n}$ versus $v_{O V}$ graph, find the slope at a point $v_{O V}=V_{O V}$.
5.17 An NMOS transistor having $V_{s}=0.8 \mathrm{~V}$ is operated in the triode region with $v_{D S}$ small. With $V_{G S}=1.2 \mathrm{~V}$, it is found to have a resistance $r_{D S}$ of $1 \mathrm{k} \Omega$. What value of $V_{G S}$ is required to obtain $r_{D S}=200 \Omega$ ? Find the corresponding resistance values obtained with a device having twice the value of $W$.
5.18 A particular MOSFET for which $V_{m}=0.5 \mathrm{~V}$ and $k_{n}^{\prime}(W / L)=1.6 \mathrm{~mA} / \mathrm{V}^{2}$ is to be operated in the saturation region. If $i_{D}$ is to be $50 \mu \mathrm{~A}$, find the required $v_{G S}$ and the minimum required $v_{D S}$. Repeat for $i_{D}=200 \mu \mathrm{~A}$.
5.19 A particular $n$-channel MOSFET is measured to have a drain current of 0.4 mA at $V_{G S}=V_{D S}=1 \mathrm{~V}$ and of 0.1 mA at $V_{G S}=V_{D S}=0.8 \mathrm{~V}$. What are the values of $k_{n}$ and $V_{i}$ for this device?

D 5.20 For a particular IC-fabrication process, the transconductance parameter $k_{n}^{\prime}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $V_{i}=0.5 \mathrm{~V}$. In an application in which $v_{G S}=v_{D S}=V_{\text {supply }}=1.8 \mathrm{~V}$, a drain current of 2 mA is required of a device of minimum length of $0.18 \mu \mathrm{~m}$. What value of channel width must the design use?
5.21 An NMOS transistor, operating in the linear-resistance region with $v_{D S}=50 \mathrm{mV}$, is found to conduct $25 \mu \mathrm{~A}$ for $v_{G S}=1 \mathrm{~V}$ and $50 \mu \mathrm{~A}$ for $v_{G S}=1.5 \mathrm{~V}$. What is the apparent value of threshold voltage $V_{i}$ ? If $k_{n}^{\prime}=50 \mu \mathrm{~A} / \mathrm{V}^{2}$, what is the device $W / L$ ratio? What current would you expect to flow with $v_{G S}=2 \mathrm{~V}$ and $v_{D S}=0.1 \mathrm{~V}$ ? If the device is operated at $v_{G S}=2 \mathrm{~V}$, at what value of $v_{D S}$ will the drain end of the MOSFET channel just reach pinch-off, and what is the corresponding drain current?
5.22 For an NMOS transistor, for which $V_{i}=0.4 \mathrm{~V}$, operating with $v_{G S}$ in the range of 1.0 V to 1.8 V , what is the largest value of $v_{D S}$ for which the channel remains continuous?
5.23 An NMOS transistor, fabricated with $W=20 \mu \mathrm{~m}$ and $L=1 \mu \mathrm{~m}$ in a technology for which $k_{n}^{\prime}=100 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{i}=$ 0.8 V , is to be operated at very low values of $v_{D S}$ as a linear resistor. For $v_{G S}$ varying from 1.0 V to 4.8 V , what range of resistor values can be obtained? What is the available range if
(a) the device width is halved?
(b) the device length is halved?
(c) both the width and length are halved?
5.24 When the drain and gate of a MOSFET are connected together, a two-terminal device known as a "diode-connected transistor" results. Figure P5.24 shows such devices obtained from MOS transistors of both polarities. Show that
(a) the $i-v$ relationship is given by

$$
i=\frac{1}{2} k^{\prime} \frac{W}{L}\left(v-\left|V_{i}\right|\right)^{2}
$$

(b) the incremental resistance $r$ for a device biased to operate at $v=\left|V_{i}\right|+V_{O V}$ is given by

$$
r \equiv 1 /\left[\frac{\partial i}{\partial v}\right]=1 /\left(k^{\prime} \frac{W}{L} V_{O V}\right)
$$



Figure P5.24
5.25 For the circuit in Fig. P5.25, sketch $i_{D}$ versus $v_{S}$ for $v_{S}$ varying from 0 to $V_{D D}$. Clearly label your sketch.


Figure P5.25
5.26 For the circuit in Fig. P5.26, find an expression for $v_{D S}$ in terms of $i_{D}$. Sketch and clearly label a graph for $v_{D S}$ versus $i_{D}$.


Figure P5.26

[^0]
[^0]:    $S I M=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
| Case | Voltage (V) |  |  |  |  |  | Region of operation |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
|  | $V_{s}$ | $V_{G}$ | $V_{D}$ | $V_{G S}$ | $V_{D V}$ | $V_{D S}$ |  |
| a | $+1.0$ | $+1.0$ | $+2.0$ |  |  |  |  |
| b | $+1.0$ | $+2.5$ | $+2.0$ |  |  |  |  |
| c | $+1.0$ | $+2.5$ | $+1.5$ |  |  |  |  |
| d | $+1.0$ | $+1.5$ | 0 |  |  |  |  |
| e | 0 | $+2.5$ | $+1.0$ |  |  |  |  |
| f | $+1.0$ | $+1.0$ | $+1.0$ |  |  |  |  |
| g | $-1.0$ | 0 | 0 |  |  |  |  |
| h | $-1.5$ | 0 | 0 |  |  |  |  |
| i | $-1.0$ | 0 | $+1.0$ |  |  |  |  |
| j | $+0.5$ | $+2.0$ | $+0.5$ |  |  |  |  |

*5.27 The table above lists 10 different cases labeled (a) to (j) for operating an NMOS transistor with $V_{i}=1 \mathrm{~V}$. In each case the voltages at the source, gate, and drain (relative to the circuit ground) are specified. You are required to complete the table entries. Note that if you encounter a case for which $v_{D S}$ is negative, you should exchange the drain and source before solving the problem. You can do this because the MOSFET is a symmetric device.
5.28 The NMOS transistor in Fig. P5.28 has $V_{i}=0.4 \mathrm{~V}$ and $k_{b}^{\prime}(W / L)=1 \mathrm{~mA} / \mathrm{V}^{2}$. Sketch and clearly label $i_{D}$ versus $v_{G}$ with $v_{G}$ varying in the range 0 to +1.8 V . Give equations for the various portions of the resulting graph.


Figure P5.28
5.29 Figure P5.29 shows two NMOS transistors operating in saturation at equal $V_{G S}$ and $V_{D S}$.
(a) If the two devices are matched except for a maximum possible mismatch in their $W / L$ ratios of $3 \%$, what is the maximum resulting mismatch in the drain currents?
(b) If the two devices are matched except for a maximum possible mismatch in their $V_{i}$ values of 10 mV , what is the maximum resulting mismatch in the drain currents? Assume that the nominal value of $V_{i}$ is 0.6 V .


Figure P5.29

[^0]
[^0]:    ${ }^{\text {S10 }}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
5.30 For a particular MOSFET operating in the saturation region at a constant $v_{G S}, i_{D}$ is found to be 0.5 mA for $v_{D S}=1 \mathrm{~V}$ and 0.52 mA for $v_{D S}=2 \mathrm{~V}$. What values of $r_{o}, V_{A}$, and $\lambda$ correspond?
5.31 A particular MOSFET has $V_{A}=20 \mathrm{~V}$. For operation at 0.1 mA and 1 mA , what are the expected output resistances? In each case, for a change in $v_{D S}$ of 1 V , what percentage change in drain current would you expect?

D 5.32 In a particular IC design in which the standard channel length is $1 \mu \mathrm{~m}$, an NMOS device with $W / L$ of 10 operating at $200 \mu \mathrm{~A}$ is found to have an output resistance of $100 \mathrm{k} \Omega$, about $\frac{1}{3}$ of that needed. What dimensional change can be made to solve the problem? What is the new device length? The new device width? The new $W / L$ ratio? What is $V_{A}$ for the standard device in this IC? The new device?

D 5.33 For a particular $n$-channel MOS technology, in which the minimum channel length is $0.5 \mu \mathrm{~m}$, the associated value of $\lambda$ is $0.03 \mathrm{~V}^{-1}$. If a particular device for which $L$ is $1.5 \mu \mathrm{~m}$ operates in saturation at $v_{D S}=1 \mathrm{~V}$ with a drain current of $100 \mu \mathrm{~A}$, what does the drain current become if $v_{D S}$ is raised to 5 V ? What percentage change does this represent? What can be done to reduce the percentage by a factor of 2 ?
5.34 An NMOS transistor is fabricated in a $0.5-\mu \mathrm{m}$ process having $k_{n}^{\prime}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{A}^{\prime}=20 \mathrm{~V} / \mu \mathrm{m}$ of channel length. If $L=1.5 \mu \mathrm{~m}$ and $W=15 \mu \mathrm{~m}$, find $V_{A}$ and $\lambda$. Find the value of $I_{D}$ that results when the device is operated with an overdrive voltage of 0.5 V and $V_{D S}=2 \mathrm{~V}$. Also, find the value of $r_{o}$ at this operating point. If $V_{D S}$ is increased by 1 V , what is the corresponding change in $I_{D}$ ?
5.35 If in an NMOS transistor, both $W$ and $L$ are quadrupled and $V_{D V}$ is halved, by what factor does $r_{o}$ change?

D 5.36 Consider the circuit in Fig. P5.29 with both transistors perfectly matched but with the dc voltage at the drain of $Q_{1}$ lowered to +2 V . If the two drain currents are to be matched within $1 \%$ (i.e., the maximum difference allowed between the two currents is $1 \%$ ), what is the minimum required value of $V_{A}$ ? If the technology is specified to have $V_{A}^{\prime}=100 \mathrm{~V} / \mu \mathrm{m}$, what is the minimum channel length the designer must use?
5.37 Complete the missing entries in the following table, which describes characteristics of suitably biased NMOS transistors:

| MOS | $\mathbf{1}$ | $\mathbf{2}$ | $\mathbf{3}$ | $\mathbf{4}$ |
| :-- | :--: | :--: | :--: | :--: |
| $\lambda\left(\mathrm{V}^{-1}\right)$ |  | 0.02 |  |  |
| $V_{A}(\mathrm{~V})$ | 20 |  |  | 100 |
| $I_{D}(\mathrm{~mA})$ | 0.5 |  | 0.1 |  |
| $r_{o}(\mathrm{k} \Omega)$ |  | 25 | 100 | 500 |

5.38 A PMOS transistor has $k_{p}^{\prime}(W / L)=100 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{s}=$ -1.0 V , and $\lambda=-0.02 \mathrm{~V}^{-1}$. The gate is connected to ground and the source to +5 V . Find the drain current for $v_{D}=+4 \mathrm{~V}$, $+2 \mathrm{~V},+1 \mathrm{~V}, 0 \mathrm{~V}$, and -5 V .
5.39 A $p$-channel transistor for which $\left|V_{s}\right|=0.8 \mathrm{~V}$ and $\left|V_{A}\right|=$ 40 V operates in saturation with $\left|v_{G S}\right|=3 \mathrm{~V},\left|v_{D S}\right|=4 \mathrm{~V}$, and $i_{D}=3 \mathrm{~mA}$. Find corresponding signed values for $v_{G S}, v_{S G}$, $v_{D S}, v_{S D}, V_{s}, V_{A}, \lambda$, and $k_{p}^{\prime}(W / L)$.
5.40 The table below lists the terminal voltages of a PMOS transistor in six cases, labeled a, b, c, d, e, and f. The transistor has $V_{s p}=-1 \mathrm{~V}$. Complete the table entries.

|  | $V_{s}$ | $V_{G}$ | $V_{D}$ | $V_{S G}$ | $\left\|V_{D V}\right\|$ | $V_{s D}$ | Region of operation |
| :-- | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| a | +2 | +2 | 0 |  |  |  |  |
| b | +2 | +1 | 0 |  |  |  |  |
| c | +2 | 0 | 0 |  |  |  |  |
| d | +2 | 0 | +1 |  |  |  |  |
| e | +2 | 0 | +1.5 |  |  |  |  |
| f | +2 | 0 | +2 |  |  |  |  |

[^0]
[^0]:    5.38 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
5.41 The PMOS transistor in Fig. P5.41 has $V_{i p}=-0.5 \mathrm{~V}$. As the gate voltage $v_{G}$ is varied from +3 V to 0 V , the transistor moves through all of its three possible modes of operation. Specify the values of $v_{G}$ at which the device changes modes of operation.


Figure P5.41
*5.42 Various NMOS and PMOS transistors, numbered 1 to 4 , are measured in operation, as shown in the table at the bottom of the page. For each transistor, find the values of $\mu C_{o s} W / L$ and $V_{s}$ that apply and complete the table, with $V$ in volts, $I$ in $\mu \mathrm{A}$, and $\mu C_{o s} W / L$ in $\mu \mathrm{A} / \mathrm{V}^{2}$. Assume $\lambda=0$.
*5.43 All the transistors in the circuits shown in Fig. P5.43 have the same values of $\left|V_{1}\right|, k^{\prime}, W / L$, and $\lambda$. Moreover, $\lambda$ is negligibly small. All operate in saturation at $I_{D}=I$ and $\left|V_{G S}\right|=$ $\left|V_{D S}\right|=1 \mathrm{~V}$. Find the voltages $V_{1}, V_{2}, V_{3}$, and $V_{4}$. If $\left|V_{1}\right|=$ 0.5 V and $I=0.1 \mathrm{~mA}$, how large a resistor can be inserted in series with each drain while maintaining saturation? If the current source $I$ requires at least 0.5 V between its terminals to operate properly, what is the largest resistor that can be placed in series with each MOSFET source while ensuring
saturated-mode operation of each transistor at $I_{D}=I$ ? In the latter limiting situation, what do $V_{1}, V_{2}, V_{3}$, and $V_{4}$ become?

(a)

(c)

(b)

(d)

Figure P5.43

| Case | Transistor | $\boldsymbol{V}_{\boldsymbol{s}}$ | $\boldsymbol{V}_{\boldsymbol{G}}$ | $\boldsymbol{V}_{\boldsymbol{D}}$ | $\boldsymbol{I}_{\boldsymbol{D}}$ | Type | Mode | $\boldsymbol{\mu} \boldsymbol{C}_{\boldsymbol{o} \boldsymbol{s}} \boldsymbol{W} / \boldsymbol{L}$ | $\boldsymbol{V}_{\boldsymbol{t}}$ |
| :-- | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| a | 1 | 0 | 1 | 2.5 | 100 |  |  |  |  |
|  | 1 | 0 | 1.5 | 2.5 | 400 |  |  |  |  |
| b | 2 | 5 | 3 | -4.5 | 50 |  |  |  |  |
|  | 2 | 5 | 2 | -0.5 | 450 |  |  |  |  |
| c | 3 | 5 | 3 | 4 | 200 |  |  |  |  |
|  | 3 | 5 | 2 | 0 | 800 |  |  |  |  |
| d | 4 | -2 | 0 | 0 | 72 |  |  |  |  |
|  | 4 | -4 | 0 | -3 | 270 |  |  |  |  |

[^0]
[^0]:    ${ }^{\text {TIE }}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
## Section 5.3: MOSFET Circuits at DC

Note: If $\lambda$ is not specified, assume it is zero.
D 5.44 Design the circuit of Fig. P5.44 to establish a drain current of 0.1 mA and a drain voltage of +0.3 V . The MOSFET has $V_{t}=0.5 \mathrm{~V}, \mu_{a} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2}, L=0.4 \mu \mathrm{~m}$, and $W=5 \mu \mathrm{~m}$. Specify the required values for $R_{S}$ and $R_{D}$.


Figure P5.44
5.45 The NMOS transistor in the circuit of Fig. P5.44 has $V_{t}=0.4 \mathrm{~V}$ and $k_{n}=4 \mathrm{~mA} / \mathrm{V}^{2}$. The voltages at the source and the drain are measured and found to be -0.6 V and +0.2 V , respectively. What current $I_{D}$ is flowing, and what must the values of $R_{D}$ and $R_{S}$ be? What is the largest value for $R_{D}$ for which $I_{D}$ remains unchanged from the value found?

D 5.46 For the circuit in Fig. E5.10, assume that $Q_{1}$ and $Q_{2}$ are matched except for having different widths, $W_{1}$ and $W_{2}$. Let $V_{t}=0.5 \mathrm{~V}, k_{n}^{\prime}=0.4 \mathrm{~mA} / \mathrm{V}^{2}, L_{1}=L_{2}=0.36 \mu \mathrm{~m}$, $W_{1}=1.44 \mu \mathrm{~m}$, and $\lambda=0$.
(a) Find the value of $R$ required to establish a current of $50 \mu \mathrm{~A}$ in $Q_{1}$.
(b) Find $W_{2}$ and $R_{2}$ so that $Q_{2}$ operates at the edge of saturation with a current of 0.5 mA .
5.47 The transistor in the circuit of Fig. P5.47 has $k_{n}^{\prime}=$ $0.4 \mathrm{~mA} / \mathrm{V}^{2}, V_{t}=0.4 \mathrm{~V}$, and $\lambda=0$. Show that operation at the
edge of saturation is obtained when the following condition is satisfied:

$$
\left(\frac{W}{L}\right) R_{D} \simeq 2.5 \mathrm{k} \Omega
$$



Figure P5.47

D 5.48 It is required to operate the transistor in the circuit of Fig. P5.47 at the edge of saturation with $I_{D}=0.1 \mathrm{~mA}$. If $V_{t}=0.4 \mathrm{~V}$, find the required value of $R_{D}$.

D 5.49 The PMOS transistor in the circuit of Fig. P5.49 has $V_{t}=-0.5 \mathrm{~V}, \mu_{a} C_{o s}=100 \mu \mathrm{~A} / \mathrm{V}^{2}, L=0.18 \mu \mathrm{~m}$, and $\lambda=0$. Find the values required for $W$ and $R$ in order to establish a drain current of $180 \mu \mathrm{~A}$ and a voltage $V_{D}$ of 1 V .


Figure P5.49

D 5.50 The NMOS transistors in the circuit of Fig. P5.50 have $V_{t}=0.5 \mathrm{~V}, \mu_{a} C_{o s}=250 \mu \mathrm{~A} / \mathrm{V}^{2}, \lambda=0$, and $L_{1}=L_{2}=$ $0.25 \mu \mathrm{~m}$. Find the required values of gate width for each of $Q_{1}$

[^0]
[^0]:    5.44 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
and $Q_{2}$, and the value of $R$, to obtain the voltage and current values indicated.


Figure P5.50

D 5.51 The NMOS transistors in the circuit of Fig. P5.51 have $V_{i}=0.5 \mathrm{~V}, \mu_{n} C_{s o}=90 \mu \mathrm{~A} / \mathrm{V}^{2}, \lambda=0$, and $L_{1}=L_{2}=$ $L_{3}=0.5 \mu \mathrm{~m}$. Find the required values of gate width for each of $Q_{1}, Q_{2}$, and $Q_{3}$ to obtain the voltage and current values indicated.


Figure P5.51
5.52 Consider the circuit of Fig. 5.24(a). In Example 5.5 it was found that when $V_{i}=1 \mathrm{~V}$ and $k_{n}^{\prime}(W / L)=1 \mathrm{~mA} / \mathrm{V}^{2}$,
the drain current is 0.5 mA and the drain voltage is +7 V . If the transistor is replaced with another having $V_{i}=1.5 \mathrm{~V}$ with $k_{n}^{\prime}(W / L)=1.5 \mathrm{~mA} / \mathrm{V}^{2}$, find the new values of $I_{D}$ and $V_{D}$. Comment on how tolerant (or intolerant) the circuit is to changes in device parameters.

D 5.53 Using a PMOS transistor with $V_{i}=-1.5 \mathrm{~V}, k_{n}^{\prime}$ $(W / L)=4 \mathrm{~mA} / \mathrm{V}^{2}$, and $\lambda=0$, design a circuit that resembles that in Fig. 5.24(a). Using a $10-\mathrm{V}$ supply, design for a gate voltage of +6 V , a drain current of 0.5 mA , and a drain voltage of +5 V . Find the values of $R_{S}$ and $R_{D}$. Also, find the values of the resistances in the voltage divider feeding the gate, assuming a $1-\mu \mathrm{A}$ current in the divider.
5.54 The MOSFET in Fig. P5.54 has $V_{i}=0.4 \mathrm{~V}, k_{n}^{\prime}=$ $500 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $\lambda=0$. Find the required values of $W / L$ and of $R$ so that when $v_{I}=V_{D D}=+1.3 \mathrm{~V}, r_{D S}=50 \Omega$ and $v_{O}=50 \mathrm{mV}$


Figure P5.54
5.55 In the circuits shown in Fig. P5.55, transistors are characterized by $\left|V_{i}\right|=1 \mathrm{~V}, k^{\prime} W / L=4 \mathrm{~mA} / \mathrm{V}^{2}$, and $\lambda=0$.
(a) Find the labeled voltages $V_{1}$ through $V_{7}$.
(b) In each of the circuits, replace the current source with a resistor. Select the resistor value to yield a current as close to that of the current source as possible, while using resistors specified in the $1 \%$ table provided in Appendix J.


Figure P5.56 continued

[^0]
[^0]:    SIIM $=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; $D=$ design problem
(g)

(h)

Figure P5.56 continued
5.57 For each of the circuits shown in Fig. P5.57, find the labeled node voltages. The NMOS transistors have $V_{i}=0.9 \mathrm{~V}$ and $k_{n}^{\prime}(W / L)=1.5 \mathrm{~mA} / \mathrm{V}^{2}$.


Figure P5.57
*5.58 For the circuit in Fig. P5.58:
(a) Show that for the PMOS transistor to operate in saturation, the following condition must be satisfied:

$$
I R \leq\left|V_{s p}\right|
$$

(b) If the transistor is specified to have $\left|V_{s p}\right|=1 \mathrm{~V}$ and $k_{p}=0.2 \mathrm{~mA} / \mathrm{V}^{2}$, and for $I=0.1 \mathrm{~mA}$, find the voltages $V_{S D}$ and $V_{S G}$ for $R=0,10 \mathrm{k} \Omega, 30 \mathrm{k} \Omega$, and $100 \mathrm{k} \Omega$.


Figure P5.58
5.59 For the circuits in Fig. P5.59, $\mu_{n} C_{o s}=3 \mu_{p} C_{o s}=$ $270 \mu \mathrm{~A} / \mathrm{V}^{2},\left|V_{s}\right|=0.5 \mathrm{~V}, \lambda=0, L=1 \mu \mathrm{~m}$, and $W=3 \mu \mathrm{~m}$, unless otherwise specified. Find the labeled currents and voltages.

(a)

(c)

Figure P5.59
318 *5.60 For the devices in the circuit of Fig. P5.60, $\left|V_{i}\right|=1 \mathrm{~V}, \lambda=0, \mu_{\mathrm{a}} C_{\text {os }}=50 \mu \mathrm{~A} / \mathrm{V}^{2}, L=1 \mu \mathrm{~m}$, and $W=10 \mu \mathrm{~m}$. Find $V_{2}$ and $I_{2}$. How do these values change if $Q_{3}$ and $Q_{4}$ are made to have $W=100 \mu \mathrm{~m}$ ?


Figure P5.60
5.61 In the circuit of Fig. P5.61, transistors $Q_{1}$ and $Q_{2}$ have $V_{i}=0.7 \mathrm{~V}$, and the process transconductance parameter $k_{n}^{\prime}=$ $125 \mu \mathrm{~A} / \mathrm{V}^{2}$. Find $V_{1}, V_{2}$, and $V_{3}$ for each of the following cases:
(a) $(W / L)_{1}=(W / L)_{2}=20$
(b) $(W / L)_{3}=1.5(W / L)_{2}=20$


Figure P5.61

## Section 5.4: The Body Effect and Other Topics

5.62 In a particular application, an $n$-channel MOSFET operates with $V_{S B}$ in the range 0 V to 4 V . If $V_{t 0}$ is nominally 1.0 V , find the range of $V_{i}$ that results if $\gamma=0.5 \mathrm{~V}^{1 / 2}$ and $2 \phi_{2}=0.6 \mathrm{~V}$. If the gate oxide thickness is increased by a factor of 4 , what does the threshold voltage become?
5.63 A $p$-channel transistor operates in saturation with its source voltage 3 V lower than its substrate. For $\gamma=0.5 \mathrm{~V}^{1 / 2}$, $2 \phi_{2}=0.75 \mathrm{~V}$, and $V_{t 0}=-0.7 \mathrm{~V}$, find $V_{i}$.
*5.64 (a) Using the expression for $i_{D}$ in saturation and neglecting the channel-length modulation effect (i.e., let $\lambda=0$ ), derive an expression for the per unit change in $i_{D}$ per ${ }^{\circ} \mathrm{C}\left[\left(\partial i_{D} / i_{D}\right) / \partial T\right]$ in terms of the per unit change in $k_{n}^{\prime}$ per ${ }^{\circ} \mathrm{C}\left[\left(\partial k_{n}^{\prime} / k_{n}^{\prime}\right) / \partial T\right]$, the temperature coefficient of $V_{i}$ in $\mathrm{V} /{ }^{\circ} \mathrm{C}\left(\partial V_{i} / \partial T\right)$, and $V_{G S}$ and $V_{i}$.
(b) If $V_{i}$ decreases by 2 mV for every ${ }^{\circ} \mathrm{C}$ rise in temperature, find the temperature coefficient of $k_{n}^{\prime}$ that results in $i_{D}$ decreasing by $0.2 \% /{ }^{\circ} \mathrm{C}$ when the NMOS transistor with $V_{i}=$ 1 V is operated at $V_{G S}=5 \mathrm{~V}$.
5.65 A depletion-type $n$-channel MOSFET with $k_{n}^{\prime} W / L=$ $2 \mathrm{~mA} / \mathrm{V}^{2}$ and $V_{i}=-3 \mathrm{~V}$ has its source and gate grounded. Find the region of operation and the drain current for $v_{D}=0.1 \mathrm{~V}, 1 \mathrm{~V}, 3 \mathrm{~V}$, and 5 V . Neglect the channel-length-modulation effect.
5.66 For a particular depletion-mode NMOS device, $V_{i}=$ $-2 \mathrm{~V}, k_{n}^{\prime} W / L=200 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $\lambda=0.02 \mathrm{~V}^{-1}$. When operated at $v_{G S}=0$, what is the drain current that flows for $v_{D S}=1 \mathrm{~V}, 2 \mathrm{~V}, 3 \mathrm{~V}$, and 10 V ? What does each of these currents become if the device width is doubled with $L$ the same? With $L$ also doubled?
*5.67 Neglecting the channel-length-modulation effect, show that for the depletion-type NMOS transistor of Fig. P5.67, the $i-v$ relationship is given by

$$
\begin{array}{ll}
i=\frac{1}{2} k_{n}^{\prime}(W / L)\left(v^{2}-2 V_{i} v\right) & \text { for } v \geq V_{i} \\
i=-\frac{1}{2} k_{n}^{\prime}(W / L) V_{i}^{2} & \text { for } v \leq V_{i}
\end{array}
$$

(Recall that $V_{i}$ is negative.) Sketch the $i-v$ relationship for the case: $V_{i}=-2 \mathrm{~V}$ and $k_{n}^{\prime}(W / L)=2 \mathrm{~mA} / \mathrm{V}^{2}$.


Figure P5.67

[^0]
[^0]:    318 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
# CHAPTER 6 

## Bipolar Junction Transistors (BJTs)

Introduction 305
6.1 Device Structure and Physical Operation 306
6.2 Current-Voltage Characteristics 320
6.3 BJT Circuits at DC 333
6.4 Transistor Breakdown and Temperature Effects 351

Summary 354
Problems 355
# IN THIS CHAPTER YOU WILL LEARN 

1. The physical structure of the bipolar transistor and how it works.
2. How the voltage between two terminals of the transistor controls the current that flows through the third terminal, and the equations that describe these current-voltage characteristics.
3. How to analyze and design circuits that contain bipolar transistors, resistors, and dc sources.

## Introduction

In this chapter, we study the other major three-terminal device: the bipolar junction transistor (BJT). The presentation of the material in this chapter parallels but does not rely on that for the MOSFET in Chapter 5; thus, if desired, the BJT can be studied before the MOSFET.

Three-terminal devices are far more useful than two-terminal ones, such as the diodes studied in Chapter 4, because they can be used in a multitude of applications, ranging from signal amplification to the design of digital logic and memory circuits. The basic principle involved is the use of the voltage between two terminals to control the current flowing in the third terminal. In this way, a three-terminal device can be used to realize a controlled source, which as we learned in Chapter 1 is the basis for amplifier design. Also, in the extreme, the control signal can be used to cause the current in the third terminal to change from zero to a large value, thus allowing the device to act as a switch. The switch is the basis for the realization of the logic inverter, the basic element of digital circuits.

The invention of the BJT in 1948 at the Bell Telephone Laboratories ushered in the era of solid-state circuits. The result was not just the replacement of vacuum tubes by transistors in radios and television sets but the eruption of an electronics revolution that led to major changes in the way we work, play, and indeed, live. The invention of the transistor also eventually led to the dominance of information technology and the emergence of the knowledge-based economy.

The bipolar transistor enjoyed nearly three decades as the device of choice in the design of both discrete and integrated circuits. Although the MOSFET had been known very early on, it was not until the 1970s and 1980s that it became a serious competitor to the BJT. By 2014, the MOSFET was undoubtedly the most widely used electronic device, and CMOS technology the technology of choice in the design of integrated circuits. Nevertheless, the BJT remains a significant device that excels in certain applications.

The BJT remains popular in discrete-circuit design, where it is used together with other discrete components such as resistors and capacitors to implement circuits that are assembled
on printed-circuit boards (PCBs). Here we note the availability of a very wide selection of BJT types that fit nearly every conceivable application. As well, the BJT is still the preferred device in some very demanding analog and digital integrated-circuit applications. This is especially true in very-high-frequency and high-speed circuits. In particular, a very-high-speed digital logic-circuit family based on bipolar transistors, namely, emitter-coupled logic, is still in use (Chapter 15). Finally, bipolar transistors can be combined with MOSFETs to create innovative circuits that take advantage of the high-input-impedance and low-power operation of MOSFETs and the very-high-frequency operation and high-current-driving capability of bipolar transistors. The resulting technology is known as BiCMOS, and it is finding increasingly larger areas of application (see Chapters 8, 9, 13, and 15).

In this chapter, we shall start with a description of the physical operation of the BJT. Though simple, this physical description provides considerable insight regarding the performance of the transistor as a circuit element. We then quickly move from describing current flow in terms of electrons and holes to a study of the transistor terminal characteristics. Circuit models for transistor operation in different modes will be developed and utilized in the analysis and design of transistor circuits. The main objective of this chapter is to develop in the reader a high degree of familiarity with the BJT. Thus, it lays the foundation for the use of the BJT in amplifier design (Chapter 7).

# 6.1 Device Structure and Physical Operation 

### 6.1.1 Simplified Structure and Modes of Operation

Figure 6.1 shows a simplified structure for the BJT. A practical transistor structure will be shown later (see also Appendix A, which deals with fabrication technology).

As shown in Fig. 6.1, the BJT consists of three semiconductor regions: the emitter region ( $n$ type), the base region ( $p$ type), and the collector region ( $n$ type). Such a transistor is called an $n p n$ transistor. Another transistor, a dual of the $n p n$ as shown in Fig. 6.2, has a $p$-type emitter, an $n$-type base, and a $p$-type collector, and is appropriately called a pnp transistor.

A terminal is connected to each of the three semiconductor regions of the transistor, with the terminals labeled emitter (E), base (B), and collector (C).

The transistor consists of two $p n$ junctions, the emitter-base junction (EBJ) and the collector-base junction (CBJ). Depending on the bias condition (forward or reverse) of each of these junctions, different modes of operation of the BJT are obtained, as shown in Table 6.1. The active mode is the one used if the transistor is to operate as an amplifier. Switching applications (e.g., logic circuits) utilize both the cutoff mode and the saturation mode. As the name implies, in the cutoff mode no current flows because both junctions are reverse biased.

As we will see shortly, charge carriers of both polarities-that is, electrons and holes-participate in the current-conduction process in a bipolar transistor, which is the reason for the name bipolar. ${ }^{1}$

[^0]
[^0]:    ${ }^{1}$ This should be contrasted with the situation in the MOSFET, where current is conducted by charge carriers of one type only: electrons in $n$-channel devices or holes in $p$-channel devices. In earlier days, some referred to FETs as unipolar devices.


Figure 6.1 A simplified structure of the $n p n$ transistor.


Figure 6.2 A simplified structure of the $p n p$ transistor.

| Table 6.1 | BJT Modes of Operation |  |
| :-- | :-- | :-- |
| Mode | EBJ | CBJ |
| Cutoff | Reverse | Reverse |
| Active | Forward | Reverse |
| Saturation | Forward | Forward |

# 6.1.2 Operation of the npn Transistor in the Active Mode 

Of the three modes of operation of the BJT, the active mode is the most important. Therefore, we begin our study of the BJT by considering its physical operation in the active mode. ${ }^{2}$ This situation is illustrated in Fig. 6.3 for the $n p n$ transistor. Two external voltage sources (shown as batteries) are used to establish the required bias conditions for active-mode operation. The voltage $V_{B E}$ causes the $p$-type base to be higher in potential than the $n$-type emitter, thus forward biasing the emitter-base junction. The collector-base voltage $V_{C B}$ causes the $n$-type collector to be at a higher potential than the $p$-type base, thus reverse biasing the collector-base junction.

[^0]
[^0]:    ${ }^{2}$ The material in this section assumes that the reader is familiar with the operation of the $p n$ junction under forward-bias conditions (Section 3.5).


Figure 6.3 Current flow in an $n p n$ transistor biased to operate in the active mode. (Reverse current components due to drift of thermally generated minority carriers are not shown.)

Current Flow The forward bias on the emitter-base junction will cause current to flow across this junction. Current will consist of two components: electrons injected from the emitter into the base, and holes injected from the base into the emitter. As will become apparent shortly, it is highly desirable to have the first component (electrons from emitter to base) be much larger than the second component (holes from base to emitter). This can be accomplished by fabricating the device with a heavily doped emitter and a lightly doped base; that is, the device is designed to have a high density of electrons in the emitter and a low density of holes in the base.

The current that flows across the emitter-base junction will constitute the emitter current $i_{E}$, as indicated in Fig. 6.3. The direction of $i_{E}$ is "out of" the emitter lead, which, following the usual conventions, is in the direction of the positive-charge flow (hole current) and opposite to the direction of the negative-charge flow (electron current), with the emitter current $i_{E}$ being equal to the sum of these two components. However, since the electron component is much larger than the hole component, the emitter current will be dominated by the electron component.

From our study in Section 3.5 of the current flow across a forward-biased $p n$ junction, we know that the magnitude of both the electron component and the hole component of $i_{E}$ will be proportional to $e^{v_{B E} / V_{T}}$, where $v_{B E}$ is the forward voltage across the base-emitter junction and $V_{T}$ is the thermal voltage (approximately 25 mV at room temperature).

Let's now focus our attention on the first current component, namely, that carried by electrons injected from the emitter into the base. These electrons will be minority carriers in the $p$-type base region. Because their concentration will be highest at the emitter side of the base, the injected electrons will diffuse through the base region toward the collector. In their journey across the base, some of the electrons will combine with holes, which are majority carriers in the base. However, since the base is usually very thin and, as mentioned earlier, lightly doped, the proportion of electrons that are "lost" through this recombination process will be quite small. Thus, most of the diffusing electrons will reach the boundary of the collector-base depletion region. Because the collector is more positive than the base (by the
reverse-bias voltage $v_{C B}$ ), these successful electrons will be swept across the CBJ depletion region into the collector. They will thus get collected and constitute the collector current $i_{C}$.

The Collector Current From the foregoing statements, we see that the collector current is carried by the electrons that reach the collector region. Its direction will be opposite to that of the flow of electrons, and thus into the collector terminal. Its magnitude will be proportional to $e^{v_{B E} / V_{T}}$, thus

$$
i_{C}=I_{S} e^{v_{B E} / V_{T}}
$$

where the constant of proportionality $I_{S}$, as in the case of the diode, is called the saturation current and is a transistor parameter. We will have more to say about $I_{S}$ shortly.

An important observation to make here is that $i_{C}$ is independent of the value of $v_{C B}$. That is, as long as the collector is positive with respect to the base, the electrons that reach the collector side of the base region will be swept into the collector and will register as collector current.

The Base Current Reference to Fig. 6.3 shows that the base current $i_{B}$ is composed of two components. The first component $i_{B 1}$ is due to the holes injected from the base region into the emitter region. This current component is proportional to $e^{v_{B E} / V_{T}}$. The second component of base current, $i_{B 2}$, is due to holes that have to be supplied by the external circuit in order to replace the holes lost from the base through the recombination process. Because $i_{B 2}$ is proportional to the number of electrons injected into the base, it also will be proportional to $e^{v_{B E} / V_{T}}$. Thus the total base current, $i_{B}=i_{B 1}+i_{B 2}$, will be proportional to $e^{v_{B E} / V_{T}}$, and can be expressed as a fraction of the collector current $i_{C}$ as follows:

$$
i_{B}=\frac{i_{C}}{\beta}
$$

That is,

$$
i_{B}=\left(\frac{I_{S}}{\beta}\right) e^{v_{B E} / V_{T}}
$$

where $\beta$ is a transistor parameter.
For modern $n p n$ transistors, $\beta$ is in the range 50 to 200 , but it can be as high as 1000 for special devices. For reasons that will become clear later, the parameter $\beta$ is called the common-emitter current gain.

The above description indicates that the value of $\beta$ is highly influenced by two factors: the width of the base region, $W$, and the relative dopings of the base region and the emitter region, $N_{A} / N_{D}$. To obtain a high $\beta$ (which is highly desirable since $\beta$ represents a gain parameter) the base should be thin ( $W$ small) and lightly doped and the emitter heavily doped (making $N_{A} / N_{D}$ small). For modern integrated circuit fabrication technologies, $W$ is in the nanometer range.

The Emitter Current Since the current that enters a transistor must leave it, it can be seen from Fig. 6.3 that the emitter current $i_{E}$ is equal to the sum of the collector current $i_{C}$ and the base current $i_{B}$; that is,

$$
i_{E}=i_{C}+i_{B}
$$
Use of Eqs. (6.2) and (6.4) gives

$$
i_{E}=\frac{\beta+1}{\beta} i_{C}
$$

That is,

$$
i_{E}=\frac{\beta+1}{\beta} I_{S} e^{v_{R E} / V_{T}}
$$

Alternatively, we can express Eq. (6.5) in the form

$$
i_{C}=\alpha i_{E}
$$

where the constant $\alpha$ is related to $\beta$ by

$$
\alpha=\frac{\beta}{\beta+1}
$$

Thus the emitter current in Eq. (6.6) can be written

$$
i_{E}=\left(I_{S} / \alpha\right) e^{v_{R E} / V_{T}}
$$

Finally, we can use Eq. (6.8) to express $\beta$ in terms of $\alpha$, that is,

$$
\beta=\frac{\alpha}{1-\alpha}
$$

It can be seen from Eq. (6.8) that $\alpha$ is a constant (for a particular transistor) that is less than but very close to unity. For instance, if $\beta=100$, then $\alpha \simeq 0.99$. Equation (6.10) reveals an important fact: Small changes in $\alpha$ correspond to very large changes in $\beta$. This mathematical observation manifests itself physically, with the result that transistors of the same type may have widely different values of $\beta$. For reasons that will become apparent later, $\alpha$ is called the common-base current gain.

Minority-Carrier Distribution Our understanding of the physical operation of the BJT can be enhanced by considering the distribution of minority charge carriers in the base and the emitter. Figure 6.4 shows the profiles of the concentration of electrons in the base and holes in the emitter of an npn transistor operating in the active mode. Observe that since the doping concentration in the emitter, $N_{D}$, is much higher than the doping concentration in the base, $N_{A}$, the concentration of electrons injected from emitter to base, $n_{p}(0)$, is much higher than the concentration of holes injected from the base to the emitter, $p_{a}(0)$. Both quantities are proportional to $e^{v_{R E} / V_{T}}$, thus

$$
n_{p}(0)=n_{p 0} e^{v_{R E} / V_{T}}
$$

where $n_{p 0}$ is the thermal-equilibrium value of the minority-carrier (electron) concentration in the base region.

Next, observe that because the base is very thin, the concentration of excess electrons decays almost linearly (as opposed to the usual exponential decay, as observed for the excess holes in the emitter region). Furthermore, the reverse bias on the collector-base junction causes the concentration of excess electrons at the collector side of the base to be zero. (Recall that electrons that reach that point are swept into the collector.)

The tapered minority-carrier concentration profile (Fig. 6.4) causes the electrons injected into the base to diffuse through the base region toward the collector. This electron diffusion


Figure 6.4 Profiles of minority-carrier concentrations in the base and in the emitter of an $n p n$ transistor operating in the active mode: $v_{B E}>0$ and $v_{C B} \geq 0$.
current $I_{n}$ is directly proportional to the slope of the straight-line concentration profile,

$$
\begin{aligned}
I_{n} & =A_{E} q D_{n} \frac{d n_{p}(x)}{d x} \\
& =A_{E} q D_{n}\left(-\frac{n_{p}(0)}{W}\right)
\end{aligned}
$$

where $A_{E}$ is the cross-sectional area of the base-emitter junction (in the direction perpendicular to the page), $q$ is the magnitude of the electron charge, $D_{n}$ is the electron diffusivity in the base, and $W$ is the effective width of the base. Observe that the negative slope of the minority-carrier concentration results in a negative current $I_{n}$ across the base; that is, $I_{n}$ flows from right to left (in the negative direction of $x$ ), which corresponds to the usual convention, namely, opposite to the direction of electron flow.

The recombination in the base region, though slight, causes the excess minority-carrier concentration profile to deviate from a straight line and take the slightly concave shape indicated by the broken line in Fig. 6.4. The slope of the concentration profile at the EBJ is slightly higher than that at the CBJ, with the difference accounting for the small number of electrons lost in the base region through recombination.

Finally, we have the collector current $i_{C}=I_{n}$, which will yield a negative value for $i_{C}$, indicating that $i_{C}$ flows in the negative direction of the $x$ axis (i.e., from right to left). Since we will take this to be the positive direction of $i_{C}$, we can drop the negative sign in Eq. (6.12). Doing this and substituting for $n_{p}(0)$ from Eq. (6.11), we can thus express the collector current $i_{C}$ as

$$
i_{C}=I_{S} e^{v_{B E} / v_{T}}
$$

where the saturation current $I_{S}$ is given by

$$
I_{S}=A_{E} q D_{n} n_{p 0} / W
$$Substituting $n_{p 0}=n_{i}^{2} / N_{A}$, where $n_{i}$ is the intrinsic carrier density and $N_{A}$ is the doping concentration in the base, we can express $I_{S}$ as

$$
I_{S}=\frac{A_{E} q D_{o} n_{i}^{2}}{N_{A} W}
$$

The saturation current $I_{S}$ is inversely proportional to the base width $W$ and is directly proportional to the area of the EBJ. Typically $I_{S}$ is in the range of $10^{-12} \mathrm{~A}$ to $10^{-18} \mathrm{~A}$ (depending on the size of the device). Because $I_{S}$ is proportional to $n_{i}^{2}$, it is a strong function of temperature, approximately doubling for every $5^{\circ} \mathrm{C}$ rise in temperature. (For the dependence of $n_{i}^{2}$ on temperature, refer to Eq. 3.2.)

Since $I_{S}$ is directly proportional to the junction area (i.e., the device size), it will also be referred to as the scale current. Two transistors that are identical except that one has an EBJ area, say, twice that of the other will have saturation currents with that same ratio (i.e., 2). Thus for the same value of $v_{B E}$ the larger device will have a collector current twice that in the smaller device. This concept is frequently employed in integrated-circuit design.

Recapitulation and Equivalent-Circuit Models We have presented a first-order model for the operation of the $n p n$ transistor in the active mode. Basically, the forward-bias voltage $v_{B E}$ causes an exponentially related current $i_{C}$ to flow in the collector terminal. The collector current $i_{C}$ is independent of the value of the collector voltage as long as the collector-base junction remains reverse biased; that is, $v_{C B} \geq 0$. Thus in the active mode the collector terminal behaves as an ideal constant-current source where the value of the current is determined by $v_{B E}$. The base current $i_{B}$ is a factor $1 / \beta$ of the collector current, and the emitter current is equal to the sum of the collector and base currents. Since $i_{B}$ is much smaller than $i_{C}$ (i.e., $\beta \gg 1$ ), $i_{E} \simeq i_{C}$. More precisely, the collector current is a fraction $\alpha$ of the emitter current, with $\alpha$ smaller than, but close to, unity.

This first-order model of transistor operation in the active mode can be represented by the equivalent circuit shown in Fig. 6.5(a). Here, diode $D_{E}$ has a scale current $I_{S E}$ equal to $\left(I_{S} / \alpha\right)$ and thus provides a current $i_{E}$ related to $v_{B E}$ according to Eq. (6.9). The current of the controlled source, which is equal to the collector current, is controlled by $v_{B E}$ according to the exponential relationship indicated, a restatement of Eq. (6.1). This model is in essence a nonlinear voltage-controlled current source. It can be converted to the current-controlled current-source model shown in Fig. 6.5(b) by expressing the current of the controlled source as $\alpha i_{E}$. Note that this model is also nonlinear because of the exponential relationship of the current $i_{E}$ through diode $D_{E}$ and the voltage $v_{B E}$. From this model we observe that if the transistor is used as a two-port network with the input port between E and B and the output port between C and B (i.e., with B as a common terminal), then the current gain observed is equal to $\alpha$. Thus $\alpha$ is called the common-base current gain.

Two other equivalent-circuit models, shown in Fig. 6.5(c) and (d), may be used to represent the operation of the BJT. The model of Fig. 6.5(c) is essentially a voltage-controlled current source. However, here diode $D_{B}$ conducts the base current and thus its current scale factor is $I_{S} / \beta$, resulting in the $i_{B}-v_{B E}$ relationship given in Eq. (6.3). By simply expressing the collector current as $\beta i_{B}$ we obtain the current-controlled current-source model shown in Fig. 6.5(d). From this latter model we observe that if the transistor is used as a two-port network with the input port between B and E and the output port between C and E (i.e., with E as the common terminal), then the current gain observed is equal to $\beta$. Thus $\beta$ is called the common-emitter current gain.


Figure 6.5 Large-signal equivalent-circuit models of the $n p n$ BJT operating in the forward active mode.

Finally, we note that the models in Fig. 6.5 apply for any positive value of $v_{B E}$. That is, unlike the models we will be discussing in Chapter 7, here there is no limitation on the size of $v_{B E}$, and thus these models are referred to as large-signal models.

# Example 6.1 

An $n p n$ transistor having $I_{S}=10^{-15} \mathrm{~A}$ and $\beta=100$ is connected as follows: The emitter is grounded, the base is fed with a constant-current source supplying a dc current of $10 \mu \mathrm{~A}$, and the collector is connected to a $5-\mathrm{V}$ dc supply via a resistance $R_{C}$ of $3 \mathrm{k} \Omega$. Assuming that the transistor is operating in the active mode, find $V_{B E}$ and $V_{C E}$. Use these values to verify active-mode operation. Replace the current source with a resistance connected from the base to the $5-\mathrm{V}$ dc supply. What resistance value is needed to result in the same operating conditions?
# Example 6.1 continued 

## Solution

If the transistor is operating in the active mode, it can be represented by one of the four possible equivalent-circuit models shown in Fig. 6.5. Because the emitter is grounded, either the model in Fig. 6.5(c) or that in Fig. 6.5(d) would be suitable. Since we know the base current $I_{B}$, the model of Fig. 6.5(d) is the most suitable.


Figure 6.6 Circuits for Example 6.1.

Figure 6.6(a) shows the circuit as described with the transistor represented by the model of Fig. 6.5(d). We can determine $V_{B E}$ from the exponential characteristic of $D_{B}$ as follows:

$$
\begin{aligned}
V_{B E} & =V_{T} \ln \frac{I_{B}}{I_{S} I \beta} \\
& =25 \ln \left(\frac{10 \times 10^{-6}}{10^{-17}}\right) \\
& =690 \mathrm{mV}=0.69 \mathrm{~V}
\end{aligned}
$$

Next we determine the value of $V_{C E}$ from

$$
V_{C E}=V_{C C}-R_{C} I_{C}
$$

where

$$
I_{C}=\beta I_{B}=100 \times 10 \times 10^{-6}=10^{-3} \mathrm{~A}=1 \mathrm{~mA}
$$
Thus,

$$
V_{C E}=5-3 \times 1=+2 \mathrm{~V}
$$

Since $V_{C}$ at +2 V is higher than $V_{B}$ at 0.69 V , the transistor is indeed operating in the active mode.
Now, replacing the $10-\mu \mathrm{A}$ current source with a resistance $R_{B}$ connected from the base to the $5-\mathrm{V} d \mathrm{c}$ supply $V_{C C}$, as in Fig. 6.6(b), the value of $R_{B}$ must be

$$
\begin{aligned}
R_{B} & =\frac{V_{C C}-V_{B E}}{I_{B}} \\
& =\frac{5-0.69}{10 \mu \mathrm{~A}}=431 \mathrm{k} \Omega
\end{aligned}
$$

# EXERCISES 

6.1 Consider an $n p n$ transistor with $v_{B E}=0.7 \mathrm{~V}$ at $i_{C}=1 \mathrm{~mA}$. Find $v_{B E}$ at $i_{C}=0.1 \mathrm{~mA}$ and 10 mA . Ans. $0.64 \mathrm{~V} ; 0.76 \mathrm{~V}$
6.2 Transistors of a certain type are specified to have $\beta$ values in the range of 50 to 150 . Find the range of their $\alpha$ values.
Ans. 0.980 to 0.993
6.3 Measurement of an $n p n$ BJT in a particular circuit shows the base current to be $14.46 \mu \mathrm{~A}$, the emitter current to be 1.460 mA , and the base-emitter voltage to be 0.7 V . For these conditions, calculate $\alpha, \beta$, and $I_{S}$.
Ans. $0.99 ; 100 ; 10^{-15} \mathrm{~A}$
6.4 Calculate $\beta$ for two transistors for which $\alpha=0.99$ and 0.98 . For collector currents of 10 mA , find the base current of each transistor.
Ans. $99 ; 49 ; 0.1 \mathrm{~mA} ; 0.2 \mathrm{~mA}$
6.5 A transistor for which $I_{S}=10^{-16} \mathrm{~A}$ and $\beta=100$ is conducting a collector current of 1 mA . Find $v_{B E}$. Also, find $I_{S E}$ and $I_{S B}$ for this transistor.
Ans. $747.5 \mathrm{mV} ; 1.01 \times 10^{-16} \mathrm{~A} ; 10^{-18} \mathrm{~A}$
6.6 For the circuit in Fig. 6.6(a) analyzed in Example 6.1, find the maximum value of $R_{C}$ that will still result in active-mode operation.
Ans. $4.31 \mathrm{k} \Omega$

### 6.1.3 Structure of Actual Transistors

Figure 6.7 shows a more realistic (but still simplified) cross section of an $n p n$ BJT. Note that the collector virtually surrounds the emitter region, thus making it difficult for the electrons injected into the thin base to escape being collected. In this way, the resulting $\alpha$ is close to


Figure 6.7 Cross section of an $n p n$ BJT.
unity and $\beta$ is large. Also, observe that the device is not symmetrical, and thus the emitter and collector cannot be interchanged. ${ }^{3}$ For more detail on the physical structure of actual devices, the reader is referred to Appendix A.

The structure in Fig. 6.7 indicates also that the CBJ has a much larger area than the EBJ. Thus the CB diode $D_{C}$ has a saturation current $I_{S C}$ that is much larger than the saturation current of the EB diode $D_{E}$. Typically, $I_{S C}$ is 10 to 100 times larger than $I_{S E}$ (recall that $\left.I_{S E}=I_{S} / \alpha \simeq I_{S}\right)$.

# EXERCISE 

6.7 A particular transistor has $I_{S}=10^{-15} \mathrm{~A}$ and $\alpha \simeq 1$. If the CBJ area is 100 times the area of the EBJ, find the collector scale current $I_{S C}$.
Ans. $10^{-13} \mathrm{~A}$

### 6.1.4 Operation in the Saturation Mode ${ }^{4}$

As mentioned above, for the BJT to operate in the active mode, the CBJ must be reverse biased. Thus far, we have stated this condition for the $n p n$ transistor as $v_{C B} \geq 0$. However, we know that a $p n$ junction does not effectively become forward biased until the forward voltage across it exceeds approximately 0.4 V . It follows that one can maintain active-mode operation of an $n p n$ transistor for negative $v_{C B}$ down to approximately -0.4 V . This is illustrated in Fig. 6.8, which is a sketch of $i_{C}$ versus $v_{C B}$ for an $n p n$ transistor operated with a constant emitter current $I_{E}$. As expected, $i_{C}$ is independent of $v_{C B}$ in the active mode, a situation that extends

[^0]
[^0]:    ${ }^{3}$ If the emitter and collector are reversed-that is, the CBJ is forward biased and the EBJ is reverse biased-the device operates in a mode called the "reverse-active mode." The resulting values of $\alpha$ and $\beta$, denoted $\alpha_{R}$ and $\beta_{R}$ (with $R$ denoting reverse), are much lower than the values of $\alpha$ and $\beta$, respectively, obtained in the "forward"-active mode discussed above. Hence, the reverse-active mode has no practical application. The MOSFET, on the other hand, being a perfectly symmetrical device, can operate equally well with its drain and source terminals interchanged.
    ${ }^{4}$ Saturation means something completely different in a BJT and in a MOSFET. The saturation mode of operation of the BJT is analogous to the triode region of operation of the MOSFET. On the other hand, the saturation region of operation of the MOSFET corresponds to the active mode of BJT operation.


Figure 6.8 The $i_{C}-v_{C B}$ characteristic of an $n p n$ transistor fed with a constant emitter current $I_{E}$. The transistor enters the saturation mode of operation for $v_{C B}<-0.4 \mathrm{~V}$, and the collector current diminishes.


Figure 6.9 Modeling the operation of an npn transistor in saturation by augmenting the model of Fig. 6.5(c) with a forward-conducting diode $D_{C}$. Note that the current through $D_{C}$ increases $i_{B}$ and reduces $i_{C}$.
for $v_{C B}$ going negative to approximately -0.4 V . Below this value of $v_{C B}$, the CBJ begins to conduct sufficiently that the transistor leaves the active mode and enters the saturation mode of operation, where $i_{C}$ decreases.

To see why $i_{C}$ decreases in saturation, we can construct a model for the saturated npn transistor as follows. We augment the model of Fig. 6.5(c) with the forward-conducting CBJ diode $D_{C}$, as shown in Fig. 6.9. Observe that the current $i_{B C}$ will subtract from the controlled-source current, resulting in the reduced collector current $i_{C}$ given by

$$
i_{C}=I_{S} e^{v_{B E} / V_{T}}-I_{S C} e^{v_{B C} / V_{T}}
$$

where $I_{S C}$ is the saturation current for $D_{C}$ and is related to $I_{S}$ by the ratio of the areas of the CBJ and the EBJ. The second term in Eq. (6.14) will play an increasing role as $v_{B C}$ exceeds 0.4 V or so, causing $i_{C}$ to decrease and eventually reach zero.

Figure 6.9 also indicates that in saturation the base current will increase to the value

$$
i_{B}=\left(I_{S} / \beta\right) e^{v_{B E} / V_{T}}+I_{S C} e^{v_{B C} / V_{T}}
$$

Equations (6.14) and (6.15) can be combined to obtain the ratio $i_{C} / i_{B}$ for a saturated transistor. We observe that this ratio will be lower than the value of $\beta$. Furthermore, the ratio will decrease as $v_{B C}$ is increased and the transistor is driven deeper into saturation. Because $i_{C} / i_{B}$
of a saturated transistor can be set to any desired value lower than $\beta$ by adjusting $v_{B C}$, this ratio is known as forced $\beta$ and denoted $\beta_{\text {forced }}$,

$$
\beta_{\text {forced }}=\left.\frac{i_{C}}{i_{B}}\right|_{\text {saturation }} \leq \beta
$$

As will be shown later, in analyzing a circuit we can determine whether the BJT is in the saturation mode by either of the following two tests:

1. Is the CBJ forward biased by more than 0.4 V ?
2. Is the ratio $i_{C} / i_{B}$ lower than $\beta$ ?

The collector-to-emitter voltage $v_{C E}$ of a saturated transistor can be found from Fig. 6.9 as the difference between the forward-bias voltages of the EBJ and the CBJ,

$$
V_{C E \text { sat }}=V_{B E}-V_{B C}
$$

Recalling that the CBJ has a much larger area than the EBJ, $V_{B C}$ will be smaller than $V_{B E}$ by 0.1 to 0.3 V . Thus,

$$
V_{C E \text { sat }} \simeq 0.1 \text { to } 0.3 \mathrm{~V}
$$

Typically we will assume that a transistor at the edge of saturation has $V_{C E \text { sat }}=0.3 \mathrm{~V}$, while a transistor deep in saturation has $V_{C E \text { sat }}=0.2 \mathrm{~V}$.

# EXERCISES 

6.8 Use Eq. (6.14) to show that $i_{C}$ reaches zero at

$$
V_{C E}=V_{T} \ln \left(I_{S C} / I_{S}\right)
$$

Calculate $V_{C E}$ for a transistor whose CBJ has 100 times the area of the EBJ.
Ans. 115 mV
6.9 Use Eqs. (6.14), (6.15), and (6.16) to show that a BJT operating in saturation with $V_{C E}=V_{C E \text { sat }}$ has a forced $\beta$ given by

$$
\beta_{\text {forced }}=\beta \frac{e^{V_{C E \text { sat }} / V_{T}}-I_{S C} / I_{S}}{e^{V_{C E \text { sat }} / V_{T}}+\beta I_{S C} / I_{S}}
$$

Find $\beta_{\text {forced }}$ for $\beta=100, I_{S C} / I_{S}=100$, and $V_{C E \text { sat }}=0.2 \mathrm{~V}$.
Ans. 22.2

### 6.1.5 The pnp Transistor

The $p n p$ transistor operates in a manner similar to that of the $n p n$ device described above. Figure 6.10 shows a $p n p$ transistor biased to operate in the active mode. Here the voltage $V_{E B}$ causes the $p$-type emitter to be higher in potential than the $n$-type base, thus forward biasing the emitter-base junction. The collector-base junction is reverse biased by the voltage $V_{B C}$, which keeps the $p$-type collector lower in potential than the $n$-type base.


Figure 6.10 Current flow in a pnp transistor biased to operate in the active mode.

Unlike the $n p n$ transistor, current in the $p n p$ device is mainly conducted by holes injected from the emitter into the base as a result of the forward-bias voltage $V_{E B}$. Since the component of emitter current contributed by electrons injected from base to emitter is kept small by using a lightly doped base, most of the emitter current will be due to holes. The electrons injected from base to emitter give rise to the first component of base current, $i_{B 1}$. Also, a number of the holes injected into the base will recombine with the majority carriers in the base (electrons) and will thus be lost. The disappearing base electrons will have to be replaced from the external circuit, giving rise to the second component of base current, $i_{B 2}$. The holes that succeed in reaching the boundary of the depletion region of the collector-base junction will be attracted by the negative voltage on the collector. Thus these holes will be swept across the depletion region into the collector and appear as collector current.

It can easily be seen from the above description that the current-voltage relationship of the $p n p$ transistor will be identical to that of the $n p n$ transistor except that $v_{B E}$ has to be replaced by $v_{E B}$. Also, the large-signal, active-mode operation of the $p n p$ transistor can be modeled by any of four equivalent circuits similar to those for the $n p n$ transistor in Fig. 6.5. Two of these four circuits are shown in Fig. 6.11. Finally, we note that the pnp transistor can operate in the saturation mode in a manner analogous to that described for the $n p n$ device.

# EXERCISES 

6.10 Consider the model in Fig. 6.11(a) applied in the case of a pnp transistor whose base is grounded, the emitter is fed by a constant-current source that supplies a $2-\mathrm{mA}$ current into the emitter terminal, and the collector is connected to a $-10-\mathrm{V}$ dc supply. Find the emitter voltage, the base current, and the collector current if for this transistor $\beta=50$ and $I_{S}=10^{-14} \mathrm{~A}$.
Ans. $0.650 \mathrm{~V} ; 39.2 \mu \mathrm{~A} ; 1.96 \mathrm{~mA}$
6.11 For a $p n p$ transistor having $I_{S}=10^{-11} \mathrm{~A}$ and $\beta=100$, calculate $v_{E B}$ for $i_{C}=1.5 \mathrm{~A}$. Ans. 0.643 V


Figure 6.11 Two large-signal models for the pnp transistor operating in the active mode.

## THE INVENTION OF THE BJT:

The first working transistor was demonstrated at the Bell Labs in late 1947 by John Bardeen and Walter Brattain, who were part of a team led by William Shockley. Made of germanium, the device became known as a point-contact transistor and operated on the field-effect principle. Within a few weeks, however, Shockley wrote a complete description of the bipolar junction transistor (BJT) and filed for a U.S. patent with the title "Circuit Element Utilizing Semiconductor Material."

BJTs dominated the electronics world from the early 1950s to the mid-1970s, when MOSFETs took over the leading position. In 1956, Shockley, Bardeen, and Brattain shared the Nobel Prize in Physics for the discovery of the transistor effect.

# 6.2 Current-Voltage Characteristics 

### 6.2.1 Circuit Symbols and Conventions

The physical structure used thus far to explain transistor operation is rather cumbersome to employ in drawing the schematic of a multitransistor circuit. Fortunately, a very descriptive and convenient circuit symbol exists for the BJT. Figure 6.12(a) shows the symbol for the $n p n$ transistor; the pnp symbol is given in Fig. 6.12(b). In both symbols the emitter is distinguished by an arrowhead. This distinction is important because, as we have seen in the last section, practical BJTs are not symmetric devices.

The polarity of the device-npn or pnp-is indicated by the direction of the arrowhead on the emitter. This arrowhead points in the direction of normal current flow in the emitter, which is also the forward direction of the base-emitter junction. Since we have adopted a drawing convention by which currents flow from top to bottom, we will always draw pnp transistors in the manner shown in Fig. 6.12(b) (i.e., with their emitters on top).

Figure 6.13 shows $n p n$ and $p n p$ transistors connected to dc sources so as to operate in the active mode. Figure 6.13 also indicates the reference and actual directions of current flow throughout the transistor. Our convention will be to take the reference direction to coincide


Figure 6.12 Circuit symbols for BJTs.


Figure 6.13 Voltage polarities and current flow in transistors operating in the active mode.
with the normal direction of current flow. Hence, normally, we should not encounter a negative value for $i_{E}, i_{B}$, or $i_{C}$.

The convenience of the circuit-drawing convention that we have adopted should be obvious from Fig. 6.13. Note that currents flow from top to bottom and that voltages are higher at the top and lower at the bottom. The arrowhead on the emitter also implies the polarity of the emitter-base voltage that should be applied in order to forward bias the emitter-base junction. Just a glance at the circuit symbol of the $p n p$ transistor, for example, indicates that we should make the emitter higher in voltage than the base (by $v_{E B}$ ) in order to cause current to flow into the emitter (downward). Note that the symbol $v_{E B}$ means the voltage by which the emitter (E) is higher than the base (B). Thus for a $p n p$ transistor operating in the active mode $v_{E B}$ is positive, while in an $n p n$ transistor $v_{B E}$ is positive.

From the discussion of Section 6.1 it follows that an $n p n$ transistor whose EBJ is forward biased (usually, $V_{B E} \simeq 0.7 \mathrm{~V}$ ) will operate in the active mode as long as the collector voltage does not fall below that of the base by more than approximately 0.4 V . Otherwise, the transistor leaves the active mode and enters the saturation region of operation. ${ }^{5}$

In a parallel manner, the $p n p$ transistor will operate in the active mode if the $E B J$ is forward biased (usually, $V_{E B} \simeq 0.7 \mathrm{~V}$ ) and the collector voltage is not allowed to rise above that of the base by more than 0.4 V or so. Otherwise, the CBJ becomes forward biased, and the pnp transistor enters the saturation region of operation.

[^0]
[^0]:    ${ }^{5}$ It is interesting to contrast the active-mode operation of the BJT with the corresponding mode of operation of the MOSFET: The BJT needs a minimum $v_{C E}$ of about 0.3 V , and the MOSFET needs a minimum $v_{1 t h}$ equal to $V_{t h}$, which for modern technologies is in the range of 0.2 V to 0.3 V . Thus we see a great deal of similarity! Also note that reverse biasing the CBJ of the BJT corresponds to pinching off the channel of the MOSFET. This condition results in the collector current (drain current in the MOSFET) being independent of the collector voltage (the drain voltage in the MOSFET).

Figure 6.14 Graphical representation of the conditions for operating the BJT in the active mode and in the saturation mode.

Table 6.2 Summary of the BJT Current-Voltage Relationships in the Active Mode

$$
\begin{aligned}
& i_{C}=I_{S} e^{v_{B E} / v_{T}} \\
& i_{B}=\frac{i_{C}}{\beta}=\left(\frac{I_{S}}{\beta}\right) e^{v_{B E} / v_{T}} \\
& i_{E}=\frac{i_{C}}{\alpha}=\left(\frac{I_{S}}{\alpha}\right) e^{v_{B E} / v_{T}}
\end{aligned}
$$

Note: For the pnp transistor, replace $v_{B E}$ with $v_{E B}$.

$$
\begin{array}{ll}
i_{C}=\alpha i_{E} & i_{B}=(1-\alpha) i_{E}=\frac{i_{E}}{\beta+1} \\
i_{C}=\beta i_{B} & i_{E}=(\beta+1) i_{B} \\
\beta=\frac{\alpha}{1-\alpha} & \alpha=\frac{\beta}{\beta+1} \\
V_{T}=\text { thermal voltage }=\frac{k T}{q} \simeq 25 \mathrm{mV} \text { at room temperature } &
\end{array}
$$

For greater emphasis, we show in Fig. 6.14 a graphical construction that illustrates the conditions for operating the BJT in the active mode and in the saturation mode. Also, for easy reference, we present in Table 6.2 a summary of the BJT current-voltage relationships in the active mode of operation.

The Collector-Base Reverse Current ( $I_{C B O}$ ) In our discussion of current flow in transistors we ignored the small reverse currents carried by thermally generated minority carriers. Although such currents can be safely neglected in modern transistors, the reverse current across the collector-base junction deserves some mention. This current, denoted $I_{C B O}$, is the reverse current flowing from collector to base with the emitter open-circuited (hence the subscript $O$ ). This current is usually in the nanoampere range, a value that is many times higher than its theoretically predicted value. As with the diode reverse current, $I_{C B O}$ contains a substantial leakage component, and its value is dependent on $v_{C B} . I_{C B O}$ depends strongly on temperature, approximately doubling for every $10^{\circ} \mathrm{C}$ rise. ${ }^{6}$

[^0]
[^0]:    ${ }^{6}$ The temperature coefficient of $I_{C B O}$ is different from that of $I_{S}$ because $I_{C B O}$ contains a substantial leakage component.
# Example 6.2 

The transistor in the circuit of Fig. 6.15(a) has $\beta=100$ and exhibits a $v_{B E}$ of 0.7 V at $i_{C}=1 \mathrm{~mA}$. Design the circuit so that a current of 2 mA flows through the collector and a voltage of +5 V appears at the collector.


Figure 6.15 Circuit for Example 6.2.

## Solution

Refer to Fig. 6.15(b). We note at the outset that since we are required to design for $V_{C}=+5 \mathrm{~V}$, the CBJ will be reverse biased and the BJT will be operating in the active mode. To obtain a voltage $V_{C}=+5 \mathrm{~V}$, the voltage drop across $R_{C}$ must be $15-5=10 \mathrm{~V}$. Now, since $I_{C}=2 \mathrm{~mA}$, the value of $R_{C}$ should be selected according to

$$
R_{C}=\frac{10 \mathrm{~V}}{2 \mathrm{~mA}}=5 \mathrm{k} \Omega
$$

Since $v_{B E}=0.7 \mathrm{~V}$ at $i_{C}=1 \mathrm{~mA}$, the value of $v_{B E}$ at $i_{C}=2 \mathrm{~mA}$ is

$$
V_{B E}=0.7+V_{T} \ln \left(\frac{2}{1}\right)=0.717 \mathrm{~V}
$$

Since the base is at 0 V , the emitter voltage should be

$$
V_{E}=-0.717 \mathrm{~V}
$$

For $\beta=100, \alpha=100 / 101=0.99$. Thus the emitter current should be

$$
I_{E}=\frac{I_{C}}{\alpha}=\frac{2}{0.99}=2.02 \mathrm{~mA}
$$
# Example 6.2 continued 

Now the value required for $R_{E}$ can be determined from

$$
\begin{aligned}
R_{E} & =\frac{V_{E}-(-15)}{I_{E}} \\
& =\frac{-0.717+15}{2.02}=7.07 \mathrm{k} \Omega
\end{aligned}
$$

This completes the design. We should note, however, that the calculations above were made with a degree of precision that is usually neither necessary nor justified in practice in view, for instance, of the expected tolerances of component values. Nevertheless, we chose to do the design precisely in order to illustrate the various steps involved.

## EXERCISES

D6.12 Repeat Example 6.2 for a transistor fabricated in a modern integrated-circuit process. Such a process yields devices that exhibit larger $v_{B E}$ at the same $i_{C}$ because they have much smaller junction areas. The dc power supplies utilized in modern IC technologies fall in the range of 1 V to 3 V . Design a circuit similar to that shown in Fig. 6.15 except that now the power supplies are $\pm 1.5 \mathrm{~V}$ and the BJT has $\beta=100$ and exhibits $v_{B E}$ of 0.8 V at $i_{C}=1 \mathrm{~mA}$. Design the circuit so that a current of 2 mA flows through the collector and a voltage of +0.5 V appears at the collector.
Ans. $R_{C}=500 \Omega ; R_{E}=338 \Omega$
6.13 In the circuit shown in Fig. E6.13, the voltage at the emitter was measured and found to be -0.7 V . If $\beta=50$, find $I_{E}, I_{B}, I_{C}$, and $V_{C}$.


Figure E6.13
Ans. $0.93 \mathrm{~mA} ; 18.2 \mu \mathrm{~A} ; 0.91 \mathrm{~mA} ;+5.45 \mathrm{~V}$
6.14 In the circuit shown in Fig. E6.14, measurement indicates $V_{B}$ to be +1.0 V and $V_{E}$ to be +1.7 V . What are $\alpha$ and $\beta$ for this transistor? What voltage $V_{C}$ do you expect at the collector?


Figure E6. 14

Ans. $0.994 ; 165 ;-1.75 \mathrm{~V}$

# 6.2.2 Graphical Representation of Transistor Characteristics 

It is sometimes useful to describe the transistor $i-v$ characteristics graphically. Figure 6.16 shows the $i_{C}-v_{B E}$ characteristic, which is the exponential relationship

$$
i_{C}=I_{S} e^{v_{B E} / V_{T}}
$$

which is identical to the diode $i-v$ relationship. The $i_{E}-v_{B E}$ and $i_{B}-v_{B E}$ characteristics are also exponential but with different scale currents: $I_{S} / \alpha$ for $i_{E}$, and $I_{S} / \beta$ for $i_{B}$. Since the constant of the exponential characteristic, $1 / V_{T}$, is quite high $(\simeq 40)$, the curve rises very sharply. For $v_{B E}$ smaller than about 0.5 V , the current is negligibly small. ${ }^{7}$ Also, over most of the normal current range $v_{B E}$ lies in the range of 0.6 V to 0.8 V . In performing rapid first-order dc calculations, we normally will assume that $V_{B E} \simeq 0.7 \mathrm{~V}$, which is similar to the approach used in the analysis of diode circuits (Chapter 4). For a pnp transistor, the $i_{C}-v_{E B}$ characteristic will look identical to that of Fig. 6.16 with $v_{B E}$ replaced with $v_{E B}$.

[^0]
[^0]:    ${ }^{7}$ The $i_{C}-v_{B E}$ characteristic is the BJT's counterpart of the $i_{D}-v_{G S}$ characteristic of the MOSFET. They share an important attribute: In both cases the voltage has to exceed a "threshold" for the device to conduct appreciably. In the case of the MOSFET, there is a formal threshold voltage, $V_{t}$, which lies typically in the range of 0.4 V to 0.8 V . For the BJT, there is an "apparent threshold" of approximately 0.5 V . The $i_{D}-v_{G S}$ characteristic of the MOSFET is parabolic, and thus is less steep than the $i_{C}-v_{B E}$ characteristic of the BJT. As will be seen in Chapter 7, this difference has a direct and significant implication for the value of transconductance $g_{m}$ realized with each device.


Figure 6.16 The $i_{C}-v_{B E}$ characteristic for an $n p n$ transistor.


Figure 6.17 Effect of temperature on the $i_{C}-v_{B E}$ characteristic. At a constant emitter current (broken line), $v_{B E}$ changes by $-2 \mathrm{mV} /{ }^{\circ} \mathrm{C}$.

As in silicon diodes, the voltage across the emitter-base junction decreases by about 2 mV for each rise of $1^{\circ} \mathrm{C}$ in temperature, provided the junction is operating at a constant current. Figure 6.17 illustrates this temperature dependence by depicting $i_{C}-v_{B E}$ curves for an $n p n$ transistor at three different temperatures.

# EXERCISE 

6.15 Consider a $p n p$ transistor with $v_{E B}=0.7 \mathrm{~V}$ at $i_{E}=1 \mathrm{~mA}$. Let the base be grounded, the emitter be fed by a $2-\mathrm{mA}$ constant-current source, and the collector be connected to a $-5-\mathrm{V}$ supply through a $1-\mathrm{k} \Omega$ resistance. If the temperature increases by $30^{\circ} \mathrm{C}$, find the changes in emitter and collector voltages. Neglect the effect of $I_{C B O}$.
Ans. $-60 \mathrm{mV} ; 0 \mathrm{~V}$

### 6.2.3 Dependence of $i_{C}$ on the Collector Voltage—The Early Effect

When operated in the active region, practical BJTs show some dependence of the collector current on the collector voltage, with the result that, unlike the graph shown in Fig. 6.8, their $i_{C}-v_{C B}$ characteristics are not perfectly horizontal straight lines. To see this dependence more


Figure 6.18 (a) Conceptual circuit for measuring the $i_{C}-v_{C E}$ characteristics of the BJT. (b) The $i_{C}-v_{C E}$ characteristics of a practical BJT.
clearly, consider the conceptual circuit shown in Fig. 6.18(a). The transistor is connected in the common-emitter configuration; that is, here the emitter serves as a common terminal between the input and output ports. The voltage $V_{B E}$ can be set to any desired value by adjusting the dc source connected between base and emitter. At each value of $V_{B E}$, the corresponding $i_{C}-v_{C E}$ characteristic curve can be measured point by point by varying the dc source connected between collector and emitter and measuring the corresponding collector current. The result is the family of $i_{C}-v_{C E}$ characteristic curves shown in Fig. 6.18(b) and known as common-emitter characteristics.

At low values of $v_{C E}$ (lower than about 0.3 V ), as the collector voltage goes below that of the base by more than 0.4 V , the collector-base junction becomes forward biased and the transistor leaves the active mode and enters the saturation mode. Shortly, we shall look at the details of the $i_{C}-v_{C E}$ curves in the saturation region. At this time, however, we wish to examine the characteristic curves in the active region in detail. We observe that the characteristic curves, though still straight lines, have finite slope. In fact, when extrapolated, the characteristic lines meet at a point on the negative $v_{C E}$ axis, at $v_{C E}=-V_{A}$. The voltage $V_{A}$, a positive number, is a parameter for the particular BJT, with typical values in the range of 10 V to 100 V . As noted earlier, it is called the Early voltage, after J. M. Early, the engineering scientist who first studied this phenomenon.

At a given value of $v_{B E}$, increasing $v_{C E}$ increases the reverse-bias voltage on the collector-base junction, and thus increases the width of the depletion region of this junction (refer to Fig. 6.4). This in turn results in a decrease in the effective base width $W$. Recalling that $I_{S}$ is inversely proportional to $W$ (Eq. 6.13), we see that $I_{S}$ will increase and that $i_{C}$ increases proportionally. This is the Early effect. For obvious reasons, it is also known as the base-width modulation effect. ${ }^{8}$

[^0]
[^0]:    ${ }^{8}$ Recall that the MOSFET's counterpart is the channel-length modulation effect. These two effects are remarkably similar and have been assigned the same name, Early effect.
The linear dependence of $i_{C}$ on $v_{C E}$ can be explicitly accounted for by assuming that $I_{S}$ remains constant and including the factor $\left(1+v_{C E} / V_{A}\right)$ in the equation for $i_{C}$ as follows:

$$
i_{C}=I_{S} e^{v_{B E} / v_{T}}\left(1+\frac{v_{C E}}{V_{A}}\right)
$$

The nonzero slope of the $i_{C}-v_{C E}$ straight lines indicates that the output resistance looking into the collector is not infinite. Rather, it is finite and defined by

$$
r_{o} \equiv\left[\left.\frac{\partial i_{C}}{\partial v_{C E}}\right|_{v_{B E}=\text { constant }}\right]^{-1}
$$

Using Eq. (6.18) we can show that

$$
r_{o}=\frac{V_{A}+V_{C E}}{I_{C}}
$$

where $I_{C}$ and $V_{C E}$ are the coordinates of the point at which the BJT is operating on the particular $i_{C}-v_{C E}$ curve (i.e., the curve obtained for $v_{B E}$ equal to constant value $V_{B E}$ at which Eq. (6.19) is evaluated). Alternatively, we can write

$$
r_{o}=\frac{V_{A}}{I_{C}^{\prime}}
$$

where $I_{C}^{\prime}$ is the value of the collector current with the Early effect neglected; that is,

$$
I_{C}^{\prime}=I_{S} e^{v_{B E} / v_{T}}
$$

It is rarely necessary to include the dependence of $i_{C}$ on $v_{C E}$ in dc bias design and analysis that is performed by hand. Such an effect, however, can be easily included in the SPICE simulation of circuit operation, which is frequently used to "fine-tune" pencil-and-paper analysis or design.

The finite output resistance $r_{o}$ can have a significant effect on the gain of transistor amplifiers. This is particularly the case in integrated-circuit amplifiers, as will be shown in Chapter 8. Fortunately, there are many situations in which $r_{o}$ can be included relatively easily in pencil-and-paper analysis.

The output resistance $r_{o}$ can be included in the circuit model of the transistor. ${ }^{9}$ This is illustrated in Fig. 6.19, where we show the two large-signal circuit models of a


Figure 6.19 Large-signal, equivalent-circuit models of an $n p n$ BJT operating in the active mode in the common-emitter configuration with the output resistance $r_{o}$ included.

[^0]
[^0]:    ${ }^{9}$ In applying Eq. (6.21) to determine $r_{o}$ we will usually drop the prime and simply use $r_{o}=V_{A} / I_{C}$ where $I_{C}$ is the collector current without the Early effect.
common-emitter npn transistor operating in the active mode, those in Fig 6.5(c) and (d), with the resistance $r_{o}$ connected between the collector and the emitter terminals.

# EXERCISES 

6.16 Use the circuit model in Fig. 6.19(a) to express $i_{C}$ in terms of $e^{r_{B E} / V_{F}}$ and $v_{C E}$ and thus show that this circuit is a direct representation of Eq. (6.18).
6.17 Find the output resistance of a BJT for which $V_{A}=100 \mathrm{~V}$ at $I_{C}=0.1,1$, and 10 mA . Ans. $1 \mathrm{M} \Omega ; 100 \mathrm{k} \Omega ; 10 \mathrm{k} \Omega$
6.18 Consider the circuit in Fig. 6.18(a). At $V_{C E}=1 \mathrm{~V}, V_{B E}$ is adjusted to yield a collector current of 1 mA . Then, while $V_{B E}$ is kept constant, $V_{C E}$ is raised to 11 V . Find the new value of $I_{C}$. For this transistor, $V_{A}=100 \mathrm{~V}$.
Ans. 1.1 mA

### 6.2.4 An Alternative Form of the Common-Emitter Characteristics

An alternative way of expressing the transistor common-emitter characteristics is illustrated in Fig. 6.20. Here the base current $i_{B}$ rather than the base-emitter voltage $v_{B E}$ is used as a parameter. That is, each $i_{C}-v_{C E}$ curve is measured with the base fed with a constant current $I_{B}$. The resulting characteristics, shown in Fig. 6.20(b), look similar to those in Fig. 6.18. Figure 6.20(c) shows an expanded view of the characteristics in the saturation region.

The Common-Emitter Current Gain $\beta$ In the active region of the characteristics shown in Fig. 6.20(b) we have identified a particular point Q. Note that this operating point for the transistor is characterized by a base current $I_{B}$, a collector current $I_{C}$, and a collector-emitter voltage $V_{C E}$. The ratio $I_{C} / I_{B}$ is the transistor $\beta$. However, there is another way to measure $\beta$ : change the base current by an increment $\Delta i_{B}$ and measure the resulting increment $\Delta i_{C}$, while keeping $V_{C E}$ constant. This is illustrated in Fig. 6.20(b). The ratio $\Delta i_{C} / \Delta i_{B}$ should, according to our study thus far, yield an identical value for $\beta$. It turns out, however, that the latter value of $\beta$ (called incremental, or ac, $\beta$ ) is a little different from the dc $\beta$ (i.e., $I_{C} / I_{B}$ ). Such a distinction, however, is too subtle for our needs in this book. We shall use $\beta$ to denote both dc and incremental values. ${ }^{10}$

The Saturation Voltage $V_{C E \text { sat }}$ and Saturation Resistance $R_{C E \text { sat }}$ Refer next to the expanded view of the common-emitter characteristics in the saturation region shown in Fig. 6.20(c). The "bunching together" of the curves in the saturation region implies that the incremental $\beta$ is lower there than in the active region. A possible operating point in the saturation region is that labeled X. It is characterized by a base current $I_{B}$, a collector current $I_{C \text { sat }}$, and a collector-emitter voltage $V_{C E \text { sat }}$. From our previous discussion of saturation, recall that $I_{C \text { sat }}=\beta_{\text {forced }} I_{B}$, where $\beta_{\text {forced }}<\beta$.

[^0]
[^0]:    ${ }^{10}$ Manufacturers of bipolar transistors use $h_{F E}$ to denote the dc value of $\beta$ and $h_{m}$ to denote the incremental $\beta$. These symbols come from the $h$-parameter description of two-port networks (see Appendix C), with the subscript $F(f)$ denoting forward and $E(e)$ denoting common emitter.


Figure 6.20 Common-emitter characteristics. (a) Basic CE circuit; note that in (b) the horizontal scale is expanded around the origin to show the saturation region in some detail. A much greater expansion of the saturation region is shown in (c).

The $i_{C}-v_{C E}$ curves in saturation are rather steep, indicating that the saturated transistor exhibits a low collector-to-emitter resistance $R_{C E \text { sat }}$,

$$
R_{C E \text { sat }} \equiv\left.\frac{\partial v_{C E}}{\partial i_{C}}\right|_{\substack{i_{B}=i_{B} \\ i_{C}=i_{C \text { sat }}}}
$$

Typically, $R_{C E \text { sat }}$ ranges from a few ohms to a few tens of ohms.


Figure 6.21 A simplified equivalent-circuit model of the saturated transistor.

That the collector-to-emitter resistance of a saturated BJT is small should have been anticipated from the fact that between C and E we now have two forward-conducting diodes in series ${ }^{11}$ (see also Fig. 6.9).

A simple model for the saturated BJT is shown in Fig. 6.21. Here $V_{B E}$ is assumed constant (approximately 0.7 V ) and $V_{C E}$ also is assumed constant, $V_{C E \text { sat }} \simeq 0.2 \mathrm{~V}$. That is, we have neglected the small saturation resistance $R_{C E \text { sat }}$ for the sake of making the model simple for hand calculations.

# Example 6.3 

For the circuit in Fig. 6.22, it is required to determine the value of the voltage $V_{B B}$ that results in the transistor operating
(a) in the active mode with $V_{C E}=5 \mathrm{~V}$
(b) at the edge of saturation
(c) deep in saturation with $\beta_{\text {forced }}=10$

For simplicity, assume that $V_{B E}$ remains constant at 0.7 V . The transistor $\beta$ is specified to be 50 .


Figure 6.22 Circuit for Example 6.3.

[^0]
[^0]:    ${ }^{11}$ In the corresponding mode of operation for the MOSFET, the triode region, the resistance between drain and source is small because it is the resistance of the continuous (non-pinched-off) channel.# Example 6.3 continued 

## Solution

(a) To operate in the active mode with $V_{C E}=5 \mathrm{~V}$,

$$
\begin{aligned}
I_{C} & =\frac{V_{C C}-V_{C E}}{R_{C}} \\
& =\frac{10-5}{1 \mathrm{k} \Omega}=5 \mathrm{~mA} \\
I_{B} & =\frac{I_{C}}{\beta}=\frac{5}{50}=0.1 \mathrm{~mA}
\end{aligned}
$$

Now the required value of $V_{B B}$ can be found as follows:

$$
\begin{aligned}
V_{B B} & =I_{B} R_{B}+V_{B E} \\
& =0.1 \times 10+0.7=1.7 \mathrm{~V}
\end{aligned}
$$

(b) Operation at the edge of saturation is obtained with $V_{C E}=0.3 \mathrm{~V}$. Thus

$$
I_{C}=\frac{10-0.3}{1}=9.7 \mathrm{~mA}
$$

Since, at the edge of saturation, $I_{C}$ and $I_{B}$ are still related by $\beta$,

$$
I_{B}=\frac{9.7}{50}=0.194 \mathrm{~mA}
$$

The required value of $V_{B B}$ can be determined as

$$
V_{B B}=0.194 \times 10+0.7=2.64 \mathrm{~V}
$$

(c) To operate deep in saturation,

$$
V_{C E}=V_{C E s a t} \simeq 0.2 \mathrm{~V}
$$

Thus,

$$
I_{C}=\frac{10-0.2}{1}=9.8 \mathrm{~mA}
$$

We then use the value of forced $\beta$ to determine the required value of $I_{B}$ as

$$
I_{B}=\frac{I_{C}}{\beta_{\text {forced }}}=\frac{9.8}{10}=0.98 \mathrm{~mA}
$$

and the required $V_{B B}$ can now be found as

$$
V_{B B}=0.98 \times 10+0.7=10.5 \mathrm{~V}
$$

Observe that once the transistor is in saturation, increasing $V_{B B}$ and thus $I_{B}$ results in negligible change in $I_{C}$ since $V_{C E s a t}$ will change only slightly. Thus $I_{C}$ is said to saturate, which is the origin of the name "saturation mode of operation."
# EXERCISES 

6.19 Repeat Example 6.3 for $R_{C}=10 \mathrm{k} \Omega$.

Ans. $0.8 \mathrm{~V} ; 0.894 \mathrm{~V} ; 1.68 \mathrm{~V}$
6.20 For the circuit in Fig. 6.22, find $V_{C E}$ for $V_{B B}=0 \mathrm{~V}$.

Ans. +10 V
6.21 For the circuit in Fig. 6.22, let $V_{B B}$ be set to the value obtained in Example 6.3, part (a), namely, $V_{B B}=1.7 \mathrm{~V}$. Verify that the transistor is indeed operating in the active mode. Now, while keeping $V_{B B}$ constant, find the value to which $R_{C}$ should be increased in order to obtain (a) operation at the edge of saturation and (b) operation deep in saturation with $\beta_{\text {forced }}=10$.
Ans. (a) $1.94 \mathrm{k} \Omega$; (b) $9.8 \mathrm{k} \Omega$

### 6.3 BJT Circuits at DC

We are now ready to consider the analysis of BJT circuits to which only dc voltages are applied. In the following examples we will use the simple model in which $\left|V_{B E}\right|$ of a conducting transistor is 0.7 V and $\left|V_{C E}\right|$ of a saturated transistor is 0.2 V , and we will neglect the Early effect. These models are shown in Table 6.3. Better models can, of course, be used to obtain more accurate results. This, however, is usually achieved at the expense of speed of analysis; more importantly, the attendant complexity could impede the circuit designer's ability to gain insight regarding circuit behavior. Accurate results using elaborate models can be obtained using circuit simulation with SPICE. This is almost always done in the final stages of a design and certainly before circuit fabrication. Computer simulation, however, is not a substitute for quick pencil-and-paper circuit analysis, an essential ability that aspiring circuit designers must master. The following series of examples is a step in that direction.

As will be seen, in analyzing a circuit the first question that one must answer is: In which mode is the transistor operating? In some cases, the answer will be obvious. For instance, a quick check of the terminal voltages will indicate whether the transistor is cut off or conducting. If it is conducting, we have to determine whether it is operating in the active mode or in saturation. In some cases, however, this may not be obvious. Needless to say, as the reader gains practice and experience in transistor circuit analysis and design, the answer will be apparent in a much larger proportion of problems. The answer, however, can always be determined by utilizing the following procedure.

Assume that the transistor is operating in the active mode and, using the active-mode model in Table 6.3, proceed to determine the various voltages and currents that correspond. Then check for consistency of the results with the assumption of active-mode operation; that is, is $V_{C B}$ of an $n p n$ transistor greater than -0.4 V (or $V_{C B}$ of a $p n p$ transistor lower than 0.4 V )? If the answer is yes, then our task is complete. If the answer is no, assume saturation-mode operation and, using the saturation-mode model in Table 6.3, proceed to determine currents and voltages
Table 6.3 Simplified Models for the Operation of the BJT in DC Circuits

and then check for consistency of the results with the assumption of saturation-mode operation. Here the test is usually to compute the ratio $I_{C} / I_{B}$ and to verify that it is lower than the transistor $\beta$ (i.e., $\beta_{\text {forced }}<\beta$ ). Since $\beta$ for a given transistor type varies over a wide range, ${ }^{12}$ one must use the lowest specified $\beta$ for this test. Finally, note that the order of these two assumptions can be reversed.

A Note on Units Except when otherwise specified, throughout this book we use a consistent set of units, namely, volts (V), milliamps (mA), and kilohms (k $\Omega$ ).

[^0]
[^0]:    ${ }^{12}$ That is, if one buys BJTs of a certain part number, the manufacturer guarantees only that their values of $\beta$ fall within a certain range, say 50 to 150 .
# Example 6.4 

Consider the circuit shown in Fig. 6.23(a), which is redrawn in Fig. 6.23(b) to remind the reader of the convention employed throughout this book for indicating connections to dc sources. We wish to analyze this circuit to determine all node voltages and branch currents. We will assume that $\beta$ is specified to be 100 .


Figure 6.23 Analysis of the circuit for Example 6.4: (a) circuit; (b) circuit redrawn to remind the reader of the convention used in this book to show connections to the dc sources; (c) analysis with the steps numbered.
# Example 6.4 continued 

## Solution

Glancing at the circuit in Fig. 6.23(a), we note that the base is connected to +4 V and the emitter is connected to ground through a resistance $R_{E}$. Therefore, it is reasonable to conclude that the base-emitter junction will be forward biased. Assuming that this is the case and assuming that $V_{B E}$ is approximately 0.7 V , it follows that the emitter voltage will be

$$
V_{E}=4-V_{B E} \simeq 4-0.7=3.3 \mathrm{~V}
$$

We are now in an opportune position; we know the voltages at the two ends of $R_{E}$ and thus can determine the current $I_{E}$ through it,

$$
I_{E}=\frac{V_{E}-0}{R_{E}}=\frac{3.3}{3.3}=1 \mathrm{~mA}
$$

Since the collector is connected through $R_{C}$ to the $+10-\mathrm{V}$ power supply, it appears possible that the collector voltage will be higher than the base voltage, which implies active-mode operation. Assuming that this is the case, we can evaluate the collector current from

$$
I_{C}=\alpha I_{E}
$$

The value of $\alpha$ is obtained from

$$
\alpha=\frac{\beta}{\beta+1}=\frac{100}{101} \simeq 0.99
$$

Thus $I_{C}$ will be given by

$$
I_{C}=0.99 \times 1=0.99 \mathrm{~mA}
$$

We are now in a position to use Ohm's law to determine the collector voltage $V_{C}$,

$$
V_{C}=10-I_{C} R_{C}=10-0.99 \times 4.7 \simeq+5.3 \mathrm{~V}
$$

Since the base is at +4 V , the collector-base junction is reverse biased by 1.3 V , and the transistor is indeed in the active mode as assumed.

It remains only to determine the base current $I_{B}$, as follows:

$$
I_{B}=\frac{I_{E}}{\beta+1}=\frac{1}{101} \simeq 0.01 \mathrm{~mA}
$$

Before leaving this example, we wish to emphasize strongly the value of carrying out the analysis directly on the circuit diagram. Only in this way will one be able to analyze complex circuits in a reasonable length of time. Figure 6.23(c) illustrates the above analysis on the circuit diagram, with the order of the analysis steps indicated by the circled numbers.
# Example 6.5 

We wish to analyze the circuit of Fig. 6.24(a) to determine the voltages at all nodes and the currents through all branches. Note that this circuit is identical to that of Fig. 6.23 except that the voltage at the base is now +6 V . Assume that the transistor $\beta$ is specified to be at least 50 .


Figure 6.24 Analysis of the circuit for Example 6.5. Note that the circled numbers indicate the order of the analysis steps.
# Example 6.5 continued 

## Solution

With +6 V at the base, the base-emitter junction will be forward biased; thus,

$$
V_{E}=+6-V_{B E} \simeq 6-0.7=5.3 \mathrm{~V}
$$

and

$$
I_{E}=\frac{5.3}{3.3}=1.6 \mathrm{~mA}
$$

Now, assuming active-mode operation, $I_{C}=\alpha I_{E} \simeq I_{E}$; thus,

$$
V_{C}=+10-4.7 \times I_{C} \simeq 10-7.52=2.48 \mathrm{~V}
$$

The details of the analysis performed above are illustrated in Fig. 6.24(b).
Since the collector voltage calculated is less than the base voltage by 3.52 V , it follows that our original assumption of active-mode operation is incorrect. In fact, the transistor has to be in the saturation mode. Assuming this to be the case, the values of $V_{E}$ and $I_{E}$ will remain unchanged. The collector voltage, however, becomes

$$
V_{C}=V_{E}+V_{C E \text { sat }} \simeq 5.3+0.2=+5.5 \mathrm{~V}
$$

from which we can determine $I_{C}$ as

$$
I_{C}=\frac{10-5.5}{4.7}=0.96 \mathrm{~mA}
$$

and $I_{B}$ can now be found as

$$
I_{B}=I_{E}-I_{C}=1.6-0.96=0.64 \mathrm{~mA}
$$

Thus the transistor is operating at a forced $\beta$ of

$$
\beta_{\text {forced }}=\frac{I_{C}}{I_{B}}=\frac{0.96}{0.64}=1.5
$$

Since $\beta_{\text {forced }}$ is less than the minimum specified value of $\beta$, the transistor is indeed saturated. We should emphasize here that in testing for saturation the minimum value of $\beta$ should be used. By the same token, if we are designing a circuit in which a transistor is to be saturated, the design should be based on the minimum specified $\beta$. Obviously, if a transistor with this minimum $\beta$ is saturated, then transistors with higher values of $\beta$ will also be saturated. The details of the analysis are shown in Fig. 6.24(c), where the order of the steps used is indicated by the circled numbers.
# Example 6.6 

We wish to analyze the circuit in Fig. 6.25(a) to determine the voltages at all nodes and the currents through all branches. Note that this circuit is identical to that considered in Examples 6.4 and 6.5 except that now the base voltage is zero.


Figure 6.25 Example 6.6: (a) circuit; (b) analysis, with the order of the analysis steps indicated by circled numbers.

## Solution

Since the base is at zero volts and the emitter is connected to ground through $R_{E}$, the base-emitter junction cannot conduct and the emitter current is zero. Also, the collector-base junction cannot conduct, since the $n$-type collector is connected through $R_{C}$ to the positive power supply while the $p$-type base is at ground. It follows that the collector current will be zero. The base current will also have to be zero, and the transistor is in the cutoff mode of operation.

The emitter voltage will be zero, while the collector voltage will be equal to +10 V , since the voltage drops across $R_{E}$ and $R_{C}$ are zero. Figure 6.25 (b) shows the analysis details.

## EXERCISES

D6.22 For the circuit in Fig. 6.23(a), find the highest voltage to which the base can be raised while the transistor remains in the active mode. Assume $\alpha \simeq 1$.
Ans. $+4.7 \mathrm{~V}$
D6.23 Redesign the circuit of Fig. 6.23(a) (i.e., find new values for $R_{E}$ and $R_{C}$ ) to establish a collector current of 0.5 mA and a reverse-bias voltage on the collector-base junction of 2 V . Assume $\alpha \simeq 1$.
Ans. $R_{E}=6.6 \mathrm{k} \Omega ; R_{C}=8 \mathrm{k} \Omega$
D6.24 For the circuit in Fig. 6.24(a), find the value to which the base voltage should be changed so that the transistor operates in saturation with a forced $\beta$ of 5 .
Ans. +5.18 V

# Example 6.7 

We want to analyze the circuit of Fig. 6.26(a) to determine the voltages at all nodes and the currents through all branches.


Figure 6.26 Example 6.7: (a) circuit; (b) analysis, with the steps indicated by circled numbers.

## Solution

The base of this pnp transistor is grounded, while the emitter is connected to a positive supply $\left(V^{+}=+10 \mathrm{~V}\right)$ through $R_{E}$. It follows that the emitter-base junction will be forward biased with

$$
V_{E}=V_{E B} \simeq 0.7 \mathrm{~V}
$$

Thus the emitter current will be given by

$$
I_{E}=\frac{V^{+}-V_{E}}{R_{E}}=\frac{10-0.7}{2}=4.65 \mathrm{~mA}
$$
Since the collector is connected to a negative supply (more negative than the base voltage) through $R_{C}$, it is possible that this transistor is operating in the active mode. Assuming this to be the case, we obtain

$$
I_{C}=\alpha I_{E}
$$

Since no value for $\beta$ has been given, we shall assume $\beta=100$, which results in $\alpha=0.99$. Since large variations in $\beta$ result in small differences in $\alpha$, this assumption will not be critical as far as determining the value of $I_{C}$ is concerned. Thus,

$$
I_{C}=0.99 \times 4.65=4.6 \mathrm{~mA}
$$

The collector voltage will be

$$
\begin{aligned}
V_{C} & =V^{-}+I_{C} R_{C} \\
& =-10+4.6 \times 1=-5.4 \mathrm{~V}
\end{aligned}
$$

Thus the collector-base junction is reverse biased by 5.4 V , and the transistor is indeed in the active mode, which supports our original assumption.

It remains only to calculate the base current,

$$
I_{B}=\frac{I_{E}}{\beta+1}=\frac{4.65}{101} \simeq 0.05 \mathrm{~mA}
$$

Obviously, the value of $\beta$ critically affects the base current. Note, however, that in this circuit the value of $\beta$ will have no effect on the mode of operation of the transistor. Since $\beta$ is generally an ill-specified parameter, this circuit represents a good design. As a rule, one should strive to design the circuit such that its performance is as insensitive to the value of $\beta$ as possible. The analysis details are illustrated in Fig. 6.26(b).

# EXERCISES 

D6.25 For the circuit in Fig. 6.26(a), find the largest value to which $R_{C}$ can be raised while the transistor remains in the active mode.
Ans. $2.26 \mathrm{k} \Omega$
D6.26 Redesign the circuit of Fig. 6.26(a) (i.e., find new values for $R_{E}$ and $R_{C}$ ) to establish a collector current of 1 mA and a reverse bias on the collector-base junction of 4 V . Assume $\alpha \simeq 1$.
Ans. $R_{E}=9.3 \mathrm{k} \Omega ; R_{C}=6 \mathrm{k} \Omega$# Example 6.8 

We want to analyze the circuit in Fig. 6.27(a) to determine the voltages at all nodes and the currents in all branches. Assume $\beta=100$.


Figure 6.27 Example 6.8: (a) circuit; (b) analysis, with the steps indicated by the circled numbers.

## Solution

The base-emitter junction is clearly forward biased. Thus,

$$
I_{B}=\frac{+5-V_{B E}}{R_{B}} \simeq \frac{5-0.7}{100}=0.043 \mathrm{~mA}
$$

Assume that the transistor is operating in the active mode. We now can write

$$
I_{C}=\beta I_{B}=100 \times 0.043=4.3 \mathrm{~mA}
$$

The collector voltage can now be determined as

$$
V_{C}=10-I_{C} R_{C}=10-4.3 \times 2=+1.4 \mathrm{~V}
$$

Since the base voltage $V_{B}$ is

$$
V_{B}=V_{B E} \simeq+0.7 \mathrm{~V}
$$

it follows that the collector-base junction is reverse biased by 0.7 V and the transistor is indeed in the active mode. The emitter current will be given by

$$
I_{E}=(\beta+1) I_{B}=101 \times 0.043 \simeq 4.3 \mathrm{~mA}
$$

We note from this example that the collector and emitter currents depend critically on the value of $\beta$. In fact, if $\beta$ were $10 \%$ higher, the transistor would leave the active mode and enter saturation. Therefore this clearly is a bad design. The analysis details are illustrated in Fig. 6.27(b).
# EXERCISE 

D6.27 The circuit of Fig. 6.27(a) is to be fabricated using a transistor type whose $\beta$ is specified to be in the range of 50 to 150 . That is, individual units of this same transistor type can have $\beta$ values anywhere in this range. Redesign the circuit by selecting a new value for $R_{C}$ so that all fabricated circuits are guaranteed to be in the active mode. What is the range of collector voltages that the fabricated circuits may exhibit?
Ans. $R_{C}=1.5 \mathrm{k} \Omega ; V_{C}=0.3 \mathrm{~V}$ to 6.8 V

## Example 6.9

We want to analyze the circuit of Fig. 6.28(a) to determine the voltages at all nodes and the currents through all branches. The minimum value of $\beta$ is specified to be 30 .


Figure 6.28 Example 6.9: (a) circuit; (b) analysis with steps numbered.

## Solution

A quick glance at this circuit reveals that the transistor will be either active or saturated. Assuming active-mode operation and neglecting the base current, we see that the base voltage will be approximately zero volts, the emitter voltage will be approximately +0.7 V , and the emitter current will be approximately 4.3 mA . Since the maximum current that the collector can support while the transistor remains in the active mode is approximately 0.5 mA , it follows that the transistor is definitely saturated.
# Example 6.9 continued 

Assuming that the transistor is saturated and denoting the voltage at the base by $V_{B}$ (refer to Fig. 6.28b), it follows that

$$
\begin{aligned}
V_{E} & =V_{B}+V_{E B} \simeq V_{B}+0.7 \\
V_{C} & =V_{E}-V_{E C \text { sat }} \simeq V_{B}+0.7-0.2=V_{B}+0.5 \\
I_{E} & =\frac{+5-V_{C}}{1}=\frac{5-V_{B}-0.7}{1}=4.3-V_{B} \mathrm{~mA} \\
I_{B} & =\frac{V_{B}}{10}=0.1 V_{B} \mathrm{~mA} \\
I_{C} & =\frac{V_{C}-(-5)}{10}=\frac{V_{B}+0.5+5}{10}=0.1 V_{B}+0.55 \mathrm{~mA}
\end{aligned}
$$

Using the relationship $I_{E}=I_{B}+I_{C}$, we obtain

$$
4.3-V_{B}=0.1 V_{B}+0.1 V_{B}+0.55
$$

which results in

$$
V_{B}=\frac{3.75}{1.2} \simeq 3.13 \mathrm{~V}
$$

Substituting in the equations above, we obtain

$$
\begin{aligned}
V_{E} & =3.83 \mathrm{~V} \\
V_{C} & =3.63 \mathrm{~V} \\
I_{E} & =1.17 \mathrm{~mA} \\
I_{C} & =0.86 \mathrm{~mA} \\
I_{B} & =0.31 \mathrm{~mA}
\end{aligned}
$$

from which we see that the transistor is saturated, since the value of forced $\beta$ is

$$
\beta_{\text {forced }}=\frac{0.86}{0.31} \simeq 2.8
$$

which is much smaller than the specified minimum $\beta$.

## Example 6.10

We want to analyze the circuit of Fig. 6.29(a) to determine the voltages at all nodes and the currents through all branches. Assume $\beta=100$.


Figure 6.29 Circuits for Example 6.10.

# Solution 

The first step in the analysis consists of simplifying the base circuit using Thévenin's theorem. The result is shown in Fig. 6.29(b), where

$$
\begin{aligned}
& V_{B B}=+15 \frac{R_{B 2}}{R_{B 1}+R_{B 2}}=15 \frac{50}{100+50}=+5 \mathrm{~V} \\
& R_{B B}=R_{B 1}\left\|R_{B 2}=100\right\| 50=33.3 \mathrm{k} \Omega
\end{aligned}
$$
# Example 6.10 continued 

To evaluate the base or the emitter current, we have to write a loop equation around the loop labeled L in Fig. 6.29(b). Note, however, that the current through $R_{B B}$ is different from the current through $R_{E}$. The loop equation will be

$$
V_{B B}=I_{B} R_{B B}+V_{B E}+I_{E} R_{E}
$$

Now, assuming active-mode operation, we replace $I_{B}$ with

$$
I_{B}=\frac{I_{E}}{\beta+1}
$$

and rearrange the equation to obtain

$$
I_{E}=\frac{V_{B B}-V_{B E}}{R_{E}+\left[R_{B B} /(\beta+1)\right]}
$$

For the numerical values given we have

$$
I_{E}=\frac{5-0.7}{3+(33.3 / 101)}=1.29 \mathrm{~mA}
$$

The base current will be

$$
I_{B}=\frac{1.29}{101}=0.0128 \mathrm{~mA}
$$

The base voltage is given by

$$
\begin{aligned}
V_{B} & =V_{B E}+I_{E} R_{E} \\
& =0.7+1.29 \times 3=4.57 \mathrm{~V}
\end{aligned}
$$

We can evaluate the collector current as

$$
I_{C}=\alpha I_{E}=0.99 \times 1.29=1.28 \mathrm{~mA}
$$

The collector voltage can now be evaluated as

$$
V_{C}=+15-I_{C} R_{C}=15-1.28 \times 5=8.6 \mathrm{~V}
$$

It follows that the collector is higher in potential than the base by 4.03 V , which means that the transistor is in the active mode, as had been assumed. The results of the analysis are given in Fig. 6.29(c, d).

## EXERCISE

6.28 If the transistor in the circuit of Fig. 6.29(a) is replaced with another having half the value of $\beta$ (i.e., $\beta=50$ ), find the new value of $I_{C}$, and express the change in $I_{C}$ as a percentage.
Ans. $I_{C}=1.15 \mathrm{~mA} ;-10 \%$
# Example 6.11 

We wish to analyze the circuit in Fig. 6.30(a) to determine the voltages at all nodes and the currents through all branches.

(a)

(b)

Figure 6.30 Circuits for Example 6.11.
# Example 6.11 continued 

## Solution

We first recognize that part of this circuit is identical to the circuit we analyzed in Example 6.10 - namely, the circuit of Fig. 6.29(a). The difference, of course, is that in the new circuit we have an additional transistor $Q_{2}$ together with its associated resistors $R_{E 2}$ and $R_{C 2}$. Assume that $Q_{1}$ is still in the active mode. The following values will be identical to those obtained in the previous example:

$$
\begin{array}{ll}
V_{B 1}=+4.57 \mathrm{~V} & I_{E 1}=1.29 \mathrm{~mA} \\
I_{B 1}=0.0128 \mathrm{~mA} & I_{C 1}=1.28 \mathrm{~mA}
\end{array}
$$

However, the collector voltage will be different than previously calculated, since part of the collector current $I_{C 1}$ will flow in the base lead of $Q_{2}\left(I_{B 2}\right)$. As a first approximation we may assume that $I_{B 2}$ is much smaller than $I_{C 1}$; that is, we may assume that the current through $R_{C 1}$ is almost equal to $I_{C 1}$. This will enable us to calculate $V_{C 1}$ :

$$
\begin{aligned}
& V_{C 1} \simeq+15-I_{C 1} R_{C 1} \\
& =15-1.28 \times 5=+8.6 \mathrm{~V}
\end{aligned}
$$

Thus $Q_{1}$ is in the active mode, as had been assumed.
As far as $Q_{2}$ is concerned, we note that its emitter is connected to +15 V through $R_{E 2}$. It is therefore safe to assume that the emitter-base junction of $Q_{2}$ will be forward biased. Thus the emitter of $Q_{2}$ will be at a voltage $V_{E 2}$ given by

$$
V_{E 2}=V_{C 1}+\left.V_{E B}\right|_{Q_{2}} \simeq 8.6+0.7=+9.3 \mathrm{~V}
$$

The emitter current of $Q_{2}$ may now be calculated as

$$
I_{E 2}=\frac{+15-V_{E 2}}{R_{E 2}}=\frac{15-9.3}{2}=2.85 \mathrm{~mA}
$$

Since the collector of $Q_{2}$ is returned to ground via $R_{C 2}$, it is possible that $Q_{2}$ is operating in the active mode. Assume this to be the case. We now find $I_{C 2}$ as

$$
\begin{aligned}
I_{C 2} & =\alpha_{2} I_{E 2} \\
& =0.99 \times 2.85=2.82 \mathrm{~mA} \quad\left(\text { assuming } \beta_{2}=100\right)
\end{aligned}
$$

The collector voltage of $Q_{2}$ will be

$$
V_{C 2}=I_{C 2} R_{C 2}=2.82 \times 2.7=7.62 \mathrm{~V}
$$

which is lower than $V_{B 2}$ by 0.98 V . Thus $Q_{2}$ is in the active mode, as assumed.
It is important at this stage to find the magnitude of the error incurred in our calculations by the assumption that $I_{B 2}$ is negligible. The value of $I_{B 2}$ is given by

$$
I_{B 2}=\frac{I_{E 2}}{\beta_{2}+1}=\frac{2.85}{101}=0.028 \mathrm{~mA}
$$

which is indeed much smaller than $I_{C 1}(1.28 \mathrm{~mA})$. If desired, we can obtain more accurate results by iterating one more time, assuming $I_{B 2}$ to be 0.028 mA . The new values will be

$$
\begin{aligned}
\text { Current in } R_{C 1} & =I_{C 1}-I_{B 2}=1.28-0.028=1.252 \mathrm{~mA} \\
V_{C 1} & =15-5 \times 1.252=8.74 \mathrm{~V} \\
V_{E 2} & =8.74+0.7=9.44 \mathrm{~V} \\
I_{E 2} & =\frac{15-9.44}{2}=2.78 \mathrm{~mA} \\
I_{C 2} & =0.99 \times 2.78=2.75 \mathrm{~mA} \\
V_{C 2} & =2.75 \times 2.7=7.43 \mathrm{~V} \\
I_{B 2} & =\frac{2.78}{101}=0.0275 \mathrm{~mA}
\end{aligned}
$$

Note that the new value of $I_{B 2}$ is very close to the value used in our iteration, and no further iterations are warranted. The final results are indicated in Fig. 6.30(b).

The reader justifiably might be wondering about the necessity for using an iterative scheme in solving a linear (or linearized) problem. Indeed, we can obtain the exact solution (if we can call anything we are doing with a first-order model exact!) by writing appropriate equations. The reader is encouraged to find this solution and then compare the results with those obtained above. It is important to emphasize, however, that in most such problems it is quite sufficient to obtain an approximate solution, provided we can obtain it quickly and, of course, correctly.

In the above examples, we frequently used a precise value of $\alpha$ to calculate the collector current. Since $\alpha \simeq 1$, the error in such calculations will be very small if one assumes $\alpha=1$ and $I_{C}=I_{E}$. Therefore, except in calculations that depend critically on the value of $\alpha$ (e.g., the calculation of base current), one usually assumes $\alpha \simeq 1$.

# EXERCISES 

6.29 For the circuit in Fig. 6.30, find the total current drawn from the power supply. Hence find the power dissipated in the circuit.
Ans. $4.135 \mathrm{~mA} ; 62 \mathrm{~mW}$
6.30 The circuit in Fig. E6.30 is to be connected to the circuit in Fig. 6.30(a) as indicated; specifically, the base of $Q_{3}$ is to be connected to the collector of $Q_{2}$. If $Q_{3}$ has $\beta=100$, find the new value of $V_{C 2}$ and the values of $V_{E 3}$ and $I_{C 3}$.


Figure E6.30

Ans. $+7.06 \mathrm{~V} ;+6.36 \mathrm{~V} ; 13.4 \mathrm{~mA}$

# Example 6.12 

We desire to evaluate the voltages at all nodes and the currents through all branches in the circuit of Fig. 6.31(a). Assume $\beta=100$.


Figure 6.31 Example 6.12: (a) circuit; (b) analysis with the steps numbered.
# Solution 

By examining the circuit, we conclude that the two transistors $Q_{1}$ and $Q_{2}$ cannot be simultaneously conducting. Thus if $Q_{1}$ is on, $Q_{2}$ will be off, and vice versa. Assume that $Q_{2}$ is on. It follows that current will flow from ground through the $1-\mathrm{k} \Omega$ resistor into the emitter of $Q_{2}$. Thus the base of $Q_{2}$ will be at a negative voltage, and base current will be flowing out of the base through the $10-\mathrm{k} \Omega$ resistor and into the $+5-\mathrm{V}$ supply. This is impossible, since if the base is negative, current in the $10-\mathrm{k} \Omega$ resistor will have to flow into the base. Thus we conclude that our original assumption-that $Q_{2}$ is on-is incorrect. It follows that $Q_{2}$ will be off and $Q_{1}$ will be on.

The question now is whether $Q_{1}$ is active or saturated. The answer in this case is obvious: Since the base is fed with a $+5-\mathrm{V}$ supply and since base current flows into the base of $Q_{1}$, it follows that the base of $Q_{1}$ will be at a voltage lower than +5 V . Thus the collector-base junction of $Q_{1}$ is reverse biased and $Q_{1}$ is in the active mode. It remains only to determine the currents and voltages using techniques already described in detail. The results are given in Fig. 6.31(b).

## EXERCISES

6.31 Solve the problem in Example 6.12 for the case of a voltage of -5 V feeding the bases. What voltage appears at the emitters?
Ans. -3.9 V
6.32 Solve the problem in Example 6.12 with the voltage feeding the bases changed to +10 V . Assume that $\beta_{\min }=30$, and find $V_{E}, V_{B}, I_{C 1}$, and $I_{C 2}$.
Ans. $+4.8 \mathrm{~V} ;+5.5 \mathrm{~V} ; 4.35 \mathrm{~mA} ; 0$

### 6.4 Transistor Breakdown and Temperature Effects

We conclude this chapter with a brief discussion of two important nonideal effects in the BJT: voltage breakdown, and the dependence of $\beta$ on $I_{C}$ and temperature.

### 6.4.1 Transistor Breakdown

The maximum voltages that can be applied to a BJT are limited by the EBJ and CBJ breakdown effects that follow the avalanche multiplication mechanism described in Section 3.5.3. Consider first the common-base configuration (Fig. 6.32(a)). The $i_{C}-v_{C B}$ characteristics in Fig. 6.32(b) indicate that for $i_{E}=0$ (i.e., with the emitter open-circuited) the collector-base junction breaks down at a voltage denoted by $B V_{C B O}$. For $i_{E}>0$, breakdown occurs at voltages smaller than $B V_{C B O}$. Typically, for discrete BJTs, $B V_{C B O}$ is greater than 50 V .

Figure 6.32 The BJT common-base characteristics including the transistor breakdown region.


Figure 6.33 The BJT common-emitter characteristics including the breakdown region.

Next consider the common-emitter characteristics of Fig. 6.33, which show breakdown occurring at a voltage $B V_{C E O}$. Here, although breakdown is still of the avalanche type, the effects on the characteristics are more complex than in the common-base configuration. We will not explain these in detail; it is sufficient to point out that typically $B V_{C E O}$ is about half $B V_{C B O}$. On transistor data sheets, $B V_{C E O}$ is sometimes referred to as the sustaining voltage $L V_{C E O}$.
Breakdown of the CBJ in either the common-base or common-emitter configuration is not destructive as long as the power dissipation in the device is kept within safe limits. This, however, is not the case with the breakdown of the emitter-base junction. The EBJ breaks down in an avalanche manner at a voltage $B V_{E B O}$ much smaller than $B V_{C B O}$. Typically, $B V_{E B O}$ is in the range of 6 V to 8 V , and the breakdown is destructive in the sense that the $\beta$ of the transistor is permanently reduced. This does not prevent use of the EBJ as a zener diode to generate reference voltages in IC design. In such applications one is not concerned with the $\beta$-degradation effect. A circuit arrangement to prevent EBJ breakdown in IC amplifiers will be discussed in Chapter 13. Transistor breakdown and the maximum allowable power dissipation are important parameters in the design of power amplifiers (Chapter 12).

# EXERCISE 

6.33 What is the output voltage of the circuit in Fig. E6.33 if the transistor $B V_{B C O}=70 \mathrm{~V}$ ?


Figure E6.33

Ans. -60 V

### 6.4.2 Dependence of $\beta$ on $I_{C}$ and Temperature

Throughout this chapter we have assumed that the transistor common-emitter dc current gain, $\beta$ or $h_{F E}$, is constant for a given transistor. In fact, $\beta$ depends on the dc current at which the transistor is operating, as shown in Fig. 6.34. The physical processes that give rise to this dependence are beyond the scope of this book. Note, however, that there is a current range over which $\beta$ is highest. Normally, one arranges to operate the transistor at a current within this range.

Figure 6.34 also shows the dependence of $\beta$ on temperature. The fact that $\beta$ increases with temperature can lead to serious problems in transistors that operate at large power levels (see Chapter 12).


Figure 6.34 Typical dependence of $\beta$ on $I_{C}$ and on temperature in an integrated-circuit npn silicon transistor intended for operation around 1 mA .

## Summary

- Depending on the bias conditions on its two junctions, the BJT can operate in one of three possible modes: cutoff (both junctions reverse biased), active (the EBJ forward biased and the CBJ reverse biased), and saturation (both junctions forward biased). Refer to Table 6.1.
- For amplifier applications, the BJT is operated in the active mode. Switching applications make use of the cutoff and saturation modes.
- A BJT operating in the active mode provides a collector current $i_{C}=I_{S} e^{i v_{B E} / V_{T}}$. The base current $i_{B}=i_{C} / \beta$, and the emitter current $i_{E}=i_{C}+i_{B}$. Also, $i_{C}=\alpha i_{E}$, and thus $\beta=\alpha /(1-\alpha)$ and $\alpha=\beta /(\beta+1)$. See Table 6.2.
- To ensure operation in the active mode, the collector voltage of an npn transistor must be kept higher than approximately 0.4 V below the base voltage. For a pnp transistor, the collector voltage must be lower than approximately 0.4 V above the base voltage. Otherwise, the CBJ becomes forward biased, and the transistor enters the saturation region.
- At a constant collector current, the magnitude of the base-emitter voltage decreases by about 2 mV for every $1^{\circ} \mathrm{C}$ rise in temperature.
- The BJT will be at the edge of saturation when $\left|v_{C E}\right|$ is reduced to about 0.3 V . In saturation, $\left|v_{C E}\right| \simeq 0.2 \mathrm{~V}$, and the ratio of $i_{C}$ to $i_{B}$ is lower than $\beta$ (i.e., $\beta_{\text {lowed }}<\beta$ ).
- In the active mode, $i_{C}$ shows a slight dependence on $v_{C E}$. This phenomenon, known as the Early effect, is modeled by ascribing a finite (i.e., noninfinite) output resistance to the BJT: $r_{o}=\left|V_{A}\right| / I_{C}^{\prime}$, where $V_{A}$ is the Early voltage and $I_{C}^{\prime}$ is the dc collector current without the Early effect taken into account. In discrete circuits, $r_{o}$ plays a minor role and can usually be neglected. This is not the case, however, in integrated-circuit design (Chapter 8).
- The dc analysis of transistor circuits is greatly simplified by assuming that $\left|V_{B E}\right| \simeq 0.7 \mathrm{~V}$. Refer to Table 6.3.
- If the BJT is conducting, one assumes it is operating in the active mode and, using the active-mode model, proceeds to determine all currents and voltages. The validity of the initial assumption is then checked by determining whether the CBJ is reverse biased. If it is, the analysis is complete; otherwise, we assume the BJT is operating in saturation and redo the analysis, using the saturation-mode model and checking at the end that $I_{C}<\beta I_{B}$.
## Computer Simulations Problems

SIM Problems identified by the Multisim/PSpice icon are intended to demonstrate the value of using SPICE simulation to verify hand analysis and design, and to investigate important issues such as allowable signal swing and amplifier nonlinear distortion. Instructions to assist in setting up PSPice and Multisim simulations for all the indicated problems can be found in the corresponding files on the website. Note that if a particular parameter value is not specified in the problem statement, you are to make a reasonable assumption.

## Section 6.1: Device Structure and Physical Operation

6.1 The terminal voltages of various $n p n$ transistors are measured during operation in their respective circuits with the following results:

| Case | E | B | C | Mode |
| :--: | :--: | :--: | :--: | :--: |
| 1 | 0 | 0.7 | 0.7 |  |
| 2 | 0 | 0.8 | 0.1 |  |
| 3 | -0.7 | 0 | 1.0 |  |
| 4 | -0.7 | 0 | -0.6 |  |
| 5 | 1.3 | 2.0 | 5.0 |  |
| 6 | 0 | 0 | 5.0 |  |

In this table, where the entries are in volts, 0 indicates the reference terminal to which the black (negative) probe of the voltmeter is connected. For each case, identify the mode of operation of the transistor.
6.2 Two transistors, fabricated with the same technology but having different junction areas, when operated at a base-emitter voltage of 0.75 V , have collector currents of 0.5 mA and 2 mA . Find $I_{S}$ for each device. What are the relative junction areas?
6.3 In a particular technology, a small BJT operating at $v_{B E}=30 V_{T}$ conducts a collector current of $200 \mu \mathrm{~A}$. What is the corresponding saturation current? For a transistor in the same technology but with an emitter junction that is 32 times larger, what is the saturation current? What current will this transistor conduct at $v_{B E}=30 V_{T}$ ? What is the base-emitter voltage of the latter transistor at $i_{C}=1 \mathrm{~mA}$ ? Assume active-mode operation in all cases.
6.4 Two transistors have EBJ areas as follows: $A_{E 1}=$ $200 \mu \mathrm{~m} \times 200 \mu \mathrm{~m}$ and $A_{E 2}=0.4 \mu \mathrm{~m} \times 0.4 \mu \mathrm{~m}$. If the two
transistors are operated in the active mode and conduct equal collector currents, what do you expect the difference in their $v_{B E}$ values to be?
6.5 Find the collector currents that you would expect for operation at $v_{B E}=700 \mathrm{mV}$ for transistors for which $I_{S}=$ $10^{-13} \mathrm{~A}$ and $I_{S}=10^{-18} \mathrm{~A}$. For the transistor with the larger EBJ, what is the $v_{B E}$ required to provide a collector current equal to that provided by the smaller transistor at $v_{B E}=$ 700 mV ? Assume active-mode operation in all cases.
6.6 In this problem, we contrast two BJT integrated-circuit fabrication technologies: For the "old" technology, a typical $n p n$ transistor has $I_{S}=2 \times 10^{-15} \mathrm{~A}$, and for the "new" technology, a typical npn transistor has $I_{S}=2 \times 10^{-18} \mathrm{~A}$. These typical devices have vastly different junction areas and base width. For our purpose here we wish to determine the $v_{B E}$ required to establish a collector current of 1 mA in each of the two typical devices. Assume active-mode operation.
6.7 Consider an $n p n$ transistor whose base-emitter drop is 0.76 V at a collector current of 5 mA . What current will it conduct at $v_{B E}=0.70 \mathrm{~V}$ ? What is its base-emitter voltage for $i_{C}=5 \mu \mathrm{~A}$ ?
6.8 In a particular BJT, the base current is $10 \mu \mathrm{~A}$, and the collector current is $800 \mu \mathrm{~A}$. Find $\beta$ and $\alpha$ for this device.
6.9 Find the values of $\beta$ that correspond to $\alpha$ values of 0.5 , $0.8,0.9,0.95,0.98,0.99,0.995$, and 0.999 .
6.10 Find the values of $\alpha$ that correspond to $\beta$ values of 1 , $2,10,20,50,100,200,500$, and 1000 .
*6.11 Show that for a transistor with $\alpha$ close to unity, if $\alpha$ changes by a small per-unit amount $(\Delta \alpha / \alpha)$, the corresponding per-unit change in $\beta$ is given approximately by

$$
\frac{\Delta \beta}{\beta} \simeq \beta\left(\frac{\Delta \alpha}{\alpha}\right)
$$

Now, for a transistor whose nominal $\beta$ is 100 , find the percentage change in its $\alpha$ value corresponding to a drop in its $\beta$ of $10 \%$.
6.12 An $n p n$ transistor of a type whose $\beta$ is specified to range from 50 to 300 is connected in a circuit with emitter grounded, collector at +10 V , and a current of $10 \mu \mathrm{~A}$ injected into the base. Calculate the range of collector and emitter currents that can result. What is the maximum power dissipated in the transistor? (Note: Perhaps you can see why this is a bad way to establish the operating current in the collector of a BJT.)

[^0]
[^0]:    $\mathrm{SIM}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
6.13 A BJT is specified to have $I_{S}=5 \times 10^{-15} \mathrm{~A}$ and $\beta$ that falls in the range of 50 to 200 . If the transistor is operated in the active mode with $v_{B E}$ set to 0.700 V , find the expected range of $i_{C}, i_{B}$, and $i_{E}$.
6.14 Measurements made on a number of transistors operating in the active mode with $i_{E}=1 \mathrm{~mA}$ indicate base currents of $10 \mu \mathrm{~A}, 20 \mu \mathrm{~A}$, and $50 \mu \mathrm{~A}$. For each device, find $i_{C}, \beta$, and $\alpha$.
6.15 Measurements of $V_{B E}$ and two terminal currents taken on a number of $n p n$ transistors operating in the active mode are tabulated below. For each, calculate the missing current value as well as $\alpha, \beta$, and $I_{S}$ as indicated by the table.

| Transistor | a | b | c | d | e |
| :--: | :--: | :--: | :--: | :--: | :--: |
| $V_{B E}(\mathrm{mV})$ | 700 | 690 | 580 | 780 | 820 |
| $I_{C}(\mathrm{~mA})$ | 1.000 | 1.000 |  | 10.10 |  |
| $I_{B}(\mu \mathrm{~A})$ | 10 |  | 5 | 120 | 1050 |
| $I_{E}(\mathrm{~mA})$ |  | 1.020 | 0.235 |  | 75.00 |
| $\alpha$ |  |  |  |  |  |
| $\beta$ |  |  |  |  |  |
| $I_{S}$ |  |  |  |  |  |

6.16 When operated in the active mode, a particular npn BJT conducts a collector current of 1 mA and has $v_{B E}=0.70 \mathrm{~V}$ and $i_{B}=10 \mu \mathrm{~A}$. Use these data to create specific transistor models of the form shown in Fig. 6.5(a) to (d).
6.17 Using the npn transistor model of Fig. 6.5(b), consider the case of a transistor for which the base is connected to ground, the collector is connected to a $5-\mathrm{V}$ dc source through a $2-\mathrm{k} \Omega$ resistor, and a $2-\mathrm{mA}$ current source is connected to the emitter with the polarity so that current is drawn out of the emitter terminal. If $\beta=100$ and $I_{S}=5 \times 10^{-15} \mathrm{~A}$, find the voltages at the emitter and the collector and calculate the base current.

D 6.18 Consider an npn transistor operated in the active mode and represented by the model of Fig. 6.5(d). Let the transistor be connected as indicated by the equivalent circuit shown in Fig. 6.6(b). It is required to calculate the values of $R_{B}$ and $R_{C}$ that will establish a collector current $I_{C}$ of 0.5 mA and a collector-to-emitter voltage $V_{C E}$ of 1 V . The BJT is specified to have $\beta=50$ and $I_{S}=5 \times 10^{-15} \mathrm{~A}$.
6.19 An npn transistor has a CBJ with an area 100 times that of the EBJ. If $I_{S}=10^{-15} \mathrm{~A}$, find the voltage drop across EBJ
and across CBJ when each is forward biased and conducting a current of 1 mA . Also find the forward current each junction would conduct when forward biased with 0.5 V .
*6.20 We wish to investigate the operation of the $n p n$ transistor in saturation using the model of Fig. 6.9. Let $I_{S}=$ $10^{-15} \mathrm{~A}, v_{B E}=0.7 \mathrm{~V}, \beta=100$, and $I_{S C} / I_{S}=100$. For each of three values of $v_{C E}$ (namely, $0.4 \mathrm{~V}, 0.3 \mathrm{~V}$, and 0.2 V ), find $v_{B C}, i_{B C}, i_{B E}, i_{B}, i_{C}$, and $i_{C} / i_{B}$. Present your results in tabular form. Also find $v_{C E}$ that results in $i_{C}=0$.
*6.21 Use Eqs. (6.14), (6.15), and (6.16) to show that an $n p n$ transistor operated in saturation exhibits a collector-to-emitter voltage, $V_{C E \text { sat }}$, given by

$$
V_{C E \text { sat }}=V_{T} \ln \left[\left(\frac{I_{S C}}{I_{S}}\right) \frac{1+\beta_{\text {forced }}}{1-\beta_{\text {forced }} / \beta}\right]
$$

Use this relationship to evaluate $V_{C E \text { sat }}$ for $\beta_{\text {forced }}=50,10,5$, and 1 for a transistor with $\beta=100$ and with a CBJ area 100 times that of the EBJ. Present your results in a table.
6.22 Consider the pnp large-signal model of Fig. 6.11(b) applied to a transistor having $I_{S}=10^{-14} \mathrm{~A}$ and $\beta=50$. If the emitter is connected to ground, the base is connected to a current source that pulls $10 \mu \mathrm{~A}$ out of the base terminal, and the collector is connected to a negative supply of -5 V via a $8.2-\mathrm{k} \Omega$ resistor, find the collector voltage, the emitter current, and the base voltage.
6.23 A pnp transistor has $v_{E B}=0.7 \mathrm{~V}$ at a collector current of 1 mA . What do you expect $v_{E B}$ to become at $i_{C}=10 \mathrm{~mA}$ ? At $i_{C}=100 \mathrm{~mA}$ ?
6.24 A pnp transistor modeled with the circuit in Fig. 6.11 (b) is connected with its base at ground, collector at -2.0 V , and a $1-\mathrm{mA}$ current is injected into its emitter. If the transistor is said to have $\beta=10$, what are its base and collector currents? In which direction do they flow? If $I_{S}=10^{-15} \mathrm{~A}$, what voltage results at the emitter? What does the collector current become if a transistor with $\beta=1000$ is substituted? (Note: The fact that the collector current changes by less than $10 \%$ for a large change in $\beta$ illustrates that this is a good way to establish a specific collector current.)
6.25 A pnp power transistor operates with an emitter-to-collector voltage of 5 V , an emitter current of 5 A , and $V_{E B}=0.8 \mathrm{~V}$. For $\beta=20$, what base current is required? What is $I_{S}$ for this transistor? Compare the emitter-base junction area of this transistor with that of a small-signal

[^0]
[^0]:    5145 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
transistor that conducts $i_{C}=1 \mathrm{~mA}$ with $v_{E B}=0.70 \mathrm{~V}$. How much larger is it?
6.26 While Fig. 6.5 provides four possible large-signal equivalent circuits for the $n p n$ transistor, only two equivalent circuits for the $p n p$ transistor are provided in Fig. 6.11. Supply the missing two.
6.27 By analogy to the $n p n$ case shown in Fig. 6.9, give the equivalent circuit of a $p n p$ transistor in saturation.

(b)

Figure P6.28

(a)

(c)

(d)

Figure P6.28


Figure P6.29

[^0]
[^0]:    ${ }^{318}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; ${ }^{* * *}=$ very challenging; $D=$ design problem
6.30 A very simple circuit for measuring $\beta$ of an $n p n$ transistor is shown in Fig. P6.30. In a particular design, $V_{C C}$ is provided by a $9-\mathrm{V}$ battery; $M$ is a current meter with a $50-\mu \mathrm{A}$ full scale and relatively low resistance that you can neglect for our purposes here. Assuming that the transistor has $V_{B E}=0.7 \mathrm{~V}$ at $I_{E}=1 \mathrm{~mA}$, what value of $R_{C}$ would establish a resistor current of 1 mA ? Now, to what value of $\beta$ does a meter reading of full scale correspond? What is $\beta$ if the meter reading is $1 / 5$ of full scale? $1 / 10$ of full scale?


Figure P6.30
6.31 Repeat Exercise 6.13 for the situation in which the power supplies are reduced to $\pm 2.5 \mathrm{~V}$.

D 6.32 Design the circuit in Fig. P6.32 to establish a current of 0.5 mA in the emitter and a voltage of -0.5 V at the collector. The transistor $v_{E B}=0.64 \mathrm{~V}$ at $I_{E}=0.1 \mathrm{~mA}$, and $\beta=100$. To what value can $R_{C}$ be increased while the collector current remains unchanged?


Figure P6.32

D 6.33 Examination of the table of standard values for resistors with $5 \%$ tolerance in Appendix J reveals that the closest values to those found in the design of Example 6.2 are $5.1 \mathrm{k} \Omega$ and $6.8 \mathrm{k} \Omega$. For these values, use approximate calculations (e.g., $V_{B E} \simeq 0.7 \mathrm{~V}$ and $\alpha \simeq 1$ ) to determine the values of collector current and collector voltage that are likely to result.

D 6.34 Design the circuit in Fig. P6.34 to establish $I_{C}=$ 0.2 mA and $V_{C}=0.5 \mathrm{~V}$. The transistor exhibits $v_{B E}$ of 0.8 V at $i_{C}=1 \mathrm{~mA}$, and $\beta=100$.


Figure P6.34
6.35 For each of the circuits shown in Fig. P6.35, find the emitter, base, and collector voltages and currents. Use $\beta=50$, but assume $\left|V_{B E}\right|=0.8 \mathrm{~V}$ independent of current level.


Figure P6.35

[^0]
[^0]:    ${ }^{\text {SHE }}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; ${ }^{* * *}=$ very challenging; $D=$ design problem


Figure P6.35 continued
6.36 The current $I_{C B O}$ of a small transistor is measured to be 10 nA at $25^{\circ} \mathrm{C}$. If the temperature of the device is raised to $125^{\circ} \mathrm{C}$, what do you expect $I_{C B O}$ to become?
6.37 Augment the model of the npn BJT shown in Fig. 6.19(a) by a current source representing $I_{C B O}$. Assume that $r_{o}$ is very large and thus can be neglected. In terms of this addition, what do the terminal currents $i_{\mathrm{B}}, i_{C}$, and $i_{E}$ become? If the base lead is open-circuited while the emitter is connected to ground, and the collector is connected to a positive supply, find the emitter and collector currents.
6.38 A BJT whose emitter current is fixed at 1 mA has a base-emitter voltage of 0.70 V at $25^{\circ} \mathrm{C}$. What base-emitter voltage would you expect at $0^{\circ} \mathrm{C}$ ? At $100^{\circ} \mathrm{C}$ ?
6.39 A particular pnp transistor operating at an emitter current of 0.5 mA at $20^{\circ} \mathrm{C}$ has an emitter-base voltage of 692 mV .
(a) What does $v_{E B}$ become if the junction temperature rises to $50^{\circ} \mathrm{C}$ ?
(b) If the transistor is operated at a fixed emitter-base voltage of 700 mV , what emitter current flows at $20^{\circ} \mathrm{C}$ ? At $50^{\circ} \mathrm{C}$ ?
6.40 Consider a transistor for which the base-emitter voltage drop is 0.7 V at 10 mA . What current flows for $v_{B E}=0.5 \mathrm{~V}$ ? Evaluate the ratio of the slopes of the $i_{C}-v_{B E}$ curve at $v_{B E}=$ 700 mV and at $v_{B E}=500 \mathrm{mV}$. The large ratio confirms the point that the BJT has an "apparent threshold" at $v_{B E} \simeq 0.5 \mathrm{~V}$.
6.41 Use Eq. (6.18) to plot $i_{C}$ versus $v_{C E}$ for an $n p n$ transistor having $I_{S}=10^{-15} \mathrm{~A}$ and $V_{A}=100 \mathrm{~V}$. Provide curves for $v_{B E}=$ $0.65,0.70,0.72,0.73$, and 0.74 volts. Show the characteristics for $v_{C E}$ up to 15 V .
*6.42 In the circuit shown in Fig. P6.42, current source $I$ is 1.1 mA , and at $25^{\circ} \mathrm{C} v_{B E}=680 \mathrm{mV}$ at $i_{E}=1 \mathrm{~mA}$. At $25^{\circ} \mathrm{C}$ with $\beta=100$, what currents flow in $R_{1}$ and $R_{2}$ ? What voltage would you expect at node E? Noting that the temperature coefficient of $v_{B E}$ for $I_{E}$ constant is $-2 \mathrm{mV} /{ }^{\circ} \mathrm{C}$, what is the TC of $v_{E}$ ? For an ambient temperature of $75^{\circ} \mathrm{C}$, what voltage would you expect at node E? Clearly state any simplifying assumptions you make.


Figure P6.42
6.43 For a particular $n p n$ transistor operating at a $v_{B E}$ of 680 mV and $I_{C}=1 \mathrm{~mA}$, the $i_{C}-v_{C E}$ characteristic has a slope of $0.8 \times 10^{-5} \Omega$. To what value of output resistance does this correspond? What is the value of the Early voltage for this transistor? For operation at 10 mA , what would the output resistance become?
6.44 For a BJT having an Early voltage of 50 V , what is its output resistance at 1 mA ? At $100 \mu \mathrm{~A}$ ?
6.45 Measurements of the $i_{C}-v_{C E}$ characteristic of a small-signal transistor operating at $v_{B E}=710 \mathrm{mV}$ show that $i_{C}=1.1 \mathrm{~mA}$ at $v_{C E}=5 \mathrm{~V}$ and that $i_{C}=1.3 \mathrm{~mA}$ at $v_{C E}=15 \mathrm{~V}$. What is the corresponding value of $i_{C}$ near saturation? At what value of $v_{C E}$ is $i_{C}=1.2 \mathrm{~mA}$ ? What is the value of the Early voltage for this transistor? What is the output resistance that corresponds to operation at $v_{B E}=710 \mathrm{mV}$ ?

[^0]
[^0]:    5.11 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
6.46 Give the $p n p$ equivalent circuit models that correspond to those shown in Fig. 6.19 for the $n p n$ case.
6.47 A BJT operating at $i_{B}=10 \mu \mathrm{~A}$ and $i_{C}=1.0 \mathrm{~mA}$ undergoes a reduction in base current of $1.0 \mu \mathrm{~A}$. It is found that when $v_{C E}$ is held constant, the corresponding reduction in collector current is 0.08 mA . What are the values of $\beta$ and the incremental $\beta$ or $\beta_{o c}$ that apply? If the base current is increased from $10 \mu \mathrm{~A}$ to $12 \mu \mathrm{~A}$ and $v_{C E}$ is increased from 8 V to 10 V , what collector current results? Assume $V_{A}=100 \mathrm{~V}$.
6.48 For the circuit in Fig. P6.48 let $V_{C C}=10 \mathrm{~V}, R_{C}=1 \mathrm{k} \Omega$, and $R_{B}=10 \mathrm{k} \Omega$. The BJT has $\beta=50$. Find the value of $V_{B B}$ that results in the transistor operating
(a) in the active mode with $V_{C}=2 \mathrm{~V}$;
(b) at the edge of saturation;
(c) deep in saturation with $\beta_{\text {forced }}=10$.

Assume $V_{B E} \simeq 0.7 \mathrm{~V}$.


Figure P6.48

T10 D *6.49 Consider the circuit of Fig. P6.48 for the case $V_{B B}=V_{C C}$. If the BJT is saturated, use the equivalent circuit of Fig. 6.21 to derive an expression for $\beta_{\text {forced }}$ in terms of $V_{C C}$ and $\left(R_{B} / R_{C}\right)$. Also derive an expression for the total power dissipated in the circuit. For $V_{C C}=5 \mathrm{~V}$, design the circuit to obtain operation at a forced $\beta$ as close to 10 as possible while limiting the power dissipation to no larger than 20 mW . Use $1 \%$ resistors (see Appendix J).
6.50 The pnp transistor in the circuit in Fig. P6.50 has $\beta=50$. Show that the BJT is operating in the saturation mode and find $\beta_{\text {forced }}$ and $V_{C}$. To what value should $R_{B}$ be increased in order for the transistor to operate at the edge of saturation?


Figure P6.50

## Section 6.3: BJT Circuits at DC

6.51 The transistor in the circuit of Fig. P6.51 has a very high $\beta$. Find $V_{E}$ and $V_{C}$ for $V_{B}$ (a) +2.0 V , (b) +1.7 V , and (c) 0 V .


Figure P6.51
6.52 The transistor in the circuit of Fig. P6.51 has a very high $\beta$. Find the highest value of $V_{B}$ for which the transistor still operates in the active mode. Also, find the value of $V_{B}$ for which the transistor operates in saturation with a forced $\beta$ of 2 .
6.53 Consider the operation of the circuit shown in Fig. P6.53 for $V_{B}$ at $-1 \mathrm{~V}, 0 \mathrm{~V}$, and +1 V . Assume that $\beta$ is very high. What values of $V_{E}$ and $V_{C}$ result? At what value of $V_{B}$ does the emitter current reduce to one-tenth of

[^0]
[^0]:    $T_{10}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; ${ }^{* * *}=$ very challenging; $D=$ design problem
its value for $V_{B}=0 \mathrm{~V}$ ? For what value of $V_{B}$ is the transistor just at the edge of conduction? $\left(v_{B E}=0.5 \mathrm{~V}\right)$ What values of $V_{E}$ and $V_{C}$ correspond? For what value of $V_{B}$ does the transistor reach the edge of saturation? What values of $V_{C}$ and $V_{E}$ correspond? Find the value of $V_{B}$ for which the transistor operates in saturation with a forced $\beta$ of 2 .


Figure P6.53
6.54 For the transistor shown in Fig. P6.54, assume $\alpha \simeq 1$ and $v_{B E}=0.5 \mathrm{~V}$ at the edge of conduction. What are the values of $V_{E}$ and $V_{C}$ for $V_{B}=0 \mathrm{~V}$ ? For what value of $V_{B}$ does the transistor cut off? Saturate? In each case, what values of $V_{E}$ and $V_{C}$ result?


Figure P6.54

D 6.55 Consider the circuit in Fig. P6.51 with the base voltage $V_{B}$ obtained using a voltage divider across the 3-V supply. Assuming the transistor $\beta$ to be very large (i.e., ignoring the base current), design the voltage divider to obtain $V_{B}=1.2 \mathrm{~V}$. Design for a $0.1-\mathrm{mA}$ current in the voltage divider. Now, if the BJT $\beta=100$, analyze the circuit to determine the collector current and the collector voltage.
6.56 A single measurement indicates the emitter voltage of the transistor in the circuit of Fig. P5.56 to be 1.0 V . Under the assumption that $\left|V_{B E}\right|=0.7 \mathrm{~V}$, what are $V_{B}, I_{B}, I_{E}, I_{C}, V_{C}$, $\beta$, and $\alpha$ ? (Note: Isn't it surprising what a little measurement can lead to?)


Figure P6.56

D 6.57 Design a circuit using a pnp transistor for which $\alpha \simeq 1$ using two resistors connected appropriately to $\pm 3 \mathrm{~V}$ so that $I_{E}=0.5 \mathrm{~mA}$ and $V_{B C}=1 \mathrm{~V}$. What exact values of $R_{E}$ and $R_{C}$ would be needed? Now, consult a table of standard 5\% resistor values (e.g., that provided in Appendix J) to select suitable practical values. What values of resistors have you chosen? What are the values of $I_{E}$ and $V_{B C}$ that result?
6.58 In the circuit shown in Fig. P6.58, the transistor has $\beta=40$. Find the values of $V_{B}, V_{E}$, and $V_{C}$. If $R_{B}$ is raised to $100 \mathrm{k} \Omega$, what voltages result? With $R_{B}=100 \mathrm{k} \Omega$, what value of $\beta$ would return the voltages to the values first calculated?

[^0]
[^0]:    338 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem

Figure P6.58
6.59 In the circuit shown in Fig. P6.58, the transistor has $\beta=50$. Find the values of $V_{B}, V_{E}$, and $V_{C}$, and verify that the transistor is operating in the active mode. What is the largest value that $R_{C}$ can have while the transistor remains in the active mode?
6.60 For the circuit in Fig. P6.60, find $V_{B}, V_{E}$, and $V_{C}$ for $R_{B}=100 \mathrm{k} \Omega, 10 \mathrm{k} \Omega$, and $1 \mathrm{k} \Omega$. Let $\beta=100$.


Figure P6.60
6.61 For the circuits in Fig. P6.61, find values for the labeled node voltages and branch currents. Assume $\beta$ to be very high.

(a)
(b)

(c)
(d)

Figure P6.61


Figure P6.61 continued
*6.62 Repeat the analysis of the circuits in Problem 6.61 using $\beta=100$. Find all the labeled node voltages and branch currents.

D **6.63 It is required to design the circuit in Fig. P6.63 so that a current of 1 mA is established in the emitter and a voltage of -1 V appears at the collector. The transistor type used has a nominal $\beta$ of 100 . However, the $\beta$ value can be as low as 50 and as high as 150 . Your design should ensure that the specified emitter current is obtained when $\beta=100$ and that at the extreme values of $\beta$ the emitter current does not change by more than $10 \%$ of its nominal value. Also, design for as large a value for $R_{B}$ as possible. Give the values of $R_{B}$, $R_{E}$, and $R_{C}$ to the nearest kilohm. What is the expected range of collector current and collector voltage corresponding to the full range of $\beta$ values?


Figure P6.63

D 6.64 The pnp transistor in the circuit of Fig. P6.64 has $\beta=50$. Find the value for $R_{C}$ to obtain $V_{C}=+2 \mathrm{~V}$. What happens if the transistor is replaced with another having $\beta=100$ ? Give the value of $V_{C}$ in the latter case.


Figure P6.64
***6.65 Consider the circuit shown in Fig. P6.65. It resembles that in Fig. 6.30 but includes other features. First, note diodes $D_{1}$ and $D_{2}$ are included to make design (and analysis) easier and to provide temperature compensation for the emitter-base voltages of $Q_{1}$ and $Q_{2}$. Second, note resistor $R$, whose purpose is to provide negative feedback (more on this later in the book!). Using $\left|V_{B E}\right|$ and $V_{D}=0.7 \mathrm{~V}$ independent of current, and $\beta=\infty$, find the voltages $V_{B 1}, V_{E 1}$, $V_{C 1}, V_{B 2}, V_{E 2}$, and $V_{C 2}$, initially with $R$ open-circuited and then with $R$ connected. Repeat for $\beta=100$, with $R$ open-circuited initially, then connected.


Figure P6.65
*6.66 For the circuit shown in Fig. P6.66, find the labeled node voltages for:
(a) $\beta=\infty$
(b) $\beta=100$


Figure P6.66
D *6.67 Using $\beta=\infty$, design the circuit shown in Fig. P6.67 so that the emitter currents of $Q_{1}, Q_{2}$, and $Q_{3}$


Figure P6.67
are $0.5 \mathrm{~mA}, 0.5 \mathrm{~mA}$, and 1 mA , respectively, and $V_{3}=0$, $V_{5}=-2 \mathrm{~V}$, and $V_{7}=1 \mathrm{~V}$. For each resistor, select the nearest standard value utilizing the table of standard values for $5 \%$ resistors in Appendix J. Now, for $\beta=100$, find the values of $V_{3}, V_{4}, V_{5}, V_{6}$, and $V_{7}$.
*6.68 For the circuit in Fig. P6.68, find $V_{R}$ and $V_{E}$ for $v_{I}=0 \mathrm{~V},+2 \mathrm{~V},-2.5 \mathrm{~V}$, and -5 V . The BJTs have $\beta=50$.


Figure P6.68
**6.69 All the transistors in the circuits of Fig. P6.69 are specified to have a minimum $\beta$ of 50 . Find approximate values for the collector voltages and calculate forced $\beta$ for each of the transistors. (Hint: Initially, assume all transistors are operating in saturation, and verify the assumption.)

Figure P6.67

[^0]
[^0]:    ${ }^{\text {TIE }}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; ${ }^{* * *}=$ very challenging; $\mathrm{D}=$ design problem


Figure P6.69
# CHAPTER 7 

## Transistor Amplifiers

Introduction 367
7.1 Basic Principles 368
7.2 Small-Signal Operation and Models 383
7.3 Basic Configurations 423
7.4 Biasing 454
7.5 Discrete-Circuit Amplifiers 467

Summary 479
Problems 480
# IN THIS CHAPTER YOU WILL LEARN 

1. How the transistor (a MOSFET or a BJT) can be used to make an amplifier.
2. How to obtain linear amplification from the fundamentally nonlinear MOS and bipolar transistor.
3. How to model the linear operation of a transistor around a bias point by an equivalent circuit that can be used in the analysis and design of transistor amplifiers.
4. The three basic ways to connect a MOSFET or a BJT to construct amplifiers with different properties.
5. Practical circuits for MOS and bipolar transistor amplifiers that can be constructed using discrete components.

## Introduction

Having studied the two major transistor types, the MOSFET (Chapter 5) and the BJT (Chapter 6), we now begin the study of their application. There are two distinctly different kinds of transistor application: as a switch, in the design of digital circuits (Chapters 14-16) and as a controlled source, in the design of amplifiers for analog circuits. This chapter and the subsequent six focus on the latter application, namely, the use of the transistor in the design of a variety of amplifier types.

Since the basic principles that underlie the use of the MOSFET and the BJT in amplifier design are the same, the two devices are studied together in this chapter. Besides providing some economy in presentation, this unified study enables us to make important comparisons between MOS and bipolar amplifiers.

The bulk of this chapter is concerned with the fundamental principles and concepts that are the basis for the application of transistors in amplifier design: We study in detail the models that are used to represent both transistor types in the analysis and design of small-signal linear amplifiers. We also study the three basic configurations in which each of the two transistor types can be connected to realize an amplifier.

The chapter concludes with examples of discrete-circuit amplifiers. These are circuits that can be assembled using discrete transistors, resistors, and capacitors on printed-circuit boards (PCBs). They predominantly use BJTs, and their design differs in significant ways from the design of integrated-circuit (IC) amplifiers. The latter predominantly use MOSFETs, and their study begins in Chapter 8. However, the fundamental principles and concepts introduced in this chapter apply equally well to both discrete and integrated amplifiers.
# 7.1 Basic Principles 

### 7.1.1 The Basis for Amplifier Operation

The basis for the application of the transistor (a MOSFET or a BJT) in amplifier design is that when the device is operated in the active region, a voltage-controlled current source is realized. Specifically, when a MOSFET is operated in the saturation or pinch-off region, also referred to in this chapter as the active region, the voltage between gate and source, $v_{G S}$, controls the drain current $i_{D}$ according to the square-law relationship which, for an NMOS transistor, is expressed as

$$
i_{D}=\frac{1}{2} k_{n}\left(v_{G S}-V_{m}\right)^{2}
$$

We note that in this first-order model of MOSFET operation, the drain current $i_{D}$ does not depend on the drain voltage $v_{D S}$ because the channel is pinched off at the drain end, ${ }^{1}$ thus "isolating" the drain.

Similarly, when a BJT is operated in the active region, the base-emitter voltage $v_{B E}$ controls the collector current $i_{C}$ according to the exponential relationship which, for an $n p n$ transistor, is expressed as

$$
i_{C}=I_{S} e^{v_{B E} / V_{T}}
$$

Here, this first-order model of BJT operation indicates that the collector current $i_{C}$ does not depend on the collector voltage $v_{C E}$ because the collector-base junction is reverse biased, thus "isolating" the collector.

Figure 7.1 shows an NMOS transistor and an $n p n$ transistor operating in the active mode. Observe that for the NMOS transistor, the pinch-off condition is ensured by keeping $v_{D S} \geq v_{O V}$. Since the overdrive voltage $v_{O V}=v_{G S}-V_{m}$, this condition implies that $v_{G D} \leq V_{m}$, which indeed ensures channel pinch-off at the drain end.

Similarly, for the $n p n$ transistor in Fig. 7.1(b), the CBJ reverse-bias condition is ensured by keeping $v_{C E} \geq 0.3 \mathrm{~V}$. Since $v_{B E}$ is usually in the vicinity of $0.7 \mathrm{~V}, v_{B C}$ is thus kept


Figure 7.1 Operating (a) an NMOS transistor and (b) an $n p n$ transistor in the active mode. Note that $v_{G S}=$ $V_{m}+v_{O V}$ and $v_{D S} \geq v_{O V}$; thus $v_{G D} \leq V_{m}$, which ensures channel pinch-off at the drain end. Similarly, $v_{B E} \simeq$ 0.7 V , and $v_{C E} \geq 0.3 \mathrm{~V}$ results in $v_{B C} \leq 0.4 \mathrm{~V}$, which is sufficient to keep the CBJ from conducting.

[^0]
[^0]:    ${ }^{1}$ To focus on essentials, we shall neglect the Early effect until a later point.
smaller than 0.4 V , which is sufficient to prevent this relatively large-area junction from conducting.

Although we used NMOS and $n p n$ transistors to illustrate the conditions for active-mode operation, similar conditions apply for PMOS and pnp transistors, as studied in Chapters 5 and 6 , respectively.

Finally, we note that the control relationships in Eqs. (7.1) and (7.2) are nonlinear. Nevertheless, we shall shortly devise a technique for obtaining almost-linear amplification from these fundamentally nonlinear devices.

# 7.1.2 Obtaining a Voltage Amplifier 

From the above we see that the transistor is basically a transconductance amplifier: that is, an amplifier whose input signal is a voltage and whose output signal is a current. More commonly, however, one is interested in voltage amplifiers. A simple way to convert a transconductance amplifier to a voltage amplifier is to pass the output current through a resistor and take the voltage across the resistor as the output. Doing this for a MOSFET results in the simple amplifier circuit shown in Fig. 7.2(a). Here $v_{G S}$ is the input voltage, $R_{D}$ (known as a load resistance) converts the drain current $i_{D}$ to a voltage $\left(i_{D} R_{D}\right)$, and $V_{D D}$ is the supply voltage that powers up the amplifier and, together with $R_{D}$, establishes operation in the active region, as will be shown shortly.

In the amplifier circuit of Fig. 7.2(a) the output voltage is taken between the drain and ground, rather than simply across $R_{D}$. This is done because of the need to maintain a common ground reference between the input and the output. The output voltage $v_{D S}$ is given by

$$
v_{D S}=V_{D D}-i_{D} R_{D}
$$

Thus it is an inverted version (note the minus sign) of $i_{D} R_{D}$ that is shifted by the constant value of the supply voltage $V_{D D}$.

An exactly similar arrangement applies for the BJT amplifier, as illustrated in Fig. 7.2(c). Here the output voltage $v_{C E}$ is given by

$$
v_{C E}=V_{C C}-i_{C} R_{C}
$$



Figure 7.2 (a) An NMOS amplifier and (b) its VTC; and (c) an npn amplifier and (d) its VTC.


Figure 7.2 continued

# 7.1.3 The Voltage-Transfer Characteristic (VTC) 

A useful tool that provides insight into the operation of an amplifier circuit is its voltage-transfer characteristic (VTC). This is simply a plot (or a clearly labeled sketch) of the output voltage versus the input voltage. For the MOS amplifier in Fig. 7.2(a), this is the plot of $v_{D S}$ versus $v_{G S}$ shown in Fig. 7.2(b).

Observe that for $v_{G S}<V_{t}$, the transistor is cut off, $i_{D}=0$ and, from Eq. (7.3), $v_{D S}=V_{D D}$. As $v_{G S}$ exceeds $V_{t}$, the transistor turns on and $v_{D S}$ decreases. However, since initially $v_{D S}$ is still high, the MOSFET will be operating in saturation or the active region. This continues as $v_{G S}$ is increased until the value of $v_{G S}$ is reached that results in $v_{D S}$ becoming lower than $v_{G S}$ by $V_{t}$ volts [point B on the VTC in Fig. 7.2(b)]. For $v_{G S}$ greater than that at point B, the transistor operates in the triode region and $v_{D S}$ decreases more slowly.

The VTC in Fig. 7.2(b) indicates that the segment of greatest slope (hence potentially the largest amplifier gain) is that labeled $A B$, which corresponds to operation in the active region. When a MOSFET is operated as an amplifier, its operating point is confined to the segment AB at all times. An expression for the segment AB can be obtained by substituting for $i_{D}$ in Eq. (7.3) by its active-region value from Eq. (7.1), thus

$$
v_{D S}=V_{D D}-\frac{1}{2} k_{n} R_{D}\left(v_{G S}-V_{t}\right)^{2}
$$

This is obviously a nonlinear relationship. Nevertheless, linear (or almost-linear) amplification can be obtained by using the technique of biasing the MOSFET. Before considering biasing, however, it is useful to determine the coordinates of point $B$, which is at the boundary between the saturation and the triode regions of operation. These can be obtained by substituting in Eq. (7.5), $v_{G S}=\left.V_{G S}\right|_{\mathrm{B}}$ and $v_{D S}=\left.V_{D S}\right|_{\mathrm{B}}=\left.V_{G S}\right|_{\mathrm{B}}-V_{t}$. The result is

$$
\left.V_{G S}\right|_{\mathrm{B}}=V_{t}+\frac{\sqrt{2 k_{n} R_{D} V_{D D}+1}-1}{k_{n} R_{D}}
$$
Point B can be alternatively characterized by the overdrive voltage

$$
\left.V_{O V}\right|_{\mathrm{B}} \equiv\left.V_{G S}\right|_{\mathrm{B}}-V_{t}=\frac{\sqrt{2 k_{o} R_{D} V_{D D}+1}-1}{k_{o} R_{D}}
$$

and

$$
\left.V_{D S}\right|_{\mathrm{B}}=\left.V_{O V}\right|_{\mathrm{B}}
$$

# EXERCISE 

7.1 Consider the amplifier of Fig. 7.2(a) with $V_{D D}=1.8 \mathrm{~V}, R_{D}=17.5 \mathrm{k} \Omega$, and with a MOSFET specified to have $V_{t}=0.4 \mathrm{~V}, k_{o}=4 \mathrm{~mA} / \mathrm{V}^{2}$, and $\lambda=0$. Determine the coordinates of the end points of the active-region segment of the VTC. Also, determine $\left.V_{D S}\right|_{C}$ assuming $\left.V_{G S}\right|_{C}=V_{D D}$. Ans. A: $0.4 \mathrm{~V}, 1.8 \mathrm{~V} ; \mathrm{B}: 0.613 \mathrm{~V}, 0.213 \mathrm{~V} ;\left.V_{D S}\right|_{C}=18 \mathrm{mV}$

An exactly similar development applies to the BJT case. This is illustrated in Fig. 7.2(c) and (d). In this case, over the active-region or amplifier segment $A B$, the output voltage $v_{C E}$ is related to the input voltage $v_{B E}$ by

$$
v_{C E}=V_{C C}-R_{C} I_{S} e^{v_{B E} / V_{T}}
$$

Here also, the input-output relationship is nonlinear. Nevertheless, linear (or almost-linear) amplification can be obtained by using the biasing technique discussed next.

### 7.1.4 Obtaining Linear Amplification by Biasing the Transistor

Biasing enables us to obtain almost-linear amplification from the MOSFET and the BJT. The technique is illustrated for the MOSFET case in Fig. 7.3(a). A dc voltage $V_{G S}$ is selected to obtain operation at a point Q on the segment AB of the VTC. How to select an appropriate location for the bias point Q will be discussed shortly. For the time being, observe that the coordinates of Q are the dc voltages $V_{G S}$ and $V_{D S}$, which are related by

$$
V_{D S}=V_{D D}-\frac{1}{2} k_{o} R_{D}\left(V_{G S}-V_{t}\right)^{2}
$$

Point Q is known as the bias point or the dc operating point. Also, since at Q no signal component is present, it is also known as the quiescent point (which is the origin of the symbol Q).

Next, the signal to be amplified, $v_{g s}$, a function of time $t$, is superimposed on the bias voltage $V_{G S}$, as shown in Fig. 7.4(a). Thus the total instantaneous value of $v_{G S}$ becomes

$$
v_{G S}(t)=V_{G S}+v_{g s}(t)
$$

The resulting $v_{D S}(t)$ can be obtained by substituting for $v_{G S}(t)$ into Eq. (7.5). Graphically, we can use the VTC to obtain $v_{D S}(t)$ point by point, as illustrated in Fig. 7.4(b). Here we show

Figure 7.3 Biasing the MOSFET amplifier at a point Q located on the segment AB of the VTC.
the case of $v_{g s}$ being a triangular wave of "small" amplitude. Specifically, the amplitude of $v_{g s}$ is small enough to restrict the excursion of the instantaneous operating point to a short, almost-linear segment of the VTC around the bias point Q . The shorter the segment, the greater the linearity achieved, and the closer to an ideal triangular wave the signal component at the output, $v_{d s}$, will be. This is the essence of obtaining linear amplification from the nonlinear MOSFET.

Before leaving Fig. 7.4(b) we wish to draw the reader's attention to the consequence of increasing the amplitude of the signal $v_{g s}$. As the instantaneous operating point will no longer be confined to the almost-linear segment of the VTC, the output signal $v_{d s}$ will deviate from its ideal triangular shape; that is, it will exhibit nonlinear distortion. Worse yet, if the input signal amplitude becomes sufficiently large, the instantaneous operating point may leave the segment AB altogether. If this happens at the negative peaks of $v_{g s}$, the transistor will cut off for a portion of the cycle and the positive peaks of $v_{d s}$ will be "clipped off." If it occurs at the positive peaks of $v_{g s}$, the transistor will enter the triode region for a portion of the cycle, and the negative peaks of $v_{d s}$ will become flattened. It follows that the selection of the location of the bias point Q can have a profound effect on the maximum allowable amplitude of $v_{d s}$, referred to as the allowable signal swing at the output. We will have more to say later on this important point.

An exactly parallel development can be applied to the BJT amplifier. In fact, all we need to do is replace the NMOS transistor in Figs. 7.3 and 7.4 with an $n p n$ transistor and change the voltage and current symbols to their BJT counterparts. The resulting bias point Q will be characterized by dc voltages $V_{B E}$ and $V_{C E}$, which are related by

$$
V_{C E}=V_{C C}-R_{C} I_{S} e^{V_{B E} / V_{T}}
$$

and a dc current $I_{C}$,

$$
I_{C}=I_{S} e^{V_{B E} / V_{T}}
$$

Also, superimposing a small-signal $v_{b e}$ on the dc bias voltage $V_{B E}$ results in

$$
v_{B E}(t)=V_{B E}+v_{b e}(t)
$$

(a)

(b)

Figure 7.4 The MOSFET amplifier with a small time-varying signal $v_{g s}(t)$ superimposed on the dc bias voltage $V_{G S}$. The MOSFET operates on a short almost-linear segment of the VTC around the bias point Q and provides an output voltage $v_{d s}=A_{y} v_{g s}$.
which can be substituted into Eq. (7.9) to obtain the total instantaneous value of the output voltage $v_{C E}(t)$. Here again, almost-linear operation is obtained by keeping $v_{b e}$ small enough to restrict the excursion of the instantaneous operating point to a short, almost-linear segment of the VTC around the bias point Q . Similar comments also apply to the maximum allowable signal swing at the output.

# 7.1.5 The Small-Signal Voltage Gain 

The MOSFET Case Consider the MOSFET amplifier in Fig. 7.4(a). If the input signal $v_{g s}$ is kept small, the corresponding signal at the output $v_{d s}$ will be nearly proportional to $v_{g s}$ with the constant of proportionality being the slope of the almost-linear segment of the VTC around Q. This is the voltage gain of the amplifier, and its value can be determined by evaluating the slope of the tangent to the VTC at the bias point Q,

$$
A_{v}=\left.\frac{d v_{D S}}{d v_{G S}}\right|_{v_{G S}=V_{G S}}
$$

Utilizing Eq. (7.5) we obtain

$$
A_{v}=-k_{n}\left(V_{G S}-V_{r}\right) R_{D}
$$

which can be expressed in terms of the overdrive voltage at the bias point, $V_{O V}$, as

$$
A_{v}=-k_{n} V_{O V} R_{D}
$$

We make the following observations on this expression for the voltage gain.

1. The gain is negative, which signifies that the amplifier is inverting; that is, there is a $180^{\circ}$ phase shift between the input and the output. This inversion is obvious in Fig. 7.4(b) and should have been anticipated from Eq. (7.5).
2. The gain is proportional to the load resistance $R_{D}$, to the transistor transconductance parameter $k_{n}$, and to the overdrive voltage $V_{O V}$. This all makes intuitive sense.
Another simple and insightful expression for the voltage gain $A_{v}$ can be derived by recalling that the dc current in the drain at the bias point is related to $V_{O V}$ by

$$
I_{D}=\frac{1}{2} k_{n} V_{O V}^{2}
$$

This equation can be combined with Eq. (7.15) to obtain

$$
A_{v}=-\frac{I_{D} R_{D}}{V_{O V} / 2}
$$

That is, the gain is simply the ratio of the dc voltage drop across the load resistance $R_{D}$ to $V_{O V} / 2$. It can be expressed in the alternative form

$$
A_{v}=-\frac{V_{D D}-V_{D S}}{V_{O V} / 2}
$$

Since the maximum slope of the VTC in Fig. 7.4(b) occurs at point B, the maximum gain magnitude $\left|A_{v \max }\right|$ is obtained by biasing the transistor at point B ,

$$
\left|A_{v \max }\right|=\frac{\left.V_{D D}-V_{D S}\right|_{\mathrm{B}}}{\left.V_{O V}\right|_{\mathrm{B}} / 2}
$$
and since $\left.V_{D S}\right|_{\mathrm{B}}=\left.V_{O V}\right|_{\mathrm{B}}$,

$$
\left|A_{v \max }\right|=\frac{\left.V_{D D}-V_{O V}\right|_{\mathrm{B}}}{\left.V_{O V}\right|_{\mathrm{B}} / 2}
$$

where $\left.V_{O V}\right|_{\mathrm{B}}$ is given by Eq. (7.7). Of course, this result is only of theoretical importance since biasing at B would leave no room for negative signal swing at the output. Nevertheless, the result in Eq. (7.18) is valuable as it provides an upper bound on the magnitude of voltage gain achievable from this basic amplifier circuit. As an example, for a discrete-circuit amplifier operated with $V_{D D}=5 \mathrm{~V}$ and $\left.V_{O V}\right|_{\mathrm{B}}=0.5 \mathrm{~V}$, the maximum achievable gain is $18 \mathrm{~V} / \mathrm{V}$. An integrated-circuit amplifier utilizing a modern submicron MOSFET operated with $V_{D D}=1.3 \mathrm{~V}$ and with $\left.V_{O V}\right|_{\mathrm{B}}=0.2 \mathrm{~V}$ realizes a maximum gain of $11 \mathrm{~V} / \mathrm{V}$.

Finally, note that to maximize the gain, the bias point Q should be as close to point B as possible, consistent with the required signal swing at the output. This point will be explored further in the end-of-chapter problems.

# Example 7.1 

Consider the amplifier circuit shown in Fig. 7.4(a). The transistor is specified to have $V_{i}=0.4 \mathrm{~V}, k_{u}^{\prime}=$ $0.4 \mathrm{~mA} / \mathrm{V}^{2}, W / L=10$, and $\lambda=0$. Also, let $V_{D D}=1.8 \mathrm{~V}, R_{D}=17.5 \mathrm{k} \Omega$, and $V_{G S}=0.6 \mathrm{~V}$.
(a) For $v_{g s}=0$ (and hence $v_{d s}=0$ ), find $V_{O V}, I_{D}, V_{D S}$, and $A_{v}$.
(b) What is the maximum symmetrical signal swing allowed at the drain? Hence, find the maximum allowable amplitude of a sinusoidal $v_{g s}$.

## Solution

(a) With $V_{G S}=0.6 \mathrm{~V}, V_{O V}=0.6-0.4=0.2 \mathrm{~V}$. Thus,

$$
\begin{aligned}
I_{D} & =\frac{1}{2} k_{v}\left(\frac{W}{L}\right) V_{O V}^{2} \\
& =\frac{1}{2} \times 0.4 \times 10 \times 0.2^{2}=0.08 \mathrm{~mA} \\
V_{D S} & =V_{D D}-R_{D} I_{D} \\
& =1.8-17.5 \times 0.08=0.4 \mathrm{~V}
\end{aligned}
$$

Since $V_{D S}$ is greater than $V_{O V}$, the transistor is indeed operating in saturation. The voltage gain can be found from Eq. (7.15),

$$
\begin{aligned}
A_{v} & =-k_{u} V_{O V} R_{D} \\
& =-0.4 \times 10 \times 0.2 \times 17.5 \\
& =-14 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

An identical result can be found using Eq. (7.17).
(b) Since $V_{O V}=0.2 \mathrm{~V}$ and $V_{D S}=0.4 \mathrm{~V}$, we see that the maximum allowable negative signal swing at the drain is 0.2 V . In the positive direction, a swing of +0.2 V would not cause the transistor to
# Example 7.1 continued 

cut off (since the resulting $v_{D S}$ would be still lower than $V_{D D}$ ) and thus is allowed. Thus the maximum symmetrical signal swing allowable at the drain is $\pm 0.2 \mathrm{~V}$. The corresponding amplitude of $v_{g s}$ can be found from

$$
\hat{v}_{g s}=\frac{\hat{v}_{d s}}{\left|A_{v}\right|}=\frac{0.2 \mathrm{~V}}{14}=14.2 \mathrm{mV}
$$

Since $\hat{v}_{g s} \ll V_{O V}$, the operation will be reasonably linear (more on this in later sections).
Greater insight into the issue of allowable signal swing can be obtained by examining the signal waveforms shown in Fig. 7.5. Note that for the MOSFET to remain in saturation at the negative peak of $v_{d s}$, we must ensure that

$$
v_{D S \min } \geq v_{G S \max }-V_{t}
$$

that is,

$$
0.4-\left|A_{v}\right| \hat{v}_{g s} \geq 0.6+\hat{v}_{g s}-0.4
$$

which results in

$$
\hat{v}_{g s} \leq \frac{0.2}{\left|A_{v}\right|+1}=13.3 \mathrm{mV}
$$

This result differs slightly from the one obtained earlier.


Figure 7.5 Signal waveforms at gate and drain for the amplifier in Example 7.1. Note that to ensure operation in the saturation region at all times, $v_{D S \min } \geq v_{G S \max }-V_{t}$.
# EXERCISE 

D7.2 For the amplifier circuit studied in Example 7.1, create two alternative designs, each providing a voltage gain of -10 by (a) changing $R_{D}$ while keeping $V_{O V}$ constant and (b) changing $V_{O V}$ while keeping $R_{D}$ constant. For each design, specify $V_{G S}, I_{D}, R_{D}$, and $V_{D S}$.
Ans. (a) $0.6 \mathrm{~V}, 0.08 \mathrm{~mA}, 12.5 \mathrm{k} \Omega, 0.8 \mathrm{~V}$; (b) $0.54 \mathrm{~V}, 0.04 \mathrm{~mA}, 17.5 \mathrm{k} \Omega, 1.1 \mathrm{~V}$

The BJT Case A similar development can be used to obtain the small-signal voltage gain of the BJT amplifier shown in Fig. 7.6,

$$
A_{v}=\left.\frac{d v_{C E}}{d v_{B E}}\right|_{v_{B E}=V_{B E}}
$$

Utilizing Eq. (7.9) together with Eq. (7.12), we obtain

$$
A_{v}=-\left(\frac{I_{C}}{V_{T}}\right) R_{C}
$$

We make the following observations on this expression for the voltage gain:

1. The gain is negative, which signifies that the amplifier is inverting; that is, there is a $180^{\circ}$ phase shift between the input and the output. This inversion should have been anticipated from Eq. (7.9).
2. The gain is proportional to the collector bias current $I_{C}$ and to the load resistance $R_{C}$.

Additional insight into the voltage gain $A_{v}$ can be obtained by expressing Eq. (7.20) as

$$
A_{v}=-\frac{I_{C} R_{C}}{V_{T}}
$$



Figure 7.6 BJT amplifier biased at a point $Q$, with a small voltage signal $v_{b e}$ superimposed on the dc bias voltage $V_{B E}$. The resulting output signal $v_{c e}$ appears superimposed on the dc collector voltage $V_{C E}$. The amplitude of $v_{c e}$ is larger than that of $v_{b e}$ by the voltage gain $A_{v}$.
That is, the gain is the ratio of the dc voltage drop across the load resistance $R_{C}$ to the physical constant $V_{T}$ (recall that the thermal voltage $V_{T} \simeq 25 \mathrm{mV}$ at room temperature). This relationship is similar in form to that for the MOSFET (Eq. 7.16) except that here the denominator is a physical constant $\left(V_{T}\right)$ rather than a design parameter $\left(V_{O V} / 2\right)$. Usually, $V_{O V} / 2$ is larger than $\left(V_{T}\right)$, thus we can obtain higher voltage gain from the BJT amplifier than from the MOSFET amplifier. This should not be surprising, as the exponential $i_{C}-v_{B E}$ relationship is much steeper than the square-law relationship $i_{D}-v_{G S}$.

The gain $A_{v}$ in Eq. (7.21) can be expressed alternately as

$$
A_{v}=-\frac{V_{C C}-V_{C E}}{V_{T}}
$$

from which we see that maximum gain is achieved when $V_{C E}$ is at its minimum value of about 0.3 V ,

$$
\left|A_{v \max }\right|=\frac{V_{C C}-0.3}{V_{T}}
$$

Here again, this is only a theoretical maximum, since biasing the BJT at the edge of saturation leaves no room for negative signal swing at the output. Equation (7.23) nevertheless provides an upper bound on the voltage gain achievable from the basic BJT amplifier. As an example, for $V_{C C}=5 \mathrm{~V}$, the maximum gain is $188 \mathrm{~V} / \mathrm{V}$, considerably larger than in the MOSFET case. For modern low-voltage technologies, a $V_{C C}$ of 1.3 V provides a gain of $40 \mathrm{~V} / \mathrm{V}$, again much larger than the MOSFET case. The reader should not, however, jump to the conclusion that the BJT is preferred to the MOSFET in the design of modern integrated-circuit amplifiers; in fact, the opposite is true, as we shall see in Chapter 8 and beyond.

Finally, we conclude from Eq. (7.22) that to maximize $\left|A_{v}\right|$ the transistor should be biased at the lowest possible $V_{C E}$ consistent with the desired value of negative signal swing at the output.

# Example 7.2 

Consider an amplifier circuit using a BJT having $I_{S}=10^{-15} \mathrm{~A}$, a collector resistance $R_{C}=6.8 \mathrm{k} \Omega$, and a power supply $V_{C C}=10 \mathrm{~V}$.
(a) Determine the value of the bias voltage $V_{B E}$ required to operate the transistor at $V_{C E}=3.2 \mathrm{~V}$. What is the corresponding value of $I_{C}$ ?
(b) Find the voltage gain $A_{v}$ at this bias point. If an input sine-wave signal of $5-\mathrm{mV}$ peak amplitude is superimposed on $V_{B E}$, find the amplitude of the output sine-wave signal (assume linear operation).
(c) Find the positive increment in $v_{B E}$ (above $V_{B E}$ ) that drives the transistor to the edge of saturation, where $v_{C E}=0.3 \mathrm{~V}$.
(d) Find the negative increment in $v_{B E}$ that drives the transistor to within $1 \%$ of cutoff (i.e., to $v_{C E}=0.99 V_{C C}$ ).
# Solution 

(a)

$$
\begin{aligned}
I_{C} & =\frac{V_{C C}-V_{C E}}{R_{C}} \\
& =\frac{10-3.2}{6.8}=1 \mathrm{~mA}
\end{aligned}
$$

The value of $V_{B E}$ can be determined from

$$
1 \times 10^{-3}=10^{-15} e^{V_{B E} / V_{T}}
$$

which results in

$$
V_{B E}=690.8 \mathrm{mV}
$$

(b)

$$
\begin{aligned}
A_{v} & =-\frac{V_{C C}-V_{C E}}{V_{T}} \\
& =\frac{10-3.2}{0.025}=-272 \mathrm{~V} / \mathrm{V} \\
\hat{v}_{c e} & =272 \times 0.005=1.36 \mathrm{~V}
\end{aligned}
$$

(c) For $v_{C E}=0.3 \mathrm{~V}$,

$$
i_{C}=\frac{10-0.3}{6.8}=1.617 \mathrm{~mA}
$$

To increase $i_{C}$ from 1 mA to $1.617 \mathrm{~mA}, v_{B E}$ must be increased by

$$
\begin{aligned}
\Delta v_{B E} & =V_{T} \ln \left(\frac{1.617}{1}\right) \\
& =12 \mathrm{mV}
\end{aligned}
$$

(d) For $v_{C E}=0.99 V_{C C}=9.9 \mathrm{~V}$,

$$
i_{C}=\frac{10-9.9}{6.8}=0.0147 \mathrm{~mA}
$$

To decrease $i_{C}$ from 1 mA to $0.0147 \mathrm{~mA}, v_{B E}$ must change by

$$
\begin{aligned}
\Delta v_{B E} & =V_{T} \ln \left(\frac{0.0147}{1}\right) \\
& =-105.5 \mathrm{mV}
\end{aligned}
$$
# EXERCISE 

7.3 For the situation described in Example 7.2, while keeping $I_{c}$ unchanged at 1 mA , find the value of $R_{c}$ that will result in a voltage gain of $-320 \mathrm{~V} / \mathrm{V}$. What is the largest negative signal swing allowed at the output (assume that $v_{c E}$ is not to decrease below 0.3 V )? What (approximately) is the corresponding input signal amplitude? (Assume linear operation.)
Ans. $8 \mathrm{k} \Omega ; 1.7 \mathrm{~V} ; 5.3 \mathrm{mV}$

### 7.1.6 Determining the VTC by Graphical Analysis

Figure 7.7 shows a graphical method for determining the VTC of the amplifier of Fig. 7.4(a). Although graphical analysis of transistor circuits is rarely employed in practice, it is useful to us at this stage for gaining greater insight into circuit operation, especially in answering the question of where to locate the bias point Q .

The graphical analysis is based on the observation that for each value of $v_{G S}$, the circuit will be operating at the point of intersection of the $i_{D}-v_{D S}$ graph corresponding to the particular


Figure 7.7 Graphical construction to determine the voltage-transfer characteristic of the amplifier in Fig. 7.4(a).


Figure 7.8 Operation of the MOSFET in Fig. 7.4(a) as a switch: (a) open, corresponding to point A in Fig. 7.7; (b) closed, corresponding to point C in Fig. 7.7. The closure resistance is approximately equal to $r_{D S}$ because $V_{D S}$ is usually very small.
value of $v_{G S}$ and the straight line representing Eq. (7.3), which can be rewritten in the form

$$
i_{D}=\frac{V_{D D}}{R_{D}}-\frac{1}{R_{D}} v_{D S}
$$

The straight line representing this relationship is superimposed on the $i_{D}-v_{D S}$ characteristics in Fig. 7.7. It intersects the horizontal axis at $v_{D S}=V_{D D}$ and has a slope of $-1 / R_{D}$. Since this straight line represents in effect the load resistance $R_{D}$, it is called the load line. The VTC is then determined point by point. Note that we have labeled four important points: point A at which $v_{G S}=V_{i}$, point Q at which the MOSFET can be biased for amplifier operation ( $v_{G S}=V_{G S}$ and $v_{D S}=V_{D S}$ ), point B at which the MOSFET leaves saturation and enters the triode region, and point C , which is deep into the triode region and for which $v_{G S}=V_{D D}$. If the MOSFET is to be used as a switch, then operating points A and C are applicable: At A the transistor is off (open switch), and at C the transistor operates as a low-valued resistance $r_{D S}$ and has a small voltage drop (closed switch). The incremental resistance at point C is also known as the closure resistance. The operation of the MOSFET as a switch is illustrated in Fig. 7.8. A detailed study of the application of the MOSFET as a switch is undertaken in Chapter 14, dealing with CMOS digital logic circuits.

The graphical analysis method above can be applied to determine the VTC of the BJT amplifier in Fig. 7.2(c). Here point A, Fig. 7.2(d), corresponds to the BJT just turning on $\left(v_{B E} \simeq 0.5 \mathrm{~V}\right)$ and point B corresponds to the BJT leaving the active region and entering the saturation region. If the BJT is to be operated as a switch, the two modes of operation are cutoff (open switch) and saturation (closed switch). As discussed in Section 6.2, in saturation, the BJT has a small closure resistance $R_{C E \text { sat }}$ as well as an offset voltage. More seriously, switching the BJT out of its saturation region can require a relatively long delay time to ensure the removal of the charge stored in the BJT base region. This phenomenon has made the BJT much less attractive in digital logic applications relative to the MOSFET. ${ }^{2}$

# 7.1.7 Deciding on a Location for the Bias Point Q 

For the MOSFET amplifier, the bias point Q is determined by the value of $V_{G S}$ and that of the load resistance $R_{D}$. Two important considerations in deciding on the location of Q

[^0]
[^0]:    ${ }^{2}$ The only exception is a nonsaturating form of BJT logic circuits known as emitter-coupled logic (ECL).# EXERCISES 

1.5 Find the frequencies $f$ and $\omega$ of a sine-wave signal with a period of 1 ms . Ans. $f=1000 \mathrm{~Hz} ; \omega=2 \pi \times 10^{7} \mathrm{rad} / \mathrm{s}$
1.6 What is the period $T$ of sine waveforms characterized by frequencies of (a) $f=60 \mathrm{~Hz}$ ? (b) $f=10^{-3} \mathrm{~Hz}$ ?
(c) $f=1 \mathrm{MHz}$ ?

Ans. $16.7 \mathrm{~ms} ; 1000 \mathrm{~s} ; 1 \mu \mathrm{~s}$
1.7 The UHF (ultra high frequency) television broadcast band begins with channel 14 and extends from 470 MHz to 806 MHz . If 6 MHz is allocated for each channel, how many channels can this band accommodate?
Ans. 56; channels 14 to 69
1.8 When the square-wave signal of Fig. 1.5, whose Fourier series is given in Eq. (1.2), is applied to a resistor, the total power dissipated may be calculated directly using the relationship $P=1 / T \int_{0}^{T}\left(v^{2} / R\right) d t$ or indirectly by summing the contribution of each of the harmonic components, that is, $P=P_{1}+P_{2}+$ $P_{5}+\ldots$, which may be found directly from rms values. Verify that the two approaches are equivalent. What fraction of the energy of a square wave is in its fundamental? In its first five harmonics? In its first seven? First nine? In what number of harmonics is $90 \%$ of the energy? (Note that in counting harmonics, the fundamental at $\omega_{0}$ is the first, the one at $2 \omega_{0}$ is the second, etc.)
Ans. $0.81 ; 0.93 ; 0.95 ; 0.96 ; 3$

### 1.3 Analog and Digital Signals

The voltage signal depicted in Fig. 1.3 is called an analog signal. The name derives from the fact that such a signal is analogous to the physical signal that it represents. The magnitude of an analog signal can take on any value; that is, the amplitude of an analog signal exhibits a continuous variation over its range of activity. The vast majority of signals in the world around us are analog. Electronic circuits that process such signals are known as analog circuits. A variety of analog circuits will be studied in this book.

An alternative form of signal representation is that of a sequence of numbers, each number representing the signal magnitude at an instant of time. The resulting signal is called a digital signal. To see how a signal can be represented in this form-that is, how signals can be converted from analog to digital form-consider Fig. 1.8(a). Here the curve represents a voltage signal, identical to that in Fig. 1.3. At equal intervals along the time axis, we have marked the time instants $t_{0}, t_{1}, t_{2}$, and so on. At each of these time instants, the magnitude of the signal is measured, a process known as sampling. Figure 1.8(b) shows a representation of the signal of Fig. 1.8(a) in terms of its samples. The signal of Fig. 1.8(b) is defined only at the sampling instants; it no longer is a continuous function of time; rather, it is a discrete-time signal. However, since the magnitude of each sample can take any value in a continuous range, the signal in Fig. 1.8(b) is still an analog signal.

Now if we represent the magnitude of each of the signal samples in Fig. 1.8(b) by a number having a finite number of digits, then the signal amplitude will no longer be continuous; rather,


Figure 1.8 Sampling the continuous-time analog signal in (a) results in the discrete-time signal in (b).
it is said to be quantized, discretized, or digitized. The resulting digital signal then is simply a sequence of numbers that represent the magnitudes of the successive signal samples.

The choice of number system to represent the signal samples affects the type of digital signal produced and has a profound effect on the complexity of the digital circuits required to process the signals. It turns out that the binary number system results in the simplest possible digital signals and circuits. In a binary system, each digit in the number takes on one of only two possible values, denoted 0 and 1 . Correspondingly, the digital signals in binary systems need have only two voltage levels, which can be labeled low and high. As an example, in some of the digital circuits studied in this book, the levels are 0 V and +5 V . Figure 1.9 shows the time variation of such a digital signal. Observe that the waveform is a pulse train with 0 V representing a 0 signal, or logic 0 , and +5 V representing logic 1 .

If we use $N$ binary digits (bits) to represent each sample of the analog signal, then the digitized sample value can be expressed as

$$
D=b_{0} 2^{0}+b_{1} 2^{1}+b_{2} 2^{2}+\cdots+b_{N-1} 2^{N-1}
$$

where $b_{0}, b_{1}, \ldots, b_{N-1}$, denote the $N$ bits and have values of 0 or 1 . Here bit $b_{0}$ is the least significant bit (LSB), and bit $b_{N-1}$ is the most significant bit (MSB). Conventionally, this binary number is written as $b_{N-1} b_{N-2} \ldots b_{0}$. We observe that such a representation quantizes the analog sample into one of $2^{N}$ levels. Obviously the greater the number of bits (i.e., the larger the $N$ ), the closer the digital word $D$ approximates the magnitude of the analog sample. That is, increasing the number of bits reduces the quantization error and increases the resolution of the


Figure 1.9 Variation of a particular binary digital signal with time.


Figure 1.10 Block-diagram representation of the analog-to-digital converter (ADC).
analog-to-digital conversion. This improvement is, however, usually obtained at the expense of more complex and hence more costly circuit implementations. It is not our purpose here to delve into this topic any deeper; we merely want the reader to appreciate the nature of analog and digital signals. Nevertheless, it is an opportune time to introduce a very important circuit building block of modern electronic systems: the analog-to-digital converter (A/D or ADC) shown in block form in Fig. 1.10. The ADC accepts at its input the samples of an analog signal and provides for each input sample the corresponding $N$-bit digital representation (according to Eq. 1.3) at its $N$ output terminals. Thus although the voltage at the input might be, say, 6.51 V , at each of the output terminals (say, at the $i$ th terminal), the voltage will be either low $(0 \mathrm{~V})$ or high $(5 \mathrm{~V})$ if $b_{i}$ is supposed to be 0 or 1 , respectively. The dual circuit of the ADC is the digital-to-analog converter (D/A or DAC). It converts an $N$-bit digital input to an analog output voltage.

Once the signal is in digital form, it can be processed using digital circuits. Of course digital circuits can deal also with signals that do not have an analog origin, such as the signals that represent the various instructions of a digital computer.

Since digital circuits deal exclusively with binary signals, their design is simpler than that of analog circuits. Furthermore, digital systems can be designed using a relatively few different kinds of digital circuit blocks. However, a large number (e.g., hundreds of thousands or even millions) of each of these blocks are usually needed. Thus the design of digital circuits poses its own set of challenges to the designer but provides reliable and economic implementations of a great variety of signal-processing functions, many of which are not possible with analog circuits. At the present time, more and more of the signal-processing functions are being performed digitally. Examples around us abound: from the digital watch and the calculator to digital audio systems, digital cameras, and digital television. Moreover, some long-standing
analog systems such as the telephone communication system are now almost entirely digital. And we should not forget the most important of all digital systems, the digital computer.

The basic building blocks of digital systems are logic circuits and memory circuits. We shall study both in this book, beginning in Chapter 14.

One final remark: Although the digital processing of signals is at present all-pervasive, there remain many signal-processing functions that are best performed by analog circuits. Indeed, many electronic systems include both analog and digital parts. It follows that a good electronics engineer must be proficient in the design of both analog and digital circuits, or mixed-signal or mixed-mode design as it is currently known. Such is the aim of this book.

# EXERCISE 

1.9 Consider a 4-bit digital word $D=b_{1} b_{2} b_{1} b_{0}$ (see Eq. 1.3) used to represent an analog signal $v_{A}$ that varies between 0 V and +15 V .
(a) Give $D$ corresponding to $v_{A}=0 \mathrm{~V}, 1 \mathrm{~V}, 2 \mathrm{~V}$, and 15 V .
(b) What change in $v_{A}$ causes a change from 0 to 1 in (i) $b_{0}$, (ii) $b_{1}$, (iii) $b_{2}$, and (iv) $b_{3}$ ?
(c) If $v_{A}=5.2 \mathrm{~V}$, what do you expect $D$ to be? What is the resulting error in representation?

Ans. (a) $0000,0001,0010,1111$; (b) $+1 \mathrm{~V},+2 \mathrm{~V},+4 \mathrm{~V},+8 \mathrm{~V}$; (c) $0101,-4 \%$

## ANALOG VS. DIGITAL CIRCUIT ENGINEERS:

As digital became the preferred implementation of more and more signal-processing functions, the need arose for greater numbers of digital circuit design engineers. Yet despite predictions made periodically that the demand for analog circuit design engineers would lessen, this has not been the case. Rather, the demand for analog engineers has, if anything, increased. What is true, however, is that the skill level required of analog engineers has risen. Not only are they asked to design circuits of greater sophistication and tighter specifications, but they also have to do this using technologies that are optimized for digital (and not analog) circuits. This is dictated by economics, as digital usually constitutes the larger part of most systems.

### 1.4 Amplifiers

In this section, we shall introduce the most fundamental signal-processing function, one that is employed in some form in almost every electronic system, namely, signal amplification. We shall study the amplifier as a circuit building block; that is, we shall consider its external characteristics and leave the design of its internal circuit to later chapters.

### 1.4.1 Signal Amplification

From a conceptual point of view the simplest signal-processing task is that of signal amplification. The need for amplification arises because transducers provide signals that
are said to be "weak," that is, in the microvolt $(\mu \mathrm{V})$ or millivolt ( mV ) range and possessing little energy. Such signals are too small for reliable processing, and processing is much easier if the signal magnitude is made larger. The functional block that accomplishes this task is the signal amplifier.

It is appropriate at this point to discuss the need for linearity in amplifiers. Care must be exercised in the amplification of a signal, so that the information contained in the signal is not changed and no new information is introduced. Thus when we feed the signal shown in Fig. 1.3 to an amplifier, we want the output signal of the amplifier to be an exact replica of that at the input, except of course for having larger magnitude. In other words, the "wiggles" in the output waveform must be identical to those in the input waveform. Any change in waveform is considered to be distortion and is obviously undesirable.

An amplifier that preserves the details of the signal waveform is characterized by the relationship

$$
v_{o}(t)=A v_{i}(t)
$$

where $v_{i}$ and $v_{o}$ are the input and output signals, respectively, and $A$ is a constant representing the magnitude of amplification, known as amplifier gain. Equation (1.4) is a linear relationship; hence the amplifier it describes is a linear amplifier. It should be easy to see that if the relationship between $v_{o}$ and $v_{i}$ contains higher powers of $v_{i}$, then the waveform of $v_{o}$ will no longer be identical to that of $v_{i}$. The amplifier is then said to exhibit nonlinear distortion.

The amplifiers discussed so far are primarily intended to operate on very small input signals. Their purpose is to make the signal magnitude larger, and therefore they are thought of as voltage amplifiers. The preamplifier in the home stereo system is an example of a voltage amplifier.

At this time we wish to mention another type of amplifier, namely, the power amplifier. Such an amplifier may provide only a modest amount of voltage gain but substantial current gain. Thus while absorbing little power from the input signal source to which it is connected, often a preamplifier, it delivers large amounts of power to its load. An example is found in the power amplifier of the home stereo system, whose purpose is to provide sufficient power to drive the loudspeaker, which is the amplifier load. Here we should note that the loudspeaker is the output transducer of the stereo system; it converts the electric output signal of the system into an acoustic signal. A further appreciation of the need for linearity can be acquired by reflecting on the power amplifier. A linear power amplifier causes both soft and loud music passages to be reproduced without distortion.

# 1.4.2 Amplifier Circuit Symbol 

The signal amplifier is obviously a two-port circuit. Its function is conveniently represented by the circuit symbol of Fig. 1.11(a). This symbol clearly distinguishes the input and output ports and indicates the direction of signal flow. Thus, in subsequent diagrams it will not be necessary to label the two ports "input" and "output." For generality we have shown the amplifier to have two input terminals that are distinct from the two output terminals. A more common situation is illustrated in Fig. 1.11(b), where a common terminal exists between the input and output ports of the amplifier. This common terminal is used as a reference point and is called the circuit ground.


Figure 1.11 (a) Circuit symbol for amplifier. (b) An amplifier with a common terminal (ground) between the input and output ports.


Figure 1.12 (a) A voltage amplifier fed with a signal $v_{I}(t)$ and connected to a load resistance $R_{L}$. (b) Transfer characteristic of a linear voltage amplifier with voltage gain $A_{v}$.

# 1.4.3 Voltage Gain 

A linear amplifier accepts an input signal $v_{I}(t)$ and provides at the output, across a load resistance $R_{L}$ (see Fig. 1.12(a)), an output signal $v_{O}(t)$ that is a magnified replica of $v_{I}(t)$. The voltage gain of the amplifier is defined by

$$
\text { Voltage gain }\left(A_{v}\right)=\frac{v_{O}}{v_{I}}
$$

Fig. 1.12(b) shows the transfer characteristic of a linear amplifier. If we apply to the input of this amplifier a sinusoidal voltage of amplitude $\hat{V}$, we obtain at the output a sinusoid of amplitude $A_{v} \hat{V}$.

### 1.4.4 Power Gain and Current Gain

An amplifier increases the signal power, an important feature that distinguishes an amplifier from a transformer. In the case of a transformer, although the voltage delivered to the load could be greater than the voltage feeding the input side (the primary), the power delivered to the load (from the secondary side of the transformer) is less than or at most equal to the
power supplied by the signal source. On the other hand, an amplifier provides the load with power greater than that obtained from the signal source. That is, amplifiers have power gain. The power gain of the amplifier in Fig. 1.12(a) is defined as

$$
\begin{aligned}
\text { Power gain }\left(A_{p}\right) & \equiv \frac{\text { load power }\left(P_{L}\right)}{\text { input power }\left(P_{I}\right)} \\
& =\frac{v_{O} i_{O}}{v_{I} i_{I}}
\end{aligned}
$$

where $i_{O}$ is the current that the amplifier delivers to the load $\left(R_{L}\right), i_{O}=v_{O} / R_{L}$, and $i_{I}$ is the current the amplifier draws from the signal source. The current gain of the amplifier is defined as

$$
\text { Current gain }\left(A_{i}\right) \equiv \frac{i_{O}}{i_{I}}
$$

From Eqs. (1.5) to (1.8) we note that

$$
A_{p}=A_{v} A_{i}
$$

# 1.4.5 Expressing Gain in Decibels 

The amplifier gains defined above are ratios of similarly dimensioned quantities. Thus they will be expressed either as dimensionless numbers or, for emphasis, as V/V for the voltage gain, A/A for the current gain, and W/W for the power gain. Alternatively, for a number of reasons, some of them historic, electronics engineers express amplifier gain with a logarithmic measure. Specifically the voltage gain $A_{v}$ can be expressed as

$$
\text { Voltage gain in decibels }=20 \log \left|A_{v}\right| \quad \mathrm{~dB}
$$

and the current gain $A_{i}$ can be expressed as

$$
\text { Current gain in decibels }=20 \log \left|A_{i}\right| \quad \mathrm{~dB}
$$

Since power is related to voltage (or current) squared, the power gain $A_{p}$ can be expressed in decibels as

$$
\text { Power gain in decibels }=10 \log A_{p} \quad \mathrm{~dB}
$$

The absolute values of the voltage and current gains are used because in some cases $A_{v}$ or $A_{i}$ will be a negative number. A negative gain $A_{v}$ simply means that there is a $180^{\circ}$ phase difference between input and output signals; it does not imply that the amplifier is attenuating the signal. On the other hand, an amplifier whose voltage gain is, say, -20 dB is in fact attenuating the input signal by a factor of 10 (i.e., $A_{v}=0.1 \mathrm{~V} / \mathrm{V}$ ).

### 1.4.6 The Amplifier Power Supplies

Since the power delivered to the load is greater than the power drawn from the signal source, the question arises as to the source of this additional power. The answer is found by observing that amplifiers need dc power supplies for their operation. These dc sources supply the extra power delivered to the load as well as any power that might be dissipated in the internal circuit


Figure 1.13 An amplifier that requires two dc supplies (shown as batteries) for operation.
of the amplifier (such power is converted to heat). In Fig. 1.12(a) we have not explicitly shown these dc sources.

Figure 1.13(a) shows an amplifier that requires two dc sources: one positive of value $V_{C C}$ and one negative of value $V_{E E}$. The amplifier has two terminals, labeled $V^{+}$and $V^{-}$, for connection to the dc supplies. For the amplifier to operate, the terminal labeled $V^{+}$has to be connected to the positive side of a dc source whose voltage is $V_{C C}$ and whose negative side is connected to the circuit ground. Also, the terminal labeled $V^{-}$has to be connected to the negative side of a dc source whose voltage is $V_{E E}$ and whose positive side is connected to the circuit ground. Now, if the current drawn from the positive supply is denoted $I_{C C}$ and that from the negative supply is $I_{E E}$ (see Fig. 1.13a), then the dc power delivered to the amplifier is

$$
P_{\mathrm{dc}}=V_{C C} I_{C C}+V_{E E} I_{E E}
$$

If the power dissipated in the amplifier circuit is denoted $P_{\text {dissipated }}$, the power-balance equation for the amplifier can be written as

$$
P_{\mathrm{dc}}+P_{I}=P_{L}+P_{\text {dissipated }}
$$

where $P_{I}$ is the power drawn from the signal source and $P_{L}$ is the power delivered to the load. Since the power drawn from the signal source is usually small, the amplifier power efficiency is defined as

$$
\eta \equiv \frac{P_{L}}{P_{\mathrm{dc}}} \times 100
$$

The power efficiency is an important performance parameter for amplifiers that handle large amounts of power. Such amplifiers, called power amplifiers, are used, for example, as output amplifiers of stereo systems.

In order to simplify circuit diagrams, we shall adopt the convention illustrated in Fig. 1.13(b). Here the $V^{+}$terminal is shown connected to an arrowhead pointing upward and the $V^{-}$terminal to an arrowhead pointing downward. The corresponding voltage is indicated next to each arrowhead. Note that in many cases we will not explicitly show the connections
of the amplifier to the dc power sources. Finally, we note that some amplifiers require only one power supply.

# Example 1.2 

Consider an amplifier operating from $\pm 10-\mathrm{V}$ power supplies. It is fed with a sinusoidal voltage having 1 V peak and delivers a sinusoidal voltage output of 9 V peak to a $1-\mathrm{k} \Omega$ load. The amplifier draws a current of 9.5 mA from each of its two power supplies. The input current of the amplifier is found to be sinusoidal with 0.1 mA peak. Find the voltage gain, the current gain, the power gain, the power drawn from the dc supplies, the power dissipated in the amplifier, and the amplifier efficiency.

## Solution

$$
A_{v}=\frac{9}{1}=9 \mathrm{~V} / \mathrm{V}
$$

or

$$
\begin{aligned}
& A_{v}=20 \log 9=19.1 \mathrm{~dB} \\
& \hat{I}_{o}=\frac{9 \mathrm{~V}}{1 \mathrm{k} \Omega}=9 \mathrm{~mA} \\
& A_{i}=\frac{\hat{I}_{o}}{\hat{I}_{i}}=\frac{9}{0.1}=90 \mathrm{~A} / \mathrm{A}
\end{aligned}
$$

or

$$
\begin{aligned}
& A_{i}=20 \log 90=39.1 \mathrm{~dB} \\
& P_{L}=V_{\text {nons }} I_{\text {nons }}=\frac{9}{\sqrt{2}} \frac{9}{\sqrt{2}}=40.5 \mathrm{~mW} \\
& P_{I}=V_{\text {tens }} I_{\text {tens }}=\frac{1}{\sqrt{2}} \frac{0.1}{\sqrt{2}}=0.05 \mathrm{~mW} \\
& A_{p}=\frac{P_{L}}{P_{I}}=\frac{40.5}{0.05}=810 \mathrm{~W} / \mathrm{W}
\end{aligned}
$$

or

$$
\begin{aligned}
A_{p} & =10 \log 810=29.1 \mathrm{~dB} \\
P_{\mathrm{dc}} & =10 \times 9.5+10 \times 9.5=190 \mathrm{~mW} \\
P_{\text {dissipated }} & =P_{\mathrm{dc}}+P_{I}-P_{L} \\
& =190+0.05-40.5=149.6 \mathrm{~mW} \\
\eta & =\frac{P_{L}}{P_{\mathrm{dc}}} \times 100=21.3 \%
\end{aligned}
$$

From the above example we observe that the amplifier converts some of the dc power it draws from the power supplies to signal power that it delivers to the load.
# 1.4.7 Amplifier Saturation 

Practically speaking, the amplifier transfer characteristic remains linear over only a limited range of input and output voltages. For an amplifier operated from two power supplies the output voltage cannot exceed a specified positive limit and cannot decrease below a specified negative limit. The resulting transfer characteristic is shown in Fig. 1.14, with the positive and negative saturation levels denoted $L_{+}$and $L_{-}$, respectively. Each of the two saturation levels is usually within a fraction of a volt of the voltage of the corresponding power supply.

Obviously, in order to avoid distorting the output signal waveform, the input signal swing must be kept within the linear range of operation,

$$
\frac{L_{-}}{A_{v}} \leq v_{i} \leq \frac{L_{+}}{A_{v}}
$$

In Fig. 1.14, which shows two input waveforms and the corresponding output waveforms, the peaks of the larger waveform have been clipped off because of amplifier saturation.


Figure 1.14 An amplifier transfer characteristic that is linear except for output saturation.

Figure 7.9 Two load lines and corresponding bias points. Bias point $\mathrm{Q}_{1}$ does not leave sufficient room for positive signal swing at the drain (too close to $V_{D D}$ ). Bias point $\mathrm{Q}_{2}$ is too close to the boundary of the triode region and might not allow for sufficient negative signal swing.
are the required gain and the desired signal swing at the output. To illustrate, consider the VTC shown in Fig. 7.4(b). Here the value of $R_{D}$ is fixed and the only variable remaining is the value of $V_{G S}$. Since the slope increases as we move closer to point B , we obtain higher gain by locating Q as close to B as possible. However, the closer Q is to the boundary point B , the smaller the allowable magnitude of negative signal swing. Thus, as often happens in engineering design, we encounter a situation requiring a trade-off. The answer here is relatively simple: For a given $R_{D}$, locate Q as close to the triode region (point B) as possible to obtain high gain but sufficiently distant to allow for the required negative signal swing.

In deciding on a value for $R_{D}$, it is useful to refer to the $i_{D}-v_{D S}$ plane. Figure 7.9 shows two load lines resulting in two extreme bias points: Point $\mathrm{Q}_{1}$ is too close to $V_{D D}$, resulting in a severe constraint on the positive signal swing of $v_{d s}$. Exceeding the allowable positive maximum results in the positive peaks of the signal being clipped off, since the MOSFET will turn off for the part of each cycle near the positive peak. We speak of this situation by saying that the circuit does not have sufficient "headroom." Similarly, point $\mathrm{Q}_{2}$ is too close to the boundary of the triode region, thus severely limiting the allowable negative signal swing of $v_{d s}$. Exceeding this limit would result in the transistor entering the triode region for part of each cycle near the negative peaks, resulting in a distorted output signal. In this situation we say that the circuit does not have sufficient "legroom." We will have more to say on bias design in Section 7.4.

Finally, we note that exactly similar considerations apply to the case of the BJT amplifier.
# 7.2 Small-Signal Operation and Models 

In our study of the operation of the MOSFET and BJT amplifiers in Section 7.1 we learned that linear amplification can be obtained by biasing the transistor to operate in the active region and by keeping the input signal small. In this section, we explore the small-signal operation in greater detail.

### 7.2.1 The MOSFET Case

Consider the conceptual amplifier circuit shown in Fig. 7.10. Here the MOS transistor is biased by applying a dc voltage ${ }^{3} V_{G S}$, and the input signal to be amplified, $v_{g s}$, is superimposed on the dc bias voltage $V_{G S}$. The output voltage is taken at the drain.

The DC Bias Point The dc bias current $I_{D}$ can be found by setting the signal $v_{g s}$ to zero; thus,

$$
I_{D}=\frac{1}{2} k_{n}\left(V_{G S}-V_{i}\right)^{2}=\frac{1}{2} k_{n} V_{D V}^{2}
$$

where we have neglected channel-length modulation (i.e., we have assumed $\lambda=0$ ). Here $V_{D V}=V_{G S}-V_{i}$ is the overdrive voltage at which the MOSFET is biased to operate. The dc voltage at the drain, $V_{D S}$, will be

$$
V_{D S}=V_{D D}-R_{D} I_{D}
$$

To ensure saturation-region operation, we must have

$$
V_{D S}>V_{D V}
$$

Furthermore, since the total voltage at the drain will have a signal component superimposed on $V_{D S}, V_{D S}$ has to be sufficiently greater than $V_{D V}$ to allow for the required negative signal swing.


Figure 7.10 Conceptual circuit utilized to study the operation of the MOSFET as a small-signal amplifier.

[^0]
[^0]:    ${ }^{3}$ Practical biasing arrangements will be studied in Section 7.4.
The Signal Current in the Drain Terminal Next, consider the situation with the input signal $v_{g s}$ applied. The total instantaneous gate-to-source voltage will be

$$
v_{G S}=V_{G S}+v_{g s}
$$

resulting in a total instantaneous drain current $i_{D}$,

$$
\begin{aligned}
i_{D} & =\frac{1}{2} k_{u}\left(V_{G S}+v_{g s}-V_{t}\right)^{2} \\
& =\frac{1}{2} k_{u}\left(V_{G S}-V_{t}\right)^{2}+k_{u}\left(V_{G S}-V_{t}\right) v_{g s}+\frac{1}{2} k_{u} v_{g s}^{2}
\end{aligned}
$$

The first term on the right-hand side of Eq. (7.28) can be recognized as the dc bias current $I_{D}$ (Eq. 7.25). The second term represents a current component that is directly proportional to the input signal $v_{g s}$. The third term is a current component that is proportional to the square of the input signal. This last component is undesirable because it represents nonlinear distortion. To reduce the nonlinear distortion introduced by the MOSFET, the input signal should be kept small so that

$$
\frac{1}{2} k_{u} v_{g s}^{2} \ll k_{u}\left(V_{G S}-V_{t}\right) v_{g s}
$$

resulting in

$$
v_{g s} \ll 2\left(V_{G S}-V_{t}\right)
$$

or, equivalently,

$$
v_{g s} \ll 2 V_{O V}
$$

If this small-signal condition is satisfied, we may neglect the last term in Eq. (7.28) and express $i_{D}$ as

$$
i_{D} \simeq I_{D}+i_{d}
$$

where

$$
i_{d}=k_{u}\left(V_{G S}-V_{t}\right) v_{g s}
$$

The parameter that relates $i_{d}$ and $v_{g s}$ is the MOSFET transconductance $g_{m}$,

$$
g_{m} \equiv \frac{i_{d}}{v_{g s}}=k_{u}\left(V_{G S}-V_{t}\right)
$$

or in terms of the overdrive voltage $V_{O V}$,

$$
g_{m}=k_{u} V_{O V}
$$

Figure 7.11 presents a graphical interpretation of the small-signal operation of the MOSFET amplifier. Note that $g_{m}$ is equal to the slope of the $i_{D}-v_{G S}$ characteristic at the bias point,

$$
g_{m} \equiv\left.\frac{\partial i_{D}}{\partial v_{G S}}\right|_{v_{G S}=V_{G S}}
$$

This is the formal definition of $g_{m}$, which can be shown to yield the expressions given in Eqs. (7.32) and (7.33).


Figure 7.11 Small-signal operation of the MOSFET amplifier.

The Voltage Gain Returning to the circuit of Fig. 7.10, we can express the total instantaneous drain voltage $v_{D S}$ as follows:

$$
v_{D S}=V_{D D}-R_{D} i_{D}
$$

Under the small-signal condition, we have

$$
v_{D S}=V_{D D}-R_{D}\left(I_{D}+i_{d}\right)
$$

which can be rewritten as

$$
v_{D S}=V_{D S}-R_{D} i_{d}
$$

Thus the signal component of the drain voltage is

$$
v_{d s}=-i_{d} R_{D}=-g_{m} v_{g s} R_{D}
$$

which indicates that the voltage gain is given by

$$
A_{v} \equiv \frac{v_{d s}}{v_{g s}}=-g_{m} R_{D}
$$

The minus sign in Eq. (7.36) indicates that the output signal $v_{d s}$ is $180^{\circ}$ out of phase with respect to the input signal $v_{g s}$. This is illustrated in Fig. 7.12, which shows $v_{G S}$ and $v_{D S}$. The input signal is assumed to have a triangular waveform with an amplitude much smaller than $2\left(V_{G S}-V_{i}\right)$, the small-signal condition in Eq. (7.29), to ensure linear operation. For operation in the saturation (active) region at all times, the minimum value of $v_{D S}$ should not fall below the corresponding value of $v_{G S}$ by more than $V_{i}$. Also, the maximum value of $v_{D S}$ should be


Figure 7.12 Total instantaneous voltages $v_{G S}$ and $v_{D S}$ for the circuit in Fig. 7.10.
smaller than $V_{D D}$; otherwise the FET will enter the cutoff region and the peaks of the output signal waveform will be clipped off.

Finally, we note that by substituting for $g_{m}$ from Eq. (7.33) the voltage-gain expression in Eq. (7.36) becomes identical to that derived in Section 7.1—namely, Eq. (7.15).

Separating the DC Analysis and the Signal Analysis From the preceding analysis, we see that under the small-signal approximation, signal quantities are superimposed on dc quantities. For instance, the total drain current $i_{D}$ equals the dc current $I_{D}$ plus the signal current $i_{d}$, the total drain voltage $v_{D S}=V_{D S}+v_{d s}$, and so on. It follows that the analysis and design can be greatly simplified by separating dc or bias calculations from small-signal calculations. That is, once a stable dc operating point has been established and all dc quantities calculated, we may then perform signal analysis ignoring dc quantities.

Small-Signal Equivalent-Circuit Models From a signal point of view, the FET behaves as a voltage-controlled current source. It accepts a signal $v_{g s}$ between gate and source and provides a current $g_{m} v_{g s}$ at the drain terminal. The input resistance of this controlled source is very high—ideally, infinite. The output resistance-that is, the resistance looking into the


Figure 7.13 Small-signal models for the MOSFET: (a) neglecting the dependence of $i_{D}$ on $v_{D S}$ in the active region (the channel-length modulation effect) and (b) including the effect of channel-length modulation, modeled by output resistance $r_{o}=\left|V_{A}\right| / I_{D}$. These models apply equally well for both NMOS and PMOS transistors.
drain-also is high, and we have assumed it to be infinite thus far. Putting all of this together, we arrive at the circuit in Fig. 7.13(a), which represents the small-signal operation of the MOSFET and is thus a small-signal model or a small-signal equivalent circuit.

In the analysis of a MOSFET amplifier circuit, the transistor can be replaced by the equivalent-circuit model shown in Fig. 7.13(a). The rest of the circuit remains unchanged except that ideal constant dc voltage sources are replaced by short circuits. This is a result of the fact that the voltage across an ideal constant dc voltage source does not change, and thus there will always be a zero voltage signal across a constant dc voltage source. A dual statement applies for constant dc current sources; namely, the signal current of an ideal constant dc current source will always be zero, and thus an ideal constant dc current source can be replaced by an open circuit in the small-signal equivalent circuit of the amplifier. The circuit resulting can then be used to perform any required signal analysis, such as calculating voltage gain.

The most serious shortcoming of the small-signal model of Fig. 7.13(a) is that it assumes the drain current in saturation to be independent of the drain voltage. From our study of the MOSFET characteristics in saturation, we know that the drain current does in fact depend on $v_{D S}$ in a linear manner. Such dependence was modeled by a finite resistance $r_{o}$ between drain and source, whose value was given by Eq. (5.27) in Section 5.2.4, which we repeat here (with the prime on $I_{D}$ dropped) as

$$
r_{o}=\frac{\left|V_{A}\right|}{I_{D}}
$$

where $V_{A}=1 / \lambda$ is a MOSFET parameter that either is specified or can be measured. It should be recalled that for a given process technology, $V_{A}$ is proportional to the MOSFET channel length. The current $I_{D}$ is the value of the dc drain current without the channel-length modulation taken into account; that is,

$$
I_{D}=\frac{1}{2} k_{b} V_{O V}^{2}
$$

Typically, $r_{o}$ is in the range of $10 \mathrm{k} \Omega$ to $1000 \mathrm{k} \Omega$. It follows that the accuracy of the small-signal model can be improved by including $r_{o}$ in parallel with the controlled source, as shown in Fig. 7.13(b).
It is important to note that the small-signal model parameters $g_{m}$ and $r_{o}$ depend on the dc bias point of the MOSFET.

Returning to the amplifier of Fig. 7.10, we find that replacing the MOSFET with the small-signal model of Fig. 7.13(b) results in the voltage-gain expression

$$
A_{v}=\frac{v_{d s}}{v_{g s}}=-g_{m}\left(R_{D} \| r_{o}\right)
$$

Thus, the finite output resistance $r_{o}$ results in a reduction in the magnitude of the voltage gain.
Although the analysis above is performed on an NMOS transistor, the results, and the equivalent-circuit models of Fig. 7.13, apply equally well to PMOS devices, except for using $\left|V_{G S}\right|,\left|V_{t}\right|,\left|V_{O V}\right|$, and $\left|V_{A}\right|$ and replacing $k_{n}$ with $k_{p}$.

The Transconductance $g_{m}$ We shall now take a closer look at the MOSFET transconductance given by Eq. (7.32), which we rewrite with $k_{n}=k_{n}^{\prime}(W / L)$ as follows:

$$
g_{m}=k_{n}^{\prime}(W / L)\left(V_{G S}-V_{t}\right)=k_{n}^{\prime}(W / L) V_{O V}
$$

This relationship indicates that $g_{m}$ is proportional to the process transconductance parameter $k_{n}^{\prime}=\mu_{n} C_{o x}$ and to the $W / L$ ratio of the MOS transistor; hence to obtain relatively large transconductance the device must be short and wide. We also observe that for a given device the transconductance is proportional to the overdrive voltage, $V_{O V}=V_{G S}-V_{t}$, the amount by which the bias voltage $V_{G S}$ exceeds the threshold voltage $V_{t}$. Note, however, that increasing $g_{m}$ by biasing the device at a larger $V_{G S}$ has the disadvantage of reducing the allowable voltage signal swing at the drain.

Another useful expression for $g_{m}$ can be obtained by substituting for $V_{O V}$ in Eq. (7.40) by $\sqrt{2 I_{D} /\left(k_{n}^{\prime}(W / L)\right)}$ [from Eq. (7.25)]:

$$
g_{m}=\sqrt{2 k_{n}^{\prime}} \sqrt{W / L} \sqrt{I_{D}}
$$

This expression shows two things:

1. For a given MOSFET, $g_{m}$ is proportional to the square root of the dc bias current.
2. At a given bias current, $g_{m}$ is proportional to $\sqrt{W / L}$.

In contrast, as we shall see shortly, the transconductance of the bipolar junction transistor (BJT) is proportional to the bias current and is independent of the physical size and geometry of the device.

To gain some insight into the values of $g_{m}$ obtained in MOSFETs consider an integrated-circuit device operating at $I_{D}=0.5 \mathrm{~mA}$ and having $k_{n}^{\prime}=120 \mu \mathrm{~A} / \mathrm{V}^{2}$. Equation (7.41) shows that for $W / L=1, g_{m}=0.35 \mathrm{~mA} / \mathrm{V}$, whereas a device for which $W / L=100$ has $g_{m}=3.5 \mathrm{~mA} / \mathrm{V}$. In contrast, a BJT operating at a collector current of 0.5 mA has $g_{m}=20 \mathrm{~mA} / \mathrm{V}$.

Yet another useful expression for $g_{m}$ of the MOSFET can be obtained by substituting for $k_{n}^{\prime}(W / L)$ in Eq. (7.40) by $2 I_{D} /\left(V_{G S}-V_{t}\right)^{2}$ :

$$
g_{m}=\frac{2 I_{D}}{V_{G S}-V_{t}}=\frac{2 I_{D}}{V_{O V}}
$$


Figure 7.14 The slope of the tangent at the bias point Q intersects the $v_{O V}$ axis at $\frac{1}{2} V_{O V}$. Thus, $g_{m}=I_{D} /\left(\frac{1}{2} V_{O V}\right)$.

A convenient graphical construction that clearly illustrates this relationship is shown in Fig. 7.14.

In summary, there are three different relationships for determining $g_{m}$ —Eqs. (7.40), (7.41), and (7.42)—and there are three design parameters- $(W / L), V_{O V}$, and $I_{D}$, any two of which can be chosen independently. That is, the designer may choose to operate the MOSFET with a certain overdrive voltage $V_{O V}$ and at a particular current $I_{D}$; the required $W / L$ ratio can then be found and the resulting $g_{m}$ determined. ${ }^{4}$

# Example 7.3 

Figure 7.15(a) shows a discrete MOSFET amplifier utilizing a drain-to-gate resistance $R_{G}$ for biasing purposes. Such a biasing arrangement will be studied in Section 7.4. The input signal $v_{i}$ is coupled to the gate via a large capacitor, and the output signal at the drain is coupled to the load resistance $R_{L}$ via another large capacitor. We wish to analyze this amplifier circuit to determine its small-signal voltage gain, its input resistance, and the largest allowable input signal. The transistor has $V_{i}=1.5 \mathrm{~V}, k_{n}^{\prime}(W / L)=$ $0.25 \mathrm{~mA} / \mathrm{V}^{2}$, and $V_{A}=50 \mathrm{~V}$. Assume the coupling capacitors to be sufficiently large so as to act as short circuits at the signal frequencies of interest.

[^0]
[^0]:    ${ }^{4}$ This assumes that the circuit designer is also designing the device, as is typically the case in IC design. On the other hand, a circuit designer working with a discrete-circuit MOSFET obviously does not have the freedom to change its $W / L$ ratio. Thus, in this case there are only two design parameters- $V_{O V}$ and $I_{D}$, and only one can be specified by the designer.
Example 7.3 continued

(a)

(b)

(c)

Figure 7.15 Example 7.3: (a) amplifier circuit; (b) circuit for determining the dc operating point; (c) the amplifier small-signal equivalent circuit; (d) a simplified version of the circuit in (c).

(d)

Figure 7.15 continued

# Solution 

We first determine the dc operating point. For this purpose, we eliminate the input signal $v_{i}$, and open-circuit the two coupling capacitors (since they block dc currents). The result is the circuit shown in Fig. 7.14(b). We note that since $I_{G}=0$, the dc voltage drop across $R_{G}$ will be zero, and

$$
V_{G S}=V_{D S}=V_{D D}-R_{D} I_{D}
$$

With $V_{D S}=V_{G S}$, the NMOS transistor will be operating in saturation. Thus,

$$
I_{D}=\frac{1}{2} k_{e}\left(V_{G S}-V_{i}\right)^{2}
$$

where, for simplicity, we have neglected the effect of channel-length modulation on the dc operating point. Substituting $V_{D D}=15 \mathrm{~V}, R_{D}=10 \mathrm{k} \Omega, k_{e}=0.25 \mathrm{~mA} / \mathrm{V}^{2}$, and $V_{i}=1.5 \mathrm{~V}$ in Eqs. (7.43) and (7.44), and substituting for $V_{G S}$ from Eq. (7.43) into Eq. (7.44) results in a quadratic equation in $I_{D}$. Solving the latter and discarding the root that is not physically meaningful yields the solution

$$
I_{D}=1.06 \mathrm{~mA}
$$

which corresponds to

$$
V_{G S}=V_{D S}=4.4 \mathrm{~V}
$$

and

$$
V_{O V}=4.4-1.5=2.9 \mathrm{~V}
$$

Next we proceed with the small-signal analysis of the amplifier. Toward that end we replace the MOSFET with its small-signal model to obtain the small-signal equivalent circuit of the amplifier, shown in Fig. 7.15(c). Observe that we have replaced the coupling capacitors with short circuits. The dc voltage supply $V_{D D}$ has also been replaced with a short circuit to ground.# Example 7.3 continued 

The values of the transistor small-signal parameters $g_{m}$ and $r_{o}$ can be determined by using the dc bias quantities found above, as follows:

$$
\begin{aligned}
g_{m} & =h_{o} V_{O V} \\
& =0.25 \times 2.9=0.725 \mathrm{~mA} / \mathrm{V} \\
r_{o} & =\frac{V_{A}}{I_{D}}=\frac{50}{1.06}=47 \mathrm{k} \Omega
\end{aligned}
$$

Next we use the equivalent circuit of Fig. 7.15(c) to determine the input resistance $R_{\mathrm{in}} \equiv v_{i} / i_{i}$ and the voltage gain $A_{v}=v_{o} / v_{i}$. Toward that end we simplify the circuit by combining the three parallel resistances $r_{o}, R_{D}$, and $R_{L}$ in a single resistance $R_{L}^{\prime}$,

$$
\begin{aligned}
R_{L}^{\prime} & =R_{L}\left\|R_{D}\right\| r_{o} \\
& =10\|10\| 47=4.52 \mathrm{k} \Omega
\end{aligned}
$$

as shown in Fig. 7.15(d). For the latter circuit we can write the two equations

$$
v_{o}=\left(i_{i}-g_{m} v_{g s}\right) R_{L}^{\prime}
$$

and

$$
i_{i}=\frac{v_{g s}-v_{o}}{R_{G}}
$$

Substituting for $i_{i}$ from Eq. (7.46) into Eq. (7.45) results in the following expression for the voltage gain $A_{v} \equiv v_{o} / v_{i}=v_{o} / v_{g s}:$

$$
A_{v}=-g_{m} R_{L}^{\prime} \frac{1-\left(1 / g_{m} R_{G}\right)}{1+\left(R_{L}^{\prime} / R_{G}\right)}
$$

Since $R_{G}$ is very large, $g_{m} R_{G} \gg 1$ and $R_{L}^{\prime} / R_{G} \ll 1$ (the reader can easily verify this), and the gain expression can be approximated as

$$
A_{v} \simeq-g_{m} R_{L}^{\prime}
$$

Substituting $g_{m}=0.725 \mathrm{~mA} / \mathrm{V}$ and $R_{L}^{\prime}=4.52 \mathrm{k} \Omega$ yields

$$
A_{v}=-3.3 \mathrm{~V} / \mathrm{V}
$$

To obtain the input resistance, we substitute in Eq. (7.46) for $v_{o}=A_{v} v_{g s}=-g_{m} R_{L}^{\prime} v_{g s}$, then use $R_{\mathrm{in}} \equiv v_{i} / i_{i}=$ $v_{g s} / i_{i}$ to obtain

$$
R_{\mathrm{in}}=\frac{R_{G}}{1+g_{m} R_{L}^{\prime}}
$$
This is an interesting relationship: The input resistance decreases as the gain $\left(g_{m} R_{L}^{\prime}\right)$ is increased. The value of $R_{\mathrm{in}}$ can now be determined; it is

$$
R_{\mathrm{in}}=\frac{10 \mathrm{M} \Omega}{1+3.3}=2.33 \mathrm{M} \Omega
$$

which is still very large.
The largest allowable input signal $\hat{v}_{i}$ is constrained by the need to keep the transistor in saturation at all times; that is,

$$
v_{D S} \geq v_{G S}-V_{t}
$$

Enforcing this condition with equality at the point $v_{G S}$ is maximum and $v_{D S}$ is minimum, we write

$$
\begin{gathered}
v_{D S \text { min }}=v_{G S \max }-V_{t} \\
V_{D S}-\left|A_{v}\right| \hat{v}_{i}=V_{G S}+\hat{v}_{i}-V_{t}
\end{gathered}
$$

Since $V_{D S}=V_{G S}$, we obtain

$$
\hat{v}_{i}=\frac{V_{t}}{\left|A_{v}\right|+1}
$$

This is a general relationship that applies to this circuit irrespective of the component values. Observe that it simply states that the maximum signal swing is determined by the fact that the bias arrangement makes $V_{D}=V_{G}$ and thus, to keep the MOSFET out of the triode region, the signal between D and G is constrained to be equal to $V_{t}$. For our particular design,

$$
\hat{v}_{i}=\frac{1.5}{3.3+1}=0.35 \mathrm{~V}
$$

Since $V_{O V}=2.9 \mathrm{~V}$, a $v_{i}$ of 0.35 is indeed much smaller than $2 V_{O V}=5.8 \mathrm{~V}$; thus the assumption of linear operation is justified.

A modification of this circuit that increases the allowable signal swing is investigated in Problem 7.103.

# EXERCISE 

D7.4 Consider the amplifier circuit of Fig. 7.15(a) without the load resistance $R_{L}$ and with channel-length modulation neglected. Let $V_{D D}=5 \mathrm{~V}, V_{i}=0.7 \mathrm{~V}$, and $k_{n}=1 \mathrm{~mA} / \mathrm{V}^{2}$. Find $V_{O V}, I_{D}, R_{D}$, and $R_{G}$ to obtain a voltage gain of $-25 \mathrm{~V} / \mathrm{V}$ and an input resistance of $0.5 \mathrm{M} \Omega$. What is the maximum allowable input signal, $\hat{v}_{i}$ ?
Ans. $0.319 \mathrm{~V} ; 50.9 \mu \mathrm{~A} ; 78.5 \mathrm{k} \Omega ; 13 \mathrm{M} \Omega ; 27 \mathrm{mV}$
The T Equivalent-Circuit Model Through a simple circuit transformation it is possible to develop an alternative equivalent-circuit model for the MOSFET. The development of such a model, known as the T model, is illustrated in Fig. 7.16. Figure 7.16(a) shows the equivalent circuit studied above without $r_{o}$. In Fig. 7.16(b) we have added a second $g_{m} v_{g s}$ current source in series with the original controlled source. This addition obviously does not change the terminal currents and is thus allowed. The newly created circuit node, labeled X, is joined to the gate terminal G in Fig. 7.16(c). Observe that the gate current does not change-that is, it remains equal to zero-and thus this connection does not alter the terminal characteristics. We now note that we have a controlled current source $g_{m} v_{g s}$ connected across its control voltage $v_{g s}$. We can replace this controlled source by a resistance as long as this resistance draws an equal current as the source. (See the source-absorption theorem in Appendix D.) Thus the value of the resistance is $v_{g s} / g_{m} v_{g s}=1 / g_{m}$. This replacement is shown in Fig. 7.16(d), which depicts


Figure 7.16 Development of the T equivalent-circuit model for the MOSFET. For simplicity, $r_{o}$ has been omitted; however, it may be added between D and S in the T model of (d).


Figure 7.17 (a) The T model of the MOSFET augmented with the drain-to-source resistance $r_{o}$. (b) An alternative representation of the T model.
the alternative model. Observe that $i_{g}$ is still zero, $i_{d}=g_{m} v_{g s}$, and $i_{s}=v_{g s} /\left(1 / g_{m}\right)=g_{m} v_{g s}$, all the same as in the original model in Fig. 7.16(a).

The model of Fig. 7.16(d) shows that the resistance between gate and source looking into the source is $1 / g_{m}$. This observation and the T model prove useful in many applications. Note that the resistance between gate and source, looking into the gate, is infinite.

In developing the T model we did not include $r_{o}$. If desired, this can be done by incorporating in the circuit of Fig. 7.16(d) a resistance $r_{o}$ between drain and source, as shown in Fig. 7.17(a). An alternative representation of the T model, in which the voltage-controlled current source is replaced with a current-controlled current source, is shown in Fig. 7.17(b).

Finally, we should note that in order to distinguish the model of Fig. 7.13(b) from the equivalent T model, the former is sometimes referred to as the hybrid- $\pi$ model, a carryover from the bipolar transistor literature. The origin of this name will be explained shortly.

# Example 7.4 

Figure 7.18(a) shows a MOSFET amplifier biased by a constant-current source $I$. Assume that the values of $I$ and $R_{D}$ are such that the MOSFET operates in the saturation region. The input signal $v_{i}$ is coupled to the source terminal by utilizing a large capacitor $C_{C 1}$. Similarly, the output signal at the drain is taken through a large coupling capacitor $C_{C 2}$. Find the input resistance $R_{i n}$ and the voltage gain $v_{o} / v_{i}$. Neglect channel-length modulation.
Example 7.4 continued


Figure 7.18 (a) Amplifier circuit for Example 7.4. (b) Small-signal equivalent circuit of the amplifier in (a).

# Solution 

Replacing the MOSFET with its T equivalent-circuit model results in the amplifier equivalent circuit shown in Fig. 7.18(b). Observe that the dc current source $I$ is replaced with an open circuit and the dc voltage source $V_{D D}$ is replaced by a short circuit. The large coupling capacitors have been replaced by short circuits. From the equivalent-circuit model we determine

$$
R_{\mathrm{in}}=\frac{v_{i}}{-i}=1 / g_{m}
$$

and

$$
v_{o}=-i R_{D}=\left(\frac{v_{i}}{1 / g_{m}}\right) R_{D}=g_{m} R_{D} v_{i}
$$

Thus,

$$
A_{v} \equiv \frac{v_{o}}{v_{i}}=g_{m} R_{D}
$$

We note that this amplifier, known as the common-gate amplifier because the gate at ground potential is common to both the input and output ports, has a low input resistance $\left(1 / g_{m}\right)$ and a noninverting gain. We shall study this amplifier type in Section 7.3.5.
# EXERCISE 

7.5 Use the T model of Fig. 7.17(b) to show that a MOSFET whose drain is connected to its gate exhibits an incremental resistance equal to $\left[\left(1 / g_{m}\right) \| r_{o}\right]$.
Ans. See Fig. E7.5.

(b)

Figure E7.5 Circuits for Exercise 7.5. Note that the bias arrangement of $Q$ is not shown.

Modeling the Body Effect As mentioned earlier (see Section 5.4), the body effect occurs in a MOSFET when the source is not tied to the substrate (which is always connected to the most negative power supply in the integrated circuit for $n$-channel devices and to the most positive for $p$-channel devices). Thus the substrate (body) will be at signal ground, but since the source is not, a signal voltage $v_{b s}$ develops between the body (B) and the source (S). The substrate then acts as a "second gate" or a backgate for the MOSFET. Thus the signal $v_{b s}$ gives rise to a drain-current component, which we shall write as $g_{m b} v_{b s}$, where $g_{m b}$ is the body transconductance, defined as

$$
g_{m b} \equiv\left.\frac{\partial i_{D}}{\partial v_{B S}}\right|_{\substack{v_{b S}=\text { constant } \\ v_{B S}=\text { constant }}}
$$

Recalling that $i_{D}$ depends on $v_{B S}$ through the dependence of $V_{i}$ on $V_{B S}$, we can show that

$$
g_{m b}=\chi g_{m}
$$

where

$$
\chi \equiv \frac{\partial V_{i}}{\partial V_{S B}}=\frac{\gamma}{2 \sqrt{2 \phi_{f}+V_{S B}}}
$$

Typically the value of $\chi$ lies in the range 0.1 to 0.3 .
Figure 7.19 shows the MOSFET model augmented to include the controlled source $g_{m b} v_{b s}$ that models the body effect. Ideally, this is the model to be used whenever the source is not connected to the substrate. It has been found, however, that except in some very particular


Figure 7.19 Small-signal, equivalent-circuit model of a MOSFET in which the source is not connected to the body.
situations, the body effect can generally be ignored in the initial, pencil-and-paper design of MOSFET amplifiers.

Finally, although the analysis above was performed on an NMOS transistor, the results and the equivalent circuit of Fig. 7.19 apply equally well to PMOS transistors, except for using $\left|V_{G S}\right|,\left|V_{i}\right|,\left|V_{O V}\right|,\left|V_{A}\right|,\left|V_{S B}\right|,|\gamma|$, and $|\lambda|$ and replacing $k_{u}^{\prime}$ with $k_{p}^{\prime}$ in the appropriate formula.

# EXERCISES 

7.6 For the amplifier in Fig. 7.4, let $V_{D D}=5 \mathrm{~V}, R_{D}=10 \mathrm{k} \Omega, V_{t}=1 \mathrm{~V}, k_{u}^{\prime}=20 \mu \mathrm{~A} / \mathrm{V}^{2}, W / L=20, V_{G S}=2 \mathrm{~V}$, and $\lambda=0$.
(a) Find the dc current $I_{D}$ and the dc voltage $V_{D S}$.
(b) Find $g_{m}$.
(c) Find the voltage gain.
(d) If $v_{g s}=0.2 \sin \omega t$ volts, find $v_{d s}$ assuming that the small-signal approximation holds. What are the minimum and maximum values of $v_{D S}$ ?
(e) Use Eq. (7.28) to determine the various components of $i_{D}$. Using the identity $\left(\sin ^{2} \omega t=\frac{1}{2}-\frac{1}{2} \cos 2 \omega t\right)$, show that there is a slight shift in $I_{D}$ (by how much?) and that there is a second-harmonic component (i.e., a component with frequency $2 \omega$ ). Express the amplitude of the second-harmonic component as a percentage of the amplitude of the fundamental. (This value is known as the second-harmonic distortion.)
Ans. (a) $200 \mu \mathrm{~A}, 3 \mathrm{~V}$; (b) $0.4 \mathrm{~mA} / \mathrm{V}$; (c) $-4 \mathrm{~V} / \mathrm{V}$; (d) $v_{d s}=-0.8 \sin \omega t$ volts, $2.2 \mathrm{~V}, 3.8 \mathrm{~V}$; (e) $i_{D}=$ $(204+80 \sin \omega t-4 \cos 2 \omega t) \mu \mathrm{A}, 5 \%$
7.7 An NMOS transistor has $\mu_{n} C_{c s}=60 \mu \mathrm{~A} / \mathrm{V}^{2}, W / L=40, V_{t}=1 \mathrm{~V}$, and $V_{A}=15 \mathrm{~V}$. Find $g_{m}$ and $r_{o}$ when (a) the bias voltage $V_{G S}=1.5 \mathrm{~V}$, (b) the bias current $I_{D}=0.5 \mathrm{~mA}$.

Ans. (a) $1.2 \mathrm{~mA} / \mathrm{V}, 50 \mathrm{k} \Omega$; (b) $1.55 \mathrm{~mA} / \mathrm{V}, 30 \mathrm{k} \Omega$
7.8 A MOSFET is to operate at $I_{D}=0.1 \mathrm{~mA}$ and is to have $g_{m}=1 \mathrm{~mA} / \mathrm{V}$. If $k_{n}^{\prime}=50 \mu \mathrm{~A} / \mathrm{V}^{2}$, find the required $W / L$ ratio and the overdrive voltage.
Ans. 100; 0.2 V
7.9 For a fabrication process for which $\mu_{p} \simeq 0.4 \mu_{n}$, find the ratio of the width of a PMOS transistor to the width of an NMOS transistor so that the two devices have equal $g_{m}$ for the same bias conditions. The two devices have equal channel lengths.
Ans. 2.5
7.10 A PMOS transistor has $V_{i}=-1 \mathrm{~V}, k_{n}^{\prime}=60 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $W / L=16 \mu \mathrm{~m} / 0.8 \mu \mathrm{~m}$. Find $I_{D}$ and $g_{m}$ when the device is biased at $V_{G S}=-1.6 \mathrm{~V}$. Also, find the value of $r_{o}$ if $\lambda$ (at $L=1 \mu \mathrm{~m}$ ) $=-0.04 \mathrm{~V}^{-1}$. Ans. $216 \mu \mathrm{~A} ; 0.72 \mathrm{~mA} / \mathrm{V} ; 92.6 \mathrm{k} \Omega$
7.11 Derive an expression for $\left(g_{m} r_{o}\right)$ in terms of $V_{A}$ and $V_{O V}$. As we shall see in Chapter 8 , this is an important transistor parameter and is known as the intrinsic gain. Evaluate the value of $g_{m} r_{o}$ for an NMOS transistor fabricated in a $0.8-\mu \mathrm{m}$ CMOS process for which $V_{A}=12.5 \mathrm{~V} / \mu \mathrm{m}$ of channel length. Let the device have minimum channel length and be operated at an overdrive voltage of 0.2 V .
Ans. $g_{m} r_{o}=2 V_{A} / V_{O V} ; 100 \mathrm{~V} / \mathrm{V}$

# 7.2.2 The BJT Case 

We next consider the small-signal operation of the BJT and develop small-signal equivalent-circuit models that represent its operation at a given bias point. The following development parallels what we used for the MOSFET except that here we have an added complication: The BJT draws a finite base current. As will be seen shortly, this phenomenon (finite $\beta$ ) manifests itself as a finite input resistance looking into the base of the BJT (as compared to the infinite input resistance looking into the gate of the MOSFET).

Consider the conceptual amplifier circuit shown in Fig. 7.20(a). Here the base-emitter junction is forward biased by a dc voltage $V_{B E}$. The reverse bias of the collector-base junction is established by connecting the collector to another power supply of voltage $V_{C C}$ through a resistor $R_{C}$. The input signal to be amplified is represented by the voltage source $v_{b e}$ that is superimposed on $V_{B E}$.

The DC Bias Point We consider first the dc bias conditions by setting the signal $v_{b e}$ to zero. The circuit reduces to that in Fig. 7.20(b), and we can write the following relationships for the dc currents and voltages:

$$
\begin{aligned}
I_{C} & =I_{S} e^{V_{B E} / V_{T}} \\
I_{E} & =I_{C} / \alpha \\
I_{B} & =I_{C} / \beta \\
V_{C E} & =V_{C C}-I_{C} R_{C}
\end{aligned}
$$

For active-mode operation, $V_{C E}$ should be greater than $\left(V_{B E}-0.4\right)$ by an amount that allows for the required negative signal swing at the collector.


Figure 7.20 (a) Conceptual circuit to illustrate the operation of the transistor as an amplifier. (b) The circuit of (a) with the signal source $v_{b e}$ eliminated for dc (bias) analysis.

The Collector Current and the Transconductance If a signal $v_{b e}$ is applied as shown in Fig. 7.20(a), the total instantaneous base-emitter voltage $v_{B E}$ becomes

$$
v_{B E}=V_{B E}+v_{b e}
$$

Correspondingly, the collector current becomes

$$
\begin{aligned}
i_{C} & =I_{S} e^{v_{B E} / V_{T}}=I_{S} e^{\left(V_{B E}+v_{b e}\right) / V_{T}} \\
& =I_{S} e^{V_{B E} / V_{T}} e^{v_{b e} / V_{T}}
\end{aligned}
$$

Use of Eq. (7.52) yields

$$
i_{C}=I_{C} e^{v_{b e} / V_{T}}
$$

Now, if $v_{b e} \ll V_{T}$, we may approximate Eq. (7.56) as

$$
i_{C} \simeq I_{C}\left(1+\frac{v_{b e}}{V_{T}}\right)
$$

Here we have expanded the exponential in Eq. (7.56) in a series and retained only the first two terms. That is, we have assumed that

$$
v_{b e} \ll V_{T}
$$

so that we can neglect the higher-order terms in the exponential series expansion. The condition in Eq. (7.58) is the small-signal approximation for the BJT and corresponds to that in Eq. (7.29) for the MOSFET case. The small-signal approximation for the BJT is valid only for $v_{b e}$ less than 5 mV or 10 mV , at most. Under this approximation, the total collector current is given by Eq. (7.57) and can be rewritten

$$
i_{C}=I_{C}+\frac{I_{C}}{V_{T}} v_{b e}
$$
Thus the collector current is composed of the dc bias value $I_{C}$ and a signal component $i_{c}$,

$$
i_{c}=\frac{I_{C}}{V_{T}} v_{b e}
$$

This equation relates the signal current in the collector to the corresponding base-emitter signal voltage. It can be rewritten as

$$
i_{c}=g_{m} v_{b e}
$$

where $g_{m}$ is the transconductance, and from Eq. (7.60), it is given by

$$
g_{m}=\frac{I_{C}}{V_{T}}
$$

We observe that the transconductance of the BJT is directly proportional to the collector bias current $I_{C}$. Thus to obtain a constant predictable value for $g_{m}$, we need a constant predictable $I_{C}$. Also, we note that BJTs have relatively high transconductance in comparison to MOSFETs: for instance, at $I_{C}=1 \mathrm{~mA}, g_{m} \simeq 40 \mathrm{~mA} / \mathrm{V}$. Finally, unlike the MOSFET, whose $g_{m}$ depends on the device dimensions ( $W$ and $L$ ), $g_{m}$ of a BJT depends only on the dc collector current at which it is biased to operate.

A graphical interpretation for $g_{m}$ is given in Fig. 7.21, where it is shown that $g_{m}$ is equal to the slope of the tangent to the $i_{C}-v_{B E}$ characteristic curve at $i_{C}=I_{C}$ (i.e., at the bias point Q ). Thus,

$$
g_{m}=\left.\frac{\partial i_{C}}{\partial v_{B E}}\right|_{i_{C}=I_{C}}
$$

The small-signal approximation implies keeping the signal amplitude sufficiently small that operation is restricted to an almost-linear segment of the $i_{C}-v_{B E}$ exponential curve. Increasing the signal amplitude will result in the collector current having components nonlinearly related to $v_{b e}$.

# EXERCISES 

7.12 Use Eq. (7.63) to derive the expression for $g_{m}$ in Eq. (7.62).
7.13 Calculate the value of $g_{m}$ for a BJT biased at $I_{C}=0.5 \mathrm{~mA}$. Ans. $20 \mathrm{~mA} / \mathrm{V}$

Figure 7.21 Linear operation of the transistor under the small-signal condition: A small-signal $v_{b e}$ with a triangular waveform is superimposed on the dc voltage $V_{B E}$. It gives rise to a collector-signal current $i_{c}$, also of triangular waveform, superimposed on the dc current $I_{C}$. Here, $i_{c}=g_{m} v_{b e}$, where $g_{m}$ is the slope of the $i_{C}-v_{B E}$ curve at the bias point Q .

The Base Current and the Input Resistance at the Base To determine the resistance seen by $v_{b e}$, we first evaluate the total base current $i_{B}$ using Eq. (7.59), as follows:

$$
i_{B}=\frac{i_{C}}{\beta}=\frac{I_{C}}{\beta}+\frac{1}{\beta} \frac{I_{C}}{V_{T}} v_{b e}
$$

Thus,

$$
i_{B}=I_{B}+i_{b}
$$

where $I_{B}$ is equal to $I_{C} / \beta$ and the signal component $i_{b}$ is given by

$$
i_{b}=\frac{1}{\beta} \frac{I_{C}}{V_{T}} v_{b e}
$$

Substituting for $I_{C} / V_{T}$ by $g_{m}$ gives

$$
i_{b}=\frac{g_{m}}{\beta} v_{b e}
$$
The small-signal input resistance between base and emitter, looking into the base, is denoted by $r_{\pi}$ and is defined as

$$
r_{\pi} \equiv \frac{v_{b e}}{i_{b}}
$$

Using Eq. (7.66) gives

$$
r_{\pi}=\frac{\beta}{g_{m}}
$$

Thus $r_{\pi}$ is directly dependent on $\beta$ and is inversely proportional to the bias current $I_{C}$. Substituting for $g_{m}$ in Eq. (7.68) from Eq. (7.62) and replacing $I_{C} / \beta$ by $I_{B}$ gives an alternative expression for $r_{\pi}$,

$$
r_{\pi}=\frac{V_{T}}{I_{B}}
$$

Here, we recall that because the gate current of the MOSFET is zero (at dc and low frequencies) the input resistance at the gate is infinite; that is, in the MOSFET there is no counterpart to $r_{\pi}{ }^{5}$

# EXERCISE 

7.14 A BJT amplifier is biased to operate at a constant collector current $I_{C}=0.5 \mathrm{~mA}$ irrespective of the value $\beta$. If the transistor manufacturer specifies $\beta$ to range from 50 to 200 , give the expected range of $g_{m}, I_{B}$, and $r_{\pi}$.
Ans. $g_{m}$ is constant at $20 \mathrm{~mA} / \mathrm{V} ; I_{B}=10 \mu \mathrm{~A}$ to $2.5 \mu \mathrm{~A} ; r_{\pi}=2.5 \mathrm{k} \Omega$ to $10 \mathrm{k} \Omega$

The Emitter Current and the Input Resistance at the Emitter The total emitter current $i_{E}$ can be determined using Eq. (7.59) as

$$
i_{E}=\frac{i_{C}}{\alpha}=\frac{I_{C}}{\alpha}+\frac{i_{e}}{\alpha}
$$

Thus,

$$
i_{E}=I_{E}+i_{e}
$$

where $I_{E}$ is equal to $I_{C} / \alpha$ and the signal current $i_{e}$ is given by

$$
i_{e}=\frac{i_{c}}{\alpha}=\frac{I_{C}}{\alpha V_{T}} v_{b e}=\frac{I_{E}}{V_{T}} v_{b e}
$$

[^0]
[^0]:    ${ }^{5}$ At high frequencies, the input capacitance at the MOSFET gate makes the input current finite (see Chapter 10).
If we denote the small-signal resistance between base and emitter looking into the emitter by $r_{e}$, it can be defined as

$$
r_{e} \equiv \frac{v_{b e}}{i_{e}}
$$

Using Eq. (7.71) we find that $r_{e}$, called the emitter resistance, is given by

$$
r_{e}=\frac{V_{r}}{I_{E}}
$$

Comparison with Eq. (7.62) reveals that

$$
r_{e}=\frac{\alpha}{g_{m}} \simeq \frac{1}{g_{m}}
$$

The relationship between $r_{\pi}$ and $r_{e}$ can be found by combining their respective definitions in Eqs. (7.67) and (7.72) as

$$
v_{b e}=i_{b} r_{\pi}=i_{e} r_{e}
$$

Thus,

$$
r_{\pi}=\left(i_{e} / i_{b}\right) r_{e}
$$

which yields

$$
r_{\pi}=(\beta+1) r_{e}
$$

Figure 7.22 illustrates the definition of $r_{\pi}$ and $r_{e}$.


Figure 7.22 Illustrating the definition of $r_{\pi}$ and $r_{e}$.

Finally, a comparison with the MOSFET would be useful: For the MOSFET, $\alpha=1$ and the resistance looking into the source is simply $1 / g_{m}$.
## SHOCKLEY AND SILICON VALLEY:

In 1956 William Bradford Shockley started a new company, Shockley Semiconductor Laboratory in Mountain View, California (near Stanford, his birthplace). While at Bell Labs, together with John Bardeen and Walter Brattain, he had invented the BJT. At Shockley, the initial concentration was on developing semiconductor devices, particularly a new four-layer diode. But Shockley's scientific genius and ability to select and attract good team members, first demonstrated at Bell Labs, was not accompanied by comparable talent for management. Consequently, in 1957, eight of his team members (the so-called Traitorous Eight, including Gordon Moore and Robert Noyce) left Shockley to create Fairchild Semiconductor. It was a propitious time: The first Sputnik was launched a month later, and the ensuing space race accelerated demand for solid-state circuits. Decades passed, and in 2002 a group of some 30 individuals who had been associated with Silicon Valley since 1956 met at Stanford University to reminisce about Shockley's contributions to the information technology age. They unanimously concluded that Shockley was the man who brought silicon to Silicon Valley!

# EXERCISE 

7.15 A BJT having $\beta=100$ is biased at a dc collector current of 1 mA . Find the value of $g_{m}, r_{e}$, and $r_{\pi}$ at the bias point.
Ans. $40 \mathrm{~mA} / \mathrm{V} ; 25 \Omega ; 2.5 \mathrm{k} \Omega$

The Voltage Gain The total collector voltage $v_{C E}$ is

$$
\begin{aligned}
v_{C E} & =V_{C C}-i_{C} R_{C} \\
& =V_{C C}-\left(I_{C}+i_{c}\right) R_{C} \\
& =\left(V_{C C}-I_{C} R_{C}\right)-i_{c} R_{C} \\
& =V_{C E}-i_{c} R_{C}
\end{aligned}
$$

Thus, superimposed on the collector bias voltage $V_{C E}$ we have signal voltage $v_{c e}$ given by

$$
\begin{aligned}
v_{c e} & =-i_{c} R_{C}=-g_{m} v_{b e} R_{C} \\
& =\left(-g_{m} R_{C}\right) v_{b e}
\end{aligned}
$$

from which we find the voltage gain $A_{v}$ of this amplifier as

$$
A_{v} \equiv \frac{v_{c e}}{v_{b e}}=-g_{m} R_{C}
$$

Here again we note that because $g_{m}$ is directly proportional to the collector bias current, the gain will be as stable as the collector bias current is made. Substituting for $g_{m}$ from Eq. (7.62)
enables us to express the gain in the form

$$
A_{v}=-\frac{I_{C} R_{C}}{V_{T}}
$$

which is identical to the expression we derived in Section 7.1 (Eq. 7.21). Finally, we note that the gain expression in Eq. (7.78) is identical in form to that for the MOSFET amplifier (namely, $-g_{m} R_{D}$ ).

# EXERCISE 

7.16 In the circuit of Fig. 7.20(a), $V_{B E}$ is adjusted to yield a dc collector current of 1 mA . Let $V_{C C}=15 \mathrm{~V}$, $R_{C}=10 \mathrm{k} \Omega$, and $\beta=100$. Find the voltage gain $v_{c e} / v_{b e}$. If $v_{b e}=0.005 \sin \omega t$ volt, find $v_{C}(t)$ and $i_{B}(t)$. Ans. $-400 \mathrm{~V} / \mathrm{V} ; 5-2 \sin \omega t$ volts; $10+2 \sin \omega t \mu \mathrm{~A}$

Separating the Signal and the DC Quantities The analysis above indicates that every current and voltage in the amplifier circuit of Fig. 7.20(a) is composed of two components: a dc component and a signal component. For instance, $v_{B E}=V_{B E}+v_{b e}, I_{C}=I_{C}+i_{c}$, and so on. The dc components are determined from the dc circuit given in Fig. 7.20(b) and from the relationships imposed by the transistor (Eqs. 7.52 through 7.54). On the other hand, a representation of the signal operation of the BJT can be obtained by eliminating the dc sources, as shown in Fig. 7.23. Observe that since the voltage of an ideal dc supply does not change, the signal voltage across it will be zero. For this reason we have replaced $V_{C C}$ and $V_{B E}$ with short circuits. Had the circuit contained ideal dc current sources, these would have been replaced by open circuits. Note, however, that the circuit of Fig. 7.23 is useful only insofar as it shows the various signal currents and voltages; it is not an actual amplifier circuit, since the dc bias circuit is not shown.

Figure 7.23 also shows the expressions for the current increments $\left(i_{c}, i_{b}\right.$, and $\left.i_{e}\right)$ obtained when a small signal $v_{b e}$ is applied. These relationships can be represented by a circuit. Such


Figure 7.23 The amplifier circuit of Fig. 7.20(a) with the dc sources $\left(V_{B E}\right.$ and $\left.V_{C C}\right)$ eliminated (short-circuited). Thus only the signal components are present. Note that this is a representation of the signal operation of the BJT and not an actual amplifier circuit.
a circuit should have three terminals-C, B, and E-and should yield the same terminal currents indicated in Fig. 7.23. The resulting circuit is then equivalent to the transistor as far as small-signal operation is concerned, and thus it can be considered an equivalent small-signal circuit model.

The Hybrid- $\pi$ Model An equivalent-circuit model for the BJT is shown in Fig. 7.24(a). This model represents the BJT as a voltage-controlled current source and explicitly includes the input resistance looking into the base, $r_{\pi}$. The model obviously yields $i_{c}=g_{m} v_{b e}$ and $i_{b}=v_{b e} / r_{\pi}$. Not so obvious, however, is the fact that the model also yields the correct expression for $i_{e}$. This can be shown as follows: At the emitter node we have

$$
\begin{aligned}
i_{e} & =\frac{v_{b e}}{r_{\pi}}+g_{m} v_{b e}=\frac{v_{b e}}{r_{\pi}}\left(1+g_{m} r_{\pi}\right) \\
& =\frac{v_{b e}}{r_{\pi}}(1+\beta)=v_{b e} /\left(\frac{r_{\pi}}{1+\beta}\right) \\
& =v_{b e} / r_{e}
\end{aligned}
$$

A slightly different equivalent-circuit model can be obtained by expressing the current of the controlled source $\left(g_{m} v_{b e}\right)$ in terms of the base current $i_{b}$ as follows:

$$
\begin{aligned}
g_{m} v_{b e} & =g_{m}\left(i_{b} r_{\pi}\right) \\
& =\left(g_{m} r_{\pi}\right) i_{b}=\beta i_{b}
\end{aligned}
$$

This results in the alternative equivalent-circuit model shown in Fig. 7.24(b). Here the transistor is represented as a current-controlled current source, with the control current being $i_{b}$.

As we have done in the case of the MOSFET's small-signal models, we can account for the Early effect (the slight dependence of $i_{C}$ on $v_{C E}$ due to basewidth modulation) by adding the resistance $r_{o}=V_{A} / I_{C}$ between collector and emitter, as shown in Fig. 7.25. Note that to conform with the literature, we have renamed $v_{b e}$ as $v_{\pi}$. The two models of Fig. 7.25 are versions of the hybrid- $\pi$ model, the most widely used model for the BJT. The equivalent circuit of Fig. 7.25(a) corresponds to that of the MOSFET [Fig. 7.13(b)] except for $r_{\pi}$, which accounts for the finite base current (or finite $\beta$ ) of the BJT. However, the equivalent circuit of Fig. 7.25(b) has no MOS counterpart.


Figure 7.24 Two slightly different versions of the hybrid- $\pi$ model for the small-signal operation of the BJT. The equivalent circuit in (a) represents the BJT as a voltage-controlled current source (a transconductance amplifier), and that in (b) represents the BJT as a current-controlled current source (a current amplifier).


Figure 7.25 The hybrid- $\pi$ small-signal model, in its two versions, with the resistance $r_{o}$ included.

It is important to note that the small-signal equivalent circuits of Fig. 7.25 model the operation of the BJT at a given bias point. This should be obvious from the fact that the model parameters $g_{m}, r_{\pi}$, and $r_{o}$ depend on the value of the dc bias current $I_{C}$, as indicated in Fig. 7.25. That is, these equivalent circuits model the incremental operation of the BJT around the bias point.

As in the case of the MOSFET amplifier, including $r_{o}$ in the BJT model causes the voltage gain of the conceptual amplifier of Fig. 7.20(a) to become

$$
\frac{v_{o}}{v_{b e}}=-g_{m}\left(R_{C} \| r_{o}\right)
$$

Thus, the magnitude of the gain is reduced somewhat.

# EXERCISE 

7.17 For the model in Fig. 7.24(b) show that $i_{c}=g_{m} v_{b e}$ and $i_{e}=v_{b e} / r_{e}$.

The T Model Although the hybrid- $\pi$ model (in one of its two variants shown in Fig. 7.24) can be used to carry out small-signal analysis of any transistor circuit, there are situations in which an alternative model, shown in Fig. 7.26, is much more convenient. This model, called, as in the case of the MOSFET, the T model, is shown in two versions in Fig. 7.26. The model of Fig. 7.26(a) represents the BJT as a voltage-controlled current source with the control voltage being $v_{b e}$. Here, however, the resistance between base and emitter, looking into the emitter, is explicitly shown. From Fig. 7.26(a) we see clearly that the model yields the correct expressions for $i_{c}$ and $i_{e}$. It can also be shown to yield the correct expression for $i_{b}$ (see Exercise 7.18 on the next page).


Figure 7.26 Two slightly different versions of what is known as the $T$ model of the BJT. The circuit in (a) is a voltage-controlled current source representation and that in (b) is a current-controlled current source representation. These models explicitly show the emitter resistance $r_{e}$ rather than the base resistance $r_{a}$ featured in the hybrid- $\pi$ model.

If in the model of Fig. 7.26(a) the current of the controlled source is expressed in terms of the emitter current as

$$
\begin{aligned}
g_{m} v_{b e} & =g_{m}\left(i_{e} r_{e}\right) \\
& =\left(g_{m} r_{e}\right) i_{e}=\alpha i_{e}
\end{aligned}
$$

we obtain the alternative T model shown in Fig. 7.26(b). Here the BJT is represented as a current-controlled current source but with the control signal being $i_{e}$.

Finally, the T models can be augmented by $r_{a}$ to account for the dependence of $i_{c}$ to $v_{c e}$ (the Early effect) to obtain the equivalent circuits shown in Fig. 7.27.

# EXERCISE 

7.18 Show that for the T model in Fig. 7.24(a), $i_{b}=v_{b e} / r_{a}$.

Small-Signal Models of the pnp Transistor Although the small-signal models in Figs. 7.25 and 7.27 were developed for the case of the $n p n$ transistor, they apply equally well to the pnp transistor with no change in polarities.


Figure 7.27 The T models of the BJT.

# Example 7.5 

We wish to analyze the transistor amplifier shown in Fig. 7.28(a) to determine its voltage gain $v_{o} / v_{i}$. Assume $\beta=100$ and neglect the Early effect.


Figure 7.28 Example 7.5: (a) amplifier circuit; (b) circuit for dc analysis; (c) amplifier circuit with dc sources replaced by short circuits; (d) amplifier circuit with transistor replaced by its hybrid- $\pi$, small-signal model.


Figure 7.28 continued

# Solution 

We shall follow a five-step process:

1. The first step in the analysis consists of determining the quiescent operating point. For this purpose we assume that $v_{i}=0$ and thus obtain the dc circuit shown in Fig. 7.28(b). The dc base current will be

$$
\begin{aligned}
I_{B} & =\frac{V_{B B}-V_{B E}}{R_{B B}} \\
& \simeq \frac{3-0.7}{100}=0.023 \mathrm{~mA}
\end{aligned}
$$

The dc collector current will be

$$
I_{C}=\beta I_{B}=100 \times 0.023=2.3 \mathrm{~mA}
$$

The dc voltage at the collector will be

$$
\begin{aligned}
V_{C} & =V_{C C}-I_{C} R_{C} \\
& =+10-2.3 \times 3=+3.1 \mathrm{~V}
\end{aligned}
$$

Since $V_{B}$ at +0.7 V is less than $V_{C}$, it follows that in the quiescent condition the transistor will be operating in the active mode. The dc analysis is illustrated in Fig. 7.28(b).# Example 7.5 continued 

2. Having determined the operating point, we can now proceed to determine the small-signal model parameters:

$$
\begin{aligned}
& r_{e}=\frac{V_{T}}{I_{E}}=\frac{25 \mathrm{mV}}{(2.3 / 0.99) \mathrm{mA}}=10.8 \Omega \\
& g_{m}=\frac{I_{C}}{V_{T}}=\frac{2.3 \mathrm{~mA}}{25 \mathrm{mV}}=92 \mathrm{~mA} / \mathrm{V} \\
& r_{\pi}=\frac{\beta}{g_{m}}=\frac{100}{92}=1.09 \mathrm{k} \Omega
\end{aligned}
$$

3. Replacing $V_{B B}$ and $V_{C C}$ with short circuits results in the circuit in Fig. 7.28(c).
4. To carry out the small-signal analysis it is equally convenient to employ either of the two hybrid- $\pi$, equivalent-circuit models of Fig. 7.24 to replace the transistor in the circuit of Fig. 7.28(c). Using the first results in the amplifier equivalent circuit given in Fig. 7.28(d).
5. Analysis of the equivalent circuit in Fig. 7.28(d) proceeds as follows:

$$
\begin{aligned}
v_{b e} & =v_{i} \frac{r_{\pi}}{r_{\pi}+R_{B B}} \\
& =v_{i} \frac{1.09}{101.09}=0.011 v_{i}
\end{aligned}
$$

The output voltage $v_{o}$ is given by

$$
\begin{aligned}
v_{o} & =-g_{m} v_{b e} R_{C} \\
& =-92 \times 0.011 v_{i} \times 3=-3.04 v_{i}
\end{aligned}
$$

Thus the voltage gain will be

$$
A_{v}=\frac{v_{o}}{v_{i}}=-3.04 \mathrm{~V} / \mathrm{V}
$$

## Example 7.6

To gain more insight into the operation of transistor amplifiers, we wish to consider the waveforms at various points in the circuit analyzed in the previous example. For this purpose assume that $v_{i}$ has a triangular waveform. First determine the maximum amplitude that $v_{i}$ is allowed to have. Then, with the amplitude of $v_{i}$ set to this value, give the waveforms of the total quantities $i_{B}(t), v_{B E}(t), i_{C}(t)$, and $v_{C}(t)$.
# Solution 

One constraint on signal amplitude is the small-signal approximation, which stipulates that $v_{b s}$ should not exceed about 10 mV . If we take the triangular waveform $v_{b s}$ to be 20 mV peak-to-peak and work backward, Eq. (7.81) can be used to determine the maximum possible peak of $v_{i}$,

$$
\hat{v}_{i}=\frac{\hat{v}_{b s}}{0.011}=\frac{10}{0.011}=0.91 \mathrm{~V}
$$

To check whether the transistor remains in the active mode with $v_{i}$ having a peak value $\hat{v}_{i}=0.91 \mathrm{~V}$, we have to evaluate the collector voltage. The voltage at the collector will consist of a triangular wave $v_{o}$ superimposed on the dc value $V_{C}=3.1 \mathrm{~V}$. The peak voltage of the triangular waveform will be

$$
\hat{v}_{o}=\hat{v}_{i} \times \text { gain }=0.91 \times 3.04=2.77 \mathrm{~V}
$$

It follows that when the output swings negative, the collector voltage reaches a minimum of $3.1-2.77=$ 0.33 V , which is lower than the base voltage by less than 0.4 V . Thus the transistor will remain in the active mode with $v_{i}$ having a peak value of 0.91 V . Nevertheless, to be on the safe side, we will use a somewhat lower value for $\hat{v}_{i}$ of approximately 0.8 V , as shown in Fig. 7.29(a), and complete the analysis of this problem utilizing the equivalent circuit in Fig. 7.28(d). The signal current in the base will be triangular, with a peak value $\hat{i}_{b}$ of

$$
\hat{i}_{b}=\frac{\hat{v}_{i}}{R_{B B}+r_{a}}=\frac{0.8}{100+1.09}=0.008 \mathrm{~mA}
$$

This triangular-wave current will be superimposed on the quiescent base current $I_{B}$, as shown in Fig. 7.29(b). The base-emitter voltage will consist of a triangular-wave component superimposed on the dc $V_{B E}$ that is approximately 0.7 V . The peak value of the triangular waveform will be

$$
\hat{v}_{b s}=\hat{v}_{i} \frac{r_{a}}{r_{a}+R_{B B}}=0.8 \frac{1.09}{100+1.09}=8.6 \mathrm{mV}
$$

The total $v_{B E}$ is sketched in Fig. 7.29(c).
The signal current in the collector will be triangular in waveform, with a peak value $\hat{i}_{c}$ given by

$$
\hat{i}_{c}=\beta \hat{i}_{b}=100 \times 0.008=0.8 \mathrm{~mA}
$$

This current will be superimposed on the quiescent collector current $I_{C}(=2.3 \mathrm{~mA})$, as shown in Fig. 7.29(d).

The signal voltage at the collector can be obtained by multiplying $v_{i}$ by the voltage gain; that is,

$$
\hat{v}_{o}=3.04 \times 0.8=2.43 \mathrm{~V}
$$

Figure 7.29(e) shows a sketch of the total collector voltage $v_{C}$ versus time. Note the phase reversal between the input signal $v_{i}$ and the output signal $v_{o}$.

Finally, we observe that each of the total quantities is the sum of a dc quantity (found from the dc circuit in Fig. 7.28b), and a signal quantity (found from the circuit in Fig. 7.28d).
Example 7.6 continued

(b)

(d)

Figure 7.29 Signal waveforms in the circuit of Fig. 7.28.


Figure 7.29 continued

# Example 7.7 

We need to analyze the circuit of Fig. 7.30(a) to determine the voltage gain and the signal waveforms at various points. The capacitor $C_{C 1}$ is a coupling capacitor whose purpose is to couple the signal $v_{i}$ to the emitter while blocking dc. In this way the dc bias established by $V^{+}$and $V^{-}$together with $R_{E}$ and $R_{C}$ will


Figure 7.30 Example 7.7: (a) circuit; (b) dc analysis; (c) circuit with the dc sources eliminated; (d) small-signal analysis using the T model for the BJT.
# Example 7.7 continued 



Figure 7.30 continued
not be disturbed when the signal $v_{c}$ is connected. For the purpose of this example, $C_{C 1}$ will be assumed to be very large so as to act as a perfect short circuit at signal frequencies of interest. Similarly, another very large capacitor $C_{C 2}$ is used to couple the output signal $v_{o}$ to other parts of the system. You may neglect the Early effect.

## Solution

Here again we shall follow a five-step process:

1. Figure 7.30(b) shows the circuit with the signal source and the coupling capacitors eliminated. The dc operating point can be determined as follows:

$$
I_{E}=\frac{+10-V_{E}}{R_{E}} \simeq \frac{+10-0.7}{10}=0.93 \mathrm{~mA}
$$

Assuming $\beta=100$, then $\alpha=0.99$, and

$$
\begin{aligned}
I_{C} & =0.99 I_{E}=0.92 \mathrm{~mA} \\
V_{C} & =-10+I_{C} R_{C} \\
& =-10+0.92 \times 5=-5.4 \mathrm{~V}
\end{aligned}
$$

Thus the transistor is in the active mode.
2. We now determine the small-signal parameters as follows:

$$
\begin{aligned}
g_{m} & =\frac{I_{C}}{V_{T}}=\frac{0.92}{0.025}=36.8 \mathrm{~mA} / \mathrm{V} \\
r_{e} & =\frac{V_{T}}{I_{E}}=\frac{0.025}{0.92}=27.2 \Omega \\
\beta & =100 \quad \alpha=0.99 \\
r_{n} & =\frac{\beta}{g_{m}}=\frac{100}{36.8}=2.72 \mathrm{k} \Omega
\end{aligned}
$$

3. To prepare the circuit for small-signal analysis, we replace the dc sources with short circuits. The resulting circuit is shown in Fig. 7.30(c). Observe that we have also eliminated the two coupling capacitors, since they are assumed to be acting as perfect short circuits.
4. We are now ready to replace the BJT with one of the four equivalent-circuit models of Figs. 7.24 and 7.26. Although any of the four will work, the T models of Fig. 7.26 will be more convenient because the base is grounded. Selecting the version in Fig. 7.26(b) results in the amplifier equivalent circuit shown in Fig. 7.30(d).
5. Analysis of the circuit in Fig. 7.30(d) to determine the output voltage $v_{o}$ and hence the voltage gain $v_{o} / v_{i}$ is straightforward and is given in the figure. The result is

$$
A_{v}=\frac{v_{o}}{v_{i}}=\frac{\alpha R_{C}}{r_{e}}=\frac{0.99 \times 5}{0.0272}=182 \mathrm{~V} / \mathrm{V}
$$

Note that the voltage gain is positive, indicating that the output is in phase with the input signal. This property is due to the fact that the input signal is applied to the emitter rather than to the base, as was done in Example 7.5. We should emphasize that the positive gain has nothing to do with the fact that the transistor used in this example is of the pnp type.

Returning to the question of allowable signal magnitude, we observe from Fig. 7.30(d) that $v_{e b}=v_{i}$. Thus, if small-signal operation is desired (for linearity), then the peak of $v_{i}$ should be limited to approximately 10 mV . With $\hat{V}_{c}$ set to this value, as shown for a sine-wave input in Fig. 7.31, the peak amplitude at the collector, $\hat{V}_{o}$, will be

$$
\hat{V}_{o}=182 \times 0.01=1.82 \mathrm{~V}
$$
Example 7.7 continued


Figure 7.31 Input and output waveforms for the circuit of Fig. 7.30. Observe that this amplifier is noninverting, a property of the grounded-base configuration.

# EXERCISE 

7.19 To increase the voltage gain of the amplifier analyzed in Example 7.7, the collector resistance $R_{C}$ is increased to $7.5 \mathrm{k} \Omega$. Find the new values of $V_{C}, A_{v}$, and the peak amplitude of the output sine wave corresponding to an input sine wave $v_{i}$ of $10-\mathrm{mV}$ peak.
Ans. $-3.1 \mathrm{~V} ; 276 \mathrm{~V} / \mathrm{V} ; 2.76 \mathrm{~V}$

Performing Small-Signal Analysis Directly on the Circuit Diagram In most cases one should explicitly replace each BJT with its small-signal model and analyze the resulting circuit, as we have done in the examples above. This systematic procedure is particularly recommended for beginning students. Experienced circuit designers, however, often perform a first-order analysis directly on the circuit. Figure 7.32 illustrates this process for the two
circuits we analyzed in Examples 7.5 and 7.7. The reader is urged to follow this direct analysis procedure (the steps are numbered). Observe that the equivalent-circuit model is implicitly utilized; we are only saving the step of drawing the circuit with the BJT replaced by its model. Direct analysis, however, has an additional very important benefit: It provides insight regarding the signal transmission through the circuit. Such insight can prove invaluable in design, particularly at the stage of selecting a circuit configuration appropriate for a given application. Direct analysis can be utilized also for MOS amplifier circuits.


Figure 7.32 Performing signal analysis directly on the circuit diagram with the BJT small-signal model implicitly employed: (a) circuit for Example 7.5; (b) circuit for Example 7.7.
# EXERCISE 

7.20 The transistor in Fig. E7.20 is biased with a constant current source $I=1 \mathrm{~mA}$ and has $\beta=100$ and $V_{A}=100 \mathrm{~V}$.
(a) Neglecting the Early effect, find the dc voltages at the base, emitter, and collector.
(b) Find $g_{m}, r_{\pi}$, and $r_{o}$.
(c) If terminal Z is connected to ground, X to a signal source $v_{\text {sig }}$ with a source resistance $R_{\text {sig }}=$ $2 \mathrm{k} \Omega$, and Y to an $8-\mathrm{k} \Omega$ load resistance, use the hybrid- $\pi$ model shown earlier (Fig. 7.25) to draw the small-signal equivalent circuit of the amplifier. (Note that the current source $I$ should be replaced with an open circuit.) Calculate the overall voltage gain $v_{s} / v_{\text {sig }}$. If $r_{o}$ is neglected, what is the error in estimating the gain magnitude? (Note: An infinite capacitance is used to indicate that the capacitance is sufficiently large that it acts as a short circuit at all signal frequencies of interest. However, the capacitor still blocks dc.)


Figure E7.20

Ans. (a) $-0.1 \mathrm{~V},-0.8 \mathrm{~V},+2.1 \mathrm{~V}$; (b) $40 \mathrm{~mA} / \mathrm{V}, 2.5 \mathrm{k} \Omega, 100 \mathrm{k} \Omega$; (c) $-77 \mathrm{~V} / \mathrm{V},+3.9 \%$

### 7.2.3 Summary Tables

We conclude this section by presenting three useful summary tables: Table 7.1 lists the five steps to be followed in the analysis of a MOSFET or a BJT amplifier circuit. Table 7.2 presents the MOSFET small-signal, equivalent-circuit models, together with the formulas for calculating the parameter values of the models. Finally, Table 7.3 supplies the corresponding data for the BJT.
Table 7.1 Systematic Procedure for the Analysis of Transistor Amplifier Circuits

1. Eliminate the signal source and determine the dc operating point of the transistor.
2. Calculate the values of the parameters of the small-signal model.
3. Eliminate the dc sources by replacing each dc voltage source by a short circuit and each dc current source by an open circuit.
4. Replace the transistor with one of its small-signal, equivalent-circuit models. Although any of the models can be used, one might be more convenient than the others for the particular circuit being analyzed. This point will be made clearer in the next section.
5. Analyze the resulting circuit to determine the required quantities (e.g., voltage gain, input resistance).

Table 7.2 Small-Signal Models of the MOSFET

# Small-Signal Parameters 

## NMOS transistors

## Transconductance:

$$
g_{m}=\mu_{n} C_{o v} W_{L} V_{O V}=\sqrt{2 \mu_{n} C_{o v} W_{L} I_{D}}=\frac{2 I_{D}}{V_{O V}}
$$

Output resistance:

$$
r_{o}=V_{A} / I_{D}=1 / \lambda I_{D}
$$

## PMOS transistors

Same formulas as for NMOS except using $\left|V_{O V}\right|,\left|V_{A}\right|,|\lambda|$ and replacing $\mu_{n}$ with $\mu_{p}$.

## Small-Signal, Equivalent-Circuit Models

Table 7.3 Small-Signal Models of the BJT

Hybrid- $\pi$ Model
$\left(g_{m} v_{\pi}\right)$ Version

$\left(\beta i_{b}\right)$ Version


T Model
$\left(g_{m} v_{\pi}\right)$ Version

$\square(\alpha i)$ Version


Model Parameters in Terms of DC Bias Currents
$g_{m}=\frac{I_{C}}{V_{T}} \quad r_{e}=\frac{V_{T}}{I_{E}}=\alpha \frac{V_{T}}{I_{C}} \quad r_{\pi}=\frac{V_{T}}{I_{B}}=\beta \frac{V_{T}}{I_{C}} \quad r_{o}=\frac{\left|V_{h}\right|}{I_{C}}$

In Terms of $g_{m}$
$r_{e}=\frac{\alpha}{g_{m}} \quad r_{\pi}=\frac{\beta}{g_{m}}$

In Terms of $r_{e}$
$g_{m}=\frac{\alpha}{r_{e}} \quad r_{\pi}=(\beta+1) r_{e} \quad g_{m}+\frac{1}{r_{\pi}}=\frac{1}{r_{e}}$
Relationships between $\alpha$ and $\beta$
$\beta=\frac{\alpha}{1-\alpha} \quad \alpha=\frac{\beta}{\beta+1} \quad \beta+1=\frac{1}{1-\alpha}$
# 7.3 Basic Configurations 

It is useful at this point to take stock of where we are and where we are going in our study of transistor amplifiers. In Section 7.1 we examined the underlying principle for the application of the MOSFET, and of the BJT, as an amplifier. There we found that almost-linear amplification can be obtained by dc biasing the transistor at an appropriate point in its active region of operation, and by keeping the input signal ( $v_{g s}$ or $v_{b e}$ ) small. We then developed, in Section 7.2, circuit models that represent the small-signal operation of each of the two transistor types (Tables 7.2 and 7.3), thus providing a systematic procedure (Table 7.1) for the analysis of transistor amplifiers.

We are now ready to consider the various possible configurations of MOSFET and BJT amplifiers, and we will do that in the present section. To focus our attention on the salient features of the various configurations, we shall present them in their most simple, or "stripped-down," version. Thus, we will not show the dc biasing arrangements, leaving the study of bias design to the next section. Finally, in Section 7.5 we will bring everything together and present practical discrete-circuit amplifiers, namely, amplifier circuits that can be constructed using discrete components. The study of integrated-circuit amplifiers begins in Chapter 8.

### 7.3.1 The Three Basic Configurations

There are three basic configurations for connecting a MOSFET or a BJT as an amplifier. Each of these configurations is obtained by connecting one of the device terminals to ground, thus creating a two-port network with the grounded terminal being common to the input and output ports. The resulting configurations are shown in Fig. 7.33(a-c) for the MOSFET and in Fig. 7.33(d-f) for the BJT.

In the circuit of Fig. 7.33(a) the source terminal is connected to ground, the input voltage signal $v_{i}$ is applied between the gate and ground, and the output voltage signal $v_{o}$ is taken between the drain and ground, across the resistance $R_{D}$. This configuration, therefore, is called the grounded-source or common-source (CS) amplifier. It is by far the most popular MOS amplifier configuration, and we utilized it in Sections 7.1 and 7.2 to study MOS amplifier operation. A parallel set of remarks apply to the BJT counterpart, the grounded-emitter or common-emitter (CE) amplifier in Fig. 7.33(d).

The common-gate (CG) or grounded-gate amplifier is shown in Fig. 7.33(b), and its BJT counterpart, the common-base (CB) or grounded-base amplifier in Fig. 7.33(e). Here the gate (base) is grounded, the input signal $v_{i}$ is applied to the source (emitter), and the output signal $v_{o}$ is taken at the drain (collector) across the resistance $R_{D}\left(R_{C}\right)$. We encountered a CG amplifier in Example 7.4 and a CB amplifier in Example 7.7.

Finally, Fig. 7.33(c) shows the common drain (CD) or grounded-drain amplifier, and Fig. 7.31(f) shows its BJT counterpart, the common-collector (CC) or grounded collector amplifier. Here the drain (collector) terminal is grounded, the input signal $v_{i}$ is applied between gate (base) and ground, and the output voltage $v_{o}$ is taken between the source (emitter) and ground, across a resistance $R_{L}$. For reasons that will become apparent shortly, this pair of configurations is more commonly called the source follower and the emitter follower.

Our study of the three basic amplifier configurations of the MOSFET and of the BJT will reveal that each has distinctly different attributes, hence areas of application. As well, it will be shown that although each pair of configurations, (e.g., CS and CE), has many common attributes, important differences remain.


Figure 7.33 The basic configurations of transistor amplifiers. (a)-(c) For the MOSFET; (d)-(f) for the BJT.

Our next step is to replace the transistor in each of the six circuits in Fig. 7.33 by an appropriate equivalent-circuit model (from Tables 7.2 and 7.3) and analyze the resulting circuits to determine important characteristic parameters of the particular amplifier configuration. To simplify matters, we shall not include $r_{o}$ in the initial analysis. At the end of the section we will offer a number of comments about when to include $r_{o}$ in the analysis, and on the expected magnitude of its effect.

# 7.3.2 Characterizing Amplifiers 

Before we begin our study of the different transistor amplifier configurations, we consider how to characterize the performance of an amplifier as a circuit building block. An introduction to this topic was presented in Section 1.5.

Figure 7.34(a) shows an amplifier fed with a signal source having an open-circuit voltage $v_{\text {sig }}$ and an internal resistance $R_{\text {sig }}$. These can be the parameters of an actual signal source or, in a cascade amplifier, the Thévenin equivalent of the output circuit of another amplifier stage preceding the one under study. The amplifier is shown with a load resistance $R_{L}$ connected to the output terminal. Here, $R_{L}$ can be an actual load resistance or the input resistance of a succeeding amplifier stage in a cascade amplifier.

Figure 7.34(b) shows the amplifier circuit with the amplifier block replaced by its equivalent-circuit model. The input resistance $R_{\mathrm{in}}$ represents the loading effect of the amplifier


Figure 7.34 Characterization of the amplifier as a functional block: (a) An amplifier fed with a voltage signal $v_{\text {sig }}$ having a source resistance $R_{\text {sig }}$, and feeding a load resistance $R_{L}$; (b) equivalent-circuit representation of the circuit in (a); (c) determining the amplifier output resistance $R_{o}$.
input on the signal source. It is found from

$$
R_{\text {in }} \equiv \frac{v_{i}}{i_{i}}
$$

and together with the resistance $R_{\text {sig }}$ forms a voltage divider that reduces $v_{\text {sig }}$ to the value $v_{i}$ that appears at the amplifier input,

$$
v_{i}=\frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}} v_{\text {sig }}
$$

Most of the amplifier circuits studied in this section are unilateral. That is, they do not contain internal feedback, and thus $R_{\text {in }}$ will be independent of $R_{L}$. However, in general $R_{\text {in }}$ may depend on the load resistance $R_{L}$. Indeed one of the six configurations studied in this section, the emitter follower, exhibits such dependence.

The second parameter in characterizing amplifier performance is the open-circuit voltage gain $A_{v o}$, defined as

$$
A_{v o} \equiv\left.\frac{v_{o}}{v_{i}}\right|_{R_{L}=\infty}
$$
The third and final parameter is the output resistance $R_{o}$. Observe from Fig. 7.34(b) that $R_{o}$ is the resistance seen looking back into the amplifier output terminal with $v_{i}$ set to zero. Thus $R_{o}$ can be determined, at least conceptually, as indicated in Fig. 7.34(c) with

$$
R_{o}=\frac{v_{x}}{l_{x}}
$$

Because $R_{o}$ is determined with $v_{i}=0$, the value of $R_{o}$ does not depend on $R_{\text {sig }}$.
The controlled source $A_{v o} v_{i}$ and the output resistance $R_{o}$ represent the Thévenin equivalent of the amplifier output circuit, and the output voltage $v_{o}$ can be found from

$$
v_{o}=\frac{R_{L}}{R_{L}+R_{o}} A_{v o} v_{i}
$$

Thus the voltage gain of the amplifier proper, $A_{v}$, can be found as

$$
A_{v} \equiv \frac{v_{o}}{v_{i}}=A_{v o} \frac{R_{L}}{R_{L}+R_{o}}
$$

and the overall voltage gain, $G_{v}$,

$$
G_{v} \equiv \frac{v_{o}}{v_{\text {sig }}}
$$

can be determined by combining Eqs. (7.83) and (7.85):

$$
G_{v}=\frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}} A_{v o} \frac{R_{L}}{R_{L}+R_{o}}
$$

# 7.3.3 The Common-Source (CS) and Common-Emitter (CE) Amplifiers 

Of the three basic transistor amplifier configurations, the common-source (common-emitter, for BJT), is the most widely used. Typically, in an amplifier formed by cascading a number of gain stages, the bulk of the voltage gain is obtained by using one or more common-source (or common-emitter, for BJT) stages in cascade.

Characteristic Parameters of the CS Amplifier Figure 7.35(a) shows a common-source amplifier (with the biasing arrangement omitted) fed with a signal source $v_{\text {sig }}$ having a source resistance $R_{\text {sig }}$. We wish to analyze this circuit to determine $R_{\text {in }}, A_{v o}$, and $R_{o}$. For this purpose, we assume that $R_{D}$ is part of the amplifier; thus if a load resistance $R_{L}$ is connected to the amplifier output, $R_{L}$ appears in parallel with $R_{D}$. In such a case, we wish to determine $A_{v}$ and $G_{v}$ as well.

Replacing the MOSFET with its hybrid- $\pi$ model (without $r_{o}$ ), we obtain the CS amplifier equivalent circuit in Fig. 7.35(b) for which, tracing the signal from input to output, we can write by inspection

$$
\begin{aligned}
R_{\text {in }} & =\infty \\
v_{i} & =v_{\text {sig }} \\
v_{g s} & =v_{i} \\
v_{o} & =-g_{m} v_{g s} R_{D}
\end{aligned}
$$

(a)

(b)

Figure 7.35 (a) Common-source amplifier fed with a signal $v_{\text {sig }}$ from a generator with a resistance $R_{\text {sig }}$. The bias circuit is omitted. (b) The common-source amplifier with the MOSFET replaced with its hybrid- $\pi$ model.

Thus,

$$
\begin{gathered}
A_{v \sigma} \equiv \frac{v_{o}}{v_{i}}=-g_{m} R_{D} \\
R_{o}=R_{D}
\end{gathered}
$$

If a load resistance $R_{L}$ is connected across $R_{D}$, the voltage gain $A_{v}$ can be obtained from

$$
A_{v}=A_{v \sigma} \frac{R_{L}}{R_{L}+R_{o}}
$$

where $A_{v \sigma}$ is given by Eq. (7.88) and $R_{o}$ by Eq. (7.89), or alternatively by simply adding $R_{L}$ in parallel with $R_{D}$ in Eq. (7.88), thus

$$
A_{v}=-g_{m}\left(R_{D} \| R_{L}\right)
$$

The reader can easily show that the expression obtained from Eq. (7.90) is identical to that in Eq. (7.91). Finally, since $R_{\text {in }}=\infty$ and thus $v_{i}=v_{\text {sig }}$, the overall voltage gain $G_{v}$ is equal to $A_{v}$,

$$
G_{v} \equiv \frac{v_{o}}{v_{\text {sig }}}=-g_{m}\left(R_{D} \| R_{L}\right)
$$
# EXERCISE 

7.21 A CS amplifier utilizes a MOSFET biased at $I_{D}=0.25 \mathrm{~mA}$ with $V_{O V}=0.25 \mathrm{~V}$ and $R_{D}=20 \mathrm{k} \Omega$. The amplifier is fed with a signal source having $R_{\text {sig }}=100 \mathrm{k} \Omega$, and a $20-\mathrm{k} \Omega$ load is connected to the output. Find $R_{\mathrm{in}}, A_{v \pi}, R_{o}, A_{v}$, and $G_{v}$. If, to maintain reasonable linearity, the peak of the input sine-wave signal is limited to $10 \%$ of $2 V_{O V}$, what is the peak of the sine-wave voltage at the output? Ans. $\infty ;-40 \mathrm{~V} / \mathrm{V} ; 20 \mathrm{k} \Omega ;-20 \mathrm{~V} / \mathrm{V} ;-20 \mathrm{~V} / \mathrm{V} ; 1 \mathrm{~V}$

Characteristic Parameters of the CE Amplifier Figure 7.36(a) shows a common-emitter amplifier. Its equivalent circuit, obtained by replacing the BJT with its hybrid- $\pi$ model (without $r_{o}$ ), is shown in Fig. 7.36(b). The latter circuit can be analyzed to obtain the characteristic parameters of the CE amplifier. The analysis parallels that for the MOSFET above except that here we have the added complexity of a finite input resistance $r_{\pi}$. Tracing the signal through the amplifier from input to output, we can write by inspection

$$
R_{\mathrm{in}}=r_{\pi}
$$


(a)

(b)

Figure 7.36 (a) Common-emitter amplifier fed with a signal $v_{\text {sig }}$ from a generator with a resistance $R_{\text {sig }}$. The bias circuit is omitted. (b) The common-emitter amplifier circuit with the BJT replaced by its hybrid- $\pi$ model.
Then we write

$$
\begin{aligned}
v_{i} & =\frac{r_{\pi}}{r_{\pi}+R_{\text {sig }}} v_{\text {sig }} \\
v_{\pi} & =v_{i} \\
v_{o} & =-g_{m} v_{\pi} R_{C}
\end{aligned}
$$

Thus,

$$
\begin{gathered}
A_{v o} \equiv \frac{v_{o}}{v_{i}}=-g_{m} R_{C} \\
R_{o}=R_{C}
\end{gathered}
$$

With a load resistance $R_{L}$ connected across $R_{C}$,

$$
A_{v}=-g_{m}\left(R_{C} \| R_{L}\right)
$$

and the overall voltage gain $G_{v}$ can be found from

$$
G_{v} \equiv \frac{v_{o}}{v_{\text {sig }}}=\frac{v_{i}}{v_{\text {sig }}} \frac{v_{o}}{v_{i}}
$$

Thus,

$$
G_{v}=-\frac{r_{\pi}}{r_{\pi}+R_{\text {sig }}} g_{m}\left(R_{C} \| R_{L}\right)
$$

It is important to note here the effect of the finite input resistance $\left(r_{\pi}\right)$ in reducing the magnitude of the voltage gain by the voltage-divider ratio $r_{\pi} /\left(r_{\pi}+R_{\text {sig }}\right)$. The extent of the gain reduction depends on the relative values of $r_{\pi}$ and $R_{\text {sig }}$. However, there is a compensating effect in the CE amplifier: $g_{m}$ of the BJT is usually much higher than the corresponding value of the MOSFET.

# Example 7.8 

A CE amplifier utilizes a BJT with $\beta=100$ is biased at $I_{C}=1 \mathrm{~mA}$ and has a collector resistance $R_{C}=5 \mathrm{k} \Omega$. Find $R_{\mathrm{in}}, R_{o}$, and $A_{v o}$. If the amplifier is fed with a signal source having a resistance of $5 \mathrm{k} \Omega$, and a load resistance $R_{L}=5 \mathrm{k} \Omega$ is connected to the output terminal, find the resulting $A_{v}$ and $G_{v}$. If $\hat{v}_{\pi}$ is to be limited to 5 mV , what are the corresponding $\hat{v}_{\text {sig }}$ and $\hat{v}_{o}$ with the load connected?

## Solution

At $I_{C}=1 \mathrm{~mA}$,

$$
\begin{aligned}
& g_{m}=\frac{I_{C}}{V_{T}}=\frac{1 \mathrm{~mA}}{0.025 \mathrm{~V}}=40 \mathrm{~mA} / \mathrm{V} \\
& r_{\pi}=\frac{\beta}{g_{m}}=\frac{100}{40 \mathrm{~mA} / \mathrm{V}}=2.5 \mathrm{k} \Omega
\end{aligned}
$$
# Example 7.8 continued 

The amplifier characteristic parameters can now be found as

$$
\begin{aligned}
R_{\mathrm{in}} & =r_{n}=2.5 \mathrm{k} \Omega \\
A_{v o} & =-g_{m} R_{C} \\
& =-40 \mathrm{~mA} / \mathrm{V} \times 5 \mathrm{k} \Omega \\
& =-200 \mathrm{~V} / \mathrm{V} \\
R_{o} & =R_{C}=5 \mathrm{k} \Omega
\end{aligned}
$$

With a load resistance $R_{L}=5 \mathrm{k} \Omega$ connected at the output, we can find $A_{v}$ by either of the following two approaches:

$$
\begin{aligned}
A_{v} & =A_{v o} \frac{R_{L}}{R_{L}+R_{o}} \\
& =-200 \times \frac{5}{5+5}=-100 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

or

$$
\begin{aligned}
A_{v} & =-g_{m}\left(R_{C} \| R_{L}\right) \\
& =-40(5\|5)=-100 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

The overall voltage gain $G_{v}$ can now be determined as

$$
\begin{aligned}
G_{v} & =\frac{R_{\mathrm{in}}}{R_{\mathrm{in}}+R_{\mathrm{sig}}} A_{v} \\
& =\frac{2.5}{2.5+5} \times-100=-33.3 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

If the maximum amplitude of $v_{n}$ is to be 5 mV , the corresponding value of $\hat{v}_{\text {sig }}$ will be

$$
\hat{v}_{\text {sig }}=\left(\frac{R_{\text {in }}+R_{\text {sig }}}{R_{\text {in }}}\right) \hat{v}_{n}=\frac{2.5+5}{2.5} \times 5=15 \mathrm{mV}
$$

and the amplitude of the signal at the output will be

$$
\hat{v}_{o}=G_{v} \hat{v}_{\text {sig }}=33.3 \times 0.015=0.5 \mathrm{~V}
$$
# EXERCISE 

7.22 The designer of the amplifier in Example 7.8 decides to lower the bias current to half its original value in order to raise the input resistance and hence increase the fraction of $v_{\text {sig }}$ that appears at the input of the amplifier proper. In an attempt to maintain the voltage gain, the designer decides to double the value of $R_{C}$. For the new design, determine $R_{\mathrm{in}}, A_{v \pi}, R_{o}, A_{v}$, and $G_{v}$. If the peak amplitude of $v_{\pi}$ is to be limited to 5 mV , what are the corresponding values of $\hat{v}_{\text {sig }}$ and $\hat{v}_{o}$ (with the load connected)?
Ans. $5 \mathrm{k} \Omega ;-200 \mathrm{~V} / \mathrm{V} ; 10 \mathrm{k} \Omega ;-66.7 \mathrm{~V} / \mathrm{V} ;-33.3 \mathrm{~V} / \mathrm{V} ; 10 \mathrm{mV} ; 0.33 \mathrm{~V}$
Comment: Although a larger fraction of the input signal reaches the amplifier input, linearity considerations cause the output signal to be in fact smaller than in the original design!

## Final Remarks

1. The CS and CE amplifiers are the most useful of all transistor amplifier configurations. They exhibit a moderate to high input resistance (infinite for the CS), a moderate to high output resistance, and reasonably high voltage gain.
2. The input resistance of the CE amplifier, $R_{\mathrm{in}}=r_{\pi}=\beta / g_{m}$, is inversely proportional to the dc bias current $I_{C}$. To increase $R_{\text {in }}$ one is tempted to lower the bias current $I_{C}$; however, this also lowers $g_{m}$ and hence the voltage gain. This is a significant design trade-off. If a much higher input resistance is desired, then a modification of the CE configuration (to be discussed in Section 7.3.4) can be applied, or an emitter-follower stage can be inserted between the signal source and the CE amplifier (see Section 7.3.6).
3. Reducing $R_{D}$ or $R_{C}$ to lower the output resistance of the CS or CE amplifier, respectively, is usually not a viable proposition because the voltage gain is also reduced. Alternatively, if a very low output resistance (in the ohms or tens-of-ohms range) is needed, a source-follower or an emitter-follower stage can be utilized between the output of the CS or CE amplifier and the load resistance (see Section 7.3.6).
4. Although the CS and the CE configurations are the workhorses of transistor amplifiers, both suffer from a limitation on their high-frequency response. As will be shown in Chapter 10, combining the CS (CE) amplifier with a CG (CB) amplifier can extend the bandwidth considerably. The CG and CB amplifiers are studied in Section 7.3.5.

### 7.3.4 The Common-Source (Common-Emitter) Amplifier with a Source (Emitter) Resistance

It is often beneficial to insert a resistance $R_{s}$ (a resistance $R_{e}$ ) in the source lead (the emitter lead) of a common-source (common-emitter) amplifier. Figure 7.37(a) shows a CS amplifier with a resistance $R_{s}$ in its source lead. The corresponding small-signal equivalent circuit is shown

Figure 7.37 The CS amplifier with a source resistance $R_{s}$ : (a) circuit without bias details; (b) equivalent circuit with the MOSFET represented by its T model.
in Fig. 7.37(b), where we have utilized the T model for the MOSFET. The T model is used in preference to the hybrid- $\pi$ model because it makes the analysis in this case considerably simpler. In general, whenever a resistance is connected in the source lead, the $T$ model is preferred. The source resistance then simply appears in series with the model resistance $1 / g_{m}$ and can be added to it.

From Fig. 7.37(b) we see that as expected, the input resistance $R_{\text {in }}$ is infinite and thus $v_{i}=v_{\text {sig }}$. Unlike the CS amplifier, however, here only a fraction of $v_{i}$ appears between gate and source as $v_{g s}$. The voltage divider composed of $1 / g_{m}$ and $R_{s}$, which appears across the amplifier input, can be used to determine $v_{g s}$, as follows:

$$
v_{g s}=v_{i} \frac{1 / g_{m}}{1 / g_{m}+R_{s}}=\frac{v_{i}}{1+g_{m} R_{s}}
$$

Thus we can use the value of $R_{s}$ to control the magnitude of the signal $v_{g s}$ and thereby ensure that $v_{g s}$ does not become too large and cause unacceptably high nonlinear distortion. This is the first benefit of including resistor $R_{s}$. Other benefits will be encountered in later sections and chapters. For instance, it will be shown in Chapter 10 that $R_{s}$ causes the useful bandwidth of the amplifier to be extended. The mechanism by which $R_{s}$ causes such improvements in amplifier performance is negative feedback. To see how $R_{s}$ introduces negative feedback, refer to Fig. 7.37(a): If with $v_{\text {sig }}$ and hence $v_{i}$ kept constant, the drain current increases for some
reason, the source current also will increase, resulting in an increased voltage drop across $R_{s}$. Thus the source voltage rises, and the gate-to-source voltage decreases. The latter effect causes the drain current to decrease, counteracting the initially assumed change, an indication of the presence of negative feedback. In Chapter 11 we shall study negative feedback formally. There we will learn that the improvements that negative feedback provides are obtained at the expense of a reduction in gain. We will now show this to be the case in the circuit of Fig. 7.37.

The output voltage $v_{o}$ is obtained by multiplying the controlled-source current $i$ by $R_{D}$,

$$
v_{o}=-i R_{D}
$$

The current $i$ in the source lead can be found by dividing $v_{i}$ by the total resistance in the source,

$$
i=\frac{v_{i}}{1 / g_{m}+R_{s}}=\left(\frac{g_{m}}{1+g_{m} R_{s}}\right) v_{i}
$$

Thus, the voltage gain $A_{v o}$ can be found as

$$
A_{v o} \equiv \frac{v_{o}}{v_{i}}=-\frac{g_{m} R_{D}}{1+g_{m} R_{s}}
$$

which can also be expressed as

$$
A_{v o}=-\frac{R_{D}}{1 / g_{m}+R_{s}}
$$

Equation (7.100) indicates that including the resistance $R_{s}$ reduces the voltage gain by the factor $\left(1+g_{m} R_{s}\right)$. This is the price paid for the improvements that accrue as a result of $R_{s}$. It is interesting to note that in Chapter 11, we will find that the factor $\left(1+g_{m} R_{s}\right)$ is the "amount of negative feedback" introduced by $R_{s}$. It is also the same factor by which linearity, bandwidth, and other performance parameters improve. Because of the negative-feedback action of $R_{s}$ it is known as a source-degeneration resistance.

There is another useful interpretation of the expression for the drain current in Eq. (7.99): The quantity between brackets on the right-hand side can be thought of as the "effective transconductance with $R_{s}$ included." Thus, including $R_{s}$ reduces the transconductance by the factor $\left(1+g_{m} R_{s}\right)$. This, of course, is simply the result of the fact that only a fraction $1 /\left(1+g_{m} R_{s}\right)$ of $v_{i}$ appears as $v_{g s}$ (see Eq. 7.98).

The alternative gain expression in Eq. (7.101) has a powerful and insightful interpretation: The voltage gain between gate and drain is equal to the ratio of the total resistance in the drain $\left(R_{D}\right)$ to the total resistance in the source $\left(1 / g_{m}+R_{s}\right)$,

$$
\text { Voltage gain from gate to drain }=-\frac{\text { Total resistance in drain }}{\text { Total resistance in source }}
$$

This is a general expression. For instance, setting $R_{s}=0$ in Eq. (7.101) yields $A_{v o}$ of the CS amplifier.
Finally, we consider the situation of a load resistance $R_{L}$ connected at the output. We can obtain the gain $A_{v}$ using the open-circuit voltage gain $A_{v o}$ together with the output resistance $R_{o}$, which can be found by inspection to be

$$
R_{o}=R_{D}
$$

Alternatively, $A_{v}$ can be obtained by simply replacing $R_{D}$ in Eq. (7.101) or (7.100) by $\left(R_{D} \| R_{L}\right)$; thus,

$$
A_{v}=-\frac{g_{m}\left(R_{D} \| R_{L}\right)}{1+g_{m} R_{s}}
$$

or

$$
A_{v}=-\frac{R_{D} \| R_{L}}{1 / g_{m}+R_{s}}
$$

Observe that Eq. (7.104) is a direct application of the ratio of total resistance rule of Eq. (7.102). Finally, note that because $R_{\text {in }}$ is infinite, $v_{i}=v_{\text {sig }}$ and the overall voltage gain $G_{v}$ is equal to $A_{v}$.

# EXERCISE 

7.23 In Exercise 7.21 we applied an input signal $v_{\text {sig }}$ of 50 mV peak and obtained an output signal of approximately 1 V peak. Assume that for some reason we now have an input signal $v_{\text {sig }}$ that is 0.2 V peak and that we wish to modify the circuit to keep $v_{g}$, unchanged, and thus keep the nonlinear distortion from increasing. What value should we use for $R_{s}$ ? What value of $G_{v}$ will result? What will the peak signal at the output become? Assume $r_{o}=\infty$.
Ans. $1.5 \mathrm{k} \Omega ;-5 \mathrm{~V} / \mathrm{V} ; 1 \mathrm{~V}$

We next turn our attention to the BJT case. Figure 7.38(a) shows a CE amplifier with a resistance $R_{e}$ in its emitter. The corresponding equivalent circuit, utilizing the T model, is shown in Fig. 7.38(b). Note that in the BJT case also, as a general rule, the T model results in a simpler analysis and should be employed whenever there is a resistance in series with the emitter.

To determine the amplifier input resistance $R_{\text {in }}$, we note from Fig. 7.38(b) that

$$
R_{\text {in }} \equiv \frac{v_{i}}{i_{b}}
$$

where

$$
i_{b}=(1-\alpha) i_{e}=\frac{i_{e}}{\beta+1}
$$

and

$$
i_{e}=\frac{v_{i}}{r_{e}+R_{e}}
$$


Figure 7.38 The CE amplifier with an emitter resistance $R_{e}$; (a) circuit without bias details; (b) equivalent circuit with the BJT replaced with its T model.

Thus,

$$
R_{\mathrm{in}}=(\beta+1)\left(r_{e}+R_{e}\right)
$$

This is a very important result. It states that the input resistance looking into the base is $(\beta+1)$ times the total resistance in the emitter, and is known as the resistance-reflection rule. The factor $(\beta+1)$ arises because the base current is $1 /(\beta+1)$ times the emitter current. The expression for $R_{\text {in }}$ in Eq. (7.107) shows clearly that including a resistance $R_{e}$ in the emitter can substantially increase $R_{\text {in }}$, a very desirable result. Indeed, the value of $R_{\text {in }}$ is increased by the ratio

$$
\begin{aligned}
\frac{R_{\text {in }}(\text { with } R_{e} \text { included })}{R_{\text {in }}(\text { without } R_{e})} & =\frac{(\beta+1)\left(r_{e}+R_{e}\right)}{(\beta+1) r_{e}} \\
& =1+\frac{R_{e}}{r_{e}} \simeq 1+g_{m} R_{e}
\end{aligned}
$$

Thus the circuit designer can use the value of $R_{e}$ to control the value of $R_{\text {in }}$.
To determine the voltage gain $A_{v o}$, we see from Fig. 7.38(b) that

$$
\begin{aligned}
v_{o} & =-i_{c} R_{C} \\
& =-\alpha i_{c} R_{C}
\end{aligned}
$$

Substituting for $i_{e}$ from Eq. (7.106) gives

$$
A_{v o}=-\alpha \frac{R_{C}}{r_{e}+R_{e}}
$$

This is a very useful result: It states that the gain from base to collector is $\alpha$ times the ratio of the total resistance in the collector to the total resistance in the emitter (in this case, $r_{e}+R_{e}$ ),

$$
\text { Voltage gain from base to collector }=-\alpha \frac{\text { Total resistance in collector }}{\text { Total resistance in emitter }}
$$

This is the BJT version of the MOSFET expression in Eq. (7.102) except that here we have the additional factor $\alpha$. This factor arises because $i_{c}=\alpha i_{e}$, unlike the MOSFET case where $i_{d}=i_{c}$. Usually, $\alpha \simeq 1$ and can be dropped from Eq. (7.110).

The open-circuit voltage gain in Eq. (7.109) can be expressed alternatively as

$$
A_{v o}=-\frac{\alpha}{r_{e}} \frac{R_{C}}{1+R_{e} / r_{e}}
$$

Thus,

$$
A_{v o}=-\frac{g_{m} R_{C}}{1+R_{e} / r_{e}} \simeq-\frac{g_{m} R_{C}}{1+g_{m} R_{e}}
$$

Thus, including $R_{e}$ reduces the voltage gain by the factor $\left(1+g_{m} R_{e}\right)$, which is the same factor by which $R_{\mathrm{m}}$ is increased. This points out an interesting trade-off between gain and input resistance, a trade-off that the designer can exercise through the choice of an appropriate value for $R_{e}$.

The output resistance $R_{o}$ can be found from the circuit in Fig. 7.38(b) by inspection:

$$
R_{o}=R_{C}
$$

If a load resistance $R_{L}$ is connected at the amplifier output, $A_{v}$ can be found as

$$
\begin{aligned}
A_{v} & =A_{v o} \frac{R_{L}}{R_{L}+R_{o}} \\
& =-\alpha \frac{R_{C}}{r_{e}+R_{e}} \frac{R_{L}}{R_{L}+R_{C}} \\
& =-\alpha \frac{R_{C} \| R_{L}}{r_{e}+R_{e}}
\end{aligned}
$$

which could have been written directly using Eq. (7.110). The overall voltage gain $G_{v}$ can now be found:

$$
G_{v}=\frac{R_{\mathrm{in}}}{R_{\mathrm{in}}+R_{\mathrm{sig}}} \times-\alpha \frac{R_{C} \| R_{L}}{r_{e}+R_{e}}
$$
Substituting for $R_{\text {in }}$ from Eq. (7.107) and replacing $\alpha$ with $\beta /(\beta+1)$ results in

$$
G_{v}=-\beta \frac{R_{C} \| R_{L}}{R_{\text {sig }}+(\beta+1)\left(r_{e}+R_{e}\right)}
$$

Careful examination of this expression reveals that the denominator comprises the total resistance in the base circuit [recall that $(\beta+1)\left(r_{e}+R_{e}\right)$ is the reflection of $\left(r_{e}+R_{e}\right)$ from the emitter side to the base side]. Thus the expression in Eq. (7.113) states that the voltage gain from base to collector is equal to $\beta$ times the ratio of the total resistance in the collector to the total resistance in the base. The factor $\beta$ appears because it is the ratio of the collector current to the base current. This general and useful expression has no counterpart in the MOS case. We observe that the overall voltage gain $G_{v}$ is lower than the value without $R_{e}$, namely,

$$
G_{v}=-\beta \frac{R_{C} \| R_{L}}{R_{\text {sig }}+(\beta+1) r_{e}}
$$

because of the additional term $(\beta+1) R_{e}$ in the denominator. The gain, however, is now less sensitive to the value of $\beta$, a desirable result because of the typical wide variability in the value of $\beta$.

Another important consequence of including the resistance $R_{e}$ in the emitter is that it enables the amplifier to handle larger input signals without incurring nonlinear distortion. This is because only a fraction of the input signal at the base, $v_{i}$, appears between the base and the emitter. Specifically, from the circuit in Fig. 7.38(b), we see that

$$
\frac{v_{\pi}}{v_{i}}=\frac{r_{e}}{r_{e}+R_{e}} \simeq \frac{1}{1+g_{m} R_{e}}
$$

Thus, for the same $v_{\pi}$, the signal at the input terminal of the amplifier, $v_{i}$, can be greater than for the CE amplifier by the factor $\left(1+g_{m} R_{e}\right)$.

To summarize, including a resistance $R_{e}$ in the emitter of the CE amplifier results in the following characteristics:

1. The input resistance $R_{\text {in }}$ is increased by the factor $\left(1+g_{m} R_{e}\right)$.
2. The voltage gain from base to collector, $A_{c}$, is reduced by the factor $\left(1+g_{m} R_{e}\right)$.
3. For the same nonlinear distortion, the input signal $v_{i}$ can be increased by the factor $\left(1+g_{m} R_{e}\right)$.
4. The overall voltage gain is less dependent on the value of $\beta$.
5. The high-frequency response is significantly improved (as we shall see in Chapter 10).

With the exception of gain reduction, these characteristics represent performance improvements. Indeed, the reduction in gain is the price paid for obtaining the other performance improvements. In many cases this is a good bargain; it is the underlying philosophy for the use of negative feedback. That the resistance $R_{e}$ introduces negative feedback in the amplifier circuit can be verified by utilizing a procedure similar to that we used above for the MOSFET case. In Chapter 11, where we shall study negative feedback formally, we will find that the factor $\left(1+g_{m} R_{e}\right)$, which appears repeatedly, is the "amount of negative feedback" introduced by $R_{e}$. Finally, we note that the negative-feedback action of $R_{e}$ gives it the name emitter degeneration resistance.
# Example 7.9 

For the CE amplifier specified in Example 7.8, what value of $R_{e}$ is needed to raise $R_{\text {in }}$ to a value four times that of $R_{\text {sig }}$ ? With $R_{e}$ included, find $A_{v o}, R_{o}, A_{v}$, and $G_{v}$. Also, if $\hat{v}_{n}$ is limited to 5 mV , what are the corresponding values of $\hat{v}_{\text {sig }}$ and $\hat{v}_{o}$ ?

## Solution

To obtain $R_{\text {in }}=4 R_{\text {sig }}=4 \times 5=20 \mathrm{k} \Omega$, the required $R_{e}$ is found from

$$
20=(\beta+1)\left(r_{e}+R_{e}\right)
$$

With $\beta=100$,

$$
r_{e}+R_{e} \simeq 200 \Omega
$$

Thus,

$$
\begin{aligned}
R_{e} & =200-25=175 \Omega \\
A_{v o} & =-\alpha \frac{R_{C}}{r_{e}+R_{e}} \\
& \simeq-\frac{5000}{25+175}=-25 \mathrm{~V} / \mathrm{V} \\
R_{o} & =R_{C}=5 \mathrm{k} \Omega \text { (unchanged) } \\
A_{v} & =A_{v o} \frac{R_{L}}{R_{L}+R_{o}}=-25 \times \frac{5}{5+5}=-12.5 \mathrm{~V} / \mathrm{V} \\
G_{v} & =\frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}} A_{v}=-\frac{20}{20+5} \times 12.5=-10 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

For $\hat{v}_{n}=5 \mathrm{mV}$,

$$
\begin{aligned}
\hat{v}_{i} & =\hat{v}_{n}\left(\frac{r_{e}+R_{e}}{r_{e}}\right) \\
& =5\left(1+\frac{175}{25}\right)=40 \mathrm{mV} \\
\hat{v}_{\text {sig }} & =\hat{v}_{i} \frac{R_{\text {in }}+R_{\text {sig }}}{R_{\text {in }}} \\
& =40\left(1+\frac{5}{20}\right)=50 \mathrm{mV} \\
\hat{v}_{o} & =\hat{v}_{\text {sig }} \times\left|G_{v}\right| \\
& =50 \times 10=500 \mathrm{mV}=0.5 \mathrm{~V}
\end{aligned}
$$

Thus, while $\left|G_{v}\right|$ has decreased to about a third of its original value, the amplifier is able to produce as large an output signal as before for the same nonlinear distortion.
# EXERCISE 

7.24 Show that with $R_{e}$ included, and $v_{n}$ limited to a maximum value $\hat{v}_{n}$, the maximum allowable input signal, $\hat{v}_{\text {sig }}$, is given by

$$
\hat{v}_{\text {sig }}=\hat{v}_{n}\left(1+\frac{R_{e}}{r_{e}}+\frac{R_{\text {sig }}}{r_{n}}\right)
$$

If the transistor is biased at $I_{C}=0.5 \mathrm{~mA}$ and has a $\beta$ of 100 , what value of $R_{e}$ is needed to permit an input signal $\hat{v}_{\text {sig }}$ of 100 mV from a source with a resistance $R_{\text {sig }}=10 \mathrm{k} \Omega$ while limiting $\hat{v}_{n}$ to 10 mV ? What is $R_{\text {in }}$ for this amplifier? If the total resistance in the collector is $10 \mathrm{k} \Omega$, what $G_{v}$ value results? Ans. $350 \Omega ; 40.4 \mathrm{k} \Omega ;-19.8 \mathrm{~V} / \mathrm{V}$

### 7.3.5 The Common-Gate (CG) and the Common-Base (CB) Amplifiers

Figure 7.39(a) shows a common-gate amplifier with the biasing circuit omitted. The amplifier is fed with a signal source characterized by $v_{\text {sig }}$ and $R_{\text {sig }}$. Since $R_{\text {sig }}$ appears in series with the source, it is more convenient to represent the transistor with the T model than with the $\pi$ model. Doing this, we obtain the amplifier equivalent circuit shown in Fig. 7.39(b).

From inspection of the equivalent circuit of Fig. 7.39(b), we see that the input resistance

$$
R_{\mathrm{in}}=\frac{1}{g_{m}}
$$



Figure 7.39 (a) Common-gate (CG) amplifier with bias arrangement omitted. (b) Equivalent circuit of the CG amplifier with the MOSFET replaced with its T model.
This should have been expected, since we are looking into the source and the gate is grounded. Typically $1 / g_{m}$ is a few hundred ohms; thus the CG amplifier has a low input resistance.

To determine the voltage gain $A_{v o}$, we write at the drain node

$$
v_{o}=-i R_{D}
$$

and substitute for the source current $i$ from

$$
i=-\frac{v_{i}}{1 / g_{m}}
$$

to obtain

$$
A_{v o} \equiv \frac{v_{o}}{v_{i}}=g_{m} R_{D}
$$

which except for the positive sign is identical to the expression for $A_{v o}$ of the CS amplifier.
The output resistance of the CG circuit can be found by inspection of the circuit in Fig. 7.39(b) as

$$
R_{o}=R_{D}
$$

which is the same as in the case of the CS amplifier.
Although the gain of the CG amplifier proper has the same magnitude as that of the CS amplifier, this is usually not the case as far as the overall voltage gain is concerned. The low input resistance of the CG amplifier can cause the input signal to be severely attenuated. Specifically,

$$
\frac{v_{i}}{v_{\text {sig }}}=\frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}}=\frac{1 / g_{m}}{1 / g_{m}+R_{\text {sig }}}
$$

from which we see that except for situations in which $R_{\text {sig }}$ is on the order of $1 / g_{m}$, the signal transmission factor $v_{i} / v_{\text {sig }}$ can be very small and the overall voltage gain $G_{v}$ can be correspondingly small. Specifically, with a resistance $R_{L}$ connected at the output

$$
G_{v}=\frac{1 / g_{m}}{R_{\text {sig }}+1 / g_{m}}\left[g_{m}\left(R_{D} \| R_{L}\right)\right]
$$

Thus,

$$
G_{v}=\frac{\left(R_{D} \| R_{L}\right)}{R_{\text {sig }}+1 / g_{m}}
$$

Observe that the overall voltage gain is simply the ratio of the total resistance in the drain circuit to the total resistance in the source circuit. If $R_{\text {sig }}$ is of the same order as $R_{D}$ and $R_{L}$, $G_{v}$ will be very small.

Because of its low input resistance, the CG amplifier alone has very limited application. One such application is to amplify high-frequency signals that come from sources with relatively low resistances. These include cables, where it is usually necessary for the input resistance of the amplifier to match the characteristic resistance of the cable. As will be shown in Chapter 10, the CG amplifier has excellent high-frequency response. Thus it can be combined with the CS amplifier in a very beneficial way that takes advantage of the best features of each of the two configurations. A very significant circuit of this kind will be studied in Chapter 8.
# EXERCISE 

7.25 A CG amplifier is required to match a signal source with $R_{\text {sig }}=100 \Omega$. At what current $I_{D}$ should the MOSFET be biased if it is operated at an overdrive voltage of 0.20 V ? If the total resistance in the drain circuit is $2 \mathrm{k} \Omega$, what overall voltage gain is realized?
Ans. $1 \mathrm{~mA} ; 10 \mathrm{~V} / \mathrm{V}$

Very similar results can be obtained for the CB amplifier shown in Fig. 7.40(a). Specifically, from the equivalent circuit in Fig. 7.40(b) we can find

$$
\begin{gathered}
R_{\mathrm{in}}=r_{e}=\frac{\alpha}{g_{m}} \simeq 1 / g_{m} \\
A_{v o}=\frac{\alpha}{r_{e}} R_{C}=g_{m} R_{C} \\
R_{o}=R_{C}
\end{gathered}
$$

and with a load resistance $R_{L}$ connected to the output, the overall voltage gain is given by

$$
G_{v} \equiv \frac{v_{o}}{v_{\text {sig }}}=\alpha \frac{R_{C} \| R_{L}}{R_{\text {sig }}+r_{e}}
$$


(a)

(b)

Figure 7.40 (a) CB amplifier with bias details omitted; (b) amplifier equivalent circuit with the BJT represented by its T model.Since $\alpha \simeq 1$, we see that as in the case of the CG amplifier, the overall voltage gain is simply the ratio of the total resistance in the collector to the total resistance in the emitter. We also note that the overall voltage gain is almost independent of the value of $\beta$ (except through the small dependence of $\alpha$ on $\beta$ ), a desirable property. Observe that for $R_{\text {sig }}$ of the same order as $R_{C}$ and $R_{L}$, the gain will be very small.

In summary, the CB and CG amplifiers exhibit a very low input resistance $\left(1 / g_{m}\right)$, an open-circuit voltage gain that is positive and equal in magnitude to that of the CE (CG) amplifier ( $g_{m} R_{C}$ or $g_{m} R_{D}$ ), and, like the CE (CS) amplifier, a relatively high output resistance ( $R_{C}$ or $R_{D}$ ). Because of its very low input resistance, the $\mathrm{CB}(\mathrm{CG})$ circuit alone is not attractive as a voltage amplifier except in specialized applications, such as the cable amplifier mentioned above. The $\mathrm{CB}(\mathrm{CG})$ amplifier has excellent high-frequency performance, which as we shall see in Chapters 8 and 10, makes it useful in combination with other circuits in the implementation of high-frequency amplifiers.

# EXERCISES 

7.26 Consider a CB amplifier utilizing a BJT biased at $I_{C}=1 \mathrm{~mA}$ and with $R_{C}=5 \mathrm{k} \Omega$. Determine $R_{i n}$, $A_{v o}$, and $R_{o}$. If the amplifier is loaded in $R_{L}=5 \mathrm{k} \Omega$, what value of $A_{v}$ results? What $G_{v}$ is obtained if $R_{\text {sig }}=5 \mathrm{k} \Omega$ ?
Ans. $25 \Omega ; 200 \mathrm{~V} / \mathrm{V} ; 5 \mathrm{k} \Omega ; 100 \mathrm{~V} / \mathrm{V} ; 0.5 \mathrm{~V} / \mathrm{V}$
7.27 A CB amplifier is required to amplify a signal delivered by a coaxial cable having a characteristic resistance of $50 \Omega$. What bias current $I_{C}$ should be utilized to obtain $R_{i n}$ that is matched to the cable resistance? To obtain an overall voltage gain of $G_{v}$ of $40 \mathrm{~V} / \mathrm{V}$, what should the total resistance in the collector (i.e., $R_{C} \| R_{L}$ ) be?
Ans. $0.5 \mathrm{~mA} ; 4 \mathrm{k} \Omega$

### 7.3.6 The Source and Emitter Followers

The last of the basic transistor amplifier configurations is the common-drain (common-collector) amplifier, an important circuit that finds application in the design of both small-signal amplifiers and amplifiers that are required to handle large signals and deliver substantial amounts of signal power to a load. This latter variety will be studied in Chapter 12. The common-drain amplifier is more commonly known as the source follower, and the common-collector amplifier is more commonly known as the emitter follower. The reason behind these names will become apparent shortly.

The Need for Voltage Buffers Before embarking on the analysis of the source and the emitter followers, it is useful to look at one of their more common applications. Consider the situation depicted in Fig. 7.41(a). A signal source delivering a signal of reasonable strength ( 1 V ) with an internal resistance of $1 \mathrm{M} \Omega$ is to be connected to a $1-\mathrm{k} \Omega$ load resistance. Connecting the source to the load directly as in Fig. 7.41(b) would result in severe attenuation


Figure 7.41 Illustrating the need for a unity-gain voltage buffer amplifier.
of the signal; the signal appearing across the load will be only $1 /(1000+1)$ of the input signal, or about 1 mV . An alternative course of action is suggested in Fig. 7.41(c). Here we have interposed an amplifier between the source and the load. Our amplifier, however, is unlike the amplifiers we have been studying in this chapter thus far; it has a voltage gain of only unity. This is because our signal is already of sufficient strength and we do not need to increase its amplitude. Note, however, that our amplifier has a very high input resistance, thus almost all of $v_{\text {sig }}$ (i.e., 1 V ) will appear at the input of the amplifier proper. Since the amplifier has a low output resistance $(100 \Omega), 90 \%$ of this signal $(0.9 \mathrm{~V})$ will appear at the output, obviously a very significant improvement over the situation without the amplifier. As will be seen next, the source follower can easily implement the unity-gain buffer amplifier shown in Fig. 7.41(c).

Characteristic Parameters of the Source Follower Figure 7.42(a) shows a source follower with the bias circuit omitted. The source follower is fed with a signal generator ( $v_{\text {sig }}, R_{\text {sig }}$ ) and has a load resistance $R_{L}$ connected between the source terminal and ground. We shall assume that $R_{L}$ includes both the actual load and any other resistance that may be present between the source terminal and ground (e.g., for biasing purposes). Normally, the actual load resistance would be much lower in value than such other resistances and thus would dominate.

Since the MOSFET has a resistance $R_{L}$ connected in its source terminal, it is most convenient to use the T model, as shown in Fig. 7.40(b). From the latter circuit we can write by inspection

$$
R_{\mathrm{in}}=\infty
$$


Figure 7.42 (a) Common-drain amplifier or source follower with the bias circuit omitted. (b) Equivalent circuit of the source follower obtained by replacing the MOSFET with its T model.
and obtain $A_{v}$ from the voltage divider formed by $1 / g_{m}$ and $R_{L}$ as

$$
A_{v} \equiv \frac{v_{o}}{v_{i}}=\frac{R_{L}}{R_{L}+1 / g_{m}}
$$

Setting $R_{L}=\infty$ we obtain

$$
A_{v o}=1
$$

The output resistance $R_{o}$ is found by setting $v_{i}=0$ (i.e., by grounding the gate). Now looking back into the output terminal, excluding $R_{L}$, we simply see $1 / g_{m}$, thus

$$
R_{o}=1 / g_{m}
$$

The unity open-circuit voltage gain together with $R_{o}$ in Eq. (7.127) can be used to find $A_{v}$ when a load resistance $R_{L}$ is connected. The result is simply the expression in Eq. (7.125).
Finally, because of the infinite $R_{\text {in }}, v_{i}=v_{\text {sig }}$, and the overall voltage gain is

$$
G_{v}=A_{v}=\frac{R_{L}}{R_{L}+1 / g_{m}}
$$

Thus $G_{v}$ will be lower than unity. However, because $1 / g_{m}$ is usually low, the voltage gain can be close to unity. The unity open-circuit voltage gain in Eq. (7.126) indicates that the voltage at the source terminal will follow that at the input, hence the name source follower.

In conclusion, the source follower features a very high input resistance (ideally, infinite), a relatively low output resistance $\left(1 / g_{m}\right)$, and an open-circuit voltage gain that is near unity (ideally, unity). Thus the source follower is ideally suited for implementing the unity-gain voltage buffer of Fig. 7.41(c). The source follower is also used as the output (i.e., last) stage in a multistage amplifier, where its function is to equip the overall amplifier with a low output resistance, thus enabling it to supply relatively large load currents without loss of gain (i.e., with little reduction of output signal level). The design of output stages is studied in Chapter 12.

# EXERCISES 

D7.28 It is required to design a source follower that implements the buffer amplifier shown in Fig. 7.41(c). If the MOSFET is operated with an overdrive voltage $V_{O V}=0.25 \mathrm{~V}$, at what drain current should it be biased? Find the output signal amplitude and the signal amplitude between gate and source. Ans. $1.25 \mathrm{~mA} ; 0.91 \mathrm{~V} ; 91 \mathrm{mV}$
D7.29 A MOSFET is connected in the source-follower configuration and employed as the output stage of a cascade amplifier. It is required to provide an output resistance of $200 \Omega$. If the MOSFET has $k_{n}^{\prime}=0.4 \mathrm{~mA} / \mathrm{V}^{2}$ and is operated at $V_{O V}=0.25 \mathrm{~V}$, find the required $W / L$ ratio. Also specify the dc bias current $I_{D}$. If the amplifier load resistance varies over the range $1 \mathrm{k} \Omega$ to $10 \mathrm{k} \Omega$, what is the range of $G_{v}$ of the source follower?
Ans. 50; $0.625 \mathrm{~mA} ; 0.83 \mathrm{~V} / \mathrm{V}$ to $0.98 \mathrm{~V} / \mathrm{V}$

Characteristic Parameters of the Emitter Follower Although the emitter follower does not have an infinite input resistance (as in the case of the source follower), it is still widely used as a voltage buffer. In fact, it is a very versatile and popular circuit. We will therefore study it in some detail.

Figure 7.43(a) shows an emitter follower with the equivalent circuit shown in Fig. 7.43(b). The input resistance $R_{\text {in }}$ is found from

$$
R_{\text {in }}=\frac{v_{i}}{i_{b}}
$$

Substituting for $i_{b}=i_{e} /(\beta+1)$ where $i_{e}$ is given by

$$
i_{e}=\frac{v_{i}}{r_{e}+R_{L}}
$$


Figure 7.43 (a) Common-collector amplifier or emitter follower with the bias circuit omitted. (b) Equivalent circuit obtained by replacing the BJT with its T model.
we obtain

$$
R_{\mathrm{in}}=(\beta+1)\left(r_{e}+R_{L}\right)
$$

a result that we could have written directly, utilizing the resistance-reflection rule. Note that as expected the emitter follower takes the low load resistance and reflects it to the base side, where the signal source is, after increasing its value by a factor $(\beta+1)$. It is this impedance transformation property of the emitter follower that makes it useful in
connecting a low-resistance load to a high-resistance source, that is, to implement a buffer amplifier.

The voltage gain $A_{v}$ is given by

$$
A_{v} \equiv \frac{v_{o}}{v_{i}}=\frac{R_{L}}{R_{L}+r_{e}}
$$

Setting $R_{L}=\infty$ yields $A_{v o}$,

$$
A_{v o}=1
$$

Thus, as expected, the open-circuit voltage gain of the emitter follower proper is unity, which means that the signal voltage at the emitter follows that at the base, which is the origin of the name "emitter follower."

To determine $R_{o}$, refer to Fig. 7.43(b) and look back into the emitter (i.e., behind or excluding $R_{L}$ ) while setting $v_{i}=0$ (i.e., grounding the base). You will see $r_{e}$ of the BJT, thus

$$
R_{o}=r_{e}
$$

This result together with $A_{v o}=1$ yields $A_{v}$ in Eq. (7.130), thus confirming our earlier analysis.
We next determine the overall voltage gain $G_{v}$, as follows:

$$
\begin{aligned}
\frac{v_{i}}{v_{\text {sig }}} & =\frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}} \\
& =\frac{(\beta+1)\left(r_{e}+R_{L}\right)}{(\beta+1)\left(r_{e}+R_{L}\right)+R_{\text {sig }}} \\
G_{v} & \equiv \frac{v_{o}}{v_{\text {sig }}}=\frac{v_{i}}{v_{\text {sig }}} \times A_{v}
\end{aligned}
$$

Substituting for $A_{v}$ from Eq. (7.130) results in

$$
G_{v}=\frac{(\beta+1) R_{L}}{(\beta+1) R_{L}+(\beta+1) r_{e}+R_{\text {sig }}}
$$

This equation indicates that the overall gain, though lower than one, can be close to one if $(\beta+1) R_{L}$ is larger or comparable in value to $R_{\text {sig }}$. This again confirms the action of the emitter follower in delivering a large proportion of $v_{\text {sig }}$ to a low-valued load resistance $R_{L}$ even though $R_{\text {sig }}$ can be much larger than $R_{L}$. The key point is that $R_{L}$ is multiplied by $(\beta+1)$ before it is "presented to the source." Figure 7.44(a) shows an equivalent circuit of the emitter follower obtained by simply reflecting $r_{e}$ and $R_{L}$ to the base side. The overall voltage gain $G_{v} \equiv v_{o} / v_{\text {sig }}$ can be determined directly and very simply from this circuit by using the voltage divider rule. The result is the expression for $G_{v}$ already given in Eq. (7.133).

Dividing all resistances in the circuit of Fig. 7.44(a) by $\beta+1$ does not change the voltage ratio $v_{o} / v_{\text {sig }}$. Thus we obtain another equivalent circuit, shown in Fig. 7.44(b), that can be used to determine $G_{v} \equiv v_{o} / v_{\text {sig }}$ of the emitter follower. A glance at this circuit reveals that it is simply the equivalent circuit obtained by reflecting $v_{\text {sig }}$ and $R_{\text {sig }}$ from the base side to the emitter side. In this reflection, $v_{\text {sig }}$ does not change, but $R_{\text {sig }}$ is divided by $\beta+1$. Thus, we


Figure 7.44 Simple equivalent circuits for the emitter follower obtained by (a) reflecting $r_{e}$ and $R_{L}$ to the base side, and (b) reflecting $v_{\text {sig }}$ and $R_{\text {sig }}$ to the emitter side. Note that the circuit in (b) can be obtained from that in (a) by simply dividing all resistances by $(\beta+1)$.
either reflect to the base side and obtain the circuit in Fig. 7.44(a) or reflect to the emitter side and obtain the circuit in Fig. 7.44(b). From the latter, $G_{v}$ can be found as

$$
G_{v} \equiv \frac{v_{o}}{v_{\text {sig }}}=\frac{R_{L}}{R_{L}+r_{e}+R_{\text {sig }} /(\beta+1)}
$$

Observe that this expression is the same as that in Eq. (7.133) except for dividing both the numerator and denominator by $\beta+1$.

The expression for $G_{v}$ in Eq. (7.134) has an interesting interpretation: The emitter follower reduces $R_{\text {sig }}$ by the factor $(\beta+1)$ before "presenting it to the load resistance $R_{L}$ ": an impedance transformation that has the same buffering effect.

At this point it is important to note that although the emitter follower does not provide voltage gain it has a current gain of $\beta+1$.

Thévenin Representation of the Emitter-Follower Output A more general representation of the emitter-follower output is shown in Fig. 7.45(a). Here $G_{v o}$ is the overall open-circuit voltage gain that can be obtained by setting $R_{L}=\infty$ in the circuit of Fig. 7.44(b), as illustrated in Fig. 7.45(b). The result is $G_{v o}=1$. The output resistance $R_{\text {out }}$ is different from $R_{o}$. To determine $R_{\text {out }}$ we set $v_{\text {sig }}$ to zero (rather than setting $v_{i}$ to zero). Again we can use the equivalent circuit in Fig. 7.44(b) to do this, as illustrated in Fig. 7.45(c). We see that

$$
R_{\text {out }}=r_{e}+\frac{R_{\text {sig }}}{\beta+1}
$$

Finally, we show in Fig. 7.45(d) the emitter-follower circuit together with its $R_{\text {in }}$ and $R_{\text {out }}$. Observe that $R_{\text {in }}$ is determined by reflecting $r_{e}$ and $R_{L}$ to the base side (by multiplying their values by $\beta+1$ ). To determine $R_{\text {out }}$, grab hold of the emitter and walk (or just look!) backward while $v_{\text {sig }}=0$. You will see $r_{e}$ in series with $R_{\text {sig }}$, which because it is in the base must be divided by $(\beta+1)$.

We note that unlike the amplifier circuits we studied earlier, the emitter follower is not unilateral. This is manifested by the fact that $R_{\text {in }}$ depends on $R_{L}$ and $R_{\text {out }}$ depends on $R_{\text {sig }}$.


Figure 7.45 (a) Thévenin representation of the output of the emitter follower. (b) Obtaining $G_{\text {in }}$ from the equivalent circuit in Fig. 7.44(b). (c) Obtaining $R_{\text {out }}$ from the equivalent circuit in Fig. 7.44(b) with $v_{\text {sig }}$ set to zero. (d) The emitter follower with $R_{\text {in }}$ and $R_{\text {out }}$ determined simply by looking into the input and output terminals, respectively.

# Example 7.10 

It is required to design an emitter follower to implement the buffer amplifier of Fig. 7.46(a). Specify the required bias current $I_{E}$ and the minimum value the transistor $\beta$ must have. Determine the maximum allowed value of $v_{\text {sig }}$ if $v_{a}$ is to be limited to 5 mV in order to obtain reasonably linear operation. With $v_{\text {sig }}=200 \mathrm{mV}$, determine the signal voltage at the output if $R_{L}$ is changed to $2 \mathrm{k} \Omega$, and to $0.5 \mathrm{k} \Omega$.


Figure 7.46 Circuit for Example 7.10.
# Example 7.10 continued 


(b)

Figure 7.46 continued

## Solution

The emitter-follower circuit is shown in Fig. 7.46(b). To obtain $R_{o}=10 \Omega$, we bias the transistor to obtain $r_{e}=10 \Omega$. Thus,

$$
\begin{aligned}
10 \Omega & =\frac{V_{e}}{I_{E}} \\
I_{E} & =2.5 \mathrm{~mA}
\end{aligned}
$$

The input resistance $R_{\text {in }}$ will be

$$
\begin{aligned}
R_{\text {in }} & =(\beta+1)\left(r_{e}+R_{L}\right) \\
100 & =(\beta+1)(0.01+1)
\end{aligned}
$$

Thus, the BJT should have a $\beta$ with a minimum value of 98 . A higher $\beta$ would obviously be beneficial.
The overall voltage gain can be determined from

$$
G_{v} \equiv \frac{v_{o}}{v_{\text {sig }}}=\frac{R_{L}}{R_{L}+r_{e}+\frac{R_{\text {sig }}}{(\beta+1)}}
$$

Assuming $\beta=100$, the value of $G_{v}$ obtained is

$$
G_{v}=0.5
$$
Thus when $v_{\text {sig }}=200 \mathrm{mV}$, the signal at the output will be 100 mV . Since the 100 mV appears across the $1-\mathrm{k} \Omega$ load, the signal across the base-emitter junction can be found from

$$
\begin{aligned}
v_{\pi} & =\frac{v_{o}}{R_{L}} \times r_{e} \\
& =\frac{100}{1000} \times 10=1 \mathrm{mV}
\end{aligned}
$$

If $\hat{v}_{\pi}=5 \mathrm{mV}$ then $v_{\text {sig }}$ can be increased by a factor of 5 , resulting in $\hat{v}_{\text {sig }}=1 \mathrm{~V}$.
To obtain $v_{o}$ as the load is varied, we use the Thévenin equivalent of the emitter follower, shown in Fig. 7.45(a) with $G_{v o}=1$ and

$$
R_{\text {out }}=\frac{R_{\text {sig }}}{\beta+1}+r_{e}=\frac{100}{101}+0.01=1 \mathrm{k} \Omega
$$

to obtain

$$
v_{o}=v_{\text {sig }} \frac{R_{L}}{R_{L}+R_{\text {out }}}
$$

For $R_{L}=2 \mathrm{k} \Omega$,

$$
v_{o}=200 \mathrm{mV} \times \frac{2}{2+1}=133.3 \mathrm{mV}
$$

and for $R_{L}=0.5 \mathrm{k} \Omega$,

$$
v_{o}=200 \mathrm{mV} \times \frac{0.5}{0.5+1}=66.7 \mathrm{mV}
$$

# EXERCISE 

7.30 An emitter follower utilizes a transistor with $\beta=100$ and is biased at $I_{C}=5 \mathrm{~mA}$. It operates between a source having a resistance of $10 \mathrm{k} \Omega$ and a load of $1 \mathrm{k} \Omega$. Find $R_{\text {in }}, G_{v o}, R_{\text {out }}$, and $G_{v}$. What is the peak amplitude of $v_{\text {sig }}$ that results in $v_{\pi}$ having a peak amplitude of 5 mV ? Find the resulting peak amplitude at the output.
Ans. $101.5 \mathrm{k} \Omega ; 1 \mathrm{~V} / \mathrm{V} ; 104 \Omega ; 0.91 \mathrm{~V} / \mathrm{V} ; 1.1 \mathrm{~V} ; 1 \mathrm{~V}$# 7.3.7 Summary Tables and Comparisons 

For easy reference and to enable comparisons, we present in Tables 7.4 and 7.5 the formulas for determining the characteristic parameters for the various configurations of MOSFET and BJT amplifiers, respectively. In addition to the remarks made throughout this section about the characteristics and areas of applicability of the various configurations, we make the following concluding points:

1. MOS amplifiers provide much higher, ideally infinite input resistances (except, of course, for the CG configuration). This is a definite advantage over BJT amplifiers.
2. BJTs exhibit higher $g_{m}$ values than MOSFETs, resulting in higher gains.
3. For discrete-circuit amplifiers-that is, those that are assembled from discrete components on a printed-circuit board (PCB) —the BJT remains the device of choice. This is because discrete BJTs are much easier to handle physically than discrete MOSFETs and, more important, a very wide variety of discrete BJTs is available commercially. The remainder of this chapter is concerned with discrete-circuit amplifiers.
4. Integrated-circuit (IC) amplifiers predominantly use MOSFETs, although BJTs are utilized in certain niche areas. Chapters 8 to 13 are mainly concerned with IC amplifiers.
5. The CS and CE configurations are the best suited for realizing the bulk of the gain required in an amplifier. Depending on the magnitude of the gain required, either a single stage or a cascade of two or three stages can be used.
6. Including a resistance $R_{s}$ in the source of the CS amplifier (a resistance $R_{e}$ in the emitter of the CE amplifier) provides a number of performance improvements at the expense of gain reduction.

Table 7.4 Characteristics of MOSFET Amplifiers

| Amplifier type | Characteristics $^{\mathrm{a}}$ |  |  |  |  |
| :--: | :--: | :--: | :--: | :--: | :--: |
|  | $R_{\text {in }}$ | $A_{v o}$ | $R_{o}$ | $A_{v}$ | $G_{v}$ |
| Common source (Fig. 7.35) | $\infty$ | $-g_{m} R_{D}$ | $R_{D}$ | $-g_{m}\left(R_{D} \| R_{L}\right)$ | $-g_{m}\left(R_{D} \| R_{L}\right)$ |
| Common source with $R_{s}$ (Fig. 7.37) | $\infty$ | $-\frac{g_{m} R_{D}}{1+g_{m} R_{s}}$ | $R_{D}$ | $\begin{gathered} \frac{-g_{m}\left(R_{D} \| R_{L}\right)}{1+g_{m} R_{s}} \\ -\frac{R_{D} \| R_{L}}{1 / g_{m}+R_{s}} \end{gathered}$ | $\begin{gathered} -\frac{g_{m}\left(R_{D} \| R_{L}\right)}{1+g_{m} R_{s}} \\ -\frac{R_{D} \| R_{L}}{1 / g_{m}+R_{s}} \end{gathered}$ |
| Common gate (Fig. 7.39) | $\frac{1}{g_{m}}$ | $g_{m} R_{D}$ | $R_{D}$ | $g_{m}\left(R_{D} \| R_{L}\right)$ | $\frac{R_{D} \| R_{L}}{R_{o g}+1 / g_{m}}$ |
| Source follower (Fig. 7.42) | $\infty$ | 1 | $\frac{1}{g_{m}}$ | $\frac{R_{L}}{R_{L}+1 / g_{m}}$ | $\frac{R_{L}}{R_{L}+1 / g_{m}}$ |
| ${ }^{\text {a }}$ For the interpretation of $R_{\text {in }}, A_{v o}$, and $R_{o}$, refer to Fig. 7.34(b). |  |  |  |  |  |
Table 7.5 Characteristics of BJT Amplifiers ${ }^{\mathrm{a}, \mathrm{b}}$

|  | $R_{\text {in }}$ | $A_{v o}$ | $R_{o}$ | $A_{v}$ | $G_{v}$ |
| :--: | :--: | :--: | :--: | :--: | :--: |
| Common emitter <br> (Fig. 7.36) | $(\beta+1) r_{e}$ | $-g_{m} R_{C}$ | $R_{C}$ | $\begin{aligned} & -g_{m}\left(R_{C} \| R_{L}\right) \\ & -\alpha \frac{R_{C} \| R_{L}}{r_{e}} \end{aligned}$ | $-\beta \frac{R_{C} \| R_{L}}{R_{\text {sig }}+(\beta+1) r_{e}}$ |
| Common emitter with $R_{e}$ (Fig. 7.38) | $(\beta+1)\left(r_{e}+R_{e}\right)$ | $-\frac{g_{m} R_{C}}{1+g_{m} R_{e}}$ | $R_{C}$ | $\begin{aligned} & \frac{-g_{m}\left(R_{C} \| R_{L}\right)}{1+g_{m} R_{e}} \\ & -\alpha \frac{R_{C} \| R_{L}}{r_{e}+R_{e}} \end{aligned}$ | $-\beta \frac{R_{C} \| R_{L}}{R_{\text {sig }}+(\beta+1)\left(r_{e}+R_{e}\right)}$ |
| Common base <br> (Fig. 7.40) | $r_{e}$ | $g_{m} R_{C}$ | $R_{C}$ | $\begin{aligned} & g_{m}\left(R_{C} \| R_{L}\right) \\ & \alpha \frac{R_{C} \| R_{L}}{r_{e}} \end{aligned}$ | $\alpha \frac{R_{C} \| R_{L}}{R_{\text {sig }}+r_{e}}$ |
| Emitter <br> follower <br> (Fig. 7.43) | $(\beta+1)\left(r_{e}+R_{L}\right)$ | 1 | $r_{e}$ | $\frac{R_{L}}{R_{L}+r_{e}}$ | $\frac{R_{L}}{R_{L}+r_{e}+R_{\text {sig }} /(\beta+1)}$ <br> $G_{v, o}=1$ <br> $R_{\text {out }}=r_{e}+\frac{R_{\text {sig }}}{\beta+1}$ |

${ }^{\text {a }}$ For the interpretation of $R_{m}, A_{v o}$, and $R_{o}$ refer to Fig. 7.34.
${ }^{\mathrm{b}}$ Setting $\beta=\infty(\alpha=1)$ and replacing $r_{e}$ with $1 / g_{m}, R_{C}$ with $R_{D}$, and $R_{e}$ with $R_{s}$ results in the corresponding formulas for MOSFET amplifiers (Table 7.4).
7. The low input resistance of the CG and CB amplifiers makes them useful only in specific applications. As we shall see in Chapter 10, these two configurations exhibit a much better high-frequency response than that available from the CS and CE amplifiers. This makes them useful as high-frequency amplifiers, especially when combined with the CS or CE circuit. We shall study one such combination in Chapter 8.
8. The source follower (emitter follower) finds application as a voltage buffer for connecting a high-resistance source to a low-resistance load, and as the output stage in a multistage amplifier, where its purpose is to equip the amplifier with a low output resistance.

# 7.3.8 When and How to Include the Output Resistance $r_{0}$ 

So far we have been neglecting the output resistance $r_{o}$ of the MOSFET and the BJT. We have done this for two reasons:

1. To keep things simple and focus attention on the significant features of each of the basic configurations, and
2. Because our main interest in this chapter is discrete-circuit design, where the circuit resistances (e.g., $R_{C}, R_{D}$, and $R_{L}$ ) are usually much smaller than $r_{o}$.
## LEE DE FOREST-A FATHER OF THE ELECTRONICS AGE:

In 1906 self-employed inventor Lee de Forest (1873-1961) created a three-terminal vacuum tube; it was the first electronic amplifier of weak signals. The device was known initially as the de Forest valve. The patent filed in 1907, however, used the name Audion, with the "-ion" indicating that the device was not completely evacuated. By 1919, engineers had realized that complete evacuation of internal gases produced a more reliable device.

De Forest's first amplifier became known as the vacuum tube triode. Through its impact on radio, telephony, motion picture sound, and television, this invention, one of de Forest's 180 patents, is credited with introducing the electronics age. The vacuum tube, in a variety of types, remained the device for implementing amplifiers until the appearance of transistors in the early 1950s.

Nevertheless, in some instances it is relatively easy to include $r_{o}$ in the analysis. Specifically:

1. In the CS and CE amplifiers, it can be seen that $r_{o}$ of the transistor appears in parallel with $R_{D}$ and $R_{C}$, respectively, and can be simply included in the corresponding formulas in Tables 7.4 and 7.5 by replacing $R_{D}$ with $\left(R_{D} \| r_{o}\right)$ and $R_{C}$ with $\left(R_{C} \| r_{o}\right)$. The effect will be a reduction in the magnitude of gain, of perhaps $5 \%$ to $10 \%$.
2. In the source and emitter followers, it can be seen that the transistor $r_{o}$ appears in parallel with $R_{L}$ and can be taken into account by replacing $R_{L}$ in the corresponding formulas with $\left(R_{L} \| r_{o}\right)$. Thus, here too, the effect of taking $r_{o}$ into account is a small reduction in gain. More significant, however, taking $r_{o}$ into account reduces the open-circuit voltage gain $A_{v o}$ from unity to

$$
A_{v o}=\frac{r_{o}}{r_{o}+\left(1 / g_{m}\right)}
$$

There are configurations in which taking $r_{o}$ into account complicates the analysis considerably. These are the CS (CE) amplifiers with a source (emitter) resistance, and the CG (CB) amplifier. Fortunately, for discrete implementation of these configurations, the effect of neglecting $r_{o}$ is usually small (which can be verified by computer simulation).

Finally, a very important point: In the analysis and design of IC amplifiers, $r_{o}$ must always be taken into account. This is because, as will be seen in the next chapter, all the circuit resistances are of the same order of magnitude as $r_{o}$; thus, neglecting $r_{o}$ can result in completely erroneous results.

### 7.4 Biasing

As discussed in Section 7.1, an essential step in the design of a transistor amplifier is the establishment of an appropriate dc operating point for the transistor. This is the step known as biasing or bias design. In this section, we study the biasing methods commonly employed in discrete-circuit amplifiers. Biasing of integrated-circuit amplifiers will be studied in Chapter 8.

Bias design aims to establish in the drain (collector) a dc current that is predictable and insensitive to variations in temperature and to the large variations in parameter values between devices of the same type. For instance, discrete BJTs belonging to the same manufacturer's part number can exhibit $\beta$ values that range, say, from 50 to 150 . Nevertheless, the bias design
for an amplifier utilizing this particular transistor type may specify that the dc collector current shall always be within, say, $\pm 10 \%$ of the nominal value of, say, 1 mA . A similar statement can be made about the desired insensitivity of the dc drain current to the wide variations encountered in $V_{i}$ of discrete MOSFETs.

A second consideration in bias design is locating the dc operating point in the active region of operation of the transistor so as to obtain high voltage gain while allowing for the required output signal swing without the transistor leaving the active region at any time (in order to avoid nonlinear distortion). We discussed this point in Section 7.1.7.

Although we shall consider the biasing of MOSFET and BJT amplifiers separately, the resulting circuits are very similar. Also, it will be seen that good bias designs incorporate a feedback mechanism that works to keep the dc bias point as constant as possible.

In order to keep matters simple and thus focus our attention on significant issues, we will neglect the Early effect; that is assume $\lambda=0$ or $V_{A}=\infty$. This is certainly allowed in initial designs of discrete circuits. Of course, the design can be fine-tuned at a later point with the assistance of a circuit-simulation program such as SPICE.

# 7.4.1 The MOSFET Case 

Biasing by Fixing $V_{G S}$ The most straightforward approach to biasing a MOSFET is to fix its gate-to-source voltage $V_{G S}$ to the value required ${ }^{6}$ to provide the desired $I_{D}$. This voltage value can be derived from the power-supply voltage $V_{D D}$ through the use of an appropriate voltage divider, as shown in Fig. 7.47(a). Alternatively, it can be derived from another suitable reference voltage that might be available in the system. Independent of how the voltage $V_{G S}$ may be generated, this is not a good approach to biasing a MOSFET. To understand the reason for this statement, recall that

$$
I_{D}=\frac{1}{2} \mu_{n} C_{o s} \frac{W}{L}\left(V_{G S}-V_{i}\right)^{2}
$$

and note that the values of the threshold voltage $V_{i}$, the oxide-capacitance $C_{o s}$, and (to a lesser extent) the transistor aspect ratio $W / L$ vary widely among devices of supposedly the same size and type. This is certainly the case for discrete devices, in which large spreads in the values of these parameters occur among devices of the same manufacturer's part number. The spread can also be large in integrated circuits, especially among devices fabricated on different wafers and certainly between different batches of wafers. Furthermore, both $V_{i}$ and $\mu_{n}$ depend on temperature, with the result that if we fix the value of $V_{G S}$, the drain current $I_{D}$ becomes very much temperature dependent.

To emphasize the point that biasing by fixing $V_{G S}$ is not a good technique, we show in Fig. 7.47 two $i_{D}-v_{G S}$ characteristic curves representing extreme values in a batch of MOSFETs of the same type. Observe that for the fixed value of $V_{G S}$, the resultant spread in the values of the drain current can be substantial.

Biasing by Fixing $V_{G}$ and Connecting a Resistance in the Source An excellent biasing technique for discrete MOSFET circuits consists of fixing the dc voltage at the gate, $V_{G}$, and connecting a resistance in the source lead, as shown in Fig. 7.48(a). For this circuit

[^0]
[^0]:    ${ }^{6}$ That is indeed what we were doing in Section 7.1. However, the amplifier circuits studied there were conceptual ones, not actual practical circuits. Our purpose in this section is to study the latter.


Figure 7.47 (a) Biasing the MOSFET with a constant $V_{G S}$ generated from $V_{D D}$ using a voltage divider $\left(R_{G 1}, R_{G 2}\right) ;(\mathbf{b})$ the use of fixed bias (constant $V_{G S}$ ) can result in a large variability in the value of $I_{D}$. Devices 1 and 2 represent extremes among units of the same type.
we can write

$$
V_{G}=V_{G S}+R_{S} I_{D}
$$

Now, if $V_{G}$ is much greater than $V_{G S}, I_{D}$ will be mostly determined by the values of $V_{G}$ and $R_{S}$. However, even if $V_{G}$ is not much larger than $V_{G S}$, resistor $R_{S}$ provides negative feedback, which acts to stabilize the value of the bias current $I_{D}$. To see how this comes about, consider what happens when $I_{D}$ increases for whatever reason. Equation (7.137) indicates that since $V_{G}$ is constant, $V_{G S}$ will have to decrease. This in turn results in a decrease in $I_{D}$, a change that is opposite to that initially assumed. Thus the action of $R_{S}$ works to keep $I_{D}$ as constant as possible. ${ }^{7}$

Figure 7.48(b) provides a graphical illustration of the effectiveness of this biasing scheme. Here too we show the $i_{D}-v_{G S}$ characteristics for two devices that represent the extremes of a batch of MOSFETs. Superimposed on the device characteristics is a straight line that represents the constraint imposed by the bias circuit—namely, Eq. (7.137). The intersection of this straight line with the $i_{D}-v_{G S}$ characteristic curve provides the coordinates ( $I_{D}$ and $V_{G S}$ ) of the bias point. Observe that compared to the case of fixed $V_{G S}$, here the variability obtained in $I_{D}$ is much smaller. Also, note that the variability decreases as $V_{G}$ and $R_{S}$ are made larger (thus providing a bias line that is less steep).

Two possible practical discrete implementations of this bias scheme are shown in Fig. 7.48(c) and (e). The circuit in Fig. 7.48(c) utilizes one power-supply $V_{D D}$ and derives $V_{G}$

[^0]
[^0]:    ${ }^{7}$ The action of $R_{S}$ in stabilizing the value of the bias current $I_{D}$ is not unlike that of the resistance $R_{s}$, which we included in the source lead of a CS amplifier in Section 7.3.4. In the latter case also, $R_{s}$ works to reduce the change in $i_{D}$ with the result that the amplifier gain is reduced.


Figure 7.48 Biasing using a fixed voltage at the gate, $V_{G}$, and a resistance in the source lead, $R_{S}$ : (a) basic arrangement; (b) reduced variability in $I_{D}$; (c) practical implementation using a single supply; (d) coupling of a signal source to the gate using a capacitor $C_{C 1}$; (e) practical implementation using two supplies.
through a voltage divider $\left(R_{G 1}, R_{G 2}\right)$. Since $I_{G}=0, R_{G 1}$ and $R_{G 2}$ can be selected to be very large (in the megohm range), allowing the MOSFET to present a large input resistance to a signal source that may be connected to the gate through a coupling capacitor, as shown in Fig. 7.48(d). Here capacitor $C_{C 1}$ blocks dc and thus allows us to couple the signal $v_{\text {sig }}$ to the amplifier input without disturbing the MOSFET dc bias point. The value of $C_{C 1}$ should be selected large enough to approximate a short circuit at all signal frequencies of interest. We shall study capacitively coupled MOSFET amplifiers, which are suitable only in discrete-circuit design, in Section 7.5. Finally, note that in the circuit of Fig. 7.48(c), resistor $R_{D}$ is selected to be as large as possible to obtain high gain but small enough to allow for the desired signal swing at the drain while keeping the MOSFET in saturation at all times.

When two power supplies are available, as is often the case, the somewhat simpler bias arrangement of Fig. 7.48(e) can be utilized. This circuit is an implementation of Eq. (7.137), with $V_{G}$ replaced by $V_{S S}$. Resistor $R_{G}$ establishes a dc ground at the gate and presents a high input resistance to a signal source that may be connected to the gate through a coupling capacitor.
# Example 7.11 

It is required to design the circuit of Fig. 7.48(c) to establish a dc drain current $I_{D}=0.5 \mathrm{~mA}$. The MOSFET is specified to have $V_{i}=1 \mathrm{~V}$ and $k_{n}^{\prime} W / L=1 \mathrm{~mA} / \mathrm{V}^{2}$. For simplicity, neglect the channel-length modulation effect (i.e., assume $\lambda=0$ ). Use a power-supply $V_{D D}=15 \mathrm{~V}$. Calculate the percentage change in the value of $I_{D}$ obtained when the MOSFET is replaced with another unit having the same $k_{n}^{\prime} W / L$ but $V_{i}=1.5 \mathrm{~V}$.

## Solution

As a rule of thumb for designing this classical biasing circuit, we choose $R_{D}$ and $R_{S}$ to provide one-third of the power-supply voltage $V_{D D}$ as a drop across each of $R_{D}$, the transistor (i.e., $V_{D S}$ ), and $R_{S}$. For $V_{D D}=15 \mathrm{~V}$, this choice makes $V_{D}=+10 \mathrm{~V}$ and $V_{S}=+5 \mathrm{~V}$. Now, since $I_{D}$ is required to be 0.5 mA , we can find the values of $R_{D}$ and $R_{S}$ as follows:

$$
\begin{aligned}
& R_{D}=\frac{V_{D D}-V_{D}}{I_{D}}=\frac{15-10}{0.5}=10 \mathrm{k} \Omega \\
& R_{S}=\frac{V_{S}}{R_{S}}=\frac{5}{0.5}=10 \mathrm{k} \Omega
\end{aligned}
$$

The required value of $V_{G S}$ can be determined by first calculating the overdrive voltage $V_{O V}$ from

$$
\begin{aligned}
I_{D} & =\frac{1}{2} k_{n}^{\prime}(W / L) V_{O V}^{2} \\
0.5 & =\frac{1}{2} \times 1 \times V_{O V}^{2}
\end{aligned}
$$

which yields $V_{O V}=1 \mathrm{~V}$, and thus,

$$
V_{G S}=V_{i}+V_{O V}=1+1=2 \mathrm{~V}
$$

Now, since $V_{S}=+5 \mathrm{~V}, V_{G}$ must be

$$
V_{G}=V_{S}+V_{G S}=5+2=7 \mathrm{~V}
$$

To establish this voltage at the gate we may select $R_{G 1}=8 \mathrm{M} \Omega$ and $R_{G 2}=7 \mathrm{M} \Omega$. The final circuit is shown in Fig. 7.49. Observe that the dc voltage at the drain $(+10 \mathrm{~V})$ allows for a positive signal swing of +5 V (i.e., up to $V_{D D}$ ) and a negative signal swing of 4 V [i.e., down to $\left(V_{G}-V_{i}\right)$ ].

If the NMOS transistor is replaced with another having $V_{i}=1.5 \mathrm{~V}$, the new value of $I_{D}$ can be found as follows:

$$
\begin{aligned}
I_{D} & =\frac{1}{2} \times 1 \times\left(V_{G S}-1.5\right)^{2} \\
V_{G} & =V_{G S}+I_{D} R_{S} \\
7 & =V_{G S}+10 I_{D}
\end{aligned}
$$


Figure 7.49 Circuit for Example 7.11.

Solving Eqs. (7.138) and (7.139) together yields

$$
I_{D}=0.455 \mathrm{~mA}
$$

Thus the change in $I_{D}$ is

$$
\Delta I_{D}=0.455-0.5=-0.045 \mathrm{~mA}
$$

which is $\frac{-0.045}{0.5} \times 100=-9 \%$ change.

# EXERCISES 

7.31 Consider the MOSFET in Example 7.11 when fixed- $V_{G S}$ bias is used. Find the required value of $V_{G S}$ to establish a dc bias current $I_{D}=0.5 \mathrm{~mA}$. Recall that the device parameters are $V_{i}=1 \mathrm{~V}, k_{e}^{\prime} W / L=$ $1 \mathrm{~mA} / \mathrm{V}^{2}$, and $\lambda=0$. What is the percentage change in $I_{D}$ obtained when the transistor is replaced with another having $V_{i}=1.5 \mathrm{~V}$ ?
Ans. $V_{G S}=2 \mathrm{~V} ;-75 \%$
D7.32 Design the circuit of Fig. 7.48(e) to operate at a dc drain current of 0.5 mA and $V_{D}=+2 \mathrm{~V}$. Let $V_{i}=$ $1 \mathrm{~V}, k_{e}^{\prime} W / L=1 \mathrm{~mA} / \mathrm{V}^{2}, \lambda=0, V_{D D}=V_{S S}=5 \mathrm{~V}$. Use standard $5 \%$ resistor values (see Appendix J), and give the resulting values of $I_{D}, V_{D}$, and $V_{S}$.
Ans. $R_{D}=R_{S}=6.2 \mathrm{k} \Omega ; I_{D}=0.49 \mathrm{~mA}, V_{S}=-1.96 \mathrm{~V}$, and $V_{D}=+1.96 \mathrm{~V} . R_{G}$ can be selected in the range of $1 \mathrm{M} \Omega$ to $10 \mathrm{M} \Omega$.


Figure 7.50 Biasing the MOSFET using a large drain-to-gate feedback resistance, $R_{G}$.

Biasing Using a Drain-to-Gate Feedback Resistor A simple and effective discretecircuit biasing arrangement utilizing a feedback resistor connected between the drain and the gate is shown in Fig. 7.50. Here the large feedback resistance $R_{G}$ (usually in the megohm range) forces the dc voltage at the gate to be equal to that at the drain (because $I_{G}=0$ ). Thus we can write

$$
V_{G S}=V_{D S}=V_{D D}-R_{D} I_{D}
$$

which can be rewritten in the form

$$
V_{D D}=V_{G S}+R_{D} I_{D}
$$

which is identical in form to Eq. (7.137), which describes the operation of the bias scheme discussed above [that in Fig. 7.48(a)]. Thus, here too, if $I_{D}$ for some reason changes, say increases, then Eq. (7.140) indicates that $V_{G S}$ must decrease. The decrease in $V_{G S}$ in turn causes a decrease in $I_{D}$, a change that is opposite in direction to the one originally assumed. Thus the negative feedback or degeneration provided by $R_{G}$ works to keep the value of $I_{D}$ as constant as possible.

The circuit of Fig. 7.50 can be utilized as an amplifier by applying the input voltage signal to the gate via a coupling capacitor so as not to disturb the dc bias conditions already established. The amplified output signal at the drain can be coupled to another part of the circuit, again via a capacitor. We considered such an amplifier circuit in Section 7.2 (Example 7.3).

# EXERCISE 

D7.33 Design the circuit in Fig. 7.50 to operate at a dc drain current of 0.5 mA . Assume $V_{D D}=+5 \mathrm{~V}$, $k_{n}^{\prime} W / L=1 \mathrm{~mA} / \mathrm{V}^{2}, V_{i}=1 \mathrm{~V}$, and $\lambda=0$. Use a standard $5 \%$ resistance value for $R_{D}$, and give the actual values obtained for $I_{D}$ and $V_{D}$.
Ans. $R_{D}=6.2 \mathrm{k} \Omega ; I_{D} \simeq 0.49 \mathrm{~mA} ; V_{D} \simeq 1.96 \mathrm{~V}$


Figure 7.51 Two obvious schemes for biasing the BJT: (a) by fixing $V_{B E}$; (b) by fixing $I_{B}$. Both result in wide variations in $I_{C}$ and hence in $V_{C E}$ and therefore are considered to be "bad." Neither scheme is recommended.

# 7.4.2 The BJT Case 

Before presenting the "good" biasing schemes, we should point out why two obvious arrangements are not good. First, attempting to bias the BJT by fixing the voltage $V_{B E}$ by, for instance, using a voltage divider across the power supply $V_{C C}$, as shown in Fig. 7.51(a), is not a viable approach: The very sharp exponential relationship $i_{C}-v_{B E}$ means that any small and inevitable differences in $V_{B E}$ from the desired value will result in large differences in $I_{C}$ and in $V_{C E}$. Second, biasing the BJT by establishing a constant current in the base, as shown in Fig. 7.51(b), where $I_{B} \simeq\left(V_{C C}-0.7\right) / R_{B}$, is also not a recommended approach. Here the typically large variations in the value of $\beta$ among units of the same device type will result in correspondingly large variations in $I_{C}$ and hence in $V_{C E}$.

The Classical Discrete-Circuit Bias Arrangement Figure 7.52(a) shows the arrangement most commonly used for biasing a discrete-circuit transistor amplifier if only a single power supply is available. The technique consists of supplying the base of the transistor with a fraction of the supply voltage $V_{C C}$ through the voltage divider $R_{1}, R_{2}$. In addition, a resistor $R_{E}$ is connected to the emitter. This circuit is very similar to one we used for the MOSFET [Fig. 7.48(c)]. Here, however, the design must take into account the finite base current.

Figure 7.52(b) shows the same circuit with the voltage-divider network replaced by its Thévenin equivalent,

$$
\begin{gathered}
V_{B B}=\frac{R_{2}}{R_{1}+R_{2}} V_{C C} \\
R_{B}=\frac{R_{1} R_{2}}{R_{1}+R_{2}}
\end{gathered}
$$

The current $I_{E}$ can be determined by writing a Kirchhoff loop equation for the base-emitterground loop, labeled L, and substituting $I_{B}=I_{E} /(\beta+1)$ :

$$
I_{E}=\frac{V_{B B}-V_{B E}}{R_{E}+R_{B} /(\beta+1)}
$$

Figure 7.52 Classical biasing for BJTs using a single power supply: (a) circuit; (b) circuit with the voltage divider supplying the base replaced with its Thévenin equivalent.

To make $I_{E}$ insensitive to temperature and $\beta$ variation, ${ }^{8}$ we design the circuit to satisfy the following two constraints:

$$
\begin{aligned}
V_{B B} & \gg V_{B E} \\
R_{E} & \gg \frac{R_{B}}{\beta+1}
\end{aligned}
$$

Condition (7.144) ensures that small variations in $V_{B E}(\simeq 0.7 \mathrm{~V})$ will be swamped by the much larger $V_{B B}$. There is a limit, however, on how large $V_{B B}$ can be: For a given value of the supply voltage $V_{C C}$, the higher the value we use for $V_{B B}$, the lower will be the sum of voltages across $R_{C}$ and the collector-base junction $\left(V_{C B}\right)$. On the other hand, we want the voltage across $R_{C}$ to be large in order to obtain high voltage gain and large signal swing (before transistor cutoff). We also want $V_{C B}$ (or $V_{C E}$ ) to be large, to provide a large signal swing (before transistor saturation). Thus, as is the case in any design, we have a set of conflicting requirements, and the solution must be a trade-off. As a rule of thumb, one designs for $V_{B B}$ about $\frac{1}{3} V_{C C}, V_{C B}$ (or $V_{C E}$ ) about $\frac{1}{3} V_{C C}$, and $I_{C} R_{C}$ about $\frac{1}{3} V_{C C}$.

Condition (7.145) makes $I_{E}$ insensitive to variations in $\beta$ and could be satisfied by selecting $R_{B}$ small. This in turn is achieved by using low values for $R_{1}$ and $R_{2}$. Lower values for $R_{1}$ and $R_{2}$, however, will mean a higher current drain from the power supply, and will result in a lowering of the input resistance of the amplifier (if the input signal is coupled to the base), ${ }^{9}$ which is the trade-off involved in this part of the design. It should be noted that condition (7.145) means that we want to make the base voltage independent of the value of $\beta$ and determined solely by the voltage divider. This will obviously be satisfied if the current in the divider is made much larger than the base current. Typically one selects $R_{1}$ and $R_{2}$ such that their current is in the range of $I_{E}$ to $0.1 I_{E}$.

Further insight regarding the mechanism by which the bias arrangement of Fig. 7.52(a) stabilizes the dc emitter (and hence collector) current is obtained by considering the feedback

[^0]
[^0]:    ${ }^{8}$ Bias design seeks to stabilize either $I_{E}$ or $I_{C}$ since $I_{C}=\alpha I_{E}$ and $\alpha$ varies very little. That is, a stable $I_{E}$ will result in an equally stable $I_{C}$, and vice versa.
    ${ }^{9}$ If the input signal is coupled to the transistor base, the two bias resistances $R_{1}$ and $R_{2}$ effectively appear in parallel between the base and ground. Thus, low values for $R_{1}$ and $R_{2}$ will result in lowering $R_{\mathrm{in}}$.
action provided by $R_{E}$. Consider that for some reason the emitter current increases. The voltage drop across $R_{E}$, and hence $V_{E}$, will increase correspondingly. Now, if the base voltage is determined primarily by the voltage divider $R_{1}, R_{2}$, which is the case if $R_{B}$ is small, it will remain constant, and the increase in $V_{E}$ will result in a corresponding decrease in $V_{B E}$. This in turn reduces the collector (and emitter) current, a change opposite to that originally assumed. Thus $R_{E}$ provides a negative feedback action that stabilizes the bias current. This should remind the reader of the resistance $R_{e}$ that we included in the emitter lead of the CE amplifier in Section 7.3.4. Also, the feedback action of $R_{E}$ in the circuit of Fig. 7.52(a) is similar to the feedback action of $R_{S}$ in the circuit of Fig. 7.48(c). We shall study negative feedback formally in Chapter 11.

# Example 7.12 

We wish to design the bias network of the amplifier in Fig. 7.52 to establish a current $I_{E}=1 \mathrm{~mA}$ using a power supply $V_{C C}=+12 \mathrm{~V}$. The transistor is specified to have a nominal $\beta$ value of 100 .

## Solution

We shall follow the rule of thumb mentioned above and allocate one-third of the supply voltage to the voltage drop across $R_{2}$ and another one-third to the voltage drop across $R_{C}$, leaving one-third for possible negative signal swing at the collector. Thus,

$$
\begin{aligned}
& V_{R}=+4 \mathrm{~V} \\
& V_{E}=4-V_{B E} \simeq 3.3 \mathrm{~V}
\end{aligned}
$$

and $R_{E}$ is determined from

$$
R_{E}=\frac{V_{E}}{I_{E}}=\frac{3.3}{1}=3.3 \mathrm{k} \Omega
$$

From the discussion above we select a voltage-divider current of $0.1 I_{E}=0.1 \times 1=0.1 \mathrm{~mA}$. Neglecting the base current, we find

$$
R_{1}+R_{2}=\frac{12}{0.1}=120 \mathrm{k} \Omega
$$

and

$$
\frac{R_{2}}{R_{1}+R_{2}} V_{C C}=4 \mathrm{~V}
$$

Thus $R_{2}=40 \mathrm{k} \Omega$ and $R_{1}=80 \mathrm{k} \Omega$.
At this point, it is desirable to find a more accurate estimate for $I_{E}$, taking into account the nonzero base current. Using Eq. (7.143),

$$
I_{E}=\frac{4-0.7}{3.3(\mathrm{k} \Omega)+\frac{(80\|40)(\mathrm{k} \Omega)}{101}}=0.93 \mathrm{~mA}
$$
# Example 7.12 continued 

This is quite a bit lower than 1 mA , the value we are aiming for. It is easy to see from the above equation that a simple way to restore $I_{E}$ to its nominal value would be to reduce $R_{E}$ from $3.3 \mathrm{k} \Omega$ by the magnitude of the second term in the denominator $(0.267 \mathrm{k} \Omega)$. Thus a more suitable value for $R_{E}$ in this case would be $R_{E}=3 \mathrm{k} \Omega$, which results in $I_{E}=1.01 \mathrm{~mA} \simeq 1 \mathrm{~mA} .^{10}$

It should be noted that if we are willing to draw a higher current from the power supply and to accept a lower input resistance for the amplifier, then we may use a voltage-divider current equal, say, to $I_{E}$ (i.e., 1 mA ), resulting in $R_{1}=8 \mathrm{k} \Omega$ and $R_{2}=4 \mathrm{k} \Omega$. We shall refer to the circuit using these latter values as design 2 , for which the actual value of $I_{E}$ using the initial value of $R_{E}$ of $3.3 \mathrm{k} \Omega$ will be

$$
I_{E}=\frac{4-0.7}{3.3+0.027}=0.99 \simeq 1 \mathrm{~mA}
$$

In this case, design 2, we need not change the value of $R_{E}$.
Finally, the value of $R_{C}$ can be determined from

$$
R_{C}=\frac{12-V_{C}}{I_{C}}
$$

Substituting $I_{C}=\alpha I_{E}=0.99 \times 1=0.99 \mathrm{~mA} \simeq 1 \mathrm{~mA}$ results, for both designs, in

$$
R_{C}=\frac{12-8}{1}=4 \mathrm{k} \Omega
$$

## EXERCISE

7.34 For design 1 in Example 7.12, calculate the expected range of $I_{E}$ if the transistor used has $\beta$ in the range of 50 to 150 . Express the range of $I_{E}$ as a percentage of the nominal value $\left(I_{E} \simeq 1 \mathrm{~mA}\right)$ obtained for $\beta=100$. Repeat for design 2 .
Ans. For design 1: 0.94 mA to 1.04 mA , a $10 \%$ range; for design 2: 0.984 mA to 0.995 mA , a $1.1 \%$ range.

A Two-Power-Supply Version of the Classical Bias Arrangement A somewhat simpler bias arrangement is possible if two power supplies are available, as shown in Fig. 7.53.

[^0]
[^0]:    ${ }^{10}$ Although reducing $R_{E}$ restores $I_{E}$ to the design value of 1 mA , it does not solve the problem of the dependence of the value of $I_{E}$ on $\beta$. See Exercise 7.34.


Figure 7.53 Biasing the BJT using two power supplies. Resistor $R_{R}$ is needed only if the signal is to be capacitively coupled to the base. Otherwise, the base can be connected directly to ground, or to a grounded signal source, resulting in almost total $\beta$-independence of the bias current.

Writing a loop equation for the loop labeled L gives

$$
I_{E}=\frac{V_{E E}-V_{B E}}{R_{E}+R_{B} /(\beta+1)}
$$

This equation is identical to Eq. (7.143) except for $V_{E E}$ replacing $V_{B B}$. Thus the two constraints of Eqs. (7.144) and (7.145) apply here as well. Note that if the transistor is to be used with the base grounded (i.e., in the common-base configuration), then $R_{B}$ can be eliminated altogether. On the other hand, if the input signal is to be coupled to the base, then $R_{B}$ is needed. We shall study complete circuits of the various BJT amplifier configurations in Section 7.5. Finally, observe that the circuit in Fig. 7.53 is the counterpart of the MOS circuit in Fig. 7.48(e).

# EXERCISE 

D7.35 The bias arrangement of Fig. 7.53 is to be used for a common-base amplifier. Design the circuit to establish a dc emitter current of 1 mA and provide the highest possible voltage gain while allowing for a signal swing at the collector of $\pm 2 \mathrm{~V}$. Use $+10-\mathrm{V}$ and $-5-\mathrm{V}$ power supplies. Ans. $R_{B}=0 ; R_{E}=4.3 \mathrm{k} \Omega ; R_{C}=8.4 \mathrm{k} \Omega$

Biasing Using a Collector-to-Base Feedback Resistor In the BJT case, there is a counterpart to the MOSFET circuit of Fig. 7.50. Figure 7.54(a) shows such a simple but effective biasing arrangement that is suitable for common-emitter amplifiers. The circuit employs a resistor $R_{B}$ connected between the collector and the base. Resistor $R_{B}$ provides negative feedback, which helps to stabilize the bias point of the BJT.


Figure 7.54 (a) A common-emitter transistor amplifier biased by a feedback resistor $R_{B}$. (b) Analysis of the circuit in (a).

Analysis of the circuit is shown in Fig. 7.54(b), from which we can write

$$
\begin{aligned}
V_{C C} & =I_{E} R_{C}+I_{B} R_{B}+V_{B E} \\
& =I_{E} R_{C}+\frac{I_{E}}{\beta+1} R_{B}+V_{B E}
\end{aligned}
$$

Thus the emitter bias current is given by

$$
I_{E}=\frac{V_{C C}-V_{B E}}{R_{C}+R_{B} /(\beta+1)}
$$

It is interesting to note that this equation is identical to Eq. (7.143), which governs the operation of the traditional bias circuit, except that $V_{C C}$ replaces $V_{B B}$ and $R_{C}$ replaces $R_{E}$. It follows that to obtain a value of $I_{E}$ that is insensitive to variation of $\beta$, we select $R_{B} /(\beta+1) \ll R_{C}$. Note, however, that the value of $R_{B}$ determines the allowable negative signal swing at the collector since

$$
V_{C B}=I_{B} R_{B}=I_{E} \frac{R_{B}}{\beta+1}
$$

# EXERCISE 

D7.36 Design the circuit of Fig. 7.54 to obtain a dc emitter current of 1 mA , maximum gain, and a $\pm 2-\mathrm{V}$ signal swing at the collector; that is, design for $V_{C E}=+2.3 \mathrm{~V}$. Let $V_{C C}=10 \mathrm{~V}$ and $\beta=100$. Ans. $R_{B}=162 \mathrm{k} \Omega ; R_{C}=7.7 \mathrm{k} \Omega$. Note that if standard $5 \%$ resistor values are used (Appendix J), we select $R_{B}=160 \mathrm{k} \Omega$ and $R_{C}=7.5 \mathrm{k} \Omega$. This results in $I_{E}=1.02 \mathrm{~mA}$ and $V_{C}=+2.3 \mathrm{~V}$.
# 7.5 Discrete-Circuit Amplifiers 

With our study of transistor amplifier basics complete, we now put everything together by presenting practical circuits for discrete-circuit amplifiers. These circuits, which utilize the amplifier configurations studied in Section 7.3 and the biasing methods of Section 7.4, can be assembled using off-the-shelf discrete transistors, resistors, and capacitors. Though practical and carefully selected to illustrate some important points, the circuits presented in this section should be regarded as examples of discrete-circuit transistor amplifiers. Indeed, there is a great variety of such circuits, a number of which are explored in the end-of-chapter problems.

As mentioned earlier, the vast majority of discrete-circuit amplifiers utilize BJTs. This is reflected in this section where all the circuits presented except for one utilize BJTs. Of course, if desired, one can utilize MOSFETs in the same amplifier configurations presented here. Also, the MOSFET is the device of choice in the design of integrated-circuit (IC) amplifiers. We begin our study of IC amplifiers in Chapter 8.

As will be seen shortly, the circuits presented in this section utilize large capacitors (in the $\mu \mathrm{F}$ range) to couple the signal source to the input of the amplifier, and to couple the amplifier output signal to a load resistance or to the input of another amplifier stage. As well, a large capacitor is employed to establish a signal ground at the desired terminal of the transistor (e.g., at the emitter of a CE amplifier). The use of capacitors for these purposes simplifies the design considerably: Since capacitors block dc, one is able to first carry out the dc bias design and then connect the signal source and load to the amplifier without disturbing the dc design. There amplifiers are therefore known as capacitively coupled amplifiers.

### 7.5.1 A Common-Source (CS) Amplifier

As mentioned in Section 7.3, the common-source (CS) configuration is the most widely used of all MOSFET amplifier circuits. A common-source amplifier realized using the bias circuit of Fig. 7.48(c) is shown in Fig. 7.55(a). Observe that to establish a signal ground, or an ac ground as it is sometimes called, at the source, we have connected a large capacitor, $C_{S}$, between the source and ground. This capacitor, usually in the microfarad range, is required to provide a very small impedance (ideally, zero impedance-i.e., in effect, a short circuit) at all signal frequencies of interest. In this way, the signal current passes through $C_{S}$ to ground and thus bypasses the resistance $R_{S}$; hence, $C_{S}$ is called a bypass capacitor. Obviously, the lower the signal frequency, the less effective the bypass capacitor becomes. This issue will be studied in Section 10.1. For our purposes here we shall assume that $C_{S}$ is acting as a perfect short circuit and thus is establishing a zero signal voltage at the MOSFET source.

To prevent disturbances to the dc bias current and voltages, the signal to be amplified, shown as voltage source $v_{\text {sig }}$ with an internal resistance $R_{\text {sig }}$, is connected to the gate through a large capacitor $C_{C 1}$. Capacitor $C_{C 1}$, known as a coupling capacitor, is required to act as a perfect short circuit at all signal frequencies of interest while blocking dc. Here again, we note that as the signal frequency is lowered, the impedance of $C_{C 1}$ (i.e., $1 / j \omega C_{C 1}$ ) will increase and its effectiveness as a coupling capacitor will be correspondingly reduced. This problem, too, will be considered in Section 10.1 in connection with the dependence of the amplifier


Figure 7.55 (a) A common-source amplifier using the classical biasing arrangement of Fig. 7.48(c). (b) Circuit for determining the bias point. (c) Equivalent circuit and analysis.
operation on frequency. For our purposes here we shall assume that $C_{C 1}$ is acting as a perfect short circuit as far as the signal is concerned.

The voltage signal resulting at the drain is coupled to the load resistance $R_{L}$ via another coupling capacitor $C_{C 2}$. We shall assume that $C_{C 2}$ acts as a perfect short circuit at all signal frequencies of interest and thus that the output voltage $v_{o}=v_{d}$. Note that $R_{L}$ can be either an actual load resistor, to which the amplifier is required to provide its output voltage signal, or it can be the input resistance of another amplifier stage in cases where more than one stage of amplification is needed. (We will study multistage amplifiers in Chapter 9).

Since a capacitor behaves as an open circuit at dc, the circuit for performing the dc bias design and analysis is obtained by open-circuiting all capacitors. The resulting circuit is shown in Fig. 7.55(b) and can be designed as discussed in Section 7.4.1.
To determine the terminal characteristics of the CS amplifier of Fig. 7.55(a)—that is, its input resistance, voltage gain, and output resistance-we replace the MOSFET with its hybrid- $\pi$ small-signal model, replace $V_{D D}$ with a signal ground, and replace all coupling and bypass capacitors with short circuits. The result is the circuit in Fig. 7.55(c). Analysis is straightforward and is shown on the figure, thus

$$
R_{\mathrm{in}}=R_{G 1} \| R_{G 2}
$$

which shows that to keep $R_{\text {in }}$ high, large values should be used for $R_{G 1}$ and $R_{G 2}$, usually in the megohm range. The overall voltage gain $G_{v}$ is

$$
G_{v}=-\frac{R_{\mathrm{in}}}{R_{\mathrm{in}}+R_{\mathrm{sig}}} g_{m}\left(R_{D} \| R_{L} \| r_{o}\right)
$$

Observe that we have taken $r_{o}$ into account, simply because it is easy to do so. Its effect, however, is usually small (this is not the case for IC amplifiers, as will be explained in Chapter 8). Finally, to encourage the reader to do the small-signal analysis directly on the original circuit diagram, with the MOSFET model used implicitly, we show some of the analysis on the circuit of Fig. 7.55(a).

# EXERCISES 

D7.37 Design the bias circuit in Fig.7.55(b) for the CS amplifier of Fig. 7.55(a). Assume the MOSFET is specified to have $V_{i}=1 \mathrm{~V}, k_{\mathrm{n}}=4 \mathrm{~mA} / \mathrm{V}^{2}$, and $V_{A}=100 \mathrm{~V}$. Neglecting the Early effect, design for $I_{D}=0.5 \mathrm{~mA}, V_{S}=3.5 \mathrm{~V}$, and $V_{D}=6 \mathrm{~V}$ using a power-supply $V_{D D}=15 \mathrm{~V}$. Specify the values of $R_{S}$ and $R_{D}$. If a current of $2 \mu \mathrm{~A}$ is used in the voltage divider, specify the values of $R_{G 1}$ and $R_{G 2}$. Give the values of the MOSFET parameters $g_{m}$ and $r_{o}$ at the bias point.
Ans. $R_{S}=7 \mathrm{k} \Omega ; R_{D}=18 \mathrm{k} \Omega ; R_{G 1}=5 \mathrm{M} \Omega ; R_{G 2}=2.5 \mathrm{M} \Omega ; g_{m}=2 \mathrm{~mA} / \mathrm{V} ; r_{o}=200 \mathrm{k} \Omega$
7.38 For the CS amplifier of Fig. 7.55(a) use the design obtained in Exercise 7.37 to determine $R_{\mathrm{in}}, R_{o}$, and the overall voltage gain $G_{v}$ when $R_{\text {sig }}=100 \mathrm{k} \Omega$ and $R_{L}=20 \mathrm{k} \Omega$.
Ans. $1.67 \mathrm{M} \Omega ; 16.5 \mathrm{k} \Omega ;-17.1 \mathrm{~V} / \mathrm{V}$
D7.39 As discussed in Section 7.3, beneficial effects can be realized by having an unbypassed resistance $R_{s}$ in the source lead of the CS amplifier. This can be implemented in the circuit of Fig. 7.55(a) by splitting the resistance $R_{S}$ into two resistances: $R_{s}$, which is left unbypassed, and $\left(R_{S}-R_{s}\right)$, across which the bypass capacitor $C_{S}$ is connected. Now, if in order to improve linearity of the amplifier in Exercises 7.37 and 7.38, $v_{\mathrm{gs}}$ is to be reduced to half its value, what value should $R_{s}$ have? What would the amplifier gain $G_{v}$ become? Recall that when $R_{s}$ is included it becomes difficult to include $r_{o}$ in the analysis, so neglect it.
Ans. $R_{s}=500 \Omega ; G_{v}=-8.9 \mathrm{~V} / \mathrm{V}$
# 7.5.2 A Common-Emitter Amplifier 

The common-emitter (CE) amplifier is the most widely used of all BJT amplifier configurations. Figure 7.56(a) shows a CE amplifier utilizing the classical biasing arrangement of Fig. 7.48(c), the design of which was considered in Section 7.4. The CE circuit in Fig. 7.54(a) is the BJT counterpart of the CS amplifier of Fig. 7.55(a). It utilizes coupling capacitors $C_{C 1}$ and $C_{C 2}$ and bypass capacitor $C_{E}$. Here we assume that these capacitors, while blocking dc, behave as perfect short circuits at all signal frequencies of interest.

To determine the characteristic parameters of the CE amplifier, we replace the BJT with its hybrid- $\pi$ model, replace $V_{C C}$ with a short circuit to ground, and replace the coupling and bypass capacitor with short circuits. The resulting small-signal equivalent circuit of the CE amplifier is shown in Fig. 7.56(b). The analysis is straightforward and is given in the


Figure 7.56 (a) A common-emitter amplifier using the classical biasing arrangement of Fig. 7.52(a). (b) Equivalent circuit and analysis.
figure, thus

$$
R_{\mathrm{in}}=R_{B 1}\left\|R_{B 2}\right\| r_{\pi}
$$

which indicates that to keep $R_{\text {in }}$ relatively high, $R_{B 1}$ and $R_{B 2}$ should be selected large (typically in the range of tens or hundreds of kilohms). This requirement conflicts with the need to keep $R_{B 1}$ and $R_{B 2}$ low so as to minimize the dependence of the dc current $I_{C}$ on the transistor $\beta$. We discussed this design trade-off in Section 7.4.

The voltage gain $G_{v}$ is given by

$$
G_{v}=-\frac{R_{\mathrm{in}}}{R_{\mathrm{in}}+R_{\mathrm{sig}}} g_{m}\left(R_{C}\left\|R_{L}\right\| r_{o}\right)
$$

Note that we have taken $r_{o}$ into account because it is easy to do so. However, as already mentioned, the effect of this parameter on discrete-circuit amplifier performance is usually small.

# EXERCISES 

D7.40 Design the bias circuit of the CE amplifier of Fig. 7.56(a) to obtain $I_{E}=0.5 \mathrm{~mA}$ and $V_{C}=$ +6 V . Design for a dc voltage at the base of 5 V and a current through $R_{B 1}$ of $50 \mu \mathrm{~A}$. Let $V_{C C}=+15 \mathrm{~V}, \beta=100$, and $V_{B E} \simeq 0.7 \mathrm{~V}$. Specify the values of $R_{B 1}, R_{B 2}, R_{E}$, and $R_{C}$. Also give the values of the BJT small-signal parameters $g_{m}, r_{\pi}$, and $r_{o}$ at the bias point. (For the calculation of $r_{o}$, let $V_{A}=100 \mathrm{~V}$.)
Ans. $R_{B 1}=182 \mathrm{k} \Omega ; R_{B 2}=100 \mathrm{k} \Omega ; R_{E}=8.6 \mathrm{k} \Omega ; R_{C}=18 \mathrm{k} \Omega ; g_{m}=20 \mathrm{~mA} / \mathrm{V}, r_{\pi}=5 \mathrm{k} \Omega, r_{o}=200 \mathrm{k} \Omega$
7.41 For the amplifier designed in Exercise 7.40, find $R_{\mathrm{in}}, R_{o}$, and $G_{v}$ when $R_{\mathrm{sig}}=10 \mathrm{k} \Omega$ and $R_{L}=20 \mathrm{k} \Omega$. Ans. $R_{\text {in }}=4.64 \mathrm{k} \Omega ; R_{o}=16.51 \mathrm{k} \Omega ; G_{v}=-57.3 \mathrm{~V} / \mathrm{V}$

### 7.5.3 A Common-Emitter Amplifier with an Emitter Resistance $R_{E}$

As discussed in Section 7.3.4, it is beneficial to include a small resistance in the transistor emitter lead. This can be implemented in the circuit of Fig. 7.56(a) by splitting the emitter bias resistance $R_{E}$ into two components: an unbypassed resistance $R_{e}$, and a resistance $\left(R_{E}-R_{e}\right)$ across which the bypass capacitor $C_{E}$ is connected. The resulting circuit is shown in Fig. 7.57(a) and its small-signal model is shown in Fig. 7.57(b). In the latter we utilize the T model of the BJT because it results in much simpler analysis (recall that this is always the case when a resistance is connected in series with the emitter). Also note that we have not included $r_{o}$, for doing so would complicate the analysis significantly. This burden would not be justified given that $r_{o}$ has little effect on the performance of discrete-circuit amplifiers.

Figure 7.57 (a) A common-emitter amplifier with an unbiased emitter resistance $R_{e}$. (b) The amplifier small-signal model and analysis.

Analysis of the circuit in Fig. 7.57(b) is straightforward and is shown in the figure. Thus,

$$
\begin{aligned}
R_{\text {in }} & =R_{B 1}\left\|R_{B 2}\right\|(\beta+1)\left(r_{e}+R_{e}\right) \\
& =R_{B 1}\left\|R_{B 2}\right\|\left[r_{\pi}+(\beta+1) R_{e}\right]
\end{aligned}
$$
from which we note that including $R_{e}$ increases $R_{\text {in }}$ because it increases the input resistance looking into the base by adding a component $(\beta+1) R_{e}$ to $r_{\pi}$. The overall voltage gain $G_{v}$ is

$$
\begin{aligned}
G_{v} & =-\frac{R_{\mathrm{in}}}{R_{\mathrm{in}}+R_{\mathrm{sig}}} \times \alpha \frac{\text { Total resistance in collector }}{\text { Total resistance in emitter }} \\
& =-\alpha \frac{R_{\mathrm{in}}}{R_{\mathrm{in}}+R_{\mathrm{sig}}} \frac{R_{C} \| R_{L}}{r_{e}+R_{e}}
\end{aligned}
$$

# EXERCISE 

7.42 For the amplifier designed in Exercise 7.40 and analyzed in Exercise 7.41, let it be required to raise $R_{\mathrm{in}}$ to $10 \mathrm{k} \Omega$. What is the required value of $R_{e}$, and what does the overall voltage gain $G_{v}$ become? Ans. $R_{e}=67.7 \Omega ; G_{v}=-39.8 \mathrm{~V} / \mathrm{V}$

### 7.5.4 A Common-Base (CB) Amplifier

Figure 7.58(a) shows a CB amplifier designed using the biasing arrangement of Fig. 7.53. Note that the availability of two power supplies, $V_{C C}$ and $-V_{E E}$, enables us to connect the base directly to ground, obviating the need for a large bypass capacitor to establish a signal ground at the base.

The small-signal equivalent circuit of the CB amplifier is shown in Fig 7.58(b). As expected, we have utilized the T model of the BJT and have not included $r_{o}$. Including $r_{o}$ would complicate the analysis significantly without making much difference to the results in the case of discrete-circuit amplifiers. From the circuit in Fig. 7.58(b) we find

$$
R_{\mathrm{in}}=r_{e} \| R_{E} \simeq r_{e} \simeq 1 / g_{m}
$$

which as expected can be very small, causing $v_{i}$ to be a small fraction of $v_{\text {sig }}$,

$$
v_{i}=v_{\text {sig }} \frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}}
$$

Now,

$$
i_{e}=-\frac{v_{i}}{r_{e}}
$$

and

$$
v_{o}=-\alpha i_{e}\left(R_{C} \| R_{L}\right)
$$


Figure 7.58 (a) A common-base amplifier using the structure of Fig. 7.53 with $R_{B}$ omitted (since the base is grounded). (b) Equivalent circuit obtained by replacing the transistor with its T model.

Thus, the overall voltage gain is given by

$$
G_{v}=\alpha \frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}} \frac{R_{C} \| R_{L}}{r_{e}}=\frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}} g_{m}\left(R_{C} \| R_{L}\right)
$$
# EXERCISE 

D7.43 Design the CB amplifier of Fig. 7.58(a) to provide an input resistance $R_{\text {in }}$ that matches the source resistance of a cable with a characteristic resistance of $50 \Omega$. Assume that $R_{E} \gg r_{e}$. The available power supplies are $\pm 5 \mathrm{~V}$ and $R_{L}=8 \mathrm{k} \Omega$. Design for a dc collector voltage $V_{C}=+1 \mathrm{~V}$. Specify the values of $R_{C}$ and $R_{E}$. What overall voltage gain is obtained? If $v_{\text {sig }}$ is a sine wave with a peak amplitude of 10 mV , what is the peak amplitude of the output voltage? Let $\alpha \simeq 1$.
Ans. $R_{C}=8 \mathrm{k} \Omega ; R_{E}=8.6 \mathrm{k} \Omega ; 40 \mathrm{~V} / \mathrm{V} ; 0.4 \mathrm{~V}$

### 7.5.5 An Emitter Follower

Figure 7.59(a) shows an emitter follower designed using the bias arrangement of Fig. 7.53 and two power supplies, $V_{C C}$ and $-V_{E E}$. The bias resistance $R_{B}$ affects the input resistance of the follower and should be chosen as large as possible while limiting the dc voltage drop across it to a small fraction of $V_{E E}$; otherwise the dependence of the bias current $I_{C}$ on $\beta$ can become unacceptably large.

Figure 7.59(b) shows the small-signal equivalent circuit of the emitter follower. Here, as expected, we have replaced the BJT with its T model and included $r_{o}$ (since this can be done very simply). The input resistance of the emitter follower can be seen to be

$$
R_{\mathrm{in}}=R_{B} \| R_{\mathrm{sb}}
$$

where $R_{i b}$, the input resistance looking into the base, can be obtained by using the resistance-reflection rule. Toward that end, note that $r_{o}$ appears in parallel with $R_{E}$ and $R_{L}$ (which is why it can be easily taken into account). Thus,

$$
R_{\mathrm{sb}}=(\beta+1)\left[r_{e}+\left(R_{E}\left\|r_{o}\right\| R_{L}\right)\right]
$$

The overall voltage gain can be determined by tracking the signal transmission from source to load,

$$
v_{l}=v_{\text {sig }} \frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}}
$$

and

$$
v_{o}=v_{l} \frac{R_{E}\left\|r_{o}\right\| R_{L}}{r_{e}+\left(R_{E}\left\|r_{o}\right\| R_{L}\right)}
$$

Thus,

$$
G_{v} \equiv \frac{v_{o}}{v_{\text {sig }}}=\frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}} \frac{\left(R_{E}\left\|r_{o}\right\| R_{L}\right)}{r_{e}+\left(R_{E}\left\|r_{o}\right\| R_{L}\right)}
$$


Figure 7.59 (a) An emitter-follower circuit. (b) Small-signal equivalent circuit of the emitter follower with the transistor replaced by its T model. Note that $r_{o}$ is included because it is easy to do so. Normally, its effect on performance is small.

Finally, the output resistance $R_{\text {out }}$ can be obtained by short-circuiting $v_{\text {sig }}$ and looking back into the output terminal, excluding $R_{L}$, as

$$
R_{\text {out }}=r_{o}\left\|R_{E}\right\|\left[r_{e}+\frac{R_{B} \| R_{\text {sig }}}{\beta+1}\right]
$$

Note that we have used the inverse resistance-reflection rule, namely, dividing the total resistance in the base, $\left(R_{B} \| R_{\text {sig }}\right)$, by $(\beta+1)$.
# EXERCISE 

D7.44 Design the emitter follower of Fig. 7.59(a) to operate at a dc emitter current $I_{E}=1 \mathrm{~mA}$. Allow a dc voltage drop across $R_{B}$ of 1 V . The available power supplies are $\pm 5 \mathrm{~V}, \beta=100, V_{B E}=$ 0.7 V , and $V_{\mathrm{A}}=100 \mathrm{~V}$. Specify the values required for $R_{B}$ and $R_{E}$. Now if $R_{\text {sig }}=50 \mathrm{k} \Omega$ and $R_{L}=1 \mathrm{k} \Omega$, find $R_{\mathrm{in}}, v_{i} / v_{\text {sig }}, v_{o} / v_{i}, G_{c}$, and $R_{\text {out }}$. (Note: In performing the bias design, neglect the Early effect.)
Ans. $R_{B}=100 \mathrm{k} \Omega ; R_{E}=3.3 \mathrm{k} \Omega ; 44.3 \mathrm{k} \Omega ; 0.469 \mathrm{~V} / \mathrm{V} ; 0.968 \mathrm{~V} / \mathrm{V} ; 0.454 \mathrm{~V} / \mathrm{V} ; 320 \Omega$

### 7.5.6 The Amplifier Frequency Response

Thus far, we have assumed that the gain of transistor amplifiers is constant independent of the frequency of the input signal. This would imply that transistor amplifiers have infinite bandwidth, which of course is not true. To illustrate, we show in Fig. 7.60 a sketch of the magnitude of the gain of a common-emitter or a CS amplifier such as those shown in Figs. 7.56 and 7.55 , respectively, versus frequency. Observe that there is indeed a wide frequency range over which the gain remains almost constant. This obviously is the useful frequency range of


Figure 7.60 Sketch of the magnitude of the gain of a CE (Fig. 7.56) or CS (Fig. 7.55) amplifier versus frequency. The graph delineates the three frequency bands relevant to frequency-response determination.
operation for the particular amplifier. Thus far, we have been assuming that our amplifiers are operating in this frequency band, called the midband.

Figure 7.60 indicates that at lower frequencies, the magnitude of amplifier gain falls off. This is because the coupling and bypass capacitors no longer have low impedances. Recall that we assumed that their impedances were small enough to act as short circuits. Although this can be true at midband frequencies, as the frequency of the input signal is lowered, the reactance $1 / j \omega C$ of each of these capacitors becomes significant, and it can be shown that this results in the overall voltage gain of the amplifier decreasing.

Figure 7.60 indicates also that the gain of the amplifier falls off at the high-frequency end. This is due to the internal capacitive effects in the BJT and the MOSFET. In Chapter 10 we shall study the internal capacitive effects of both transistor types and will augment their hybrid- $\pi$ models with capacitances that model these effects.

We will undertake a detailed study of the frequency response of transistor amplifiers in Chapter 10. For the time being, however, it is important for the reader to realize that for every transistor amplifier, there is a finite band over which the gain is almost constant. The boundaries of this useful frequency band, or midband, are the two frequencies $f_{L}$ and $f_{H}$ at which the gain drops by a certain number of decibels (usually 3 dB ) below its value at midband. As indicated in Fig. 7.60, the amplifier bandwidth, or 3-dB bandwidth, is defined as the difference between the lower $\left(f_{L}\right)$ and upper or higher $\left(f_{H}\right) 3-\mathrm{dB}$ frequencies:

$$
B W=f_{H}-f_{L}
$$

and since usually $f_{L} \ll f_{H}$,

$$
B W \simeq f_{H}
$$

A figure of merit for the amplifier is its gain-bandwidth product, defined as

$$
G B=\left|A_{M}\right| B W
$$

where $\left|A_{M}\right|$ is the magnitude of the amplifier gain in the midband. It will be seen in Chapter 10 that in amplifier design it is usually possible to trade off gain for bandwidth. One way to accomplish this, for instance, is by including resistance $R_{e}$ in the emitter of the CE amplifier.
# Summary 

- The essence of the use of the MOSFET (the BJT) as an amplifier is that when the transistor is operated in the active region, $v_{G S}$ controls $i_{D}\left(v_{B E}\right.$ controls $\left.i_{C}\right)$ in the manner of a voltage-controlled current source. When the device is dc biased in the active region, and the signal $v_{g s}\left(v_{b s}\right)$ is kept small, the operation becomes almost linear, with $i_{d}=g_{m} v_{g s}\left(i_{c}=g_{m} v_{b s}\right)$.
- The most fundamental parameter in characterizing the small-signal linear operation of a transistor is the transconductance $g_{m}$. For a MOSFET, $g_{m}=\mu_{n} C_{o s}(W / L) V_{O V}=$ $\sqrt{2 \mu_{n} C_{o s}(W / L) I_{D}}=2 I_{D} / V_{O V}$; and for the BJT, $g_{m}=I_{C} / V_{T}$.
- A systematic procedure for the analysis of a transistor amplifier circuit is presented in Table 7.1. Tables 7.2 and 7.3 present the small-signal models for the MOSFET and the BJT, respectively.
- When a resistance is connected in series with the source (or emitter), the T model is the most convenient to use.
- The three basic configurations of MOS and BJT amplifiers are presented in Fig. 7.33. Their characteristic parameter values are provided in Table 7.4 (for the MOS case) and in Table 7.5 (for the BJT case).
- The CS amplifier, which has (ideally) infinite input resistance and a reasonably high gain but a rather high output resistance and a limited high-frequency response (more on the latter point in Chapter 10), is used to obtain most of the gain in a cascade amplifier. Similar remarks apply to the CE amplifier, except that it has a relatively low input resistance $\left(r_{\mathrm{e}}=\beta / g_{m}\right)$ arising from the finite base current of the BJT (finite $\beta$ ). Its voltage gain, however, can be larger than that of the CS amplifier because of the higher values of $g_{m}$ obtained with BJTs.
- Adding a resistance $R_{s}$ in the source of a CS amplifier (a resistance $R_{e}$ in the emitter of a CE amplifier) can lead to beneficial effects including the following: raising the input resistance of the CE amplifier, increasing linearity, and extending the useful amplifier bandwidth, at the expense of reducing the gain, all by a factor equal to $\left(1+g_{m} R_{s}\right)\left[\left(1+g_{m} R_{e}\right)\right.$ for the BJT case].
- The $\mathrm{CG}(\mathrm{CB})$ amplifier has a low input resistance and thus, used alone, it has limited and specialized applications. However, its excellent high-frequency response makes it attractive in combination with the CS (CE) amplifier (Chapters 8 and 10).
- The source follower has (ideally) infinite input resistance, a voltage gain lower than but close to unity, and a low output resistance. It is employed as a voltage buffer and as the output stage of a multistage amplifier. Similar remarks apply to the emitter follower except that its input resistance, though large, is finite. Specifically, the emitter follower multiplies the total resistance in the emitter by $(\beta+1)$ before presenting it to the signal source.
- The resistance-reflection rule is a powerful tool in the analysis of BJT amplifier circuits: All resistances in the emitter circuit including the emitter resistance $r_{e}$ can be reflected to the base side by multiplying them by $(\beta+1)$. Conversely, we can reflect all resistances in the base circuit to the emitter side by dividing them by $(\beta+1)$.
- In the analysis and design of discrete-circuit amplifiers, it is rarely necessary to take the transistor output resistance $r_{o}$ into account. In some situations, however, $r_{o}$ can be easily taken into account; specifically in the CS (CE) amplifier and in the source (emitter) follower. In IC amplifiers, $r_{o}$ must always be taken into account.
- A key step in the design of transistor amplifiers is to bias the transistor to operate at an appropriate point in the active region. A good bias design ensures that the parameters of the operating point $\left(I_{D}, V_{O V}\right.$, and $V_{D S}$ for the MOSFET; $I_{C}$ and $V_{C E}$ for the BJT) are predictable and stable and do not vary by large amounts when the transistor is replaced by another of the same type. The bias methods studied in this chapter are suited for discrete-circuit amplifiers only because they utilize large coupling and bypass capacitors.
- Discrete-circuit amplifiers predominantly employ BJTs. The opposite is true for IC amplifiers, where the device of choice is the MOSFET.
## Computer Simulation Problems

316 Problems identified by the Multisim/PSpice icon are intended to demonstrate the value of using SPICE simulation to verify hand analysis and design, and to investigate important issues such as allowable signal swing and amplifier nonlinear distortion. Instructions to assist in setting up PSpice and Multisim simulations for all the indicated problems can be found in the corresponding files on the website. Note that if a particular parameter value is not specified in the problem statement, you are to make a reasonable assumption.

## Section 7.1: Basic Principles

7.1 For the MOS amplifier of Fig. 7.2(a) with $V_{D D}=5 \mathrm{~V}$, $V_{s}=0.5 \mathrm{~V}, k_{n}=10 \mathrm{~mA} / \mathrm{V}^{2}$, and $R_{D}=20 \mathrm{k} \Omega$, determine the coordinates of the active-region segment (AB) of the VTC [Fig. 7.2(b)].

D 7.2 For the MOS amplifier of Fig. 7.2(a) with $V_{D D}=5 \mathrm{~V}$ and $k_{n}=5 \mathrm{~mA} / \mathrm{V}^{2}$, it is required to have the end point of the VTC, point B , at $V_{D S}=0.5 \mathrm{~V}$. What value of $R_{D}$ is required? If the transistor is replaced with another having twice the value of the transconductance parameter $k_{n}$, what new value of $R_{D}$ is needed?

D 7.3 It is required to bias the MOS amplifier of Fig. 7.3 at point Q for which $V_{O V}=0.2 \mathrm{~V}$ and $V_{D S}=1 \mathrm{~V}$. Find the required value of $R_{D}$ when $V_{D D}=5 \mathrm{~V}, V_{s}=0.5 \mathrm{~V}$, and $k_{n}=10 \mathrm{~mA} / \mathrm{V}^{2}$. Also specify the coordinates of the VTC end point B. What is the small-signal voltage gain of this amplifier? Assuming linear operation, what is the maximum allowable negative signal swing at the output? What is the corresponding peak input signal?
7.4 The MOS amplifier of Fig. 7.4(a), when operated with $V_{D D}=2 \mathrm{~V}$, is found to have a maximum small-signal voltage gain magnitude of $14 \mathrm{~V} / \mathrm{V}$. Find $V_{O V}$ and $V_{D S}$ for bias point Q at which a voltage gain of $-12 \mathrm{~V} / \mathrm{V}$ is obtained.
7.5 Consider the amplifier of Fig. 7.4(a) for the case $V_{D D}=$ $5 \mathrm{~V}, R_{D}=24 \mathrm{k} \Omega, k_{n}^{\prime}(W / L)=1 \mathrm{~mA} / \mathrm{V}^{2}$, and $V_{s}=1 \mathrm{~V}$.
(a) Find the coordinates of the two end points of the saturation-region segment of the amplifier transfer characteristic, that is, points A and B on the sketch of Fig. 7.4(b).
(b) If the amplifier is biased to operate with an overdrive voltage $V_{O V}$ of 0.5 V , find the coordinates of the bias point

Q on the transfer characteristic. Also, find the value of $I_{D}$ and of the incremental gain $A_{v}$ at the bias point.
(c) For the situation in (b), and disregarding the distortion caused by the MOSFET's square-law characteristic, what is the largest amplitude of a sine-wave voltage signal that can be applied at the input while the transistor remains in saturation? What is the amplitude of the output voltage signal that results? What gain value does the combination of these amplitudes imply? By what percentage is this gain value different from the incremental gain value calculated above? Why is there a difference?
7.6 Various measurements are made on an NMOS amplifier for which the drain resistor $R_{D}$ is $20 \mathrm{k} \Omega$. First, dc measurements show the voltage across the drain resistor, $V_{R D}$, to be 1.5 V and the gate-to-source bias voltage to be 0.7 V . Then, ac measurements with small signals show the voltage gain to be $\sim 10 \mathrm{~V} / \mathrm{V}$. What is the value of $V_{s}$ for this transistor? If the process transconductance parameter $k_{n}^{\prime}$ is $200 \mu \mathrm{~A} / \mathrm{V}^{2}$, what is the MOSFET's W/L?
*7.7 The expression for the incremental voltage gain $A_{v}$ given in Eq. (7.16) can be written in as

$$
A_{v}=-\frac{2\left(V_{D D}-V_{D S}\right)}{V_{O V}}
$$

where $V_{D S}$ is the bias voltage at the drain. This expression indicates that for given values of $V_{D D}$ and $V_{O V}$, the gain magnitude can be increased by biasing the transistor at a lower $V_{D S}$. This, however, reduces the allowable output signal swing in the negative direction. Assuming linear operation around the bias point, show that the largest possible negative output signal peak $\hat{v}_{o}$ that is achievable while the transistor remains saturated is

$$
\hat{v}_{o}=\left(V_{D S}-V_{O V}\right) /\left(1+\frac{1}{\left|A_{v}\right|}\right)
$$

For $V_{D D}=5 \mathrm{~V}$ and $V_{O V}=0.5 \mathrm{~V}$, provide a table of values for $A_{v}, \hat{v}_{o}$, and the corresponding $\hat{v}_{i}$ for $V_{D S}=1 \mathrm{~V}, 1.5 \mathrm{~V}, 2 \mathrm{~V}$, and 2.5 V . If $k_{n}^{\prime}(W / L)=1 \mathrm{~mA} / \mathrm{V}^{2}$, find $I_{D}$ and $R_{D}$ for the design for which $V_{D S}=1 \mathrm{~V}$.

D *7.8 Design the MOS amplifier of Fig. 7.4(a) to obtain maximum gain while allowing for an output voltage swing of at least $\pm 0.5 \mathrm{~V}$. Let $V_{D D}=5 \mathrm{~V}$, and utilize an overdrive

[^0]
[^0]:    316 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
voltage of approximately 0.2 V .
(a) Specify $V_{D S}$ at the bias point.
(b) What is the gain achieved? What is the signal amplitude $\vec{v}_{s i}$, that results in the $0.5-\mathrm{V}$ signal amplitude at the output?
(c) If the dc bias current in the drain is to be $100 \mu \mathrm{~A}$, what value of $R_{D}$ is needed?
(d) If $k_{n}^{\prime}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$, what $W / L$ ratio is required for the MOSFET?
*7.9 Figure P7.9 shows an amplifier in which the load resistor $R_{D}$ has been replaced with another NMOS transistor $Q_{2}$ connected as a two-terminal device. Note that because $v_{D G}$ of $Q_{2}$ is zero, it will be operating in saturation at all times, even when $v_{I}=0$ and $i_{D 2}=i_{D 1}=0$. Note also that the two transistors conduct equal drain currents. Using $i_{D 1}=i_{D 2}$, show that for the range of $v_{I}$ over which $Q_{1}$ is operating in saturation, that is, for

$$
V_{t 1} \leq v_{I} \leq v_{O}+V_{t 1}
$$

the output voltage will be given by

$$
v_{O}=V_{D D}-V_{t}+\sqrt{\frac{(W / L)_{1}}{(W / L)_{2}}} V_{t}-\sqrt{\frac{(W / L)_{1}}{(W / L)_{2}}} v_{I}
$$

where we have assumed $V_{t 1}=V_{O}=V_{t}$. Thus the circuit functions as a linear amplifier, even for large input signals. For $(W / L)_{1}=(50 \mu \mathrm{~m} / 0.5 \mu \mathrm{~m})$ and $(W / L)_{2}=(5 \mu \mathrm{~m} / 0.5 \mu \mathrm{~m})$, find the voltage gain.


Figure P7.9
7.10 A BJT amplifier circuit such as that in Fig. 7.6 is operated with $V_{C C}=+5 \mathrm{~V}$ and is biased at $V_{C E}=+1 \mathrm{~V}$. Find the voltage gain, the maximum allowed output negative swing without the transistor entering saturation, and the corresponding maximum input signal permitted.
7.11 For the amplifier circuit in Fig. 7.6 with $V_{C C}=+5 \mathrm{~V}$ and $R_{C}=1 \mathrm{k} \Omega$, find $V_{C E}$ and the voltage gain at the following dc collector bias currents: $0.5 \mathrm{~mA}, 1 \mathrm{~mA}, 2.5 \mathrm{~mA}, 4 \mathrm{~mA}$, and 4.5 mA . For each, give the maximum possible positive- and negative-output signal swing as determined by the need to keep the transistor in the active region. Present your results in a table.

D 7.12 Consider the CE amplifier circuit of Fig. 7.6 when operated with a dc supply $V_{C C}=+5 \mathrm{~V}$. It is required to find the point at which the transistor should be biased; that is, find the value of $V_{C E}$ so that the output sine-wave signal $v_{c e}$ resulting from an input sine-wave signal $v_{b e}$ of $5-\mathrm{mV}$ peak amplitude has the maximum possible magnitude. What is the peak amplitude of the output sine wave and the value of the gain obtained? Assume linear operation around the bias point. (Hint: To obtain the maximum possible output amplitude for a given input, you need to bias the transistor as close to the edge of saturation as possible without entering saturation at any time, that is, without $v_{C E}$ decreasing below 0.3 V .)
7.13 A designer considers a number of low-voltage BJT amplifier designs utilizing power supplies with voltage $V_{C C}$ of $1.0,1.5,2.0$, or 3.0 V . For transistors that saturate at $V_{C E}=$ 0.3 V , what is the largest possible voltage gain achievable with each of these supply voltages? If in each case biasing is adjusted so that $V_{C E}=V_{C C} / 2$, what gains are achieved? If a negative-going output signal swing of 0.4 V is required, at what $V_{C E}$ should the transistor be biased to obtain maximum gain? What is the gain achieved with each of the supply voltages? (Notice that all of these gains are independent of the value of $I_{C}$ chosen!)

D *7.14 A BJT amplifier such as that in Fig. 7.6 is to be designed to support relatively undistorted sine-wave output signals of peak amplitudes $P$ volt without the BJT entering saturation or cutoff and to have the largest possible voltage gain, denoted $A_{v} \mathrm{~V} / \mathrm{V}$. Show that the minimum supply voltage $V_{C C}$ needed is given by

$$
V_{C C}=V_{C E \text { sat }}+P+\left|A_{v}\right| V_{T}
$$

[^0]
[^0]:    5.11 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem

Figure 1.15 Symbol convention employed throughout the book.

# 1.4.8 Symbol Convention 

At this point, we draw the reader's attention to the terminology we shall employ throughout the book. To illustrate the terminology, Fig. 1.15 shows the waveform of a current $i_{C}(t)$ that is flowing through a branch in a particular circuit. The current $i_{C}(t)$ consists of a dc component $I_{C}$ on which is superimposed a sinusoidal component $i_{c}(t)$ whose peak amplitude is $I_{c}$. Observe that at a time $t$, the total instantaneous current $i_{C}(t)$ is the sum of the dc current $I_{C}$ and the signal current $i_{c}(t)$,

$$
i_{C}(t)=I_{C}+i_{c}(t)
$$

where the signal current is given by

$$
i_{c}(t)=I_{c} \sin \omega t
$$

Thus, we state some conventions: Total instantaneous quantities are denoted by a lowercase symbol with uppercase subscript(s), for example, $i_{C}(t), v_{D S}(t)$. Direct-current (dc) quantities are denoted by an uppercase symbol with uppercase subscript(s), for example, $I_{C}, V_{D S}$. Incremental signal quantities are denoted by a lowercase symbol with lowercase subscript(s), for example, $i_{c}(t), v_{p s}(t)$. If the signal is a sine wave, then its amplitude is denoted by an uppercase symbol with lowercase subscript(s), for example, $I_{c}, V_{p s}$. Finally, although not shown in Fig. 1.15, dc power supplies are denoted by an uppercase letter with a double-letter uppercase subscript, for example, $V_{C C}, V_{D D}$. A similar notation is used for the dc current drawn from the power supply, for example, $I_{C C}, I_{D D}$.

## EXERCISES

1.10 An amplifier has a voltage gain of $100 \mathrm{~V} / \mathrm{V}$ and a current gain of $1000 \mathrm{~A} / \mathrm{A}$. Express the voltage and current gains in decibels and find the power gain.
Ans. $40 \mathrm{~dB} ; 60 \mathrm{~dB} ; 50 \mathrm{~dB}$
1.11 An amplifier operating from a single $15-\mathrm{V}$ supply provides a $12-\mathrm{V}$ peak-to-peak sine-wave signal to a $1-\mathrm{k} \Omega$ load and draws negligible input current from the signal source. The dc current drawn from the $15-\mathrm{V}$ supply is 8 mA . What is the power dissipated in the amplifier, and what is the amplifier efficiency?
Ans. $102 \mathrm{~mW} ; 15 \%$

# 1.5 Circuit Models for Amplifiers 

A substantial part of this book is concerned with the design of amplifier circuits that use transistors of various types. Such circuits will vary in complexity from those using a single transistor to those with 20 or more devices. In order to be able to apply the resulting amplifier circuit as a building block in a system, one must be able to characterize, or model, its terminal behavior. In this section, we study simple but effective amplifier models. These models apply irrespective of the complexity of the internal circuit of the amplifier. The values of the model parameters can be found either by analyzing the amplifier circuit or by performing measurements at the amplifier terminals.

### 1.5.1 Voltage Amplifiers

Figure 1.16(a) shows a circuit model for the voltage amplifier. The model consists of a voltage-controlled voltage source having a gain factor $A_{v o}$, an input resistance $R_{i}$ that accounts for the fact that the amplifier draws an input current from the signal source, and an output resistance $R_{o}$ that accounts for the change in output voltage as the amplifier is called upon to supply output current to a load. To be specific, we show in Fig. 1.16(b) the amplifier model fed with a signal voltage source $v_{s}$ having a resistance $R_{s}$ and connected at the output to a load resistance $R_{L}$. The nonzero output resistance $R_{o}$ causes only a fraction of $A_{v o} v_{i}$ to appear across the output. Using the voltage-divider rule we obtain

$$
v_{o}=A_{v o} v_{i} \frac{R_{L}}{R_{L}+R_{o}}
$$

Thus the voltage gain is given by

$$
A_{v} \equiv \frac{v_{o}}{v_{i}}=A_{v o} \frac{R_{L}}{R_{L}+R_{o}}
$$

It follows that in order not to lose gain in coupling the amplifier output to a load, the output resistance $R_{o}$ should be much smaller than the load resistance $R_{L}$. In other words, for a given $R_{L}$ one must design the amplifier so that its $R_{o}$ is much smaller than $R_{L}$. Furthermore, there are applications in which $R_{L}$ is known to vary over a certain range. In order to keep the output voltage $v_{o}$ as constant as possible, the amplifier is designed with $R_{o}$ much smaller than the lowest value of $R_{L}$. An ideal voltage amplifier is one with $R_{o}=0$. Equation (1.12) indicates also that for $R_{L}=\infty, A_{v}=A_{v o}$. Thus $A_{v o}$ is the voltage gain of the unloaded amplifier, or the open-circuit voltage gain. It should also be clear that in specifying the voltage gain of an amplifier, one must also specify the value of load resistance at which this gain is measured or


Figure 1.16 (a) Circuit model for the voltage amplifier. (b) The voltage amplifier with input signal source and load.
calculated. If a load resistance is not specified, it is normally assumed that the given voltage gain is the open-circuit gain $A_{v o}$.

The finite input resistance $R_{i}$ introduces another voltage-divider action at the input, with the result that only a fraction of the source signal $v_{s}$ actually reaches the input terminals of the amplifier; that is,

$$
v_{i}=v_{s} \frac{R_{i}}{R_{i}+R_{s}}
$$

It follows that in order not to lose a significant portion of the input signal in coupling the signal source to the amplifier input, the amplifier must be designed to have an input resistance $R_{i}$ much greater than the resistance of the signal source, $R_{i} \gg R_{s}$. Furthermore, there are applications in which the source resistance is known to vary over a certain range. To minimize the effect of this variation on the value of the signal that appears at the input of the amplifier, the design ensures that $R_{i}$ is much greater than the largest value of $R_{s}$. An ideal voltage amplifier is one with $R_{i}=\infty$. In this ideal case both the current gain and power gain become infinite.

The overall voltage gain $\left(v_{o} / v_{s}\right)$ can be found by combining Eqs. (1.12) and (1.13),

$$
\frac{v_{o}}{v_{s}}=A_{v o} \frac{R_{i}}{R_{i}+R_{s}} \frac{R_{L}}{R_{L}+R_{o}}
$$

There are situations in which one is interested not in voltage gain but only in a significant power gain. For instance, the source signal can have a respectable voltage but a source resistance that is much greater than the load resistance. Connecting the source directly to the load would result in significant signal attenuation. In such a case, one requires an amplifier with a high input resistance (much greater than the source resistance) and a low output resistance (much smaller than the load resistance) but with a modest voltage gain (or even unity gain).
Such an amplifier is referred to as a buffer amplifier. We shall encounter buffer amplifiers often throughout this book.

# EXERCISES 

1.12 A transducer characterized by a voltage of 1 V rms and a resistance of $1 \mathrm{M} \Omega$ is available to drive a $10-\Omega$ load. If connected directly, what voltage and power levels result at the load? If a unity-gain (i.e., $A_{v o}=1$ ) buffer amplifier with $1-\mathrm{M} \Omega$ input resistance and $10-\Omega$ output resistance is interposed between source and load, what do the output voltage and power levels become? For the new arrangement, find the voltage gain from source to load, and the power gain (both expressed in decibels).
Ans. $10 \mu \mathrm{~V} \mathrm{rms} ; 10^{-11} \mathrm{~W} ; 0.25 \mathrm{~V} ; 6.25 \mathrm{~mW} ;-12 \mathrm{~dB} ; 44 \mathrm{~dB}$
1.13 The output voltage of a voltage amplifier has been found to decrease by $20 \%$ when a load resistance of $1 \mathrm{k} \Omega$ is connected. What is the value of the amplifier output resistance?
Ans. $250 \Omega$
1.14 An amplifier with a voltage gain of +40 dB , an input resistance of $10 \mathrm{k} \Omega$, and an output resistance of $1 \mathrm{k} \Omega$ is used to drive a $1-\mathrm{k} \Omega$ load. What is the value of $A_{v o}$ ? Find the value of the power gain in decibels.
Ans. $100 \mathrm{~V} / \mathrm{V} ; 44 \mathrm{~dB}$

### 1.5.2 Cascaded Amplifiers

To meet given amplifier specifications, we often need to design the amplifier as a cascade of two or more stages. The stages are usually not identical; rather, each is designed to serve a specific purpose. For instance, in order to provide the overall amplifier with a large input resistance, the first stage is usually required to have a large input resistance. Also, in order to equip the overall amplifier with a low output resistance, the final stage in the cascade is usually designed to have a low output resistance. To illustrate the analysis and design of cascaded amplifiers, we consider a practical example.

## Example 1.3

Figure 1.17 depicts an amplifier composed of a cascade of three stages. The amplifier is fed by a signal source with a source resistance of $100 \mathrm{k} \Omega$ and delivers its output into a load resistance of $100 \Omega$. The first stage has a relatively high input resistance and a modest gain factor of 10 . The second stage has a higher gain factor but lower input resistance. Finally, the last, or output, stage has unity gain but a low output resistance. We wish to evaluate the overall voltage gain, that is, $v_{L} / v_{s}$, the current gain, and the power gain.
# Example 1.3 continued 



Figure 1.17 Three-stage amplifier for Example 1.3.

## Solution

The fraction of source signal appearing at the input terminals of the amplifier is obtained using the voltage-divider rule at the input, as follows:

$$
\frac{v_{i 1}}{v_{s}}=\frac{1 \mathrm{M} \Omega}{1 \mathrm{M} \Omega+100 \mathrm{k} \Omega}=0.909 \mathrm{~V} / \mathrm{V}
$$

The voltage gain of the first stage is obtained by considering the input resistance of the second stage to be the load of the first stage; that is,

$$
A_{v 1} \equiv \frac{v_{i 2}}{v_{i 1}}=10 \frac{100 \mathrm{k} \Omega}{100 \mathrm{k} \Omega+1 \mathrm{k} \Omega}=9.9 \mathrm{~V} / \mathrm{V}
$$

Similarly, the voltage gain of the second stage is obtained by considering the input resistance of the third stage to be the load of the second stage,

$$
A_{v 2} \equiv \frac{v_{i 2}}{v_{i 2}}=100 \frac{10 \mathrm{k} \Omega}{10 \mathrm{k} \Omega+1 \mathrm{k} \Omega}=90.9 \mathrm{~V} / \mathrm{V}
$$

Finally, the voltage gain of the output stage is as follows:

$$
A_{v 3} \equiv \frac{v_{L}}{v_{i 3}}=1 \frac{100 \Omega}{100 \Omega+10 \Omega}=0.909 \mathrm{~V} / \mathrm{V}
$$

The total gain of the three stages in cascade can now be found from

$$
A_{v} \equiv \frac{v_{L}}{v_{i 1}}=A_{v 1} A_{v 2} A_{v 3}=818 \mathrm{~V} / \mathrm{V}
$$

or 58.3 dB .
To find the voltage gain from source to load, we multiply $A_{v}$ by the factor representing the loss of gain at the input; that is,

$$
\begin{aligned}
\frac{v_{L}}{v_{s}} & =\frac{v_{L}}{v_{i 1}} \frac{v_{i 1}}{v_{s}}=A_{v} \frac{v_{i 1}}{v_{s}} \\
& =818 \times 0.909=743.6 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

or 57.4 dB .
The current gain is found as follows:

$$
\begin{aligned}
A_{i} \equiv \frac{i_{o}}{i_{i}} & =\frac{v_{L} / 100 \Omega}{v_{i 1} / 1 \mathrm{M} \Omega} \\
& =10^{4} \times A_{o}=8.18 \times 10^{6} \mathrm{~A} / \mathrm{A}
\end{aligned}
$$

or 138.3 dB .
The power gain is found from

$$
\begin{aligned}
A_{p} & \equiv \frac{P_{L}}{P_{I}}=\frac{v_{L} i_{o}}{v_{i 1} i_{i}} \\
& =A_{v} A_{i}=818 \times 8.18 \times 10^{6}=66.9 \times 10^{8} \mathrm{~W} / \mathrm{W}
\end{aligned}
$$

or 98.3 dB . Note that

$$
A_{p}(\mathrm{~dB})=\frac{1}{2}\left[A_{v}(\mathrm{~dB})+A_{i}(\mathrm{~dB})\right]
$$

A few comments on the cascade amplifier in the above example are in order. To avoid losing signal strength at the amplifier input where the signal is usually very small, the first stage is designed to have a relatively large input resistance $(1 \mathrm{M} \Omega)$, which is much larger than the source resistance. The trade-off appears to be a moderate voltage gain ( $10 \mathrm{~V} / \mathrm{V})$. The second stage does not need to have such a high input resistance; rather, here we need to realize the bulk of the required voltage gain. The third and final, or output, stage is not asked to provide any voltage gain; rather, it functions as a buffer amplifier, providing a relatively large input resistance and a low output resistance, much lower than $R_{L}$. It is this stage that enables connecting the amplifier to the $100-\Omega$ load. These points can be made more concrete by solving the following exercises. In so doing, observe that in finding the gain of an amplifier stage in a cascade amplifier, the loading effect of the succeeding amplifier stage must be taken into account as we have done in the above example.

# EXERCISES 

1.15 What would the overall voltage gain of the cascade amplifier in Example 1.3 be without stage 3 (i.e., with the load resistance connected to the output of the second stage)?

Ans. $81.8 \mathrm{~V} / \mathrm{V}$; a decrease by a factor of 9 .
1.16 For the cascade amplifier of Example 1.3, let $v_{s}$ be 1 mV . Find $v_{i 1}, v_{i 2}, v_{i 3}$, and $v_{L}$. Ans. $0.91 \mathrm{mV} ; 9 \mathrm{mV} ; 818 \mathrm{mV} ; 744 \mathrm{mV}$
1.17 (a) Model the three-stage amplifier of Example 1.3 (without the source and load), using the voltage amplifier model of Fig. 1.16(a). What are the values of $R_{i}, A_{v, o}$, and $R_{o}$ ?
(b) If $R_{L}$ varies in the range $10 \Omega$ to $1000 \Omega$, find the corresponding range of the overall voltage gain, $v_{o} / v_{s}$.
Ans. $1 \mathrm{M} \Omega, 900 \mathrm{~V} / \mathrm{V}, 10 \Omega ; 409 \mathrm{~V} / \mathrm{V}$ to $810 \mathrm{~V} / \mathrm{V}$
# 1.5.3 Other Amplifier Types 

In the design of an electronic system, the signal of interest-whether at the system input, at an intermediate stage, or at the output-can be either a voltage or a current. For instance, some transducers have very high output resistances and can be more appropriately modeled as current sources. Similarly, there are applications in which the output current rather than the voltage is of interest. Thus, although it is the most popular, the voltage amplifier considered above is just one of four possible amplifier types. The other three are the current amplifier, the transconductance amplifier, and the transresistance amplifier. Table 1.1 shows the four amplifier types, their circuit models, the definition of their gain parameters, and the ideal values of their input and output resistances.

### 1.5.4 Relationships between the Four Amplifier Models

Although for a given amplifier a particular one of the four models in Table 1.1 is most preferable, any of the four can be used to model any amplifier. In fact, simple relationships can be derived to relate the parameters of the various models. For instance, the open-circuit

Table 1.1 The Four Amplifier Types

voltage gain $A_{v o}$ can be related to the short-circuit current gain $A_{i s}$ as follows: The open-circuit output voltage given by the voltage amplifier model of Table 1.1 is $A_{v o} v_{i}$. The current amplifier model in the same table gives an open-circuit output voltage of $A_{i s} i_{i} R_{o}$. Equating these two values and noting that $i_{i}=v_{i} / R_{i}$ gives

$$
A_{v o}=A_{i s}\left(\frac{R_{o}}{R_{i}}\right)
$$

Similarly, we can show that

$$
A_{v o}=G_{m} R_{o}
$$

and

$$
A_{v o}=\frac{R_{m}}{R_{i}}
$$

The expressions in Eqs. (1.14) to (1.16) can be used to relate any two of the gain parameters $A_{v o}, A_{i s}, G_{m}$, and $R_{m}$.

# 1.5.5 Determining $R_{i}$ and $R_{o}$ 

From the amplifier circuit models given in Table 1.1, we observe that the input resistance $R_{i}$ of the amplifier can be determined by applying an input voltage $v_{i}$ and measuring (or calculating) the input current $i_{i}$; that is, $R_{i}=v_{i} / i_{i}$. The output resistance is found as the ratio of the open-circuit output voltage to the short-circuit output current. Alternatively, the output resistance can be found by eliminating the input signal source (then $i_{i}$ and $v_{i}$ will both be zero) and applying a voltage signal $v_{s}$ to the output of the amplifier, as shown in Fig. 1.18. If we denote the current drawn from $v_{s}$ into the output terminals as $i_{s}$ (note that $i_{s}$ is opposite in direction to $i_{o}$ ), then $R_{o}=v_{s} / i_{s}$. Although these techniques are conceptually correct, in actual practice more refined methods are employed in measuring $R_{i}$ and $R_{o}$.

### 1.5.6 Unilateral Models

The amplifier models considered above are unilateral; that is, signal flow is unidirectional, from input to output. Most real amplifiers show some reverse transmission, which is usually undesirable but must nonetheless be modeled. We shall not pursue this point further at this time except to mention that more complete models for linear two-port networks are given in Appendix C. Also, in later chapters, we will find it necessary in certain cases to augment the models of Table 1.1 to take into account the nonunilateral nature of some transistor amplifiers.


Figure 1.18 Determining the output resistance.
# Example 1.4 

The bipolar junction transistor (BJT), which will be studied in Chapter 6, is a three-terminal device that when powered up by a dc source (battery) and operated with small signals can be modeled by the linear circuit shown in Fig. 1.19(a). The three terminals are the base (B), the emitter (E), and the collector (C). The heart of the model is a transconductance amplifier represented by an input resistance between B and E (denoted $r_{u}$ ), a short-circuit transconductance $g_{m}$, and an output resistance $r_{o}$.


Figure 1.19 (a) Small-signal circuit model for a bipolar junction transistor (BJT). (b) The BJT connected as an amplifier with the emitter as a common terminal between input and output (called a common-emitter amplifier). (c) An alternative small-signal circuit model for the BJT.
(a) With the emitter used as a common terminal between input and output, Fig. 1.19(b) shows a transistor amplifier known as a common-emitter or grounded-emitter circuit. Derive an expression for the voltage gain $v_{o} / v_{s}$, and evaluate its magnitude for the case $R_{s}=5 \mathrm{k} \Omega, r_{u}=2.5 \mathrm{k} \Omega$, $g_{m}=40 \mathrm{~mA} / \mathrm{V}, r_{o}=100 \mathrm{k} \Omega$, and $R_{L}=5 \mathrm{k} \Omega$. What would the gain value be if the effect of $r_{o}$ were neglected?
(b) An alternative model for the transistor in which a current amplifier rather than a transconductance amplifier is utilized is shown in Fig. 1.19(c). What must the short-circuit current gain $\beta$ be? Give both an expression and a value.
# Solution 

(a) Refer to Fig. 1.19(b). We use the voltage-divider rule to determine the fraction of input signal that appears at the amplifier input as

$$
v_{b e}=v_{s} \frac{r_{\pi}}{r_{\pi}+R_{s}}
$$

Next we determine the output voltage $v_{o}$ by multiplying the current $\left(g_{m} v_{b e}\right)$ by the resistance $\left(R_{L} \| r_{o}\right)$,

$$
v_{o}=-g_{m} v_{b e}\left(R_{L} \| r_{o}\right)
$$

Substituting for $v_{b e}$ from Eq. (1.17) yields the voltage-gain expression

$$
\frac{v_{o}}{v_{s}}=-\frac{r_{\pi}}{r_{\pi}+R_{s}} g_{m}\left(R_{L} \| r_{o}\right)
$$

Observe that the gain is negative, indicating that this amplifier is inverting. For the given component values,

$$
\begin{aligned}
\frac{v_{o}}{v_{s}} & =-\frac{2.5}{2.5+5} \times 40 \times(5 \| 100) \\
& =-63.5 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

Neglecting the effect of $r_{o}$, we obtain

$$
\begin{aligned}
\frac{v_{o}}{v_{s}} & \simeq-\frac{2.5}{2.5+5} \times 40 \times 5 \\
& =-66.7 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

which is quite close to the value obtained including $r_{o}$. This is not surprising, since $r_{o} \gg R_{L}$.
(b) For the model in Fig. 1.19(c) to be equivalent to that in Fig. 1.19(a),

$$
\beta i_{b}=g_{m} v_{b e}
$$

But $i_{b}=v_{b e} / r_{\pi}$; thus,

$$
\beta=g_{m} r_{\pi}
$$

For the values given,

$$
\begin{aligned}
\beta & =40 \mathrm{~mA} / \mathrm{V} \times 2.5 \mathrm{k} \Omega \\
& =100 \mathrm{~A} / \mathrm{A}
\end{aligned}
$$Also, find $V_{C C}$, specified to the nearest 0.5 V , for the following situations:
(a) $A_{v}=-20 \mathrm{~V} / \mathrm{V}, P=0.2 \mathrm{~V}$
(b) $A_{v}=-50 \mathrm{~V} / \mathrm{V}, P=0.5 \mathrm{~V}$
(c) $A_{v}=-100 \mathrm{~V} / \mathrm{V}, P=0.5 \mathrm{~V}$
(d) $A_{v}=-100 \mathrm{~V} / \mathrm{V}, P=1.0 \mathrm{~V}$
(e) $A_{v}=-200 \mathrm{~V} / \mathrm{V}, P=1.0 \mathrm{~V}$
(f) $A_{v}=-500 \mathrm{~V} / \mathrm{V}, P=1.0 \mathrm{~V}$
(g) $A_{v}=-500 \mathrm{~V} / \mathrm{V}, P=2.0 \mathrm{~V}$
7.15 The transistor in the circuit of Fig. P7.15 is biased at a dc collector current of 0.3 mA . What is the voltage gain? (Hint: Use Thévenin's theorem to convert the circuit to the form in Fig. 7.6.)


Figure P7.15
7.16 Sketch and label the voltage-transfer characteristics of the pnp amplifiers shown in Fig. P7.16.


Figure P7.16
*7.17 In deriving the expression for small-signal voltage gain $A_{v}$ in Eq. (7.21) we neglected the Early effect. Derive this expression including the Early effect by substituting

$$
i_{C}=I_{S} e^{v_{B E} / V_{T}}\left(1+\frac{v_{C E}}{V_{A}}\right)
$$

in Eq. (7.4) and including the factor $\left(1+V_{C E} / V_{A}\right)$ in Eq. (7.11). Show that the gain expression changes to

$$
A_{v}=\frac{-I_{C} R_{C} / V_{T}}{\left[1+\frac{I_{C} R_{C}}{V_{A}+V_{C E}}\right]}=-\frac{\left(V_{C C}-V_{C E}\right) / V_{T}}{\left[1+\frac{V_{C C}-V_{C E}}{V_{A}+V_{C E}}\right]}
$$

For the case $V_{C C}=5 \mathrm{~V}$ and $V_{C E}=3 \mathrm{~V}$, what is the gain without and with the Early effect taken into account? Let $V_{A}=100 \mathrm{~V}$.
7.18 When the amplifier circuit of Fig. 7.6 is biased with a certain $V_{B E}$, the dc voltage at the collector is found to be +2 V . For $V_{C C}=+5 \mathrm{~V}$ and $R_{C}=1 \mathrm{k} \Omega$, find $I_{C}$ and the small-signal voltage gain. For a change $\Delta v_{B E}=+5 \mathrm{mV}$, calculate the resulting $\Delta v_{O}$. Calculate it two ways: by using the transistor exponential characteristic $\Delta i_{C}$, and approximately, using the small-signal voltage gain. Repeat for $\Delta v_{B E}=-5 \mathrm{mV}$. Summarize your results in a table.
*7.19 Consider the amplifier circuit of Fig. 7.6 when operated with a supply voltage $V_{C C}=+3 \mathrm{~V}$.
(a) What is the theoretical maximum voltage gain that this amplifier can provide?
(b) What value of $V_{C E}$ must this amplifier be biased at to provide a voltage gain of $-60 \mathrm{~V} / \mathrm{V}$ ?
(c) If the dc collector current $I_{C}$ at the bias point in (b) is to be 0.5 mA , what value of $R_{C}$ should be used?
(d) What is the value of $V_{B E}$ required to provide the bias point mentioned above? Assume that the BJT has $I_{S}=10^{-15} \mathrm{~A}$.
(e) If a sine-wave signal $v_{b e}$ having a $5-\mathrm{mV}$ peak amplitude is superimposed on $V_{B E}$, find the corresponding output voltage signal $v_{c e}$ that will be superimposed on $V_{C E}$ assuming linear operation around the bias point.
(f) Characterize the signal current $i_{c}$ that will be superimposed on the dc bias current $I_{C}$.
(g) What is the value of the dc base current $I_{B}$ at the bias point? Assume $\beta=100$. Characterize the signal current $i_{h}$ that will be superimposed on the base current $I_{B}$.
(h) Dividing the amplitude of $v_{b e}$ by the amplitude of $i_{b}$, evaluate the incremental (or small-signal) input resistance of the amplifier.
(i) Sketch and clearly label correlated graphs for $v_{B E}, v_{C E}$, $i_{C}$, and $i_{B}$ versus time. Note that each graph consists of a dc or average value and a superimposed sine wave. Be careful of the phase relationships of the sine waves.
7.20 The essence of transistor operation is that a change in $v_{B E}, \Delta v_{B E}$, produces a change in $i_{C}, \Delta i_{C}$. By keeping $\Delta v_{B E}$ small, $\Delta i_{C}$ is approximately linearly related to $\Delta v_{B E}, \Delta i_{C}=g_{m} \Delta v_{B E}$, where $g_{m}$ is known as the transistor transconductance. By passing $\Delta i_{C}$ through $R_{C}$, an output voltage signal $\Delta v_{O}$ is obtained. Use the expression for the small-signal voltage gain in Eq. (7.20) to derive an expression for $g_{m}$. Find the value of $g_{m}$ for a transistor biased at $I_{C}=0.5 \mathrm{~mA}$.
7.21 The purpose of this problem is to illustrate the application of graphical analysis to the circuit shown in Fig. P7.21. Sketch $i_{C}-v_{C E}$ characteristic curves for the BJT for $i_{B}=$ $10 \mu \mathrm{~A}, 20 \mu \mathrm{~A}, 30 \mu \mathrm{~A}$, and $40 \mu \mathrm{~A}$. Assume the lines to be horizontal (i.e., neglect the Early effect), and let $\beta=100$. For $V_{C C}=5 \mathrm{~V}$ and $R_{C}=1 \mathrm{k} \Omega$, sketch the load line. What peak-to-peak collector voltage swing will result for $i_{B}$ varying


Figure P7.21
over the range $10 \mu \mathrm{~A}$ to $40 \mu \mathrm{~A}$ ? If the BJT is biased at $V_{C E}=\frac{1}{2} V_{C C}$, find the value of $I_{C}$ and $I_{B}$. If at this current $V_{B E}=0.7 \mathrm{~V}$ and if $R_{B}=100 \mathrm{k} \Omega$, find the required value of $V_{B B}$.
*7.22 Sketch the $i_{C}-v_{C E}$ characteristics of an $n p n$ transistor having $\beta=100$ and $V_{A}=100 \mathrm{~V}$. Sketch characteristic curves for $i_{B}=20 \mu \mathrm{~A}, 50 \mu \mathrm{~A}, 80 \mu \mathrm{~A}$, and $100 \mu \mathrm{~A}$. For the purpose of this sketch, assume that $i_{C}=\beta i_{B}$ at $v_{C E}=0$. Also, sketch the load line obtained for $V_{C C}=10 \mathrm{~V}$ and $R_{C}=1 \mathrm{k} \Omega$. If the dc bias current into the base is $50 \mu \mathrm{~A}$, write the equation for the corresponding $i_{C}-v_{C E}$ curve. Also, write the equation for the load line, and solve the two equations to obtain $V_{C E}$ and $I_{C}$. If the input signal causes a sinusoidal signal of $30-\mu \mathrm{A}$ peak amplitude to be superimposed on $I_{B}$, find the corresponding signal components of $i_{C}$ and $v_{C E}$.

## Section 7.2: Small-Signal Operation and Models

*7.23 This problem investigates the nonlinear distortion introduced by a MOSFET amplifier. Let the signal $v_{g}$, be a sine wave with amplitude $V_{g s}$, and substitute $v_{g s}=$ $V_{g s} \sin \omega t$ in Eq. (7.28). Using the trigonometric identity $\sin ^{2} \theta=\frac{1}{2}-\frac{1}{2} \cos 2 \theta$, show that the ratio of the signal at frequency $2 \omega$ to that at frequency $\omega$, expressed as a percentage (known as the second-harmonic distortion) is

$$
\text { Second-harmonic distortion }=\frac{1}{4} \frac{V_{g s}}{V_{O V}} \times 100
$$

If in a particular application $V_{g s}$ is 10 mV , find the minimum overdrive voltage at which the transistor should be operated so that the second-harmonic distortion is kept to less than $1 \%$.
7.24 Consider an NMOS transistor having $k_{n}=10 \mathrm{~mA} / \mathrm{V}^{2}$. Let the transistor be biased at $V_{O V}=0.2 \mathrm{~V}$. For operation in saturation, what dc bias current $I_{D}$ results? If a $0.02-\mathrm{V}$ signal is superimposed on $V_{G S}$, find the corresponding increment in collector current by evaluating the total collector current $i_{D}$ and subtracting the dc bias current $I_{D}$. Repeat for a $-0.02-\mathrm{V}$ signal. Use these results to estimate $g_{m}$ of the FET at this bias point. Compare with the value of $g_{m}$ obtained using Eq. (7.33).

[^0]
[^0]:    3.14 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
7.25 Consider the FET amplifier of Fig. 7.10 for the case $V_{t}=0.4 \mathrm{~V}, k_{a}=5 \mathrm{~mA} / \mathrm{V}^{2}, V_{G S}=0.6 \mathrm{~V}, V_{D D}=1.8 \mathrm{~V}$, and $R_{D}=10 \mathrm{k} \Omega$.
(a) Find the dc quantities $I_{D}$ and $V_{D S}$.
(b) Calculate the value of $g_{m}$ at the bias point.
(c) Calculate the value of the voltage gain.
(d) If the MOSFET has $\lambda=0.1 \mathrm{~V}^{-1}$, find $r_{o}$ at the bias point and calculate the voltage gain.

D *7.26 An NMOS amplifier is to be designed to provide a $0.20-\mathrm{V}$ peak output signal across a $20-\mathrm{k} \Omega$ load that can be used as a drain resistor. If a gain of at least $10 \mathrm{~V} / \mathrm{V}$ is needed, what $g_{m}$ is required? Using a dc supply of 1.8 V , what values of $I_{D}$ and $V_{O V}$ would you choose? What $W / L$ ratio is required if $\mu_{n} C_{o x}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$ ? If $V_{t}=0.4 \mathrm{~V}$, find $V_{G S}$.

D *7.27 In this problem we investigate an optimum design of the CS amplifier circuit of Fig. 7.10. First, use the voltage gain expression $A_{v}=-g_{m} R_{D}$ together with Eq. (7.42) for $g_{m}$ to show that

$$
A_{v}=-\frac{2 I_{D} R_{D}}{V_{O V}}=-\frac{2\left(V_{D D}-V_{D S}\right)}{V_{O V}}
$$

Next, let the maximum positive input signal be $\hat{v}_{i}$. To keep the second-harmonic distortion to an acceptable level, we bias the MOSFET to operate at an overdrive voltage $V_{O V} \gg \hat{v}_{i}$. Let $V_{O V}=m \hat{v}_{i}$. Now, to maximize the voltage gain $\left|A_{v}\right|$, we design for the lowest possible $V_{D S}$. Show that the minimum $V_{D S}$ that is consistent with allowing a negative signal voltage swing at the drain of $\left|A_{v}\right| \hat{v}_{i}$ while maintaining saturation-mode operation is given by

$$
V_{D S}=\frac{V_{O V}+\hat{v}_{i}+2 V_{D D}\left(\hat{v}_{i} / V_{O V}\right)}{1+2\left(\hat{v}_{i} / V_{O V}\right)}
$$

Now, find $V_{O V}, V_{D S}, A_{v}$, and $\hat{v}_{o}$ for the case $V_{D D}=2.5 \mathrm{~V}, \hat{v}_{i}=$ 20 mV , and $m=15$. If it is desired to operate this transistor at $I_{D}=200 \mu \mathrm{~A}$, find the values of $R_{D}$ and $W / L$, assuming that for this process technology $k_{a}^{\prime}=100 \mu \mathrm{~A} / \mathrm{V}^{2}$.
7.28 In the table below, for MOS transistors operating under a variety of conditions, complete as many entries as possible. Although some data is not available, it is always possible to calculate $g_{m}$ using one of Eqs. (7.40), (7.41), or (7.42). Assume $\mu_{n}=500 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}, \mu_{p}=250 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$, and $C_{o x}=0.4 \mathrm{fF} / \mu \mathrm{m}^{2}$.

| Voltages (V) |  |  |  | Dimensions ( $\mu \mathrm{m}$ ) |  |  |  |  |  |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| Case | Type | $I_{D}(\mathrm{~mA})$ | $\left\|V_{G S}\right\|$ | $\left\|V_{t}\right\|$ | $V_{O V}$ | W | L | W/L | $k^{\prime}(W / L)$ | $g_{m}(\mathrm{~mA} / \mathrm{V})$ |
| a | N | 1 | 3 | 2 |  |  | 1 |  |  |  |
| b | N | 1 |  | 0.7 | 0.5 | 50 |  |  |  |  |
| c | N | 10 |  |  | 2 |  | 1 |  |  |  |
| d | N | 0.5 |  |  | 0.5 |  |  |  |  |  |
| e | N | 0.1 |  |  |  | 10 | 2 |  |  |  |
| f | N |  | 1.8 | 0.8 |  | 40 | 4 |  |  |  |
| g | P | 0.5 |  |  |  |  |  | 25 |  |  |
| h | P |  | 3 | 1 |  |  |  |  | 0.5 |  |
| i | P | 10 |  |  |  | 4000 | 2 |  |  |  |
| j | P | 10 |  |  | 4 |  |  |  |  |  |
| k | P |  |  |  | 1 | 30 | 3 |  |  |  |
| 1 | P |  |  |  | 5 |  |  |  | 0.08 |  |

[^0]
[^0]:    7.25 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
7.29 An NMOS technology has $\mu_{n} C_{o x}=250 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{t}=0.5 \mathrm{~V}$. For a transistor with $L=0.5 \mu \mathrm{~m}$, find the value of $W$ that results in $g_{m}=2 \mathrm{~mA} / \mathrm{V}$ at $I_{D}=0.25 \mathrm{~mA}$. Also, find the required $V_{G S}$.
7.30 For the NMOS amplifier in Fig. P7.30, replace the transistor with its T equivalent circuit, assuming $\lambda=0$. Derive expressions for the voltage gains $v_{i} / v_{i}$ and $v_{d} / v_{i}$.


Figure P7.30

SIR 7.31 In the circuit of Fig. P7.31, the NMOS transistor has $\left|V_{t}\right|=0.5 \mathrm{~V}$ and $V_{A}=50 \mathrm{~V}$ and operates with $V_{D}=1 \mathrm{~V}$. What is the voltage gain $v_{o} / v_{i}$ ? What do $V_{D}$ and the gain become for $I$ increased to 1 mA ?
7.32 For a $0.18-\mu \mathrm{m}$ CMOS fabrication process: $V_{m}=0.5 \mathrm{~V}$, $V_{q r}=-0.5 \mathrm{~V}, \mu_{q} C_{o x}=400 \mu \mathrm{~A} / \mathrm{V}^{2}, \mu_{p} C_{o x}=100 \mu \mathrm{~A} / \mathrm{V}^{2}$, $C_{o x}=8.6 \mathrm{fF} / \mu \mathrm{m}^{2}, V_{A}$ ( $n$-channel devices) $=5 L(\mu \mathrm{~m})$, and $\left|V_{A}\right|$ ( $p$-channel devices) $=6 L(\mu \mathrm{~m})$. Find the small-signal model parameters $\left(g_{m}\right.$ and $\left.r_{o}\right)$ for both an NMOS and a PMOS transistor having $W / L=10 \mu \mathrm{~m} / 0.5 \mu \mathrm{~m}$ and operating at $I_{D}=$ $100 \mu \mathrm{~A}$. Also, find the overdrive voltage at which each device must be operating.
*7.33 Figure P7.33 shows a discrete-circuit amplifier. The input signal $v_{\text {sig }}$ is coupled to the gate through a very large capacitor (shown as infinite). The transistor source is connected to ground at signal frequencies via a very large capacitor (shown as infinite). The output voltage signal that develops at the drain is coupled to a load resistance via a very large capacitor (shown as infinite). All capacitors behave as short circuits for signals and as open circuits for dc.
(a) If the transistor has $V_{s}=1 \mathrm{~V}$, and $h_{n}=4 \mathrm{~mA} / \mathrm{V}^{2}$, verify that the bias circuit establishes $V_{G S}=1.5 \mathrm{~V}, I_{D}=0.5 \mathrm{~mA}$, and $V_{D}=+7.0 \mathrm{~V}$. That is, assume these values, and verify that they are consistent with the values of the circuit components and the device parameters.
(b) Find $g_{m}$ and $r_{o}$ if $V_{A}=100 \mathrm{~V}$.
(c) Draw a complete small-signal equivalent circuit for the amplifier, assuming all capacitors behave as short circuits at signal frequencies.
(d) Find $R_{\text {in }}, v_{g s} / v_{\text {sig }}, v_{o} / v_{g s}$, and $v_{o} / v_{\text {sig }}$.


Figure P7.31


Figure P7.33

[^0]
[^0]:    SIR $=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
7.34 Consider a transistor biased to operate in the active mode at a dc collector current $I_{C}$. Calculate the collector signal current as a fraction of $I_{C}$ (i.e., $i_{c} / I_{C}$ ) for input signals $v_{b e}$ of $+1 \mathrm{~mV},-1 \mathrm{mV},+2 \mathrm{mV},-2 \mathrm{mV},+5 \mathrm{mV},-5 \mathrm{mV},+8 \mathrm{mV},-8$ $\mathrm{mV},+10 \mathrm{mV},-10 \mathrm{mV},+12 \mathrm{mV}$, and -12 mV . In each case do the calculation two ways:
(a) using the exponential characteristic, and
(b) using the small-signal approximation.

Present your results in the form of a table that includes a column for the error introduced by the small-signal approximation. Comment on the range of validity of the small-signal approximation.
7.35 An npn BJT with grounded emitter is operated with $V_{B E}=0.700 \mathrm{~V}$, at which the collector current is 0.5 mA . A $5-\mathrm{k} \Omega$ resistor connects the collector to a $+5-\mathrm{V}$ supply. What is the resulting collector voltage $V_{C}$ ? Now, if a signal applied to the base raises $v_{B E}$ to 705 mV , find the resulting total collector current $i_{C}$ and total collector voltage $v_{C}$ using the exponential $i_{C}-v_{B E}$ relationship. For this situation, what are $v_{b e}$ and $v_{c}$ ? Calculate the voltage gain $v_{c} / v_{b e}$. Compare with the value obtained using the small-signal approximation, that is, $-g_{m} R_{C}$.
7.36 A transistor with $\beta=100$ is biased to operate at a dc collector current of 0.5 mA . Find the values of $g_{m}, r_{\pi}$, and $r_{s}$. Repeat for a bias current of $50 \mu \mathrm{~A}$.
7.37 A pnp BJT is biased to operate at $I_{C}=1.0 \mathrm{~mA}$. What is the associated value of $g_{m}$ ? If $\beta=100$, what is the value of the small-signal resistance seen looking into the emitter $\left(r_{s}\right)$ ? Into the base $\left(r_{\pi}\right)$ ? If the collector is connected to a $5-\mathrm{k} \Omega$ load, with a signal of $5-\mathrm{mV}$ peak applied between base and emitter, what output signal voltage results?

D 7.38 A designer wishes to create a BJT amplifier with a $g_{m}$ of $30 \mathrm{~mA} / \mathrm{V}$ and a base input resistance of $3000 \Omega$ or more.

What collector-bias current should he choose? What is the minimum $\beta$ he can tolerate for the transistor used?
7.39 A transistor operating with nominal $g_{m}$ of $40 \mathrm{~mA} / \mathrm{V}$ has a $\beta$ that ranges from 50 to 150 . Also, the bias circuit, being less than ideal, allows a $\pm 20 \%$ variation in $I_{C}$. What are the extreme values found of the resistance looking into the base?
7.40 In the circuit of Fig. 7.20, $V_{B E}$ is adjusted so that $V_{C}=$ 1 V . If $V_{C C}=3 \mathrm{~V}, R_{C}=2 \mathrm{k} \Omega$, and a signal $v_{b e}=0.005 \sin \omega t$ volts is applied, find expressions for the total instantaneous quantities $i_{C}(t), v_{C}(t)$, and $i_{B}(t)$. The transistor has $\beta=100$. What is the voltage gain?

D *7.41 We wish to design the amplifier circuit of Fig. 7.20 under the constraint that $V_{C C}$ is fixed. Let the input signal $v_{b e}=$ $\hat{V}_{b e} \sin \omega t$, where $\hat{V}_{b e}$ is the maximum value for acceptable linearity. For the design that results in the largest signal at the collector, without the BJT leaving the active region, show that

$$
R_{C} I_{C}=\left(V_{C C}-0.3\right) /\left(1+\frac{\hat{V}_{b e}}{V_{T}}\right)
$$

and find an expression for the voltage gain obtained. For $V_{C C}=3 \mathrm{~V}$ and $\hat{V}_{b e}=5 \mathrm{mV}$, find the dc voltage at the collector, the amplitude of the output voltage signal, and the voltage gain.
7.42 The table below summarizes some of the basic attributes of a number of BJTs of different types, operating as amplifiers under various conditions. Provide the missing entries. (Note: Isn't it remarkable how much two parameters can reveal?)
7.43 A BJT is biased to operate in the active mode at a dc collector current of 1 mA . It has a $\beta$ of 100 and $V_{A}$ of 100 V . Give the four small-signal models (Figs. 7.25 and 7.27) of the BJT complete with the values of their parameters.

| Transistor | a | b | c | d | e | f | g |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| $\alpha$ | 1.000 |  |  |  |  | 0.90 |  |
| $\beta$ |  | 100 |  | $\infty$ |  |  |  |
| $I_{C}(\mathrm{~mA})$ | 1.00 |  | 1.00 |  |  |  |  |
| $I_{E}(\mathrm{~mA})$ |  | 1.00 |  |  |  | 5 |  |
| $I_{B}(\mathrm{~mA})$ |  |  | 0.020 |  |  |  | 1.10 |
| $g_{m}(\mathrm{~mA} / \mathrm{V})$ |  |  |  | 25 | 100 |  | 700 |
| $r_{s}(\Omega)$ |  |  |  |  | $10.1 \mathrm{k} \Omega$ |  |  |
| $r_{\pi}(\Omega)$ |  |  |  |  |  |  |  |

[^0]
[^0]:    ${ }^{\text {TIE }}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
7.44 Using the T model of Fig. 7.26(a), show that the input resistance between base and emitter, looking into the base, is equal to $r_{\sigma}$.
7.45 Show that the collector current provided by the model of Fig. 7.26(b) is equal to that provided by the model in Fig. 7.26(a).
7.46 Show that the hybrid- $\pi$ model of Fig. 7.24(b) is the incremental version of the large-signal model of Fig. 6.5(d).
7.47 Show that the T model of Fig. 7.26(b) is the incremental version of the large-signal model of Fig. 6.5(b).
7.48 The transistor amplifier in Fig. P7.48 is biased with a current source $I$ and has a very high $\beta$. Find the dc voltage at the collector, $V_{C}$. Also, find the value of $r_{e}$. Replace the transistor with the T model of Fig. 7.26(b) (note that the dc current source $I$ should be replaced with an open circuit). Hence find the voltage gain $v_{r} / v_{i}$.


Figure P7.48
7.49 For the conceptual circuit shown in Fig. 7.23, $R_{C}=2 \mathrm{k} \Omega, g_{m}=50 \mathrm{~mA} / \mathrm{V}$, and $\beta=100$. If a peak-to-peak output voltage of 1 V is measured at the collector, what are the peak-to-peak values of $v_{b e}$ and $i_{b}$ ?
7.50 Figure P7.50 shows the circuit of an amplifier fed with a signal source $v_{\text {sig }}$ with a source resistance $R_{\text {sig }}$. The bias circuitry is not shown. Replace the BJT with its hybrid- $\pi$ equivalent circuit of Fig. 7.24(a). Find the input resistance $R_{\mathrm{in}} \equiv v_{\pi} / i_{b}$, the voltage transmission from source to amplifier
input, $v_{\pi} / v_{\text {sig }}$, and the voltage gain from base to collector, $v_{\sigma} / v_{\pi}$. Use these to show that the overall voltage gain $v_{\sigma} / v_{\text {sig }}$ is given by

$$
\frac{v_{\sigma}}{v_{\text {sig }}}=-\frac{\beta R_{C}}{r_{\sigma}+R_{\text {sig }}}
$$



Figure P7.50
7.51 Figure P7.51 shows a transistor with the collector connected to the base. The bias arrangement is not shown. Since a zero $v_{B C}$ implies operation in the active mode, the BJT can be replaced by one of the small-signal models of Figs. 7.24 and 7.26. Use the model of Fig. 7.26(b) and show that the resulting two-terminal device, known as a diode-connected transistor, has a small-signal resistance $r$ equal to $r_{e}$.


Figure P7.51
7.52 Figure P7.52 shows a particular configuration of BJT amplifiers known as "emitter follower." The bias arrangement is not shown. Replace the BJT with its T equivalent-circuit

[^0]
[^0]:    3.44 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
model of Fig. 7.26(b). Show that

$$
\begin{aligned}
R_{i n} \equiv \frac{v_{i}}{t_{b}} & =(\beta+1)\left(r_{e}+R_{e}\right) \\
\frac{v_{o}}{v_{i}} & =\frac{R_{e}}{R_{e}+r_{e}}
\end{aligned}
$$



Figure P7.52
7.53 For the circuit shown in Fig. P7.53, draw a complete small-signal equivalent circuit utilizing an appropriate T model for the BJT (use $\alpha=0.99$ ). Your circuit should show the values of all components, including the model parameters. What is the input resistance $R_{\text {in }}$ ? Calculate the overall voltage gain $\left(v_{o} / v_{\text {sig }}\right)$.


Figure P7.53
7.54 In the circuit shown in Fig. P7.54, the transistor has a $\beta$ of 200. What is the dc voltage at the collector? Replacing the BJT with one of the hybrid- $\pi$ models (neglecting $r_{o}$ ), draw the equivalent circuit of the amplifier. Find the input resistances $R_{\text {in }}$ and $R_{\text {in }}$ and the overall voltage gain $\left(v_{o} / v_{\text {sig }}\right)$. For an output signal of $\pm 0.4 \mathrm{~V}$, what values of $v_{\text {sig }}$ and $v_{b}$ are required?


Figure P7.54
7.55 Consider the augmented hybrid- $\pi$ model shown in Fig. 7.25(a). Disregarding how biasing is to be done, what is the largest possible voltage gain available for a signal source connected directly to the base and a very-high-resistance load? Calculate the value of the maximum possible gain for $V_{A}=25 \mathrm{~V}$ and $V_{A}=125 \mathrm{~V}$.

D 7.56 Redesign the circuit of Fig. 7.30(a) by raising the resistor values by a factor $n$ to increase the resistance seen by the input $v_{i}$ to $75 \Omega$. What value of voltage gain results? Grounded-base circuits of this kind are used in systems such as cable TV, in which, for highest-quality signaling, load resistances need to be "matched" to the equivalent resistances of the interconnecting cables.

D *7.57 Design an amplifier using the configuration of Fig. 7.30(a). The power supplies available are $\pm 5 \mathrm{~V}$. The input signal source has a resistance of $50 \Omega$, and it is required that the amplifier input resistance match this value. (Note that $R_{\text {in }}=r_{e} \| R_{E} \simeq r_{e}$.) The amplifier is to have the greatest possible voltage gain and the largest possible output signal but retain small-signal linear operation (i.e., the signal component across the base-emitter junction should be limited to no more

[^0]
[^0]:    7.53 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
than 10 mV ). Find appropriate values for $R_{E}$ and $R_{C}$. What is the value of voltage gain realized from signal source to output?
*7.58 The transistor in the circuit shown in Fig. P7.58 is biased to operate in the active mode. Assuming that $\beta$ is very large, find the collector bias current $I_{C}$. Replace the transistor with the small-signal equivalent-circuit model of Fig. 7.26(b) (remember to replace the dc power supply with a short circuit). Analyze the resulting amplifier equivalent circuit to show that

$$
\begin{aligned}
& \frac{v_{o 1}}{v_{i}}=\frac{R_{E}}{R_{E}+r_{e}} \\
& \frac{v_{o 2}}{v_{i}}=\frac{-\alpha R_{C}}{R_{E}+r_{e}}
\end{aligned}
$$



Figure P7.58

Find the values of these voltage gains (for $\alpha \simeq 1$ ). Now, if the terminal labeled $v_{o 1}$ is connected to ground, what does the voltage gain $v_{o 2} / v_{i}$ become?

## Section 7.3: Basic Configurations

7.59 An amplifier with an input resistance of $100 \mathrm{k} \Omega$, an open-circuit voltage gain of $100 \mathrm{~V} / \mathrm{V}$, and an output resistance of $100 \Omega$ is connected between a $20-\mathrm{k} \Omega$ signal source and a $2-\mathrm{k} \Omega$ load. Find the overall voltage gain $G_{o}$. Also find the current gain, defined as the ratio of the load current to the current drawn from the signal source.

D 7.60 Specify the parameters $R_{\text {in }}, A_{v o}$, and $R_{o}$ of an amplifier that is to be connected between a $100-\mathrm{k} \Omega$ source and a $2-\mathrm{k} \Omega$ load and is required to meet the following specifications:
(a) No more than $5 \%$ of the signal strength is lost in the connection to the amplifier input;
(b) If the load resistance changes from the nominal value of $2 \mathrm{k} \Omega$ to a low value of $1 \mathrm{k} \Omega$, the change in output voltage is limited to $5 \%$ of nominal value; and
(c) The nominal overall voltage gain is $10 \mathrm{~V} / \mathrm{V}$.
7.61 Figure P7.61 shows an alternative equivalent-circuit representation of an amplifier. If this circuit is to be equivalent to that in Fig. 7.34(b) show that $G_{m}=A_{v o} / R_{o}$. Also convince yourself that the transconductance $G_{m}$ is defined as

$$
G_{m}=\left.\frac{i_{o}}{v_{i}}\right|_{R_{L}=0}
$$

and hence is known as the short-circuit transconductance. Now, if the amplifier is fed with a signal source $\left(v_{\text {sig }}, R_{\text {sig }}\right)$ and is connected to a load resistance $R_{L}$ show that the gain of the amplifier proper $A_{v}$ is given by $A_{v}=G_{m}\left(R_{o} \| R_{L}\right)$ and the overall voltage gain $G_{o}$ is given by

$$
G_{v}=\frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}} G_{m}\left(R_{o} \| R_{L}\right)
$$



Figure P7.61
7.62 An alternative equivalent circuit of an amplifier fed with a signal source $\left(v_{\text {sig }}, R_{\text {sig }}\right)$ and connected to a load $R_{L}$ is shown in Fig. P7.62. Here $G_{v o}$ is the open-circuit overall voltage gain,

$$
G_{v o}=\left.\frac{v_{o}}{v_{\text {sig }}}\right|_{R_{L}=\infty}
$$
and $R_{\text {out }}$ is the output resistance with $v_{\text {sig }}$ set to zero. This is different than $R_{o}$. Show that

$$
G_{v o}=\frac{R_{i}}{R_{i}+R_{\text {sig }}} A_{v o}
$$

where $R_{i}=\left.R_{\text {in }}\right|_{R_{L}=\infty}$.
Also show that the overall voltage gain is

$$
G_{v}=G_{v o} \frac{R_{L}}{R_{L}+R_{\text {out }}}
$$

**7.63 Most practical amplifiers have internal feedback that make them non-unilateral. In such a case, $R_{\text {in }}$ depends on $R_{L}$. To illustrate this point we show in Fig. P7.63 the equivalent circuit of an amplifier where a feedback resistance $R_{f}$ models the internal feedback mechanism that is present in this amplifier. It is $R_{f}$ that makes the amplifier non-unilateral. Show that

$$
\begin{aligned}
R_{\text {in }} & =R_{1} \|\left[\frac{R_{f}+\left(R_{2} \| R_{L}\right)}{1+g_{m}\left(R_{2} \| R_{L}\right)}\right] \\
A_{v o} & =-g_{m} R_{2} \frac{1-1 /\left(g_{m} R_{f}\right)}{1+\left(R_{2} / R_{f}\right)} \\
R_{o} & =R_{2} \| R_{f}
\end{aligned}
$$

Evaluate $R_{\text {in }}, A_{v o}$, and $R_{o}$ for the case $R_{1}=100 \mathrm{k} \Omega, R_{f}=$ $1 \mathrm{M} \Omega, g_{m}=100 \mathrm{~mA} / \mathrm{V}, R_{2}=100 \Omega$, and $R_{L}=1 \mathrm{k} \Omega$. Which of the amplifier characteristic parameters is most affected by $R_{f}$ (that is, relative to the case with $R_{f}=\infty$ )? For $R_{\text {sig }}=100 \mathrm{k} \Omega$ determine the overall voltage gain, $G_{v}$, with and without $R_{f}$ present.
7.64 Calculate the overall voltage gain of a CS amplifier fed with a $1-\mathrm{M} \Omega$ source and connected to a $10-\mathrm{k} \Omega$ load. The MOSFET has $g_{m}=2 \mathrm{~mA} / \mathrm{V}$, and a drain resistance $R_{D}=10 \mathrm{k} \Omega$ is utilized.
7.65 A CS amplifier utilizes a MOSFET with $\mu_{n} C_{v o}=$ $400 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $W / L=10$. It is biased at $I_{D}=320 \mu \mathrm{~A}$ and uses $R_{D}=10 \mathrm{k} \Omega$. Find $R_{\text {in }}, A_{v o}$, and $R_{o}$. Also, if a load resistance of $10 \mathrm{k} \Omega$ is connected to the output, what overall voltage gain $G_{v}$ is realized? Now, if a $0.2-\mathrm{V}$ peak sine-wave signal is required at the output, what must the peak amplitude of $v_{\text {sig }}$ be?
7.66 A common-source amplifier utilizes a MOSFET operated at $V_{O V}=0.25 \mathrm{~V}$. The amplifier feeds a load resistance $R_{L}=15 \mathrm{k} \Omega$. The designer selects $R_{D}=2 R_{L}$. If it is required to realize an overall voltage gain $G_{v}$ of $-10 \mathrm{~V} / \mathrm{V}$ what $g_{m}$ is needed? Also specify the bias current $I_{D}$. If, to increase the output signal swing, $R_{D}$ is reduced to $R_{D}=R_{L}$, what does $G_{v}$ become?


Figure P7.62


Figure P7.63

[^0]
[^0]:    518 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
7.67 Two identical CS amplifiers are connected in cascade. The first stage is fed with a source $v_{\text {sig }}$ having a resistance $R_{\text {sig }}=200 \mathrm{k} \Omega$. A load resistance $R_{L}=10 \mathrm{k} \Omega$ is connected to the drain of the second stage. Each MOSFET is biased at $I_{D}=0.3 \mathrm{~mA}$ and operates with $V_{O V}=0.2 \mathrm{~V}$. Each stage utilizes a drain resistance $R_{D}=10 \mathrm{k} \Omega$.
(a) Sketch the equivalent circuit of the two-stage amplifier.
(b) Calculate the overall voltage gain $G_{v}$.
7.68 A CE amplifier utilizes a BJT with $\beta=100$ biased at $I_{C}=0.5 \mathrm{~mA}$; it has a collector resistance $R_{C}=10 \mathrm{k} \Omega$. Find $R_{i n}, R_{o}$, and $A_{v o}$. If the amplifier is fed with a signal source having a resistance of $10 \mathrm{k} \Omega$, and a load resistance $R_{L}=10 \mathrm{k} \Omega$ is connected to the output terminal, find the resulting $A_{v}$ and $G_{v}$. If the peak voltage of the sine wave appearing between base and emitter is to be limited to 5 mV , what $\hat{v}_{\text {sig }}$ is allowed, and what output voltage signal appears across the load?

D *7.69 In this problem we investigate the effect of the inevitable variability of $\beta$ on the realized gain of the CE amplifier. For this purpose, use the overall gain expression in Eq. (7.114).

$$
\left|G_{v}\right|=\frac{R_{L}^{\prime}}{\left(R_{\text {sig }} / \beta\right)+\left(1 / g_{m}\right)}
$$

where $R_{L}^{\prime}=R_{L} \| R_{C}$.
Consider the case $R_{L}^{\prime}=10 \mathrm{k} \Omega$ and $R_{\text {sig }}=10 \mathrm{k} \Omega$, and let the BJT be biased at $I_{C}=1 \mathrm{~mA}$. The BJT has a nominal $\beta$ of 100 .
(a) What is the nominal value of $\left|G_{v}\right|$ ?
(b) If $\beta$ can be anywhere between 50 and 150, what is the corresponding range of $\left|G_{v}\right|$ ?
(c) If in a particular design, it is required to maintain $\left|G_{v}\right|$ within $\pm 20 \%$ of its nominal value, what is the maximum allowable range of $\beta$ ?
(d) If it is not possible to restrict $\beta$ to the range found in (c), and the designer has to contend with $\beta$ in the range 50 to 150 , what value of bias current $I_{C}$ would result in $\left|G_{v}\right|$ falling in a range of $\pm 20 \%$ of a new nominal value? What is the nominal value of $\left|G_{v}\right|$ in this case?
7.70 Two identical CE amplifiers are connected in cascade. The first stage is fed with a source $v_{\text {sig }}$ having a resistance $R_{\text {sig }}=10 \mathrm{k} \Omega$. A load resistance $R_{L}=10 \mathrm{k} \Omega$ is connected to the collector of the second stage. Each BJT is biased at $I_{C}=0.25 \mathrm{~mA}$ and has $\beta=100$. Each stage utilizes a collector resistance $R_{C}=10 \mathrm{k} \Omega$.
(a) Sketch the equivalent circuit of the two-stage amplifier.
(b) Find the overall voltage gain, $v_{o 2} / v_{\text {sig }}$.
7.71 A MOSFET connected in the CS configuration has a transconductance $g_{m}=5 \mathrm{~mA} / \mathrm{V}$. When a resistance $R_{s}$ is connected in the source lead, the effective transconductance is reduced to $2 \mathrm{~mA} / \mathrm{V}$. What do you estimate the value of $R_{s}$ to be?
7.72 A CS amplifier using an NMOS transistor with $g_{m}=$ $2 \mathrm{~mA} / \mathrm{V}$ is found to have an overall voltage gain of $-10 \mathrm{~V} / \mathrm{V}$. What value should a resistance $R_{s}$ inserted in the source lead have to reduce the overall voltage gain to $-5 \mathrm{~V} / \mathrm{V}$ ?
7.73 The overall voltage gain of a CS amplifier with a resistance $R_{s}=0.5 \mathrm{k} \Omega$ in the source lead was measured and found to be $-10 \mathrm{~V} / \mathrm{V}$. When $R_{s}$ was shorted, but the circuit operation remained linear, the gain doubled. What must $g_{m}$ be? What value of $R_{s}$ is needed to obtain an overall voltage gain of $-16 \mathrm{~V} / \mathrm{V}$ ?
7.74 A CE amplifier utilizes a BJT with $\beta=100$ biased at $I_{C}=0.5 \mathrm{~mA}$ and has a collector resistance $R_{C}=12 \mathrm{k} \Omega$ and a resistance $R_{c}=250 \Omega$ connected in the emitter. Find $R_{\mathrm{in}}$, $A_{v o}$, and $R_{c}$. If the amplifier is fed with a signal source having a resistance of $10 \mathrm{k} \Omega$, and a load resistance $R_{L}=12 \mathrm{k} \Omega$ is connected to the output terminal, find the resulting $A_{v}$ and $G_{v}$. If the peak voltage of the sine wave appearing between base and emitter is to be limited to 5 mV , what $\hat{v}_{\text {sig }}$ is allowed, and what output voltage signal appears across the load?

D 7.75 Design a CE amplifier with a resistance $R_{e}$ in the emitter to meet the following specifications:
(i) Input resistance $R_{i n}=15 \mathrm{k} \Omega$.
(ii) When fed from a signal source with a peak amplitude of 0.15 V and a source resistance of $30 \mathrm{k} \Omega$, the peak amplitude of $v_{n}$ is 5 mV .

Specify $R_{e}$ and the bias current $I_{C}$. The BJT has $\beta=74$. If the total resistance in the collector is $6 \mathrm{k} \Omega$, find the overall voltage gain $G_{v}$ and the peak amplitude of the output signal $v_{o}$.
310 D 7.76 Inclusion of an emitter resistance $R_{e}$ reduces the variability of the gain $G_{v}$ due to the inevitable wide variance in the value of $\beta$. Consider a CE amplifier operating between a signal source with $R_{\text {sig }}=10 \mathrm{k} \Omega$ and a total collector resistance $R_{C} \| R_{L}$ of $10 \mathrm{k} \Omega$. The BJT is biased at $I_{C}=1 \mathrm{~mA}$ and its $\beta$ is specified to be nominally 100 but can lie in the range of 50 to 150 . First determine the nominal value and the range of

310 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem$\left|G_{v}\right|$ without resistance $R_{v}$. Then select a value for $R_{v}$ that will ensure that $\left|G_{v}\right|$ be within $\pm 20 \%$ of its new nominal value. Specify the value of $R_{v}$, the new nominal value of $\left|G_{v}\right|$, and the expected range of $\left|G_{v}\right|$.
7.77 A CG amplifier using an NMOS transistor for which $g_{m}=2 \mathrm{~mA} / \mathrm{V}$ has a $5-\mathrm{k} \Omega$ drain resistance $R_{D}$ and a $5-\mathrm{k} \Omega$ load resistance $R_{L}$. The amplifier is driven by a voltage source having a $750-\Omega$ resistance. What is the input resistance of the amplifier? What is the overall voltage gain $G_{v}$ ? By what factor must the bias current $I_{D}$ of the MOSFET be changed so that $R_{\mathrm{in}}$ matches $R_{\text {sig }}$ ?
7.78 A CG amplifier when fed with a signal source having $R_{\text {sig }}=100 \Omega$ is found to have an overall voltage gain of $12 \mathrm{~V} / \mathrm{V}$. When a $100-\Omega$ resistance was added in series with the signal generator the overall voltage gain decreased to $10 \mathrm{~V} / \mathrm{V}$. What must $g_{m}$ of the MOSFET be? If the MOSFET is biased at $I_{D}=0.25 \mathrm{~mA}$, at what overdrive voltage must it be operating?

D 7.79 A CB amplifier is operating with $R_{L}=10 \mathrm{k} \Omega, R_{C}=$ $10 \mathrm{k} \Omega$, and $R_{\text {sig }}=50 \Omega$. At what current $I_{C}$ should the transistor be biased for the input resistance $R_{\text {in }}$ to equal that of the signal source? What is the resulting overall voltage gain? Assume $\alpha \simeq 1$.
7.80 For the circuit in Fig. P7.80, let $R_{\text {sig }} \gg r_{e}$ and $\alpha \simeq 1$. Find $v_{o}$.


Figure P7.80
7.81 A CB amplifier is biased at $I_{E}=0.2 \mathrm{~mA}$ with $R_{C}=R_{L}=$ $10 \mathrm{k} \Omega$ and is driven by a signal source with $R_{\text {sig }}=0.5 \mathrm{k} \Omega$. Find the overall voltage gain $G_{v}$. If the maximum signal amplitude of the voltage between base and emitter is limited to 10 mV ,
what are the corresponding amplitudes of $v_{\text {sig }}$ and $v_{o}$ ? Assume $\alpha \simeq 1$.
7.82 A source follower is required to connect a high-resistance source to a load whose resistance is nominally $2 \mathrm{k} \Omega$ but can be as low as $1.5 \mathrm{k} \Omega$ and as high as $5 \mathrm{k} \Omega$. What is the maximum output resistance that the source follower must have if the output voltage is to remain within $\pm 10 \%$ of nominal value? If the MOSFET has $k_{n}=2.5 \mathrm{~mA} / \mathrm{V}^{2}$, at what current $I_{D}$ must it be biased? At what overdrive voltage is the MOSFET operating?

D 7.83 A source follower is required to deliver a $0.5-\mathrm{V}$ peak sinusoid to a $2-\mathrm{k} \Omega$ load. If the peak amplitude of $v_{p}$, is to be limited to 50 mV , and the MOSFET transconductance parameter $k_{n}$ is $5 \mathrm{~mA} / \mathrm{V}^{2}$, what is the lowest value of $I_{D}$ at which the MOSFET can be biased? At this bias current, what are the maximum and minimum currents that the MOSFET will be conducting (at the positive and negative peaks of the output sine wave)? What must the peak amplitude of $v_{\text {sig }}$ be?

D 7.84 An emitter follower is required to deliver a $0.5-\mathrm{V}$ peak sinusoid to a $2-\mathrm{k} \Omega$ load. If the peak amplitude of $v_{b e}$ is to be limited to 5 mV , what is the lowest value of $I_{E}$ at which the BJT can be biased? At this bias current, what are the maximum and minimum currents that the BJT will be conducting (at the positive and negative peaks of the output sine wave)? If the resistance of the signal source is $200 \mathrm{k} \Omega$, what value of $G_{v}$ is obtained? Thus determine the required amplitude of $v_{\text {sig }}$. Assume $\beta=100$.
7.85 An emitter follower with a BJT biased at $I_{C}=2 \mathrm{~mA}$ and having $\beta=100$ is connected between a source with $R_{\text {sig }}=10 \mathrm{k} \Omega$ and a load $R_{L}=0.5 \mathrm{k} \Omega$.
(a) Find $R_{\mathrm{in}}, v_{b} / v_{\text {sig }}$, and $v_{o} / v_{\text {sig }}$.
(b) If the signal amplitude across the base-emitter junction is to be limited to 10 mV , what is the corresponding amplitude of $v_{\text {sig }}$ and $v_{o}$ ?
(c) Find the open-circuit voltage gain $G_{v o}$ and the output resistance $R_{\text {out }}$. Use these values first to verify the value of $G_{v}$ obtained in (a), then to find the value of $G_{v}$ obtained with $R_{L}$ reduced to $250 \Omega$.
7.86 An emitter follower is operating at a collector bias current of 0.5 mA and is used to connect a $10-\mathrm{k} \Omega$ source to a $1-\mathrm{k} \Omega$ load. If the nominal value of $\beta$ is 100 , what output resistance $R_{\text {out }}$ and overall voltage gain $G_{v}$ result? Now if

[^0]
[^0]:    7.80 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
transistor $\beta$ is specified to lie in the range 50 to 150 , find the corresponding range of $R_{\text {out }}$ and $G_{v}$.
7.87 An emitter follower, when driven from a $5-\mathrm{k} \Omega$ source, was found to have an output resistance $R_{\text {out }}$ of $150 \Omega$. The output resistance increased to $250 \Omega$ when the source resistance was increased to $10 \mathrm{k} \Omega$. Find the overall voltage gain when the follower is driven by a $10-\mathrm{k} \Omega$ source and loaded by a $1-\mathrm{k} \Omega$ resistor.
7.88 For the general amplifier circuit shown in Fig. P7.88 neglect the Early effect.
(a) Find expressions for $v_{c} / v_{\text {sig }}$ and $v_{o} / v_{\text {sig }}$.
(b) If $v_{\text {sig }}$ is disconnected from node X , node X is grounded, and node Y is disconnected from ground and connected to $v_{\text {sig }}$, find the new expression for $v_{c} / v_{\text {sig }}$.


Figure P7.88
7.89 When the Early effect is neglected, the overall voltage gain of a CE amplifier with a collector resistance $R_{C}=10 \mathrm{k} \Omega$ is calculated to be $-100 \mathrm{~V} / \mathrm{V}$. If the BJT is biased at $I_{C}=1$ mA and the Early voltage is 100 V , provide a better estimate of the voltage gain $G_{v}$.
*7.90 Show that when $r_{o}$ is taken into account, the voltage gain of the source follower becomes

$$
G_{v} \equiv \frac{v_{o}}{v_{\text {sig }}}=\frac{R_{L} \| r_{o}}{\left(R_{L} \| r_{o}\right)+\frac{1}{g_{m}}}
$$

Now, with $R_{L}$ removed, the voltage gain is carefully measured and found to be 0.98 . Then, when $R_{L}$ is connected and its value is varied, it is found that the gain is halved at $R_{L}=500 \Omega$. If the amplifier remained linear throughout this measurement, what must the values of $g_{m}$ and $r_{o}$ be?

D 7.91 In this problem, we investigate the effect of changing the bias current $I_{C}$ on the overall voltage gain $G_{v}$ of a CE amplifier. Consider the situation of a CE amplifier operating with a signal source having $R_{\text {sig }}=10 \mathrm{k} \Omega$ and having $R_{C} \| R_{L}=$ $10 \mathrm{k} \Omega$. The BJT is specified to have $\beta=100$ and $V_{A}=25 \mathrm{~V}$. Use Eq. (7.114) (with $r_{o}$ included in parallel with $R_{C}$ and $R_{L}$ in the numerator) to find $\left|G_{v}\right|$ at $I_{C}=0.1 \mathrm{~mA}, 0.2 \mathrm{~mA}, 0.5 \mathrm{~mA}$, 1.0 mA , and 1.25 mA . Observe the effect of $r_{o}$ on limiting $\left|G_{v}\right|$ as $I_{C}$ is increased. Find the value of $I_{C}$ that results in $\left|G_{v}\right|=50 \mathrm{~V} / \mathrm{V}$.

## Section 7.4: Biasing

D 7.92 Consider the classical biasing scheme shown in Fig. 7.48(c), using a 9-V supply. For the MOSFET, $V_{i}=1 \mathrm{~V}$, $\lambda=0$, and $k_{n}=2 \mathrm{~mA} / \mathrm{V}^{2}$. Arrange that the drain current is 1 mA , with about one-third of the supply voltage across each of $R_{S}$ and $R_{D}$. Use 22 M $\Omega$ for the larger of $R_{G 1}$ and $R_{G 2}$. What are the values of $R_{G 1}, R_{G 2}, R_{S}$, and $R_{D}$ that you have chosen? Specify them to two significant digits. For your design, how far is the drain voltage from the edge of saturation?

D 7.93 Using the circuit topology displayed in Fig. 7.48(e), arrange to bias the NMOS transistor at $I_{D}=0.5 \mathrm{~mA}$ with $V_{D}$ midway between cutoff and the beginning of triode operation. The available supplies are $\pm 5 \mathrm{~V}$. For the NMOS transistor, $V_{i}=1.0 \mathrm{~V}, \lambda=0$, and $k_{n}=1 \mathrm{~mA} / \mathrm{V}^{2}$. Use a gate-bias resistor of $10 \mathrm{M} \Omega$. Specify $R_{S}$ and $R_{D}$ to two significant digits.

D *7.94 In an electronic instrument using the biasing scheme shown in Fig. 7.48(c), a manufacturing error reduces $R_{S}$ to zero. Let $V_{D D}=15 \mathrm{~V}, R_{G 1}=10 \mathrm{M} \Omega$, and $R_{G 2}=5.1 \mathrm{M} \Omega$. What is the value of $V_{G}$ created? If supplier specifications allow $k_{n}$ to vary from 0.2 to $0.3 \mathrm{~mA} / \mathrm{V}^{2}$ and $V_{i}$ to vary from 1.0 V to 1.5 V , what are the extreme values of $I_{D}$ that may result? What value of $R_{S}$ should have been installed to limit the maximum value of $I_{D}$ to 1.5 mA ? Choose an appropriate standard 5\% resistor value (refer to Appendix J). What extreme values of current now result?
7.95 An NMOS transistor is connected in the bias circuit of Fig. 7.48(c), with $V_{G}=5 \mathrm{~V}$ and $R_{S}=3 \mathrm{k} \Omega$. The transistor has $V_{i}=1 \mathrm{~V}$ and $k_{n}=2 \mathrm{~mA} / \mathrm{V}^{2}$. What bias current results? If a transistor for which $k_{n}$ is $50 \%$ higher is used, what is the resulting percentage increase in $I_{D}$ ?

SUB 7.96 The bias circuit of Fig. 7.48(c) is used in a design with $V_{G}=5 \mathrm{~V}$ and $R_{S}=2 \mathrm{k} \Omega$. For a MOSFET with

[^0]
[^0]:    $\mathrm{SIN}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
$k_{n}=2 \mathrm{~mA} / \mathrm{V}^{2}$, the source voltage was measured and found to be 2 V . What must $V_{i}$ be for this device? If a device for which $V_{i}$ is 0.5 V less is used, what does $V_{S}$ become? What bias current results?

D 7.97 Design the circuit of Fig. 7.48(e) for a MOSFET having $V_{i}=1 \mathrm{~V}$ and $k_{n}=4 \mathrm{~mA} / \mathrm{V}^{2}$. Let $V_{D D}=V_{S S}=5 \mathrm{~V}$. Design for a dc bias current of 0.5 mA and for the largest possible voltage gain (and thus the largest possible $R_{D}$ ) consistent with allowing a 2-V peak-to-peak voltage swing at the drain. Assume that the signal voltage on the source terminal of the FET is zero.

TIID D 7.98 Design the circuit in Fig. P7.98 so that the transistor operates in saturation with $V_{D}$ biased 1 V from the edge of the triode region, with $I_{D}=1 \mathrm{~mA}$ and $V_{D}=3 \mathrm{~V}$, for each of the following two devices (use a $10-\mu \mathrm{A}$ current in the voltage divider):
(a) $\left|V_{i}\right|=1 \mathrm{~V}$ and $k_{n}^{\prime} W / L=0.5 \mathrm{~mA} / \mathrm{V}^{2}$
(b) $\left|V_{i}\right|=2 \mathrm{~V}$ and $k_{n}^{\prime} W / L=1.25 \mathrm{~mA} / \mathrm{V}^{2}$

For each case, specify the values of $V_{G}, V_{D}, V_{S}, R_{1}, R_{2}, R_{S}$, and $R_{D}$.


Figure P7.98

D **7.99 A very useful way to characterize the stability of the bias current $I_{D}$ is to evaluate the sensitivity of $I_{D}$ relative to a particular transistor parameter whose variability might be large. The sensitivity of $I_{D}$ relative to the MOSFET parameter $K \equiv \frac{1}{2} k^{\prime}(W / L)$ is defined as

$$
S_{K}^{I D} \equiv \frac{\partial I_{D} / I_{D}}{\partial K / K}=\frac{\partial I_{D}}{\partial K} \frac{K}{I_{D}}
$$

and its value, when multiplied by the variability (or tolerance) of $K$, provides the corresponding expected variability of $I_{D}$,

$$
\frac{\Delta I_{D}}{I_{D}}=S_{K}^{I D}\left(\frac{\Delta K}{K}\right)
$$

The purpose of this problem is to investigate the use of the sensitivity function in the design of the bias circuit of Fig. 7.48(e).
(a) Show that for $V_{i}$ constant,

$$
S_{K}^{I D}=1 /\left(1+2 \sqrt{K I_{D}} R_{S}\right)
$$

(b) For a MOSFET having $K=100 \mu \mathrm{~A} / \mathrm{V}^{2}$ with a variability of $\pm 10 \%$ and $V_{i}=1 \mathrm{~V}$, find the value of $R_{S}$ that would result in $I_{D}=100 \mu \mathrm{~A}$ with a variability of $\pm 1 \%$. Also, find $V_{G S}$ and the required value of $V_{S S}$.
(c) If the available supply $V_{S S}=5 \mathrm{~V}$, find the value of $R_{S}$ for $I_{D}=100 \mu \mathrm{~A}$. Evaluate the sensitivity function, and give the expected variability of $I_{D}$ in this case.

D **7.100 The variability $\left(\triangle I_{D} / I_{D}\right)$ in the bias current $I_{D}$ due to the variability $\left(\triangle V_{i} / V_{i}\right)$ in the threshold voltage $V_{i}$ can be evaluated from

$$
\frac{\Delta I_{D}}{I_{D}}=S_{V_{i}}^{I D}\left(\frac{\Delta V_{i}}{V_{i}}\right)
$$

where $S_{V_{i}}^{I D}$, the sensitivity of $I_{D}$ relative to $V_{i}$, is defined as

$$
S_{V_{i}}^{I D}=\frac{\partial I_{D}}{\partial V_{i}} \frac{V_{i}}{I_{D}}
$$

(a) For the case of a MOSFET biased with a fixed $V_{G S}$, show that

$$
S_{V_{i}}^{I D}=-\frac{2 V_{i}}{V_{O V}}
$$

and find the variability in $I_{D}$ for $V_{i}=0.5 \mathrm{~V}$ and $\triangle V_{i} / V_{i}=$ $\pm 5 \%$. Let the MOSFET be biased at $V_{O V}=0.25 \mathrm{~V}$.
(b) For the case of a MOSFET biased with a fixed gate voltage $V_{G}$ and a resistance $R_{S}$ included in the source lead, show that

$$
S_{V_{i}}^{I D}=-\frac{2 V_{i}}{V_{O V}+2 I_{D} R_{S}}
$$

For the same parameters given in (a), find the required value of $\left(I_{D} R_{S}\right)$ and $V_{G}$ to limit $\triangle I_{D} / I_{D}$ to $\pm 5 \%$. What value of $R_{S}$ is needed if $I_{D}$ is $100 \mu \mathrm{~A}$ ?

[^0]
[^0]:    7.10 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
TIN 7.101 In the circuit of Fig. 7.50, let $R_{G}=10 \mathrm{M} \Omega$, $R_{D}=10 \mathrm{k} \Omega$, and $V_{D D}=10 \mathrm{~V}$. For each of the following two transistors, find the voltages $V_{D}$ and $V_{G}$.
(a) $V_{i}=1 \mathrm{~V}$ and $k_{u}=0.5 \mathrm{~mA} / \mathrm{V}^{2}$
(b) $V_{i}=2 \mathrm{~V}$ and $k_{u}=1.25 \mathrm{~mA} / \mathrm{V}^{2}$

D 7.102 Using the feedback bias arrangement shown in Fig. 7.50 with a 5-V supply and an NMOS device for which $V_{i}=1 \mathrm{~V}$ and $k_{u}=10 \mathrm{~mA} / \mathrm{V}^{2}$, find $R_{D}$ to establish a drain current of 0.2 mA .

D 7.103 Figure P7.103 shows a variation of the feedback-bias circuit of Fig. 7.50. Using a 5-V supply with an NMOS transistor for which $V_{i}=0.8 \mathrm{~V}, k_{u}=8 \mathrm{~mA} / \mathrm{V}^{2}$, and $\lambda=0$, provide a design that biases the transistor at $I_{D}=1 \mathrm{~mA}$, with $V_{D S}$ large enough to allow saturation operation for a 2-V negative signal swing at the drain. Use $22 \mathrm{M} \Omega$ as the largest resistor in the feedback-bias network. What values of $R_{D}$, $R_{G 1}$, and $R_{G 2}$ have you chosen? Specify all resistors to two significant digits.


Figure P7. 103

D 7.104 For the circuit in Fig. 7.51(a), neglect the base current $I_{B}$ in comparison with the current in the voltage divider. It is required to bias the transistor at $I_{C}=1 \mathrm{~mA}$, which requires selecting $R_{B 1}$ and $R_{B 2}$ so that $V_{B E}=0.710 \mathrm{~V}$. If $V_{C C}=3 \mathrm{~V}$, what must the ratio $R_{B 1} / R_{B 2}$ be? Now, if $R_{B 1}$ and $R_{B 2}$ are $1 \%$ resistors, that is, each can be in the range of 0.99 to 1.01 of its nominal value, what is the range obtained for $V_{B E}$ ? What is the corresponding range of $I_{C}$ ? If $R_{C}=2 \mathrm{k} \Omega$, what is
the range obtained for $V_{C E}$ ? Comment on the efficacy of this biasing arrangement.

D 7.105 It is required to bias the transistor in the circuit of Fig. 7.51(b) at $I_{C}=1 \mathrm{~mA}$. The transistor $\beta$ is specified to be nominally 100 , but it can fall in the range of 50 to 150 . For $V_{C C}=+3 \mathrm{~V}$ and $R_{C}=2 \mathrm{k} \Omega$, find the required value of $R_{B}$ to achieve $I_{C}=1 \mathrm{~mA}$ for the "nominal" transistor. What is the expected range for $I_{C}$ and $V_{C E}$ ? Comment on the efficacy of this bias design.

D 7.106 Consider the single-supply bias network shown in Fig. 7.52(a). Provide a design using a 9-V supply in which the supply voltage is equally split between $R_{C}, V_{C E}$, and $R_{E}$ with a collector current of 0.6 mA . The transistor $\beta$ is specified to have a minimum value of 90 . Use a voltage-divider current of $I_{E} / 10$, or slightly higher. Since a reasonable design should operate for the best transistors for which $\beta$ is very high, do your initial design with $\beta=\infty$. Then choose suitable $5 \%$ resistors (see Appendix J), making the choice in a way that will result in a $V_{B B}$ that is slightly higher than the ideal value. Specify the values you have chosen for $R_{E}, R_{C}, R_{1}$, and $R_{2}$. Now, find $V_{B}, V_{E}, V_{C}$, and $I_{C}$ for your final design using $\beta=90$.

D 7.107 Repeat Problem 7.106, but use a voltage-divider current that is $I_{E} / 2$. Check your design at $\beta=90$. If you have the data available, find how low $\beta$ can be while the value of $I_{C}$ does not fall below that obtained with the design of Problem 7.106 for $\beta=90$.

D *7.108 It is required to design the bias circuit of Fig. 7.52 for a BJT whose nominal $\beta=100$.
(a) Find the largest ratio $\left(R_{B} / R_{E}\right)$ that will guarantee $I_{E}$ remains within $\pm 5 \%$ of its nominal value for $\beta$ as low as 50 and as high as 150 .
(b) If the resistance ratio found in (a) is used, find an expression for the voltage $V_{B B} \equiv V_{C E} R_{2} /\left(R_{1}+R_{2}\right)$ that will result in a voltage drop of $V_{C C} / 3$ across $R_{E}$.
(c) For $V_{C C}=5 \mathrm{~V}$, find the required values of $R_{1}, R_{2}$, and $R_{E}$ to obtain $I_{E}=0.5 \mathrm{~mA}$ and to satisfy the requirement for stability of $I_{E}$ in (a).
(d) Find $R_{C}$ so that $V_{C E}=1.0 \mathrm{~V}$ for $\beta$ equal to its nominal value.

Check your design by evaluating the resulting range of $I_{E}$.
D *7.109 Consider the two-supply bias arrangement shown in Fig. 7.53 using $\pm 5-\mathrm{V}$ supplies. It is required to design the circuit so that $I_{C}=0.5 \mathrm{~mA}$ and $V_{C}$ is placed 2 V above $V_{E}$.
(a) For $\beta=\infty$, what values of $R_{E}$ and $R_{C}$ are required?
(b) If the BJT is specified to have a minimum $\beta$ of 50 , find the largest value for $R_{B}$ consistent with the need to limit the voltage drop across it to one-tenth the voltage drop across $R_{E}$.
(c) What standard 5\% resistor values (see Appendix J) would you use for $R_{B}, R_{E}$, and $R_{C}$ ? In making your selection, use somewhat lower values in order to compensate for the low $-\beta$ effects.
(d) For the values you selected in (c), find $I_{C}, V_{B}, V_{E}$, and $V_{C}$ for $\beta=\infty$ and for $\beta=50$.

D *7.110 Utilizing $\pm 3-\mathrm{V}$ power supplies, it is required to design a version of the circuit in Fig. 7.53 in which the signal will be coupled to the emitter and thus $R_{B}$ can be set to zero. Find values for $R_{E}$ and $R_{C}$ so that a dc emitter current of 0.4 mA is obtained and so that the gain is maximized while allowing $\pm 1 \mathrm{~V}$ of signal swing at the collector. If temperature increases from the nominal value of $25^{\circ} \mathrm{C}$ to $125^{\circ} \mathrm{C}$, estimate the percentage change in collector bias current. In addition to the $-2 \mathrm{mV} /{ }^{\circ} \mathrm{C}$ change in $V_{B E}$, assume that the transistor $\beta$ changes over this temperature range from 50 to 150 .

SIN D 7.111 Using a 3-V power supply, design a version of the circuit of Fig. 7.54 to provide a dc emitter current of 0.5 mA and to allow a $\pm 1-\mathrm{V}$ signal swing at the collector. The BJT has a nominal $\beta=100$. Use standard $5 \%$ resistor values (see Appendix J). If the actual BJT used has $\beta=50$, what emitter current is obtained? Also, what is the allowable signal swing at the collector? Repeat for $\beta=150$.

D *7.112 (a) Using a 3-V power supply, design the feedback bias circuit of Fig. 7.54 to provide $I_{C}=1 \mathrm{~mA}$ and $V_{C}=V_{C C} / 2$ for $\beta=100$.
(b) Select standard $5 \%$ resistor values, and reevaluate $V_{C}$ and $I_{C}$ for $\beta=100$.
(c) Find $V_{C}$ and $I_{C}$ for $\beta=\infty$.
(d) To improve the situation that obtains when high- $\beta$ transistors are used, we have to arrange for an additional current to flow through $R_{B}$. This can be achieved by connecting a resistor between base and emitter, as shown in Fig. P7.112.

Design this circuit for $\beta=100$. Use a current through $R_{B 2}$ equal to the base current. Now, what values of $V_{C}$ and $I_{C}$ result with $\beta=\infty$ ?


Figure P7.112

D 7.113 A circuit that can provide a very large voltage gain for a high-resistance load is shown in Fig. P7.113. Find the values of $I$ and $R_{B}$ to bias the BJT at $I_{C}=1 \mathrm{~mA}$ and $V_{C}=$ 1.5 V . Let $\beta=100$.


Figure P7.113
7.114 The circuit in Fig. P7.114 provides a constant current $I_{O}$ as long as the circuit to which the collector is
connected maintains the BJT in the active mode. Show that

$$
I_{O}=\alpha \frac{V_{C C}\left[R_{2} /\left(R_{1}+R_{2}\right)\right]-V_{B E}}{R_{E}+\left(R_{1} \| R_{2}\right) /(\beta+1)}
$$



Figure P7.114

SIM D *7.115 For the circuit in Fig. P7.115, assuming all transistors to be identical with $\beta$ infinite, derive an expression for the output current $I_{O}$, and show that by selecting

$$
R_{1}=R_{2}
$$



Figure P7.115
and keeping the current in each junction the same, the current $I_{O}$ will be

$$
I_{O}=\frac{V_{C C}}{2 R_{E}}
$$

which is independent of $V_{B E}$. What must the relationship of $R_{E}$ to $R_{1}$ and $R_{2}$ be? For $V_{C C}=10 \mathrm{~V}$ and $V_{B E}=0.7 \mathrm{~V}$, design the circuit to obtain an output current of 0.5 mA . What is the lowest voltage that can be applied to the collector of $Q_{3}$ ?

D 7.116 For the circuit in Fig. P7.116 find the value of $R$ that will result in $I_{O} \simeq 0.5 \mathrm{~mA}$. What is the largest voltage that can be applied to the collector? Assume $\left|V_{B E}\right|=0.7 \mathrm{~V}$.


Figure P7.116

## Section 7.5: Discrete-Circuit Amplifiers

7.117 Calculate the overall voltage gain $G_{o}$ of a common-source amplifier for which $g_{m}=3 \mathrm{~mA} / \mathrm{V}, r_{o}=$ $100 \mathrm{k} \Omega, R_{D}=10 \mathrm{k} \Omega$, and $R_{G}=10 \mathrm{M} \Omega$. The amplifier is fed from a signal source with a Thévenin resistance of $1 \mathrm{M} \Omega$, and the amplifier output is coupled to a load resistance of $20 \mathrm{k} \Omega$.

SIM 7.118 The NMOS transistor in the CS amplifier shown in Fig. P7.118 has $V_{t}=0.7 \mathrm{~V}$ and $V_{A}=50 \mathrm{~V}$.
(a) Neglecting the Early effect, verify that the MOSFET is operating in saturation with $I_{D}=0.5 \mathrm{~mA}$ and $V_{O V}=0.3 \mathrm{~V}$. What must the MOSFET's $k_{n}$ be? What is the dc voltage at the drain?
(b) Find $R_{m}$ and $G_{o}$.
(c) If $v_{\text {sig }}$ is a sinusoid with a peak amplitude $\hat{v}_{\text {sig }}$, find the maximum allowable value of $\hat{v}_{\text {sig }}$ for which the transistor remains in saturation. What is the corresponding amplitude of the output voltage?


Figure P7.118
(d) What is the value of resistance $R_{s}$ that needs to be inserted in series with capacitor $C_{S}$ in order to allow us to double the input signal $\hat{v}_{\text {sig }}$ ? What output voltage now results?

SIIM D *7.119 The PMOS transistor in the CS amplifier of Fig. P7.119 has $V_{i p}=-0.7 \mathrm{~V}$ and a very large $\left|V_{A}\right|$.
(a) Select a value for $R_{S}$ to bias the transistor at $I_{D}=$ 0.3 mA and $\left|V_{O V}\right|=0.3 \mathrm{~V}$. Assume $v_{\text {sig }}$ to have a zero dc component.
(b) Select a value for $R_{D}$ that results in $G_{v}=-10 \mathrm{~V} / \mathrm{V}$.


Figure P7.119
(c) Find the largest sinusoid $\hat{v}_{\text {sig }}$ that the amplifier can handle while remaining in the saturation region. What is the corresponding signal at the output?
(d) If to obtain reasonably linear operation, $\hat{v}_{\text {sig }}$ is limited to 50 mV , what value can $R_{D}$ be increased to while maintaining saturation-region operation? What is the new value of $G_{v}$ ?
7.120 Figure P7.120 shows a scheme for coupling and amplifying a high-frequency pulse signal. The circuit utilizes


Figure P7.120

[^0]
[^0]:    $\mathrm{SIM}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; $\mathrm{D}=$ design problem
two MOSFETs whose bias details are not shown and a $50-\Omega$ coaxial cable. Transistor $Q_{1}$ operates as a CS amplifier and $Q_{2}$ as a CG amplifier. For proper operation, transistor $Q_{2}$ is required to present a $50-\Omega$ resistance to the cable. This situation is known as "proper termination" of the cable and ensures that there will be no signal reflection coming back on the cable. When the cable is properly terminated, its input resistance is $50 \Omega$. What must $g_{m 2}$ be? If $Q_{1}$ is biased at the same point as $Q_{2}$, what is the amplitude of the current pulses in the drain of $Q_{1}$ ? What is the amplitude of the voltage pulses at the drain of $Q_{1}$ ? What value of $R_{D}$ is required to provide $1-\mathrm{V}$ pulses at the drain of $Q_{2}$ ?

D *7.121 The MOSFET in the circuit of Fig. P7.121 has $V_{t}=0.8 \mathrm{~V}, k_{u}=5 \mathrm{~mA} / \mathrm{V}^{2}$, and $V_{A}=40 \mathrm{~V}$.
(a) Find the values of $R_{S}, R_{D}$, and $R_{G}$ so that $I_{D}=0.4 \mathrm{~mA}$, the largest possible value for $R_{D}$ is used while a maximum signal swing at the drain of $\pm 0.8 \mathrm{~V}$ is possible, and the input resistance at the gate is $10 \mathrm{M} \Omega$. Neglect the Early effect.
(b) Find the values of $g_{m}$ and $r_{o}$ at the bias point.
(c) If terminal Z is grounded, terminal X is connected to a signal source having a resistance of $1 \mathrm{M} \Omega$, and terminal Y is connected to a load resistance of $10 \mathrm{k} \Omega$, find the voltage gain from signal source to load.
(d) If terminal Y is grounded, find the voltage gain from X to Z with Z open-circuited. What is the output resistance of the source follower?


Figure P7.121
(e) If terminal X is grounded and terminal Z is connected to a current source delivering a signal current of $50 \mu \mathrm{~A}$ and having a resistance of $100 \mathrm{k} \Omega$, find the voltage signal that can be measured at Y . For simplicity, neglect the effect of $r_{o}$.

## *7.122

(a) The NMOS transistor in the source-follower circuit of Fig. P7.122(a) has $g_{m}=10 \mathrm{~mA} / \mathrm{V}$ and a large $r_{o}$. Find the open-circuit voltage gain and the output resistance.
(b) The NMOS transistor in the common-gate amplifier of Fig. P7.122(b) has $g_{m}=10 \mathrm{~mA} / \mathrm{V}$ and a large $r_{o}$. Find the input resistance and the voltage gain.
(c) If the output of the source follower in (a) is connected to the input of the common-gate amplifier in (b), use the results of (a) and (b) to obtain the overall voltage gain $v_{o} / v_{i}$.

(a)

(b)

Figure P7.122
D **7.123 The MOSFET in the amplifier circuit of Fig. P7.123 has $V_{t}=0.6 \mathrm{~V}, k_{n}=5 \mathrm{~mA} / \mathrm{V}^{2}$, and $V_{A}=60 \mathrm{~V}$. The signal $v_{\text {sig }}$ has a zero average.
(a) It is required to bias the transistor to operate at an overdrive voltage $V_{D V}=0.2 \mathrm{~V}$. What must the dc voltage at the drain be? Calculate the dc drain current $I_{D}$ taking into account $V_{A}$. Now, what value must the drain resistance $R_{D}$ have?
(b) Calculate the values of $g_{m}$ and $r_{o}$ at the bias point established in (a).
(c) Using the small-signal equivalent circuit of the amplifier, show that the voltage gain is given by

$$
\frac{v_{o}}{v_{\text {sig }}}=-\frac{R_{2} / R_{1}}{1+\frac{1+R_{2} / R_{1}}{g_{m}\left(R_{D} \| r_{o} \| R_{2}\right)\left(1-1 / g_{m} R_{2}\right)}}
$$

and find the value of the gain.


Figure P7. 123
P.S. This feedback amplifier and the gain expression should remind you of an op amp utilized in the inverting configuration. We shall study feedback formally in Chapter 11.

D **7.124 The MOSFET in the amplifier circuit of Fig. P7.124 has $V_{t}=0.6 \mathrm{~V}$ and $k_{n}=5 \mathrm{~mA} / \mathrm{V}^{2}$. We shall assume that $V_{A}$ is sufficiently large so that we can ignore the Early effect. The input signal $v_{\text {sig }}$ has a zero average.
(a) It is required to bias the transistor to operate at an overdrive voltage $V_{D V}=0.2 \mathrm{~V}$. What must the dc voltage at the drain be? Calculate the dc drain current $I_{D}$. What value must $R_{D}$ have?
(b) Calculate the value of $g_{m}$ at the bias point.
(c) Use the small-signal equivalent circuit of the amplifier to show that

$$
\frac{v_{o}}{v_{\text {sig }}}=\frac{1+\left(R_{2} / R_{1}\right)}{1+\frac{\left(1+R_{2} / R_{1}\right)}{g_{m} R_{D}^{\prime}}}
$$

and

$$
R_{\text {in }}=\frac{1}{g_{m}}\left(1+g_{m} R_{D}^{\prime} \frac{R_{2}}{R_{1}+R_{2}}\right)
$$

where

$$
R_{D}^{\prime}=R_{D} \|\left(R_{1}+R_{2}\right)
$$

(d) Evaluate $v_{o} / v_{\text {sig }}$ and $R_{\text {in }}$.


Figure P7. 124
P.S. This feedback amplifier circuit and the gain formula should remind you of an op amp connected in the noninverting configuration. We shall study feedback formally in Chapter 11.
7.125 For the common-emitter amplifier shown in Fig. P7.125, let $V_{C C}=15 \mathrm{~V}, R_{1}=27 \mathrm{k} \Omega, R_{2}=15 \mathrm{k} \Omega$, $R_{E}=2.4 \mathrm{k} \Omega$, and $R_{C}=3.9 \mathrm{k} \Omega$. The transistor has $\beta=100$. Calculate the dc bias current $I_{C}$. If the amplifier operates between a source for which $R_{\text {sig }}=2 \mathrm{k} \Omega$ and a load of $2 \mathrm{k} \Omega$, replace the transistor with its hybrid- $\pi$ model, and find the values of $R_{\text {in }}$, and the overall voltage gain $v_{o} / v_{\text {sig }}$.
D 7.126 Using the topology of Fig. P7.125, design an amplifier to operate between a $2-\mathrm{k} \Omega$ source and a $2-\mathrm{k} \Omega$ load with a gain $v_{o} / v_{\text {sig }}$ of $-40 \mathrm{~V} / \mathrm{V}$. The power supply available is 15 V . Use an emitter current of approximately 2 mA and a current of about one-tenth of that in the voltage divider that feeds the base, with the dc voltage at the base about one-third of the supply. The transistor available has $\beta=100$. Use standard $5 \%$ resistors (see Appendix J).


Figure P7. 125

D 7.127 A designer, having examined the situation described in Problem 7.125 and estimating the available gain to be approximately $-36.3 \mathrm{~V} / \mathrm{V}$, wants to explore the possibility of improvement by reducing the loading
of the source by the amplifier input. As an experiment, the designer varies the resistance levels by a factor of approximately 3: $R_{1}$ to $82 \mathrm{k} \Omega, R_{2}$ to $47 \mathrm{k} \Omega, R_{E}$ to $7.2 \mathrm{k} \Omega$, and $R_{C}$ to $12 \mathrm{k} \Omega$ (standard values of $5 \%$-tolerance resistors). With $V_{C C}=15 \mathrm{~V}, R_{\text {sig }}=2 \mathrm{k} \Omega, R_{L}=2 \mathrm{k} \Omega$, and $\beta=100$, what does the gain become? Comment.

D 7.128 The CE amplifier circuit of Fig. P7.128 is biased with a constant-current source $I$. It is required to design the circuit (i.e., find values for $I, R_{B}$, and $R_{C}$ ) to meet the following specifications:
(a) $R_{\text {in }} \simeq 10 \mathrm{k} \Omega$.
(b) The dc voltage drop across $R_{B}$ is approximately 0.2 V .
(c) The open-circuit voltage gain from base to collector is the maximum possible, consistent with the requirement that the collector voltage never fall by more than approximately 0.4 V below the base voltage with the signal between base and emitter being as high as 5 mV .

Assume that $v_{\text {sig }}$ is a sinusoidal source, the available supply $V_{C C}=5 \mathrm{~V}$, and the transistor has $\beta=100$. Use standard $5 \%$ resistance values, and specify the value of $I$ to one significant digit. What base-to-collector open-circuit voltage gain does your design provide? If $R_{\text {sig }}=R_{L}=20 \mathrm{k} \Omega$, what is the overall voltage gain?


Figure P7. 128

[^0]
[^0]:    $\mathrm{SHM}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; $\mathrm{D}=$ design problemD 7.129 In the circuit of Fig. P7.129, $v_{\text {sig }}$ is a small sine-wave signal with zero average. The transistor $\beta$ is 100 .
(a) Find the value of $R_{E}$ to establish a dc emitter current of about 0.5 mA .


Figure P7.129
(b) Find $R_{C}$ to establish a dc collector voltage of about +0.5 V .
(c) For $R_{L}=10 \mathrm{k} \Omega$, draw the small-signal equivalent circuit of the amplifier and determine its overall voltage gain.
*7.130 The amplifier of Fig. P7.130 consists of two identical common-emitter amplifiers connected in cascade. Observe that the input resistance of the second stage, $R_{\mathrm{in} 2}$, constitutes the load resistance of the first stage.
(a) For $V_{C C}=15 \mathrm{~V}, R_{1}=100 \mathrm{k} \Omega, R_{2}=47 \mathrm{k} \Omega, R_{E}=3.9 \mathrm{k} \Omega$, $R_{C}=6.8 \mathrm{k} \Omega$, and $\beta=100$, determine the dc collector current and dc collector voltage of each transistor.
(b) Draw the small-signal equivalent circuit of the entire amplifier and give the values of all its components.
(c) Find $R_{\mathrm{in} 1}$ and $v_{b 1} / v_{\text {sig }}$ for $R_{\text {sig }}=5 \mathrm{k} \Omega$.
(d) Find $R_{\mathrm{in} 2}$ and $v_{b 2} / v_{b 1}$.
(e) For $R_{L}=2 \mathrm{k} \Omega$, find $v_{o} / v_{b 2}$.
(f) Find the overall voltage gain $v_{o} / v_{\text {sig }}$.


Figure P7.130

[^0]
[^0]:    $\mathrm{III}^{2}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; $\mathrm{D}=$ design problem
7.131 In the circuit of Fig. P7.131, the BJT is biased with a constant-current source, and $v_{\text {sig }}$ is a small sine-wave signal. Find $R_{m}$ and the gain $v_{o} / v_{\text {sig }}$. Assume $\beta=100$. If the amplitude of the signal $v_{b e}$ is to be limited to 5 mV , what is the largest signal at the input? What is the corresponding signal at the output?


Figure P7.131
*7.132 The BJT in the circuit of Fig. P7.132 has $\beta=100$.
(a) Find the dc collector current and the dc voltage at the collector.
(b) Replacing the transistor by its T model, draw the small-signal equivalent circuit of the amplifier. Analyze the resulting circuit to determine the voltage gain $v_{o} / v_{i}$.


Figure P7.132
7.133 For the circuit in Fig. P7.133, find the input resistance $R_{i n}$ and the voltage gain $v_{o} / v_{\text {sig }}$. Assume that the source provides a small signal $v_{\text {sig }}$ and that $\beta=100$.


Figure P7.133
7.134 For the emitter-follower circuit shown in Fig. P7.134, the BJT used is specified to have $\beta$ values in the range of 50 to 200 (a distressing situation for the circuit designer).


Figure P7.134

[^0]
[^0]:    $S I M=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; $D=$ design problem
For the two extreme values of $\beta(\beta=50$ and $\beta=200)$, find:
(a) $I_{E}, V_{E}$, and $V_{B}$
(b) the input resistance $R_{\mathrm{in}}$
(c) the voltage gain $v_{o} / v_{\text {sig }}$
7.135 For the emitter follower in Fig. P7.135, the signal source is directly coupled to the transistor base. If the dc component of $v_{\text {sig }}$ is zero, find the dc emitter current. Assume $\beta=100$. Neglecting $r_{o}$, find $R_{\mathrm{in}}$, the voltage gain $v_{o} / v_{\text {sig }}$, the current gain $i_{o} / i_{i}$, and the output resistance $R_{\text {out }}$.


Figure P7.135
**7.136 For the circuit in Fig. P7.136, called a bootstrapped follower:
(a) Find the dc emitter current and $g_{m}, r_{e}$, and $r_{\pi}$. Use $\beta=100$.
(b) Replace the BJT with its T model (neglecting $r_{o}$ ), and analyze the circuit to determine the input resistance $R_{\mathrm{in}}$ and the voltage gain $v_{o} / v_{\text {sig }}$.
(c) Repeat (b) for the case when capacitor $C_{R}$ is open-circuited. Compare the results with those obtained in (b) to find the advantages of bootstrapping.


Figure P7.136
**7.137 For the follower circuit in Fig. P7.137, let transistor $Q_{1}$ have $\beta=50$ and transistor $Q_{2}$ have $\beta=100$, and neglect the effect of $r_{o}$. Use $V_{B E}=0.7 \mathrm{~V}$.


Figure P7.137
(a) Find the dc emitter currents of $Q_{1}$ and $Q_{2}$. Also, find the dc voltages $V_{B 1}$ and $V_{B 2}$.
(b) If a load resistance $R_{L}=1 \mathrm{k} \Omega$ is connected to the output terminal, find the voltage gain from the base to the emitter of $Q_{2}, v_{o} / v_{b 2}$, and find the input resistance $R_{i b 2}$ looking into the base of $Q_{2}$. (Hint: Consider $Q_{2}$ as an emitter follower fed by a voltage $v_{b 2}$ at its base.)
(c) Replacing $Q_{2}$ with its input resistance $R_{i b 2}$ found in (b), analyze the circuit of emitter follower $Q_{1}$ to determine its input resistance $R_{i n}$, and the gain from its base to its emitter, $v_{e 1} / v_{b 1}$.
(d) If the circuit is fed with a source having a $100-\mathrm{k} \Omega$ resistance, find the transmission to the base of $Q_{1}, v_{b 1} / v_{\text {sig }}$.
(e) Find the overall voltage gain $v_{o} / v_{\text {sig }}$.

D 7.138 A CE amplifier has a midband voltage gain of $\left|A_{M}\right|=100 \mathrm{~V} / \mathrm{V}$, a lower 3-dB frequency of $f_{L}=100 \mathrm{~Hz}$, and a higher 3-dB frequency $f_{H}=500 \mathrm{kHz}$. In Chapter 10 we will learn that connecting a resistance $R_{e}$ in the emitter of the BJT results in lowering $f_{L}$ and raising $f_{H}$ by the factor $\left(1+g_{m} R_{e}\right)$. If the BJT is biased at $I_{C}=1 \mathrm{~mA}$, find $R_{e}$ that will result in $f_{H}$ at least equal to 2 MHz . What will the new values of $f_{L}$ and $A_{M}$ be?
# PART II 

## Integrated-Circuit Amplifiers

CHAPTER 8
Building Blocks of Integrated-Circuit Amplifiers 508
CHAPTER 9
Differential and Multistage Amplifiers 594
CHAPTER 10
Frequency Response 696
CHAPTER 11
Feedback 806
CHAPTER 12
Output Stages and Power Amplifiers 920
CHAPTER 13
Operational-Amplifier Circuits 994
Having studied the MOSFET and the BJT and become familiar with their basic circuit applications, we are now ready to consider their use in the design of practical amplifier circuits that can be fabricated in integrated-circuit (IC) form. Part II is devoted to this rich subject. Its six chapters constitute a coherent treatment of IC amplifier design and can thus serve as a second course in electronic circuits.

Beginning with a brief introduction to the philosophy of IC design, Chapter 8 presents the basic circuit building blocks that are utilized in the design of IC amplifiers. However, the most important building block of all, the differential-pair configuration, is deferred to Chapter 9, where it is the main topic. Chapter 9 also considers the design of amplifiers that require a number of cascaded stages.

As mentioned at various points in Part I, amplifiers have finite bandwidths. Chapter 10 is devoted to the frequency-response analysis of amplifiers; it provides a comprehensive study of the mechanisms that limit the bandwidth and the tools and methods that are utilized to estimate it for a wide variety of amplifier circuit configurations. While the study of the first half or so of Chapter 10 is essential, some of its later sections can be postponed until a later point in the course or even to subsequent courses.

An essential tool in amplifier design is the judicious use of feedback. Chapter 11 deals with this exceedingly important subject. A thorough understanding of feedback concepts, insight into feedback configurations, and proficiency in the use of the feedback-analysis method are invaluable to the serious circuit designer.

In Chapter 12, we switch gears from dealing with primarily small-signal amplifiers to studying those that are required to handle large signals and large amounts of power. Finally, Chapter 13 brings together all the topics of Part II in an important application: namely, the design of operational-amplifier circuits. We will then have come full circle, from considering the op amp as a black box in Chapter 2 to understanding what is inside the box in Chapter 13.

Throughout Part II, MOSFET and BJT circuits are treated side by side. Because over $90 \%$ of ICs today employ the MOSFET, its circuits are presented first. Nevertheless, BJT circuits are presented with equal depth, although sometimes somewhat more briefly. In this regard, we draw the reader's attention to Appendix G (on the website), which presents a valuable compilation of the properties of transistors of both types, allowing interesting comparisons to be made. As well, typical device parameter values are provided in Appendix K for a number of CMOS and bipolar fabrication process technologies.
# CHAPTER 8 

## Building Blocks of Integrated-Circuit Amplifiers

Introduction 509
8.1 IC Design Philosophy 510
8.2 IC Biasing-Current Sources, Current Mirrors, and Current-Steering Circuits 511
8.3 The Basic Gain Cell 525
8.4 The Common-Gate and Common-Base Amplifiers 537
8.5 The Cascode Amplifier 546
8.6 Current-Mirror Circuits with Improved Performance 559
8.7 Some Useful Transistor Pairings 567

Summary 575
Problems 576
# IN THIS CHAPTER YOU WILL LEARN 

1. The basic integrated-circuit (IC) design philosophy and how it differs from that for discrete-circuit design.
2. How current sources are used to bias IC amplifiers and how the use of current mirrors allows the replication of the reference current generated in one location at various other locations on the IC chip.
3. The basic gain cells of IC amplifiers, namely, the CS and CE amplifiers with current-source loads.
4. How the CG and CB amplifiers act as current buffers.
5. How to increase the gain realized in the basic gain cells by employing the principle of cascoding.
6. Analysis and design of the cascode amplifier and the cascode current source in both their MOS and bipolar forms.
7. Some ingenious analog circuit-design techniques that result in current mirrors with vastly improved characteristics.
8. How to pair transistors to realize amplifiers with characteristics superior to those obtained from a single-transistor stage.

## Introduction

Having studied the two major transistor types, the MOSFET and the BJT, and their basic discrete-circuit amplifier configurations, we are now ready to begin the study of integrated-circuit (IC) amplifiers. This chapter is devoted to the design of the basic building blocks of IC amplifiers.

We begin with a brief section on the design philosophy of integrated circuits and how it differs from that of discrete circuits. This is followed by the study of IC biasing in Section 8.2, highlighting the design of current sources and current mirrors. The current mirror is one of the most important building blocks of analog integrated circuits. More advanced mirror circuits are presented in Section 8.6.

The heart of this chapter is the material in Sections 8.3 to 8.5. In Section 8.3 we present the basic gain cell of IC amplifiers, namely, the current-source-loaded common-source (common-emitter) amplifier. Then, in determining how to increase its gain, we discover the
need for current buffers. The two amplifier configurations capable of implementing a current buffer, the common-gate and common-base amplifiers, are studied in Section 8.4. This study differs from that in Chapter 7 in that $r_{a}$ of the transistor is included, as must always be the case in integrated circuits. The study of the CG and CB leads naturally and seamlessly to the principle of cascoding and its applications in amplifier design: namely, the cascode amplifier and the cascode current source, which are very important building blocks of IC amplifiers.

The chapter concludes with the presentation in Section 8.7 of an interesting and useful collection of amplifier configurations, each utilizing a pair of transistors. Throughout this chapter, MOS and bipolar circuits are presented side by side, which allows a certain economy in presentation and, more important, provides an opportunity to compare and contrast the two circuit types.

# 8.1 IC Design Philosophy 

Integrated-circuit fabrication technology (Appendix A) imposes constraints on and provides opportunities to the circuit designer. To cope with the constraints and take advantage of the opportunities, IC designers have over the years invented (and continue to invent) many ingenious techniques, and a distinct philosophy has emerged for the design of integrated circuits. In the following we provide a brief summary of the important constraints and opportunities and the major features of the IC design philosophy.

1. Resistors. To minimize the chip area, large and even moderate-size resistors are to be avoided. As well, economic considerations discourage the use of resistors of precise values. On the other hand, transistors can be made small and cheaply, and the designer is encouraged to use transistors in preference to resistors wherever possible. As a result, the classical biasing arrangement, popular in discrete-circuit amplifier design, is abandoned in IC amplifiers in favor of biasing with constant-current sources implemented with transistors operating in the active mode. As well, the collector and drain resistors in amplifiers are replaced with constant-current sources that have much higher incremental resistance, thus providing larger gains.
2. Capacitors. Chip-area considerations also make it impossible to fabricate large-valued capacitors such as those employed for signal coupling and bypass in discrete-circuit amplifiers. As a result, IC amplifiers are all direct coupled and utilize clever techniques, which we will study in this chapter and the next.

Small-size capacitors, in the picofarad and fraction-of-a-picofarad range, are easy to fabricate in IC MOS technology. Such capacitors can be combined with MOS amplifiers and MOS switches to realize a wide variety of signal-processing functions, both analog (Chapter 17) and digital (Chapter 15).
3. Power Supplies. To pack a large number of devices on the same IC chip, and thus reduce system cost and increase reliability, the trend has been to reduce the device dimensions. (For a discussion of Moore's law and device scaling, see Section 14.5.) By 2014, CMOS process technologies capable of producing devices with a 14-nm channel length were in use. To avoid breaking down the thin oxide layers (less than 1 nm ) used in these devices, power supplies are limited to 1 V or so. Low power-supply voltages help with another major design challenge; namely, keeping the power dissipated in the chip within acceptable limits. However, the use of such low dc power-supply voltages presents the circuit designer with a host of challenges. For instance, MOS
transistors must be operated with overdrive voltages of only 0.1 V to 0.2 V . In our study of MOS amplifiers, we will frequently comment on such issues.
4. Device Variety. Unlike the designer of discrete circuits, who is limited to available off-the-shelf transistors, the IC designer has the freedom to specify the device dimensions and to utilize device matching and arrays of devices having dimensions with specified ratios. For instance, one can utilize an array of bipolar transistors whose emitter-base-junction areas have binary-weighted ratios. CMOS technology provides even more flexibility, with the $W$ and $L$ values of MOS transistors selected to fit a very wide range of design requirements.
5. Bipolar Technology. BJTs are still used in special analog applications, such as high-quality general-purpose op-amp packages that are intended for assembly on printed-circuit (PC) boards (as opposed to being part of a system-on-a-chip). Bipolar circuits can also be combined with CMOS circuits in innovative and exciting ways in what is known as BiCMOS technology.
6. CMOS Technology. Currently the vast majority of analog integrated circuits are designed using CMOS technology. This practice was initially motivated by the need to be compatible with digital circuits, which have become predominantly CMOS. Now, however, the richness and the versatility that CMOS provides the analog designer is an even stronger reason for its dominance. We hope that the reader will come to appreciate this point in Chapters 8 and 9.

SOLID CIRCUITS WITH "FLYING WIRES":

As the importance of transistors grew during the 1950s, packaging became a problem. While it was possible to create smaller and smaller active devices, individual transistor packages had to be large enough to be held in the assembly of an electronic system. As one solution to this problem, Texas Instruments (TI) initiated a program of package modular electronics in the creation, on a ceramic substrate, of larger, more functional system elements. Employed to work in this direction, Jack Kilby believed it was necessary to go one step further and design the multiplicity of active and passive elements on a single piece of semiconductor. Thus, in 1958 he created the first "solid circuit," incorporating many transistors and resistors formed on a single slab of germanium and coupled by "flying wire" interconnections to form system elements such as oscillators and amplifiers. In 1959 TI began to use this technique to manufacture the 507 Binary Flip-Flop. While the approach was successful in producing small space-efficient modules, it was not suited for mass production. In 2000 Kilby received the Nobel Prize in Physics, in recognition of his part in the invention of the integrated circuit.

# 8.2 IC Biasing-Current Sources, Current Mirrors, and Current-Steering Circuits 

Biasing in integrated-circuit design is based on the use of constant-current sources. On an IC chip with a number of amplifier stages, a constant dc current (called a reference current) is generated at one location and is then replicated at various other locations for biasing the various amplifier stages through a process known as current steering. This approach has the advantage that the effort expended on generating a predictable and stable reference current,usually utilizing a precision resistor external to the chip or a special circuit on the chip, need not be repeated for every amplifier stage. Furthermore, the bias currents of the various stages track each other in case of changes in power-supply voltage or in temperature.

In this section we study circuit building blocks and techniques employed in the bias design of IC amplifiers. These current-source circuits are also utilized as amplifier load elements, as will be seen in Sections 8.3 and 8.4.

# 8.2.1 The Basic MOSFET Current Source 

Figure 8.1 shows the circuit of a simple MOS constant-current source. The heart of the circuit is transistor $Q_{1}$, the drain of which is shorted to its gate, ${ }^{1}$ thereby forcing it to operate in the saturation mode with

$$
I_{D 1}=\frac{1}{2} k_{n}^{\prime}\left(\frac{W}{L}\right)_{1}\left(V_{G S}-V_{t n}\right)^{2}
$$

where we have neglected channel-length modulation. The drain current of $Q_{1}$ is supplied by $V_{D D}$ through resistor $R$, which in most cases would be outside the IC chip. Since the gate currents are zero,

$$
I_{D 1}=I_{\mathrm{REF}}=\frac{V_{D D}-V_{G S}}{R}
$$

where the current through $R$ is considered to be the reference current of the current source and is denoted $I_{\text {REF }}$. Equations (8.1) and (8.2) can be used to determine the value required for $R$.

Now consider transistor $Q_{2}$ : It has the same $V_{G S}$ as $Q_{1}$; thus, if we assume that it is operating in saturation, its drain current, which is the output current $I_{O}$ of the current source, will be

$$
I_{O}=I_{D 2}=\frac{1}{2} k_{n}^{\prime}\left(\frac{W}{L}\right)_{2}\left(V_{G S}-V_{t n}\right)^{2}
$$

where we have neglected channel-length modulation. Equations (8.1) and (8.3) enable us to relate the output current $I_{O}$ to the reference current $I_{\text {REF }}$ as follows:

$$
\frac{I_{O}}{I_{\mathrm{REF}}}=\frac{(W / L)_{2}}{(W / L)_{1}}
$$



Figure 8.1 Circuit for a basic MOSFET constantcurrent source. For proper operation, the output terminal, that is, the drain of $Q_{2}$, must be connected to a circuit that ensures that $Q_{2}$ operates in saturation.

[^0]
[^0]:    ${ }^{1}$ Such a transistor is said to be diode connected.


Figure 8.2 Basic MOSFET current mirror.

This is a simple and attractive relationship: The special connection of $Q_{1}$ and $Q_{2}$ provides an output current $I_{O}$ that is related to the reference current $I_{\mathrm{REF}}$ by the aspect ratios of the transistors. In other words, the relationship between $I_{O}$ and $I_{\mathrm{REF}}$ is solely determined by the geometries of the transistors. In the special case of identical transistors, $I_{O}=I_{\mathrm{REF}}$, and the circuit simply replicates or mirrors the reference current in the output terminal. This has given the circuit composed of $Q_{1}$ and $Q_{2}$ the name current mirror, a name that is used irrespective of the ratio of device dimensions.

Figure 8.2 depicts the current-mirror circuit with the input reference current shown as being supplied by a current source for both simplicity and generality. The current gain or current transfer ratio of the current mirror is given by Eq. (8.4).

Effect of $V_{O}$ on $I_{O}$ In the description above for the operation of the current source of Fig. 8.1, we assumed $Q_{2}$ to be operating in saturation. This is essential if $Q_{2}$ is to supply a constant-current output. To ensure that $Q_{2}$ is saturated, the circuit to which the drain of $Q_{2}$ is to be connected must establish a drain voltage $V_{O}$ that satisfies the relationship

$$
V_{O} \geq V_{G S}-V_{t n}
$$

or, equivalently, in terms of the overdrive voltage $V_{O V}$ of $Q_{1}$ and $Q_{2}$,

$$
V_{O} \geq V_{O V}
$$

In other words, the current source will operate properly with an output voltage $V_{O}$ as low as $V_{O V}$, which is a few tenths of a volt.

Although thus far neglected, channel-length modulation can have a significant effect on the operation of the current source. Consider, for simplicity, the case of identical devices $Q_{1}$ and $Q_{2}$. The drain current of $Q_{2}, I_{O}$, will equal the current in $Q_{1}, I_{\mathrm{REF}}$, at the value of $V_{O}$ that causes the two devices to have the same $V_{D S}$, that is, at $V_{O}=V_{G S}$. As $V_{O}$ is increased above this value, $I_{O}$ will increase according to the incremental output resistance $r_{o 2}$ of $Q_{2}$. This is illustrated in Fig. 8.3, which shows $I_{O}$ versus $V_{O}$. Observe that since $Q_{2}$ is operating at a constant $V_{G S}$ (determined by passing $I_{\mathrm{REF}}$ through the matched device $Q_{1}$ ), the curve in Fig. 8.3 is simply the $i_{D}-v_{D S}$ characteristic curve of $Q_{2}$ for $v_{G S}$ equal to the particular value $V_{G S}$.

In summary, the current source of Fig. 8.1 and the current mirror of Fig. 8.2 have a finite output resistance $R_{o}$,

$$
R_{o} \equiv \frac{\Delta V_{O}}{\Delta I_{O}}=r_{o 2}=\frac{V_{A 2}}{I_{O}}
$$


Figure 8.3 Output characteristic of the current source in Fig. 8.1 and the current mirror of Fig. 8.2 for the case of $Q_{2}$ matched to $Q_{1}$.
where $I_{O}$ is given by Eq. (8.3) and $V_{A 2}$ is the Early voltage of $Q_{2}$. Also, recall that for a given process technology, $V_{A}$ is proportional to the transistor channel length; thus, to obtain high output-resistance values, current sources are usually designed using transistors with relatively long channels. Finally, note that we can express the current $I_{O}$ as

$$
I_{O}=\frac{(W / L)_{2}}{(W / L)_{1}} I_{\mathrm{REF}}\left(1+\frac{V_{O}-V_{O S}}{V_{A 2}}\right)
$$

# Example 8.1 

Given $V_{D O}=3 \mathrm{~V}$ and using $I_{\mathrm{REF}}=100 \mu \mathrm{~A}$, design the circuit of Fig. 8.1 to obtain an output current whose nominal value is $100 \mu \mathrm{~A}$. Find $R$ if $Q_{1}$ and $Q_{2}$ are matched and have channel lengths of $1 \mu \mathrm{~m}$, channel widths of $10 \mu \mathrm{~m}, V_{s}=0.7 \mathrm{~V}$, and $k_{n}^{\prime}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$. What is the lowest possible value of $V_{O}$ ? Assuming that for this process technology, the Early voltage $V_{A}^{\prime}=20 \mathrm{~V} / \mu \mathrm{m}$, find the output resistance of the current source. Also, find the change in output current resulting from a $+1-\mathrm{V}$ change in $V_{O}$.

## Solution

$$
\begin{gathered}
I_{D 1}=I_{\mathrm{REF}}=\frac{1}{2} k_{n}^{\prime}\left(\frac{W}{L}\right)_{1} V_{O V}^{2} \\
100=\frac{1}{2} \times 200 \times 10 V_{O V}^{2}
\end{gathered}
$$

Thus,

$$
V_{O V}=0.316 \mathrm{~V}
$$
and

$$
\begin{aligned}
V_{G S} & =V_{i}+V_{O V}=0.7+.316 \simeq 1 \mathrm{~V} \\
R & =\frac{V_{D D}-V_{G S}}{I_{\mathrm{REF}}}=\frac{3-1}{0.1 \mathrm{~mA}}=20 \mathrm{k} \Omega \\
V_{\text {Omin }} & =V_{O V} \simeq 0.3 \mathrm{~V}
\end{aligned}
$$

For the transistors used, $L=1 \mu \mathrm{~m}$. Thus,

$$
\begin{aligned}
V_{\mathrm{A}} & =20 \times 1=20 \mathrm{~V} \\
r_{e 2} & =\frac{20 \mathrm{~V}}{100 \mu \mathrm{~A}}=0.2 \mathrm{M} \Omega
\end{aligned}
$$

The output current will be $100 \mu \mathrm{~A}$ at $V_{O}=V_{G S}=1 \mathrm{~V}$. If $V_{O}$ changes by +1 V , the corresponding change in $I_{O}$ will be

$$
\Delta I_{O}=\frac{\Delta V_{O}}{r_{e 2}}=\frac{1 \mathrm{~V}}{0.2 \mathrm{M} \Omega}=5 \mu \mathrm{~A}
$$

# EXERCISE 

D8.1 In the current source of Example 8.1, it is required to reduce the change in output current, $\Delta I_{O}$, corresponding to a change in output voltage, $\Delta V_{O}$, of 1 V to $1 \%$ of $I_{O}$. What should the dimensions of $Q_{1}$ and $Q_{2}$ be changed to? Assume that $Q_{1}$ and $Q_{2}$ are to remain matched.
Ans. $L=5 \mu \mathrm{~m} ; W=50 \mu \mathrm{~m}$

### 8.2.2 MOS Current-Steering Circuits

As mentioned earlier, once a constant current has been generated, it can be replicated to provide dc bias or load currents for the various amplifier stages in an IC. Current mirrors can obviously be used to implement this current-steering function. Figure 8.4 shows a simple current-steering circuit. Here $Q_{1}$ together with $R$ determine the reference current $I_{\text {REF }}$. Transistors $Q_{1}, Q_{2}$, and $Q_{3}$ form a two-output current mirror,

$$
\begin{aligned}
& I_{2}=I_{\mathrm{REF}} \frac{(W / L)_{2}}{(W / L)_{1}} \\
& I_{3}=I_{\mathrm{REF}} \frac{(W / L)_{3}}{(W / L)_{1}}
\end{aligned}
$$


Figure 8.4 A current-steering circuit.

To ensure operation in the saturation region, the voltages at the drains of $Q_{2}$ and $Q_{3}$ are constrained as follows:

$$
V_{D 2}, V_{D 3} \geq-V_{S S}+V_{G S 1}-V_{t n}
$$

or, equivalently,

$$
V_{D 2}, V_{D 3} \geq-V_{S S}+V_{O V 1}
$$

where $V_{O V 1}$ is the overdrive voltage at which $Q_{1}, Q_{2}$, and $Q_{3}$ are operating. In other words, the drains of $Q_{2}$ and $Q_{3}$ will have to remain higher than $-V_{S S}$ by at least the overdrive voltage, which is usually a few tenths of a volt.

Continuing our discussion of the circuit in Fig. 8.4, we see that current $I_{3}$ is fed to the input side of a current mirror formed by PMOS transistors $Q_{4}$ and $Q_{5}$. This mirror provides

$$
I_{5}=I_{4} \frac{(W / L)_{5}}{(W / L)_{4}}
$$

where $I_{4}=I_{3}$. To keep $Q_{5}$ in saturation, its drain voltage should be

$$
V_{D 5} \leq V_{D D}-\left|V_{O V 5}\right|
$$

where $V_{O V 5}$ is the overdrive voltage at which $Q_{5}$ is operating.
The constant current $I_{2}$ generated in the circuit of Fig. 8.4 can be used to bias a source-follower amplifier such as that implemented by transistor $Q_{6}$ in Fig. 8.5(a). Similarly, the constant current $I_{5}$ can be used as the load for a common-source amplifier such as that implemented with transistor $Q_{7}$ in Fig. 8.5(b). We will discuss the use of current sources as load elements for CS amplifiers in Section 8.3.

Finally, an important point to note is that in the circuit of Fig. 8.4, while $Q_{2}$ pulls its current $I_{2}$ from a circuit (not shown in Fig. 8.4), $Q_{5}$ pushes its current $I_{5}$ into a circuit (not shown in Fig. 8.4). Thus $Q_{5}$ is appropriately called a current source, whereas $Q_{2}$ should more properly be called a current sink. In an IC, both current sources and current sinks are usually needed. The difference between a current source and a current sink is further illustrated in Fig. 8.6, where $V_{C S \text { min }}$ denotes the minimum voltage needed across the current source (or sink) for its proper operation.


Figure 8.5 Application of the constant currents $I_{2}$ and $I_{5}$ generated in the current-steering circuit of Fig. 8.4. Constant-current $I_{2}$ is the bias current for the source follower $Q_{6}$, and constant-current $I_{5}$ is the load current for the common-source amplifier $Q_{7}$.


Figure 8.6 (a) A current source; and (b) a current sink.

# EXERCISE 

D8.2 For the circuit of Fig. 8.4, let $V_{D D}=V_{S S}=1.5 \mathrm{~V}, V_{r e}=0.6 \mathrm{~V}, V_{t p}=-0.6 \mathrm{~V}$, all channel lengths $=1 \mu \mathrm{~m}$, $k_{b}^{\prime}=200 \mu \mathrm{~A} / \mathrm{V}^{2}, k_{b}^{\prime}=80 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $\lambda=0$. For $I_{B E F}=10 \mu \mathrm{~A}$, find the widths of all transistors to obtain $I_{2}=60 \mu \mathrm{~A}, I_{3}=20 \mu \mathrm{~A}$, and $I_{5}=80 \mu \mathrm{~A}$. It is further required that the voltage at the drain of $Q_{2}$ be allowed to go down to within 0.2 V of the negative supply and that the voltage at the drain of $Q_{5}$ be allowed to go up to within 0.2 V of the positive supply.
Ans. $W_{1}=2.5 \mu \mathrm{~m} ; W_{2}=15 \mu \mathrm{~m} ; W_{3}=5 \mu \mathrm{~m} ; W_{4}=12.5 \mu \mathrm{~m} ; W_{5}=50 \mu \mathrm{~m}$


Figure 8.7 The basic BJT current mirror.

# 8.2.3 BJT Circuits 

The basic BJT current mirror is shown in Fig. 8.7. It works in a fashion very similar to that of the MOS mirror. However, there are two important differences: First, the nonzero base current of the BJT (or, equivalently, the finite $\beta$ ) causes an error in the current transfer ratio of the bipolar mirror. Second, the current transfer ratio is determined by the relative areas of the emitter-base junctions of $Q_{1}$ and $Q_{2}$.

Let us first consider the case of $\beta$ sufficiently high that we can neglect the base currents. The reference current $I_{\mathrm{REF}}$ is passed through the diode-connected transistor $Q_{1}$ and thus establishes a corresponding voltage $V_{B E}$, which in turn is applied between base and emitter of $Q_{2}$. Now, if $Q_{2}$ is matched to $Q_{1}$ or, more specifically, if the EBJ area of $Q_{2}$ is the same as that of $Q_{1}$, and thus $Q_{2}$ has the same scale current $I_{S}$ as $Q_{1}$, then the collector current of $Q_{2}$ will be equal to that of $Q_{1}$; that is,

$$
I_{O}=I_{\mathrm{REF}}
$$

For this to happen, however, $Q_{2}$ must be operating in the active mode, which in turn is achieved as long as the collector voltage $V_{O}$ is 0.3 V or so higher than that of the emitter.

To obtain a current transfer ratio other than unity, say $m$, we simply arrange that the area of the EBJ of $Q_{2}$ is $m$ times that of $Q_{1}$. In this case,

$$
I_{O}=m I_{\mathrm{REF}}
$$

In general, the current transfer ratio is given by

$$
\frac{I_{O}}{I_{\mathrm{REF}}}=\frac{I_{S 2}}{I_{S 1}}=\frac{\text { Area of EBJ of } Q_{2}}{\text { Area of EBJ of } Q_{1}}
$$

Alternatively, if the area ratio $m$ is an integer, one can think of $Q_{2}$ as equivalent to $m$ transistors, each matched to $Q_{1}$ and connected in parallel.

Next we consider the effect of finite transistor $\beta$ on the current transfer ratio. The analysis for the case in which the current transfer ratio is nominally unity-that is, for the case in which $Q_{2}$ is matched to $Q_{1}$-is illustrated in Fig. 8.8. The key point here is that since $Q_{1}$ and $Q_{2}$ are matched and have the same $V_{B E}$, their collector currents will be equal. The rest of the analysis is straightforward. A node equation at the collector of $Q_{1}$ yields

$$
I_{\mathrm{REF}}=I_{C}+2 I_{C} / \beta=I_{C}\left(1+\frac{2}{\beta}\right)
$$


Figure 8.8 Analysis of the current mirror taking into account the finite $\beta$ of the BJTs.

Finally, since $I_{O}=I_{C}$, the current transfer ratio can be found as

$$
\frac{I_{O}}{I_{\mathrm{REF}}}=\frac{I_{C}}{I_{C}\left(1+\frac{2}{\beta}\right)}=\frac{1}{1+\frac{2}{\beta}}
$$

Note that as $\beta$ approaches $\infty, I_{O} / I_{\text {REF }}$ approaches the nominal value of unity. For typical values of $\beta$, however, the error in the current transfer ratio can be significant. For instance, $\beta=100$ results in a $2 \%$ error in the current transfer ratio. Furthermore, the error due to the finite $\beta$ increases as the nominal current transfer ratio is increased. The reader is encouraged to show that for a mirror with a nominal current transfer ratio $m$-that is, one in which $I_{S 2}=m I_{S 1}$-the actual current transfer ratio is given by

$$
\frac{I_{O}}{I_{\mathrm{REF}}}=\frac{m}{1+\frac{m+1}{\beta}}
$$

In common with the MOS current mirror, the BJT mirror has a finite output resistance $R_{o}$,

$$
R_{o} \equiv \frac{\Delta V_{O}}{\Delta I_{O}}=r_{o 2}=\frac{V_{A 2}}{I_{O}}
$$

where $V_{A 2}$ and $r_{o 2}$ are the Early voltage and the output resistance, respectively, of $Q_{2}$. Thus, even if we neglect the error due to finite $\beta$, the output current $I_{O}$ will be at its nominal value only when $Q_{2}$ has the same $V_{C E}$ as $Q_{1}$, namely, at $V_{O}=V_{B E}$. As $V_{O}$ is increased, $I_{O}$ will correspondingly increase. Taking both the finite $\beta$ and the finite $R_{o}$ into account, we can express the output current of a BJT mirror with a nominal current transfer ratio $m$ as

$$
I_{O}=I_{\mathrm{REF}} \frac{m}{1+\frac{m+1}{\beta}}\left(1+\frac{V_{O}-V_{B E}}{V_{A 2}}\right)
$$

where we note that the error term due to the Early effect is expressed in a form that shows that it reduces to zero for $V_{O}=V_{B E}$.
# EXERCISE 

8.3 Consider a BJT current mirror with a nominal current transfer ratio of unity. Let the transistors have $I_{S}=10^{-15} \mathrm{~A}, \beta=100$, and $V_{A}=100 \mathrm{~V}$. For $I_{\mathrm{REF}}=1 \mathrm{~mA}$, find $I_{O}$ when $V_{O}=5 \mathrm{~V}$. Also, find the output resistance.
Ans. $1.02 \mathrm{~mA} ; 100 \mathrm{k} \Omega$

A Simple Current Source In a manner analogous to that in the MOS case, the basic BJT current mirror can be used to implement a simple current source, as shown in Fig. 8.9. Here the reference current is

$$
I_{\mathrm{REF}}=\frac{V_{C C}-V_{B E}}{R}
$$

where $V_{B E}$ is the base-emitter voltage corresponding to the desired value of $I_{\mathrm{REF}}$. The output current $I_{O}$ is given by

$$
I_{O}=\frac{I_{\mathrm{REF}}}{1+(2 / \beta)}\left(1+\frac{V_{O}-V_{B E}}{V_{A}}\right)
$$

The output resistance of this current source is $r_{o}$ of $Q_{2}$,

$$
R_{o}=r_{o 2} \simeq \frac{V_{A}}{I_{O}} \simeq \frac{V_{A}}{I_{\mathrm{REF}}}
$$



Figure 8.9 A simple BJT current source.

## EXERCISE

D8.4 Assuming the availability of BJTs with scale currents $I_{S}=10^{-15} \mathrm{~A}, \beta=100$, and $V_{A}=50 \mathrm{~V}$, design the current-source circuit of Fig. 8.9 to provide an output current $I_{O}=0.5 \mathrm{~mA}$ at $V_{O}=2 \mathrm{~V}$. The power supply $V_{C C}=5 \mathrm{~V}$. Give the values of $I_{\mathrm{REF}}, R$, and $V_{O \min }$. Also, find $I_{O}$ at $V_{O}=5 \mathrm{~V}$. Ans. $0.497 \mathrm{~mA} ; 8.71 \mathrm{k} \Omega ; 0.3 \mathrm{~V} ; 0.53 \mathrm{~mA}$


Figure 8.10 Generation of a number of constant currents of various magnitudes.

Current Steering To generate bias currents for different amplifier stages in an IC, the current-steering approach described for MOS circuits can be applied in the bipolar case. As an example, consider the circuit shown in Fig. 8.10. The dc reference current $I_{\text {REF }}$ is generated in the branch that consists of the diode-connected transistor $Q_{1}$, resistor $R$, and the diode-connected transistor $Q_{2}$ :

$$
I_{\mathrm{REF}}=\frac{V_{C C}+V_{E E}-V_{E B 1}-V_{B E 2}}{R}
$$

Now, for simplicity, assume that all the transistors have high $\beta$ and thus that the base currents are negligibly small. We will also neglect the Early effect. The diode-connected transistor $Q_{1}$ forms a current mirror with $Q_{3}$; thus $Q_{3}$ will supply a constant current $I_{1}$ equal to $I_{\text {REF }}$. Transistor $Q_{3}$ can supply this current to any load as long as the voltage that develops at the collector does not exceed $\left(V_{C C}-0.3 \mathrm{~V}\right)$; otherwise $Q_{3}$ would enter the saturation region.

To generate a dc current twice the value of $I_{\text {REF }}$, two transistors, $Q_{5}$ and $Q_{6}$, each of which is matched to $Q_{1}$, are connected in parallel, and the combination forms a mirror with $Q_{1}$. Thus $I_{3}=2 I_{\text {REF }}$. Note that the parallel combination of $Q_{5}$ and $Q_{6}$ is equivalent to a transistor with an EBJ area double that of $Q_{1}$, which is precisely what is done when this circuit is fabricated in IC form.

Transistor $Q_{4}$ forms a mirror with $Q_{2}$; thus $Q_{4}$ provides a constant current $I_{2}$ equal to $I_{\text {REF }}$. Note that while $Q_{3}$ sources its current to parts of the circuit whose voltage should not exceed $\left(V_{C C}-0.3 \mathrm{~V}\right), Q_{4}$ sinks its current from parts of the circuit whose voltage should not decrease below $\left(-V_{E E}+0.3 \mathrm{~V}\right)$. Finally, to generate a current three times $I_{\mathrm{REF}}$, three transistors, $Q_{7}$, $Q_{8}$, and $Q_{9}$, each of which is matched to $Q_{2}$, are connected in parallel, and the combination is placed in a mirror configuration with $Q_{2}$. Again, in an IC implementation, $Q_{7}, Q_{8}$, and $Q_{9}$ would be replaced with a transistor having a junction area three times that of $Q_{2}$.# EXERCISE 

8.5 Figure E8.5 shows an $N$-output current mirror. Assuming that all transistors are matched and have finite $\beta$ and ignoring the effect of finite output resistances, show that

$$
I_{1}=I_{2}=\cdots=I_{N}=\frac{I_{\mathrm{REF}}}{1+(N+1) / \beta}
$$

For $\beta=100$, find the maximum number of outputs for an error not exceeding $10 \%$.


Figure E8.5
Ans. 9

A Bipolar Mirror with Base-Current Compensation Figure 8.11 shows a bipolar current mirror with a current transfer ratio that is much less dependent on $\beta$ than that of the simple current mirror. The reduced dependence on $\beta$ is achieved by including transistor $Q_{3}$, the emitter of which supplies the base currents of $Q_{1}$ and $Q_{2}$. The sum of the base currents is then divided by $\left(\beta_{3}+1\right)$, resulting in a much smaller error current that has to be supplied by $I_{\text {REF }}$. Detailed analysis is shown on the circuit diagram; it is based on the assumption that $Q_{1}$ and $Q_{2}$ are matched and thus have equal collector currents, $I_{C}$. A node equation at the node labeled $x$ gives

$$
I_{\mathrm{REF}}=I_{C}\left[1+\frac{2}{\beta(\beta+1)}\right]
$$

Since

$$
I_{O}=I_{C}
$$


Figure 8.11 A current mirror with base-current compensation.
the current transfer ratio of the mirror will be

$$
\begin{aligned}
\frac{I_{O}}{I_{\mathrm{REF}}} & =\frac{1}{1+2 /\left(\beta^{2}+\beta\right)} \\
& \simeq \frac{1}{1+2 / \beta^{2}}
\end{aligned}
$$

which means that the error due to finite $\beta$ has been reduced from $2 / \beta$ in the simple mirror to $2 / \beta^{2}$, a tremendous improvement. Unfortunately, however, the output resistance remains approximately equal to that of the simple mirror, namely $r_{o}$. Finally, note that if a reference current $I_{\mathrm{REF}}$ is not available, we simply connect node $x$ to the power supply, $V_{C C}$, through a resistance $R$. The result is a reference current given by

$$
I_{\mathrm{REF}}=\frac{V_{C C}-V_{B E 1}-V_{B E 3}}{R}
$$

# 8.2.4 Small-Signal Operation of Current Mirrors 

In addition to their use in biasing, current mirrors are sometimes employed as current amplifiers. It is therefore useful to derive the small-signal parameters of the current mirror, that is, $R_{\mathrm{in}}, A_{i s}$, and $R_{o}$.

Figure 8.12(a) shows a MOS current mirror biased with a dc input current $I_{D 1}$ and fed with a small-signal input current $i_{i}$. Note that $V_{G S}$ and $I_{D 2}$ are the resulting dc quantities, while $v_{g s}$ and $i_{o}$ are signal quantities. Although we are not showing the circuit to which the output terminal is connected, we are assuming that the voltage at the drain of $Q_{2}$ exceeds the minimum required to keep $Q_{2}$ in saturation.

Replacing $Q_{1}$ and $Q_{2}$ with their small-signal models results in the circuit in Fig. 8.12(b). Observe that the controlled current source $g_{m 1} v_{g s}$ appears across its control voltage $v_{g s}$ and thus can be replaced by a resistance, $1 / g_{m 1}$, as shown in Fig. 8.12(c). For the latter circuit we can obtain

$$
\begin{aligned}
R_{\mathrm{in}} & =r_{o 1} \| \frac{1}{g_{m 1}} \simeq \frac{1}{g_{m 1}} \\
R_{o} & =r_{o 2} \\
A_{i s} \equiv \frac{i_{o}}{i_{i}} v_{g 2}=0 & =\frac{g_{m 2} v_{g s}}{i_{i}} \simeq \frac{g_{m 2} i_{i} / g_{m 1}}{i_{i}}
\end{aligned}
$$


Figure 8.12 Obtaining the small-signal parameters of the MOS current mirror as a current amplifier.

Thus,

$$
A_{i s}=\frac{g_{m 2}}{g_{m 1}}
$$

Substituting for $g_{m 1,2}=\mu_{n} C_{o s}(W / L)_{1,2} V_{O V}$, where $V_{O V}$ is the overdrive voltage at which $Q_{1}$ and $Q_{2}$ are operating, yields for the short-circuit current gain

$$
A_{i s}=\frac{(W / L)_{2}}{(W / L)_{1}}
$$

which is equal to the dc or large-signal current transfer function-a clear indication of the excellent linearity of the current mirror.

We conclude that the current mirror is an excellent current amplifier: It has a relatively low input resistance $\left(1 / g_{m 1}\right)$, a relatively high output resistance $\left(r_{o 2}\right)$, and a gain determined
by the aspect ratios of the MOSFETs. Finally, a similar development can be used to obtain the small-signal parameters of the bipolar mirror.

# EXERCISE 

D8.6 The MOSFETs in the current mirror of Fig. 8.12(a) have equal channel lengths, $\mu_{n} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $V_{A}^{\prime}=20 \mathrm{~V} / \mu \mathrm{m}$. If the input bias current is $100 \mu \mathrm{~A}$, find $W_{1}, W_{2}, L_{1}$, and $L_{2}$ to obtain a short-circuit current gain of 5 , an input resistance of $1 \mathrm{k} \Omega$, and an output resistance of $40 \mathrm{k} \Omega$.
Ans. $12.5 \mu \mathrm{~m} ; 62.5 \mu \mathrm{~m} ; 1 \mu \mathrm{~m}$; and $1 \mu \mathrm{~m}$

## THE INTEGRATED CIRCUIT:

In 1959, at the same time that Kilby and TI applied for a patent on "miniaturized electronic circuits," Robert Noyce (a cofounder of Fairchild Semiconductor and later of Intel) filed a patent on the "monolithic silicon-based integrated circuit." He later acknowledged the critical importance of Kurt Lehovac's idea of using reverse-biased junctions to isolate multiple devices on a single die. Lehovac, of Sprague Electric Company, also filed a patent in 1959. Regrettably, Noyce, who died in 1990, did not live to share in the Nobel Prize with Kilby.

### 8.3 The Basic Gain Cell

### 8.3.1 The CS and CE Amplifiers with Current-Source Loads

The basic gain cell in an IC amplifier is a common-source (CS) or common-emitter (CE) transistor loaded with a constant-current source, as shown in Fig. 8.13(a) and (b). These circuits are similar to the CS and CE amplifiers studied in Section 7.3, except that here we have replaced the resistances $R_{D}$ and $R_{C}$ with constant-current sources. This is done for two reasons: First, as mentioned in Section 8.1, it is difficult in IC technology to implement resistances with reasonably precise values; rather, it is much easier to use current sources, which are implemented using transistors. Second, by using a constant-current source we are in effect operating the CS and CE amplifiers with a very high (ideally infinite) load resistance; thus we can obtain a much higher gain than if a finite $R_{D}$ or $R_{C}$ is used. This is particularly the case because, even if passive resistances were available, they would have very small values because the dc power supplies are now limited to only 1 V to 2 V . These voltages, however, do allow the use of current sources that have large output resistances. The circuits in Fig. 8.13(a) and (b) are said to be current-source loaded or active loaded.

Before we consider the small-signal analysis of the active-loaded CS and CE amplifiers, a word on their dc bias is in order. Obviously, in each circuit $Q_{1}$ is biased at $I_{D}=I$ and $I_{C}=I$. But what determines the dc voltages at the drain (collector) and at the gate (base)? Usually, these gain cells will be part of larger circuits in which negative feedback is utilized to fix the values of $V_{D S}$ and $V_{G S}\left(V_{C E}\right.$ and $\left.V_{B E}\right)$. In the next chapter we will begin to see complete IC amplifiers including biasing. For the time being, however, we shall assume that the MOS transistor in


Figure 8.13 The basic gain cells of IC amplifiers: (a) current-source- or active-loaded common-source amplifier; (b) current-source- or active-loaded common-emitter amplifier; (c) small-signal equivalent circuit of (a); and (d) small-signal equivalent circuit of (b).

Fig. 8.13(a) is biased to operate in the saturation region and that the BJT in Fig. 8.13(b) is biased to operate in the active region. We will often refer to both the MOSFET and the BJT as operating in the "active region."

Small-signal analysis of the current-source-loaded CS and CE amplifiers can be performed by utilizing their equivalent-circuit models, shown respectively in Fig. 8.13(c) and (d). Observe that since the current-source load is assumed to be ideal, it is represented in the models by an infinite resistance. Practical current sources have finite output resistance, as we have seen in the previous section. For the time being, however, note that the CS and CE amplifiers of Fig. 8.13 are in effect operating in an open-circuit fashion. The only resistance between their output node and ground is the output resistance of the transistor itself, $r_{o}$. Thus the voltage gain obtained in these circuits is the maximum possible for a CS or a CE amplifier.

From Fig. 8.13(c) we obtain for the active-loaded CS amplifier:

$$
\begin{aligned}
R_{\mathrm{in}} & =\infty \\
A_{v o} & =-g_{m} r_{o} \\
R_{o} & =r_{o}
\end{aligned}
$$
Similarly, from Fig. 8.13(d) we obtain for the active-loaded CE amplifier:

$$
\begin{aligned}
R_{i n} & =r_{\pi} \\
A_{v o} & =-g_{m} r_{o} \\
R_{o} & =r_{o}
\end{aligned}
$$

Thus both circuits realize a voltage gain of magnitude $g_{m} r_{o}$. Since this is the maximum gain obtainable in a CS or CE amplifier, we refer to it as the intrinsic gain and give it the symbol $A_{0}$. Furthermore, it is useful to examine the nature of $A_{0}$ in a little more detail.

# 8.3.2 The Intrinsic Gain 

For the BJT, we can derive a formula for the intrinsic gain $A_{0}=g_{m} r_{o}$ by using the following formulas for $g_{m}$ and $r_{o}$ :

$$
\begin{aligned}
g_{m} & =\frac{I_{C}}{V_{T}} \\
r_{o} & =\frac{V_{A}}{I_{C}}
\end{aligned}
$$

The result is

$$
A_{0}=g_{m} r_{o}=\frac{V_{A}}{V_{T}}
$$

Thus $A_{0}$ is simply the ratio of the Early voltage $V_{A}$, which is a technology-determined parameter, and the thermal voltage $V_{T}$, which is a physical parameter (approximately 0.025 V at room temperature). The value of $V_{A}$ ranges from 5 V to 35 V for modern IC fabrication processes to 100 V to 130 V for the older, so-called high-voltage processes (see Appendix G). As a result, the value of $A_{0}$ will be in the range of $200 \mathrm{~V} / \mathrm{V}$ to $5000 \mathrm{~V} / \mathrm{V}$, with the lower values characteristic of modern small-feature-size devices. It is important to note that for a given bipolar-transistor fabrication process, $A_{0}$ is independent of the transistor junction area and of its bias current. This is not the case for the MOSFET, as we shall now see.

Recall from our study of the MOSFET $g_{m}$ in Section 7.2 that there are three possible expressions for $g_{m}$. Two of these are particularly useful for our purposes here:

$$
\begin{aligned}
g_{m} & =\frac{I_{D}}{V_{O V} / 2} \\
g_{m} & =\sqrt{2 \mu_{n} C_{o s}(W / L) \sqrt{1_{D}}}
\end{aligned}
$$

For the MOSFET $r_{o}$ we have

$$
r_{o}=\frac{V_{A}}{I_{D}}=\frac{V_{A}^{\prime} L}{I_{D}}
$$

where $V_{A}$ is the Early voltage and $V_{A}^{\prime}$ is the technology-dependent component of the Early voltage. Utilizing each of the $g_{m}$ expressions together with the expression for $r_{o}$, we obtain for $A_{0}$,

$$
A_{0}=\frac{V_{A}}{V_{O V} / 2}
$$

which can be expressed in the alternate forms

$$
A_{0}=\frac{2 V_{A}^{\prime} L}{V_{O V}}
$$
and

$$
A_{0}=\frac{V_{A}^{\prime} \sqrt{2\left(\mu_{u} C_{o v}\right)(W L)}}{\sqrt{I_{D}}}
$$

The expression in Eq. (8.44) is the one most directly comparable to that of the BJT (Eq. 8.40). Here, however, we note the following:

1. The quantity in the denominator is $V_{O V} / 2$, which is a design parameter. Although the value of $V_{O V}$ that designers use for modern submicron technologies has been steadily decreasing, it is still about 0.15 V to 0.3 V . Thus $V_{O V} / 2$ is 0.075 V to 0.15 V , which is 3 to 6 times higher than $V_{T}$. Furthermore, there are reasons for selecting higher values for $V_{O V}$ (to be discussed in later chapters).
2. The numerator quantity is both process dependent (through $V_{A}^{\prime}$ ) and device dependent (through $L$ ), and its value has been steadily decreasing with the scaling down of the technology (see Appendix K).
3. From Eq. (8.45) we see that for a given technology (i.e., a given value of $V_{A}^{\prime}$ ) the intrinsic gain $A_{0}$ can be increased by using a longer MOSFET and operating it at a lower $V_{O V}$. As usual, however, there are design trade-offs. For instance, we will see in Chapter 10 that increasing $L$ and lowering $V_{O V}$ result, independently, in decreasing the amplifier bandwidth.

As a result, the intrinsic gain realized in a MOSFET fabricated in a modern short-channel technology is only $10 \mathrm{~V} / \mathrm{V}$ to $40 \mathrm{~V} / \mathrm{V}$, an order of magnitude lower than that for a BJT.

The alternative expression for the MOSFET $A_{0}$ given in Eq. (8.46) reveals a very interesting fact: For a given process technology ( $V_{A}^{\prime}$ and $\mu_{u} C_{o v}$ ) and a given device ( $W$ and $L$ ), the intrinsic gain is inversely proportional to $\sqrt{I_{D}}$. This is illustrated in Fig. 8.14, which shows a typical plot for $A_{0}$ versus the bias current $I_{D}$. The plot confirms that the gain increases as the bias current is lowered. The gain, however, levels off at very low currents. This is because the MOSFET enters the subthreshold region of operation (Section 5.1.9), where it becomes very much like a BJT with an exponential current-voltage characteristic. The intrinsic gain then becomes constant, just like that of a BJT. Note, however, that although higher gain is


Figure 8.14 The intrinsic gain of the MOSFET versus bias current $I_{D}$. Outside the subthreshold region, this is a plot of $A_{0}=V_{A}^{\prime} \sqrt{2 \mu_{u} C_{o v} W L / I_{D}}$ for the case: $\mu_{u} C_{o v}=20 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{A}^{\prime}=20 \mathrm{~V} / \mu \mathrm{m}, L=2 \mu \mathrm{~m}$, and $W=20 \mu \mathrm{~m}$.
obtained at lower values of $I_{D}$, the price paid is a lower $g_{m}$ (Eq. 8.42) and less ability to drive capacitive loads, and thus a decrease in bandwidth. This point will be studied in Chapter 10.

# Example 8.2 

We wish to compare the values of $g_{m}, R_{\mathrm{in}}, R_{o}$, and $A_{0}$ for a CS amplifier that is designed using an NMOS transistor with $L=0.4 \mu \mathrm{~m}$ and $W=4 \mu \mathrm{~m}$ and fabricated in a $0.25-\mu \mathrm{m}$ technology specified to have $\mu_{\mathrm{a}} C_{o s}=267 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{A}^{\prime}=10 \mathrm{~V} / \mu \mathrm{m}$, with those for a CE amplifier designed using a BJT fabricated in a process with $\beta=100$ and $V_{A}=10 \mathrm{~V}$. Assume that both devices are operating at a drain (collector) current of $100 \mu \mathrm{~A}$.

## Solution

For simplicity, we shall neglect the Early effect in the MOSFET in determining $V_{o v}$; thus,

$$
\begin{aligned}
I_{D} & =\frac{1}{2}\left(\mu_{\mathrm{a}} C_{o s}\right)\left(\frac{W}{L}\right) V_{o v}^{2} \\
100 & =\frac{1}{2} \times 267 \times\left(\frac{4}{0.4}\right) V_{o v}^{2}
\end{aligned}
$$

resulting in

$$
\begin{aligned}
V_{o v} & =0.27 \mathrm{~V} \\
g_{m} & =\frac{2 I_{D}}{V_{o v}}=\frac{2 \times 0.1}{0.27}=0.74 \mathrm{~mA} / \mathrm{V} \\
R_{\mathrm{in}} & =\infty \\
r_{o} & =\frac{V_{A}^{\prime} L}{I_{D}}=\frac{10 \times 0.4}{0.1}=40 \mathrm{k} \Omega \\
R_{o} & =r_{o}=40 \mathrm{k} \Omega \\
A_{0} & =g_{m} r_{o}=0.74 \times 40=29.6 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

For the CE amplifier we have

$$
\begin{aligned}
& g_{m}=\frac{I_{C}}{V_{T}}=\frac{0.1 \mathrm{~mA}}{0.025 \mathrm{~V}}=4 \mathrm{~mA} / \mathrm{V} \\
& R_{\mathrm{in}}=r_{\pi}=\frac{\beta}{g_{m}}=\frac{100}{4}=25 \mathrm{k} \Omega \\
& r_{o}=\frac{V_{A}}{I_{C}}=\frac{10}{0.1}=100 \mathrm{k} \Omega \\
& R_{o}=r_{o}=100 \mathrm{k} \Omega \\
& A_{0}=g_{m} r_{o}=4 \times 100=400 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$
# EXERCISE 

8.7 A CS amplifier utilizes an NMOS transistor with $L=0.36 \mu \mathrm{~m}$ and $W / L=10$; it was fabricated in a $0.18-\mu \mathrm{m}$ CMOS process for which $\mu_{n} C_{o s}=387 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{A}^{2}=5 \mathrm{~V} / \mu \mathrm{m}$. Find the values of $g_{m}$ and $A_{0}$ obtained at $I_{D}=10 \mu \mathrm{~A}, 100 \mu \mathrm{~A}$, and 1 mA .
Ans. $0.28 \mathrm{~mA} / \mathrm{V}, 50 \mathrm{~V} / \mathrm{V} ; 0.88 \mathrm{~mA} / \mathrm{V}, 15.8 \mathrm{~V} / \mathrm{V} ; 2.78 \mathrm{~mA} / \mathrm{V}, 5 \mathrm{~V} / \mathrm{V}$

### 8.3.3 Effect of the Output Resistance of the Current-Source Load

The current-source load of the CS amplifier in Fig. 8.13(a) can be implemented using a PMOS transistor biased in the saturation region to provide the required current $I$, as shown in Fig. 8.15(a). We can use the large-signal MOSFET model (Section 5.2, Fig. 5.18) to model


Figure 8.15 (a) The CS amplifier with the current-source load implemented with a $p$-channel MOSFET $Q_{2}$; (b) the circuit with $Q_{2}$ replaced with its large-signal model; and (c) small-signal equivalent circuit of the amplifier.
$Q_{2}$ as shown in Fig. 8.15(b), where

$$
I=\frac{1}{2}\left(\mu_{\varphi} C_{o s}\right)\left(\frac{W}{L}\right)_{2}\left[V_{D D}-V_{G}-\left|V_{t p}\right|\right]^{2}
$$

and

$$
r_{o 2}=\frac{\left|V_{A 2}\right|}{I}
$$

Thus the current-source load no longer has an infinite resistance; rather, it has a finite output resistance $r_{o 2}$. This resistance will in effect appear in parallel with $r_{o 1}$, as shown in the amplifier equivalent-circuit model in Fig. 8.15(c), from which we obtain

$$
A_{v} \equiv \frac{v_{o}}{v_{i}}=-g_{m 1}\left(r_{o 1} \| r_{o 2}\right)
$$

Thus, not surprisingly, the finite output resistance of the current-source load reduces the magnitude of the voltage gain from $\left(g_{m 1} r_{o 1}\right)$ to $g_{m 1}\left(r_{o 1} \| r_{o 2}\right)$. This reduction can be substantial. For instance, if $Q_{2}$ has an Early voltage equal to that of $Q_{1}, r_{o 2}=r_{o 1}$ and the gain is reduced by half,

$$
A_{v}=-\frac{1}{2} g_{m} r_{o}
$$

Finally, we note that a similar development can be used for the bipolar case.

# Example 8.3 

A practical circuit implementation of the common-source amplifier is shown in Fig. 8.16(a). Here the current-source transistor $Q_{1}$ is the output transistor of a current mirror formed by $Q_{2}$ and $Q_{3}$ and fed with a reference current $I_{\text {REF }}$. The NMOS version of this current source was studied in Section 8.1. Assume that $Q_{2}$ and $Q_{3}$ are matched. To be able to clearly see the region of $v_{I}$ over which the circuit operates as an almost-linear amplifier, determine the voltage-transfer characteristic (VTC), that is, $v_{O}$ versus $v_{I}$.

(a)

(b)

Figure 8.16 Practical implementation of the common-source amplifier: (a) circuit; (b) $i-v$ characteristic of the active-load $Q_{1}$; (c) graphical construction to determine the transfer characteristic; (d) transfer characteristic.# Example 8.3 continued 


(c)

(d)

Figure 8.16 continued

## Solution

First we concern ourselves with the current mirror, with the objective of determining the $i-v$ characteristic of the current source $Q_{2}$. Toward that end, we note that the current $I_{\mathrm{REF}}$ flows through the diode-connected transistor $Q_{1}$ and thus determines $V_{S G}$ of $Q_{3}$, which is in turn applied between the source and the gate of $Q_{2}$. Thus, the $i-v$ characteristic of the current source $Q_{2}$ will be the $i_{D}-v_{S D}$ characteristic curve of $Q_{2}$ obtained for $v_{S G}=V_{S G}$. This is shown in Fig. 8.16(b), where we note that $i$ will be equal to $I_{\text {REF }}$ at one point only, namely, at $v_{S D 2}=V_{S G}$, this being the only point at which the two matched transistors $Q_{2}$ and $Q_{3}$ have identical operating conditions. We also observe the effect of channel-length modulation in $Q_{2}$ (the Early effect), which is modeled by the finite output resistance $r_{o 2}$. Finally, note that $Q_{2}$ operates as
a current source when $v$ is equal to or greater than $\left|V_{O V 2}\right|=V_{S G}-\left|V_{i p}\right|$. This in turn is obtained when $v_{O} \leq V_{D D}-\left|V_{O V 2}\right|$. This is the maximum permitted value of the output voltage $v_{O}$.

Now, with the $i-v$ characteristic of the current-source load $Q_{2}$ in hand, we can proceed to determine $v_{O}$ versus $v_{I}$. Figure 8.16(c) shows a graphical construction for doing this. It is based on the graphical analysis method employed in Section 7.1.6 except that here the load line is not a straight line but is the $i-v$ characteristic curve of $Q_{2}$ shifted along the $v_{O}$ axis by $V_{D D}$ volts and "flipped around." The reason for this is that

$$
v_{O}=V_{D D}-v
$$

The term $V_{D D}$ necessitates the shift, and the minus sign of $v$ gives rise to the "flipping around" of the load curve.

The graphical construction of Fig. 8.16(c) can be used to determine $v_{O}$ for every value of $v_{I}$, point by point: The value of $v_{I}$ determines the particular characteristic curve of $Q_{1}$ on which the operating point lies. The operating point will be at the intersection of this particular graph and the load curve. The horizontal coordinate of the operating point then gives the value of $v_{O}$.

Proceeding in the manner just explained, we obtain the VTC shown in Fig. 8.16(d). As indicated, it has four distinct segments, labeled I, II, III, and IV. Each segment is obtained for one of the four combinations of the modes of operation of $Q_{1}$ and $Q_{2}$, which are also indicated in the diagram. Note that we have labeled two important break points on the transfer characteristic (A and B) in correspondence with the intersection points (A and B) in Fig. 8.16(c). We urge the reader to carefully study the transfer characteristic and its various details.

Not surprisingly, segment III is the one of interest for amplifier operation. Observe that in region III the transfer curve is almost linear and is very steep, indicating large voltage gain. In region III both the amplifying transistor $Q_{1}$ and the load transistor $Q_{2}$ are operating in saturation. The end points of region III are A and B: At A, defined by $v_{O}=V_{D D}-\left|V_{O V 2}\right|, Q_{2}$ enters the triode region, and at B, defined by $v_{O}=v_{I}-V_{i n}, Q_{1}$ enters the triode region. When the amplifier is biased at a point in region III, the small-signal voltage gain can be determined as we have done in Fig. 8.15(c). The question remains as to how we are going to guarantee that the dc component of $v_{I}$ will have such a value that will result in operation in region III. That is why overall negative feedback is needed, as will be demonstrated later.

Before leaving this example it is useful to reiterate that the upper limit of the amplifier region (i.e., point A) is defined by $V_{O A}=V_{D D}-\left|V_{O V 2}\right|$ and the lower limit (i.e., point B) is defined by $V_{O B}=V_{O V 1}$, where $V_{O V 1}$ can be approximately determined by assuming that $I_{D 1} \simeq I_{\text {REF }}$. A more precise value for $V_{O B}$ can be obtained by taking into account the Early effect in both $Q_{1}$ and $Q_{2}$, as will be demonstrated in the next example.

# Example 8.4 

Consider the CMOS common-source amplifier in Fig. 8.16(a) for the case $V_{D D}=3 \mathrm{~V}, V_{i n}=\left|V_{i p}\right|=0.6 \mathrm{~V}$, $\mu_{n} C_{o s}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $\mu_{p} C_{o s}=65 \mu \mathrm{~A} / \mathrm{V}^{2}$. For all transistors, $L=0.4 \mu \mathrm{~m}$ and $W=4 \mu \mathrm{~m}$. Also, $V_{A n}=20 \mathrm{~V},\left|V_{A p}\right|=10 \mathrm{~V}$, and $I_{\text {REF }}=100 \mu \mathrm{~A}$. Find the small-signal voltage gain. Also, find the coordinates of the extremities of the amplifier region of the transfer characteristic- that is, points A and B.
# Example 8.4 continued 

## Solution

$$
\begin{aligned}
g_{m 1} & =\sqrt{2 k_{c}\left(\frac{W}{L}\right)_{1} I_{\mathrm{REF}}} \\
& =\sqrt{2 \times 200 \times \frac{4}{0.4} \times 100}=0.63 \mathrm{~mA} / \mathrm{V} \\
r_{o 1} & =\frac{V_{A n}}{I_{D 1}}=\frac{20 \mathrm{~V}}{0.1 \mathrm{~mA}}=200 \mathrm{k} \Omega \\
r_{o 2} & =\frac{\left|V_{A p}\right|}{I_{D 2}}=\frac{10 \mathrm{~V}}{0.1 \mathrm{~mA}}=100 \mathrm{k} \Omega
\end{aligned}
$$

Thus,

$$
\begin{aligned}
A_{v} & =-g_{m 1}\left(r_{o 1} \| r_{o 2}\right) \\
& =-0.63(\mathrm{~mA} / \mathrm{V}) \times(200 \| 100)(\mathrm{k} \Omega)=-42 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

Approximate values for the extremities of the amplifier region of the transfer characteristic [region III in Fig. 8.16(d)] can be determined as follows: Neglecting the Early effect, all three transistors are carrying equal currents $I_{\mathrm{REF}}$, and thus we can determine the overdrive voltages at which they are operating. Transistors $Q_{2}$ and $Q_{3}$ will have equal overdrive voltages, $\left|V_{O V 3}\right|$, determined from

$$
I_{D 3}=I_{\mathrm{REF}} \simeq \frac{1}{2}\left(\mu_{p} C_{o s}\right)\left(\frac{W}{L}\right)_{3}\left|V_{O V 3}\right|^{2}
$$

Substituting $I_{\mathrm{REF}}=100 \mu \mathrm{~A}, \mu_{p} C_{o s}=65 \mu \mathrm{~A} / \mathrm{V}^{2},(W / L)_{3}=4 / 0.4=10$ results in

$$
\left|V_{O V 3}\right|=0.55 \mathrm{~V}
$$

Thus,

$$
V_{O A}=V_{D D}-\left|V_{O V 3}\right|=2.45 \mathrm{~V}
$$

Next we determine $\left|V_{O V 1}\right|$ from

$$
I_{D 1} \simeq I_{\mathrm{REF}} \simeq \frac{1}{2}\left(\mu_{u} C_{o s}\right)\left(\frac{W}{L}\right)_{1} V_{O V 1}^{2}
$$

Substituting $I_{\mathrm{REF}}=100 \mu \mathrm{~A}, \mu_{u} C_{o s}=200 \mu \mathrm{~A} / \mathrm{V}^{2},(W / L)_{1}=4 / 0.4=10$ results in

$$
V_{O V 1}=0.32 \mathrm{~V}
$$

Thus,

$$
V_{O B}=V_{O V 1}=0.32 \mathrm{~V}
$$

More precise values for $V_{O A}$ and $V_{O B}$ can be determined by taking the Early effect in all transistors into account as follows.
First, we determine $V_{S G}$ of $Q_{2}$ and $Q_{3}$ corresponding to $I_{D 3}=I_{\text {REF }}=100 \mu \mathrm{~A}$ using

$$
I_{D 3}=\frac{1}{2} k_{p}\left(\frac{W}{L}\right)_{3}\left(V_{S G}-\left|V_{i p}\right|\right)^{2}\left(1+\frac{V_{S D}}{\left|V_{A p}\right|}\right)
$$

Thus,

$$
100=\frac{1}{2} \times 65\left(\frac{4}{0.4}\right)\left|V_{O V 3}\right|^{2}\left(1+\frac{0.6+\left|V_{O V 3}\right|}{10}\right)
$$

where $\left|V_{O V 3}\right|$ is the magnitude of the overdrive voltage at which $Q_{3}$ and $Q_{2}$ are operating, and we have used the fact that, for $Q_{3}, V_{S D}=V_{S G}$. Equation (8.51) can be manipulated to the form

$$
0.29=\left|V_{O V 3}\right|^{2}\left(1+0.09\left|V_{O V 3}\right|\right)
$$

which by a trial-and-error process yields

$$
\left|V_{O V 3}\right|=0.526 \mathrm{~V}
$$

Thus,

$$
V_{S G}=0.6+0.526=1.126 \mathrm{~V}
$$

and

$$
V_{O A}=V_{D D}-V_{O V 3}=2.47 \mathrm{~V}
$$

To find the corresponding value of $v_{I}, V_{I A}$, we derive an expression for $v_{O}$ versus $v_{I}$ in region III. Noting that in region III, $Q_{1}$ and $Q_{2}$ are in saturation and obviously conduct equal currents, we can write

$$
\begin{aligned}
i_{D 1} & =i_{D 2} \\
\frac{1}{2} k_{a}^{\prime}\left(\frac{W}{L}\right)_{1}\left(v_{I}-V_{i a}\right)^{2}\left(1+\frac{v_{O}}{\left|V_{A a}\right|}\right) & =\frac{1}{2} k_{p}^{\prime}\left(\frac{W}{L}\right)_{2}\left(V_{S G}-\left|V_{i p}\right|\right)^{2}\left(1+\frac{V_{D D}-v_{O}}{\left|V_{A p}\right|}\right)
\end{aligned}
$$

Substituting numerical values, we obtain

$$
8.55\left(v_{I}-0.6\right)^{2}=\frac{1-0.08 v_{O}}{1+0.05 v_{O}}
$$

This is the equation of segment III of the transfer characteristic. Although it includes $v_{I}^{2}$, the reader should not be alarmed: Because region III is very narrow, $v_{I}$ changes very little, and the characteristic is nearly linear. Substituting $v_{O}=2.47 \mathrm{~V}$ gives the corresponding value of $v_{I}$; that is, $V_{I A}=0.89 \mathrm{~V}$. To determine the coordinates of B , we note that they are related by $V_{O B}=V_{I B}-V_{o e}$. Substituting in Eq. (8.52) and solving by trial and error gives $V_{I B}=0.935 \mathrm{~V}$ and $V_{O B}=0.335 \mathrm{~V}$. The width of the amplifier region is therefore

$$
\Delta v_{I}=V_{I B}-V_{I A}=0.045 \mathrm{~V}
$$

and the corresponding output range is

$$
\Delta v_{O}=V_{O B}-V_{O A}=-2.135 \mathrm{~V}
$$
# Example 8.4 continued 

Thus, the "large-signal" voltage gain is

$$
\frac{\Delta v_{t i}}{\Delta v_{t}}=-\frac{2.135}{0.045}=-47.4 \mathrm{~V} / \mathrm{V}
$$

which is reasonably close to the small-signal value of -42 , indicating that segment III of the transfer characteristic is quite linear.

## EXERCISES

8.8 A CMOS common-source amplifier such as that in Fig. 8.16(a), fabricated in a $0.18-\mu \mathrm{m}$ technology, has $W / L=7.2 \mu \mathrm{~m} / 0.36 \mu \mathrm{~m}$ for all transistors, $k_{n}^{\prime}=387 \mu \mathrm{~A} / \mathrm{V}^{2}, k_{p}^{\prime}=86 \mu \mathrm{~A} / \mathrm{V}^{2}, I_{\mathrm{REF}}=100 \mu \mathrm{~A}$, $V_{A n}^{\prime}=5 \mathrm{~V} / \mu \mathrm{m}$, and $\left|V_{A p}^{\prime}\right|=6 \mathrm{~V} / \mu \mathrm{m}$. Find $g_{m 1}, r_{o 1}, r_{o 2}$, and the voltage gain.
Ans. $1.24 \mathrm{~mA} / \mathrm{V} ; 18 \mathrm{k} \Omega ; 21.6 \mathrm{k} \Omega ;-12.2 \mathrm{~V} / \mathrm{V}$
8.9 Consider the active-loaded CE amplifier when the constant-current source $I$ is implemented with a pnp transistor. Let $I=0.1 \mathrm{~mA},\left|V_{A}\right|=50 \mathrm{~V}$ (for both the $n p n$ and the $p n p$ transistors), and $\beta=100$. Find $R_{m}, r_{o}$ (for each transistor), $g_{m}, A_{0}$, and the amplifier voltage gain.
Ans. $25 \mathrm{k} \Omega ; 0.5 \mathrm{M} \Omega ; 4 \mathrm{~mA} / \mathrm{V} ; 2000 \mathrm{~V} / \mathrm{V} ;-1000 \mathrm{~V} / \mathrm{V}$

### 8.3.4 Increasing the Gain of the Basic Cell

We conclude this section by considering a question: How can we increase the voltage gain obtained from the basic gain cell? The answer lies in finding a way to raise the level of the output resistance of both the amplifying transistor and the load transistor. That is, we seek a circuit that passes the current $g_{m} v_{i}$ provided by the amplifying transistor right through, but increases the resistance from $r_{o}$ to a much larger value. This requirement is illustrated in Fig. 8.17. Figure 8.17(a) shows the CS amplifying transistor $Q_{1}$ together with its output equivalent circuit. Note that for the time being we are not showing the load device. In Fig. 8.17(b) we have inserted a shaded box between the drain of $Q_{1}$ and a new output terminal labeled $d_{2}$. Here again we are not showing the load to which $d_{2}$ will be connected. Our "black box" takes in the output current of $Q_{1}$ and passes it to the output; thus at its output we have the equivalent circuit shown, consisting of the same controlled source $g_{m 1} v_{i}$ but with the output resistance increased by a factor $K$.

Now, what does the black box really do? Since it passes the current but raises the resistance level, it is a current buffer. It is the dual of the voltage buffer (the source and emitter followers), which passes the voltage but lowers the resistance level.

Now searching our repertoire of transistor amplifier configurations studied in Section 7.3, the only candidate for implementing this current-buffering action is the common-gate (or common-base in bipolar) amplifier. Indeed, recall that the CG and CB circuits have a unity current gain. What we have not yet investigated, however, is their resistance transformation property. We shall do this in the next section.


Figure 8.17 To increase the voltage gain realized in the basic gain cell shown in (a), a functional block, shown as a black box in (b), is connected between $d_{1}$ and the load. This new block is required to pass the current $g_{m 1} v_{i}$ right through but raise the resistance level by a factor $K$. The functional block is a current buffer and can be realized with a common-gate transistor, as demonstrated in the next section.

# 8.4 The Common-Gate and Common-Base Amplifiers 

In this section we study the IC versions of the CG and CB amplifier configurations. This study differs in a significant way from that of the discrete-circuit versions (Section 7.3.5) because here we have to take into account the output resistance of the transistor, $r_{o}$. In the following, we show that both the CG and CB configurations provide excellent implementations of the current buffer discussed in the previous section.

### 8.4.1 The CG Circuit

Figure 8.18(a) shows a CG amplifier with the biasing arrangement shown only partially. The amplifier is fed with a signal source $v_{\text {sig }}$ having a resistance $R_{s}$, and it has a load resistance $R_{L}$. The latter is usually implemented using a PMOS current source, as discussed earlier.

To characterize the signal performance of the CG amplifier, we show in Fig. 8.18(b) the circuit with the dc voltages eliminated. Observe that because the gate current is zero, the input


Figure 8.18 (a) A CG amplifier with the bias arrangement only partially shown. (b) The circuit with the dc sources eliminated.
current $i$ passes through to the drain and on to the load-the first requirement of a current buffer.

Input Resistance The input resistance $R_{\text {in }}$ can be found using the circuit of Fig. 8.19. Here we have employed the T model of the MOSFET and applied a test voltage $v_{s}$ to the input. The input resistance is given by

$$
R_{\mathrm{in}} \equiv \frac{v_{s}}{i_{s}}
$$



Figure 8.19 Determining the input resistance $R_{\mathrm{in}}$ of the CG amplifier.
The analysis proceeds as follows.
A node equation at the input yields the current in $r_{o}$ as $\left(i_{x}+g_{m} v_{g s}\right)$. A node equation at the output shows that the current through $R_{L}$ is $i_{x}$. Next, a loop equation for the loop comprising $v_{x}, r_{o}$, and $R_{L}$ gives

$$
v_{x}=\left(i_{x}+g_{m} v_{g s}\right) r_{o}+i_{x} R_{L}
$$

Since the voltage at the source node $v_{x}$ is equal to $-v_{g s}$, we can replace $v_{g s}$ by $-v_{x}$ and rearrange terms to obtain $R_{\text {in }} \equiv v_{x} / i_{x}$,

$$
R_{\text {in }}=\frac{r_{o}+R_{L}}{1+g_{m} r_{o}}
$$

For $g_{m} r_{o} \gg 1$,

$$
R_{\text {in }} \simeq \frac{1}{g_{m}}+\frac{R_{L}}{g_{m} r_{o}}
$$

This is a very interesting result. First, it shows that if $r_{o}$ is infinite, as was the case in our analysis of the discrete CG amplifier in Section 7.3.5, then $R_{\text {in }}$ reduces to $1 / g_{m}$, verifying the result we found there. If $r_{o}$ cannot be neglected, as is always the case in IC amplifiers, we see that the input resistance depends on $R_{L}$ in an interesting fashion: The load resistance $R_{L}$ is transformed to the input by dividing it by the intrinsic gain $A_{0}=g_{m} r_{o}$. Thus, even as $R_{L}$ is increased, this impedance transformation property ensures that $R_{\text {in }}$ remains relatively low, an important characteristic of a current buffer.

Output Resistance To obtain the output resistance $R_{\text {out }}$ we utilize the circuit shown in Fig. 8.20. Here we have short circuited $v_{\text {sig }}$ but left the source resistance $R_{s}$, and applied a test voltage $v_{x}$ to the output. The output resistance is given by

$$
R_{\text {out }}=\frac{v_{x}}{i_{x}}
$$



Figure 8.20 Determining the output resistance $R_{\text {out }}$ of the CG amplifier.
The analysis proceeds as follows.
A node equation at the drain gives the current through $r_{o}$ as $\left(i_{s}-g_{m} v_{g s}\right)$. A node equation at the source gives the current in $R_{s}$ as $i_{s}$. Next, a loop equation for the loop comprising $v_{s}$, $r_{o}$, and $R_{s}$ gives

$$
v_{s}=\left(i_{s}-g_{m} v_{g s}\right) r_{o}+i_{s} R_{s}
$$

Finally, we observe that the voltage at the source terminal is $-v_{g s}$ and can also be expressed as $i_{s} R_{s}$, thus

$$
v_{g s}=-i_{s} R_{s}
$$

Substituting this value for $v_{g s}$ into Eq. (8.55) and rearranging terms to obtain $R_{\text {out }} \equiv v_{s} / i_{s}$ yields

$$
R_{\text {out }}=r_{o}+R_{s}+g_{m} r_{o} R_{s}
$$

which can be written in the alternate form

$$
R_{\text {out }}=r_{o}+\left(1+g_{m} r_{o}\right) R_{s}
$$

For $g_{m} r_{o} \gg 1$,

$$
R_{\text {out }} \simeq r_{o}+\left(g_{m} r_{o}\right) R_{s}
$$

and if we also have $g_{m} R_{s} \gg$ then

$$
R_{\text {out }} \simeq\left(g_{m} r_{o}\right) R_{s}
$$

Equation (8.58) indicates that the output resistance of the CG amplifier includes, in addition to the transistor's $r_{o}$, a component related to the resistance in the source load $R_{s}$. The significant point is that the CG amplifier transforms the source resistance $R_{s}$ to the output by multiplying it by the intrinsic gain $A_{0}=g_{m} r_{o}$. This impedance transformation is the inverse to that observed from output to input. Now, if $R_{s}$ is large then the output resistance of the CG circuit can be very large; this also is an important characteristic of a current buffer.

To summarize: the CG circuit has a unity current gain; a low input resistance, obtained by dividing $R_{L}$ by $g_{m} r_{o}$; and a high output resistance, obtained by multiplying $R_{s}$ by $g_{m} r_{o}$. Thus it makes for an excellent current buffer and can be used to implement the shaded functional box in Fig. 8.17. As a useful summary, Fig. 8.21 illustrates the impedance transformation properties of the common-gate amplifier.


Figure 8.21 The impedance transformation properties of the common-gate amplifier. Depending on the values of $R_{s}$ and $R_{L}$, we can sometimes write $R_{m} \simeq R_{L} /\left(g_{m} r_{o}\right)$ and $R_{s} \simeq$ $\left(g_{m} r_{o}\right) R_{s}$. However, such approximations are not always justified.
# EXERCISES 

8.10 For the CG amplifier in Fig. 8.18, show that the voltage gain is given by

$$
\frac{v_{s}}{v_{\text {sig }}}=\frac{R_{L}}{R_{s}+R_{\text {in }}}
$$

8.11 For a CG amplifier for which $g_{m} r_{o} \gg 1$, find $R_{\text {in }}$ for the following cases: $R_{L}=0 ; r_{o} ;\left(g_{m} r_{o}\right) r_{o} ; \infty$. Ans. $\frac{1}{g_{m}} ; \frac{2}{g_{m}} ; r_{o} ; \infty$
8.12 For a CG amplifier for which $g_{m} r_{o} \gg 1$, find $R_{\text {out }}$ for the following cases: $R_{s}=0 ; r_{o} ;\left(g_{m} r_{o}\right) r_{o} ; \infty$. Ans. $r_{o} ;\left(g_{m} r_{o}\right) r_{o} ;\left(g_{m} r_{o}\right)^{2} r_{o} ; \infty$

### 8.4.2 Output Resistance of a CS Amplifier with a Source Resistance

In Section 7.3.4 we discussed some of the benefits that are obtained when a resistance $R_{s}$ is included in the source lead of a CS amplifier, as in Fig. 8.22. Such a resistance is referred to as a source-degeneration resistance because of its action in reducing the effective transconductance of the CS stage to $g_{m} /\left(1+g_{m} R_{s}\right)$, that is, by a factor $\left(1+g_{m} R_{s}\right)$. This also is the factor by which a number of performance parameters are increased, such as linearity and bandwidth (as will be seen in Chapter 10). At this juncture we simply wish to point out that the expression we derived above for the output resistance of the CG amplifier applies directly to the case of a source-degenerated CS amplifier. This is because when we determine $R_{o}$, we ground the input terminal, making transistor $Q$ appear as a CG transistor. Thus $R_{o}$ is given by Eq. (8.56), namely,

$$
R_{o}=r_{o}+R_{s}+g_{m} r_{o} R_{s}
$$

Since $g_{m} r_{o} \gg 1$, the second term on the right-hand side will be much lower than the third and can be neglected, resulting in

$$
R_{o} \simeq\left(1+g_{m} R_{s}\right) r_{o}
$$



Figure 8.22 The output resistance expression of the CG amplifier can be used to find the output resistance of a source-degenerated common-source amplifier. Here, a useful interpretation of the result is that $R_{s}$ increases the output resistance by the factor $\left(1+g_{m} R_{s}\right)$.Thus source degeneration increases the output resistance of the CS amplifier from $r_{o}$ to $\left(1+g_{m} R_{s}\right) r_{o}$, again by the same factor $\left(1+g_{m} R_{s}\right)$. In Chapter 11, we will find that $R_{s}$ introduces negative (degenerative) feedback of an amount $\left(1+g_{m} R_{s}\right)$.

# EXERCISE 

8.13 Given that source degeneration reduces the transconductance of a CS amplifier from $g_{m}$ to approximately $g_{m} /\left(1+g_{m} R_{s}\right)$ and increases its output resistance by approximately the same factor, what happens to the open-circuit voltage gain $A_{v o}$ ? Now, find an expression for $A_{v}$ when a load resistance $R_{L}$ is connected to the output.
Ans. $A_{v o}$ remains constant at $g_{m} r_{o}$ :

$$
A_{v}=\left(g_{m} r_{o}\right) \frac{R_{L}}{R_{L}+\left(1+g_{m} R_{s}\right) r_{o}}
$$

### 8.4.3 The Body Effect

Since in the CG amplifier the source cannot be connected to the substrate, the body effect (see Section 5.4) plays a role in the operation of the CG amplifier. It turns out, however, that taking the body effect into account in the analysis of the CG circuit is a very simple matter. To see how this can be done, refer to Fig. 8.23(a) and recall that the body terminal acts as another gate for the MOSFET. Thus, just as a signal voltage $v_{g s}$ between the gate and the source gives


Figure 8.23 The body effect can be easily taken into account in the analysis of the CG circuit by replacing $g_{m}$ by $(1+\chi) g_{m}$, where $\chi=g_{m b} / g_{m}=0.1$ to 0.2 .
rise to a drain current signal $g_{m} v_{g s}$, a signal voltage $v_{b s}$ between the body and the source gives rise to a drain current signal $g_{m b} v_{b s}$. Thus the drain signal current becomes $\left(g_{m} v_{g s}+g_{m b} v_{b s}\right)$, where the body transconductance $g_{m b}$ is a small fraction $\chi$ of $g_{m} ; g_{m b}=\chi g_{m}$ and $\chi=0.1$ to 0.2 . For the CG circuit, $v_{b s}=v_{g s}$, thus the two current signals can be combined as $\left(g_{m}+g_{m b}\right) v_{g s}$ or $g_{m}(1+\chi) v_{g s}$. Thus, the body effect can be taken into account by simply replacing $g_{m}$ by $g_{m}(1+\chi)$ as illustrated in the T equivalent model shown in Fig. 8.23(b). Normally, however, we will not bother with the factor $(1+\chi)$ in our calculations.

# 8.4.4 The CB Circuit 

Analysis of the CB amplifier parallels that of the CG amplifier except it is a little more involved because of the finite base current. Figure 8.24(a) shows a CB amplifier with the bias details only partially shown and with a load resistance $R_{L}$ that is normally implemented with a pnp current source. The circuit, prepared for small-signal analysis, is shown in Fig. 8.24(b). Note that since $\alpha \simeq 1$ the current gain is nearly unity, an important characteristic of a current buffer.

Input Resistance The circuit for determining the input resistance $R_{\text {in }}$ is shown in Fig. 8.25, which also shows the currents in all branches, obtained by writing node equations for the three nodes. Of special note is the use of the identity $g_{m}+\frac{1}{r_{o}}=\frac{1}{r_{e}}$ to obtain the current in the base as $v_{a} / r_{a}$. Writing a loop equation for the loop comprising $v_{s}, r_{o}$, and $R_{L}$, and replacing $v_{a}$ by $-v_{s}$, results in the following expression for $R_{\text {in }} \equiv v_{s} / i_{s}$,

$$
R_{\mathrm{in}}=\frac{r_{o}+R_{L}}{1+\frac{r_{o}}{r_{e}}+\frac{R_{L}}{(\beta+1) r_{e}}}
$$

where we have utilized the relationship $r_{\pi}=(\beta+1) r_{e}$. Since $r_{o} \gg r_{e}$,

$$
R_{\mathrm{in}} \simeq r_{e} \frac{r_{o}+R_{L}}{r_{o}+\frac{R_{L}}{\beta+1}}
$$



Figure 8.24 (a) A CB amplifier with the bias arrangement only partially shown. (b) The circuit with the dc sources eliminated.


Figure 8.25 Determining the input resistance $R_{\text {in }}$ of the CB amplifier.

Note that setting $r_{o}=\infty$ yields $R_{\text {in }}=r_{e}$, which is consistent with the case of the discrete-circuit CB amplifier studied in Section 7.3.5. Also, for $R_{L}=0, R_{\text {in }}=r_{e}$. The value of $R_{\text {in }}$ increases as $R_{L}$ is raised, reaching a maximum of

$$
\left.R_{\text {in }}\right|_{\max }=(\beta+1) r_{e}=r_{\pi}, \text { for } R_{L}=\infty
$$

that is, for the amplifier operating open circuited. Finally, for $\frac{R_{L}}{\beta+1} \ll r_{o}$, Eq. (8.63) can be approximated by

$$
R_{\text {in }} \simeq r_{e}+\frac{R_{L}}{g_{m} r_{o}}
$$

which is very similar to the case of the MOSFET (Eq. 8.54). We conclude by noting that the impedance transformation property of the CB circuit ensures that its input resistance is kept small, an important characteristic of a current buffer.

Output Resistance The determination of the output resistance $R_{\text {out }}$ of the CB amplifier is illustrated in Fig. 8.26. The result is

$$
R_{\text {out }}=r_{o}+\left(R_{e} \| r_{\pi}\right)+\left(R_{e} \| r_{\pi}\right) g_{m} r_{o}
$$

which is very similar to the corresponding expression for the MOSFET case (Eq. 8.56) except that $R_{e}$ is replaced by $\left(R_{e} \| r_{\pi}\right)$. The expression in Eq. (8.66) can be written in the alternate form

$$
R_{\text {out }}=r_{o}+\left(1+g_{m} r_{o}\right)\left(R_{e} \| r_{\pi}\right)
$$

For $g_{m} r_{o} \gg 1$,

$$
R_{\text {out }} \simeq r_{o}+\left(g_{m} r_{o}\right)\left(R_{e} \| r_{\pi}\right)
$$

Thus, similar to the CG amplifier, the CB amplifier exhibits an impedance transformation property that raises the output resistance. Unlike the CG case, however, the output resistance of the CB circuit has an absolute maximum value obtained by setting $R_{e}=\infty$ as

$$
\left.R_{\text {out }}\right|_{\max }=r_{o}+g_{m} r_{o} r_{\pi}=(\beta+1) r_{o}
$$


Figure 8.26 Determining the output resistance $R_{\text {out }}$ of the CB amplifier.

Figure 8.27 The impedance transformation properties of the CB amplifier. Note that for $\beta=\infty$, these formulas reduce to those for the MOSFET case (Fig. 8.21).

We conclude that the CB circuit has a current gain of nearly unity, a low input resistance, and a high output resistance; thus it makes for an excellent current buffer. The impedance transformation properties of the CB circuit are summarized in Fig. 8.27.

# EXERCISES 

8.14 For a CB amplifier, find approximate values for $R_{\text {in }}$ for the following cases: $R_{L}=0 ; r_{o} ;(\beta+1) r_{o} ; \infty$. Ans. $r_{e} ; 2 r_{e} ; \frac{1}{2} r_{\pi} ; r_{\pi}$
8.15 For a CB amplifier, find approximate values for $R_{\text {out }}$ for the following cases: $R_{e}=0 ; r_{e} ; r_{\pi} ; r_{o} ; \infty$. Ans. $r_{o} ; 2 r_{o} ;\left(\frac{1}{2} \beta+1\right) r_{o} ;(\beta+1) r_{o} ;(\beta+1) r_{o}$
# 8.4.5 Output Resistance of an Emitter-Degenerated CE Amplifier 

As we have done in the MOS case, we shall adapt the expression for $R_{o}$ derived for the CB amplifier (Eq. 8.68) for the case of a CE amplifier with a resistance $R_{e}$ connected in its emitter, as shown in Fig. 8.28(a),

$$
R_{o} \simeq r_{o}+g_{m} r_{o}\left(R_{e} \| r_{\pi}\right)
$$

which can be written in the alternate form

$$
R_{o}=\left[1+g_{m}\left(R_{e} \| r_{\pi}\right)\right] r_{o}
$$

Thus, emitter degeneration multiplies the transistor output resistance $r_{o}$ by the factor $\left[1+g_{m}\left(R_{e} \| r_{\pi}\right)\right]$. Note that this factor has a maximum value of $\left(1+g_{m} r_{\pi}\right)$ or $(\beta+1)$, obtained when $R_{e} \gg r_{\pi}$. Thus the theoretical maximum output resistance realized is $(\beta+1) r_{o}$ and is achieved when the emitter is open circuited.


Figure 8.28 Output resistance of a CE amplifier with an emitter resistance $R_{e}$.

## EXERCISE

8.16 Find the output resistance of a CE amplifier biased at $I_{C}=1 \mathrm{~mA}$ and having a resistance of $500 \Omega$ connected in its emitter. Let $\beta=100$ and $V_{A}=10 \mathrm{~V}$. What is the value of the output resistance without degeneration?
Ans. $177 \mathrm{k} \Omega ; 10 \mathrm{k} \Omega$

### 8.5 The Cascode Amplifier

### 8.5.1 Cascoding

Cascoding refers to the use of a transistor connected in the common-gate (or the common-base) configuration to provide current buffering for the output of a common-source (or a common-emitter) amplifying transistor. Figure 8.29 illustrates the technique for the MOS case. Here the CS transistor $Q_{1}$ is the amplifying transistor and $Q_{2}$, connected in the CG


Figure 8.29 The current-buffering action of Fig. 8.17(b) is implemented using a transistor $Q_{2}$ connected in the CG configuration. Here $V_{G 2}$ is a dc bias voltage. The output equivalent circuit indicates that the CG transistor passes the current $g_{m 1} v_{i}$ through but raises the resistance level by a factor $K$. Transistor $Q_{2}$ is called a cascode transistor.
configuration with a dc bias voltage $V_{G 2}$ (signal ground) at its gate, is the cascode transistor. ${ }^{2}$ A similar arrangement applies for the bipolar case and will be considered later.

From our study of the CG amplifier characteristics, we can see that the cascode transistor passes the current $g_{m 1} v_{i}$ to the output node while multiplying the resistance in its source ( $r_{o 1}$ of $Q_{1}$ ) by a factor $K$. The result is the equivalent circuit of Fig. 8.29, which can be utilized to determine the voltage gain of the cascode amplifier for various load resistances. We shall consider the MOS cascode amplifier in detail next.

# EXERCISE 

8.17 Give an approximate value of the factor $K$ of the circuit in Fig. 8.29.

Ans. $K \simeq g_{m 2} r_{o 2}$

### 8.5.2 The MOS Cascode Amplifier

The Ideal Case Figure 8.30(a) shows a MOS cascode amplifier loaded with an ideal constant-current source. The voltage gain realized can be found from the equivalent circuit in Fig. 8.30(b). Since the load is an ideal constant-current source, the load resistance is infinite. That is, the amplifier is operating with an open-circuit load, and the gain is

$$
A_{v o} \equiv \frac{v_{o}}{v_{i}}=-g_{m 1} R_{o}
$$

[^0]
[^0]:    ${ }^{2}$ The name cascode is a carryover from the days of vacuum tubes and is a shortened version of "cascaded cathode"; in the tube version, the anode of the amplifying tube (corresponding to the drain of $Q_{1}$ ) feeds the cathode of the cascode tube (corresponding to the source of $Q_{2}$ ).


Figure 8.30 (a) A MOS cascode amplifier with an ideal current-source load; (b) equivalent circuit representation of the cascode output.

Now, since $R_{s}$ of $Q_{2}$ is $r_{o 1}$, the output resistance $R_{o}$ is given by the approximate expression

$$
R_{o} \simeq\left(g_{m 2} r_{o 2}\right) r_{o 1}
$$

Substituting in Eq. (8.71) results in

$$
A_{v o}=-\left(g_{m 1} r_{o 1}\right)\left(g_{m 2} r_{o 2}\right)
$$

For the case $g_{m 1}=g_{m 2}=g_{m}$ and $r_{o 1}=r_{o 2}=r_{o}$,

$$
\begin{aligned}
A_{v o} & =-\left(g_{m} r_{o}\right)^{2} \\
& =-A_{0}^{2}
\end{aligned}
$$

Thus cascoding increases the gain magnitude from $A_{0}$ to $A_{0}^{2}$.

Implementation of the Constant-Current Source Load If the current source load is implemented with a PMOS transistor (which can be part of a PMOS current mirror) as shown in Fig. 8.31(a), the load resistance $R_{L}$ will be equal to the output resistance of $Q_{3}, r_{o 3}$,

$$
R_{L}=r_{o 3}
$$

and the voltage gain of the cascode amplifier will be

$$
\begin{aligned}
A_{v} & =-g_{m 1}\left(R_{o} \| R_{L}\right) \\
& =-g_{m 1}\left(g_{m 2} r_{o 2} r_{o 1} \| r_{o 3}\right)
\end{aligned}
$$

from which we can readily see that since $R_{L} \ll R_{o}$, the total resistance will be approximately equal to $r_{o 3}$ and the gain will be

$$
A_{v} \simeq-g_{m 1} r_{o 3}
$$


Figure 8.31 (a) A MOS cascode amplifier loaded in a simple PMOS current source $Q_{3}$. (b) Equivalent circuit at the amplifier output.

Thus the gain magnitude will be back to $A_{0}$, of the same order as that realized by a CS amplifier. In other words, the use of a simple current-source load with a relatively low output resistance has in effect destroyed the cascoding advantage of increased output resistance. Nevertheless, it turns out that this cascode amplifier, whose gain is of the same order as that of a CS amplifier, does in fact have a major advantage over the CS circuit: It exhibits a much wider bandwidth. We will demonstrate this point in Chapter 10.

The Use of a Cascode Current Source To realize a gain of the order of $A_{0}^{2}$, the load resistance $R_{L}$ must be of the same order as $R_{o}$ of the cascode amplifier. This can be achieved by using a cascode current source such as that shown in Fig. 8.32. Here $Q_{4}$ is the current-source transistor, and $Q_{3}$ is the CG cascode transistor. Voltages $V_{G 3}$ and $V_{G 4}$ are dc bias voltages. The cascode transistor $Q_{3}$ multiplies the output resistance of $Q_{4}, r_{o 4}$ by $\left(g_{m 3} r_{o 3}\right)$ to provide an


Figure 8.32 Employing a cascode transistor $Q_{3}$ to raise the output resistance of the current source $Q_{4}$.


Figure 8.33 A cascode amplifier with a cascode current-source load.
output resistance for the cascode current source of

$$
R_{o}=\left(g_{m 3} r_{o 3}\right) r_{o 4}
$$

Combining a cascode amplifier with a cascode current source results in the circuit of Fig. 8.33(a). The equivalent circuit at the output side is shown in Fig. 8.33(b), from which the voltage gain can be easily found as

$$
A_{v}=\frac{v_{o}}{v_{i}}=-g_{m 1}\left[R_{o n} \| R_{o p}\right]
$$

Thus,

$$
A_{v}=-g_{m 1}\left\{\left[\left(g_{m 2} r_{o 2}\right) r_{o 1}\right] \|\left[\left(g_{m 3} r_{o 3}\right) r_{o 4}\right]\right\}
$$

For the case in which all transistors are identical,

$$
A_{v}=-\frac{1}{2}\left(g_{m} r_{o}\right)^{2}=-\frac{1}{2} A_{0}^{2}
$$

By comparison to the gain expression in Eq. (8.50), we see that using the cascode configuration for both the amplifying transistor and the current-source load transistor results in an increase in the magnitude of gain by a factor equal to $A_{0}$.
# Example 8.5 

It is required to design the cascode current source of Fig. 8.32 to provide a current of $100 \mu \mathrm{~A}$ and an output resistance of $500 \mathrm{k} \Omega$. Assume the availability of a $0.18-\mu \mathrm{m}$ CMOS technology for which $V_{D D}=1.8 \mathrm{~V}$, $V_{i p}=-0.5 \mathrm{~V}, \mu_{p} C_{o s}=90 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $V_{A}^{\prime}=-5 \mathrm{~V} / \mu \mathrm{m}$. Use $\left|V_{O V}\right|=0.3 \mathrm{~V}$ and determine $L$ and $W / L$ for each transistor, and the values of the bias voltages $V_{G 3}$ and $V_{G 4}$.

## Solution

The output resistance $R_{o}$ is given by

$$
R_{o}=\left(g_{m 3} r_{o 3}\right) r_{o 4}
$$

Assuming $Q_{3}$ and $Q_{4}$ are identical,

$$
\begin{aligned}
R_{o} & =\left(g_{m} r_{o}\right) r_{o} \\
& =\frac{\left|V_{A}\right|}{\left|V_{O V}\right| / 2} \times \frac{\left|V_{A}\right|}{I_{D}}
\end{aligned}
$$

Using $\left|V_{O V}\right|=0.3 \mathrm{~V}$, we write

$$
500 \mathrm{k} \Omega=\frac{\left|V_{A}\right|}{0.15} \times \frac{\left|V_{A}\right|}{0.1 \mathrm{~mA}}
$$

Thus we require

$$
\left|V_{A}\right|=2.74 \mathrm{~V}
$$

Now, since $\left|V_{A}\right|=\left|V_{A}^{\prime}\right| L$ we need to use a channel length of

$$
L=\frac{2.74}{5}=0.55 \mu \mathrm{~m}
$$

which is about three times the minimum channel length. With $\left|V_{i}\right|=0.5 \mathrm{~V}$ and $\left|V_{O V}\right|=0.3 \mathrm{~V}$,

$$
V_{S G 4}=0.5+0.3=0.8 \mathrm{~V}
$$

and thus,

$$
V_{G 4}=1.8-0.8=1.0 \mathrm{~V}
$$

To allow for the largest possible signal swing at the output terminal, we shall use the minimum required voltage across $Q_{4}$, namely, $\left|V_{O V}\right|$ or 0.3 V . Thus,

$$
V_{D 4}=1.8-0.3=1.5 \mathrm{~V}
$$

Since the two transistors are identical and are carrying equal currents,

$$
V_{S G 3}=V_{S G 4}=0.8 \mathrm{~V}
$$

Thus,

$$
V_{G 3}=1.5-0.8=+0.7 \mathrm{~V}
$$# Example 8.5 continued 

We note that the maximum voltage allowed at the output terminal of the current source will be constrained by the need to allow a minimum voltage of $\left|V_{O V}\right|$ across $Q_{3}$; thus;

$$
v_{D 3 \max }=1.5-0.3=+1.2 \mathrm{~V}
$$

To determine the required $W / L$ ratios of $Q_{3}$ and $Q_{4}$, we use

$$
\begin{aligned}
I_{D} & =\frac{1}{2}\left(\mu_{p} C_{o s}\right)\left(\frac{W}{L}\right)\left|V_{O V}\right|^{2}\left(1+\frac{V_{S D}}{\left|V_{A}\right|}\right) \\
100 & =\frac{1}{2} \times 90 \times\left(\frac{W}{L}\right) \times 0.3^{2}\left(1+\frac{0.3}{2.74}\right)
\end{aligned}
$$

which yields

$$
\frac{W}{L}=22.3
$$

## EXERCISES

D8.18 If in Example 8.5, $L$ of each of $Q_{3}$ and $Q_{4}$ is halved while $W / L$ is changed to allow $I_{D}$ and $V_{O V}$ to remain unchanged, find the new values of $R_{o}$ and $W / L$. [Hint: In computing the required ( $W / L$ ), note that $\left|V_{A}\right|$ has changed.]
Ans. $125 \mathrm{k} \Omega ; 20.3$
8.19 Consider the cascode amplifier of Fig. 8.33 with the dc component at the input, $V_{I}=0.7 \mathrm{~V}, V_{G 2}=$ $1.0 \mathrm{~V}, V_{G 3}=0.8 \mathrm{~V}, V_{G 4}=1.1 \mathrm{~V}$, and $V_{D D}=1.8 \mathrm{~V}$. If all devices are matched (i.e., if $k_{n 1}=k_{n 2}=$ $k_{p 3}=k_{p 4}$ ), and have equal $\left|V_{i}\right|$ of 0.5 V , what is the overdrive voltage at which the four transistors are operating? What is the allowable voltage range at the output?
Ans. $0.2 \mathrm{~V} ; 0.5 \mathrm{~V}$ to 1.3 V
8.20 The cascode amplifier in Fig. 8.33 is operated at a current of 0.2 mA with all devices operating at $\left|V_{O V}\right|=0.2 \mathrm{~V}$. All devices have $\left|V_{A}\right|=2 \mathrm{~V}$. Find $g_{m 1}$, the output resistance of the amplifier, $R_{o n}$, and the output resistance of the current source, $R_{o p}$. Also find the overall output resistance and the voltage gain realized.
Ans. $2 \mathrm{~mA} / \mathrm{V} ; 200 \mathrm{k} \Omega, 200 \mathrm{k} \Omega ; 100 \mathrm{k} \Omega ;-200 \mathrm{~V} / \mathrm{V}$

### 8.5.3 Distribution of Voltage Gain in a Cascode Amplifier

It is often useful to know how much of the overall voltage gain of a cascode amplifier is realized in each of its two stages: the CS stage $Q_{1}$, and the CG stage $Q_{2}$. For this purpose, consider the cascode amplifier shown in Fig. 8.34(a). Here, for generality we have included


Figure 8.34 (a) The cascode amplifier with a load resistance $R_{L}$. Only signal quantities are shown. (b) Determining $v_{o 1}$.
a load resistance $R_{L}$, which represents the output resistance of the current-source load plus any additional resistance that may be connected to the output node. The voltage gain $A_{v}$ of the amplifier can be found as

$$
A_{v}=-g_{m 1}\left(R_{o} \| R_{L}\right)
$$

Thus,

$$
A_{v}=-g_{m 1}\left(g_{m 2} r_{o 2} r_{o 1} \| R_{L}\right)
$$

The overall gain $A_{v}$ can be expressed as the product of the voltage gains of $Q_{1}$ and $Q_{2}$ as

$$
A_{v}=A_{v 1} A_{v 2}=\left(\frac{v_{o 1}}{v_{i}}\right)\left(\frac{v_{o}}{v_{o 1}}\right)
$$

To obtain $A_{v 1} \equiv v_{o 1} / v_{i}$ we need to find the total resistance between the drain of $Q_{1}$ and ground. Referring to Fig. 8.34(b) and denoting this resistance $R_{d 1}$, we can express $A_{v 1}$ as

$$
A_{v 1}=\frac{v_{o 1}}{v_{i}}=-g_{m 1} R_{d 1}
$$

Observe that $R_{d 1}$ is the parallel equivalent of $r_{o 1}$ and $R_{\text {in } 2}$, where $R_{\text {in } 2}$ is the input resistance of the CG transistor $Q_{2}$. From Eq. (8.54), we can write

$$
R_{\text {in } 2} \simeq \frac{R_{L}}{g_{m 2} r_{o 2}}+\frac{1}{g_{m 2}}
$$
Table 8.1 Gain Distribution in the MOS Cascode Amplifier for Various Values of $R_{L}$

| Case | $R_{L}$ | $R_{\mathrm{m} 2}$ | $R_{d 1}$ | $A_{v 1}$ | $A_{v 2}$ | $A_{v}$ |
| :-- | :-- | :-- | :-- | :-- | :-- | :-- |
| 1 | $\infty$ | $\infty$ | $r_{o}$ | $-g_{m} r_{o}$ | $g_{m} r_{o}$ | $-\left(g_{m} r_{o}\right)^{2}$ |
| 2 | $\left(g_{m} r_{o}\right) r_{o}$ | $r_{o}$ | $r_{o} / 2$ | $-\frac{1}{2}\left(g_{m} r_{o}\right)$ | $g_{m} r_{o}$ | $-\frac{1}{2}\left(g_{m} r_{o}\right)^{2}$ |
| 3 | $r_{o}$ | $\frac{2}{g_{m}}$ | $\frac{2}{g_{m}}$ | -2 | $\frac{1}{2}\left(g_{m} r_{o}\right)$ | $-\left(g_{m} r_{o}\right)$ |
| 4 | 0 | $\frac{1}{g_{m}}$ | $\frac{1}{g_{m}}$ | -1 | 0 | 0 |

Now we can obtain $R_{d 1}$ as

$$
R_{d 1}=r_{o 1} \| R_{\mathrm{m} 2}
$$

and $A_{v 1}$ as

$$
A_{v 1}=-g_{m 1} R_{d 1}=-g_{m 1}\left(r_{o 1} \| R_{\mathrm{m} 2}\right)
$$

Finally, we can obtain $A_{v 2}$ by dividing the total gain $A_{v}$ given by Eq. (8.80) by $A_{v 1}$. To provide insight into the effect of the value of $R_{L}$ on the overall gain of the cascode as well as on how this gain is distributed among the two stages of the cascode amplifier, we provide in Table 8.1 approximate values for the case $r_{o 1}=r_{o 2}=r_{o}$ and for four different values of $R_{L}$ : (1) $R_{L}=\infty$, obtained with an ideal current-source load; (2) $R_{L}=\left(g_{m} r_{o}\right) r_{o}$, obtained with a cascode current-source load; (3) $R_{L}=r_{o}$, obtained with a simple current-source load; and (4) for completeness, $R_{L}=0$, that is, a signal short circuit at the output.

Observe that while case 1 represents an idealized situation, it is useful in that it provides the theoretical maximum voltage gain achievable in a MOS cascode amplifier. Case 2, which assumes a cascode current-source load with an output resistance equal to that of the cascode amplifier, provides a realistic estimate of the gain achieved if one aims to maximize the realized gain. In certain situations, however, that is not our objective. This point is important, for as we shall see in Chapter 10, there is an entirely different application of the cascode amplifier: namely, to obtain wideband amplification by extending the upper-3-dB frequency $f_{H}$. As will be seen, for such an application one opts for the situation represented by case 3, where the gain achieved in the CS amplifier is only $-2 \mathrm{~V} / \mathrm{V}$, and of course the overall gain is now only $-\left(g_{m} r_{o}\right)$. However, as will be seen in Chapter 10, this trade-off of the overall gain to obtain extended bandwidth is in some cases a good bargain!

# EXERCISE 

8.21 Consider a cascode amplifier for which the CS and CG transistors are identical and are biased to operate at $I_{D}=0.1 \mathrm{~mA}$ with $V_{O V}=0.2 \mathrm{~V}$. Also let $V_{A}=2 \mathrm{~V}$. Find $A_{v 1}, A_{v 2}$, and $A_{v}$ for two cases: (a) $R_{L}=20 \mathrm{k} \Omega$ and (b) $R_{L}=400 \mathrm{k} \Omega$.
Ans. (a) $-1.82 \mathrm{~V} / \mathrm{V}, 10.5 \mathrm{~V} / \mathrm{V},-19.0 \mathrm{~V} / \mathrm{V}$; (b) $-10.2 \mathrm{~V} / \mathrm{V}, 19.6 \mathrm{~V} / \mathrm{V},-200 \mathrm{~V} / \mathrm{V}$
# 8.5.4 Double Cascoding 

If a still higher output resistance and correspondingly higher gain are required, it is possible to add another level of cascoding, as illustrated in Fig. 8.35. Observe that $Q_{3}$ is the second cascode transistor, and it raises the output resistance by $\left(g_{m 3} r_{o 3}\right)$. For the case of identical transistors, the output resistance will be $\left(g_{m} r_{o}\right)^{2} r_{o}$ and the voltage gain, assuming an ideal current-source load, will be $\left(g_{m} r_{o}\right)^{3}$ or $A_{0}^{3}$. Of course, we have to generate another dc bias voltage for the second cascode transistor, $Q_{3}$.

A drawback of double cascoding is that an additional transistor is now stacked between the power-supply rails. Furthermore, to realize the advantage of double cascoding, the current-source load will also need to use double cascoding with an additional transistor. Since for proper operation each transistor needs a certain minimum $v_{D S}$ (at least equal to $V_{D V}$ ), and recalling that modern MOS technology utilizes power supplies in the range of 1 V to 2 V , we see that there is a limit on the number of transistors in a cascode stack.


Figure 8.35 Double cascoding.

### 8.5.5 The Folded Cascode

To avoid the problem of stacking a large number of transistors across a low-voltage power supply, one can use a PMOS transistor for the cascode device, as shown in Fig. 8.36. Here, as before, the NMOS transistor $Q_{1}$ is operating in the CS configuration, but the CG stage is implemented using the PMOS transistor $Q_{2}$. An additional current source $I_{2}$ is needed to bias $Q_{2}$ and provide it with its active load. Note that $Q_{1}$ is now operating at a bias current of $\left(I_{1}-I_{2}\right)$. Finally, a dc voltage $V_{G 2}$ is needed to provide an appropriate dc level for the gate of the cascode transistor $Q_{2}$. Its value has to be selected so that $Q_{2}$ and $Q_{1}$ operate in the saturation region.

The small-signal operation of the circuit in Fig. 8.36 is similar to that of the NMOS cascode. The difference here is that the signal current $g_{m} v_{i}$ is folded down and made to flow


Figure 8.36 The folded cascode.
into the source terminal of $Q_{2}$, which gives the circuit the name folded cascode. ${ }^{3}$ The folded cascode is a very popular building block in CMOS amplifiers.

# EXERCISE 

D8.22 Consider the folded-cascode amplifier of Fig. 8.36 for the following case: $V_{D D}=1.8 \mathrm{~V}, k_{n}^{\prime}=4 k_{p}^{\prime}$, and $V_{t n}=-V_{i p}=0.5 \mathrm{~V}$. To operate $Q_{1}$ and $Q_{2}$ at equal bias currents $I, I_{1}=2 I$ and $I_{2}=I$. While current source $I_{1}$ is implemented using the simple circuit studied in Section 8.2, current source $I_{2}$ is realized using a cascoded circuit (i.e., the NMOS version of the circuit in Fig. 8.32). The transistor $W / L$ ratios are selected so that each operates at an overdrive voltage of 0.2 V .
(a) What must the relationship of $(W / L)_{2}$ to $(W / L)_{1}$ be?
(b) What is the minimum dc voltage required across current source $I_{1}$ for proper operation? Now, if a $0.1-\mathrm{V}$ peak-to-peak signal swing is to be allowed at the drain of $Q_{1}$, what is the highest dc bias voltage that can be used at that node?
(c) What is the value of $V_{8 G}$ of $Q_{2}$, and hence what is the largest value to which $V_{G 2}$ can be set?
(d) What is the minimum dc voltage required across current-source $I_{2}$ for proper operation?
(e) Given the results of (c) and (d), what is the allowable range of signal swing at the output?

Ans. (a) $(W / L)_{2}=4(W / L)_{1}$; (b) $0.2 \mathrm{~V}, 1.55 \mathrm{~V}$; (c) $0.7 \mathrm{~V}, 0.85 \mathrm{~V}$; (d) 0.4 V ; (e) 0.4 V to 1.35 V

[^0]
[^0]:    ${ }^{3}$ The circuit itself can be thought of as having been folded. In this same vein, the regular cascode is sometimes referred to as a telescopic cascode because the stacking of transistors resembles the extension of a telescope.
# 8.5.6 The BJT Cascode 

Figure 8.37(a) shows the BJT cascode amplifier with an ideal current-source load. Voltage $V_{B 2}$ is a dc bias voltage for the CB cascode transistor $Q_{2}$. The circuit is very similar to the MOS cascode, and the small-signal analysis will follow in a parallel fashion. First, note that the input resistance of the bipolar cascode amplifier is finite,

$$
R_{\mathrm{in}}=r_{\pi 1}
$$

Second, recall that the current signal in the collector of $Q_{2}$ will be approximately equal to $g_{m 1} v_{i}$. Thus, the equivalent circuit of the output of the cascode amplifier will be that shown in Fig. 8.37(b). To obtain $R_{o}$ we use the formula in Eq. (8.68) and note that the resistance $R_{e}$ in the emitter of $Q_{2}$ is $r_{o 1}$, thus

$$
R_{o} \simeq r_{o 2}+\left(g_{m 2} r_{o 2}\right)\left(r_{o 1} \| r_{\pi 2}\right)
$$

Since $g_{m 2}\left(r_{o 1} \| r_{\pi 2}\right) \gg 1$, we can neglect the first term on the right-hand side of Eq. (8.87),

$$
R_{o} \simeq\left(g_{m 2} r_{o 2}\right)\left(r_{o 1} \| r_{\pi 2}\right)
$$

This result is similar but certainly not identical to that for the MOS cascode. Here, because of the finite $\beta$ of the BJT, we have $r_{\pi 2}$ appearing in parallel with $r_{o 1}$. This poses a very significant constraint on $R_{o}$ of the BJT cascode. Specifically, because $\left(r_{o 1} \| r_{\pi 2}\right)$ will always be lower than $r_{\pi 2}$, it follows that the maximum possible value of $R_{o}$ is

$$
\begin{aligned}
\left.R_{o}\right|_{\max } & =g_{m 2} r_{o 2} r_{\pi 2} \\
& =\left(g_{m 2} r_{\pi 2}\right) r_{o 2}=\beta_{2} r_{o 2}
\end{aligned}
$$

Thus the maximum output resistance realizable by cascoding is $\beta_{2} r_{o 2}$. This means that unlike the MOS case, double cascoding with a BJT would not be useful.


Figure 8.37 (a) A BJT cascode amplifier with an ideal current-source load; (b) small-signal, equivalent-circuit representation of the output of the cascode amplifier.
The open-circuit voltage gain of the bipolar cascode can be found using the equivalent circuit of Fig. 8.37(b) as

$$
A_{v o}=\frac{v_{o}}{v_{i}}=-g_{m 1} R_{o}
$$

Thus,

$$
A_{v o}=-g_{m 1}\left(g_{m 2} r_{o 2}\right)\left(r_{o 1} \| r_{\pi 2}\right)
$$

For the case $g_{m 1}=g_{m 2}, r_{o 1}=r_{o 2}$,

$$
A_{v o}=-\left(g_{m} r_{o}\right)\left[g_{m}\left(r_{o} \| r_{\pi}\right)\right]
$$

which will be less than $\left(g_{m} r_{o}\right)^{2}$ in magnitude. In fact, the maximum possible gain magnitude is obtained when $r_{o} \gg r_{\pi}$ and is given by

$$
\left|A_{v o}\right|_{\max }=\beta g_{m} r_{o}=\beta A_{0}
$$

Finally, we note that to be able to realize gains approaching this level, the current-source load must also be cascoded. Figure 8.38 shows a cascode BJT amplifier with a cascode current-source load.


Figure 8.38 A BJT cascode amplifier with a cascode current source.
# EXERCISES 

8.23 Find an expression for the maximum voltage gain achieved in the amplifier of Fig. 8.38. Ans. $\left|A_{v \max }\right|=g_{m 1}\left(\beta_{2} r_{o 2} \| \beta_{3} r_{o 3}\right)$
8.24 Consider the BJT cascode amplifier of Fig. 8.38 when biased at a current of 0.2 mA . Assuming that $n p n$ transistors have $\beta=100$ and $V_{A}=5 \mathrm{~V}$ and that $p n p$ transistors have $\beta=50$ and $\left|V_{A}\right|=4 \mathrm{~V}$, find $R_{o u}, R_{o p}$, and $A_{v}$. Also use the result of Exercise 8.23 to determine the maximum achievable gain.
Ans. $1.67 \mathrm{M} \Omega ; 0.762 \mathrm{M} \Omega ;-4186 \mathrm{~V} / \mathrm{V} ;-5714 \mathrm{~V} / \mathrm{V}$

### 8.6 Current-Mirror Circuits with Improved Performance

As we have seen throughout this chapter, current sources play a major role in the design of IC amplifiers: The constant-current source is used both in biasing and as active load. Simple forms of both MOS and bipolar current sources and, more generally, current mirrors were studied in Section 8.2. The need to improve the characteristics of the simple sources and mirrors has already been demonstrated.

Specifically, three performance parameters need to be addressed:

1. The accuracy of the current transfer ratio of the mirror. For bipolar mirrors, this parameter is primarily affected by the transistor $\beta$. For both bipolar and MOS mirrors, the Early effect affects the current transfer ratio.
2. The output resistance, $R_{o}$. The need to increase the output resistance of current sources is motivated by the need to increase the voltage gain achievable in an amplifier stage. While simple bipolar and MOS mirrors have output resistances equal to $r_{o}$, cascoding can be used to increase the output resistance.
3. The minimum dc voltage required across the current source. The need to keep this voltage as small as possible stems from the low dc voltage supplies employed in modern IC technologies. Simple BJT and MOS sources can operate with dc voltages in the range of 0.2 V to 0.3 V . More elaborate mirror circuits usually require higher voltages.

In this section we study MOS and bipolar current mirrors that feature improvements in one or more of these characteristics.

### 8.6.1 Cascode MOS Mirrors

The use of cascoding in the design of current sources was presented in Section 8.5. Figure 8.39 shows the basic cascode current mirror. Observe that in addition to the diode-connected transistor $Q_{1}$, which forms the basic mirror $Q_{1}-Q_{2}$, another diode-connected transistor, $Q_{4}$, is used to provide a suitable bias voltage for the gate of the cascode transistor $Q_{3}$. To determine the output resistance of the cascode mirror at the drain of $Q_{3}$, we assume that the voltages


Figure 8.39 A cascode MOS current mirror.
across $Q_{1}$ and $Q_{4}$ are constant, and thus the signal voltages at the gates of $Q_{2}$ and $Q_{3}$ will be zero. Thus $R_{o}$ will be that of the cascode current source formed by $Q_{2}$ and $Q_{3}$,

$$
R_{\mathrm{o}} \simeq g_{m 3} r_{o 3} r_{o 2}
$$

Thus, as expected, cascoding raises the output resistance of the current source by the factor $\left(g_{m 3} r_{o 3}\right)$, which is the intrinsic gain of the cascode transistor.

A drawback of the cascode current mirror is that it consumes a relatively large portion of the steadily shrinking supply voltage $V_{D D}$. While the simple MOS mirror operates properly with a voltage as low as $V_{O V}$ across its output transistor, the cascode circuit of Fig. 8.39 requires a minimum voltage of $V_{i}+2 V_{O V}$. This is because the gate of $Q_{3}$ is at $2 V_{G S}=2 V_{i}+2 V_{O V}$. Thus the minimum voltage required across the output of the cascode mirror is 1 V or so. This obviously limits the signal swing at the output of the mirror (i.e., at the output of the amplifier that utilizes this current source as a load). In Chapter 13 we shall study a wide-swing cascode mirror.

# EXERCISE 

8.25 For a cascode MOS mirror utilizing devices with $V_{i}=0.5 \mathrm{~V}, \mu_{\mathrm{a}} C_{o s}=387 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{A}^{\prime}=5 \mathrm{~V} / \mu \mathrm{m}$, $W / L=3.6 \mu \mathrm{~m} / 0.36 \mu \mathrm{~m}$, and $I_{\mathrm{REF}}=100 \mu \mathrm{~A}$, find the minimum voltage required at the output and the output resistance.
Ans. $0.95 \mathrm{~V} ; 285 \mathrm{k} \Omega$

### 8.6.2 The Wilson Current Mirror

A simple but ingenious modification of the basic bipolar mirror results in both reducing the $\beta$ dependence and increasing the output resistance. The resulting circuit, known as the Wilson mirror after its inventor George Wilson, an IC design engineer working for Tektronix, is shown in Fig. 8.40(a). The analysis to determine the effect of finite $\beta$ on the current transfer


Figure 8.40 The Wilson bipolar current mirror: (a) circuit showing analysis to determine the current transfer ratio; (b) determining the output resistance.
ratio is shown in Fig. 8.40(a), from which we can write

$$
\begin{aligned}
\frac{I_{o}}{I_{\mathrm{REF}}} & =\frac{I_{C}\left(1+\frac{2}{\beta}\right) \beta /(\beta+1)}{I_{C}\left[1+\left(1+\frac{2}{\beta}\right) /(\beta+1)\right]} \\
& =\frac{\beta+2}{\beta+1+\frac{\beta+2}{\beta}}=\frac{\beta+2}{\beta+2+\frac{2}{\beta}} \\
& =\frac{1}{1+\frac{2}{\beta(\beta+2)}} \\
& \simeq \frac{1}{1+2 / \beta^{2}}
\end{aligned}
$$

which is much less dependent on $\beta$ than in the case of the simple current mirror.
This analysis assumes that $Q_{1}$ and $Q_{2}$ conduct equal collector currents. There is, however, a slight problem with this assumption: The collector-to-emitter voltages of $Q_{1}$ and $Q_{2}$ are not equal, which introduces a current offset or a systematic error. The problem can be solved by adding a diode-connected transistor in series with the collector of $Q_{2}$, as we shall shortly show for the MOS version.

To determine the output resistance of the Wilson mirror, we set $I_{\mathrm{REF}}=0$ and apply a test voltage $v_{x}$ to the output node, as shown in Fig. 8.40(b). Our purpose is to determine the current $i_{x}$ and hence $R_{o}$ as

$$
R_{o}=v_{x} / i_{x}
$$Rather than replacing each transistor with its hybrid- $\pi$ model, we shall do the analysis directly on the circuit diagram. For this purpose, we have "pulled $r_{o}$ out" of each transistor and shown it separately.

Observe that transistor $Q_{3}$, viewed as a supernode (highlighted in color), has a current $i_{x}$ entering it and two currents $i_{1}$ and $i_{2}$ exiting it; thus,

$$
i_{1}+i_{2}=i_{x}
$$

Next note that the action of current mirror $Q_{1}-Q_{2}$ forces $i_{2}$ to be approximately equal to $i_{1}$; thus,

$$
i_{2} \simeq i_{1}=i_{x} / 2
$$

Current $i_{2}$ flows into the base of $Q_{3}$ and thus gives rise to a collector current $\beta_{3} i_{2}$ in the direction indicated. We are now in a position to write a node equation at the collector of $Q_{3}$ and thus determine the current through $r_{o 3}$ as $i_{x}+\beta_{3} i_{2}=i_{x}+\beta_{3}\left(i_{x} / 2\right)=i_{x}\left(\beta_{3} / 2+1\right)$. Finally, we can express the voltage between the collector of $Q_{3}$ and ground as the sum of the voltage drop across $r_{o 3}$ and the voltage $v$ across $Q_{1}$,

$$
\begin{aligned}
v_{x} & =i_{x}\left(\frac{\beta_{3}}{2}+1\right) r_{o 3}+i_{1} r_{e 1} \\
& =i_{x}\left(\frac{\beta_{3}}{2}+1\right) r_{o 3}+\left(\frac{i_{x}}{2}\right) r_{e 1}
\end{aligned}
$$

Since $r_{o} \gg r_{e}$ and $\beta_{3} \gg 2$

$$
v_{x} \simeq i_{x}\left(\frac{\beta_{3}}{2}\right) r_{o 3}
$$

and

$$
R_{o}=\beta_{3} r_{o 3} / 2
$$

Thus the Wilson current mirror has an output resistance $\left(\frac{1}{2} \beta_{3}\right)$ times higher than that of $Q_{3}$ alone. This is a result of the negative feedback obtained by feeding the collector current of $Q_{2}\left(i_{2}\right)$ back to the base of $Q_{3}$. As can be seen from the above analysis, this feedback results in increasing the current through $r_{o 3}$ to approximately $\frac{1}{2} \beta_{3} i_{x}$, and thus the voltage across $r_{o 3}$ and the output resistance increase by the same factor, $\frac{1}{2} \beta_{3}$. Finally, note that the factor $\frac{1}{2}$ is because only half of $i_{x}$ is mirrored back to the base of $Q_{3}$.

The Wilson mirror is preferred over the cascode circuit because the latter has the same dependence on $\beta$ as the simple mirror. However, like the cascode mirror, the Wilson mirror requires an additional $V_{R E}$ drop for its operation; that is, for proper operation we must allow for 1 V or so across the Wilson mirror output.
# EXERCISE 

8.26 For $\beta=100$ and $r_{o}=100 \mathrm{k} \Omega$, contrast the Wilson mirror and the simple mirror by evaluating the transfer-ratio error due to finite $\beta$, and the output resistance.
Ans. Transfer-ratio error: $0.02 \%$ for Wilson as opposed to $2 \%$ for the simple circuit; $R_{o}=5 \mathrm{M} \Omega$ for Wilson compared to $100 \mathrm{k} \Omega$ for the simple circuit

### 8.6.3 The Wilson MOS Mirror

Figure 8.41(a) shows the MOS version of the Wilson mirror. Obviously there is no $\beta$ error to reduce here, and the advantage of the MOS Wilson lies in its enhanced output resistance.

To determine the output resistance of the Wilson MOS mirror, we set $I_{\text {REF }}=0$, and apply a test voltage $v_{x}$ to the output node, as shown in Fig. 8.41(b). Our purpose is to determine the current $i_{x}$ and hence $R_{o}$ as

$$
R_{o}=v_{x} / i_{x}
$$

Rather than replacing each transistor with its hybrid- $\pi$ equivalent-circuit model, we shall perform the analysis directly on the circuit. For this purpose, we have "pulled $r_{o}$ out" of each transistor and shown it separately.


Figure 8.41 The Wilson MOS mirror: (a) circuit; (b) analysis to determine output resistance; (c) modified circuit.

(c)

Figure 8.41 continued

Observe that the current $i_{s}$ that enters the drain of $Q_{3}$ must exit at its source. Thus the current that feeds the input side of the $Q_{1}-Q_{2}$ mirror is equal to $i_{s}$. Most of this current will flow in the drain proper of $Q_{1}$ (i.e., only a very small fraction flows through $r_{o 1}$ ) and will give rise to a voltage $v \simeq i_{s} / g_{m 1}$, where $1 / g_{m 1}$ is the approximate resistance of the diode-connected transistor $Q_{1}$. The current-mirror action of $\left(Q_{1}, Q_{2}\right)$ forces a current equal to $i_{s}$ to flow through the drain proper of $Q_{2}$. Now, since the current in the drain of $Q_{2}$ is forced (by the connection to the gate of $Q_{3}$ ) to be zero, all of $i_{s}$ must flow through $r_{o 2}$, resulting in a voltage $-i_{s} r_{o 2}$. This is the voltage fed back to the gate of $Q_{3}$. The drain current of $Q_{3}$ can now be found as

$$
\begin{aligned}
i_{d 3} & =g_{m 3} v_{g s 3} \\
& =g_{m 3}\left(v_{g 3}-v_{s 3}\right) \\
& =g_{m 3}\left(-i_{s} r_{o 2}-i_{s} / g_{m 1}\right) \\
& \simeq-g_{m 3} r_{o 2} i_{s}
\end{aligned}
$$

A node equation at the drain of $Q_{3}$ gives the current through $r_{o 3}$ as $\left(i_{s}-i_{d 3}\right)=i_{s}+g_{m 3} r_{o 2} i_{s} \simeq$ $g_{m 3} r_{o 2} i_{s}$. Finally, we can express $v_{s}$ as the sum of the voltage drop across $r_{o 3}$ and the voltage $v$ across $Q_{1}$,

$$
\begin{aligned}
v_{s} & =g_{m 3} r_{o 2} i_{s} r_{o 3}+v \\
& =\left(g_{m 3} r_{o 3} r_{o 2}\right) i_{s}+\left(i_{s} / g_{m 1}\right) \\
& \simeq g_{m 3} r_{o 3} r_{o 2} i_{s}
\end{aligned}
$$

and obtain

$$
R_{o}=\frac{v_{s}}{i_{s}}=\left(g_{m 3} r_{o 3}\right) r_{o 2}
$$

Thus, the Wilson MOS mirror exhibits an increase of output resistance by a factor $\left(g_{m 3} r_{o 3}\right)$, an identical result to that achieved in the cascode mirror. Here the increase in $R_{o}$, as demonstrated in the analysis above, is a result of the negative feedback obtained by connecting the drain of $Q_{2}$ to the gate of $Q_{3}$. Finally, to balance the two branches of the mirror and thus avoid the systematic current error resulting from the difference in $V_{D S}$ between $Q_{1}$ and $Q_{2}$, the circuit can be modified as shown in Fig. 8.41(c).


Figure 8.42 The Widlar current source.

# 8.6.4 The Widlar Current Source ${ }^{4}$ 

Our final current-source circuit, known as the Widlar current source, is shown in Fig. 8.42. It differs from the basic current-mirror circuit in an important way: A resistor $R_{E}$ is included in the emitter lead of $Q_{2}$. Neglecting base currents we can write

$$
V_{B E 1}=V_{T} \ln \left(\frac{I_{\mathrm{REF}}}{I_{S}}\right)
$$

and

$$
V_{B E 2}=V_{T} \ln \left(\frac{I_{O}}{I_{S}}\right)
$$

where we have assumed that $Q_{1}$ and $Q_{2}$ are matched devices. Combining Eqs. (8.97) and (8.98) gives

$$
V_{B E 1}-V_{B E 2}=V_{T} \ln \left(\frac{I_{\mathrm{REF}}}{I_{O}}\right)
$$

But from the circuit we see that

$$
V_{B E 1}=V_{B E 2}+I_{O} R_{E}
$$

Thus,

$$
I_{O} R_{E}=V_{T} \ln \left(\frac{I_{\mathrm{REF}}}{I_{O}}\right)
$$

The design and advantages of the Widlar current source are illustrated in the following example.

[^0]
[^0]:    ${ }^{4}$ Named after Robert Widlar, a pioneer in analog IC design.
# Example 8.6 

The two circuits for generating a constant current $I_{i t}=10 \mu \mathrm{~A}$ shown in Fig. 8.43 operate from a $10-\mathrm{V}$ supply. Determine the values of the required resistors, assuming that $V_{B E}$ is 0.7 V at a current of 1 mA and neglecting the effect of finite $\beta$.


Figure 8.43 Circuits for Example 8.6.

## Solution

For the basic current-source circuit in Fig. 8.43(a) we choose a value for $R_{1}$ to result in $I_{\mathrm{REF}}=10 \mu \mathrm{~A}$. At this current, the voltage drop across $Q_{1}$ will be

$$
V_{B E 1}=0.7+V_{r} \ln \left(\frac{10 \mu \mathrm{~A}}{1 \mathrm{~mA}}\right)=0.58 \mathrm{~V}
$$

Thus,

$$
R_{1}=\frac{10-0.58}{0.01}=942 \mathrm{k} \Omega
$$

For the Widlar circuit in Fig. 8.43(b) we must first decide on a suitable value for $I_{\text {REF }}$. If we select $I_{\text {REF }}=$ 1 mA , then $V_{B E 1}=0.7 \mathrm{~V}$ and $R_{2}$ is given by

$$
R_{2}=\frac{10-0.7}{1}=9.3 \mathrm{k} \Omega
$$

The value of $R_{3}$ can be determined using Eq. (8.101) as follows:

$$
\begin{aligned}
10 \times 10^{-6} R_{3} & =0.025 \ln \left(\frac{1 \mathrm{~mA}}{10 \mu \mathrm{~A}}\right) \\
R_{3} & =11.5 \mathrm{k} \Omega
\end{aligned}
$$
From the above example we observe that using the Widlar circuit allows the generation of a small constant current using relatively small resistors. This is an important advantage that results in considerable savings in chip area. In fact the circuit of Fig. 8.43(a), requiring a $942-\mathrm{k} \Omega$ resistance, is totally impractical for implementation in IC form because of the very high value of resistor $R_{1}$.

Another important characteristic of the Widlar current source is that its output resistance is high. The increase in the output resistance, above that achieved in the basic current source, is due to the emitter-degeneration resistance $R_{E}$. To determine the output resistance of $Q_{2}$, we assume that since the base of $Q_{2}$ is connected to ground via the small resistance $r_{e}$ of $Q_{1}$, the incremental voltage at the base will be small. Thus we can use the formula in Eq. (8.70) and adapt it for our purposes here as follows:

$$
R_{\text {out }} \simeq\left[1+g_{m}\left(R_{E} \| r_{n}\right)\right] r_{o}
$$

Thus the output resistance is increased above $r_{o}$ by a factor that can be significant.

# EXERCISE 

8.27 Find the output resistance of each of the two current sources designed in Example 8.6. Let $V_{A}=100 \mathrm{~V}$ and $\beta=100$.
Ans. $10 \mathrm{M} \Omega ; 54 \mathrm{M} \Omega$

### 8.7 Some Useful Transistor Pairings

The cascode configuration studied in Section 8.5 combines CS and CG MOS transistors (CE and CB bipolar transistors) to great advantage. The key to the superior performance of the resulting combination is that the transistor pairing is done in a way that maximizes the advantages and minimizes the shortcomings of each of the two individual configurations. In this section we present a number of other such transistor pairings. In each case the transistor pair can be thought of as a compound device; thus the resulting amplifier may be considered as a single stage.

### 8.7.1 The CC-CE, CD-CS, and CD-CE Configurations

Figure 8.44(a) shows an amplifier formed by cascading a common-collector (emitter-follower) transistor $Q_{1}$ with a common-emitter transistor $Q_{2}$. This circuit has two main advantages over the CE amplifier. First, the emitter follower increases the input resistance by a factor equal to $\left(\beta_{1}+1\right)$. As a result, the overall voltage gain is increased, especially if the resistance of the signal source is large. Second, it will be shown in Chapter 10 that the CC-CE amplifier can exhibit much wider bandwidth than that obtained with the CE amplifier.

The MOS counterpart of the CC-CE amplifier, namely, the CD-CS configuration, is shown in Fig. 8.44(b). Here, since the CS amplifier alone has an infinite input resistance, the


Figure 8.44 (a) CC-CE amplifier; (b) CD-CS amplifier; (c) CD-CE amplifier.
sole purpose for adding the source-follower stage is to increase the amplifier bandwidth, as will be seen in Chapter 10. Finally, Fig. 8.44(c) shows the BiCMOS version of this circuit type. Compared to the bipolar circuit in Fig. 8.44(a), the BiCMOS circuit has an infinite input resistance. Compared to the MOS circuit in Fig. 8.44(b), the BiCMOS circuit typically has a higher $g_{m 2}$.

The IC Source Follower Since a number of the circuit configurations discussed in this section utilize an input source follower, we digress briefly to consider the IC source follower (the discrete-circuit source follower was studied in Section 7.3.6). Figure 8.45(a) shows a source follower formed by transistor $Q_{1}$ and biased by a constant-current supplied by the current mirror $Q_{2}-Q_{3}$. Observe that since the source of $Q_{1}$ cannot be connected to the body (which is at signal ground potential) a voltage signal $v_{b s}$ develops between body and source and gives rise to a current signal $g_{m b} v_{b s}$, as indicated in the equivalent circuit in Fig. 8.45(b). The equivalent circuit shows also the output resistance $r_{o 3}$ of the bias current source $Q_{3}$, which acts as a load resistance for the follower $Q_{1}$.

An important observation to make from the equivalent circuit is that the controlled source $\left(g_{m b} v_{b s}\right)$ appears across its control voltage $v_{b s}$. Thus we can use the source-absorption theorem (Appendix G) to replace the controlled source with a resistance $1 / g_{m b}$. Next, note that the three


Figure 8.45 (a) A source follower biased with a current mirror $Q_{2}-Q_{3}$ and with the body terminal indicated. Note that the source cannot be connected to the body and thus the body effect should be taken into account. (b) Equivalent circuit.
resistances $1 / g_{m b}, r_{o 1}$, and $r_{o 3}$ appear in parallel between the source and ground. If we denote their parallel equivalent $R_{L}$, we can easily show that the voltage gain of the source follower is given by

$$
\frac{v_{o}}{v_{i}}=\frac{R_{L}}{R_{L}+\frac{1}{g_{m}}}
$$

where

$$
R_{L}=r_{o 1}\left\|r_{o 3}\right\| \frac{1}{g_{m b}}
$$

In cases where $\frac{1}{g_{m b}} \ll r_{o 1}, r_{o 3}$,

$$
R_{L} \simeq \frac{1}{g_{m b}}
$$

and

$$
\frac{v_{o}}{v_{i}} \simeq \frac{g_{m b}}{g_{m}+g_{m b}}
$$

Substituting for $g_{m b}=\chi g_{m}$ where $\chi=0.1$ to 0.2 ,

$$
\frac{v_{o}}{v_{i}} \simeq \frac{1}{1+\chi}
$$

This is the maximum possible gain obtained from an IC source follower. The actual gain realized will usually be lower because of the effect of $r_{o 1}$ and $r_{o 3}$.

# EXERCISE 

8.28 For the source follower in Fig. 8.45(a), let the bias current of $Q_{1}$ be $200 \mu \mathrm{~A}$ and assume $Q_{1}$ is operating at $V_{O V}=0.2 \mathrm{~V}$. If $V_{A}=5 \mathrm{~V}$ and $\chi=0.2$, find the voltage gain of the source follower. Ans. $0.81 \mathrm{~V} / \mathrm{V}$
# Example 8.7 

For the CC-CE amplifier in Fig. 8.44(a) let $I_{1}=I_{2}=1 \mathrm{~mA}$ and assume identical transistors with $\beta=100$. Find the input resistance $R_{\text {in }}$ and the overall voltage gain obtained when the amplifier is fed with a signal source having $R_{\text {sig }}=4 \mathrm{k} \Omega$ and loaded with a resistance $R_{L}=4 \mathrm{k} \Omega$. Compare the results with those obtained with a common-emitter amplifier operating under the same conditions. Ignore $r_{o}$.

## Solution

At an emitter current of $1 \mathrm{~mA}, Q_{1}$ and $Q_{2}$ have

$$
\begin{aligned}
& g_{m}=40 \mathrm{~mA} / \mathrm{V} \\
& r_{e}=25 \Omega \\
& r_{\pi}=\frac{\beta}{g_{m}}=\frac{100}{40}=2.5 \mathrm{k} \Omega
\end{aligned}
$$



Figure 8.46 Circuit for Example 8.7.
Referring to Fig. 8.46 we can find

$$
\begin{aligned}
R_{\mathrm{in} 2} & =r_{\pi 2}=2.5 \mathrm{k} \Omega \\
R_{\mathrm{in}} & =\left(\beta_{1}+1\right)\left(r_{e 1}+R_{\mathrm{in} 2}\right) \\
& =101(0.025+2.5)=255 \mathrm{k} \Omega \\
\frac{v_{b 1}}{v_{\text {sig }}} & =\frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}}=\frac{255}{255+4}=0.98 \mathrm{~V} / \mathrm{V} \\
\frac{v_{b 2}}{v_{b 1}} & =\frac{R_{\text {in } 2}}{R_{\text {in } 2}+r_{e 1}}=\frac{2.5}{2.5+0.025}=0.99 \mathrm{~V} / \mathrm{V} \\
\frac{v_{o}}{v_{b 2}} & =-g_{m 2} R_{L}=-40 \times 4=-160 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$
Thus,

$$
G_{v}=\frac{v_{n}}{v_{\text {sig }}}=-160 \times 0.99 \times 0.98=-155 \mathrm{~V} / \mathrm{V}
$$

For comparison, a CE amplifier operating under the same conditions will have

$$
\begin{aligned}
R_{\text {in }} & =r_{n}=2.5 \mathrm{k} \Omega \\
G_{v} & =\frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}}\left(-g_{m} R_{L}\right) \\
& =\frac{2.5}{2.5+4}(-40 \times 4) \\
& =-61.5 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

# EXERCISE 

8.29 Repeat Example 8.7 for the CD-CE configuration of Fig. 8.44(c). Let $I_{1}=I_{2}=1 \mathrm{~mA}, \beta_{2}=100$, $R_{\mathrm{L}}=4 \mathrm{k} \Omega$, and $k_{\mathrm{el}}=8 \mathrm{~mA} / \mathrm{V}^{2}$; neglect the body effect in $Q_{1}$ and $r_{n}$ of both transistors. Find $R_{\text {in }}$ and $G_{v}$ when $R_{\text {sig }}=4 \mathrm{k} \Omega$ (as in Example 8.7) and $R_{\text {sig }}=400 \mathrm{k} \Omega$. What would $G_{v}$ of the CC-CE amplifier in Example 8.7 become for $R_{\text {sig }}=400 \mathrm{k} \Omega$ ?
Ans. $R_{\text {in }}=\infty ; G_{v}=-145.5 \mathrm{~V} / \mathrm{V}$, independent of $R_{\text {sig }} ;-61.7 \mathrm{~V} / \mathrm{V}$

### 8.7.2 The Darlington Configuration ${ }^{5}$

Figure 8.47(a) shows a popular BJT circuit known as the Darlington configuration. It can be thought of as a variation of the $\mathrm{CC}-\mathrm{CE}$ circuit with the collector of $Q_{1}$ connected to that of $Q_{2}$. Alternatively, the Darlington pair can be thought of as a composite transistor with $\beta=\beta_{1} \beta_{2}$. It can therefore be used to implement a high-performance voltage follower, as illustrated in Fig. 8.47(b). Note that in this application the circuit can be considered as the cascade connection of two common-collector transistors (i.e., a $\mathrm{CC}-\mathrm{CC}$ configuration).

Since the transistor $\beta$ depends on the dc bias current, it is possible that $Q_{1}$ will be operating at a very low $\beta$, rendering the $\beta$-multiplication effect of the Darlington pair rather ineffective. A simple solution to this problem is to provide a bias current for $Q_{1}$, as shown in Fig. 8.47(c).

[^0]
[^0]:    ${ }^{5}$ Named after Sidney Darlington, a pioneer in filter design and transistor circuit design.

Figure 8.47 (a) The Darlington configuration; (b) voltage follower using the Darlington configuration; (c) the Darlington follower with a bias current $I$ supplied to $Q_{1}$ to ensure that its $\beta$ remains high.

# EXERCISE 

8.30 For the Darlington voltage follower in Fig. 8.47(b), show that:

$$
\begin{aligned}
R_{\text {in }} & =\left(\beta_{1}+1\right)\left[r_{e 1}+\left(\beta_{2}+1\right)\left(r_{e 2}+R_{E}\right)\right] \\
R_{\text {out }} & =R_{E} \|\left[r_{e 2}+\frac{r_{e 1}+\left[R_{\text {sig }} /\left(\beta_{1}+1\right)\right]}{\beta_{2}+1}\right] \\
\frac{v_{o}}{v_{\text {sig }}} & =\frac{R_{E}}{R_{E}+r_{e 2}+\left[r_{e 1}+R_{\text {sig }} /\left(\beta_{1}+1\right)\right] /\left(\beta_{2}+1\right)}
\end{aligned}
$$

Evaluate $R_{\text {in }}, R_{\text {out }}$, and $v_{o} / v_{\text {sig }}$ for the case $I_{E 2}=5 \mathrm{~mA}, \beta_{1}=\beta_{2}=100, R_{E}=1 \mathrm{k} \Omega$, and $R_{\text {sig }}=100 \mathrm{k} \Omega$. Ans. $10.3 \mathrm{M} \Omega ; 20 \Omega ; 0.98 \mathrm{~V} / \mathrm{V}$

### 8.7.3 The CC-CB and CD-CG Configurations

Cascading an emitter follower with a common-base amplifier, as shown in Fig. 8.48(a), results in a circuit with a low-frequency gain approximately equal to that of the CB but with the problem of the low input resistance of the CB solved by the buffering action of the CC stage. It will be shown in Chapter 10 that this circuit exhibits wider bandwidth than that obtained with a CE amplifier of the same gain. Note that the biasing current sources shown in Fig. 8.48(a) ensure that each of $Q_{1}$ and $Q_{2}$ is operating at a bias current $I$. We are not showing, however, how the dc voltage at the base of $Q_{1}$ is set, nor do we show the circuit that determines the


Figure 8.48 (a) A CC-CB amplifier. (b) Another version of the CC-CB circuit with $Q_{2}$ implemented using a pnp transistor. (c) The MOSFET version of the circuit in (a).
dc voltage at the collector of $Q_{2}$. Both issues are usually looked after in the larger circuit of which the $\mathrm{CC}-\mathrm{CB}$ amplifier is a part.

An interesting version of the CC-CB configuration is shown in Fig. 8.48(b). Here the CB stage is implemented with a pnp transistor. Although only one current source is now needed, observe that we also need to establish an appropriate bias voltage at the base of $Q_{2}$. This circuit is part of the internal circuit of the popular 741 op amp, which will be studied in Chapter 13.

The MOSFET version of the circuit in Fig. 8.48(a) is the CD-CG amplifier shown in Fig. 8.48(c).

# Example 8.8 

For the CC-CB amplifiers in Fig. 8.48(a) and (b), find $R_{\mathrm{in}}, v_{o} / v_{i}$, and $v_{o} / v_{\text {sig }}$ when each amplifier is fed with a signal source having a resistance $R_{\text {sig }}$, and a load resistance $R_{L}$ is connected at the output. For simplicity, neglect $r_{o}$.

## Solution

The analysis of both circuits is illustrated in Fig. 8.49. Observe that both amplifiers have the same $R_{\text {in }}$ and $v_{o} / v_{i}$. The overall voltage gain $v_{o} / v_{\text {sig }}$ can be found as

$$
\frac{v_{o}}{v_{\text {sig }}}=\frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}} \frac{\alpha_{2} R_{L}}{2 r_{e}}
$$
# Example 8.8 continued 


(a)

(b)

Figure 8.49 Circuits for Example 8.8.

## EXERCISES

8.31 For the amplifiers in Example 8.8 find $R_{\mathrm{in}}, v_{o} / v_{i}$, and $v_{o} / v_{\text {sig }}$ for the case $I=1 \mathrm{~mA}, \beta=100$. $R_{L}=R_{\text {sig }}=5 \mathrm{k} \Omega$.
Ans. $5.05 \mathrm{k} \Omega ; 100 \mathrm{~V} / \mathrm{V} ; 50 \mathrm{~V} / \mathrm{V}$
D8.32 (a) Neglecting $r_{o 1}$ and the body effect, show that the voltage gain $v_{o} / v_{i}$ of the CD-CG amplifier shown earlier in Fig. 8.48(c) is given by

$$
\frac{v_{o}}{v_{i}}=\frac{I R_{L}}{V_{O V}}
$$

where $R_{L}$ is a load resistance connected at the output and $V_{O V}$ is the overdrive voltage at which each of $Q_{1}$ and $Q_{2}$ is operating.
(b) For $I=0.1 \mathrm{~mA}$ and $R_{L}=20 \mathrm{k} \Omega$, find $W / L$ for each of $Q_{1}$ and $Q_{2}$ to obtain a gain of $10 \mathrm{~V} / \mathrm{V}$. Assume $k_{n}^{\prime}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$.
Ans. (b) $W / L=25$

## Summary

- Integrated-circuit fabrication technology offers the circuit designer many exciting opportunities, the most important of which is the large number of inexpensive small-area MOS transistors. An overriding concern for IC designers, however, is the minimization of chip area or "silicon real estate." As a result, large-valued resistors and capacitors are virtually absent.
- Biasing in integrated circuits utilizes current sources. As well, current sources are used as load devices. Typically an accurate and stable reference current is generated and then replicated to provide bias currents for the various amplifier stages on the chip. The heart of the current-steering circuitry utilized to perform this function is the current mirror.
- The MOS current mirror has a current transfer ratio of $(W / L)_{f} /(W / L)_{1}$. For a bipolar mirror, the ratio is $I_{S 2} / I_{S 1}$.
- Bipolar mirrors suffer from the finite $\beta$, which reduces the accuracy of the current transfer ratio.
- Both bipolar and MOS mirrors of the basic type have a finite output resistance equal to $r_{o}$ of the output device. Also, for proper operation, a voltage of at least 0.3 V is required across the output transistor of a simple bipolar mirror ( $\left|V_{O V}\right|$ for the MOS case).
- The basic gain cell of IC amplifiers is the CS (CE) amplifier with a current-source load. For an ideal current-source load (i.e., one with infinite output resistance), the transistor operates in an open-circuit fashion and thus provides the maximum gain possible, $A_{v o}=-g_{m} r_{o}=-A_{0}$.
- The intrinsic gain $A_{0}$ is given by $A_{0}=V_{h} / V_{T}$ for a BJT and $A_{0}=V_{h} /\left(V_{O V} / 2\right)$ for a MOSFET. For a BJT, $A_{0}$ is constant independent of bias current and device dimensions. For
a MOSFET, $A_{0}$ is inversely proportional to $\sqrt{I_{D}}$ (see Eq. 8.46).
- Simple current-source loads reduce the gain realized in the basic gain cell because of their finite output resistance (usually comparable to the value of $r_{o}$ of the amplifying transistor).
- To raise the output resistance of the CS or CE transistor, we stack a CG or CB transistor on top. This is cascoding.
- The CG and CB amplifiers act as current buffers. They have a short-circuit current gain of unity or, equivalently, a short-circuit transconductance equal to $g_{m}$ of the transistor. For the CG: $R_{m}=\frac{r_{o}+R_{L}}{g_{m} r_{o}}$ and $R_{\text {out }}=R_{s}+r_{o}+g_{m} r_{o} R_{s}$. For the CB: $R_{m}=r_{s} \frac{r_{o}+R_{L}}{r_{o}+\frac{R_{L}}{\beta+1}}$ and $R_{\text {out }}=\left(R_{s} \| r_{o}\right)+r_{o}+g_{m} r_{o}\left(R_{s} \| r_{o}\right)$.
- The CG or CB transistor in the cascode passes the current $g_{m 1} v_{i}$ provided by the CS or CE transistor to the output but increases the resistance at the output from $r_{o 1}$ to $\left(g_{m 2} r_{o 2}\right) r_{o 1}$ in the MOS case $\left\{g_{m 2} r_{o 2}\left(r_{o 1} \| r_{o 2}\right)\right.$ in the bipolar case $\}$. The maximum output resistance achieved in the bipolar case is $\beta_{2} r_{o 2}$.
- A MOS cascode amplifier operating with an ideal current-source load achieves a gain of $\left(g_{m} r_{o}\right)^{2}=A_{0}^{2}$.
- To realize the full advantage of cascoding, the load current-source must also be cascoded, in which case a gain as high as $\frac{1}{2} A_{0}^{2}$ can be obtained.
- Double cascoding is possible in the MOS case only. However, the large number of transistors in the
stack between the power-supply rails results in the disadvantage of a severely limited output-signal swing. The folded-cascode configuration helps resolve this issue.

- A CS amplifier with a resistance $R_{s}$ in its source lead has an output resistance $R_{o} \simeq\left(1+g_{m} R_{s}\right) r_{o}$. The corresponding formula for the BJT case is $R_{o}=\left[1+g_{m}\left(R_{s} \| r_{o}\right)\right] r_{o}$.
- Cascoding can be applied to current mirrors to increase their output resistances. An alternative that also solves the $\beta$ problem in the bipolar case is the Wilson circuit. The MOS Wilson mirror has an output resistance of $\left(g_{m} r_{o}\right) r_{o}$, and the BJT version has an output resistance of $\frac{1}{2} \beta r_{o}$. Both the cascode and Wilson mirrors require at least 1 V or so for proper operation.
- The Widlar current source provides an area-efficient way to implement a low-valued constant-current source that also has a high output resistance.
- Preceding the CE (CS) transistor with an emitter follower (a source follower) results in increased input resistance in the BJT case and wider bandwidth in both the BJT and MOS cases.
- Preceding the $\mathrm{CB}(\mathrm{CG})$ transistor with an emitter follower (a source follower) solves the low-input-resistance problem of the CB and CG configurations.
- The Darlington configuration results in an equivalent BJT with a current gain approaching $\beta^{*}$.


# PROBLEMS 

## Computer Simulation Problems

SIIC Problems identified by the multisim/PSpice icon are intended to demonstrate the value of using SPICE simulation to verify hand analysis and design, and to investigate important issues such as allowable signal swing and amplifier nonlinear distortion. Instructions to assist in setting up PSpice and Multism simulations for all the indicated problems can be found in the corresponding files on the website. Note that if a particular parameter value is not specified in the problem statement, you are to make a reasonable assumption.

## Section 8.2: IC Biasing-Current Sources, Current Mirrors, and Current-Steering Circuits

D 8.1 For $V_{D D}=1.3 \mathrm{~V}$ and using $I_{\mathrm{REF}}=100 \mu \mathrm{~A}$, it is required to design the circuit of Fig. 8.1 to obtain an output current whose nominal value is $100 \mu \mathrm{~A}$. Find $R$ if $Q_{1}$ and $Q_{2}$ are matched with channel lengths of $0.5 \mu \mathrm{~m}$, channel widths of $5 \mu \mathrm{~m}, V_{i}=0.4 \mathrm{~V}$, and $k_{n}^{\prime}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$. What is the lowest possible value of $V_{O}$ ? Assuming that for this process technology the Early voltage $V_{A}^{\prime}=5 \mathrm{~V} / \mu \mathrm{m}$, find the output resistance of the current source. Also, find the change in output current resulting from a $+0.5-\mathrm{V}$ change in $V_{O}$.
D 8.2 Using $V_{D D}=1.8 \mathrm{~V}$ and a pair of matched MOSFETs, design the current-source circuit of Fig. 8.1 to provide an output current of $150-\mu$ A nominal value. To simplify matters,
assume that the nominal value of the output current is obtained at $V_{O} \simeq V_{G S}$. It is further required that the circuit operate for $V_{O}$ in the range of 0.3 V to $V_{D D}$ and that the change in $I_{O}$ over this range be limited to $10 \%$ of the nominal value of $I_{O}$. Find the required value of $R$ and the device dimensions. For the fabrication-process technology utilized, $\mu_{n} C_{o s}=$ $400 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{A}^{\prime}=10 \mathrm{~V} / \mu \mathrm{m}$, and $V_{i}=0.5 \mathrm{~V}$.
D 8.3 Sketch the $p$-channel counterpart of the current-source circuit of Fig. 8.1. Note that while the circuit of Fig. 8.1 should more appropriately be called a current sink, the corresponding PMOS circuit is a current source. Let $V_{D D}=1.3 \mathrm{~V},\left|V_{i}\right|=$ $0.4 \mathrm{~V}, Q_{1}$ and $Q_{2}$ be matched, and $\mu_{p} C_{o s}=80 \mu \mathrm{~A} / \mathrm{V}^{2}$. Find the device $W / L$ ratios and the value of the resistor that sets the value of $I_{\mathrm{REF}}$ so that a nominally $80-\mu \mathrm{A}$ output current is obtained. The current source is required to operate for $V_{O}$ as high as 1.1 V . Neglect channel-length modulation.

SIIC 8.4 Consider the current-mirror circuit of Fig. 8.2 with two transistors having equal channel lengths but with $Q_{2}$ having a width five times that of $Q_{1}$. If $I_{\text {REF }}$ is $20 \mu \mathrm{~A}$ and the transistors are operating at an overdrive voltage of 0.2 V , what $I_{O}$ results? What is the minimum allowable value of $V_{O}$ for proper operation of the current source? If $V_{i}=0.5 \mathrm{~V}$, at what value of $V_{O}$ will the nominal value of $I_{O}$ be obtained? If $V_{O}$ increases by 1 V , what is the corresponding increase in $I_{O}$ ? Let $V_{A}=20 \mathrm{~V}$.
8.5 For the current-steering circuit of Fig. P8.5, find $I_{O}$ in terms of $I_{\text {REF }}$ and device $W / L$ ratios.


Figure P8.5

D 8.6 The current-steering circuit of Fig. P8.6 is fabricated in a CMOS technology for which $\mu_{n} C_{e x}=400 \mu \mathrm{~A} / \mathrm{V}^{2}, \mu_{p} C_{e x}=$ $100 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{t n}=0.5 \mathrm{~V} V_{t p}=-0.5 \mathrm{~V}, V_{A n}^{\prime}=5 \mathrm{~V} / \mu \mathrm{m}$, and $\left|V_{A p}^{\prime}\right|=5 \mathrm{~V} / \mu \mathrm{m}$. If all devices have $L=0.5 \mu \mathrm{~m}$, design the circuit so that $I_{\mathrm{REF}}=20 \mu \mathrm{~A}, I_{2}=100 \mu \mathrm{~A}, I_{3}=I_{4}=40 \mu \mathrm{~A}$, and $I_{5}=80 \mu \mathrm{~A}$. Use the minimum possible device widths needed to achieve proper operation of the current source $Q_{2}$ for voltages at its drain as high as +0.8 V and proper operation of the current sink $Q_{5}$ with voltages at its drain as low as -0.8 V . Specify the widths of all devices and the value of $R$. Find the output resistance of the current source $Q_{2}$ and the output resistance of the current $\operatorname{sink} Q_{5}$.


Figure P8.6
*8.7 A PMOS current mirror consists of three PMOS transistors, one diode connected and two used as current
outputs. All transistors have $\left|V_{t}\right|=0.6 \mathrm{~V}, k_{p}^{\prime}=100 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $L=1.0 \mu \mathrm{~m}$ but three different widths, namely, $10 \mu \mathrm{~m}$, $20 \mu \mathrm{~m}$, and $40 \mu \mathrm{~m}$. When the diode-connected transistor is supplied from a $100-\mu \mathrm{A}$ source, how many different output currents are available? Repeat with two of the transistors diode connected and the third used to provide current output. For each possible input-diode combination, give the values of the output currents and of the $V_{S G}$ that results.
8.8 Consider the basic bipolar current mirror of Fig. 8.7 for the case in which $Q_{1}$ and $Q_{2}$ are identical devices having $I_{S}=10^{-17} \mathrm{~A}$.
(a) Assuming the transistor $\beta$ is very high, find the range of $V_{B E}$ and $I_{O}$ corresponding to $I_{\mathrm{REF}}$ increasing from $10 \mu \mathrm{~A}$ to 10 mA . Assume that $Q_{2}$ remains in the active mode, and neglect the Early effect.
(b) Find the range of $I_{O}$ corresponding to $I_{\text {REF }}$ in the range of $10 \mu \mathrm{~A}$ to 10 mA , taking into account the finite $\beta$. Assume that $\beta$ remains constant at 100 over the current range 0.1 mA to 5 mA but that at $I_{C} \simeq 10 \mathrm{~mA}$ and at $I_{C} \simeq$ $10 \mu \mathrm{~A}, \beta=50$. Specify $I_{O}$ corresponding to $I_{\mathrm{REF}}=10 \mu \mathrm{~A}$, $0.1 \mathrm{~mA}, 1 \mathrm{~mA}$, and 10 mA . Note that $\beta$ variation with current causes the current transfer ratio to vary with current.
8.9 Consider the basic BJT current mirror of Fig. 8.7 for the case in which $Q_{2}$ has $m$ times the area of $Q_{1}$. Show that the current transfer ratio is given by Eq. (8.19). If $\beta$ is specified to be a minimum of 80 , what is the largest current transfer ratio possible if the error introduced by the finite $\beta$ is limited to $10 \%$ ?
8.10 Give the circuit for the $p n p$ version of the basic current mirror of Fig. 8.7. If $\beta$ of the $p n p$ transistor is 50 , what is the current gain (or transfer ratio) $I_{O} / I_{\text {REF }}$ for the case of identical transistors, neglecting the Early effect?
8.11 Consider the basic BJT current mirror of Fig. 8.7 when $Q_{1}$ and $Q_{2}$ are matched and $I_{\mathrm{REF}}=1 \mathrm{~mA}$. Neglecting the effect of finite $\beta$, find the change in $I_{O}$, both as an absolute value and as a percentage, corresponding to $V_{O}$ changing from 1 V to 10 V . The Early voltage is 90 V .

D 8.12 The current-source circuit of Fig. P8.12 utilizes a pair of matched $p n p$ transistors having $I_{S}=10^{-15} \mathrm{~A}, \beta=50$, and $\left|V_{A}\right|=50 \mathrm{~V}$. It is required to design the circuit to provide an output current $I_{O}=1 \mathrm{~mA}$ at $V_{O}=1 \mathrm{~V}$. What values of $I_{\text {REF }}$ and $R$ are needed? What is the maximum allowed value of $V_{O}$ while the current source continues to operate properly? What change occurs in $I_{O}$ corresponding to $V_{O}$ changing from the

[^0]
[^0]:    3.11 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem


Figure P8.12
maximum positive value to -5 V ? Hint: Adapt Eq. (8.21) for this case as:

$$
I_{O}=I_{\mathrm{REP}}\left[\frac{1+\frac{3-V_{O}-V_{E B}}{\left|V_{A}\right|}}{1+\frac{2}{\beta}}\right]
$$

8.13 Find the voltages at all nodes and the currents through all branches in the circuit of Fig. P8.13. Assume $\left|V_{B E}\right|=0.7 \mathrm{~V}$ and $\beta=\infty$.
8.14 For the circuit in Fig. P8.14, let $\left|V_{B E}\right|=0.7 \mathrm{~V}$ and $\beta=\infty$. Find $I, V_{1}, V_{2}, V_{3}, V_{4}$, and $V_{5}$ for (a) $R=10 \mathrm{k} \Omega$ and (b) $R=100 \mathrm{k} \Omega$.


Figure P8.14


Figure P8.13

[^0]
[^0]:    8.13 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
D 8.15 Using the ideas embodied in Fig. 8.10, design a multiple-mirror circuit using power supplies of $\pm 5 \mathrm{~V}$ to create source currents of $0.2 \mathrm{~mA}, 0.4 \mathrm{~mA}$, and 0.8 mA and sink currents of $0.5 \mathrm{~mA}, 1 \mathrm{~mA}$, and 2 mA . Assume that the BJTs have $\left|V_{B E}\right| \simeq 0.7 \mathrm{~V}$ and large $\beta$. What is the total power dissipated in your circuit?
*8.16 The circuit shown in Fig. P8.16 is known as a current conveyor.


Figure P8.16
(a) Assuming that Y is connected to a voltage $V$, a current $I$ is forced into $X$, and terminal $Z$ is connected to a voltage that keeps $Q_{S}$ in the active region, show that a current equal to $I$ flows through terminal $Y$, that a voltage equal to $V$ appears at terminal $X$, and that a current equal to $I$ flows through terminal Z. Assume $\beta$ to be large; corresponding transistors are matched, and all transistors are operating in the active region.
(b) With Y connected to ground, show that a virtual ground appears at $X$. Now, if $X$ is connected to a $+5-\mathrm{V}$ supply through a $10-\mathrm{k} \Omega$ resistor, what current flows through Z?
8.17 The MOSFETs in the current mirror of Fig. 8.12(a) have equal channel lengths of $0.5 \mu \mathrm{~m}, W_{1}=10 \mu \mathrm{~m}, W_{2}=50 \mu \mathrm{~m}$, $\mu_{o} C_{o s}=500 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $V_{A}^{\prime}=10 \mathrm{~V} / \mu \mathrm{m}$. If the input bias current is $100 \mu \mathrm{~A}$, find $R_{\mathrm{in}}, A_{\mathrm{in}}$, and $R_{o}$.
D 8.18 The MOSFETs in the current mirror of Fig. 8.12(a) have equal channel lengths, $\mu_{o} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{A}^{\prime}=20$ $\mathrm{V} / \mu \mathrm{m}$. If the input bias current is $200 \mu \mathrm{~A}$, find $W_{1}, W_{2}$, and $L$
to obtain a short-circuit current gain of 4 , an input resistance of $500 \Omega$, and an output resistance of $20 \mathrm{k} \Omega$.
8.19 Figure P8.19 shows an amplifier utilizing a current mirror $Q_{3}-Q_{3}$. Here $Q_{1}$ is a common-source amplifier fed with $v_{\mathrm{f}}=V_{\mathrm{GS}}+v_{i}$, where $V_{\mathrm{GS}}$ is the gate-to-source dc bias voltage of $Q_{1}$ and $v_{i}$ is a small signal to be amplified. Find the signal component of the output voltage $v_{O}$ and hence the small-signal voltage gain $v_{o} / v_{i}$. Also, find the small-signal resistance of the diode-connected transistor $Q_{2}$ in terms of $g_{m 2}$, and hence the total resistance between the drain of $Q_{1}$ and ground. What is the voltage gain of the CS amplifier $Q_{1}$ ? Neglect all $r_{o}$ 's.


Figure P8.19
*8.20 Figure P8.20 shows a current-mirror circuit prepared for small-signal analysis. Replace the BJTs with their hybrid$\pi$ models and find expressions for $R_{\mathrm{in}}, i_{o} / i_{i}$, and $R_{o}$, where $i_{o}$ is the output short-circuit current. Assume $r_{o} \gg r_{n}$.


Figure P8.20
8.21 It is required to find the incremental (i.e., small-signal) resistance of each of the diode-connected transistors shown in

[^0]
[^0]:    3IN = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
Fig. P8.21. Assume that the dc bias current $I=0.1 \mathrm{~mA}$. For the MOSFET, let $\mu_{n} C_{o x}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $W / L=10$. Neglect $r_{o}$ for both devices.


Figure P8.21
8.22 For the base-current-compensated mirror of Fig. 8.11, let the three transistors be matched and specified to have a collector current of 1 mA at $V_{B E}=0.7 \mathrm{~V}$. For $I_{\text {REF }}$ of $100 \mu \mathrm{~A}$ and assuming $\beta=100$, what will the voltage at node $x$ be? If $I_{\text {REF }}$ is increased to 1 mA , what is the change in $V_{x}$ ? What is the value of $I_{O}$ obtained with $V_{O}=V_{x}$ in both cases? Give the percentage difference between the actual and ideal value of $I_{O}$. What is the lowest voltage at the output for which proper current-source operation is maintained?

D 8.23 Extend the current-mirror circuit of Fig. 8.11 to $n$ outputs. What is the resulting current transfer ratio from the input to each output, $I_{O} / I_{\text {REF }}$ ? If the deviation from unity is to be kept at $0.2 \%$ or less, what is the maximum possible number of outputs for BJTs with $\beta=150$ ?
*8.24 For the base-current-compensated mirror of Fig. 8.11, show that the incremental input resistance (seen by the reference current source) is approximately $2 V_{F} / I_{\text {REF }}$. Evaluate $R_{\mathrm{m}}$ for $I_{\mathrm{REF}}=100 \mu \mathrm{~A}$. (Hint: $Q_{3}$ is operating at a current $I_{E 3}=2 I_{C} / \beta$, where $I_{C}$ is the operating current of each of $Q_{1}$ and $Q_{2}$. Replace each transistor with its T model and neglect $r_{0}$.)

## Section 8.3: The Basic Gain Cell

8.25 Find $g_{m}, r_{n}, r_{o}$, and $A_{0}$ for the CE amplifier of Fig. 8.13(b) when operated at $I=10 \mu \mathrm{~A}, 100 \mu \mathrm{~A}$, and 1 mA . Assume $\beta=100$ and remains constant as $I$ is varied, and that $V_{A}=10 \mathrm{~V}$. Present your results in a table.
8.26 Consider the CE amplifiers of Fig. 8.13(b) for the case of $I=0.5 \mathrm{~mA}, \beta=100$, and $V_{A}=100 \mathrm{~V}$. Find $R_{\mathrm{m}}, A_{v o}$, and $R_{o}$. If it is required to raise $R_{\mathrm{m}}$ by a factor of 5 by changing $I$, what value of $I$ is required, assuming that $\beta$ remains unchanged? What are the new values of $A_{v o}$ and $R_{o}$ ? If the amplifier is fed with a signal source having $R_{\text {sig }}=5 \mathrm{k} \Omega$ and is connected to a load of $100-\mathrm{k} \Omega$ resistance, find the overall voltage gain, $v_{o} / v_{\text {sig }}$.
8.27 Find the intrinsic gain of an NMOS transistor fabricated in a process for which $k_{o}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{A}^{\prime}=10 \mathrm{~V} \mu \mathrm{~m}$. The transistor has a $0.5-\mu \mathrm{m}$ channel length and is operated at $V_{O V}=0.2 \mathrm{~V}$. If a $2-\mathrm{mA} / \mathrm{V}$ transconductance is required, what must $I_{D}$ and $W$ be?
8.28 An NMOS transistor fabricated in a certain process is found to have an intrinsic gain of $50 \mathrm{~V} / \mathrm{V}$ when operated at an $I_{D}$ of $100 \mu \mathrm{~A}$. Find the intrinsic gain for $I_{D}=25 \mu \mathrm{~A}$ and $I_{D}=400 \mu \mathrm{~A}$. For each of these currents, find the factor by which $g_{m}$ changes from its value at $I_{D}=100 \mu \mathrm{~A}$.

D 8.29 Consider an NMOS transistor fabricated in a $0.18-\mu \mathrm{m}$ technology for which $k_{o}^{\prime}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{A}^{\prime}=$ $5 \mathrm{~V} / \mu \mathrm{m}$. It is required to obtain an intrinsic gain of $20 \mathrm{~V} / \mathrm{V}$ and a $g_{m}$ of $2 \mathrm{~mA} / \mathrm{V}$. Using $V_{O V}=0.2 \mathrm{~V}$, find the required values of $L, W / L$, and the bias current $I$.

D 8.30 Sketch the circuit for a current-source-loaded CS amplifier that uses a PMOS transistor for the amplifying device. Assume the availability of a single $+1.8-\mathrm{V}$ dc supply. If the transistor is operated with $\left|V_{O V}\right|=0.2 \mathrm{~V}$, what is the highest instantaneous voltage allowed at the drain?
8.31 An NMOS transistor operated with an overdrive voltage of 0.25 V is required to have a $g_{m}$ equal to that of an $n p n$ transistor operated at $I_{C}=0.1 \mathrm{~mA}$. What must $I_{D}$ be? What value of $g_{m}$ is realized?
8.32 For an NMOS transistor with $L=1 \mu \mathrm{~m}$ fabricated in the $0.5-\mu \mathrm{m}$ process specified in Table J. 1 in Appendix J, find $g_{m}, r_{o}$, and $A_{0}$ if the device is operated with $V_{O V}=$ 0.5 V and $I_{D}=100 \mu \mathrm{~A}$. Also, find the required device width $W$.
8.33 For an NMOS transistor with $L=0.3 \mu \mathrm{~m}$ fabricated in the $0.18-\mu \mathrm{m}$ process specified in Table J. 1 in Appendix J, find $g_{m}, r_{o}$, and $A_{0}$ obtained when the device is operated at $I_{D}=100 \mu \mathrm{~A}$ with $V_{O V}=0.2 \mathrm{~V}$. Also, find $W$.

[^0]
[^0]:    8.28 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
8.34 Fill in the table below. For the BJT, let $\beta=100$ and $V_{A}=100 \mathrm{~V}$. For the MOSFET, let $\mu_{u} C_{o s}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$, $W / L=40$, and $V_{A}=10 \mathrm{~V}$.

|  | BJT Cell | MOSFET Cell |
| :-- | :-- | :--: |
| Bias Current | $I_{C}=0.1 \mathrm{~mA} \quad I_{C}=1 \mathrm{~mA}$ | $I_{D}=0.1 \mathrm{~mA} I_{D}=1 \mathrm{~mA}$ |
| $g_{m}(\mathrm{~mA} / \mathrm{V})$ |  |  |
| $r_{o}(\mathrm{k} \Omega)$ |  |  |
| $A_{0}(\mathrm{~V} / \mathrm{V})$ |  |  |
| $R_{i n}(\mathrm{k} \Omega)$ |  |  |

8.35 A CS amplifier utilizes an NMOS transistor with $L=0.54 \mu \mathrm{~m}$ and $W / L=8$. It was fabricated in a $0.18-\mu \mathrm{m}$ CMOS process for which $\mu_{u} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{A}^{\prime}=$ $5 \mathrm{~V} / \mu \mathrm{m}$. What is the bias current of the transistor for which $A_{0}=18 \mathrm{~V} / \mathrm{V}$ ?
8.36 A CS amplifier utilizes an NMOS transistor with $L=$ $0.36 \mu \mathrm{~m}$ and $W / L=8$. It was fabricated in a $0.18-\mu \mathrm{m}$ CMOS process for which $\mu_{u} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{A}^{\prime}=5 \mathrm{~V} / \mu \mathrm{m}$. Find the values of $g_{m}$ and $A_{0}$ obtained at $I_{D}=25 \mu \mathrm{~A}, 250 \mu \mathrm{~A}$, and 2.5 mA .

D 8.37 An NMOS transistor is fabricated in the $0.18-\mu \mathrm{m}$ process whose parameters are given in Table J. 1 in Appendix J. The device has a channel length twice the minimum and is operated at $V_{O V}=0.25 \mathrm{~V}$ and $I_{D}=10 \mu \mathrm{~A}$.
(a) What values of $g_{m}, r_{o}$, and $A_{0}$ are obtained?
(b) If $I_{D}$ is increased to $100 \mu \mathrm{~A}$, what do $V_{O V}, g_{m}, r_{o}$, and $A_{0}$ become?
(c) If the device is redesigned with a new value of $W$ so that it operates at $V_{O V}=0.25 \mathrm{~V}$ for $I_{D}=100 \mu \mathrm{~A}$, what do $g_{m}$, $r_{o}$, and $A_{0}$ become?
(d) If the redesigned device in (c) is operated at $10 \mu \mathrm{~A}$, find $V_{O V}, g_{m}, r_{o}$, and $A_{0}$.
(e) Which designs and operating conditions produce the lowest and highest values of $A_{0}$ ? What are these values? In each of these two cases, if $W / L$ is held at the same value but $L$ is made 10 times larger, what gains result?

D 8.38 Find $A_{0}$ for an NMOS transistor fabricated in a CMOS process for which $k_{n}^{\prime}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{A}^{\prime}=6 \mathrm{~V} / \mu \mathrm{m}$. The transistor has a $0.5-\mu \mathrm{m}$ channel length and is operated with an overdrive voltage of 0.15 V . What must $W$ be for the NMOS transistor to operate at $I_{D}=100 \mu \mathrm{~A}$ ? Also, find the values of $g_{m}$ and $r_{o}$.

D 8.39 Using a CMOS technology for which $k_{n}^{\prime}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{A}^{\prime}=20 \mathrm{~V} / \mu \mathrm{m}$, design a
current-source-loaded CS amplifier for operation at $I=$ $50 \mu \mathrm{~A}$ with $V_{O V}=0.2 \mathrm{~V}$. The amplifier is to have an open-circuit voltage gain of $-100 \mathrm{~V} / \mathrm{V}$. Assume that the current-source load is ideal. Specify $L$ and $W / L$.

D 8.40 The circuit in Fig. 8.15(a) is fabricated in a process for which $\mu_{u} C_{o s}=2 \mu_{u} C_{o s}=200 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{A u}^{\prime}=\left|V_{A p}^{\prime}\right|=20 \mathrm{~V} / \mu \mathrm{m}$, $V_{o s}=-V_{i p}=0.5 \mathrm{~V}$, and $V_{D D}=2.5 \mathrm{~V}$. The two transistors have $L=0.5 \mu \mathrm{~m}$ and are to be operated at $I_{D}=100 \mu \mathrm{~A}$ and $\left|V_{O V}\right|=$ 0.3 V . Find the required values of $V_{G},(W / L)_{1},(W / L)_{2}$, and $A_{v}$.

D 8.41 The circuit in Fig. 8.15(a) is fabricated in a $0.18-\mu \mathrm{m}$ CMOS technology for which $\mu_{u} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2}, \mu_{u} C_{o s}=$ $100 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{o s}=-V_{i p}=0.5 \mathrm{~V}, V_{A u}^{\prime}=5 \mathrm{~V} / \mu \mathrm{m},\left|V_{A p}^{\prime}\right|=$ $5 \mathrm{~V} / \mu \mathrm{m}$, and $V_{D D}=1.8 \mathrm{~V}$. It is required to design the circuit to obtain a voltage gain $A_{v}=-40 \mathrm{~V} / \mathrm{V}$. Use devices of equal length $L$ operating at $I=100 \mu \mathrm{~A}$ and $\left|V_{O V}\right|=0.25 \mathrm{~V}$. Determine the required values of $V_{G}, L,(W / L)_{1}$, and $(W / L)_{2}$.
8.42 Figure P8.42 shows an IC MOS amplifier formed by cascading two common-source stages. Assuming that $V_{A u}=\left|V_{A p}\right|$ and that the biasing current sources have output resistances equal to those of $Q_{1}$ and $Q_{2}$, find an expression for the overall voltage gain in terms of $g_{m}$ and $r_{o}$ of $Q_{1}$ and $Q_{2}$. If $Q_{1}$ and $Q_{2}$ are to be operated at equal overdrive voltages, $\left|V_{O V}\right|$, find the required value of $\left|V_{O V}\right|$ if $\left|V_{A}\right|=5 \mathrm{~V}$ and the gain required is $400 \mathrm{~V} / \mathrm{V}$.


Figure P8.42
*8.43 The NMOS transistor in the circuit of Fig. P8.43 has $V_{i}=0.5 \mathrm{~V}, k_{n}^{\prime} W / L=2 \mathrm{~mA} / \mathrm{V}^{2}$, and $V_{A}=20 \mathrm{~V}$.
(a) Neglecting the dc current in the feedback network and the effect of $r_{o}$, find $V_{G S}$. Then find the dc current in the feedback network and $V_{D S}$. Verify that you were justified in neglecting the current in the feedback network when you found $V_{G S}$.# EXERCISES 

1.18 Consider a current amplifier having the model shown in the second row of Table 1.1. Let the amplifier be fed with a signal current-source $i_{s}$ having a resistance $R_{s}$, and let the output be connected to a load resistance $R_{L}$. Show that the overall current gain is given by

$$
\frac{i_{o}}{i_{s}}=A_{o} \frac{R_{s}}{R_{s}+R_{i}} \frac{R_{o}}{R_{o}+R_{L}}
$$

1.19 Consider the transconductance amplifier whose model is shown in the third row of Table 1.1. Let a voltage signal source $v_{s}$ with a source resistance $R_{s}$ be connected to the input and a load resistance $R_{L}$ be connected to the output. Show that the overall voltage gain is given by

$$
\frac{v_{o}}{v_{s}}=G_{m} \frac{R_{s}}{R_{i}+R_{s}}\left(R_{o} \| R_{L}\right)
$$

1.20 Consider a transresistance amplifier having the model shown in the fourth row of Table 1.1. Let the amplifier be fed with a signal current source $i_{s}$ having a resistance $R_{s}$, and let the output be connected to a load resistance $R_{L}$. Show that the overall gain is given by

$$
\frac{v_{o}}{i_{s}}=R_{m} \frac{R_{s}}{R_{s}+R_{i}} \frac{R_{L}}{R_{L}+R_{o}}
$$

1.21 Find the input resistance between terminals B and G in the circuit shown in Fig. E1.21. The voltage $v_{s}$ is a test voltage with the input resistance $R_{\text {in }}$ defined as $R_{\text {in }} \equiv v_{s} / i_{s}$.


Figure E1.21

Ans. $R_{\text {in }}=r_{n}+(\beta+1) R_{e}$
# 1.6 Frequency Response of Amplifiers ${ }^{2}$ 

From Section 1.2 we know that the input signal to an amplifier can always be expressed as the sum of sinusoidal signals. It follows that an important characterization of an amplifier is in terms of its response to input sinusoids of different frequencies. Such a characterization of amplifier performance is known as the amplifier frequency response.

### 1.6.1 Measuring the Amplifier Frequency Response

We shall introduce the subject of amplifier frequency response by showing how it can be measured. Figure 1.20 depicts a linear voltage amplifier fed at its input with a sine-wave signal of amplitude $V_{i}$ and frequency $\omega$. As the figure indicates, the signal measured at the amplifier output also is sinusoidal with exactly the same frequency $\omega$. This is an important point to note: Whenever a sine-wave signal is applied to a linear circuit, the resulting output is sinusoidal with the same frequency as the input. In fact, the sine wave is the only signal that does not change shape as it passes through a linear circuit. Observe, however, that the output sinusoid will in general have a different amplitude and will be shifted in phase relative to the input. The ratio of the amplitude of the output sinusoid $\left(V_{o}\right)$ to the amplitude of the input sinusoid $\left(V_{i}\right)$ is the magnitude of the amplifier gain (or transmission) at the test frequency $\omega$. Also, the angle $\phi$ is the phase of the amplifier transmission at the test frequency $\omega$. If we denote the amplifier transmission, or transfer function as it is more commonly known, by $T(\omega)$, then

$$
\begin{aligned}
|T(\omega)| & =\frac{V_{o}}{V_{i}} \\
\angle T(\omega) & =\phi
\end{aligned}
$$

The response of the amplifier to a sinusoid of frequency $\omega$ is completely described by $|T(\omega)|$ and $\angle T(\omega)$. Now, to obtain the complete frequency response of the amplifier we simply change the frequency of the input sinusoid and measure the new value for $|T|$ and $\angle T$. The end result will be a table and/or graph of gain magnitude $[|T(\omega)|]$ versus frequency and a table and/or graph of phase angle $[\angle T(\omega)]$ versus frequency. These two plots together constitute the frequency response of the amplifier; the first is known as the magnitude or amplitude


Figure 1.20 Measuring the frequency response of a linear amplifier: At the test frequency, the amplifier gain is characterized by its magnitude $\left(V_{o} / V_{i}\right)$ and phase $\phi$.

[^0]
[^0]:    ${ }^{2}$ Except for its use in the study of the frequency response of op-amp circuits in Sections 2.5 and 2.7, the material in this section will not be needed in a substantial manner until Chapter 10.


Figure 1.21 Typical magnitude response of an amplifier: $|T(\omega)|$ is the magnitude of the amplifier transfer function-that is, the ratio of the output $V_{o}(\omega)$ to the input $V_{i}(\omega)$.
response, and the second is the phase response. Finally, we should mention that it is a common practice to express the magnitude of transmission in decibels and thus plot 20 log $|T(\omega)|$ versus frequency.

# 1.6.2 Amplifier Bandwidth 

Figure 1.21 shows the magnitude response of an amplifier. It indicates that the gain is almost constant over a wide frequency range, roughly between $\omega_{1}$ and $\omega_{2}$. Signals whose frequencies are below $\omega_{1}$ or above $\omega_{2}$ will experience lower gain, with the gain decreasing as we move farther away from $\omega_{1}$ and $\omega_{2}$. The band of frequencies over which the gain of the amplifier is almost constant, to within a certain number of decibels (usually 3 dB ), is called the amplifier bandwidth. Normally the amplifier is designed so that its bandwidth coincides with the spectrum of the signals it is required to amplify. If this were not the case, the amplifier would distort the frequency spectrum of the input signal, with different components of the input signal being amplified by different amounts.

### 1.6.3 Evaluating the Frequency Response of Amplifiers

Above, we described the method used to measure the frequency response of an amplifier. We now briefly discuss the method for analytically obtaining an expression for the frequency response. What we are about to say is just a preview of this important subject, whose detailed study is in Chapter 10.

To evaluate the frequency response of an amplifier, one has to analyze the amplifier equivalent circuit model, taking into account all reactive components. ${ }^{3}$ Circuit analysis proceeds in the usual fashion but with inductances and capacitances represented by their reactances. An inductance $L$ has a reactance or impedance $j \omega L$, and a capacitance $C$ has a reactance or impedance $1 / j \omega C$ or, equivalently, a susceptance or admittance $j \omega C$. Thus in a frequency-domain analysis we deal with impedances and/or admittances. The result of the

[^0]
[^0]:    ${ }^{3}$ Note that in the models considered in previous sections no reactive components were included. These were simplified models and cannot be used alone to predict the amplifier frequency response.
analysis is the amplifier transfer function $T(\omega)$

$$
T(\omega)=\frac{V_{o}(\omega)}{V_{i}(\omega)}
$$

where $V_{i}(\omega)$ and $V_{o}(\omega)$ denote the input and output signals, respectively. $T(\omega)$ is generally a complex function whose magnitude $|T(\omega)|$ gives the magnitude of transmission or the magnitude response of the amplifier. The phase of $T(\omega)$ gives the phase response of the amplifier.

In the analysis of a circuit to determine its frequency response, the algebraic manipulations can be considerably simplified by using the complex frequency variable $s$. In terms of $s$, the impedance of an inductance $L$ is $s L$ and that of a capacitance $C$ is $1 / s C$. Replacing the reactive elements with their impedances and performing standard circuit analysis, we obtain the transfer function $T(s)$ as

$$
T(s) \equiv \frac{V_{o}(s)}{V_{i}(s)}
$$

Subsequently, we replace $s$ by $j \omega$ to determine the transfer function for physical frequencies, $T(j \omega)$. Note that $T(j \omega)$ is the same function we called $T(\omega)$ above ${ }^{4}$; the additional $j$ is included in order to emphasize that $T(j \omega)$ is obtained from $T(s)$ by replacing $s$ with $j \omega$.

# 1.6.4 Single-Time-Constant Networks 

In analyzing amplifier circuits to determine their frequency response, one is greatly aided by knowledge of the frequency-response characteristics of single-time-constant (STC) networks. An STC network is one that is composed of, or can be reduced to, one reactive component (inductance or capacitance) and one resistance. Examples are shown in Fig. 1.22. An STC network formed of an inductance $L$ and a resistance $R$ has a time constant $\tau=L / R$. The time constant $\tau$ of an STC network composed of a capacitance $C$ and a resistance $R$ is given by $\tau=C R$.

Appendix E presents a study of STC networks and their responses to sinusoidal, step, and pulse inputs. Knowledge of this material will be needed at various points throughout this book, and the reader will be encouraged to refer to the appendix. At this point we need in particular the frequency-response results; we will, in fact, briefly discuss this important topic now.


Figure 1.22 Two examples of STC networks: (a) a low-pass network and (b) a high-pass network.

[^0]
[^0]:    ${ }^{4}$ At this stage, we are using $s$ simply as a shorthand for $j \omega$. We shall not require detailed knowledge of $s$-plane concepts until Chapter 10. A brief review of $s$-plane analysis is presented in Appendix F.
Most STC networks can be classified into two categories, ${ }^{5}$ low pass (LP) and high pass (HP), with each of the two categories displaying distinctly different signal responses. As an example, the STC network shown in Fig. 1.22(a) is of the low-pass type and that in Fig. 1.22(b) is of the high-pass type. To see the reasoning behind this classification, observe that the transfer function of each of these two circuits can be expressed as a voltage-divider ratio, with the divider composed of a resistor and a capacitor. Now, recalling how the impedance of a capacitor varies with frequency $(Z=1 / j \omega C)$, it is easy to see that the transmission of the circuit in Fig. 1.22(a) will decrease with frequency and approach zero as $\omega$ approaches $\infty$. Thus the circuit of Fig. 1.22(a) acts as a low-pass filter ${ }^{6}$; it passes low-frequency, sine-wave inputs with little or no attenuation (at $\omega=0$, the transmission is unity) and attenuates high-frequency input sinusoids. The circuit of Fig. 1.22(b) does the opposite; its transmission is unity at $\omega=\infty$ and decreases as $\omega$ is reduced, reaching 0 for $\omega=0$. The latter circuit, therefore, performs as a high-pass filter.

Table 1.2 provides a summary of the frequency-response results for STC networks of both types. ${ }^{7}$ Also, sketches of the magnitude and phase responses are given in Figs. 1.23 and 1.24. These frequency-response diagrams are known as Bode plots, and the 3-dB frequency $\left(\omega_{0}\right)$ is also known as the corner frequency, break frequency, or pole frequency. The reader is urged to become familiar with this information and to consult Appendix E if further clarifications are needed. In particular, it is important to develop a facility for the rapid

Table 1.2 Frequency Response of STC Networks

|  | Low-Pass (LP) | High-Pass (HP) |
| :-- | :--: | :--: |
| Transfer Function $T(s)$ | $\frac{K}{1+\left(s / \omega_{0}\right)}$ | $\frac{K s}{s+\omega_{0}}$ |
| Transfer Function (for physical | $\frac{K}{1+j\left(\omega / \omega_{0}\right)}$ | $\frac{K}{1-j\left(\omega_{0} / \omega\right)}$ |
| frequencies) $T(j \omega)$ | $\frac{|K|}{\sqrt{1+\left(\omega / \omega_{0}\right)^{2}}}$ | $\frac{|K|}{\sqrt{1+\left(\omega_{0} / \omega\right)^{2}}}$ |
| Magnitude Response $|T(j \omega)|$ | $-\tan ^{-1}\left(\omega / \omega_{0}\right)$ | $\tan ^{-1}\left(\omega_{0} / \omega\right)$ |
| Phase Response $\angle T(j \omega)$ | $K$ | 0 |
| Transmission at $\omega=0(\mathrm{dc})$ | 0 | $K$ |
| Transmission at $\omega=\infty$ | 0 | $K$ |
| 3-dB Frequency | $\omega_{0}=1 / \tau ; \tau \equiv \text { time constant }$ |  |
| Bode Plots | $\tau=C R$ or $L / R$ | in Fig. 1.24 |

[^0]
[^0]:    ${ }^{5}$ An important exception is the all-pass STC network studied in Chapter 17.
    ${ }^{6} \mathrm{~A}$ filter is a circuit that passes signals in a specified frequency band (the filter passband) and stops or severely attenuates (filters out) signals in another frequency band (the filter stopband). Filters will be studied in Chapter 17.
    ${ }^{7}$ The transfer functions in Table 1.2 are given in general form. For the circuits of Fig. 1.22, $K=1$ and $\omega_{0}=1 / C R$


Figure 1.23 (a) Magnitude and (b) phase response of STC networks of the low-pass type.
determination of the time constant $\tau$ of an STC circuit. The process is very simple: Set the independent voltage or current source to zero; "grab hold" of the two terminals of the reactive element (capacitor $C$ or inductor $L$ ); and determine the equivalent resistance $R$ that appears between these two terminals. The time constant is then $C R$ or $L / R$.

# BODE PLOTS: 

In the 1930s, while working at Bell Labs, Hendrik Bode devised a simple but accurate method for using linearized asymptotic responses to graph gain and phase shift against frequency on a logarithmic scale. Such gain and phase presentations, together called Bode plots, have enormous importance in the design and analysis of the frequency-dependent behavior of systems large and small.


Figure 1.24 (a) Magnitude and (b) phase response of STC networks of the high-pass type.

# Example 1.5 

Figure 1.25 shows a voltage amplifier having an input resistance $R_{i}$, an input capacitance $C_{i}$, a gain factor $\mu$, and an output resistance $R_{o}$. The amplifier is fed with a voltage source $V_{s}$ having a source resistance $R_{s}$, and a load of resistance $R_{L}$ is connected to the output.


Figure 1.25 Circuit for Example 1.5.
(a) Derive an expression for the amplifier voltage gain $V_{o} / V_{s}$ as a function of frequency. From this find expressions for the dc gain and the 3-dB frequency.
(b) Calculate the values of the dc gain, the 3-dB frequency, and the frequency at which the gain becomes 0 dB (i.e., unity) for the case $R_{s}=20 \mathrm{k} \Omega, R_{i}=100 \mathrm{k} \Omega, C_{i}=60 \mathrm{pF}, \mu=144 \mathrm{~V} / \mathrm{V}, R_{o}=200 \Omega$, and $R_{L}=1 \mathrm{k} \Omega$
(c) Find $v_{o}(t)$ for each of the following inputs:
(i) $v_{i}=0.1 \sin 10^{7} t, \mathrm{~V}$
(ii) $v_{i}=0.1 \sin 10^{5} t, \mathrm{~V}$
(iii) $v_{i}=0.1 \sin 10^{6} t, \mathrm{~V}$
(iv) $v_{i}=0.1 \sin 10^{8} t, \mathrm{~V}$

# Solution 

(a) Utilizing the voltage-divider rule, we can express $V_{i}$ in terms of $V_{s}$ as follows

$$
V_{i}=V_{s} \frac{Z_{i}}{Z_{i}+R_{s}}
$$

where $Z_{i}$ is the amplifier input impedance. Since $Z_{i}$ is composed of two parallel elements, it is obviously easier to work in terms of $Y_{i}=1 / Z_{i}$. Toward that end we divide the numerator and denominator by $Z_{i}$, thus obtaining

$$
\begin{aligned}
V_{i} & =V_{s} \frac{1}{1+R_{s} Y_{i}} \\
& =V_{s} \frac{1}{1+R_{s}\left[\left(1 / R_{i}\right)+s C_{i}\right]}
\end{aligned}
$$

Thus,

$$
\frac{V_{i}}{V_{s}}=\frac{1}{1+\left(R_{s} / R_{i}\right)+s C_{i} R_{s}}
$$

This expression can be put in the standard form for a low-pass STC network (see the top line of Table 1.2) by extracting $\left[1+\left(R_{s} / R_{i}\right)\right]$ from the denominator; thus we have

$$
\frac{V_{i}}{V_{s}}=\frac{1}{1+\left(R_{s} / R_{i}\right)} \frac{1}{1+s C_{i}\left[\left(R_{s} R_{i}\right) /\left(R_{s}+R_{i}\right)\right]}
$$

At the output side of the amplifier we can use the voltage-divider rule to write

$$
V_{o}=\mu V_{i} \frac{R_{L}}{R_{L}+R_{o}}
$$

This equation can be combined with Eq. (1.20) to obtain the amplifier transfer function as

$$
\frac{V_{o}}{V_{s}}=\mu \frac{1}{1+\left(R_{s} / R_{i}\right)} \frac{1}{1+\left(R_{o} / R_{L}\right)} \frac{1}{1+s C_{i}\left[\left(R_{s} R_{i}\right) /\left(R_{s}+R_{i}\right)\right]}
$$
# Example 1.5 continued 

We note that only the last factor in this expression is new (compared with the expression derived in the last section). This factor is a result of the input capacitance $C_{i}$, with the time constant being

$$
\begin{aligned}
\tau & =C_{i} \frac{R_{s} R_{i}}{R_{s}+R_{i}} \\
& =C_{i}\left(R_{s} \| R_{i}\right)
\end{aligned}
$$

We could have obtained this result by inspection: From Fig. 1.25 we see that the input circuit is an STC network and that its time constant can be found by reducing $V_{s}$ to zero, with the result that the resistance seen by $C_{i}$ is $R_{i}$ in parallel with $R_{s}$. The transfer function in Eq. (1.21) is of the form $K /\left(1+\left(s / \omega_{o}\right)\right)$, which corresponds to a low-pass STC network. The dc gain is found as

$$
K \equiv \frac{V_{o}}{V_{s}}(s=0)=\mu \frac{1}{1+\left(R_{s} / R_{i}\right)} \frac{1}{1+\left(R_{o} / R_{L}\right)}
$$

The 3-dB frequency $\omega_{0}$ can be found from

$$
\omega_{0}=\frac{1}{\tau}=\frac{1}{C_{i}\left(R_{s} \| R_{i}\right)}
$$

Since the frequency response of this amplifier is of the low-pass STC type, the Bode plots for the gain magnitude and phase will take the form shown in Fig. 1.23, where $K$ is given by Eq. (1.23) and $\omega_{0}$ is given by Eq. (1.24).
(b) Substituting the numerical values given into Eq. (1.23) results in

$$
K=144 \frac{1}{1+(20 / 100)} \frac{1}{1+(200 / 1000)}=100 \mathrm{~V} / \mathrm{V}
$$

Thus the amplifier has a dc gain of 40 dB . Substituting the numerical values into Eq. (1.24) gives the $3-\mathrm{dB}$ frequency

$$
\begin{aligned}
\omega_{0} & =\frac{1}{60 \mathrm{pF} \times(20 \mathrm{k} \Omega / / 100 \mathrm{k} \Omega)} \\
& =\frac{1}{60 \times 10^{-12} \times(20 \times 100 /(20+100)) \times 10^{3}}=10^{6} \mathrm{rad} / \mathrm{s}
\end{aligned}
$$

Thus,

$$
f_{0}=\frac{10^{6}}{2 \pi}=159.2 \mathrm{kHz}
$$

Since the gain falls off at the rate of $-20 \mathrm{~dB} /$ decade, starting at $\omega_{0}$ (see Fig. 1.23a) the gain will reach 0 dB in two decades (a factor of 100); thus we have

Unity-gain frequency $=100 \times \omega_{0}=10^{8} \mathrm{rad} / \mathrm{s}$ or 15.92 MHz
(c) To find $v_{o}(t)$ we need to determine the gain magnitude and phase at $10^{2}, 10^{5}, 10^{6}$, and $10^{8} \mathrm{rad} / \mathrm{s}$. This can be done either approximately utilizing the Bode plots of Fig. 1.23 or exactly utilizing the expression for the amplifier transfer function,

$$
T(j \omega) \equiv \frac{V_{o}}{V_{s}}(j \omega)=\frac{100}{1+j\left(\omega / 10^{\circ}\right)}
$$

We shall do both:
(i) For $\omega=10^{2} \mathrm{rad} / \mathrm{s}$, which is $\left(\omega_{0} / 10^{4}\right)$, the Bode plots of Fig. 1.23 suggest that $|T|=K=100$ and $\phi=0^{\circ}$. The transfer function expression gives $|T| \simeq 100$ and $\phi=-\tan ^{-1} 10^{-4} \simeq 0^{\circ}$. Thus,

$$
v_{o}(t)=10 \sin 10^{2} t, \mathrm{~V}
$$

(ii) For $\omega=10^{5} \mathrm{rad} / \mathrm{s}$, which is $\left(\omega_{0} / 10\right)$, the Bode plots of Fig. 1.23 suggest that $|T| \simeq K=100$ and $\phi=-5.7^{\circ}$. The transfer function expression gives $|T|=99.5$ and $\phi=-\tan ^{-1} 0.1=-5.7^{\circ}$. Thus,

$$
v_{o}(t)=9.95 \sin \left(10^{5} t-5.7^{\circ}\right), \mathrm{V}
$$

(iii) For $\omega=10^{6} \mathrm{rad} / \mathrm{s}=\omega_{0},|T|=100 / \sqrt{2}=70.7 \mathrm{~V} / \mathrm{V}$ or 37 dB and $\phi=-45^{\circ}$. Thus,

$$
v_{o}(t)=7.07 \sin \left(10^{6} t-45^{\circ}\right), \mathrm{V}
$$

(iv) For $\omega=10^{8} \mathrm{rad} / \mathrm{s}$, which is $\left(100 \omega_{0}\right)$, the Bode plots suggest that $|T|=1$ and $\phi=-90^{\circ}$. The transfer function expression gives $|T| \simeq 1$ and $\phi=-\tan ^{-1} 100=-89.4^{\circ}$. Thus,

$$
v_{o}(t)=0.1 \sin \left(10^{8} t-89.4^{\circ}\right), \mathrm{V}
$$

# 1.6.5 Classification of Amplifiers Based on Frequency Response 

Amplifiers can be classified based on the shape of their magnitude-response curve. Figure 1.26 shows typical frequency-response curves for various amplifier types. In Fig. 1.26(a) the gain remains constant over a wide frequency range, but falls off at low and high frequencies. This type of frequency response is common in audio amplifiers.

As will be shown in later chapters, internal capacitances in the device (a transistor) cause the falloff of gain at high frequencies, just as $C_{i}$ did in the circuit of Example 1.5. On the other hand, the falloff of gain at low frequencies is usually caused by coupling capacitors used to connect one amplifier stage to another, as indicated in Fig. 1.27. This practice is usually adopted to simplify the design process of the different stages. The coupling capacitors are usually chosen quite large (a fraction of a microfarad to a few tens of microfarads) so that their reactance (impedance) is small at the frequencies of interest. Nevertheless, at sufficiently low frequencies the reactance of a coupling capacitor will become large enough to cause part of the signal being coupled to appear as a voltage drop across the coupling capacitor, thus not reaching the subsequent stage. Coupling capacitors will thus cause loss of gain at low

Figure P8.43
(b) Find the small-signal voltage gain, $v_{o} / v_{i}$. What is the peak of the largest output sine-wave signal that is possible while the NMOS transistor remains in saturation? What is the corresponding input signal?
(c) Find the small-signal input resistance $R_{\mathrm{in}}$.

D 8.44 Consider the CMOS amplifier of Fig. 8.16(a) when fabricated with a process for which $k_{n}^{\prime}=4 k_{p}^{\prime}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$, $\left|V_{i}\right|=0.5 \mathrm{~V}$, and $\left|V_{A}\right|=5 \mathrm{~V}$. Find $I_{\text {REF }}$ and $(W / L)_{1}$ to obtain a voltage gain of $-40 \mathrm{~V} / \mathrm{V}$ and an output resistance of $100 \mathrm{k} \Omega$. Recall that $Q_{2}$ and $Q_{3}$ are matched. If $Q_{2}$ and $Q_{3}$ are to be operated at the same overdrive voltage as $Q_{1}$, what must their $W / L$ ratios be?
8.45 Consider the CMOS amplifier analyzed in Example 8.4. If $v_{I}$ consists of a dc bias component on which is superimposed a sinusoidal signal, find the value of the dc component that will result in the maximum possible signal swing at the output with almost-linear operation. What is the amplitude of the output sinusoid resulting? (Note: In practice, the amplifier would have a feedback circuit that caused it to operate at a point near the middle of its linear region.)
8.46 The power supply of the CMOS amplifier analyzed in Example 8.4 is increased to 5 V . What will the extent of the linear region at the output become?
**8.47 Consider the circuit shown in Fig. 8.16(a), using a 3.3-V supply and transistors for which $\left|V_{i}\right|=0.8 \mathrm{~V}$ and $L=$ $1 \mu \mathrm{~m}$. For $Q_{1}, k_{n}^{\prime}=100 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{A}=100 \mathrm{~V}$, and $W=20 \mu \mathrm{~m}$. For $Q_{2}$ and $Q_{3}, k_{p}^{\prime}=50 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $\left|V_{A}\right|=50 \mathrm{~V}$. For $Q_{2}$, $W=40 \mu \mathrm{~m}$. For $Q_{3}, W=10 \mu \mathrm{~m}$.
(a) If $Q_{1}$ is to be biased at $100 \mu \mathrm{~A}$, find $I_{\text {REF }}$. For simplicity, ignore the effect of $V_{A}$.
(b) What are the extreme values of $v_{O}$ for which $Q_{1}$ and $Q_{2}$ just remain in saturation?
(c) What is the large-signal voltage gain?
(d) Find the slope of the transfer characteristic at $v_{O}=V_{D D} / 2$.
(e) For operation as a small-signal amplifier around a bias point at $v_{O}=V_{D D} / 2$, find the small-signal voltage gain and output resistance.
**8.48 The MOSFETs in the circuit of Fig. P8.48 are matched, having $k_{n}^{\prime}(W / L)_{1}=k_{p}^{\prime}(W / L)_{2}=1 \mathrm{~mA} / \mathrm{V}^{2}$ and $\left|V_{i}\right|=$ 0.5 V . The resistance $R=1 \mathrm{M} \Omega$.
(a) For G and D open, what are the drain currents $I_{D 1}$ and $I_{D 2}$ ?
(b) For $r_{o}=\infty$, what is the voltage gain of the amplifier from G to D? (Hint: Replace the transistors with their small-signal models.)
(c) For finite $r_{o}\left(\left|V_{A}\right|=20 \mathrm{~V}\right)$, what is the voltage gain from G to D and the input resistance at G ?
(d) If G is driven (through a large coupling capacitor) from a source $v_{\text {sig }}$ having a resistance of $20 \mathrm{k} \Omega$, find the voltage gain $v_{d} / v_{\text {sig }}$.
(e) For what range of output signals do $Q_{1}$ and $Q_{2}$ remain in the saturation region?


Figure P8.48
8.49 Transistor $Q_{1}$ in the circuit of Fig. P8.49 is operating as a CE amplifier with an active load provided by transistor $Q_{2}$, which is the output transistor in a current mirror formed by $Q_{2}$ and $Q_{3}$. (Note that the biasing arrangement for $Q_{1}$ is not shown.)
(a) Neglecting the finite base currents of $Q_{2}$ and $Q_{3}$ and assuming that their $V_{B E} \simeq 0.7 \mathrm{~V}$ and that $Q_{2}$ has five times the area of $Q_{2}$, find the value of $I$.
(b) If $Q_{1}$ and $Q_{2}$ are specified to have $\left|V_{A}\right|=30 \mathrm{~V}$, find $r_{o 1}$ and $r_{o 2}$ and hence the total resistance at the collector of $Q_{1}$.

[^0]
[^0]:    ${ }^{8.48}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; $D=$ design problem
(c) Find $r_{a 1}$ and $g_{m 1}$ assuming that $\beta_{1}=50$.
(d) Find $R_{i n}, A_{i c}$, and $R_{i c}$.


Figure P8.49

D 8.50 It is required to design the CMOS amplifier of Fig. 8.16(a) utilizing a $0.18-\mu \mathrm{m}$ process for which $k_{n}^{\prime}=$ $387 \mu \mathrm{~A} / \mathrm{V}^{2}, k_{p}^{\prime}=86 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{i n}=-V_{t p}=0.5 \mathrm{~V}, V_{D D}=1.8 \mathrm{~V}$, $V_{A n}=5 \mathrm{~V} / \mu \mathrm{m}$, and $V_{A p}=-6 \mathrm{~V} / \mu \mathrm{m}$. The output voltage must be able to swing to within approximately 0.2 V of the power-supply rails (i.e., from 0.2 V to 1.6 V ), and the voltage gain must be at least $10 \mathrm{~V} / \mathrm{V}$. Design for a dc bias current of $50 \mu \mathrm{~A}$, and use devices with the same channel length. If the channel length is an integer multiple of the minimum $0.18 \mu \mathrm{~m}$, what channel length is needed and what $W / L$ ratios are required? If it is required to raise the gain by a factor of 2 , what channel length would be required, and by what factor does the total gate area of the circuit increase?

## Section 8.4: The CG and CB Amplifiers

8.51 A CG amplifier operating with $g_{m}=2 \mathrm{~mA} / \mathrm{V}$ and $r_{a}=20 \mathrm{k} \Omega$ is fed with a signal source having $R_{s}=1 \mathrm{k} \Omega$ and is loaded in a resistance $R_{L}=20 \mathrm{k} \Omega$. Find $R_{\mathrm{in}}, R_{\text {out }}$, and $v_{o} / v_{\text {sig }}$.
8.52 A CG amplifier operating with $g_{m}=2 \mathrm{~mA} / \mathrm{V}$ and $r_{a}=20 \mathrm{k} \Omega$ is fed with a signal source having a Norton equivalent composed of a current signal $i_{\text {sig }}$ and a source resistance $R_{s}=20 \mathrm{k} \Omega$. The amplifier is loaded in a resistance $R_{L}=20 \mathrm{k} \Omega$. Find $R_{\mathrm{in}}$ and $i_{o} / i_{\text {sig }}$, where $i_{o}$ is the current through the load $R_{L}$. If $R_{L}$ increases by a factor of 10 , by
what percentage does the current gain change? Can you see the effectiveness of the CG as a current buffer?

D 8.53 It is required to design the current source in Fig. P8.53 to deliver a current of 0.2 mA with an output resistance of 500 $\mathrm{k} \Omega$. The transistor has $V_{A}=20 \mathrm{~V}$ and $V_{i}=0.5 \mathrm{~V}$. Design for $V_{O V}=0.2 \mathrm{~V}$ and specify $R_{s}$ and $V_{\text {BIAS }}$.


Figure P8.53

D 8.54 Figure P8.54 shows a current source realized using a current mirror with two matched transistors $Q_{1}$ and $Q_{2}$. Two equal resistances $R_{s}$ are inserted in the source leads to increase the output resistance of the current source. If $Q_{2}$ is operating at $g_{m}=1 \mathrm{~mA} / \mathrm{V}$ and has $V_{A}=10 \mathrm{~V}$, and if the maximum allowed dc voltage drop across $R_{s}$ is 0.3 V , what is the maximum available output resistance of the current source? Assume that the voltage at the common-gate node is approximately constant.


Figure P8.54
8.55 In the common-gate amplifier circuit of Fig. P8.55, $Q_{2}$ and $Q_{3}$ are matched. $k_{n}^{\prime}(W / L)_{n}=k_{p}^{\prime}(W / L)_{p}=4 \mathrm{~mA} / \mathrm{V}^{2}$, and all transistors have $\left|V_{i}\right|=0.8 \mathrm{~V}$ and $\left|V_{A}\right|=20 \mathrm{~V}$.


Figure P8.55

The signal $v_{\text {sig }}$ is a small sinusoidal signal with no dc component.
(a) Neglecting the effect of $V_{A}$, find the dc drain current of $Q_{1}$ and the required value of $V_{\text {BIAS }}$.
(b) Find the values of $g_{m 1}$ and $r_{o}$ for all transistors.
(c) Find the value of $R_{\text {in }}$.
(d) Find the value of $R_{\text {out }}$.
(e) Calculate the voltage gains $v_{o} / v_{i}$ and $v_{o} / v_{\text {sig }}$.
(f) How large can $v_{\text {sig }}$ be (peak-to-peak) while maintaining saturation-mode operation for $Q_{1}$ and $Q_{2}$ ?
8.56 For the CB amplifier, use Eq. (8.63) to explore the variation of the input resistance $R_{\text {in }}$ with the load resistance $R_{L}$. Specifically, find $R_{\text {in }}$ as a multiple of $r_{e}$ for $R_{L} / r_{o}=0,1$, $10,100,1000$, and $\infty$. Let $\beta=100$. Present your results in tabular form.
8.57 What value of load resistance $R_{L}$ causes the input resistance of the CB amplifier to be approximately double the value of $r_{e}$ ?
8.58 Show that for the CB amplifier,

$$
\frac{R_{\text {out }}}{r_{o}} \simeq 1+\frac{\beta\left(R_{e} / r_{e}\right)}{\beta+1+\left(R_{e} / r_{e}\right)}
$$

Generate a table for $R_{\text {out }}$ as a multiple of $r_{o}$ versus $R_{e}$ as a multiple of $r_{e}$ with entries for $R_{e}=0, r_{e}, 2 r_{e}, 10 r_{e},(\beta / 2) r_{e}$, $\beta r_{e}$, and $1000 r_{e}$. Let $\beta=100$.
8.59 As mentioned in the text, the CB amplifier functions as a current buffer. That is, when fed with a current signal, it passes
it to the collector and supplies the output collector current at a high output resistance. Figure P8.59 shows a CB amplifier fed with a signal current $i_{\text {sig }}$ having a source resistance $R_{\text {sig }}=$ $10 \mathrm{k} \Omega$. The BJT is specified to have $\beta=100$ and $V_{A}=50 \mathrm{~V}$. (Note that the bias arrangement is not shown.) The output at the collector is represented by its Norton equivalent circuit. Find the value of the current gain $k$ and the output resistance $R_{\text {out }}$. Note that $k$ is the short-circuit current gain and should be evaluated using the T model of the transistor with the collector short-circuited to ground.


Figure P8.59
8.60 For the constant-current source circuit shown in Fig. P8.60, find the collector current $I$ and the output resistance. The BJT is specified to have $\beta=100, V_{B E}=0.7 \mathrm{~V}$, and $V_{A}=100 \mathrm{~V}$. If the collector voltage undergoes a change of 10 V while the BJT remains in the active mode, what is the corresponding change in collector current?


Figure P8.60

[^0]
[^0]:    8.58 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
8.61 Find the value of the resistance $R_{e}$, which, when connected in the emitter lead of a CE BJT amplifier, raises the output resistance by a factor of (a) 5 , (b) 10 , and (c) 50 . What is the maximum possible factor by which the output resistance can be raised, and at what value of $R_{e}$ is it achieved? Assume the BJT has $\beta=100$ and is biased at $I_{C}=0.5 \mathrm{~mA}$.

## Section 8.5: The Cascode Amplifier

D 8.62 In a MOS cascode amplifier, the cascode transistor is required to raise the output resistance by a factor of 50 . If the transistor is operated at $V_{O V}=0.2 \mathrm{~V}$, what must its $V_{A}$ be? If the process technology specifies $V_{A}^{\prime}$ as $5 \mathrm{~V} / \mu \mathrm{m}$, what channel length must the transistor have?

D 8.63 For a cascode current source such as that in Fig. 8.32, show that if the two transistors are identical, the current $I$ supplied by the current source and the output resistance $R_{o}$ are related by $I R_{o}=2\left|V_{A}\right|^{2} /\left|V_{O V}\right|$. Now consider the case of transistors that have $\left|V_{A}\right|=4 \mathrm{~V}$ and are operated at $\left|V_{O V}\right|$ of 0.2 V . Also, let $\mu_{p} C_{o s}=100 \mu \mathrm{~A} / \mathrm{V}^{2}$. Find the $W / L$ ratios required and the output resistance realized for the two cases: (a) $I=0.1 \mathrm{~mA}$ and (b) $I=0.5 \mathrm{~mA}$. Assume that $V_{S D}$ for the two devices is the minimum required (i.e., $\left|V_{O V}\right|$ ).

D *8.64 For a cascode current source, such as that in Fig. 8.32, show that if the two transistors are identical, the current $I$ supplied by the current source and the output resistance $R_{o}$ are related by

$$
I R_{o}=\frac{2\left|V_{A}^{\prime}\right|^{2}}{\left|V_{O V}\right|} L^{2}
$$

Now consider the case of a $0.18-\mu \mathrm{m}$ technology for which $\left|V_{A}^{\prime}\right|=5 \mathrm{~V} / \mu \mathrm{m}$ and let the transistors be operated at $\left|V_{O V}\right|=0.2 \mathrm{~V}$. Find the figure-of-merit $I R_{o}$ for the three cases of $L$ equal to the minimum channel length, twice the minimum, and three times the minimum. Complete the entries of the table at the bottom of the page. Give $W / L$ and the area $2 W L$ in terms of $n$, where $n$ is the value of $W / L$ for the case $I=0.01 \mathrm{~mA}$. In the table, $A_{v}$ denotes the gain obtained in a cascode amplifier such as that in Fig. 8.33 that utilizes our current source as load and which has the same values of $g_{m}$ and $R_{o}$ as the current-source transistors.
(a) For each current value, what is price paid for the increase in $R_{o}$ and $A_{v}$ obtained as $L$ is increased?
(b) For each value of $L$, what advantage is obtained as $I$ is increased, and what is the price paid? (Hint: We will see in Chapter 10 that the amplifier bandwidth increases with $g_{m}$.)
(c) Contrast the performance obtained from the circuit with the largest area with that obtained from the circuit with the smallest area.

D 8.65 Design the cascode amplifier of Fig. 8.30(a) to obtain $g_{m 1}=2 \mathrm{~mA} / \mathrm{V}$ and $R_{o}=200 \mathrm{k} \Omega$. Use a $0.18-\mu \mathrm{m}$ technology for which $V_{t o}=0.5 \mathrm{~V}, V_{A}^{\prime}=5 \mathrm{~V} / \mu \mathrm{m}$, and $k_{n}^{\prime}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$. Determine $L, W / L, V_{G 2}$, and $I$. Use identical transistors operated at $V_{O V}=0.25 \mathrm{~V}$, and design for the maximum possible negative signal swing at the output. What is the value of the minimum permitted output voltage?
8.66 The cascode amplifier of Fig. 8.33 is operated at a current of 0.2 mA with all devices operating at $\left|V_{O V}\right|=0.20 \mathrm{~V}$.

|  | $L=L_{\min }=0.18 \mu \mathrm{~m}$ |  |  |  | $L=2 L_{\min }=0.36 \mu \mathrm{~m}$ |  |  |  | $L=3 L_{\min }=0.54 \mu \mathrm{~m}$ |  |  |  |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
|  | $I R_{o}=$ |  |  |  | $I R_{o}=$ |  |  |  | $I R_{o}=$ |  |  |  |
|  | $\begin{gathered} g_{m} \\ (\mathrm{~mA} / \mathrm{V}) \end{gathered}$ | $\begin{gathered} R_{o} \\ (\mathrm{k} \Omega) \end{gathered}$ | $\begin{gathered} A_{v} \\ (\mathrm{~V} / \mathrm{V}) \end{gathered}$ | $\begin{gathered} 2 W L \\ \left(\mu \mathrm{~m}^{2}\right) \end{gathered}$ | $\begin{gathered} g_{m} \\ (\mathrm{~mA} / \mathrm{V}) \end{gathered}$ | $\begin{gathered} R_{o} \\ (\mathrm{k} \Omega) \end{gathered}$ | $\begin{gathered} A_{v} \\ (\mathrm{~V} / \mathrm{V}) \end{gathered}$ | $\begin{gathered} 2 W L \\ \left(\mu \mathrm{~m}^{2}\right) \end{gathered}$ | $\begin{gathered} g_{m} \\ (\mathrm{~mA} / \mathrm{V}) \end{gathered}$ | $\begin{gathered} R_{o} \\ (\mathrm{k} \Omega) \end{gathered}$ | $\begin{gathered} A_{v} \\ (\mathrm{~V} / \mathrm{V}) \end{gathered}$ | $\begin{gathered} 2 W L \\ \left(\mu \mathrm{~m}^{2}\right) \end{gathered}$ |
| $I=0.01 \mathrm{~mA}$ $W / L=n$ |  |  |  |  |  |  |  |  |  |  |  |  |
| $I=0.1 \mathrm{~mA}$ $W / L=$ |  |  |  |  |  |  |  |  |  |  |  |  |
| $I=1.0 \mathrm{~mA}$ $W / L=$ |  |  |  |  |  |  |  |  |  |  |  |  |

[^0]
[^0]:    8.64 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
All devices have $\left|V_{A}\right|=4 \mathrm{~V}$. Find $g_{m 1}$, the output resistance of the amplifier, $R_{o n}$, the output resistance of the current source, $R_{o p}$, the overall output resistance, $R_{o}$, and the voltage gain, $A_{v}$.
D 8.67 Design the CMOS cascode amplifier in Fig. 8.33 for the following specifications: $g_{m 1}=1 \mathrm{~mA} / \mathrm{V}$ and $A_{v}=$ -280 V/V. Assume that for the available fabrication process, $\left|V_{A}^{\prime}\right|=5 \mathrm{~V} / \mu \mathrm{m}$ for both NMOS and PMOS devices and that $\mu_{a} C_{o s}=4 \mu_{a} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$. Use the same channel length $L$ for all devices and operate all four devices at $\left|V_{O V}\right|=0.25 \mathrm{~V}$. Determine the required channel length $L$, the bias current $I$, and the W/L ratio for each of four transistors. Assume that suitable bias voltages have been chosen, and neglect the Early effect in determining the W/L ratios.
D 8.68 Design the circuit of Fig. 8.32 to provide an output current of $100 \mu \mathrm{~A}$. Use $V_{D D}=3.3 \mathrm{~V}$, and assume the PMOS transistors to have $\mu_{a} C_{o s}=60 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{s p}=-0.8 \mathrm{~V}$, and $\left|V_{A}\right|=5 \mathrm{~V}$. The current source is to have the widest possible signal swing at its output. Design for $V_{O V}=0.2 \mathrm{~V}$, and specify the values of the transistor $W / L$ ratios and of $V_{G 3}$ and $V_{G 4}$. What is the highest allowable voltage at the output? What is the value of $R_{o}$ ?
8.69 The cascode transistor can be thought of as providing a "shield" for the input transistor from the voltage variations at the output. To quantify this "shielding" property of the cascode, consider the situation in Fig. P8.69. Here we have grounded the input terminal (i.e., reduced $v_{i}$ to zero), applied a small change $v_{s}$ to the output node, and denoted the voltage change that results at the drain of $Q_{1}$ by $v_{s}$. By what factor is $v_{s}$ smaller than $v_{s}$ ?


Figure P8.69
*8.70 In this problem we investigate whether, as an alternative to cascoding, we can simply increase the channel length $L$ of the CS MOSFET. Specifically, we wish to compare the
two circuits shown in Fig. P8.70(b) and (c). The circuit in Fig. P8.70(b) is a CS amplifier in which the channel length has been quadrupled relative to that of the original CS amplifier in Fig. P8.70(a) while the drain bias current has been kept constant.

(a)

(c)

Figure P8.70
(a) Show that for this circuit $V_{O V}$ is double that of the original circuit, $g_{m}$ is half that of the original circuit, and $\frac{v_{s}}{v_{i}}$ is double that of the original circuit.
(b) Compare these values to those of the cascode circuit in Fig. P8.70(c), which is operating at the same bias current and has the same minimum voltage requirement at the drain as in the circuit of Fig. P8.70(b).
8.71 Consider the cascode amplifier of Fig. 8.33 with the dc component at the input $V_{I}=0.6 \mathrm{~V}, V_{G 2}=0.9 \mathrm{~V}, V_{G 3}=0.4 \mathrm{~V}$, $V_{G 4}=0.7 \mathrm{~V}$, and $V_{D D}=1.3 \mathrm{~V}$. If all devices are matched, that is, $k_{n 1}=k_{n 2}=k_{p 3}=k_{p 4}$, and have equal $\left|V_{i}\right|$ of 0.4 V , what is the overdrive voltage at which the four transistors are operating? What is the allowable voltage range at the output?

[^0]
[^0]:    $8.70=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
311 8.72 A CMOS cascode amplifier such as that in Fig. 8.34(a) has identical CS and CG transistors that have $W / L=5.4 \mu \mathrm{~m} / 0.36 \mu \mathrm{~m}$ and biased at $I=0.2 \mathrm{~mA}$. The fabrication process has $\mu_{n} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $V_{A}^{\prime}=$ $5 \mathrm{~V} / \mu \mathrm{m}$. At what value of $R_{L}$ does the gain become $-100 \mathrm{~V} / \mathrm{V}$ ? What is the voltage gain of the common-source stage?
8.73 The purpose of this problem is to investigate the signal currents and voltages at various points throughout a cascode


Figure P8.73
amplifier circuit. Knowledge of this signal distribution is very useful in designing the circuit so as to allow for the required signal swings. Figure P8.73 shows a CMOS cascode amplifier with all dc voltages replaced with signal grounds. As well, we have explicitly shown the resistance $r_{o}$ of each of the four transistors. For simplicity, we are assuming that the four transistors have the same $g_{m}$ and $r_{o}$. The amplifier is fed with a signal $v_{i}$.
(a) Determine $R_{1}, R_{2}$, and $R_{3}$. Assume $g_{m} r_{o} \gg 1$.
(b) Determine $i_{1}, i_{2}, i_{3}, i_{4}, i_{5}, i_{6}$, and $i_{7}$, all in terms of $v_{i}$. (Hint: Use the current-divider rule at the drain of $Q_{1}$.)
(c) Determine $v_{1}, v_{2}$, and $v_{3}$, all in terms of $v_{i}$.
(d) If $v_{i}$ is a $5-\mathrm{mV}$ peak sine wave and $g_{m} r_{o}=20$, sketch and clearly label the waveforms of $v_{1}, v_{2}$, and $v_{3}$.
D 8.74 Design the double-cascode current source shown in Fig. P8.74 to provide $I=0.2 \mathrm{~mA}$ and the largest possible signal swing at the output; that is, design for the minimum allowable voltage across each transistor. The $0.13-\mu \mathrm{m}$ CMOS fabrication process available has $V_{i p}=-0.4 \mathrm{~V}, V_{A}^{\prime}=-6 \mathrm{~V} / \mu \mathrm{m}$, and $\mu_{p} C_{o s}=100 \mu \mathrm{~A} / \mathrm{V}^{2}$. Use devices with $L=0.4 \mu \mathrm{~m}$, and operate at $\left|V_{O V}\right|=0.2 \mathrm{~V}$. Specify $V_{G 1}, V_{G 2}, V_{G 3}$, and the $W / L$ ratios of the transistors. What is the value of $R_{o}$ achieved?


Figure P8.74
*8.75 Figure P8.75 shows a folded-cascode CMOS amplifier utilizing a simple current source $Q_{2}$, supplying a current $2 I$, and a cascoded current source $\left(Q_{4}, Q_{5}\right)$ supplying a current I. Assume, for simplicity, that all transistors have equal parameters $g_{m}$ and $r_{o}$.

[^0]
[^0]:    3111 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem


Figure P8.75
(a) Give approximate expressions for all the resistances indicated.
(b) Find the amplifier output resistance $R_{o}$.
(c) Show that the short-circuit transconductance $G_{m}$ is approximately equal to $g_{m 1}$. Note that the short-circuit transconductance is determined by short-circuiting $v_{s}$ to ground and finding the current that flows through the short circuit, $G_{m} v_{i}$.
(d) Find the overall voltage gain $v_{o} / v_{i}$ and evaluate its value for the case $g_{m 1}=2 \mathrm{~mA} / \mathrm{V}$ and $A_{0}=30$.
8.76 A cascode current source formed of two pnp transistors for which $\beta=50$ and $V_{A}=5 \mathrm{~V}$ supplies a current of 0.2 mA . What is the output resistance?
8.77 Use Eq. (8.88) to show that for a BJT cascode current source utilizing identical pnp transistors and supplying a current $I$,

$$
I R_{o}=\frac{\left|V_{A}\right|}{\left(V_{T} /\left|V_{A}\right|\right)+(1 / \beta)}
$$

Evaluate the figure-of-merit $I R_{o}$ for the case $\left|V_{A}\right|=5 \mathrm{~V}$ and $\beta=50$. Now find $R_{o}$ for the cases of $I=0.1,0.5$, and 1.0 mA .
8.78 Consider the BJT cascode amplifier of Fig. 8.38 for the case all transistors have equal $\beta$ and $r_{o}$. Show that the voltage gain $A_{v}$ can be expressed in the form

$$
A_{v}=-\frac{1}{2} \frac{\left|V_{A}\right| / V_{T}}{\left(V_{T} /\left|V_{A}\right|\right)+(1 / \beta)}
$$

Evaluate $A_{v}$ for the case $\left|V_{A}\right|=5 \mathrm{~V}$ and $\beta=50$. Note that except for the fact that $\beta$ depends on $I$ as a second-order effect, the gain is independent of the bias current $I$ !
8.79 A bipolar cascode amplifier has a current-source load with an output resistance $\beta r_{o}$. Let $\beta=50,\left|V_{A}\right|=100 \mathrm{~V}$, and $I=0.2 \mathrm{~mA}$. Find the voltage gain $A_{v}$.
$\mathbf{D}^{* 8.80}$ Figure P8.80 shows four possible realizations of the folded cascode amplifier. Assume that the BJTs have $\beta=100$ and that both the BJTs and the MOSFETs have $\left|V_{A}\right|=5 \mathrm{~V}$.


Figure P8.80

[^0]
[^0]:    518 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem


Figure P8.80 continued

Let $I=100 \mu \mathrm{~A}$, and assume that the MOSFETs are operating at $\left|V_{D V}\right|=0.2 \mathrm{~V}$. Assume the current sources are ideal. For each circuit determine $R_{i n}, R_{o}$, and $A_{v o}$. Comment on your results.
8.81 In this problem, we will explore the difference between using a BJT as cascode device and a MOSFET as cascode device. Refer to Fig. P8.81. Given the following data, calculate $G_{m}, R_{o}$, and $A_{v o}$ for the circuits (a) and (b):
$I=100 \mu \mathrm{~A}, \beta=125, \mu_{n} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2}, W / L=25$, $V_{A}=1.8 \mathrm{~V}$

(a)

Figure P8.81

(b)

Figure P8.81 continued

## Section 8.6: Current-Mirror Circuits with Improved Performance

310 8.82 In a particular cascoded current mirror, such as that shown in Fig. 8.39, all transistors have $V_{t}=0.6 \mathrm{~V}$, $\mu_{n} C_{o s}=160 \mu \mathrm{~A} / \mathrm{V}^{2}, L=1 \mu \mathrm{~m}$, and $V_{A}=10 \mathrm{~V}$. Width $W_{1}=W_{4}=4 \mu \mathrm{~m}$, and $W_{2}=W_{3}=40 \mu \mathrm{~m}$. The reference current $I_{R E F}$ is $20 \mu \mathrm{~A}$. What output current results? What are the voltages at the gates of $Q_{2}$ and $Q_{3}$ ? What is the lowest voltage at the output for which current-source operation is possible? What are the values of $g_{m}$ and
$r_{o}$ of $Q_{2}$ and $Q_{3}$ ? What is the output resistance of the mirror?
8.83 Find the output resistance of the double-cascode current mirror of Fig. P8.83.


Figure P8.83
8.84 Consider the Wilson current-mirror circuit of Fig. 8.40 when supplied with a reference current $I_{\mathrm{REF}}$ of 1 mA . What is the change in $I_{O}$ corresponding to a change of +10 V in the voltage at the collector of $Q_{3}$ ? Give both the absolute value and the percentage change. Let $\beta=100$ and $V_{\mathrm{A}}=100 \mathrm{~V}$.

D 8.85 (a) The circuit in Fig. P8.85 is a modified version of the Wilson current mirror. Here the output transistor is "split" into two matched transistors, $Q_{3}$ and $Q_{4}$. Find $I_{O 1}$ and $I_{O 2}$ in terms of $I_{\text {REF }}$. Assume all transistors to be matched with current gain $\beta$.
(b) Use this idea to design a circuit that generates currents of $0.1 \mathrm{~mA}, 0.2 \mathrm{~mA}$, and 0.4 mA , using a reference current source of 0.7 mA . What are the actual values of the currents generated for $\beta=50$ ?


Figure P8.85

D 8.86 Use the pnp version of the Wilson current mirror to design a $0.1-\mathrm{mA}$ current source. The current source is required to operate with the voltage at its output terminal as low as -2.5 V . If the power supplies available are $\pm 2.5 \mathrm{~V}$, what is the highest voltage possible at the output terminal?
*8.87 For the Wilson current mirror of Fig. 8.40, show that the incremental input resistance seen by $I_{\mathrm{REF}}$ is approximately $2 V_{F} / I_{\mathrm{REF}}$. (Neglect the Early effect in this derivation and assume a signal ground at the output.) Evaluate $R_{\mathrm{m}}$ for $I_{\mathrm{REF}}=$ 0.2 mA .
*8.88 Consider the Wilson MOS mirror of Fig. 8.41(a) for the case of all transistors identical, with $W / L=10, \mu_{\mathrm{a}} C_{o s}=$ $400 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{t u}=0.5 \mathrm{~V}$, and $V_{\mathrm{a}}=18 \mathrm{~V}$. The mirror is fed with $I_{\mathrm{REF}}=180 \mu \mathrm{~A}$.
(a) Obtain an estimate of $V_{O V}$ and $V_{G S}$ at which the three transistors are operating, by neglecting the Early effect.
(b) Noting that $Q_{1}$ and $Q_{2}$ are operating at different $V_{D S}$, obtain an approximate value for the difference in their currents and hence determine $I_{O}$.
(c) To eliminate the systematic error between $I_{O}$ and $I_{\text {REF }}$ caused by the difference in $V_{D S}$ between $Q_{1}$ and $Q_{2}$, a diode-connected transistor $Q_{4}$ can be added to the circuit
as shown in Fig. 8.41(c). What do you estimate $I_{O}$ now to be?
(d) What is the minimum allowable voltage at the output node of the mirror?
(e) Convince yourself that $Q_{4}$ will have no effect on the output resistance of the mirror. Find $R_{o}$.
(f) What is the change in $I_{O}$ (both absolute value and percentage) that results from $\Delta V_{O}=1 \mathrm{~V}$ ?
8.89 Show that the incremental input resistance (seen by $I_{\text {REF }}$ ) for the Wilson MOS mirror of Fig. 8.41(a) is $2 / g_{m}$. Assume that all three transistors are identical and neglect the Early effect. Also, assume a signal ground at the output. (Hint: Replace all transistors by their T model and remember that $Q_{1}$ is equivalent to a resistance $1 / g_{m}$.)
D 8.90 (a) Utilizing a reference current of $200 \mu \mathrm{~A}$, design a Widlar current source to provide an output current of $20 \mu \mathrm{~A}$. Assume $\beta$ to be high.
(b) If $\beta=200$ and $V_{A}=50 \mathrm{~V}$, find the value of the output resistance, and find the change in output current corresponding to a $5-\mathrm{V}$ change in output voltage.
D 8.91 Design three Widlar current sources, each having a $100-\mu \mathrm{A}$ reference current: one with a current transfer ratio of 0.8 , one with a ratio of 0.10 , and one with a ratio of 0.01 , all assuming high $\beta$. For each, find the output resistance, and contrast it with $r_{o}$ of the basic unity-ratio source that is providing the desired current and for which $R_{E}=0$. Use $\beta=\infty$ and $V_{A}=50 \mathrm{~V}$.
D 8.92 (a) For the circuit in Fig. P8.92, assume BJTs with high $\beta$ and $v_{B E}=0.7 \mathrm{~V}$ at 1 mA . Find the value of $R$ that will result in $I_{O}=10 \mu \mathrm{~A}$.
(b) For the design in (a), find $R_{o}$ assuming $\beta=100$ and $V_{A}=40 \mathrm{~V}$.


Figure P8.92

D 8.93 If the pnp transistor in the circuit of Fig. P8.93 is characterized by its exponential relationship with a scale current $I_{S}$, show that the dc current $I$ is determined by $I R=V_{T} \ln \left(I / I_{S}\right)$. Assume $Q_{1}$ and $Q_{2}$ to be matched and $Q_{3}, Q_{4}$, and $Q_{5}$ to be matched. Find the value of $R$ that yields a current $I=200 \mu \mathrm{~A}$. For the BJT, $V_{E B}=0.7 \mathrm{~V}$ at $I_{E}=1 \mathrm{~mA}$.


Figure P8.93

## Section 8.7: Some Useful Transistor Pairings

8.94 Use the source-follower equivalent circuit in Fig. 8.45(b) to show that its output resistance is given by

$$
R_{o}=r_{o 3}\left\|r_{o 1}\right\| \frac{1}{g_{m}+g_{m b}} \simeq \frac{1}{g_{m}+g_{m b}}
$$

8.95 A source follower for which $h_{n}^{\prime}=200 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{A}^{\prime}=$ $20 \mathrm{~V} / \mu \mathrm{m}, \chi=0.2, L=0.5 \mu \mathrm{~m}, W=20 \mu \mathrm{~m}$, and $V_{i}=0.6 \mathrm{~V}$ is required to provide a dc level shift (between input and output of 0.9 V .) What must the bias current be? Find $g_{m}$, $g_{m b}, r_{o}, A_{o v}$, and $R_{o}$. Assume that the bias current source has an output resistance equal to $r_{o}$. Also find the voltage gain when a load resistance of $2 \mathrm{k} \Omega$ is connected to the output.
8.96 The transistors in the circuit of Fig. P8.96 have $\beta=100$ and $V_{A}=50 \mathrm{~V}$.(a) Find $R_{\mathrm{in}}$ and the overall voltage gain.
(b) What is the effect of increasing the bias currents by a factor of 10 on $R_{\mathrm{in}}, G_{v}$, and the power dissipation?


Figure P8.96
D*8.97 Consider the BiCMOS amplifier shown in Fig. P8.97. The BJT has $V_{R E}=0.7 \mathrm{~V}$ and $\beta=200$. The MOSFET has $V_{i}=1 \mathrm{~V}$ and $k_{0}=2 \mathrm{~mA} / \mathrm{V}^{2}$. Neglect the Early effect in both devices.


Figure P8.97
(a) Consider the dc bias circuit. Neglect the base current in $Q_{2}$ in determining the current in $Q_{1}$. Find the dc bias currents in $Q_{1}$ and $Q_{2}$ and show that they are approximately $100 \mu \mathrm{~A}$ and 1 mA , respectively.
(b) Evaluate the small-signal parameters of $Q_{1}$ and $Q_{2}$ at their bias points.
(c) Determine the voltage gain $A_{v}=v_{o} / v_{i}$. For this purpose you can neglect $R_{G}$.
(d) Noting that $R_{G}$ is connected between the input node where the voltage is $v_{i}$ and the output node where the voltage is $A_{v} v_{i}$, find $R_{\text {in }}$ and hence the overall voltage gain $v_{o} / v_{\text {sig }}$.
(e) To considerably reduce the effect of $R_{G}$ on $R_{\text {in }}$ and hence on $G_{v}$, consider the effect of adding another $10-\mathrm{M} \Omega$ resistor in series with the existing one and placing a large bypass capacitor between their joint node and ground. What will $R_{\text {in }}$ and $G_{v}$ become?
8.98 The BJTs in the Darlington follower of Fig. P8.98 have $\beta=100$. If the follower is fed with a source having a $100-\mathrm{k} \Omega$ resistance and is loaded with $1 \mathrm{k} \Omega$, find the input resistance and the output resistance (excluding the load). Also find the overall voltage gain, both open-circuited and with load. Neglect the Early effect.


Figure P8.98
8.99 For the amplifier in Fig. 8.48(a), let $I=0.5 \mathrm{~mA}$ and $\beta=100$, and neglect $r_{o}$. Assume that a load resistance of $10 \mathrm{k} \Omega$ is connected to the output terminal. If the amplifier is fed with a signal $v_{\text {sig }}$ having a source resistance $R_{\text {sig }}=10 \mathrm{k} \Omega$, find $G_{v}$.
8.100 Consider the CD-CG amplifier of Fig. 8.48(c) for the case $g_{m}=5 \mathrm{~mA} / \mathrm{V}, R_{\text {sig }}=500 \mathrm{k} \Omega$, and $R_{L}=10 \mathrm{k} \Omega$. Neglecting $r_{o}$, find $G_{v}$.
**8.101 In each of the six circuits in Fig. P8.101, let $\beta=100$, and neglect $r_{o}$. Calculate the overall voltage gain.


Figure P8.101
# CHAPTER 9 

## Differential and Multistage Amplifiers

Introduction 595
9.1 The MOS Differential Pair 596
9.2 The BJT Differential Pair 614
9.3 Common-Mode Rejection 627
9.4 DC Offset 637
9.5 The Differential Amplifier with a Current-Mirror Load 644
9.6 Multistage Amplifiers 659

Summary 672
Problems 674
# IN THIS CHAPTER YOU WILL LEARN 

1. The essence of the operation of the MOS and the bipolar differential amplifiers: how they reject common-mode noise or interference and amplify differential signals.
2. The analysis and design of MOS and BJT differential amplifiers.
3. Differential-amplifier circuits of varying complexity; utilizing passive resistive loads, current-source loads, and cascodes-the building blocks we studied in Chapter 8.
4. An ingenious and highly popular differential-amplifier circuit that utilizes a current-mirror load.
5. The structure, analysis, and design of amplifiers composed of two or more stages in cascade. Two practical examples are studied in detail: a two-stage CMOS op amp and a four-stage bipolar op amp.

## Introduction

The differential-pair or differential-amplifier configuration is the most widely used building block in analog integrated-circuit design. For instance, the input stage of every op amp is a differential amplifier. Also, the BJT differential amplifier is the basis of a very-high-speed logic-circuit family, studied in Chapter 15, called emitter-coupled logic (ECL).

Initially invented in the 1940s for use with vacuum tubes, the basic differential-amplifier configuration was subsequently implemented with discrete bipolar transistors. However, it was the advent of integrated circuits that has made the differential pair extremely popular in both bipolar and MOS technologies. There are two reasons why differential amplifiers are so well suited for IC fabrication: First, as we shall shortly see, the performance of the differential pair depends critically on the matching between the two sides of the circuit. Integrated-circuit fabrication is capable of providing matched devices whose parameters track over wide ranges of changes in environmental conditions. Second, by their very nature, differential amplifiers utilize more components (approaching twice as many) than single-ended circuits. Here again, the reader will recall from the discussion in Section 8.1 that a significant advantage of integrated-circuit technology is the availability of large numbers of transistors at relatively low cost.

We assume that the reader is familiar with the basic concept of a differential amplifier as presented in Section 2.1. Nevertheless it is worthwhile to answer the question: Why differential? Basically, there are two reasons for using differential in preference to single-ended amplifiers. First, differential circuits are much less sensitive to noise and interference than
single-ended circuits. To appreciate this point, consider two wires carrying a small differential signal as the voltage difference between the two wires. Now, assume that there is an interference signal that is coupled to the two wires, either capacitively or inductively. As the two wires are physically close together, the interference voltages on the two wires (i.e., between each of the two wires and ground) will be equal. Since, in a differential system, only the difference signal between the two wires is sensed, it will contain no interference component!

The second reason for preferring differential amplifiers is that the differential configuration enables us to bias the amplifier and to couple amplifier stages together without the need for bypass and coupling capacitors such as those utilized in the design of discrete-circuit amplifiers (Section 7.5). This is another reason why differential circuits are ideally suited for IC fabrication where large capacitors are impossible to fabricate economically.

The major topic of this chapter is the differential amplifier in both its MOS and bipolar implementations. As will be seen, the design and analysis of differential amplifiers makes extensive use of the material on single-stage amplifiers presented in Chapters 7 and 8 . We will follow the study of differential amplifiers with examples of practical multistage amplifiers, again in both MOS and bipolar technologies.

# 9.1 The MOS Differential Pair 

Figure 9.1 shows the basic MOS differential-pair configuration. It consists of two matched transistors, $Q_{1}$ and $Q_{2}$, whose sources are joined together and biased by a constant-current source $I$. The latter is usually implemented by a MOSFET circuit of the type studied in Sections 8.2 and 8.5. For the time being, we assume that the current source is ideal and that it has infinite output resistance. Although each drain is shown connected to the positive supply through a resistance $R_{D}$, in most cases active (current-source) loads are employed, as will be seen shortly. For the time being, however, we will explain the essence of the differential-pair operation utilizing simple resistive loads. Whatever type of load is used, it is essential that the MOSFETs not enter the triode region of operation.


Figure 9.1 The basic MOS differential-pair configuration.
# 9.1.1 Operation with a Common-Mode Input Voltage 

To see how the differential pair works, consider first the case when equal voltages, $V_{C M}$, are applied to the two gate terminals. That is, as shown in Fig. 9.2, $v_{G 1}=v_{G 2}=V_{C M}$. Since $V_{C M}$ is common to the two input terminals, it is called common-mode voltage. Since $Q_{1}$ and $Q_{2}$ are matched, the current $I$ will divide equally between the two transistors. Thus, $i_{D 1}=i_{D 2}=I / 2$, and the voltage at the sources, $V_{S}$, will be

$$
V_{S}=V_{C M}-V_{G S}
$$

where $V_{G S}$ is the gate-to-source voltage corresponding to a drain current of $I / 2$. Neglecting channel-length modulation, $V_{G S}$ and $I / 2$ are related by

$$
\frac{I}{2}=\frac{1}{2} k_{a}^{\prime} \frac{W}{L}\left(V_{G S}-V_{t}\right)^{2}
$$

or in terms of the overdrive voltage $V_{O V}$,

$$
\begin{aligned}
V_{O V} & =V_{G S}-V_{t} \\
\frac{I}{2} & =\frac{1}{2} k_{a}^{\prime} \frac{W}{L} V_{O V}^{2} \\
V_{O V} & =\sqrt{I / k_{a}^{\prime}(W / L)}
\end{aligned}
$$

The voltage at each drain will be

$$
v_{D 1}=v_{D 2}=V_{D D}-\frac{I}{2} R_{D}
$$

Thus, the difference in voltage between the two drains will be zero.
Now, let us vary the value of the common-mode voltage $V_{C M}$. We see that, as long as $Q_{1}$ and $Q_{2}$ remain in the saturation region, the current $I$ will divide equally between $Q_{1}$ and $Q_{2}$ and the voltages at the drains will not change. Thus the differential pair does not respond to (i.e., it rejects) common-mode input signals.


Figure 9.2 The MOS differential pair with a common-mode input voltage $V_{C M}$.
An important specification of a differential amplifier is its input common-mode range. This is the range of $V_{C M}$ over which the differential pair operates properly. The highest value of $V_{C M}$ is limited by the requirement that $Q_{1}$ and $Q_{2}$ remain in saturation, thus

$$
V_{C M \max }=V_{t}+V_{D D}-\frac{I}{2} R_{D}
$$

The lowest value of $V_{C M}$ is determined by the need to allow for a sufficient voltage across the current source $I$ for it to operate properly. If a voltage $V_{C S}$ is needed across the current source, then

$$
V_{C M \min }=-V_{S S}+V_{C S}+V_{t}+V_{O V}
$$

# Example 9.1 

For the MOS differential pair with a common-mode voltage $V_{C M}$ applied, as shown in Fig. 9.2, let $V_{D D}=$ $V_{S S}=1.5 \mathrm{~V}, k_{u}^{\prime}(W / L)=4 \mathrm{~mA} / \mathrm{V}^{2}, V_{t}=0.5 \mathrm{~V}, I=0.4 \mathrm{~mA}$, and $R_{D}=2.5 \mathrm{k} \Omega$, and neglect channel-length modulation. Assume that the current source $I$ requires a minimum voltage of 0.4 V to operate properly.
(a) Find $V_{O V}$ and $V_{G S}$ for each transistor.
(b) For $V_{C M}=0$, find $V_{S}, I_{D 1}, I_{D 2}, V_{D 1}$, and $V_{D 2}$.
(c) Repeat (b) for $V_{C M}=+1 \mathrm{~V}$.
(d) Repeat (b) for $V_{C M}=-0.2 \mathrm{~V}$.
(e) What is the highest permitted value of $V_{C M}$ ?
(f) What is the lowest value allowed for $V_{C M}$ ?

## Solution

(a) With $v_{G 1}=v_{G 2}=V_{C M}$, we see that $V_{G S 1}=V_{G S 2}$. Now, since the transistors are matched, $I$ will divide equally between the two transistors,

$$
I_{D 1}=I_{D 2}=\frac{I}{2}
$$

Thus,

$$
\begin{aligned}
\frac{I}{2} & =\frac{1}{2} k_{u}^{\prime}(W / L) V_{O V}^{2} \\
\frac{0.4}{2} & =\frac{1}{2} \times 4 V_{O V}^{2}
\end{aligned}
$$

which results in

$$
V_{O V}=0.316 \mathrm{~V}
$$

and thus,

$$
V_{G S}=V_{t}+V_{O V}=0.5+0.316 \simeq 0.82 \mathrm{~V}
$$


Figure 9.3 Circuits for Example 9.1. Effects of varying $V_{C M}$ on the operation of the differential pair.
(b) The analysis for the case $V_{C M}=0$ is shown in Fig. 9.3(a) from which we see that

$$
\begin{aligned}
V_{S} & =V_{G}-V_{G S}=0-0.82=-0.82 \mathrm{~V} \\
I_{D 1} & =I_{D 2}=\frac{I}{2}=0.2 \mathrm{~mA}
\end{aligned}
$$
# Example 9.1 continued 

$$
\begin{aligned}
V_{D 1} & =V_{D 2}=V_{D D}-\frac{I}{2} R_{D} \\
& =1.5-0.2 \times 2.5=1 \mathrm{~V}
\end{aligned}
$$

(c) The analysis for the case $V_{C M}=+1 \mathrm{~V}$ is shown in Fig. 9.3(b) from which we see that

$$
\begin{aligned}
& V_{S}=V_{G}-V_{G S}=1-0.82=+0.18 \mathrm{~V} \\
& I_{D 1}=I_{D 2}=\frac{I}{2}=0.2 \mathrm{~mA} \\
& V_{D 1}=V_{D 2}=V_{D D}-\frac{I}{2} R_{D}=1.5-0.2 \times 2.5=+1 \mathrm{~V}
\end{aligned}
$$

Observe that the transistors remain in the saturation region as assumed. Also observe that $I_{D 1}, I_{D 2}, V_{D 1}$, and $V_{D 2}$ remain unchanged even though the common-mode voltage $V_{C M}$ changed by 1 V .
(d) The analysis for the case $V_{C M}=-0.2 \mathrm{~V}$ is shown in Fig. 9.3(c), from which we see that

$$
V_{S}=V_{G}-V_{G S}=-0.2-0.82=-1.02 \mathrm{~V}
$$

It follows that the current source $I$ now has a voltage across it of

$$
V_{C S}=-V_{S}-\left(-V_{S S}\right)=-1.02+1.5=0.48 \mathrm{~V}
$$

which is greater than the minimum required value of 0.4 V . Thus, the current source is still operating properly and delivering a constant current $I=0.4 \mathrm{~mA}$ and hence

$$
\begin{aligned}
& I_{D 1}=I_{D 2}=\frac{I}{2}=0.2 \mathrm{~mA} \\
& V_{D 1}=V_{D 2}=V_{D D}-\frac{I}{2} R_{D}=+1 \mathrm{~V}
\end{aligned}
$$

So, here again the differential circuit is not responsive to the change in the common-mode voltage $V_{C M}$.
(e) The highest permitted value of $V_{C M}$ is that which causes $Q_{1}$ and $Q_{2}$ to leave saturation and enter the triode region. Thus,

$$
\begin{aligned}
V_{C M \max } & =V_{i}+V_{D} \\
& =0.5+1=+1.5 \mathrm{~V}
\end{aligned}
$$

(f) The lowest value allowed for $V_{C M}$ is that which reduces the voltage across the current source $I$ to the minimum required of $V_{C S}=0.4 \mathrm{~V}$. Thus,

$$
\begin{aligned}
V_{C M \min } & =-V_{S S}+V_{C S}+V_{G S} \\
& =-1.5+0.4+0.82=-0.28 \mathrm{~V}
\end{aligned}
$$

Thus, the input common-mode range is

$$
-0.28 \mathrm{~V} \leq V_{C M} \leq+1.5 \mathrm{~V}
$$
# EXERCISE 

9.1 For the amplifier in Example 9.1, find the input common-mode range for the case in which the two drain resistances $R_{D}$ are increased by a factor of 2 .
Ans. -0.28 V to 1.0 V

### 9.1.2 Operation with a Differential Input Voltage

Next we apply a difference or differential input voltage by grounding the gate of $Q_{2}$ (i.e., setting $v_{G 2}=0$ ) and applying a signal $v_{i d}$ to the gate of $Q_{1}$, as shown in Fig. 9.4. We can see that since $v_{i d}=v_{G S 1}-v_{G S 2}$, if $v_{i d}$ is positive, $v_{G S 1}$ will be greater than $v_{G S 2}$ and hence $i_{D 1}$ will be greater than $i_{D 2}$ and the difference output voltage $\left(v_{D 2}-v_{D 1}\right)$ will be positive. On the other hand, when $v_{i d}$ is negative, $v_{G S 1}$ will be lower than $v_{G S 2}, i_{D 1}$ will be smaller than $i_{D 2}$, and correspondingly $v_{D 1}$ will be higher than $v_{D 2}$; in other words, the difference or differential output voltage $\left(v_{D 2}-v_{D 1}\right)$ will be negative.

From the above, we see that the differential pair responds to difference-mode or differential input signals by providing a corresponding differential output signal between the two drains. At this point, it is useful to inquire about the value of $v_{i d}$ that causes the entire bias current $I$ to flow in one of the two transistors. In the positive direction, this happens when $v_{G S 1}$ reaches the value that corresponds to $i_{D 1}=I$, and $v_{G S 2}$ is reduced to a value equal to the threshold voltage $V_{t}$, at which point $v_{S}=-V_{t}$. The value of $v_{G S 1}$ can be found from

$$
I=\frac{1}{2}\left(k_{o} \frac{W}{L}\right)\left(v_{G S 1}-V_{t}\right)^{2}
$$



Figure 9.4 The MOS differential pair with a differential input signal $v_{i d}$ applied. With $v_{i d}$ positive: $v_{G S 1}>v_{G S 2}$, $i_{D 1}>i_{D 2}$, and $v_{D 1}<v_{D 2}$; thus $\left(v_{D 2}-v_{D 1}\right)$ will be positive. With $v_{i d}$ negative: $v_{G S 1}$ $<v_{G S 2}, i_{D 1}<i_{D 2}$, and $v_{D 1}>v_{D 2}$; thus $\left(v_{D 2}-v_{D 1}\right)$ will be negative.as

$$
\begin{aligned}
v_{G S 1} & =V_{t}+\sqrt{2 I / k_{n}^{\prime}(W / L)} \\
& =V_{t}+\sqrt{2} V_{O V}
\end{aligned}
$$

where $V_{O V}$ is the overdrive voltage corresponding to a drain current of $I / 2$ (Eq. 9.5). Thus, the value of $v_{i d}$ at which the entire bias current $I$ is steered into $Q_{1}$ is

$$
\begin{aligned}
v_{i d \max } & =v_{G S 1}+v_{S} \\
& =V_{i}+\sqrt{2} V_{O V}-V_{i} \\
& =\sqrt{2} V_{O V}
\end{aligned}
$$

If $v_{i d}$ is increased beyond $\sqrt{2} V_{O V}, i_{D 1}$ remains equal to $I, v_{G S 1}$ remains equal to $\left(V_{i}+\sqrt{2} V_{O V}\right)$, and $v_{S}$ rises correspondingly, thus keeping $Q_{2}$ off. In a similar manner we can show that in the negative direction, as $v_{i d}$ reaches $-\sqrt{2} V_{O V}, Q_{1}$ turns off and $Q_{2}$ conducts the entire bias current $I$. Thus the current $I$ can be steered from one transistor to the other by varying $v_{i d}$ in the range

$$
-\sqrt{2} V_{O V} \leq v_{i d} \leq \sqrt{2} V_{O V}
$$

which defines the range of differential-mode operation. Finally, observe that we have assumed that $Q_{1}$ and $Q_{2}$ remain in saturation even when one of them is conducting the entire current $I$.

# EXERCISE 

9.2 For the MOS differential pair specified in Example 9.1 find (a) the value of $v_{i d}$ that causes $Q_{1}$ to conduct the entire current $I$, and the corresponding values of $v_{D 1}$ and $v_{D 2}$; (b) the value of $v_{i d}$ that causes $Q_{2}$ to conduct the entire current $I$, and the corresponding values of $v_{D 1}$ and $v_{D 2}$; (c) the corresponding range of the differential output voltage $\left(v_{D 2}-v_{D 1}\right)$.
Ans. (a) $+0.45 \mathrm{~V}, 0.5 \mathrm{~V}, 1.5 \mathrm{~V}$; (b) $-0.45 \mathrm{~V}, 1.5 \mathrm{~V}, 0.5 \mathrm{~V}$; (c) +1 V to -1 V

To use the differential pair as a linear amplifier, we keep the differential input signal $v_{i d}$ small. As a result, the current in one of the transistors ( $Q_{1}$ when $v_{i d}$ is positive) will increase by an increment $\Delta I$ proportional to $v_{i d}$, to $(I / 2+\Delta I)$. Simultaneously, the current in the other transistor will decrease by the same amount to become $(I / 2-\Delta I)$. A voltage signal $-\Delta I R_{D}$ develops at one of the drains and an opposite-polarity signal, $\Delta I R_{D}$, develops at the other drain. Thus the output voltage taken between the two drains will be $2 \Delta I R_{D}$, which is proportional to the differential input signal $v_{i d}$. The small-signal operation of the differential pair will be studied in detail in Section 9.1.4.

### 9.1.3 Large-Signal Operation

We shall now derive expressions for the drain currents $i_{D 1}$ and $i_{D 2}$ in terms of the input differential signal $v_{i d} \equiv v_{G 1}-v_{G 2}$. The derivation assumes that the differential pair is perfectly


Figure 9.5 The MOSFET differential pair for the purpose of deriving the transfer characteristics, $i_{D 1}$ and $i_{D 2}$ versus $v_{i d}=v_{G 1}-v_{G 2}$.
matched and neglects channel-length modulation ( $\lambda=0$ or $V_{A}=\infty$ ). Thus these expressions do not depend on the details of the circuit to which the drains are connected, and we do not show these connections in Fig. 9.5; we simply assume that the circuit maintains $Q_{1}$ and $Q_{2}$ in the saturation region of operation at all times.

To begin with, we express the drain currents of $Q_{1}$ and $Q_{2}$ as

$$
\begin{aligned}
& i_{D 1}=\frac{1}{2} k_{n}^{\prime} \frac{W}{L}\left(v_{G S 1}-V_{t}\right)^{2} \\
& i_{D 2}=\frac{1}{2} k_{n}^{\prime} \frac{W}{L}\left(v_{G S 2}-V_{t}\right)^{2}
\end{aligned}
$$

Taking the square roots of both sides of each of Eqs. (9.11) and (9.12), we obtain

$$
\begin{aligned}
& \sqrt{i_{D 1}}=\sqrt{\frac{1}{2} k_{n}^{\prime} \frac{W}{L}}\left(v_{G S 1}-V_{t}\right) \\
& \sqrt{i_{D 2}}=\sqrt{\frac{1}{2} k_{n}^{\prime} \frac{W}{L}}\left(v_{G S 2}-V_{t}\right)
\end{aligned}
$$

Subtracting Eq. (9.14) from Eq. (9.13) and substituting

$$
v_{G S 1}-v_{G S 2}=v_{G 1}-v_{G 2}=v_{i d}
$$

results in

$$
\sqrt{i_{D 1}}-\sqrt{i_{D 2}}=\sqrt{\frac{1}{2} k_{n}^{\prime} \frac{W}{L}} v_{i d}
$$

The constant-current bias imposes the constraint

$$
i_{D 1}+i_{D 2}=I
$$

Equations (9.16) and (9.17) are two equations in the two unknowns $i_{D 1}$ and $i_{D 2}$ and can be solved as follows: Squaring both sides of Eq. (9.16) and substituting for $i_{D 1}+i_{D 2}=I$ gives

$$
2 \sqrt{i_{D 1} i_{D 2}}=I-\frac{1}{2} k_{n}^{\prime} \frac{W}{L} v_{i d}^{2}
$$
Substituting for $i_{D 2}$ from Eq. (9.17) as $i_{D 2}=I-i_{D 1}$ and squaring both sides of the resulting equation provides a quadratic equation in $i_{D 1}$ that can be solved to yield

$$
i_{D 1}=\frac{I}{2} \pm \sqrt{k_{a}^{\prime} \frac{W}{L} I}\left(\frac{v_{i d}}{2}\right) \sqrt{1-\frac{\left(v_{i d} / 2\right)^{2}}{I / k_{a}^{\prime} \frac{W}{L}}}
$$

Now, since the increment in $i_{D 1}$ above the bias value of $I / 2$ must have the same polarity as $v_{i d}$, only the root with the " + " sign in the second term is physically meaningful; thus,

$$
i_{D 1}=\frac{I}{2}+\sqrt{k_{a}^{\prime} \frac{W}{L} I}\left(\frac{v_{i d}}{2}\right) \sqrt{1-\frac{\left(v_{i d} / 2\right)^{2}}{I / k_{a}^{\prime} \frac{W}{L}}}
$$

The corresponding value of $i_{D 2}$ is found from $i_{D 2}=I-i_{D 1}$ as

$$
i_{D 2}=\frac{I}{2}-\sqrt{k_{a}^{\prime} \frac{W}{L} I}\left(\frac{v_{i d}}{2}\right) \sqrt{1-\frac{\left(v_{i d} / 2\right)^{2}}{I / k_{a}^{\prime} \frac{W}{L}}}
$$

At the bias (quiescent) point, $v_{i d}=0$, leading to

$$
i_{D 1}=i_{D 2}=\frac{I}{2}
$$

Correspondingly,

$$
v_{G S 1}=v_{G S 2}=V_{G S}
$$

where

$$
\frac{I}{2}=\frac{1}{2} k_{a}^{\prime} \frac{W}{L}\left(V_{G S}-V_{i}\right)^{2}=\frac{1}{2} k_{a}^{\prime} \frac{W}{L} V_{O V}^{2}
$$

This relationship enables us to replace $k_{a}^{\prime}(W / L)$ in Eqs. (9.18) and (9.19) with $I / V_{O V}^{2}$ to express $i_{D 1}$ and $i_{D 2}$ in the alternative form

$$
\begin{aligned}
& i_{D 1}=\frac{I}{2}+\left(\frac{I}{V_{O V}}\right)\left(\frac{v_{i d}}{2}\right) \sqrt{1-\left(\frac{v_{i d} / 2}{V_{O V}}\right)^{2}} \\
& i_{D 2}=\frac{I}{2}-\left(\frac{I}{V_{O V}}\right)\left(\frac{v_{i d}}{2}\right) \sqrt{1-\left(\frac{v_{i d} / 2}{V_{O V}}\right)^{2}}
\end{aligned}
$$

These two equations describe the effect of applying a differential input signal $v_{i d}$ on the currents $i_{D 1}$ and $i_{D 2}$. They can be used to obtain the normalized plots, $i_{D 1} / I$ and $i_{D 2} / I$ versus $v_{i d} / V_{O V}$, shown in Fig. 9.6. Note that at $v_{i d}=0$, the two currents are equal to $I / 2$. Making $v_{i d}$ positive causes $i_{D 1}$ to increase and $i_{D 2}$ to decrease by equal amounts, to keep the sum constant, $i_{D 1}+i_{D 2}=I$. The current is steered entirely into $Q_{1}$ when $v_{i d}$ reaches the value $\sqrt{2} V_{O V}$, as we found out earlier. For $v_{i d}$ negative, identical statements can be made by interchanging $i_{D 1}$ and $i_{D 2}$. In this case, $v_{i d}=-\sqrt{2} V_{O V}$ steers the current entirely into $Q_{2}$. Finally, note that the plots in Fig. 9.6 are universal, as they apply to any MOS differential pair.


Figure 9.6 Normalized plots of the currents in a MOSFET differential pair. Note that $V_{O V}$ is the overdrive voltage at which $Q_{1}$ and $Q_{2}$ operate when conducting drain currents equal to $I / 2$, the equilibrium situation. Note that these graphs are universal and apply to any MOS differential pair.

The transfer characteristics of Eqs. (9.23) and (9.24) and Fig. 9.6 are obviously nonlinear. This is due to the term involving $v_{i d}^{2}$. Since we are interested in obtaining linear amplification from the differential pair, we will strive to make this term as small as possible. For a given value of $V_{O V}$, the only thing we can do is keep $\left(v_{i d} / 2\right)$ much smaller than $V_{O V}$, which is the condition for the small-signal approximation. It results in

$$
i_{D 1} \simeq \frac{I}{2}+\left(\frac{I}{V_{O V}}\right)\left(\frac{v_{i d}}{2}\right)
$$

and

$$
i_{D 2} \simeq \frac{I}{2}-\left(\frac{I}{V_{O V}}\right)\left(\frac{v_{i d}}{2}\right)
$$

which, as expected, indicate that $i_{D 1}$ increases by an increment $i_{d}$, and $i_{D 2}$ decreases by the same amount, $i_{d}$, where $i_{d}$ is proportional to the differential input signal $v_{i d}$,

$$
i_{d}=\left(\frac{I}{V_{O V}}\right)\left(\frac{v_{i d}}{2}\right)
$$

Recalling from our study of the MOSFET amplifier in Chapter 7 (also refer to Table G. 3 in Appendix G), that a MOSFET biased at a current $I_{D}$ has a transconductance $g_{m}=2 I_{D} / V_{O V}$, we recognize the factor $\left(I / V_{O V}\right)$ in Eq. (9.27) as $g_{m}$ of each of $Q_{1}$ and $Q_{2}$, which are biased at $I_{D}=I / 2$. Now, why $v_{i d} / 2$ ? Simply because $v_{i d}$ divides equally between the two devices with $v_{g e 1}=v_{i d} / 2$ and $v_{g e 2}=-v_{i d} / 2$, which causes $Q_{1}$ to have a current increment $i_{d}$ and $Q_{2}$ to have a current decrement $i_{d}$. We shall analyze the small-signal operation of the MOS differential pair


Figure 9.7 The linear range of operation of the MOS differential pair can be extended by operating the transistor at a higher value of $V_{O V}$.
shortly. At this time, however, we wish to return to Eqs. (9.23) and (9.24) and note that for a given $v_{i d}$, linearity can be increased by increasing the overdrive voltage $V_{O V}$ at which each of $Q_{1}$ and $Q_{2}$ is operating. This can be done by using smaller $W / L$ ratios. The price paid for the increased linearity is a reduction in $g_{m}$ and hence a reduction in gain. In this regard, we observe that the normalized plot of Fig. 9.6, though compact, masks this design degree of freedom. Figure 9.7 shows plots of the transfer characteristics $i_{D 1,2} / I$ versus $v_{i d}$ for various values of $V_{O V}$. These graphs clearly illustrate the linearity-transconductance trade-off obtained by changing the value of $V_{O V}$ : The linear range of operation can be extended by operating the MOSFETs at a higher $V_{O V}$ (by using smaller $W / L$ ratios) at the expense of reducing $g_{m}$ and hence the gain. This trade-off is based on the assumption that the bias current $I$ is being kept constant. The bias current can, of course, be increased to obtain a higher $g_{m}$. The expense for doing this, however, is increased power dissipation, a serious limitation in IC design.

# EXERCISE 

9.3 A MOS differential pair is operated at a bias current $I$ of 0.4 mA . If $\mu_{n} C_{o s}=0.2 \mathrm{~mA} / \mathrm{V}^{2}$, find the required values of $W / L$ and the resulting $g_{m}$ if the MOSFETs are operated at $V_{O V}=0.2,0.3$, and 0.4 V . For each value, give the maximum $\left|v_{i d}\right|$ for which the term involving $v_{i d}^{2}$ in Eqs. (9.23) and (9.24), namely, $\left(\left(v_{i d} / 2\right) / V_{O V}\right)^{2}$, is limited to 0.1 .
Ans.

| $V_{O V}(\mathrm{~V})$ | 0.2 | 0.3 | 0.4 |
| :-- | :--: | :--: | :--: |
| $W / L$ | 50 | 22.2 | 12.5 |
| $g_{m}(\mathrm{~mA} / \mathrm{V})$ | 2 | 1.33 | 1 |
| $\left|v_{i d}\right|_{\max }(\mathrm{mV})$ | 126 | 190 | 253 |
# 9.1.4 Small-Signal Operation 

In this section we build on the understanding gained of the basic operation of the differential pair and consider in some detail its operation as a linear amplifier.

Differential Gain Figure 9.8(a) shows the MOS differential amplifier with input voltages

$$
v_{G 1}=V_{C M}+\frac{1}{2} v_{i d}
$$

and

$$
v_{G 2}=V_{C M}-\frac{1}{2} v_{i d}
$$

Here, $V_{C M}$ denotes a common-mode dc voltage within the input common-mode range of the differential amplifier. It is needed in order to set the dc voltage of the MOSFET gates. Typically


Figure 9.8 Small-signal analysis of the MOS differential amplifier. (a) The circuit with a common-mode voltage applied to set the dc bias voltage at the gates and with $v_{i d}$ applied in a complementary (or balanced) manner. (b) The circuit prepared for small-signal analysis. (c) The circuit in (b), with the MOSFETs replaced with T models.
$V_{C M}$ is at the middle value of the power supply. Thus, for our case, where two complementary supplies are utilized, $V_{C M}$ is typically 0 V .

The differential input signal $v_{i d}$ is applied in a complementary (or balanced) manner; that is, $v_{G 1}$ is increased by $v_{i d} / 2$ and $v_{G 2}$ is decreased by $v_{i d} / 2$. This would be the case, for instance, if the differential amplifier were fed from the output of another differential-amplifier stage. Sometimes, however, the differential input is applied in a single-ended fashion, as we saw earlier in Fig. 9.4. The difference in the performance resulting is too subtle a point for our current needs.

As indicated in Fig. 9.8(a) the amplifier output can be taken either between one of the drains and ground or between the two drains. In the first case, the resulting single-ended outputs $v_{o 1}$ and $v_{o 2}$ will be riding on top of the dc voltages at the drains, $\left(V_{D D}-\frac{I}{2} R_{D}\right)$. This is not the case when the output is taken between the two drains; the resulting differential output $v_{o d}$ (having a $0-\mathrm{V}$ dc component) will be entirely a signal component. We will see shortly that there are other significant advantages to taking the output voltage differentially.

Our objective now is to analyze the small-signal operation of the differential amplifier of Fig. 9.8(a) to determine its voltage gain in response to the differential input signal $v_{i d}$. Toward that end we show in Fig. 9.8(b) the circuit with the power supplies grounded, the bias current source $I$ removed, and $V_{C M}$ eliminated; that is, only signal quantities are indicated. For the time being we will neglect the effect of the MOSFET $r_{o}$. Finally note that each of $Q_{1}$ and $Q_{2}$ is biased at a dc current of $I / 2$ and is operating at an overdrive voltage $V_{O V}$.

From the symmetry of the circuit and because of the balanced manner in which $v_{i d}$ is applied, we observe that the signal voltage at the joint source connection must be zero, acting as a sort of virtual ground. Thus $Q_{1}$ has a gate-to-source voltage signal $v_{g s 1}=v_{i d} / 2$ and $Q_{2}$ has $v_{g s 2}=-v_{i d} / 2$. Assuming $v_{i d} / 2 \ll V_{O V}$, the condition for the small-signal approximation, the changes resulting in the drain currents of $Q_{1}$ and $Q_{2}$ will be proportional to $v_{g s 1}$ and $v_{g s 2}$, respectively. Thus $Q_{1}$ will have a drain current increment $g_{m}\left(v_{i d} / 2\right)$ and $Q_{2}$ will have a drain current decrement $g_{m}\left(v_{i d} / 2\right)$, where $g_{m}$ denotes the equal transconductances of the two devices,

$$
g_{m}=\frac{2 I_{D}}{V_{O V}}=\frac{2(I / 2)}{V_{O V}}=\frac{I}{V_{O V}}
$$

These results correspond to those obtained earlier using the large-signal transfer characteristics and imposing the small-signal condition, Eqs. (9.25) to (9.27). To further illustrate the small-signal operation of the differential amplifier, we show in Fig. 9.8(c) its equivalent circuit obtained by replacing each of the MOSFETs with the corresponding T model. The reader is urged to study the correspondence between the elements and qualities in Fig. 9.8(b) and $9.8(\mathrm{c})$.

It is useful at this point to observe again that a signal ground is established at the source terminals of the transistors without resorting to the use of a large bypass capacitor, clearly a major advantage of the differential-pair configuration.

The essence of differential-pair operation is that it provides complementary current signals in the drains; what we do with the resulting pair of complementary current signals is, in a sense, a separate issue. Here, of course, we are simply passing the two current signals through a pair of matched resistors, $R_{D}$, and thus obtaining the drain voltage signals

$$
v_{o 1}=-g_{m} \frac{v_{i d}}{2} R_{D}
$$
and

$$
v_{o 2}=+g_{m} \frac{v_{i d}}{2} R_{D}
$$

If the output is taken in a single-ended fashion, the resulting gain becomes

$$
\frac{v_{o 1}}{v_{i d}}=-\frac{1}{2} g_{m} R_{D}
$$

or

$$
\frac{v_{o 2}}{v_{i d}}=\frac{1}{2} g_{m} R_{D}
$$

Alternatively, if the output is taken differentially, the gain becomes

$$
A_{d} \equiv \frac{v_{o d}}{v_{i d}}=\frac{v_{o 2}-v_{o 1}}{v_{i d}}=g_{m} R_{D}
$$

Thus another advantage of taking the output differentially is an increase in gain by a factor of $2(6 \mathrm{~dB})$. It should be noted, however, that although differential outputs are preferred, a single-ended output is needed in some applications. We will have more to say about this later.

An alternative and useful way of viewing the operation of the differential pair in response to a differential input signal $v_{i d}$ is illustrated in Fig. 9.9. Here we are making use of the fact that the resistance between gate and source of a MOSFET, looking into the source, is $1 / g_{m}$. As a result, between $G_{1}$ and $G_{2}$ we have a total resistance, in the source circuit, of $2 / g_{m}$. It follows that we can obtain the current $i_{d}$ simply by dividing $v_{i d}$ by $2 / g_{m}$, as indicated in the figure.

The Differential Half-Circuit When a symmetrical differential amplifier is fed with a differential signal in a balanced manner, as in the case in Fig. 9.8, the performance can be determined by considering only half the circuit. The equivalent differential half-circuit is shown in Fig. 9.10. It has a grounded source, a result of the virtual ground that appears on the common sources' terminal of the MOSFETs in the differential pair. Note that $Q_{1}$ is operating at a drain bias current of $(I / 2)$ and an overdrive voltage $V_{O V}$.


Figure 9.9 An alternative view of the small-signal differential operation of the MOS differential pair: (a) analysis done directly on the circuit; (b) analysis using equivalent-circuit models.


Figure 9.10 The equivalent differential half-circuit of the differential amplifier of Fig. 9.8. Here $Q_{1}$ is biased at $I / 2$ and is operating at $V_{O V}$. This circuit can be used to determine the differential voltage gain of the differential amplifier $A_{d}=$ $v_{o d} / v_{i d}$.

The differential gain $A_{d}$ can be determined directly from the half-circuit. For instance, if we wish to take $r_{o}$ of $Q_{1}$ and $Q_{2}$ into account, we can use the half-circuit with the following result:

$$
A_{d}=g_{m}\left(R_{D} \| r_{o}\right)
$$

More significantly, the frequency response of the differential gain can be determined by analyzing the half-circuit, as we shall do in Chapter 10.

# Example 9.2 

Give the differential half-circuit of the differential amplifier shown in Fig. 9.11(a). Assume that $Q_{1}$ and $Q_{2}$ are perfectly matched. Neglecting $r_{o}$, determine the differential voltage gain $A_{d} \equiv v_{o d} / v_{i d}$.


Figure 9.11 (a) Differential amplifier for Example 9.2. (b) Differential half-circuit.
# Solution 

Since the circuit is symmetrical and is fed with $v_{i d}$ in a balanced manner, the differential half-circuit will be as shown in Fig. 9.11(b). Observe that because the line of symmetry passes through the middle of $R_{L}$, the half-circuit has a resistance $R_{L} / 2$ connected between drain and ground. Also note that the virtual ground appears on the node between the two resistances $R_{s}$. As a result, the half-circuit has a source-degeneration resistance $R_{s}$.

Now, neglecting $r_{o}$ of the half-circuit transistor $Q_{1}$, we can obtain the gain as the ratio of the total resistance in the drain to the total resistance in the source as

$$
\frac{-v_{o d} / 2}{v_{i d} / 2}=-\frac{R_{D} \|\left(R_{L} / 2\right)}{1 / g_{m}+R_{s}}
$$

with the result that

$$
A_{d} \equiv \frac{v_{o d}}{v_{i d}}=\frac{R_{D} \|\left(R_{L} / 2\right)}{1 / g_{m}+R_{s}}
$$

## EXERCISE

9.4 A MOS differential amplifier is operated at a total current of 0.8 mA , using transistors with a $W / L$ ratio of $100, \mu_{a} C_{o s}=0.2 \mathrm{~mA} / \mathrm{V}^{2}, V_{h}=20 \mathrm{~V}$, and $R_{D}=5 \mathrm{k} \Omega$. Find $V_{O V}, g_{m}, r_{o}$, and $A_{d}$. Ans. $0.2 \mathrm{~V} ; 4 \mathrm{~mA} / \mathrm{V} ; 50 \mathrm{k} \Omega ; 18.2 \mathrm{~V} / \mathrm{V}$

### 9.1.5 The Differential Amplifier with Current-Source Loads

To obtain higher gain, the passive resistances $R_{D}$ can be replaced with current sources, as shown in Fig. 9.12(a). Here the current sources are realized with PMOS transistors $Q_{3}$ and $Q_{4}$, and $V_{G}$ is a dc bias voltage that ensures that $Q_{3}$ and $Q_{4}$ each conducts a current equal to $I / 2$. The differential voltage gain $A_{d}$ can be found from the differential half-circuit shown in Fig. 9.12(b) as

$$
A_{d} \equiv \frac{v_{o d}}{v_{i d}}=g_{m 1}\left(r_{o 1} \| r_{o 3}\right)
$$

## EXERCISE

9.5 The differential amplifier of Fig. 9.12(a) is fabricated in a $0.18-\mu \mathrm{m}$ CMOS technology for which $\mu_{a} C_{o s}=4 \mu_{a} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2},\left|V_{s}\right|=0.5 \mathrm{~V}$, and $\left|V_{h}^{\prime}\right|=10 \mathrm{~V} / \mu \mathrm{m}$. If the bias current $I=200 \mu \mathrm{~A}$ and all transistors have a channel length twice the minimum and are operating at $\left|V_{O V}\right|=0.2 \mathrm{~V}$, find $W / L$ for each of $Q_{1}, Q_{2}, Q_{3}$, and $Q_{4}$, and determine the differential voltage gain $A_{d}$.
Ans. $(W / L)_{1,2}=12.5 ;(W / L)_{3,4}=50 ; A_{d}=18 \mathrm{~V} / \mathrm{V}$

Figure 9.12 (a) Differential amplifier with current-source loads formed by $Q_{3}$ and $Q_{4}$. (b) Differential half-circuit of the amplifier in (a).

## THE LONG-TAILED PAIR:

This idea using vacuum tubes was first documented by B. C. P. Matthews in 1934 in the Proceedings of the Physical Society, and was further developed by others in the late 1930s. The topology is simply that of a differential pair, where the term "long-tailed" refers to the biasing current source, which originally used a large-valued (hence long) resistor. Interestingly enough, the first application in measuring biological potentials in an electrically noisy environment continues to be an important one in modern medical instruments that utilize MOS devices.

### 9.1.6 Cascode Differential Amplifier

The gain of the differential amplifier can be increased by utilizing the cascode configuration studied in Section 8.5. Figure 9.13(a) shows a CMOS differential amplifier with cascoding applied to the amplifying transistors $Q_{1}$ and $Q_{2}$ via transistors $Q_{3}$ and $Q_{4}$, and to the current-source transistors $Q_{5}$ and $Q_{8}$ via transistors $Q_{5}$ and $Q_{6}$. The differential voltage gain can be found from the differential half-circuit shown in Fig. 9.13(b) as

$$
A_{d} \equiv \frac{v_{o d}}{v_{i d}}=g_{m 1}\left(R_{o n} \| R_{o p}\right)
$$


Figure 9.13 (a) Cascode differential amplifier; and (b) its differential half-circuit.
where

$$
R_{o u}=\left(g_{m 3} r_{o 3}\right) r_{o 1}
$$

and,

$$
R_{o p}=\left(g_{m 5} r_{o 5}\right) r_{o 7}
$$

# EXERCISE 

9.6 The CMOS cascode differential amplifier of Fig. 9.13(a) is fabricated in a $0.18-\mu \mathrm{m}$ technology for which $\mu_{a} C_{o s}=4 \mu_{p} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2},\left|V_{i}\right|=0.5 \mathrm{~V}$, and $\left|V_{A}^{\prime}\right|=10 \mathrm{~V} / \mu \mathrm{m}$. If the bias current $I=200 \mu \mathrm{~A}$, and all transistors have a channel length twice the minimum and are operating at $\left|V_{O V}\right|=0.2 \mathrm{~V}$, find $W / L$ for each of $Q_{1}$ to $Q_{8}$, and determine the differential voltage gain $A_{d}$.
Ans. $(W / L)_{1,2,3,4}=12.5 ;(W / L)_{3,6,7,8}=50 ; A_{d}=648 \mathrm{~V} / \mathrm{V}$


Figure 9.14 The basic BJT differential-pair configuration.

# 9.2 The BJT Differential Pair 

Figure 9.14 shows the basic BJT differential-pair configuration. It is very similar to the MOSFET circuit and consists of two matched transistors, $Q_{1}$ and $Q_{2}$, whose emitters are joined together and biased by a constant-current source $I$. The latter is usually implemented by a transistor circuit of the type studied in Sections 8.2 and 8.6. Although each collector is shown connected to the positive supply voltage $V_{C C}$ through a resistance $R_{C}$, this connection is not essential to the operation of the differential pair-that is, in some applications the two collectors may be connected to current sources rather than resistive loads. It is essential, though, that the collector circuits be such that $Q_{1}$ and $Q_{2}$ never enter saturation.

### 9.2.1 Basic Operation

To see how the BJT differential pair works, consider first the case of a common-mode voltage $V_{C M}$ applied to the two input terminals. That is, as shown in Fig. 9.15(a), $v_{B 1}=v_{B 2}=V_{C M}$. Since $Q_{1}$ and $Q_{2}$ are matched, and assuming an ideal bias current source $I$ with infinite output resistance, it follows that the current $I$ will remain constant and, from symmetry, that $I$ will divide equally between the two devices. Thus $i_{E 1}=i_{E 2}=I / 2$, and the voltage at the emitters will be $V_{C M}-V_{B E}$, where $V_{B E}$ is the base-emitter voltage [assumed in Fig 9.15(a) to be approximately 0.7 V ] corresponding to an emitter current of $I / 2$. The voltage at each collector will be $V_{C C}-\frac{1}{2} \alpha I R_{C}$, and the difference in voltage between the two collectors will be zero.

Now let us vary the value of the common-mode input voltage $V_{C M}$. Obviously, as long as $Q_{1}$ and $Q_{2}$ remain in the active region, and the current source $I$ has sufficient voltage across it to operate properly, the current $I$ will still divide equally between $Q_{1}$ and $Q_{2}$, and the voltages at the collectors will not change. Thus the differential pair does not respond to (i.e., it rejects) changes in the common-mode input voltage.

As another experiment, let the voltage $v_{B 2}$ be set to a constant value, say, zero (by grounding $\mathrm{B}_{2}$ ), and let $v_{B 1}=+1 \mathrm{~V}$ [see Fig. 9.15(b)]. With a bit of reasoning it can be seen that $Q_{1}$ will be on and conducting all of the current $I$ and that $Q_{2}$ will be off. For $Q_{1}$ to be on (with


Figure 9.15 Different modes of operation of the BJT differential pair: (a) the differential pair with a common-mode input voltage $V_{C M}$; (b) the differential pair with a "large" differential input signal; (c) the differential pair with a large differential input signal of polarity opposite to that in (b); (d) the differential pair with a small differential input signal $v_{i}$. Note that we have assumed the bias current source $I$ to be ideal (i.e., it has an infinite output resistance) and thus $I$ remains constant with the change in the voltage across it.
$V_{B E 1}=0.7 \mathrm{~V}$ ), the emitter has to be at approximately +0.3 V , which keeps the EBJ of $Q_{2}$ reverse-biased. The collector voltages will be $v_{C 1}=V_{C C}-\alpha I R_{C}$ and $v_{C 2}=V_{C C}$.

Let us now change $v_{B 1}$ to -1 V [Fig. 9.15(c)]. Again with some reasoning it can be seen that $Q_{1}$ will turn off, and $Q_{2}$ will carry all the current $I$. The common emitter will be at -0.7 V ,
which means that the EBJ of $Q_{1}$ will be reverse biased by 0.3 V . The collector voltages will be $v_{C 1}=V_{C C}$ and $v_{C 2}=V_{C C}-\alpha I R_{C}$.

From the foregoing, we see that the differential pair certainly responds to difference-mode (or differential) signals. In fact, with relatively small difference voltages we are able to steer the entire bias current from one side of the pair to the other. This current-steering property of the differential pair allows it to be used in logic circuits, as will be demonstrated in Chapter 15.

To use the BJT differential pair as a linear amplifier, we apply a very small differential signal (a few millivolts), which will result in one of the transistors conducting a current of $I / 2+\Delta I$; the current in the other transistor will be $I / 2-\Delta I$, with $\Delta I$ being proportional to the difference input voltage (see Fig. 9.15(d)). The output voltage taken between the two collectors will be $2 \alpha \Delta I R_{C}$, which is proportional to the differential input signal $v_{i}$. The small-signal operation of the differential pair will be studied shortly.

# EXERCISE 

9.7 Find $v_{E}, v_{C 1}$, and $v_{C 2}$ in the circuit of Fig. E9.7. Assume that $\left|v_{B E}\right|$ of a conducting transistor is approximately 0.7 V and that $\alpha \simeq 1$.


Figure E9.7

Ans. $+0.7 \mathrm{~V} ;-5 \mathrm{~V} ;-0.7 \mathrm{~V}$

### 9.2.2 Input Common-Mode Range

Refer to the circuit in Fig. 9.15(a). The allowable range of $V_{C M}$ is determined at the upper end by $Q_{1}$ and $Q_{2}$ leaving the active mode and entering saturation. Thus

$$
V_{C M \max } \simeq V_{C}+0.4=V_{C C}-\alpha \frac{I}{2} R_{C}+0.4
$$
The lower end of the $V_{C M}$ range is determined by the need to provide a certain minimum voltage $V_{C S}$ across the current source $I$ to ensure its proper operation. Thus,

$$
V_{C M \min }=-V_{E E}+V_{C S}+V_{B E}
$$

# EXERCISE 

9.8 Determine the input common-mode range for a bipolar differential amplifier operating from $\pm 2.5-\mathrm{V}$ power supplies and biased with a simple current source that delivers a constant current of 0.4 mA and requires a minimum of 0.3 V for its proper operation. The collector resistances $R_{C}=5 \mathrm{k} \Omega$.
Ans. -1.5 V to +1.9 V

### 9.2.3 Large-Signal Operation

We now present a general analysis of the BJT differential pair of Fig. 9.14. If we denote the voltage at the common emitter by $v_{E}$ and neglect the Early effect, the exponential relationship applied to each of the two transistors may be written

$$
\begin{aligned}
& i_{E 1}=\frac{I_{S}}{\alpha} e^{\left(v_{B 1}-v_{E}\right) / V_{T}} \\
& i_{E 2}=\frac{I_{S}}{\alpha} e^{\left(v_{B 2}-v_{E}\right) / V_{T}}
\end{aligned}
$$

These two equations can be combined to obtain

$$
\frac{i_{E 1}}{i_{E 2}}=e^{\left(v_{B 1}-v_{B 2}\right) / V_{T}}
$$

which can be manipulated to yield

$$
\begin{aligned}
\frac{i_{E 1}}{i_{E 1}+i_{E 2}} & =\frac{1}{1+e^{\left(v_{B 2}-v_{B 1}\right) / V_{T}}} \\
\frac{i_{E 2}}{i_{E 1}+i_{E 2}} & =\frac{1}{1+e^{\left(v_{B 1}-v_{B 2}\right) / V_{T}}}
\end{aligned}
$$

The circuit imposes the additional constraint

$$
i_{E 1}+i_{E 2}=I
$$

Using Eq. (9.47) together with Eqs. (9.45) and (9.46) and substituting $v_{B 1}-v_{B 2}=v_{i d}$ gives

$$
\begin{aligned}
& i_{E 1}=\frac{I}{1+e^{-v_{i d} / V_{T}}} \\
& i_{E 2}=\frac{I}{1+e^{v_{i d} / V_{T}}}
\end{aligned}
$$
The collector currents $i_{C 1}$ and $i_{C 2}$ can be obtained simply by multiplying the emitter currents in Eqs. (9.48) and (9.49) by $\alpha$, which is normally very close to unity.

The fundamental operation of the differential amplifier is illustrated by Eqs. (9.48) and (9.49). First, note that the amplifier responds only to the difference voltage $v_{i d}$. That is, if $v_{B 1}=v_{B 2}=V_{C M}$, the current $I$ divides equally between the two transistors irrespective of the value of the common-mode voltage $V_{C M}$. This is the essence of differential-amplifier operation, which also gives rise to its name.

Another important observation is that a relatively small difference voltage $v_{i d}$ will cause the current $I$ to flow almost entirely in one of the two transistors. Figure 9.16 shows a plot of the two collector currents (assuming $\alpha \simeq 1$ ) as a function of the differential input signal. This is a normalized plot that can be used universally. Observe that a difference voltage of about $4 V_{T}(\simeq 100 \mathrm{mV})$ is sufficient to switch the current almost entirely to one side of the BJT pair. Note that this is much smaller than the corresponding voltage for the MOS pair, $\sqrt{2} V_{O V}$. The fact that such a small signal can switch the current from one side of the BJT differential pair to the other means that the BJT differential pair can be used as a fast current switch (Chapter 15).

The nonlinear transfer characteristics of the differential pair, shown in Fig. 9.16, will not be utilized any further in this chapter. Rather, in the following we shall be interested specifically in the application of the differential pair as a small-signal amplifier. For this purpose, the difference input signal is limited to less than about $V_{T} / 2$ in order that we may operate on a linear segment of the characteristics around the midpoint $x$ (in Fig. 9.16).

Before leaving the large-signal operation of the differential BJT pair, we wish to point out an effective technique frequently employed to extend the linear range of operation. It consists of including two equal resistances $R_{e}$ in series with the emitters of $Q_{1}$ and $Q_{2}$, as


Figure 9.16 Transfer characteristics of the BJT differential pair of Fig. 9.14 assuming $\alpha \simeq 1$.


Figure 9.17 The transfer characteristics of the BJT differential pair (a) can be linearized (b) (i.e., the linear range of operation can be extended) by including resistances in the emitters.
shown in Fig. 9.17(a). The resulting transfer characteristics for three different values of $R_{e}$ are sketched in Fig. 9.17(b). Observe that expansion of the linear range is obtained at the expense of reduced $G_{i n}$ (which is the slope of the transfer curve at $v_{i d}=0$ ) and hence reduced gain. This result should come as no surprise; $R_{e}$ here is performing in exactly the same way as the emitter resistance $R_{e}$ does in the CE amplifier with emitter degeneration (see Section 7.3.4). Finally, we also note that this linearization technique is in effect the bipolar counterpart of the technique employed for the MOS differential pair (Fig. 9.7). In the latter case, however, $V_{O V}$ was varied by changing the transistors' $W / L$ ratio, a design tool with no counterpart in the BJT.
# EXERCISE 

9.9 For the BJT differential pair of Fig. 9.14, find the value of input differential signal that is sufficient to cause $i_{E 1}=0.99 I$.
Ans. 115 mV

### 9.2.4 Small-Signal Operation

In this section we study the application of the BJT differential pair in small-signal amplification. Figure 9.18 shows the BJT differential pair with a difference voltage signal $v_{i d}$ applied between the two bases. Implied is that the dc level at the input-that is, the common-mode input voltage-has been somehow established. For instance, one of the two input terminals can be grounded and $v_{i d}$ applied to the other input terminal. Alternatively, the differential amplifier may be fed from the output of another differential amplifier. In the latter case, the voltage at one of the input terminals will be $V_{C M}+v_{i d} / 2$ while that at the other input terminal will be $V_{C M}-v_{i d} / 2$.

The Collector Currents When $v_{i d}$ Is Applied For the circuit of Fig. 9.18, we may use Eqs. (9.48) and (9.49) to write

$$
\begin{aligned}
& i_{C 1}=\frac{\alpha I}{1+e^{-v_{i d} / V_{T}}} \\
& i_{C 2}=\frac{\alpha I}{1+e^{v_{i d} / V_{T}}}
\end{aligned}
$$



Figure 9.18 The currents and voltages in the differential amplifier when a small differential input signal $v_{i d}$ is applied.
Multiplying the numerator and the denominator of the right-hand side of Eq. (9.50) by $e^{v_{i d} / 2 V_{T}}$ gives

$$
i_{C 1}=\frac{\alpha I e^{v_{i d} / 2 V_{T}}}{e^{v_{i d} / 2 V_{T}}+e^{-v_{i d} / 2 V_{T}}}
$$

Assume that $v_{i d} \ll 2 V_{T}$. We may thus expand the exponential $e^{3 v_{i d} / 2 V_{T}}$ in a series and retain only the first two terms:

$$
i_{C 1} \simeq \frac{\alpha I\left(1+v_{i d} / 2 V_{T}\right)}{1+v_{i d} / 2 V_{T}+1-v_{i d} / 2 V_{T}}
$$

Thus

$$
i_{C 1}=\frac{\alpha I}{2}+\frac{\alpha I}{2 V_{T}} \frac{v_{i d}}{2}
$$

Similar manipulations can be applied to Eq. (9.51) to obtain

$$
i_{C 2}=\frac{\alpha I}{2}-\frac{\alpha I}{2 V_{T}} \frac{v_{i d}}{2}
$$

Equations (9.52) and (9.53) tell us that when $v_{i d}=0$, the bias current $I$ divides equally between the two transistors of the pair. Thus each transistor is biased at an emitter current of $I / 2$. When a "small-signal" $v_{i d}$ is applied differentially (i.e., between the two bases), the collector current of $Q_{1}$ increases by an increment $i_{c}$ and that of $Q_{2}$ decreases by an equal amount. This ensures that the sum of the total currents in $Q_{1}$ and $Q_{2}$ remains constant, as constrained by the current-source bias. The incremental (or signal) current component $i_{c}$ is given by

$$
i_{c}=\frac{\alpha I}{2 V_{T}} \frac{v_{i d}}{2}
$$

Equation (9.54) has an easy interpretation. First, note from the symmetry of the circuit (Fig. 9.18) that the differential signal $v_{i d}$ should divide equally between the base-emitter junctions of the two transistors. Thus the total base-emitter voltages will be

$$
\begin{aligned}
& \left.v_{B E}\right|_{Q 1}=V_{B E}+\frac{v_{i d}}{2} \\
& \left.v_{B E}\right|_{Q 2}=V_{B E}-\frac{v_{i d}}{2}
\end{aligned}
$$

where $V_{B E}$ is the dc BE voltage corresponding to an emitter current of $I / 2$. Therefore, the collector current of $Q_{1}$ will increase by $g_{m} v_{i d} / 2$ and the collector current of $Q_{2}$ will decrease by $g_{m} v_{i d} / 2$. Here $g_{m}$ denotes the transconductance of $Q_{1}$ and of $Q_{2}$, which are equal and given by

$$
g_{m}=\frac{I_{C}}{V_{T}}=\frac{\alpha I / 2}{V_{T}}
$$

Thus Eq. (9.54) simply states that $i_{c}=g_{m} v_{i d} / 2$.
An Alternative Viewpoint There is an extremely useful alternative interpretation of the results above. Assume the current source $I$ to be ideal. Its incremental resistance then will be infinite. Thus the voltage $v_{i d}$ appears across a total resistance of $2 r_{e}$, where

$$
r_{e}=\frac{V_{T}}{I_{E}}=\frac{V_{T}}{I / 2}
$$

Figure 9.19 A simple technique for determining the signal currents in a differential amplifier excited by a differential voltage signal $v_{i d}$; dc quantities are not shown. While Fig. 9.19(a) utilizes the BJT T model implicitly, the T model of both BJTs are shown explicitly in Fig. 9.19(b).

Correspondingly there will be a signal current $i_{e}$, as illustrated in Fig. 9.19, given by

$$
i_{e}=\frac{v_{i d}}{2 r_{e}}
$$

Thus the collector of $Q_{1}$ will exhibit a current increment $i_{c}$ and the collector of $Q_{2}$ will exhibit a current decrement $i_{c}$ :

$$
i_{c}=\alpha i_{e}=\frac{\alpha v_{i d}}{2 r_{e}}=g_{m} \frac{v_{i d}}{2}
$$

Note that in Fig. 9.19(a) we have shown signal quantities only. It is implied, of course, that each transistor is biased at an emitter current of $I / 2$. For greater emphasis, we show in Fig. 9.20(b) the equivalent circuit obtained by replacing each BJT with its T model.

This method of analysis is particularly useful when resistances are included in the emitters, as shown in Fig. 9.20. For this circuit we have

$$
i_{e}=\frac{v_{i d}}{2 r_{e}+2 R_{e}}
$$

Input Differential Resistance Unlike the MOS differential amplifier, which has an infinite input resistance, the bipolar differential pair exhibits a finite input resistance, a result of the finite $\beta$ of the BJT.

The input differential resistance is the resistance seen between the two bases; that is, it is the resistance seen by the differential input signal $v_{i d}$. For the differential amplifier in Figs. 9.18 and 9.19 it can be seen that the base current of $Q_{1}$ shows an increment $i_{b}$ and the base current of $Q_{2}$ shows an equal decrement,

$$
i_{b}=\frac{i_{e}}{\beta+1}=\frac{v_{i d} / 2 r_{e}}{\beta+1}
$$


Figure 9.20 A differential amplifier with emitter resistances. Only signal quantities are shown (in color).

Thus the differential input resistance $R_{i d}$ is given by

$$
R_{i d} \equiv \frac{v_{i d}}{i_{b}}=(\beta+1) 2 r_{e}=2 r_{\alpha}
$$

This result is just a restatement of the familiar resistance-reflection rule: namely, the resistance seen between the two bases is equal to the total resistance in the emitter circuit multiplied by $(\beta+1)$. We can employ this rule to find the input differential resistance for the circuit in Fig. 9.20 as

$$
R_{i d}=(\beta+1)\left(2 r_{e}+2 R_{e}\right)
$$

Differential Voltage Gain We have established that for small difference input voltages ( $v_{i d} \ll 2 V_{T}$; i.e., $v_{i d}$ smaller than about 20 mV ), the collector currents are given by

$$
\begin{aligned}
& i_{C 1}=I_{C}+g_{m} \frac{v_{i d}}{2} \\
& i_{C 2}=I_{C}-g_{m} \frac{v_{i d}}{2}
\end{aligned}
$$

where

$$
I_{C}=\frac{\alpha I}{2}
$$

Thus the total voltages at the collectors will be

$$
\begin{aligned}
& v_{C 1}=\left(V_{C C}-I_{C} R_{C}\right)-g_{m} R_{C} \frac{v_{i d}}{2} \\
& v_{C 2}=\left(V_{C C}-I_{C} R_{C}\right)+g_{m} R_{C} \frac{v_{i d}}{2}
\end{aligned}
$$

The quantities in parentheses are simply the dc voltages at each of the two collectors.
As in the MOS case, the output voltage signal of a bipolar differential amplifier can be taken differentially (i.e., between the two collectors, $v_{o d}=v_{c 2}-v_{c 1}$ ). The differential gain of the differential amplifier will be

$$
A_{d}=\frac{v_{o d}}{v_{i d}}=g_{m} R_{C}
$$

For the differential amplifier with resistances in the emitter leads (Fig. 9.20), the differential gain is given by

$$
A_{d}=\frac{\alpha\left(2 R_{C}\right)}{2 r_{e}+2 R_{e}} \simeq \frac{R_{C}}{r_{e}+R_{e}}
$$

This equation is a familiar one: It states that the voltage gain is equal to the ratio of the total resistance in the collector circuit $\left(2 R_{C}\right)$ to the total resistance in the emitter circuit $\left(2 r_{e}+2 R_{e}\right)$.

The Differential Half-Circuit As in the MOS case, the differential gain of the BJT differential amplifier can be obtained by considering its differential half-circuit. Figure 9.21(a) shows a differential amplifier fed by a differential signal $v_{i d}$ that is applied in a complementary (push-pull or balanced) manner. That is, while the base of $Q_{1}$ is raised by $v_{i d} / 2$, the base of $Q_{2}$ is lowered by $v_{i d} / 2$. We have also included the output resistance $R_{E E}$ of the bias current source. From symmetry, it follows that the signal voltage at the emitters will be zero. Thus the circuit is equivalent to the two common-emitter amplifiers shown in Fig. 9.21(b), where each of the two transistors is biased at an emitter current of $I / 2$. Note that the finite output resistance $R_{E E}$ of the current source will have no effect on the operation. The equivalent circuit in Fig. 9.21(b) is valid for differential operation only.

In many applications the differential amplifier is not fed in a complementary fashion; rather, the input signal may be applied to one of the input terminals while the other terminal is


Figure 9.21 Equivalence of the BJT differential amplifier in (a) to the two common-emitter amplifiers in (b). This equivalence applies only for differential input signals. Either of the two common-emitter amplifiers in (b) can be used to find the differential gain, differential input resistance, frequency response, and so on, of the differential amplifier.


Figure 9.22 The differential amplifier fed in a single-ended fashion.
grounded, as shown in Fig. 9.22. In this case the signal voltage at the emitters will not be zero, and thus the resistance $R_{E E}$ will have an effect on the operation. Nevertheless, if $R_{E E}$ is large $\left(R_{E E} \gg r_{e}\right)$, as is usually the case, ${ }^{1}$ then $v_{i d}$ will still divide equally (approximately) between the two junctions, as shown in Fig. 9.22. Thus the operation of the differential amplifier in this case will be almost identical to that in the case of symmetric feed, and the common-emitter equivalence can still be employed.

Since in Fig. 9.21, $v_{o 2}=-v_{o 1}=v_{o d} / 2$, the two common-emitter transistors in Fig. 9.21(b) yield similar results about the performance of the differential amplifier. Thus only one is needed to analyze the differential small-signal operation of the differential amplifier, and it is known as the differential half-circuit. If we take the common-emitter transistor fed with $+v_{i d} / 2$ as the differential half-circuit and replace the transistor with its low-frequency, hybrid- $\pi$, equivalent-circuit model, the circuit in Fig. 9.23 results. In evaluating the model parameters $r_{\pi}, g_{m}$, and $r_{o}$, we must recall that the half-circuit is biased at $I / 2$. The voltage gain of the differential amplifier is equal to the voltage gain of the half-circuit-that is, $v_{o 1} /\left(v_{i d} / 2\right)$. Here, we note that including $r_{o}$ will modify the gain expression in Eq. (9.68) to

$$
A_{d}=g_{m}\left(R_{C} \| r_{o}\right)
$$

The input differential resistance of the differential amplifier is twice that of the half-circuit-that is, $2 r_{\pi}$. Finally, we note that the differential half-circuit of the amplifier of Fig. 9.20 is a common-emitter transistor with a resistance $R_{c}$ in the emitter lead.


Figure 9.23 Equivalent-circuit model of the differential half-circuit formed by $Q_{1}$ in Fig. 9.22(b).

[^0]
[^0]:    ${ }^{1}$ Note that $R_{E E}$ appears in parallel with the much smaller $r_{e}$ of $Q_{2}$.
# Example 9.3 

The differential amplifier in Fig. 9.24 uses transistors with $\beta=100$. Evaluate the following:
(a) The input differential resistance $R_{i d}$.
(b) The overall differential voltage gain $v_{o d} / v_{s i g}$ (neglect the effect of $r_{o}$ ).


Figure 9.24 Circuit for Example 9.3.

## Solution

(a) Each transistor is biased at an emitter current of 0.5 mA . Thus

$$
r_{e 1}=r_{e 2}=\frac{V_{g}}{I_{E}}=\frac{25 \mathrm{mV}}{0.5 \mathrm{~mA}}=50 \Omega
$$

The input differential resistance can now be found as

$$
\begin{aligned}
R_{i d} & =2(\beta+1)\left(r_{e}+R_{E}\right) \\
& =2 \times 101 \times(50+150) \simeq 40 \mathrm{k} \Omega
\end{aligned}
$$
(b) The voltage gain from the signal source to the bases of $Q_{1}$ and $Q_{2}$ is

$$
\begin{aligned}
\frac{v_{s d}}{v_{\text {sig }}} & =\frac{R_{s d}}{R_{\text {sig }}+R_{s d}} \\
& =\frac{40}{5+5+40}=0.8 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

The voltage gain from the bases to the output is

$$
\begin{aligned}
\frac{v_{o d}}{v_{s d}} & \simeq \frac{\text { Total resistance in the collectors }}{\text { Total resistance in the emitters }} \\
& =\frac{2 R_{C}}{2\left(r_{e}+R_{E}\right)}=\frac{2 \times 10}{2(50+150) \times 10^{-3}}=50 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

The overall differential voltage gain can now be found as

$$
A_{d}=\frac{v_{o d}}{v_{\text {sig }}}=\frac{v_{t d}}{v_{\text {sig }}} \frac{v_{o d}}{v_{t d}}=0.8 \times 50=40 \mathrm{~V} / \mathrm{V}
$$

# EXERCISE 

9.10 For the circuit in Fig. 9.18, let $I=1 \mathrm{~mA}, V_{C C}=15 \mathrm{~V}, R_{C}=10 \mathrm{k} \Omega$, with $\alpha=1$, and let the input voltages be $v_{B 1}=5+0.005 \sin 2 \pi \times 1000 t$, volts, and $v_{B 2}=5-0.005 \sin 2 \pi \times 1000 t$, volts. (a) If the BJTs are specified to have $v_{B E}$ of 0.7 V at a collector current of 1 mA , find the voltage at the emitters. (b) Find $g_{m}$ for each of the two transistors. (c) Find $i_{C}$ for each of the two transistors. (d) Find $v_{C}$ for each of the two transistors. (e) Find the voltage between the two collectors. (f) Find the gain experienced by the $1000-\mathrm{Hz}$ signal.
Ans. (a) 4.317 V ; (b) $20 \mathrm{~mA} / \mathrm{V}$; (c) $i_{C 1}=0.5+0.1 \sin 2 \pi \times 1000 t$, mA and $i_{C 2}=0.5-0.1 \sin 2 \pi \times$ $1000 t, \mathrm{~mA}$; (d) $v_{C 1}=10-1 \sin 2 \pi \times 1000 t$, V and $v_{C 2}=10+1 \sin 2 \pi \times 1000 t$, V; (e) $v_{C 2}-v_{C 1}=$ $2 \sin 2 \pi \times 1000 t, \mathrm{~V}$; (f) $200 \mathrm{~V} / \mathrm{V}$

### 9.3 Common-Mode Rejection

Thus far, we have seen that the differential amplifier responds to a differential input signal and completely rejects a common-mode signal. This latter point was made very clearly at the outset of our discussion of differential amplifiers and was illustrated in Example 9.1, where we saw that changes in $V_{C M}$ over a wide range resulted in no change in the voltage at either of the two drains. The same phenomenon was demonstrated for the BJT differential amplifier in Section 9.2.1. This highly desirable result is, however, a consequence of our assumption that the current source that supplies the bias current $I$ is ideal. As we shall now show, if we
consider the more realistic situation of the current source having a finite output resistance, the common-mode gain will no longer be zero.

# 9.3.1 The MOS Case 

Figure 9.25(a) shows a MOS differential amplifier biased with a current source having an output resistance $R_{S S}$. As before, the dc voltage at the input is defined by $V_{C M}$. Here, however, we also have an incremental signal $v_{i c m}$ applied to both input terminals. This common-mode input signal can represent an interference signal or noise that is picked up by both inputs and is clearly undesirable. Our objective now is to find how much of $v_{i c m}$ makes its way to the output of the amplifier.

Before we determine the common-mode gain of the amplifier, we wish to address the question of the effect of $R_{S S}$ on the bias current of $Q_{1}$ and $Q_{2}$. That is, with $v_{i c m}$ set to zero, the bias current in each of $Q_{1}$ and $Q_{2}$ will no longer be $I / 2$ but will be larger than $I / 2$ by an amount determined by $V_{C M}$ and $R_{S S}$. However, since $R_{S S}$ is usually very large, this additional dc current in each of $Q_{1}$ and $Q_{2}$ is usually small and we shall neglect it, thus assuming that $Q_{1}$ and $Q_{2}$ continue to operate at a bias current of $I / 2$. The reader might also be wondering about the effect of $R_{S S}$ on the differential gain. The answer here is very simple: The virtual ground that develops on the common-source terminal when a differential input signal is applied results in a zero signal current through $R_{S S}$; hence $R_{S S}$ has no effect on the value of $A_{d}$.

To determine the response of the differential amplifier to the common-mode input signal $v_{i c m}$, consider the circuit in Fig. 9.25(b), where we have replaced each of $V_{D D}$ and $V_{S S}$ by a short circuit and $I$ by an open circuit. The circuit is obviously symmetrical, and thus the two transistors will carry equal signal currents, denoted $i$. The value of $i$ can be easily determined by replacing each of $Q_{1}$ and $Q_{2}$ with its T model and, for simplicity, neglecting $r_{o}$. The resulting equivalent circuit is shown in Fig. 9.25(c), from which we can write

$$
v_{i c m}=\frac{i}{g_{m}}+2 i R_{S S}
$$

Thus,

$$
i=\frac{v_{i c m}}{1 / g_{m}+2 R_{S S}}
$$

The voltages at the drain of $Q_{1}$ and $Q_{2}$ can now be found as

$$
v_{o 1}=v_{o 2}=-R_{D} i
$$

resulting in

$$
v_{o 1}=v_{o 2}=-\frac{R_{D}}{1 / g_{m}+2 R_{S S}} v_{i c m}
$$

It follows that both $v_{o 1}$ and $v_{o 2}$ will be corrupted by the common-mode signal $v_{i c m}$ and will be given approximately by

$$
\frac{v_{o 1}}{v_{i c m}}=\frac{v_{o 2}}{v_{i c m}} \simeq-\frac{R_{D}}{2 R_{S S}}
$$

where we have assumed that $2 R_{S S} \gg 1 / g_{m}$. Nevertheless, because $v_{o 1}=v_{o 2}$, the differential output voltage $v_{o d}$ will remain free of common-mode interference:

$$
v_{o d}=v_{o 2}-v_{o 1}=0
$$


Figure 9.25 (a) A MOS differential amplifier with a common-mode input signal $v_{i c m}$ superimposed on the input dc common-mode voltage $V_{C M}$. (b) The amplifier circuit prepared for small-signal analysis. (c) The amplifier circuit with the transistors replaced with their T model and $r_{o}$ neglected. (d) The circuit in (b) split into its two halves; each half is said to be a "CM half-circuit."
Thus the circuit still rejects common-mode signals! Unfortunately, however, this will not be the case if the circuit is not perfectly symmetrical, as we shall now show.

Before proceeding further, it is useful to observe that all the above results can be obtained by considering only half the differential amplifier. Figure 9.25(d) shows the two half-circuits of the differential amplifier that apply for common-mode analysis. To see the equivalence, observe that each of the two half-circuits indeed carries a current $i$ given by Eq. (9.72) and the voltages at the source terminals are equal $\left(v_{s}=2 i R_{S S}\right)$. Thus the two sources can be joined, returning the circuit to the original form in Fig. 9.25(b). Each of the circuits in Fig. 9.25(d) is known as the common-mode half-circuit. Note the difference between the CM half-circuit and the differential half-circuit.

Effect of $R_{D}$ Mismatch When the two drain resistances exhibit a mismatch $\Delta R_{D}$, as they inevitably do, the common-mode voltages at the two drains will no longer be equal. Rather, if the load of $Q_{1}$ is $R_{D}$ and that of $Q_{2}$ is $\left(R_{D}+\Delta R_{D}\right)$ the drain signal voltages arising from $v_{i c m}$ will be

$$
v_{o 1} \simeq-\frac{R_{D}}{2 R_{S S}} v_{i c m}
$$

and

$$
v_{o 2} \simeq-\frac{R_{D}+\Delta R_{D}}{2 R_{S S}} v_{i c m}
$$

Thus,

$$
v_{o d}=v_{o 2}-v_{o 1}=-\frac{\Delta R_{D}}{2 R_{S S}} v_{i c m}
$$

and we can find the common-mode gain $A_{c m}$ as

$$
A_{c m} \equiv \frac{v_{o d}}{v_{i c m}}=-\frac{\Delta R_{D}}{2 R_{S S}}
$$

which can be expressed in the alternate form

$$
A_{c m}=-\left(\frac{R_{D}}{2 R_{S S}}\right)\left(\frac{\Delta R_{D}}{R_{D}}\right)
$$

It follows that a mismatch in the drain resistances causes the differential amplifier to have a finite common-mode gain. Thus, a portion of the interference or noise signal $v_{i c m}$ will appear as a component of $v_{o d}$. A measure of the effectiveness of the differential amplifier in amplifying differential-mode signals and rejecting common-mode interference is the ratio of the magnitude of its differential gain $\left|A_{d}\right|$ to the magnitude of its common-mode gain $\left|A_{c m}\right|$. This ratio is termed common-mode rejection ratio (CMRR). Thus,

$$
\operatorname{CMRR} \equiv \frac{\left|A_{d}\right|}{\left|A_{c m}\right|}
$$

and is usually expressed in decibels,

$$
\operatorname{CMRR}(\mathrm{dB})=20 \log \frac{\left|A_{d}\right|}{\left|A_{c m}\right|}
$$
For the case of a MOS differential amplifier with drain resistances $R_{D}$ that exhibit a mismatch $\Delta R_{D}$, the CMRR can be found as the ratio of $A_{d}$ in Eq. (9.35) to $A_{c m}$ in Eq. (9.79), thus

$$
\mathrm{CMRR}=\left(2 g_{m} R_{S S}\right) /\left(\frac{\Delta R_{D}}{R_{D}}\right)
$$

It follows that to obtain a high CMRR, we should utilize a bias current source with a high output resistance $R_{S S}$, and we should strive to obtain a high degree of matching between the drain resistances (i.e., keep $\Delta R_{D} / R_{D}$ small).

# EXERCISE 

9.11 A MOS differential pair operated at a bias current of 0.8 mA employs transistors with $W / L=100$ and $\mu_{n} C_{o s}=0.2 \mathrm{~mA} / \mathrm{V}^{2}$, using $R_{D}=5 \mathrm{k} \Omega$ and $R_{S S}=25 \mathrm{k} \Omega$. Find the differential gain, the common-mode gain when the drain resistances have a $1 \%$ mismatch, and the CMRR.
Ans. $20 \mathrm{~V} / \mathrm{V} ; 0.001 \mathrm{~V} / \mathrm{V} ; 86 \mathrm{~dB}$

Effect of $g_{m}$ Mismatch on CMRR Another possible mismatch between the two halves of the MOS differential pair is a mismatch in $g_{m}$ of the two transistors. For the purpose of finding the effect of a $g_{m}$ mismatch on CMRR, let

$$
\begin{aligned}
& g_{m 1}=g_{m}+\frac{1}{2} \Delta g_{m} \\
& g_{m 2}=g_{m}-\frac{1}{2} \Delta g_{m}
\end{aligned}
$$

That is,

$$
g_{m 1}-g_{m 2}=\Delta g_{m}
$$

Since the circuit is no longer symmetrical, we cannot employ the common-mode half-circuit. Rather, we need to return to the original circuit of Fig. 9.25(a) and replace each of $Q_{1}$ and $Q_{2}$ with its T equivalent-circuit model. We shall skip the analysis and simply present the result,

$$
A_{c m} \simeq\left(\frac{R_{D}}{2 R_{S S}}\right)\left(\frac{\Delta g_{m}}{g_{m}}\right)
$$

and the corresponding CMRR will be

$$
\mathrm{CMRR}=\left(2 g_{m} R_{S S}\right) /\left(\frac{\Delta g_{m}}{g_{m}}\right)
$$

Note that both expressions have exactly the same form as the corresponding expressions for the case of $R_{D}$ mismatch.

Thus, as in that case, to keep CMRR high, we have to use a biasing current source with a high output resistance $R_{S S}$ and, of course, strive to maintain a high degree of matching between $Q_{1}$ and $Q_{2}$.# EXERCISE 

9.12 For the MOS amplifier specified in Exercise 9.11, compute the CMRR resulting from a $1 \%$ mismatch in $g_{m}$.
Ans. 86 dB

## Example 9.4

In this example we consider the design of the current source that supplies the bias current of a MOS differential amplifier. Let it be required to achieve a CMRR of 100 dB and assume that the only source of mismatch between $Q_{1}$ and $Q_{2}$ is a $2 \%$ mismatch in their $W / L$ ratios. Let $I=200 \mu \mathrm{~A}$ and assume that all transistors are to be operated at $V_{O V}=0.2 \mathrm{~V}$. For the $0.18-\mu \mathrm{m}$ CMOS fabrication process available, $V_{A}^{\prime}=5 \mathrm{~V} / \mu \mathrm{m}$. If a simple current source is utilized for $I$, what channel length is required? If a cascode current source is utilized, what channel length is needed for the two transistors in the cascode?

## Solution

A mismatch in $W / L$ results in a $g_{m}$ mismatch that can be found from the expression of $g_{m}$ :

$$
g_{m}=\sqrt{2\left(\mu_{n} C_{o s}\right)\left(\frac{W}{L}\right) I_{D}}
$$

It can be seen that an error of $2 \%$ in $W / L$ will result in an error in $g_{m}$ of $1 \%$. That is, the $2 \%$ mismatch in the $W / L$ ratios of $Q_{1}$ and $Q_{2}$ will result in a $1 \%$ mismatch in their $g_{m}$ values. The resulting CMRR can be found from Eq. (9.88), repeated here:

$$
\mathrm{CMRR}=\left(2 g_{m} R_{S S}\right) /\left(\frac{\Delta g_{m}}{g_{m}}\right)
$$

Now, a 100-dB CMRR corresponds to a ratio of $10^{5}$; thus,

$$
10^{5}=\left(2 g_{m} R_{S S}\right) / 0.01
$$

The value of $g_{m}$ can be found from

$$
\begin{aligned}
g_{m} & =\frac{2 I_{D}}{V_{O V}}=\frac{2 \times(I / 2)}{V_{O V}} \\
& =\frac{2 \times 0.1}{0.2}=1 \mathrm{~mA} / \mathrm{V}
\end{aligned}
$$

Substituting in Eq. (9.90) gives

$$
R_{S S}=500 \mathrm{k} \Omega
$$

Now if the current source is implemented with a single transistor, its $r_{o}$ must be

$$
r_{o}=R_{S S}=500 \mathrm{k} \Omega
$$
Thus,

$$
\frac{V_{A}}{I}=500 \mathrm{k} \Omega
$$

Substituting $I=200 \mu \mathrm{~A}$, we find the required value of $V_{A}$ as

$$
V_{A}=100 \mathrm{~V}
$$

Since $V_{A}=V_{A}^{\prime} L=5 L$, the required value of $L$ will be

$$
L=20 \mu \mathrm{~m}
$$

which is very large!
Using a cascode current source, we have

$$
R_{S S}=\left(g_{m} r_{o}\right) r_{o}
$$

where

$$
g_{m}=\frac{2 I}{V_{O V}}=\frac{2 \times 0.2}{0.2}=2 \mathrm{~mA} / \mathrm{V}
$$

Thus,

$$
\begin{aligned}
500 & =2 \times r_{o}^{2} \\
r_{o} & =15.81 \mathrm{k} \Omega
\end{aligned}
$$

and the required $V_{A}$ now becomes

$$
\begin{aligned}
15.81 & =\frac{V_{A}}{I}=\frac{V_{A}}{0.2} \\
V_{A} & =3.16 \mathrm{~V}
\end{aligned}
$$

which implies a channel length for each of the two transistors in the cascode of

$$
L=\frac{3.16}{V_{A}^{\prime}}=\frac{3.16}{5}=0.63 \mu \mathrm{~m}
$$

a considerable reduction from the case of a simple current source, and indeed a practical value.

Differential versus Single-Ended Output The above study of common-mode rejection was predicated on the assumption that the output of the differential amplifier is taken differentially, that is, between the drains of $Q_{1}$ and $Q_{2}$. In some cases one might decide to take the output single-endedly; that is, between one of the drains and ground. If this is done, the CMRR is reduced dramatically. This can be seen from the above analysis, where the common-mode gain in the absence of mismatches is zero if the output is taken differentially and finite (Eq. 9.74) if the output is taken single-endedly. When mismatches are taken into account, the CM gain for the differential-output case departs from zero but remains much lower than the value obtained for single-ended output (Eq. 9.74).
We conclude that to obtain a large CMRR, the output of the differential amplifier must be taken differentially. The subject of converting the output signal from differential to single-ended without loss of CMRR will be studied in Section 9.5.

# EXERCISE 

9.13 Show that if the output of the MOS differential amplifier is taken single-endedly, the CMRR is given by:

$$
\mathrm{CMRR}=g_{m} R_{S S}
$$

### 9.3.2 The BJT Case

An exactly similar development applies for studying the common-mode rejection of the BJT differential amplifier. Figure 9.26 shows a bipolar differential amplifier with an input common-mode signal $v_{i c m}$. Here $R_{E E}$ is the output resistance of the bias current source $I$. We wish to find the voltages that result from $v_{i c m}$ at the collectors of $Q_{1}$ and $Q_{2}, v_{o 1}$ and $v_{o 2}$, and between the two collectors, $v_{o d}$. Toward that end, we make use of the common-mode half-circuits shown in Fig. 9.26(b). The signal $v_{o 1}$ that appears at the collector of $Q_{1}$ in response to $v_{i c m}$ will be

$$
v_{o 1}=-\frac{\alpha R_{C}}{r_{e}+2 R_{E E}} v_{i c m}
$$


(a)

(b)

Figure 9.26 (a) The differential amplifier fed by a common-mode input signal $v_{i c m}$. (b) Equivalent "half-circuits" for common-mode calculations.
Similarly, $v_{o 2}$ will be

$$
v_{o 2}=-\frac{\alpha R_{C}}{r_{e}+2 R_{E E}} v_{i c m}
$$

where we have neglected the transistor $r_{o}$, for simplicity. The differential output signal $v_{o d}$ can be obtained as

$$
v_{o d}=v_{o 2}-v_{o 1}=0
$$

Thus, while the voltages at the two collectors will contain common-mode noise or interference components, the output differential voltage will be free from such interference. This condition, however, is based on the assumption of perfect matching between the two sides of the differential amplifier. Any mismatch will result in $v_{o d}$ acquiring a component proportional to $v_{i c m}$. For example, a mismatch $\Delta R_{C}$ between the two collector resistances results in

$$
A_{c m} \equiv \frac{v_{o d}}{v_{i c m}}=-\frac{\alpha \Delta R_{C}}{2 R_{E E}+r_{e}}
$$

Since $\alpha \simeq 1, r_{e} \ll 2 R_{E E}$, Eq. (9.93) can be approximated and written in the form

$$
A_{c m} \simeq-\left(\frac{R_{C}}{2 R_{E E}}\right)\left(\frac{\Delta R_{C}}{R_{C}}\right)
$$

The common-mode rejection ratio can now be found from

$$
\mathrm{CMRR}=\frac{\left|A_{d}\right|}{\left|A_{c m}\right|}
$$

together with using Eqs. (9.68) and (9.94), with the result that

$$
\mathrm{CMRR}=\left(2 g_{m} R_{E E}\right) /\left(\frac{\Delta R_{C}}{R_{C}}\right)
$$

which is similar in form to the expression for the MOS pair [Eq. (9.83)]. Thus, to obtain a high CMRR, we design the current source to have a large output resistance $R_{E E}$ and strive for close matching of the collector resistances.

Common-Mode Input Resistance The definition of the common-mode input resistance $R_{i c m}$ is illustrated in Fig. 9.27(a). Figure 9.27(b) shows the equivalent common-mode half-circuit; its input resistance is $2 R_{i c m}$. The value of $2 R_{i c m}$ can be determined by analyzing the circuit of Fig. 9.27(b) while taking $r_{o}$ into account (because $R_{E E}$ and $R_{C}$ can be equal to, or larger than, $r_{o}$ ). The analysis is straightforward but tedious and can be shown (Problem 9.79) to yield the following result

$$
R_{i c m} \simeq \beta R_{E E} \frac{1+R_{C} / \beta r_{o}}{1+\frac{R_{C}+2 R_{E E}}{r_{o}}}
$$


Figure 9.27 (a) Definition of the input common-mode resistance $R_{i c m}$. (b) The equivalent common-mode half-circuit.

# Example 9.5 

For the differential amplifier analyzed in Example 9.3, let the bias-current source have an output resistance $R_{E E}=200 \mathrm{k} \Omega$. Evaluate:
(a) the worst-case common-mode gain if the two collector resistances are accurate to within $\pm 1 \%$.
(b) the CMRR in dB .
(c) the input common-mode resistance (assuming the Early voltage $V_{A}=100 \mathrm{~V}$ ).

## Solution

First we observe that the two emitter resistances $R_{E}$ will have negligible effect on $A_{c m}$.
(a) Using Eq. (9.94),

$$
\left|A_{c m}\right|=\frac{R_{C}}{2 R_{E E}} \frac{\triangle R_{C}}{R_{C}}
$$

where $\triangle R_{C}=0.02 R_{C}$ in the worst case. Thus,

$$
\left|A_{c m}\right|=\frac{10}{2 \times 200} \times 0.02=5 \times 10^{-4} \mathrm{~V} / \mathrm{V}
$$

(b)

$$
\mathrm{CMRR}=20 \log \frac{\left|A_{d}\right|}{\left|A_{c m}\right|}
$$

where from Example 9.3, $\left|A_{d}\right|=40$, thus

$$
\mathrm{CMRR}=20 \log \frac{40}{5 \times 10^{-4}}=98 \mathrm{~dB}
$$
(c)

$$
r_{o}=\frac{V_{A}}{I / 2}=\frac{100}{0.5}=200 \mathrm{k} \Omega
$$

Using Eq. (9.96),

$$
R_{\mathrm{m}}=6.6 \mathrm{M} \Omega
$$

# EXERCISE 

9.14 A bipolar differential amplifier utilizes a simple (i.e., a single CE transistor) current source to supply a bias current $I$ of $200 \mu \mathrm{~A}$, and simple current-source loads formed by pnp transistors. For all transistors, $\beta=100$ and $\left|V_{A}\right|=10 \mathrm{~V}$. Find $g_{m}, R_{C},\left|A_{d}\right|, R_{o l}, R_{E E}$, CMRR (if the two load transistors exhibit a $1 \%$ mismatch in their $r_{o}{ }^{\prime}$ s), and $R_{y c m}$. Hint: Remember to take into account $r_{o 1}$ and $r_{o 2}$.
Ans. $4 \mathrm{~mA} / \mathrm{V} ; 100 \mathrm{k} \Omega ; 200 \mathrm{~V} / \mathrm{V} ; 50 \mathrm{k} \Omega, 50 \mathrm{k} \Omega ; 86 \mathrm{~dB} ; 1.67 \mathrm{M} \Omega$

### 9.4 DC Offset

Because differential amplifiers are directly coupled and have finite gain at dc, they suffer from a number of dc problems. In this section we study some of these.

### 9.4.1 Input Offset Voltage of the MOS Differential Amplifier

Consider the basic MOS differential amplifier with both inputs grounded, as shown in Fig. 9.28(a). If the two sides of the differential pair were perfectly matched (i.e., $Q_{1}$ and $Q_{2}$ identical and $R_{D 1}=R_{D 2}=R_{D}$ ), then current $I$ would split equally between $Q_{1}$ and $Q_{2}$, and $V_{O}$ would be zero. But practical circuits exhibit mismatches that result in a dc output voltage $V_{O}$ even with both inputs grounded. We call $V_{O}$ the output dc offset voltage. More commonly, we divide $V_{O}$ by the differential gain of the amplifier, $A_{d}$, to obtain a quantity known as the input offset voltage, $V_{O S}$,

$$
V_{O S}=V_{O} / A_{d}
$$

We can see that if we apply a voltage $-V_{O S}$ between the input terminals of the differential amplifier, then the output voltage will be reduced to zero [see Fig. 9.28(b)]. This observation gives rise to the usual definition of the input offset voltage. It should be noted, however, that since the offset voltage is a result of device mismatches, its polarity is not known a priori.

Three factors contribute to the dc offset voltage of the MOS differential pair: mismatch in load resistances, mismatch in $W / L$, and mismatch in $V_{t}$. We shall consider the three contributing factors one at a time.


Figure 9.28 (a) The MOS differential pair with both inputs grounded. Owing to device and resistor mismatches, a finite dc output voltage $V_{O}$ results. (b) Application of a voltage equal to the input offset voltage $V_{O S}$ to the input terminals with opposite polarity reduces $V_{O}$ to zero.

For the differential pair shown in Fig. 9.28(a) consider first the case where $Q_{1}$ and $Q_{2}$ are perfectly matched but $R_{D 1}$ and $R_{D 2}$ show a mismatch $\Delta R_{D}$; that is,

$$
\begin{aligned}
& R_{D 1}=R_{D}+\frac{\Delta R_{D}}{2} \\
& R_{D 2}=R_{D}-\frac{\Delta R_{D}}{2}
\end{aligned}
$$

Because $Q_{1}$ and $Q_{2}$ are matched, the current $I$ will split equally between them. Nevertheless, because of the mismatch in load resistances, the output voltages $V_{D 1}$ and $V_{D 2}$ will be

$$
\begin{aligned}
& V_{D 1}=V_{D D}-\frac{I}{2}\left(R_{D}+\frac{\Delta R_{D}}{2}\right) \\
& V_{D 2}=V_{D D}-\frac{I}{2}\left(R_{D}-\frac{\Delta R_{D}}{2}\right)
\end{aligned}
$$

Thus the differential output voltage $V_{O}$ will be

$$
\begin{aligned}
V_{O} & =V_{D 2}-V_{D 1} \\
& =\left(\frac{I}{2}\right) \Delta R_{D}
\end{aligned}
$$

The corresponding input offset voltage is obtained by dividing $V_{O}$ by the gain $g_{m} R_{D}$ and substituting for $g_{m}$ from Eq. (9.30). The result is

$$
V_{O S}=\left(\frac{V_{O V}}{2}\right)\left(\frac{\Delta R_{D}}{R_{D}}\right)
$$
Thus the offset voltage is directly proportional to $V_{O V}$ and, of course, to $\Delta R_{D} / R_{D}$. As an example, consider a differential pair in which the two transistors are operating at an overdrive voltage of 0.2 V and each drain resistance is accurate to within $\pm 1 \%$. It follows that the worst-case resistor mismatch will be

$$
\frac{\Delta R_{D}}{R_{D}}=0.02
$$

and the resulting input offset voltage will be

$$
\left|V_{O S}\right|=0.1 \times 0.02=2 \mathrm{mV}
$$

Next, consider the effect of a mismatch in the $W / L$ ratios of $Q_{1}$ and $Q_{2}$, expressed as

$$
\begin{aligned}
& \left(\frac{W}{L}\right)_{1}=\frac{W}{L}+\frac{1}{2} \Delta\left(\frac{W}{L}\right) \\
& \left(\frac{W}{L}\right)_{2}=\frac{W}{L}-\frac{1}{2} \Delta\left(\frac{W}{L}\right)
\end{aligned}
$$

Such a mismatch causes the current $I$ to no longer divide equally between $Q_{1}$ and $Q_{2}$. Rather, because $V_{G S 1}=V_{G S 2}$, the current conducted by each of $Q_{1}$ and $Q_{2}$ will be proportional to its $W / L$ ratio, and we can easily show that

$$
\begin{aligned}
& I_{1}=\frac{I}{2}\left[1+\frac{\Delta(W / L)}{2(W / L)}\right] \\
& I_{2}=\frac{I}{2}\left[1-\frac{\Delta(W / L)}{2(W / L)}\right]
\end{aligned}
$$

Dividing the current difference,

$$
\frac{I}{2} \frac{\Delta(W / L)}{(W / L)}
$$

by $g_{m}$ gives the input offset voltage (due to the mismatch in $W / L$ values). ${ }^{2}$ Thus

$$
V_{O S}=\left(\frac{V_{O V}}{2}\right)\left(\frac{\Delta(W / L)}{(W / L)}\right)
$$

Here again we note that $V_{O S}$, resulting from a $(W / L)$ mismatch, is proportional to $V_{O V}$ and, as expected, $\Delta(W / L)$.

Finally, we consider the effect of a mismatch $\Delta V_{i}$ between the two threshold voltages,

$$
\begin{aligned}
& V_{i 1}=V_{i}+\frac{\Delta V_{i}}{2} \\
& V_{i 2}=V_{r}-\frac{\Delta V_{i}}{2}
\end{aligned}
$$

The current $I_{1}$ will be given by

$$
\begin{aligned}
I_{1} & =\frac{1}{2} k_{n} \frac{W}{L}\left(V_{G S}-V_{i}-\frac{\Delta V_{i}}{2}\right)^{2} \\
& =\frac{1}{2} k_{n} \frac{W}{L}\left(V_{G S}-V_{i}\right)^{2}\left(1-\frac{\Delta V_{i}}{2\left(V_{G S}-V_{i}\right)}\right)^{2}
\end{aligned}
$$

[^0]
[^0]:    ${ }^{2}$ We are skipping a step in the derivation: Rather than multiplying the current difference by $R_{C}$ and dividing the resulting output offset by $A_{d}=g_{m} R_{C}$, we are simply dividing the current difference by $g_{m}$.
which, for $\Delta V_{t} \ll 2\left(V_{G S}-V_{t}\right)$ (that is, $\Delta V_{t} \ll 2 V_{O V}$ ), can be approximated as

$$
I_{1} \simeq \frac{1}{2} k_{t} \frac{W}{L}\left(V_{G S}-V_{t}\right)^{2}\left(1-\frac{\Delta V_{t}}{V_{G S}-V_{t}}\right)
$$

Similarly,

$$
I_{2} \simeq \frac{1}{2} k_{t} \frac{W}{L}\left(V_{G S}-V_{t}\right)^{2}\left(1+\frac{\Delta V_{t}}{V_{G S}-V_{t}}\right)
$$

We recognize that

$$
\frac{1}{2} k_{t} \frac{W}{L}\left(V_{G S}-V_{t}\right)^{2}=\frac{I}{2}
$$

and the current increment (decrement) in $Q_{2}\left(Q_{1}\right)$ is

$$
\Delta I=\frac{I}{2} \frac{\Delta V_{t}}{V_{G S}-V_{t}}=\frac{I}{2} \frac{\Delta V_{t}}{V_{O V}}
$$

Dividing the current difference $2 \Delta I$ by $g_{m}$ gives the input offset voltage (due to $\Delta V_{t}$ ). Thus,

$$
V_{O S}=\Delta V_{t}
$$

a very logical result! For modern MOS technology $\Delta V_{t}$ can be as high as a few mV . Finally, we note that since the three sources for offset voltage are not correlated, an estimate of the total input offset voltage can be found as

$$
V_{O S}=\sqrt{\left(\frac{V_{O V}}{2} \frac{\Delta R_{D}}{R_{D}}\right)^{2}+\left(\frac{V_{O V}}{2} \frac{\Delta(W / L)}{W / L}\right)^{2}+\left(\Delta V_{t}\right)^{2}}
$$

# EXERCISE 

9.15 For the MOS differential pair specified in Exercise 9.4, find the three components of the input offset voltage. Let $\Delta R_{D} / R_{D}=2 \%, \Delta(W / L) /(W / L)=2 \%$, and $\Delta V_{t}=2 \mathrm{mV}$. Use Eq. (9.110) to obtain an estimate of the total $V_{O S}$.
Ans. $2 \mathrm{mV} ; 2 \mathrm{mV} ; 2 \mathrm{mV} ; 3.5 \mathrm{mV}$

### 9.4.2 Input Offset Voltage of the Bipolar Differential Amplifier

The offset voltage of the bipolar differential pair shown in Fig. 9.29(a) can be determined in a manner analogous to that used above for the MOS pair. Note, however, that in the bipolar case there is no analog to the $V_{t}$ mismatch of the MOSFET pair. Here the output offset results from mismatches in the load resistances $R_{C 1}$ and $R_{C 2}$ and from junction area, $\beta$, and other mismatches in $Q_{1}$ and $Q_{2}$. Consider first the effect of the load mismatch. Let

$$
\begin{aligned}
& R_{C 1}=R_{C}+\frac{\Delta R_{C}}{2} \\
& R_{C 2}=R_{C}-\frac{\Delta R_{C}}{2}
\end{aligned}
$$


Figure 9.29 (a) The BJT differential pair with both inputs grounded. Device mismatches result in a finite dc output $V_{O}$. (b) Application of the input offset voltage $V_{O S}=V_{O} / A_{d}$ to the input terminals with opposite polarity reduces $V_{O}$ to zero.
and assume that $Q_{1}$ and $Q_{2}$ are perfectly matched. It follows that current $I$ will divide equally between $Q_{1}$ and $Q_{2}$, and thus

$$
\begin{aligned}
& V_{C 1}=V_{C C}-\left(\frac{\alpha I}{2}\right)\left(R_{C}+\frac{\Delta R_{C}}{2}\right) \\
& V_{C 2}=V_{C C}-\left(\frac{\alpha I}{2}\right)\left(R_{C}-\frac{\Delta R_{C}}{2}\right)
\end{aligned}
$$

Thus the output voltage will be

$$
V_{O}=V_{C 2}-V_{C 1}=\alpha\left(\frac{I}{2}\right)\left(\Delta R_{C}\right)
$$

and the input offset voltage will be

$$
V_{O S}=\frac{\alpha(I / 2)\left(\Delta R_{C}\right)}{A_{d}}
$$

Substituting $A_{d}=g_{m} R_{C}$ and

$$
g_{m}=\frac{\alpha I / 2}{V_{T}}
$$

gives

$$
\left|V_{O S}\right|=V_{T}\left(\frac{\Delta R_{C}}{R_{C}}\right)
$$

An important point to note is that in comparison to the corresponding expression for the MOS pair (Eq. 9.101) here the offset is proportional to $V_{T}$ rather than $V_{O V} / 2 . V_{T}$ at 25 mV is 3 to 6 times lower than $V_{O V} / 2$. Hence bipolar differential pairs exhibit lower offsets than their MOScounterparts. As an example, consider the situation of collector resistors that are accurate to within $\pm 1 \%$. Then the worst-case mismatch will be

$$
\frac{\Delta R_{C}}{R_{C}}=0.02
$$

and the resulting input offset voltage will be

$$
\left|V_{O S}\right|=25 \times 0.02=0.5 \mathrm{mV}
$$

Next consider the effect of mismatches in transistors $Q_{1}$ and $Q_{2}$. In particular, let the transistors have a mismatch in their emitter-base junction areas. Such an area mismatch gives rise to a proportional mismatch in the scale currents $I_{S}$,

$$
\begin{aligned}
& I_{S 1}=I_{S}+\frac{\Delta I_{S}}{2} \\
& I_{S 2}=I_{S}-\frac{\Delta I_{S}}{2}
\end{aligned}
$$

Refer to Fig. 9.29(a) and note that $V_{B E 1}=V_{B E 2}$. Thus, the current $I$ will split between $Q_{1}$ and $Q_{2}$ in proportion to their $I_{S}$ values, resulting in

$$
\begin{aligned}
& I_{E 1}=\frac{I}{2}\left(1+\frac{\Delta I_{S}}{2 I_{S}}\right) \\
& I_{E 2}=\frac{I}{2}\left(1-\frac{\Delta I_{S}}{2 I_{S}}\right)
\end{aligned}
$$

It follows that the output offset voltage will be

$$
V_{O}=\alpha\left(\frac{I}{2}\right)\left(\frac{\Delta I_{S}}{I_{S}}\right) R_{C}
$$

and the corresponding input offset voltage will be

$$
\left|V_{O S}\right|=V_{T}\left(\frac{\Delta I_{S}}{I_{S}}\right)
$$

As an example, an area mismatch of $4 \%$ gives rise to $\Delta I_{S} / I_{S}=0.04$ and an input offset voltage of 1 mV . Here again we note that the offset voltage is proportional to $V_{T}$ rather than to the much larger $V_{O V}$, which determines the offset of the MOS pair due to $\Delta(W / L)$ mismatch.

Since the two contributions to the input offset voltage are usually not correlated, an estimate of the total input offset voltage can be found as

$$
\begin{aligned}
V_{O S} & =\sqrt{\left(V_{T} \frac{\Delta R_{C}}{R_{C}}\right)^{2}+\left(V_{T} \frac{\Delta I_{S}}{I_{S}}\right)^{2}} \\
& =V_{T} \sqrt{\left(\frac{\Delta R_{C}}{R_{C}}\right)^{2}+\left(\frac{\Delta I_{S}}{I_{S}}\right)^{2}}
\end{aligned}
$$

There are other possible sources for input offset voltage such as mismatches in the values of $\beta$ and $r_{o}$. Some of these are investigated in the end-of-chapter problems. Finally, it should be noted that there is a popular scheme for compensating for the offset voltage. It involves introducing a deliberate mismatch in the values of the two collector resistances such that the differential output voltage is reduced to zero when both input terminals are grounded. Such an offset-nulling scheme is explored in Problem 9.81.
# 9.4.3 Input Bias and Offset Currents of the Bipolar Differential Amplifier 

In a perfectly symmetric bipolar differential pair, the two input terminals carry equal dc currents; that is,

$$
I_{B 1}=I_{B 2}=\frac{I / 2}{\beta+1}
$$

This is the input bias current of the differential amplifier.
Mismatches in the amplifier circuit and most importantly a mismatch in $\beta$ make the two input dc currents unequal. The resulting difference is the input offset current, $I_{O S}$, given as

$$
I_{O S}=\left|I_{B 1}-I_{B 2}\right|
$$

Let

$$
\begin{aligned}
& \beta_{1}=\beta+\frac{\Delta \beta}{2} \\
& \beta_{2}=\beta-\frac{\Delta \beta}{2}
\end{aligned}
$$

then

$$
\begin{aligned}
& I_{B 1}=\frac{I}{2} \frac{1}{\beta+1+\Delta \beta / 2} \simeq \frac{I}{2} \frac{1}{\beta+1}\left(1-\frac{\Delta \beta}{2 \beta}\right) \\
& I_{B 2}=\frac{I}{2} \frac{1}{\beta+1-\Delta \beta / 2} \simeq \frac{I}{2} \frac{1}{\beta+1}\left(1+\frac{\Delta \beta}{2 \beta}\right) \\
& I_{O S}=\frac{I}{2(\beta+1)}\left(\frac{\Delta \beta}{\beta}\right)
\end{aligned}
$$

Formally, the input bias current $I_{B}$ is defined as follows:

$$
I_{B} \equiv \frac{I_{B 1}+I_{B 2}}{2}=\frac{I}{2(\beta+1)}
$$

Thus

$$
I_{O S}=I_{B}\left(\frac{\Delta \beta}{\beta}\right)
$$

As an example, a $10 \% \beta$ mismatch results in an offset current that is one-tenth the value of the input bias current.

Finally note that a great advantage of the MOS differential pair is that it does not suffer from a finite input bias current or from mismatches thereof!

## EXERCISE

9.16 For a BJT differential amplifier utilizing transistors having $\beta=100$, matched to $10 \%$ or better, and areas that are matched to $10 \%$ or better, along with collector resistors that are matched to $2 \%$ or better, find $V_{O S}, I_{B}$, and $I_{O S}$. The dc bias current $I$ is $100 \mu \mathrm{~A}$.
Ans. $2.55 \mathrm{mV} ; 0.5 \mu \mathrm{~A} ; 50 \mathrm{nA}$
# 9.4.4 A Concluding Remark 

We conclude this section by noting that the definitions presented here are identical to those presented in Chapter 2 for op amps. In fact, as will be seen in Chapter 13, it is the input differential stage in an op-amp circuit that primarily determines the op-amp dc offset voltage, input bias and offset currents, and input common-mode range.

### 9.5 The Differential Amplifier with a Current-Mirror Load

The differential amplifiers we have studied thus far have been of the differential output variety; that is, the output is taken between the two drains (or two collectors) rather than between one of the drains (collectors) and ground. Taking the output differentially has three major advantages:

1. It decreases the common-mode gain and thus increases the common-mode rejection ratio (CMRR). Recall that while the drain (collector) voltages change somewhat in response to a common-mode input signal, the difference between the drain (collector) voltages remains essentially zero except for a small change due to the mismatches inevitably present in the circuit.
2. It decreases the input offset voltage.
3. It increases the differential gain by a factor of $2(6 \mathrm{~dB})$ because the output is the difference between two voltages of equal magnitude and opposite sign.

These advantages are sufficiently compelling that at least the first stage in an IC amplifier such as an op amp is differential-in, differential-out. The differential transmission of the signal on the chip also minimizes its susceptibility to corruption with noise and interference, which usually occur in a common-mode fashion. Nevertheless, it is usually required at some point to convert the signal from differential to single-ended; for instance, to connect it to an off-chip load. Figure 9.30 shows a block diagram of a three-stage amplifier in which the first two stages are of the differential-in, differential-out type, and the third has a single-ended output, that is, an output that is referenced to ground. We now address the question of conversion from differential to single-ended.


Figure 9.30 A three-stage amplifier consisting of two differential-in, differential-out stages, $A_{1}$ and $A_{2}$, and a differential-in, single-ended-out stage $A_{3}$.

### 9.5.1 Differential-to-Single-Ended Conversion

Figure 9.31 illustrates the simplest, most basic approach for differential-to-single-ended conversion. It consists of simply ignoring the drain current signal of $Q_{1}$ and eliminating its drain resistor altogether, and taking the output between the drain of $Q_{2}$ and ground. The


Figure 9.31 A simple but inefficient approach for differential-to-single-ended conversion.
obvious drawback of this scheme is that we lose a factor of 2 (or 6 dB ) in gain as a result of "wasting" the drain signal current of $Q_{1}$. A much better approach would be to find a way of utilizing the drain current signal of $Q_{1}$, and that is exactly what the circuit we are about to discuss accomplishes.

# 9.5.2 The Current-Mirror-Loaded MOS Differential Pair 

Figure 9.32(a) shows a MOS differential pair formed by transistors $Q_{1}$ and $Q_{2}$, loaded by a current mirror formed by transistors $Q_{3}$ and $Q_{4}$. To see how this circuit operates, consider first the quiescent or equilibrium state with the two input terminals connected to a dc voltage equal to the common-mode equilibrium value, in this case 0 V , as shown in Fig. 9.32(b). Assuming perfect matching, the bias current $I$ divides equally between $Q_{1}$ and $Q_{2}$. The drain current of $Q_{1}, I / 2$, is fed to the input transistor of the mirror, $Q_{3}$. Thus, a replica of this current is provided by the output transistor of the mirror, $Q_{4}$. Observe that at the output node the two currents $I / 2$ balance each other out, leaving a zero current to flow out to the next stage or to a load (not shown). This is obviously the desired result! Further, if $Q_{4}$ is perfectly matched to $Q_{3}$, its drain voltage will track the voltage at the drain of $Q_{3}$; thus in equilibrium the voltage at the output will be $V_{D D}-V_{S G 3}$. It should be noted, however, that in practical implementations, there will always be mismatches, resulting in a net dc current at the output. In the absence of a load resistance, this current will flow into the output resistances of $Q_{2}$ and $Q_{4}$ and thus can cause a large deviation in the output voltage from the ideal value. Therefore, this circuit is always designed so that the dc bias voltage at the output node is defined by a feedback circuit rather than by simply relying on the matching of $Q_{4}$ and $Q_{3}$. We shall see how this is done later.

Next, consider the circuit with a differential input signal $v_{i d}$ applied to the input, as shown in Fig. 9.32(c). Since we are now investigating the small-signal operation of the circuit, we have removed the dc supplies (including the current source $I$ ). Also, for the time being let us ignore $r_{o}$ of all transistors. As Fig. 9.32(c) shows, a current $i$ flows through $Q_{1}$ and $Q_{2}$, given by $i=v_{i d} /\left(\frac{2}{g_{m}}\right)$. Thus, transistor $Q_{1}$ will conduct a drain signal current $i=g_{m 1} v_{i d} / 2$, and transistor $Q_{2}$ will conduct an equal but opposite current $i$. The drain signal current $i$ of $Q_{1}$ is


Figure 9.32 (a) The current-mirror-loaded MOS differential pair. (b) The circuit at equilibrium assuming perfect matching. (c) The circuit with a differential input signal applied and neglecting the $r_{o}$ of all transistors.
fed to the input of the $Q_{3}-Q_{4}$ mirror, which responds by providing a replica in the drain of $Q_{4}$. Now, at the output node we have two currents, each equal to $i$, which sum together to provide an output current $2 i$. It is this factor of 2 , which is a result of the current-mirror action, that makes it possible to convert the signal to single-ended form (i.e., between the output node and ground) with no loss of gain! If a load resistance is connected to the output node, the current $2 i$ flows through it and thus determines the output voltage $v_{o}$. In the absence of a load resistance, the output voltage is determined by the output current $2 i$ and the output resistance of the circuit, as we shall shortly see.

Before immersing ourselves in detailed analysis of the circuit, it is important to understand the essence of its operation: For dc quantities and common-mode inputs, the current-mirror load produces an output current in the drain of $Q_{4}$ that cancels the current of $Q_{2}$. On the other hand, for differential input signals, the output current of the mirror adds to the current of $Q_{2}$.
# 9.5.3 Differential Gain of the Current-Mirror-Loaded MOS Pair 

As we learned in Chapter 8, the output resistance $r_{o}$ of the transistor plays a significant role in the operation of active-loaded amplifiers. Therefore, we shall now take $r_{o}$ into account and derive an expression for the differential gain $v_{o} / v_{i d}$ of the current-mirror-loaded MOS differential pair. Toward that end, we first observe that the circuit is not symmetrical: While the drain of $Q_{1}$ sees the small resistance of the diode-connected transistor $Q_{3}$ (approximately equal to $1 / g_{m 3}$ ), the drain of $Q_{2}$ sees the much larger output resistance of $Q_{4}\left(r_{o 4}\right)$. Thus, a virtual ground will not develop at the common sources ${ }^{3}$ and we cannot use the differential half-circuit technique.

Our approach will be to represent the output of the circuit in Fig. 9.32(c) by the general equivalent circuit shown in Fig. 9.33. Here $G_{m}$ is the short-circuit transconductance and $R_{o}$ is the output resistance. In the following, we will show that

$$
G_{m}=g_{m 1,2}
$$

where $g_{m 1,2}$ is the transconductance of each of $Q_{1}$ and $Q_{2}$. We will also show that

$$
R_{o}=r_{o 2} \| r_{o 4}
$$

In other words, we shall have two intuitively appealing results: The short-circuit transconductance of the circuit is equal to $g_{m}$ of each of the two transistors of the differential pair, and the output resistance is the parallel equivalent of the output resistances of $Q_{2}$ and $Q_{4}$. Thus, the open-circuit differential voltage gain can be found as

$$
A_{d} \equiv \frac{v_{o}}{v_{i d}}=G_{m} R_{o}=g_{m 1,2}\left(r_{o 2} \| r_{o 4}\right)
$$

Writing $g_{m 1,2}$ simply as $g_{m}$, and for the case $r_{o 2}=r_{o 4}=r_{o}$,

$$
A_{d}=\frac{1}{2} g_{m} r_{o}=\frac{1}{2} A_{0}
$$

where $A_{0}$ is the intrinsic gain of the MOS transistor.


Figure 9.33 Output equivalent circuit of the amplifier in Fig. 9.32(a) for differential input signals.

[^0]
[^0]:    ${ }^{3}$ The qualitative description of circuit operation above implied that a virtual ground develops at the MOSFET sources. That was the case because we were neglecting $r_{o}$ of all transistors.
# EXERCISE 

9.17 A current-mirror-loaded MOS differential amplifier of the type shown in Fig. 9.32(a) is specified as follows: $(W / L)_{n}=100,(W / L)_{p}=200, \mu_{n} C_{o s}=2 \mu_{p} C_{o s}=0.2 \mathrm{~mA} / \mathrm{V}^{2}, V_{A n}=\left|V_{A p}\right|=20 \mathrm{~V}$, and $I=0.8$ mA . Calculate $G_{m}, R_{o}$, and $A_{d}$.
Ans. $4 \mathrm{~mA} / \mathrm{V} ; 25 \mathrm{k} \Omega ; 100 \mathrm{~V} / \mathrm{V}$

Derivation of the Short-Circuit Transconductance, $G_{m}$ Figure 9.34(a) shows the current-mirror-loaded MOS amplifier with the output terminal short-circuited to ground. Our purpose is to determine the short-circuit transconductance

$$
G_{m} \equiv \frac{i_{o}}{v_{i d}}
$$

We note that short-circuiting the output terminal makes the circuit nearly balanced. This is because the drain of $Q_{1}$ sees the small resistance of the diode-connected transistor $Q_{3}$, and now the drain of $Q_{2}$ sees a short circuit. It follows that the voltage at the MOSFET sources will be approximately zero. Now, replacing each of the four transistors with its hybrid- $\pi$ model and noting that for the diode-connected transistor $Q_{3}$, the model reduces to a resistance $\left(1 / g_{m 3} \| r_{o 3}\right)$, we obtain the equivalent circuit shown in Fig. 9.34(b). The short-circuit output current $i_{o}$ can be found by writing a node equation at the output and noting that the currents in $r_{o 2}$ and $r_{o 4}$ are zero; thus

$$
i_{o}=g_{m 2}\left(\frac{v_{i d}}{2}\right)-g_{m 4} v_{g s 4}
$$

Next, we note that

$$
v_{g s 4}=v_{g s 3}
$$

and $v_{g s 3}$ can be obtained from a node equation at $d_{1}$ as

$$
v_{g s 3}=-g_{m 1}\left(\frac{v_{i d}}{2}\right)\left(\frac{1}{g_{m 3}}\left\|r_{o 3}\right\| r_{o 1}\right)
$$

which for the usual case of $\frac{1}{g_{m 3}} \ll r_{o 3}, r_{o 1}$, reduces to

$$
v_{g s 3} \simeq-\frac{g_{m 1}}{g_{m 3}}\left(\frac{v_{i d}}{2}\right)
$$

Combining Eqs. (9.132) to (9.134) and substituting $g_{m 3}=g_{m 4}$ and $g_{m 1}=g_{m 2}=g_{m}$ gives

$$
i_{o}=g_{m} v_{i d}
$$

from which $G_{m}$ is found to be

$$
G_{m}=g_{m}
$$

as expected.
Derivation of the Output Resistance $R_{o}$ Figure 9.35 shows the circuit ${ }^{4}$ for determining the output resistance $R_{o}$. Observe that we have set $v_{i d}$ to zero, resulting in the ground

[^0]
[^0]:    ${ }^{4}$ Note that rather than replacing each transistor with its small-signal model, we are, for simplicity, using the models implicitly. Thus we have "pulled $r_{o}$ out" of each transistor and shown it separately so that the drain current becomes $g_{m} v_{g s}$.


Figure 9.34 Derivation of the short-circuit transconductance $G_{m} \equiv i_{o} / v_{c d}$.
connections at the gates of $Q_{1}$ and $Q_{2}$. We have applied a test voltage $v_{x}$ in order to determine $R_{o}$,

$$
R_{o} \equiv \frac{v_{x}}{i_{x}}
$$

Analysis of this circuit is considerably simplified by observing the current transmission around the circuit by simply following the circled numbers. The current $i$ that enters $Q_{2}$ must exit at its source. It then enters $Q_{1}$, exiting at the drain to feed the $Q_{3}-Q_{4}$ mirror. Since for the diode-connected transistor $Q_{3}, 1 / g_{m 3}$ is much smaller than $r_{o 3}$, most of the current $i$ flows into the drain proper of $Q_{3}$. The mirror responds by providing an equal current $i$ in the drain of $Q_{4}$. The relationship between $i$ and $v_{x}$ can be determined by observing that at the output node

$$
i=v_{x} / R_{o 2}
$$


Figure 9.35 Circuit for determining $R_{o}$. The circled numbers indicate the order of the analysis steps.
where $R_{o 2}$ is the output resistance of $Q_{2}$. Now, $Q_{2}$ is a CG transistor and has in its source lead the input resistance $R_{\text {in1 }}$ of the CG transistor $Q_{1}$. Noting that the load resistance of $Q_{1}$ is $\left[\left(1 / g_{m 3}\right) \| r_{o 3}\right]$, which is approximately $1 / g_{m 3}$, we can obtain $R_{\text {in1 }}$ by using the expression for the input resistance of a CG transistor (Eq. 8.53),

$$
\begin{aligned}
R_{\text {in } 1} & =\frac{r_{o 1}+R_{L}}{g_{m 1} r_{o 1}} \\
& =\frac{1}{g_{m 1}}+\frac{1 / g_{m 3}}{g_{m 1} r_{o 1}} \simeq \frac{1}{g_{m 1}}
\end{aligned}
$$

We then use this value of $R_{\text {in } 1}$ to determine $R_{o 2}$ utilizing the expression in Eq. (8.60) as follows:

$$
\begin{aligned}
R_{o 2} & =R_{\text {in } 1}+r_{o 2}+g_{m 2} r_{o 2} R_{\text {in } 1} \\
& =\frac{1}{g_{m 1}}+r_{o 2}+\left(\frac{g_{m 2}}{g_{m 1}}\right) r_{o 2}
\end{aligned}
$$

which, for $g_{m 1}=g_{m 2}=g_{m}$ and $g_{m 2} r_{o 2} \gg 1$, yields

$$
R_{o 2} \simeq 2 r_{o 2}
$$

Returning to the output node, we write

$$
\begin{aligned}
i_{s} & =i+i+\frac{v_{s}}{r_{o 4}} \\
& =2 i+\frac{v_{s}}{r_{o 4}}=2 \frac{v_{s}}{R_{o 2}}+\frac{v_{s}}{r_{o 4}}
\end{aligned}
$$

Substituting for $R_{o 2}$ from Eq. (9.135), we obtain

$$
i_{s}=2 \frac{v_{s}}{2 r_{o 2}}+\frac{v_{s}}{r_{o 4}}
$$
Thus,

$$
R_{o} \equiv \frac{v_{x}}{t_{x}}=r_{o 2} \| r_{o 4}
$$

which is the result we stated earlier.

# 9.5.4 The Bipolar Differential Pair with a Current-Mirror Load 

The bipolar version of the active-loaded differential pair is shown in Fig. 9.36(a). The circuit structure and operation are very similar to those of its MOS counterpart except that here we have to contend with the effects of finite $\beta$ and the resulting finite input resistance at the base, $r_{n}$. For the time being, however, we shall ignore the effect of finite $\beta$ on the dc bias of the four transistors and assume that in equilibrium all transistors are operating at a dc current of $I / 2$.

Differential Gain To obtain an expression for the differential gain, we use an approach identical to that employed above for the MOS case. That is, we represent the output of the amplifier with the equivalent circuit shown in Fig. 9.36(b) and show that the short-circuit transconductance $G_{m}$ is given by

$$
G_{m}=g_{m 1,2}
$$

where $g_{m 1,2}$ denotes $g_{m}$ of each of $Q_{1}$ and $Q_{2}$, and that the output resistance $R_{o}$ is given by

$$
R_{o}=r_{o 2} \| r_{o 4}
$$

Both these results are identical to those for the MOS case and can be similarly derived.


Figure 9.36 (a) Current-mirror-loaded bipolar differential pair. (b) Small-signal equivalent circuit of the amplifier output when a differential signal $v_{c d} \equiv v_{B 1}-v_{B 2}$ is applied.Equations (9.137) and (9.138) can now be combined to obtain the differential gain,

$$
A_{d} \equiv \frac{v_{o}}{v_{i d}}=G_{m} R_{o}=g_{m}\left(r_{o 2} \| r_{o 4}\right)
$$

where $g_{m}=g_{m 1}=g_{m 2} \simeq \frac{V_{T}}{I / 2}$, and since $r_{o 2}=r_{o 4}=r_{o}$, we can simplify Eq. (9.139) to

$$
A_{d}=\frac{1}{2} g_{m} r_{o}
$$

Although this expression is identical to that found for the MOS circuit, the gain here is much larger because $g_{m} r_{o}$ for the BJT is more than an order of magnitude greater than $g_{m} r_{o}$ of a MOSFET. The downside, however, lies in the low input resistance of BJT amplifiers. Indeed, from the circuit in Fig. 9.36(a), we can see that the differential input resistance is equal to $2 r_{\pi}$,

$$
R_{i d}=2 r_{\pi}
$$

in sharp contrast to the infinite input resistance of the MOS amplifier. Thus, while the voltage gain realized in a current-mirror-loaded BJT amplifier stage is large, when a subsequent BJT stage is connected to the output, its inevitably low input resistance will drastically reduce the overall voltage gain.

# EXERCISE 

9.18 For the current-mirror-loaded BJT differential amplifier let $I=0.8 \mathrm{~mA}, V_{A}=100 \mathrm{~V}$, and $\beta=160$. Find $G_{m}, R_{o}, A_{d}$, and $R_{i d}$.
Ans. $16 \mathrm{~mA} / \mathrm{V} ; 125 \mathrm{k} \Omega ; 2000 \mathrm{~V} / \mathrm{V} ; 20 \mathrm{k} \Omega$

Systematic Input Offset Voltage In addition to the random offset voltages that result from the mismatches inevitably present in the differential amplifier, the current-mirror-loaded bipolar differential pair suffers from a systematic offset voltage that has no counterpart in the MOS version. This is due to the error in the current transfer ratio of the current-mirror load caused by the finite $\beta$ of the $p n p$ transistors that make up the mirror. To see how this comes about, refer to Fig. 9.37. Here the inputs are grounded and the transistors are assumed to be perfectly matched. Thus, the bias current $I$ will divide equally between $Q_{1}$ and $Q_{2}$, with the result that their two collectors conduct equal currents of $\alpha I / 2$. The collector current of $Q_{1}$ is fed to the input of the current mirror. From Section 8.2 we know that the current transfer ratio of the mirror is

$$
\frac{I_{4}}{I_{3}}=\frac{1}{1+\frac{2}{\beta_{P}}}
$$

where $\beta_{P}$ is the value of $\beta$ of the $p n p$ transistors $Q_{3}$ and $Q_{4}$. Thus the collector current of $Q_{4}$ will be

$$
I_{4}=\frac{\alpha I / 2}{1+\frac{2}{\beta_{P}}}
$$


Figure 9.37 The current-mirror-loaded BJT differential pair suffers from a systematic input offset voltage resulting from the error in the current transfer ratio of the current mirror.
which does not exactly balance the collector current of $Q_{2}$. It follows that the current difference $\Delta i$ will flow into the output terminal of the amplifier with

$$
\begin{aligned}
\Delta i & =\frac{\alpha I}{2}-\frac{\alpha I / 2}{1+\frac{2}{\beta_{P}}} \\
& =\frac{\alpha I}{2} \frac{2 / \beta_{P}}{1+\frac{2}{\beta_{P}}} \\
& \simeq \frac{\alpha I}{\beta_{P}}
\end{aligned}
$$

To reduce this output current to zero, an input voltage $V_{O S}$ has to be applied with a value of

$$
V_{O S}=-\frac{\Delta i}{G_{m}}
$$

Substituting for $\Delta i$ from Eq. (9.144) and for $G_{m}=g_{m}=(\alpha I / 2) / V_{T}$, we obtain for the input offset voltage the expression

$$
V_{O S}=-\frac{\alpha I / \beta_{P}}{\alpha I / 2 V_{T}}=-\frac{2 V_{T}}{\beta_{P}}
$$

As an example, for $\beta_{P}=50, V_{O S}=-1 \mathrm{mV}$. To reduce $V_{O S}$, an improved current mirror such as the Wilson circuit studied in Section 8.6.2 should be used. Such a circuit provides the added advantage of increased output resistance and hence voltage gain. However, to realize the full advantage of the higher output resistance of the active load, the output resistance of the differential pair should be raised by utilizing a cascode stage. Figure 9.38 shows such an arrangement: A folded cascode stage formed by pnp transistors $Q_{3}$ and $Q_{4}$ is utilized to


Figure 9.38 An current-mirror-loaded bipolar differential amplifier employing a folded cascode stage ( $Q_{3}$ and $Q_{4}$ ) and a Wilson current-mirror load ( $Q_{5}, Q_{6}$, and $Q_{7}$ ).
raise the output resistance looking into the collector of $Q_{4}$ to $\beta_{4} r_{o 4}$. A Wilson mirror formed by transistors $Q_{5}, Q_{6}$, and $Q_{7}$ is used to implement the active load. From Section 8.6.2 we know that the output resistance of the Wilson mirror (i.e., looking into the collector of $Q_{5}$ ) is $\beta_{5}\left(r_{o 5} / 2\right)$. Thus the output resistance of the amplifier is given by

$$
R_{o}=\left[\beta_{4} r_{o 4} \| \beta_{5} \frac{r_{o 5}}{2}\right]
$$

The transconductance $G_{m}$ remains equal to $g_{m}$ of $Q_{1}$ and $Q_{2}$. Thus the differential voltage gain becomes

$$
A_{d}=g_{m}\left[\beta_{4} r_{o 4} \| \beta_{5} \frac{r_{o 5}}{2}\right]
$$

which can be very large. Further examples of improved-performance differential amplifiers will be studied in Chapter 13.

# EXERCISE 

9.19 Find $G_{m}, R_{o 4}, R_{o 5}, R_{o}$, and $A_{d}$ for the differential amplifier in Fig. 9.38 under the following conditions: $I=1 \mathrm{~mA}, \beta_{P}=50, \beta_{N}=100$, and $V_{A}=100 \mathrm{~V}$.
Ans. $20 \mathrm{~mA} / \mathrm{V} ; 10 \mathrm{M} \Omega ; 10 \mathrm{M} \Omega ; 5 \mathrm{M} \Omega ; 10^{5} \mathrm{~V} / \mathrm{V}$ or 100 dB
# 9.5.5 Common-Mode Gain and CMRR 

Although the output is single ended, the current-mirror-loaded differential amplifier has a low common-mode gain (ideally zero) and, correspondingly, a high CMRR (ideally infinite). This is due to the action of the current mirror, whose output current, for common-mode inputs, cancels the current of $Q_{2}$ of the differential pair. We have, in fact, seen this in our initial qualitative description of circuit operation.

The current transfer ratio of the mirror, however, will never be exactly unity, and thus the current cancellation at the output node will never be perfect. As a result, the common-mode gain will be finite. We wish to derive an expression for $A_{c m}$.

Figure 9.39(a) shows the circuit with $v_{i c m}$ applied and with the power supplies eliminated except, of course, for the output resistance $R_{S S}$ of the bias-current source $I$. Although the circuit is not symmetrical and hence we cannot use the common-mode half-circuit, we can split $R_{S S}$ equally between $Q_{1}$ and $Q_{2}$ as shown in Fig. 9.39(b). It can now be seen that each of $Q_{1}$ and $Q_{2}$ is a CS transistor with a large source-degeneration resistance $2 R_{S S}$.

Each of $Q_{1}$ and $Q_{2}$ together with their degeneration resistances can be replaced by equivalent circuits composed of a controlled source $G_{m c m} v_{i c m}$ and an output resistance $R_{o 1,2}$, as shown in Fig. 9.39(c). To determine $G_{m c m}$ we short-circuit the drain to ground, as shown in Fig. 9.39(d) for $Q_{1}$. Observe that $2 R_{S S}$ and $r_{o 1}$ appear in parallel. Thus the voltage at the source terminal can be found from the voltage divider consisting of $1 / g_{m 1}$ and $\left(2 R_{S S} \| r_{o 1}\right)$ as

$$
\begin{aligned}
v_{s} & =v_{i c m} \frac{\left(2 R_{S S} \| r_{o 1}\right)}{\left(2 R_{S S} \| r_{o 1}\right)+\left(1 / g_{m 1}\right)} \\
& \simeq v_{i c m}
\end{aligned}
$$

The short-circuit drain current $i_{o}$ can be seen to be equal to the current through $2 R_{S S}$; thus,

$$
i_{o}=\frac{v_{s}}{2 R_{S S}} \simeq \frac{v_{i c m}}{2 R_{S S}}
$$

which leads to

$$
G_{m c m} \equiv \frac{i_{o}}{v_{i c m}}=\frac{1}{2 R_{S S}}
$$

The output resistance $R_{o 1}$ can be determined using the expression for $R_{o}$ of a CS transistor with an emitter-degeneration resistance (Eq. 8.60) to obtain

$$
R_{o 1}=2 R_{S S}+r_{o 1}+\left(g_{m 1} r_{o 1}\right)\left(2 R_{S S}\right)
$$

Similar results can be obtained for $Q_{2}$, namely, the same $G_{m c m}$ and an output resistance $R_{o 2}$ given by

$$
R_{o 2}=2 R_{S S}+r_{o 2}+\left(g_{m 2} r_{o 2}\right)\left(2 R_{S S}\right)
$$

Returning to the circuit in Fig. 9.39(c), we see that the current mirror is represented by its input resistance $R_{i m}$, current gain $A_{m}$, and output resistance $R_{o m}$. This is a general representation that applies for any current mirror. As current mirrors have relatively low input resistances, $R_{i m}$ will be much lower than $R_{o 1}$ with the result that the input current of the mirror $i_{1}$ will be

$$
i_{i} \simeq G_{m c m} v_{i c m}
$$

The output voltage can be obtained by writing a node equation at the output,

$$
v_{o}=\left(A_{m} i_{i}-G_{m c m} v_{i c m}\right)\left(R_{o m} \| R_{o 2}\right)
$$


Figure 9.39 Analysis of the current-mirror-loaded MOS differential amplifier to determine its common-mode gain.

Substituting for $i_{i}$ from Eq. (9.151) results in the following expression for the common-mode gain:

$$
A_{c m} \equiv \frac{v_{o}}{v_{i c m}}=-\left(1-A_{m}\right) G_{m c m}\left(R_{o m} \| R_{o 2}\right)
$$

This is a general expression that applies for any implementation of the current mirror. The expression makes clear that $A_{c m}$ results from the deviation from unity of the current gain of the mirror.
For the simple current mirror utilized in the circuit of Fig. 9.39(a),

$$
R_{i m}=\frac{1}{g_{m 3}} \| r_{o 3}
$$

and

$$
R_{o m}=r_{o 4}
$$

The current gain $A_{m}$ can be found as follows

$$
A_{m} i_{i}=-g_{m 4} v_{g s 4}=-g_{m 4} v_{g s 3}
$$

but

$$
v_{g s 3}=-i_{i} R_{i m}
$$

Thus

$$
A_{m}=g_{m 4} R_{i m}
$$

Substituting for $R_{i m}$ from (9.154) together with using $g_{m 4}=g_{m 3}$ results in

$$
A_{m}=1 /\left(1+\frac{1}{g_{m 3} r_{o 3}}\right)
$$

Finally, substituting in Eq. (9.153) for $A_{m}$ from (9.156), for $G_{m c m}$ from (9.148), and for $R_{o m}$ from (9.155), and noting that $r_{o 4} \ll R_{o 2}, r_{o 4}=r_{o 3}$, and $g_{m} r_{o 3} \ll 1$, gives for $A_{c m}$ the expression,

$$
A_{c m} \simeq-\frac{1}{2 g_{m 3} R_{S S}}
$$

Since $R_{S S}$ is usually large, at least equal to $r_{o}, A_{c m}$ will be small. The common-mode rejection ratio (CMRR) can now be obtained by utilizing Eqs. (9.130) and (9.157),

$$
\operatorname{CMRR} \equiv \frac{\left|A_{d}\right|}{\left|A_{c m}\right|}=\left[g_{m}\left(r_{o 2} \| r_{o 4}\right)\right]\left[2 g_{m 3} R_{S S}\right]
$$

which for $r_{o 2}=r_{o 4}=r_{o}$ and $g_{m 3}=g_{m}$ simplifies to

$$
\mathrm{CMRR}=\left(g_{m} r_{o}\right)\left(g_{m} R_{S S}\right)
$$

We observe that to obtain a large CMRR, we select an implementation of the biasing current source $I$ that features a high output resistance. Such circuits include the cascode current source and the Wilson current source studied in Section 8.6.

# EXERCISE 

9.20 For the current-mirror-loaded MOS differential amplifier specified in Exercise 9.17, let $R_{S S}=25 \mathrm{k} \Omega$. Calculate $\left|A_{c m}\right|$ and CMRR. Use the results of Exercise 9.17.
Ans. $0.005 \mathrm{~V} / \mathrm{V} ; 20,000$ or 86 dB
The Bipolar Case To obtain $A_{c m}$ and CMRR for the BJT circuit of Fig. 9.36(a) we can use the expression in Eq. (9.153) with

$$
\begin{gathered}
G_{m c m}=\frac{1}{2 R_{E E}} \\
R_{i m}=\frac{1}{g_{m 3}}\left\|r_{\pi 3}\right\| r_{o 3} \| r_{\pi 4}
\end{gathered}
$$

which for $r_{o 3} \gg r_{\pi 3}$ and $r_{\pi 4}=r_{\pi 3}$ yields

$$
\begin{gathered}
R_{i m} \simeq \frac{1}{g_{m 3}} \| \frac{2}{r_{\pi 3}} \\
R_{o m}=r_{o 4}
\end{gathered}
$$

and

$$
A_{m}=g_{m 4} R_{i m}
$$

Assuming $g_{m 4}=g_{m 3}$ and utilizing $r_{o 4} \gg R_{o 2}$, we obtain

$$
\begin{aligned}
A_{c m} & \simeq-\frac{r_{o 4}}{2 R_{E E}} \frac{\frac{2}{r_{\pi 3}}}{g_{m 3}+\frac{2}{r_{\pi 3}}} \\
& \simeq-\frac{r_{o 4}}{2 R_{E E}} \frac{2}{\beta_{3}}=-\frac{r_{o 4}}{\beta_{3} R_{E E}}
\end{aligned}
$$

Using $A_{d}$ from Eq. (9.139) enables us to obtain the CMRR as

$$
\mathrm{CMRR} \equiv \frac{\left|A_{d}\right|}{\left|A_{c m}\right|}=g_{m}\left(r_{o 2} \| r_{o 4}\right)\left(\frac{\beta_{3} R_{E E}}{r_{o 4}}\right)
$$

For $r_{o 2}=r_{o 4}=r_{o}$,

$$
\mathrm{CMRR}=\frac{1}{2} \beta_{3} g_{m} R_{E E}
$$

from which we observe that to obtain a large CMRR, the circuit implementing the bias current source should have a large output resistance $R_{E E}$. This is possible with, say, a Wilson current mirror (Section 8.6.2).

In conclusion, it is useful to reflect once more on the origin of the finite common-mode gain: It is simply due to the current transmission error introduced by the current-mirror load. In the case of the MOS circuit, this error is due to the finite $r_{o 3}$; in the case of the bipolar mirror, the error is due to the finite $\beta$.

# EXERCISE 

9.21 For the current-mirror-loaded BJT differential amplifier specified in Exercise 9.18, find $R_{E E}, A_{c m}$, and CMRR. Use the results of Exercise 9.18.
Ans. $125 \mathrm{k} \Omega ; 0.0125 \mathrm{~V} / \mathrm{V} ; 160,000$, or 104 dB
# 9.6 Multistage Amplifiers 

Practical transistor amplifiers usually consist of a number of stages connected in cascade. In addition to providing gain, the first (or input) stage is usually required to provide a high input resistance in order to avoid loss of signal level when the amplifier is fed from a high-resistance source. In a differential amplifier the input stage must also provide large common-mode rejection. The function of the middle stages of an amplifier cascade is to provide the bulk of the voltage gain. In addition, the middle stages provide such other functions as the conversion of the signal from differential mode to single-ended mode (unless, of course, the amplifier output also is differential) and the shifting of the dc level of the signal in order to allow the output signal to swing both positive and negative. These two functions and others will be illustrated later in this section and in greater detail in Chapter 13.

Finally, the main function of the last (or output) stage of an amplifier is to provide a low output resistance in order to avoid loss of gain when a low-valued load resistance is connected to the amplifier. Also, the output stage should be able to supply the current required by the load in an efficient manner-that is, without dissipating an unduly large amount of power in the output transistors. We have already studied one type of amplifier configuration suitable for implementing output stages, namely, the source follower and the emitter follower. It will be shown in Chapter 12 that the source and emitter followers are not optimum from the point of view of power efficiency and that other, more appropriate circuit configurations exist for output stages that are required to supply large amounts of output power. In fact, we will encounter some such output stages in the op-amp circuit examples studied in Chapter 13.

To illustrate the circuit structure and the method of analysis of multistage amplifiers, we will present two examples: a two-stage CMOS op amp and a four-stage bipolar op amp.

## THE INTERNATIONAL SOLID-STATE CIRCUITS CONFERENCE (ISSCC):

The year 2013 marked the sixtieth appearance of the International Solid-State Circuits Conference (ISSCC), which has become the foremost global forum for the presentation of novel developments in the broad field of solid-state circuits and systems. Sponsored by the Institute of Electrical and Electronics Engineers, ISSCC began in 1954 at the University of Pennsylvania in Philadelphia and eventually migrated to Silicon Valley with meetings annually in San Francisco since 1990.

In the early 1950s, shortly after the invention of the transistor, many of the large vacuum-tube-dependent electronics companies (e.g., GE, RCA) realized the potentially dramatic importance of these new amplifying devices. But eager as they were to create new transistor-based designs, they were quickly stymied by the lack of qualified engineers with appropriate background. In fact, Bell Labs was the only group with experience. Thus, a novel solution was needed, one in which limited expertise can be shared among multiple interested research and development entities. Thus, the first "Transistor Conference," the precursor of ISSCC, was born. Clearly, this was an idea that worked!

### 9.6.1 A Two-Stage CMOS Op Amp

Figure 9.40 shows a popular structure for CMOS op amps known as the two-stage configuration. The circuit utilizes two power supplies, which can range from $\pm 2.5 \mathrm{~V}$ for


Figure 9.40 Two-stage CMOS op-amp configuration.
the $0.5-\mu \mathrm{m}$ technology down to $\pm 0.5 \mathrm{~V}$ for the $65-\mathrm{nm}$ technology. A reference bias current $I_{\text {REF }}$ is generated either externally or using on-chip circuits. One such circuit will be discussed in Chapter 13. The current mirror formed by $Q_{8}$ and $Q_{5}$ supplies the differential pair $Q_{1}-Q_{2}$ with bias current. The $W / L$ ratio of $Q_{5}$ is selected to yield the desired value for the input-stage bias current $I$ (or $I / 2$ for each of $Q_{1}$ and $Q_{2}$ ). The input differential pair is actively loaded with the current mirror formed by $Q_{3}$ and $Q_{4}$. Thus the input stage is identical to that studied in Section 9.5 (except that here the differential pair is implemented with PMOS transistors and the current mirror with NMOS).

The second stage consists of $Q_{6}$, which is a common-source amplifier loaded with the current-source transistor $Q_{7}$. A capacitor $C_{C}$ is included in the negative-feedback path of the second stage. Its function will be explained in Chapter 13, when we study the frequency response of this amplifier.

A striking feature of the circuit in Fig. 9.40 is that it does not have a low-output-resistance stage. In fact, the output resistance of the circuit is equal to $\left(r_{o b} \| r_{o 7}\right)$ and is thus rather high. This circuit, therefore, is not suitable for driving low-impedance loads. Nevertheless, the circuit is very popular and is used frequently for implementing op amps in VLSI circuits, where the op amp needs to drive only a small capacitive load, for example, in switched-capacitor circuits (Chapter 17). The simplicity of the circuit results in an op amp of reasonably good quality realized in a very small chip area.

Voltage Gain The voltage gain of the first stage was found in Section 9.5 to be given by

$$
A_{1}=-g_{m 1}\left(r_{o 2} \| r_{o 4}\right)
$$
where $g_{m 1}$ is the transconductance of each of the transistors of the first stage, that is, $Q_{1}$ and $Q_{2}$.

The second stage is a current-source-loaded, common-source amplifier whose voltage gain is given by

$$
A_{2}=-g_{m 6}\left(r_{o 6} \| r_{o 7}\right)
$$

The dc open-loop gain of the op amp is the product of $A_{1}$ and $A_{2}$.

# Example 9.6 

Consider the circuit in Fig. 9.40 with the following device geometries (in $\mu \mathrm{m}$ ).

| Transistor | $\mathbf{Q}_{\mathbf{1}}$ | $\mathbf{Q}_{\mathbf{2}}$ | $\mathbf{Q}_{\mathbf{3}}$ | $\mathbf{Q}_{\mathbf{4}}$ | $\mathbf{Q}_{\mathbf{5}}$ | $\mathbf{Q}_{\mathbf{6}}$ | $\mathbf{Q}_{\mathbf{7}}$ | $\mathbf{Q}_{\mathbf{8}}$ |
| :-- | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| $W / L$ | $20 / 0.8$ | $20 / 0.8$ | $5 / 0.8$ | $5 / 0.8$ | $40 / 0.8$ | $10 / 0.8$ | $40 / 0.8$ | $40 / 0.8$ |

Let $I_{\mathrm{REF}}=90 \mu \mathrm{~A}, V_{i n}=0.7 \mathrm{~V}, V_{i p}=-0.8 \mathrm{~V}, \mu_{a} C_{o s}=160 \mu \mathrm{~A} / \mathrm{V}^{2}, \mu_{g} C_{o s}=40 \mu \mathrm{~A} / \mathrm{V}^{2},\left|V_{A}\right|$ (for all devices) $=10 \mathrm{~V}, V_{D D}=V_{S S}=2.5 \mathrm{~V}$. For all devices, evaluate $I_{D},\left|V_{O V}\right|,\left|V_{G S}\right|, g_{m}$, and $r_{o}$. Also find $A_{1}, A_{2}$, the dc open-loop voltage gain, the input common-mode range, and the output voltage range. Neglect the effect of $V_{A}$ on bias current.

## Solution

Refer to Fig. 9.40. Since $Q_{8}$ and $Q_{5}$ are matched, $I=I_{\mathrm{REF}}$. Thus $Q_{1}, Q_{2}, Q_{3}$, and $Q_{4}$ each conducts a current equal to $I / 2=45 \mu \mathrm{~A}$. Since $Q_{7}$ is matched to $Q_{5}$ and $Q_{8}$, the current in $Q_{7}$ is equal to $I_{\mathrm{REF}}=90 \mu \mathrm{~A}$. Finally, $Q_{6}$ conducts an equal current of $90 \mu \mathrm{~A}$.

With $I_{D}$ of each device known, we use

$$
I_{D}=\frac{1}{2}\left(\mu C_{o s}\right)(W / L) V_{O V}^{2}
$$

to determine $\left|V_{O V}\right|$ for each transistor. Then we find $\left|V_{G S}\right|$ from $\left|V_{G S}\right|=\left|V_{i}\right|+\left|V_{O V}\right|$. The results are given in Table 9.1.

The transconductance of each device is determined from

$$
g_{m}=2 I_{D} /\left|V_{O V}\right|
$$

The value of $r_{o}$ is determined from

$$
r_{o}=\left|V_{A}\right| / I_{D}
$$

The resulting values of $g_{m}$ and $r_{o}$ are given in Table 9.1.# Example 9.6 continued 

Table 9.1

|  | $Q_{1}$ | $Q_{2}$ | $Q_{3}$ | $Q_{4}$ | $Q_{5}$ | $Q_{6}$ | $Q_{7}$ | $Q_{8}$ |
| :-- | --: | --: | --: | --: | --: | --: | --: | --: |
| $I_{D}(\mu \mathrm{~A})$ | 45 | 45 | 45 | 45 | 90 | 90 | 90 | 90 |
| $\left\lvert\, V_{D V}\right.$ (V) | 0.3 | 0.3 | 0.3 | 0.3 | 0.3 | 0.3 | 0.3 | 0.3 |
| $\left\lvert\, V_{G S}\right.$ (V) | 1.1 | 1.1 | 1 | 1 | 1.1 | 1 | 1.1 | 1.1 |
| $g_{m}(\mathrm{~mA} / \mathrm{V})$ | 0.3 | 0.3 | 0.3 | 0.3 | 0.6 | 0.6 | 0.6 | 0.6 |
| $r_{o}(\mathrm{k} \Omega)$ | 222 | 222 | 222 | 222 | 111 | 111 | 111 | 111 |

The voltage gain of the first stage is determined from

$$
\begin{aligned}
A_{1} & =-g_{m 1}\left(r_{o 2} \| r_{o 4}\right) \\
& =-0.3(222 \| 222)=-33.3 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

The voltage gain of the second stage is determined from

$$
\begin{aligned}
A_{2} & =-g_{m 6}\left(r_{o 6} \| r_{o 7}\right) \\
& =-0.6(111 \| 111)=-33.3 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

Thus the overall dc open-loop gain is

$$
A_{0}=A_{1} A_{2}=(-33.3) \times(-33.3)=1109 \mathrm{~V} / \mathrm{V}
$$

or

$$
20 \log 1109=61 \mathrm{~dB}
$$

The lower limit of the input common-mode range is the value of input voltage at which $Q_{1}$ and $Q_{2}$ leave the saturation region. This occurs when the input voltage falls below the voltage at the drain of $Q_{1}$ by $\left|V_{i p}\right|$ volts. Since the drain of $Q_{1}$ is at $-2.5+1=-1.5 \mathrm{~V}$, then the lower limit of the input common-mode range is -2.3 V .

The upper limit of the input common-mode range is the value of input voltage at which $Q_{5}$ leaves the saturation region. Since for $Q_{5}$ to operate in saturation the voltage across it (i.e., $V_{S D 5}$ ) should at least be equal to the overdrive voltage at which it is operating (i.e., 0.3 V ), the highest voltage permitted at the drain of $Q_{5}$ should be +2.2 V . It follows that the highest value of $v_{I C M}$ should be

$$
v_{I C M \max }=2.2-1.1=1.1 \mathrm{~V}
$$

The highest allowable output voltage is the value at which $Q_{3}$ leaves the saturation region, which is $V_{D D}-\left|V_{D V 7}\right|=2.5-0.3=2.2 \mathrm{~V}$. The lowest allowable output voltage is the value at which $Q_{6}$ leaves saturation, which is $-V_{S S}+V_{D V 6}=-2.5+0.3=-2.2 \mathrm{~V}$. Thus, the output voltage range is -2.2 V to +2.2 V .
Input Offset Voltage The device mismatches inevitably present in the input stage give rise to an input offset voltage. The components of this input offset voltage can be calculated using the methods developed in Section 9.4.1. Because device mismatches are random, the resulting offset voltage is referred to as random offset. This is to distinguish it from another type of input offset voltage that can be present even if all appropriate devices are perfectly matched. This predictable or systematic offset can be minimized by careful design. Although it occurs also in BJT op amps, and we have encountered it in Section 9.5.4, it is usually much more pronounced in CMOS op amps because their gain-per-stage is rather low.

To see how systematic offset can occur in the circuit of Fig. 9.40, let the two input terminals be grounded. If the input stage is perfectly balanced, then the voltage appearing at the drain of $Q_{4}$ will be equal to that at the drain of $Q_{3}$, which is $\left(-V_{S S}+V_{G S 4}\right)$. Now this is also the voltage that is fed to the gate of $Q_{6}$. In other words, a voltage equal to $V_{G S 4}$ appears between gate and source of $Q_{6}$. Thus the drain current of $Q_{6}, I_{6}$, will be related to the drain current of $Q_{4}$, which is equal to $I / 2$, by the relationship

$$
I_{6}=\frac{(W / L)_{6}}{(W / L)_{4}}(I / 2)
$$

In order for no offset voltage to appear at the output, this current must be exactly equal to the current supplied by $Q_{7}$. The latter current is related to the current $I$ of the parallel transistor $Q_{5}$ by

$$
I_{7}=\frac{(W / L)_{7}}{(W / L)_{5}} I
$$

Now, the condition for making $I_{6}=I_{7}$ can be found from Eqs. (9.170) and (9.171) as

$$
\frac{(W / L)_{6}}{(W / L)_{4}}=2 \frac{(W / L)_{7}}{(W / L)_{5}}
$$

If this condition is not met, a systematic offset will result. From the specification of the device geometries in Example 9.6, we can verify that condition (9.172) is satisfied, and, therefore, the op amp analyzed in that example should not exhibit a systematic input offset voltage.

# EXERCISE 

9.22 Consider the CMOS op amp of Fig. 9.40 when fabricated in a $0.8-\mu \mathrm{m}$ CMOS technology for which $\mu_{n} C_{o s}=3 \mu_{n} C_{o s}=90 \mu \mathrm{~A} / \mathrm{V}^{3},\left|V_{s}\right|=0.8 \mathrm{~V}$, and $V_{D D}=V_{S S}=2.5 \mathrm{~V}$. For a particular design, $I=100 \mu \mathrm{~A}$, $(W / L)_{1}=(W / L)_{2}=(W / L)_{3}=200$, and $(W / L)_{3}=(W / L)_{4}=100$.
(a) Find the $(W / L)$ ratios of $Q_{6}$ and $Q_{7}$ so that $I_{6}=100 \mu \mathrm{~A}$.
(b) Find the overdrive voltage, $\left|V_{O V}\right|$, at which each of $Q_{1}, Q_{2}$, and $Q_{6}$ is operating.
(c) Find $g_{m}$ for $Q_{1}, Q_{2}$, and $Q_{6}$.
(d) If $\left|V_{A}\right|=10 \mathrm{~V}$, find $r_{o 2}, r_{o 4}, r_{o 6}$, and $r_{o 7}$.
(e) Find the voltage gains $A_{1}$ and $A_{2}$, and the overall gain $A$.

Ans. (a) $(W / L)_{6}=(W / L)_{7}=200$; (b) $0.129 \mathrm{~V}, 0.129 \mathrm{~V}, 0.105 \mathrm{~V}$; (c) $0.775 \mathrm{~mA} / \mathrm{V}, 0.775 \mathrm{~mA} / \mathrm{V}$, $1.90 \mathrm{~mA} / \mathrm{V}$; (d) $200 \mathrm{k} \Omega, 200 \mathrm{k} \Omega, 100 \mathrm{k} \Omega, 100 \mathrm{k} \Omega$; (e) $-77.5 \mathrm{~V} / \mathrm{V},-95 \mathrm{~V} / \mathrm{V}, 7363 \mathrm{~V} / \mathrm{V}$
# 9.6.2 A Bipolar Op Amp 

Our second example of multistage amplifiers is the four-stage bipolar op amp shown in Fig. 9.41. The circuit consists of four stages. The differential-in, differential-out input stage consists of transistors $Q_{1}$ and $Q_{2}$, which are biased by current source $Q_{3}$. The second stage is also a differential-input amplifier, but its output is taken single-endedly at the collector of $Q_{5}$. This stage is formed by $Q_{4}$ and $Q_{5}$, which are biased by the current source $Q_{6}$. Note that the conversion from differential to single-ended as performed by the second stage results in a loss of gain by a factor of 2 . In the more elaborate method for accomplishing this conversion studied in Section 9.5, a current mirror was used as an active load.

In addition to providing some voltage gain, the third stage, consisting of the pnp transistor $Q_{7}$, provides the essential function of shifting the dc level of the signal. Thus, while the signal at the collector of $Q_{5}$ is not allowed to swing below the voltage at the base of $Q_{5}(+10 \mathrm{~V})$, the signal at the collector of $Q_{7}$ can swing negatively (and positively, of course). From our study of op amps in Chapter 2, we know that the output terminal of the op amp should be capable of both positive and negative voltage swings. Therefore every op-amp circuit includes a level-shifting arrangement. Although the use of the complementary pnp transistor provides a simple solution to the level-shifting problem, other forms of level shifter exist, one of which


Figure 9.41 A four-stage bipolar op amp.
will be discussed in Chapter 13. Furthermore, note that level shifting is accomplished in the CMOS op amp we have studied in Section 9.6.1 by using complementary devices for the two stages: that is, $p$-channel for the first stage and $n$-channel for the second stage.

The output stage of the op amp consists of emitter follower $Q_{8}$. As we know from our study of op amps in Chapter 2, ideally the output operates around zero volts. This and other features of the BJT op amp will be illustrated in Example 9.7.

# Example 9.7 

In this example, we analyze the dc bias of the bipolar op-amp circuit of Fig. 9.41. Toward that end, Fig. 9.42 shows the circuit with the two input terminals connected to ground.
(a) Perform an approximate dc analysis (assuming $\beta \gg 1,\left|V_{B E}\right| \simeq 0.7 \mathrm{~V}$, and neglecting the Early effect) to calculate the dc currents and voltages everywhere in the circuit. Note that $Q_{8}$ has four times the area of each of $Q_{9}$ and $Q_{3}$.
(b) Calculate the quiescent power dissipation in this circuit.
(c) If transistors $Q_{1}$ and $Q_{2}$ have $\beta=100$, calculate the input bias current of the op amp.
(d) What is the input common-mode range of this op amp?


Figure 9.42 Circuit for Example 9.7.
# Example 9.7 continued 

## Solution

(a) The values of all dc currents and voltages are indicated on the circuit diagram. These values were calculated by ignoring the base current of every transistor-that is, by assuming $\beta$ to be very high. The analysis starts by determining the current through the diode-connected transistor $Q_{\mathrm{tr}}$ to be 0.5 mA . Then we see that transistor $Q_{3}$ conducts 0.5 mA and transistor $Q_{\mathrm{k}}$ conducts 2 mA . The current-source transistor $Q_{3}$ feeds the differential pair $\left(Q_{1}, Q_{2}\right)$ with 0.5 mA . Thus each of $Q_{1}$ and $Q_{2}$ will be biased at 0.25 mA . The collectors of $Q_{1}$ and $Q_{2}$ will be at $[+15-0.25 \times 20]=+10 \mathrm{~V}$.

Proceeding to the second differential stage formed by $Q_{4}$ and $Q_{5}$, we find the voltage at their emitters to be $[+10-0.7]=9.3 \mathrm{~V}$. This differential pair is biased by the current-source transistor $Q_{\mathrm{k}}$, which supplies a current of 2 mA ; thus $Q_{4}$ and $Q_{5}$ will each be biased at 1 mA . We can now calculate the voltage at the collector of $Q_{5}$ as $[+15-1 \times 3]=+12 \mathrm{~V}$. This will cause the voltage at the emitter of the pnp transistor $Q_{7}$ to be +12.7 V , and the emitter current of $Q_{7}$ will be $(+15-12.7) / 2.3=1 \mathrm{~mA}$.

The collector current of $Q_{7}, 1 \mathrm{~mA}$, causes the voltage at the collector to be $[-15+1 \times 15.7]=+0.7 \mathrm{~V}$. The emitter of $Q_{8}$ will be 0.7 V below the base; thus output terminal 3 will be at 0 V . Finally, the emitter current of $Q_{8}$ can be calculated to be $[0-(-15)] / 3=5 \mathrm{~mA}$.
(b) To calculate the power dissipated in the circuit in the quiescent state (i.e., with zero input signal) we simply evaluate the dc current that the circuit draws from each of the two power supplies. From the +15 V supply the dc current is $I^{+}=0.25+0.25+1+1+1+5=8.5 \mathrm{~mA}$. Thus the power supplied by the positive power supply is $P^{+}=15 \times 8.5=127.5 \mathrm{~mW}$. The $-15-\mathrm{V}$ supply provides a current $I^{-}$given by $I^{-}=0.5+0.5+2+1+5=9 \mathrm{~mA}$. Thus the power provided by the negative supply is $P^{-}=15 \times$ $9=135 \mathrm{~mW}$. Adding $P^{+}$and $P^{-}$provides the total power dissipated in the circuit $P_{D}: P_{D}=P^{+}+P^{-}=$ 262.5 mW .
(c) The input bias current of the op amp is the average of the dc currents that flow in the two input terminals (i.e., in the bases of $Q_{1}$ and $Q_{2}$ ). These two currents are equal (because we have assumed matched devices); thus the bias current is given by

$$
I_{B}=\frac{I_{E 1}}{\beta+1} \simeq 2.5 \mu \mathrm{~A}
$$

(d) The upper limit on the input common-mode voltage is determined by the voltage at which $Q_{1}$ and $Q_{2}$ leave the active mode and enter saturation. This will happen if the input voltage exceeds the collector voltage, which is +10 V , by about 0.4 V . Thus the upper limit of the common-mode range is +10.4 V .

The lower limit of the input common-mode range is determined by the voltage at which $Q_{3}$ leaves the active mode and thus ceases to act as a constant-current source. This will happen if the collector voltage of $Q_{3}$ goes below the voltage at its base, which is -14.3 V , by more than 0.4 V . It follows that the input common-mode voltage should not go lower than $-14.7+0.7=-14 \mathrm{~V}$. Thus the common-mode range is -14 V to +10.4 V .

## Example 9.8

Use the dc bias quantities evaluated in Example 9.7 to analyze the circuit in Fig. 9.41 to determine the input resistance, the voltage gain, and the output resistance.
# Solution 

The input differential resistance $R_{i d}$ is given by

$$
R_{i d}=r_{\pi 1}+r_{\pi 2}
$$

Since each of $Q_{1}$ and $Q_{2}$ is operating at an emitter current of 0.25 mA , it follows that

$$
r_{e 1}=r_{e 2}=\frac{25}{0.25}=100 \Omega
$$

Assume $\beta=100$; then

$$
r_{\pi 1}=r_{\pi 2}=101 \times 100=10.1 \mathrm{k} \Omega
$$

Thus,

$$
R_{i d}=20.2 \mathrm{k} \Omega
$$

To evaluate the gain of the first stage, we first find the input resistance of the second stage, $R_{i 2}$,

$$
R_{i 2}=r_{\pi 4}+r_{\pi 5}
$$

$Q_{4}$ and $Q_{5}$ are each operating at an emitter current of 1 mA ; thus

$$
\begin{aligned}
& r_{e 4}=r_{e 5}=25 \Omega \\
& r_{\pi 4}=r_{\pi 5}=101 \times 25=2.525 \mathrm{k} \Omega
\end{aligned}
$$

Thus $R_{i 2}=5.05 \mathrm{k} \Omega$. This resistance appears between the collectors of $Q_{1}$ and $Q_{2}$, as shown in Fig. 9.43. Thus the gain of the first stage will be

$$
\begin{aligned}
A_{1} & \equiv \frac{v_{e 1}}{v_{i d}} \simeq \frac{\text { Total resistance in collector circuit }}{\text { Total resistance in emitter circuit }} \\
& =\frac{R_{i 2} \|\left(R_{1}+R_{2}\right)}{r_{e 1}+r_{e 2}} \\
& =\frac{5.05 \mathrm{k} \Omega \| 40 \mathrm{k} \Omega}{200 \Omega}=22.4 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$



Figure 9.43 Equivalent circuit for calculating the gain of the input stage of the amplifier in Fig. 9.41.
# Example 9.8 continued 



Figure 9.44 Equivalent circuit for calculating the gain of the second stage of the amplifier in Fig. 9.41.

Figure 9.44 shows an equivalent circuit for calculating the gain of the second stage. As indicated, the input voltage to the second stage is the output voltage of the first stage, $v_{o 1}$. Also shown is the resistance $R_{i 3}$, which is the input resistance of the third stage formed by $Q_{3}$. The value of $R_{i 3}$ can be found by multiplying the total resistance in the emitter of $Q_{3}$ by $(\beta+1)$ :

$$
R_{i 3}=(\beta+1)\left(R_{4}+r_{e 3}\right)
$$

Since $Q_{3}$ is operating at an emitter current of 1 mA ,

$$
\begin{aligned}
& r_{e 3}=\frac{25}{1}=25 \Omega \\
& R_{i 3}=101 \times 2.325=234.8 \mathrm{k} \Omega
\end{aligned}
$$

We can now find the gain $A_{2}$ of the second stage as the ratio of the total resistance in the collector circuit to the total resistance in the emitter circuit:

$$
\begin{aligned}
A_{2} & \equiv \frac{v_{o 2}}{v_{o 1}} \simeq-\frac{R_{3} \| R_{i 3}}{r_{e 4}+r_{e 5}} \\
& =-\frac{3 \mathrm{k} \Omega \| 234.8 \mathrm{k} \Omega}{50 \Omega}=-59.2 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

To obtain the gain of the third stage we refer to the equivalent circuit shown in Fig. 9.45, where $R_{i 4}$ is the input resistance of the output stage formed by $Q_{8}$. Using the resistance-reflection rule, we calculate the value of $R_{i 4}$ as

$$
R_{i 4}=(\beta+1)\left(r_{e 8}+R_{6}\right)
$$
where

$$
\begin{aligned}
r_{e 8} & =\frac{25}{5}=5 \Omega \\
R_{i 4} & =101(5+3000)=303.5 \mathrm{k} \Omega
\end{aligned}
$$

The gain of the third stage is given by

$$
\begin{aligned}
A_{3} & \equiv \frac{v_{o 2}}{v_{o 2}} \simeq-\frac{R_{5} \| R_{i 4}}{r_{e 7}+R_{4}} \\
& =-\frac{15.7 \mathrm{k} \Omega \| 303.5 \mathrm{k} \Omega}{2.325 \mathrm{k} \Omega}=-6.42 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$



Figure 9.45 Equivalent circuit for evaluating the gain of the third stage in the amplifier circuit of Fig. 9.41.


Figure 9.46 Equivalent circuit of the output stage of the amplifier circuit of Fig. 9.41.
# Example 9.8 continued 

Finally, to obtain the gain $A_{4}$ of the output stage we refer to the equivalent circuit in Fig. 9.46 and write

$$
\begin{aligned}
A_{4} & \equiv \frac{v_{o}}{v_{e 3}}=\frac{R_{6}}{R_{6}+r_{e 8}} \\
& =\frac{3000}{3000+5}=0.998 \simeq 1
\end{aligned}
$$

The overall voltage gain of the amplifier can then be obtained as follows:

$$
\frac{v_{o}}{v_{i d}}=A_{1} A_{2} A_{3} A_{4}=8513 \mathrm{~V} / \mathrm{V}
$$

or 78.6 dB .
To obtain the output resistance $R_{o}$ we "grab hold" of the output terminal in Fig. 9.41 and look back into the circuit. By inspection we find

$$
R_{o}=R_{6} \|\left[r_{e 8}+R_{5} /(\beta+1)\right]
$$

which gives

$$
R_{o}=152 \Omega
$$

## EXERCISE

9.23 Use the results of Example 9.8 to calculate the overall voltage gain of the amplifier in Fig. 9.41 when it is connected to a source having a resistance of $10 \mathrm{k} \Omega$ and a load of $1 \mathrm{k} \Omega$.
Ans. $4943 \mathrm{~V} / \mathrm{V}$

Analysis Using Current Gains There is an alternative method for the analysis of bipolar multistage amplifiers that can be somewhat easier to perform in some cases. The method makes use of current gains or more appropriately current-transmission factors. In effect, one traces the transmission of the signal current throughout the amplifier cascade, evaluating all the current transmission factors in turn. We shall illustrate the method by using it to analyze the amplifier circuit of the preceding example.


Figure 9.47 The circuit of the multistage amplifier of Fig. 9.41 prepared for small-signal analysis. Indicated are the signal currents throughout the amplifier and the input resistances of the four stages.

Figure 9.47 shows the amplifier circuit prepared for small-signal analysis. We have indicated on the circuit diagram the signal currents through all the circuit branches. Also indicated are the input resistances of all four stages of the amplifier. These should be evaluated before commencing the following analysis.

The purpose of the analysis is to determine the overall voltage gain $\left(v_{o} / v_{i d}\right)$. Toward that end, we express $v_{o}$ in terms of the signal current in the emitter of $Q_{8}, i_{e 8}$, and $v_{i d}$ in terms of the input signal current $i_{i}$, as follows:

$$
\begin{aligned}
v_{o} & =R_{6} i_{e 8} \\
v_{i d} & =R_{i 1} i_{i}
\end{aligned}
$$

Thus, the voltage gain can be expressed in terms of the current gain $\left(i_{e 8} / i_{i}\right)$ as

$$
\frac{v_{o}}{v_{i d}}=\frac{R_{6}}{R_{i 1}} \frac{i_{e 8}}{i_{i}}
$$

Next, we expand the current gain $\left(i_{e 8} / i_{i}\right)$ in terms of the signal currents throughout the circuit as follows:

$$
\frac{i_{e 8}}{i_{i}}=\frac{i_{e 8}}{i_{b 8}} \times \frac{i_{b 8}}{i_{c 7}} \times \frac{i_{c 7}}{i_{b 7}} \times \frac{i_{b 7}}{i_{c 5}} \times \frac{i_{c 5}}{i_{b 5}} \times \frac{i_{b 5}}{i_{c 2}} \times \frac{i_{c 2}}{i_{i}}
$$

Each of the current-transmission factors on the right-hand side is either the current gain of a transistor or the ratio of a current divider. Thus, reference to Fig. 9.47 enables us to find thesefactors by inspection:

$$
\begin{aligned}
& \frac{i_{e 8}}{i_{b 8}}=\beta_{8}+1 \\
& \frac{i_{b 8}}{i_{c 7}}=\frac{R_{5}}{R_{5}+R_{i 4}} \\
& \frac{i_{e 7}}{i_{b 7}}=\beta_{7} \\
& \frac{i_{b 7}}{i_{c 5}}=\frac{R_{3}}{R_{3}+R_{i 3}} \\
& \frac{i_{c 5}}{i_{b 5}}=\beta_{5} \\
& \frac{i_{b 5}}{i_{c 2}}=\frac{\left(R_{1}+R_{2}\right)}{\left(R_{1}+R_{2}\right)+R_{i 2}} \\
& \frac{i_{e 2}}{i_{i}}=\beta_{2}
\end{aligned}
$$

These ratios can be easily evaluated and their values used to determine the voltage gain.
With a little practice, it is possible to carry out such an analysis very quickly, foregoing explicitly labeling the signal currents on the circuit diagram. One simply "walks through" the circuit, from input to output, or vice versa, determining the current-transmission factors one at a time, in a chainlike fashion.

# EXERCISE 

9.24 Use the values of input resistance found in Example 9.8 to evaluate the seven current-transmission factors and hence the overall current gain and voltage gain.
Ans. The current-transmission factors in the order of their listing are 101, 0.0492, 100, 0.0126, 100, $0.8879,100 \mathrm{~A} / \mathrm{A}$; the overall current gain is $55599 \mathrm{~A} / \mathrm{A}$; the voltage gain is $8257 \mathrm{~V} / \mathrm{V}$. This value differs slightly from that found in Example 9.8, because of the various approximations made in the example (e.g., $\alpha \simeq 1$ ).

## Summary

- The differential-pair or differential-amplifier configuration is the most widely used building block in analog IC design. The input stage of every op amp is a differential amplifier.
- There are two reasons for preferring differential to single-ended amplifiers: Differential amplifiers are insensitive to interference, and they do not need bypass and coupling capacitors.
- For a MOS (bipolar) pair biased by a current source $I$, each device operates at a drain (collector, assuming $\alpha=1$ ) current of $I / 2$ and a corresponding overdrive voltage $V_{D V}$ (no counterpart in bipolar). Each device has $g_{m}=I / V_{D V}$ $\left(\alpha I / 2 V_{T}\right.$, for bipolar) and $r_{o}=\left|V_{A}\right| /(I / 2)$.
- With the two input terminals connected to a suitable dc voltage $V_{C M}$, the bias current $I$ of a perfectly symmetrical differential pair divides equally between the
two transistors of the pair, resulting in a zero voltage difference between the two drains (collectors). To steer the current completely to one side of the pair, a difference input voltage $v_{i d}$ of at least $\sqrt{2} V_{O V}\left(4 V_{T}\right.$ for bipolar) is needed.

- Superimposing a differential input signal $v_{i d}$ on the dc common-mode input voltage $V_{C M}$ such that $v_{I 1}=V_{C M}+$ $v_{i d} / 2$ and $v_{I 2}=V_{C M}-v_{i d} / 2$ causes a virtual signal ground to appear on the common-source (common-emitter) connection. In response to $v_{i d}$, the current in $Q_{1}$ increases by $g_{m} v_{i d} / 2$ and the current in $Q_{2}$ decreases by $g_{m} v_{i d} / 2$. Thus, voltage signals of $\pm g_{m}\left(R_{D} \| r_{e}\right) v_{i d} / 2$ develop at the two drains (collectors, with $R_{D}$ replaced by $R_{C}$ ). If the output voltage is taken single-endedly, that is, between one of the drains (collectors) and ground, a differential gain of $\frac{1}{2} g_{m}\left(R_{D} \| r_{e}\right)$ is realized. When the output is taken differentially, that is, between the two drains (collectors), the differential gain realized is twice as large: $g_{m}\left(R_{D} \| r_{e}\right)$.
- The analysis of a differential amplifier to determine differential gain, differential input resistance, frequency response of differential gain, and so on is facilitated by employing the differential half-circuit, which is a common-source (common-emitter) transistor biased at $I / 2$.
- An input common-mode signal $v_{i c m}$ gives rise to drain (collector) voltage signals that are ideally equal and given by $-v_{i c m}\left(R_{D} / 2 R_{S S}\right)\left[-v_{i c m}\left(R_{C} / 2 R_{E E}\right)\right.$ for the bipolar pair], where $R_{S S}\left(R_{E E}\right)$ is the output resistance of the current source that supplies the bias current $I$. When the output is taken single-endedly, a common-mode gain of magnitude $\left|A_{c m}\right|=R_{D} / 2 R_{S S}\left(R_{C} / 2 R_{E E}\right.$ for the bipolar case) results. Taking the output differentially results, in the perfectly matched case, in zero $A_{c m}$ (infinite CMRR). Mismatches between the two sides of the pair make $A_{c m}$ finite even when the output is taken differentially: A mismatch $\Delta R_{D}$ causes $\left|A_{c m}\right|=\left(R_{D} / 2 R_{S S}\right)\left(\Delta R_{D} / R_{D}\right)$; a mismatch $\Delta g_{m}$ causes $\left|A_{c m}\right|=\left(R_{D} / 2 R_{S S}\right)\left(\Delta g_{m} / g_{m}\right)$. Corresponding expressions apply for the bipolar pair.
- While the input differential resistance $R_{i d}$ of the MOS pair is infinite, that for the bipolar pair is only $2 r_{n}$ but can be increased to $2(\beta+1)\left(r_{e}+R_{e}\right)$ by including resistances
$R_{e}$ in the two emitters. The latter action, however, lowers $A_{d}$.
- Mismatches between the two sides of a differential pair result in a differential dc output voltage $V_{O}$ even when the two input terminals are tied together and connected to a dc voltage $V_{C M}$. This signifies the presence of an input offset voltage $V_{O S} \equiv V_{O} / A_{d}$. In a MOS pair there are three main sources for $V_{O S}$ :

$$
\begin{gathered}
\Delta R_{D} \Rightarrow V_{O S}=\frac{V_{O V}}{2} \frac{\Delta R_{D}}{R_{D}} \\
\Delta(W / L) \Rightarrow V_{O S}=\frac{V_{O V}}{2} \frac{\Delta(W / L)}{W / L} \\
\Delta V_{i} \Rightarrow V_{O S}=\Delta V_{i}
\end{gathered}
$$

For the bipolar pair there are two main sources:

$$
\begin{gathered}
\Delta R_{C} \Rightarrow V_{O S}=V_{T} \frac{\Delta R_{C}}{R_{C}} \\
\Delta I_{S} \Rightarrow V_{O S}=V_{T} \frac{\Delta I_{S}}{I_{S}}
\end{gathered}
$$

- A popular circuit in both MOS and bipolar analog ICs is the current-mirror-loaded differential pair. It realizes a high differential gain $A_{d}=g_{m}\left(R_{n \text { pair }} \| R_{n \text { mirror }}\right)$ and a low common-mode gain, $\left|A_{c m}\right|=1 / 2 g_{m 3} R_{S S}$ for the MOS circuit ( $r_{o d} / \beta_{3} R_{E E}$ for the bipolar circuit), as well as performing the differential-to-single-ended conversion with no loss of gain.
- The CMOS two-stage amplifier studied in Section 9.6.1 is intended for use as part of an IC system and thus is required to drive only small capacitive loads. Therefore it does not have an output stage with a low output resistance.
- A multistage amplifier typically consists of three or more stages: an input stage having a high input resistance, a reasonably high gain, and, if differential, a high CMRR; one or two intermediate stages that realize the bulk of the gain; and an output stage having a low output resistance. In designing and analyzing a multistage amplifier, the loading effect of each stage on the one that precedes it must be taken into account.
## Computer Simulation Problems

TIM Problems identified by the Multisim/PSpice icon are intended to demonstrate the value of using SPICE simulation to verify hand analysis and design, and to investigate important issues such as allowable signal swing and amplifier nonlinear distortion. Instructions to assist in setting up PSpice and Multisim simulations for all the indicated problems can be found in the corresponding files on the website. Note that if a particular parameter value is not specified in the problem statement, you are to make a reasonable assumption.

## Section 9.1: The MOS Differential Pair

9.1 For an NMOS differential pair with a common-mode voltage $V_{C M}$ applied, as showninFig. 9.2, let $V_{D D}=V_{S S}=1.0 \mathrm{~V}$, $k_{e}^{\prime}=0.4 \mathrm{~mA} / \mathrm{V}^{2},(W / L)_{1.2}=10, V_{t w}=0.4 \mathrm{~V}, I=0.16 \mathrm{~mA}$, $R_{D}=5 \mathrm{k} \Omega$, and neglect channel-length modulation.
(a) Find $V_{O V}$ and $V_{G S}$ for each transistor.
(b) For $V_{C M}=0$, find $V_{S}, I_{D 1}, I_{D 2}, V_{D 1}$, and $V_{D 2}$.
(c) Repeat (b) for $V_{C M}=+0.4 \mathrm{~V}$.
(d) Repeat (b) for $V_{C M}=-0.1 \mathrm{~V}$.
(e) What is the highest value of $V_{C M}$ for which $Q_{1}$ and $Q_{2}$ remain in saturation?
(f) If current source $I$ requires a minimum voltage of 0.2 V to operate properly, what is the lowest value allowed for $V_{S}$ and hence for $V_{C M}$ ?
9.2 For the PMOS differential amplifier shown in Fig. P9.2 let $V_{i p}=-0.8 \mathrm{~V}$ and $k_{p}^{\prime} W / L=4 \mathrm{~mA} / \mathrm{V}^{2}$. Neglect channel-length modulation.


Figure P9.2
(a) For $v_{G 1}=v_{G 2}=0 \mathrm{~V}$, find $\left|V_{O V}\right|$ and $V_{S G}$ for each of $Q_{1}$ and $Q_{2}$. Also find $V_{S}, V_{D 1}$, and $V_{D 2}$.
(b) If the current source requires a minimum voltage of 0.4 V , find the input common-mode range.
9.3 For the differential amplifier specified in Problem 9.1 let $v_{G 2}=0$ and $v_{G 1}=v_{o l}$. Find the value of $v_{o l}$ that corresponds to each of the following situations:
(a) $i_{D 1}=i_{D 2}=0.08 \mathrm{~mA}$; (b) $i_{D 1}=0.12 \mathrm{~mA}$ and $i_{D 2}=0.04 \mathrm{~mA}$;
(c) $i_{D 1}=0.16 \mathrm{~mA}$ and $i_{D 2}=0$ ( $Q_{2}$ just cuts off); (d) $i_{D 1}=0.04 \mathrm{~mA}$ and $i_{D 2}=0.12 \mathrm{~mA}$; (e) $i_{D 1}=0 \mathrm{~mA}\left(Q_{1}\right.$ just cuts off) and $i_{D 2}=0.16 \mathrm{~mA}$. For each case, find $v_{S}, v_{D 1}, v_{D 2}$, and $\left(v_{D 2}-v_{D 1}\right)$.
9.4 For the differential amplifier specified in Problem 9.2, let $v_{G 2}=0$ and $v_{G 1}=v_{o l}$. Find the range of $v_{o l}$ needed to steer the bias current from one side of the pair to the other. At each end of this range, give the value of the voltage at the common-source terminal and the drain voltages.
9.5 Consider the differential amplifier specified in Problem 9.1 with $G_{2}$ grounded and $v_{G 1}=v_{o l}$. Let $v_{o l}$ be adjusted to the value that causes $i_{D 1}=0.09 \mathrm{~mA}$ and $i_{D 2}=0.07 \mathrm{~mA}$. Find the corresponding values of $v_{G S 2}, v_{S}, v_{G S 1}$, and hence $v_{o l}$. What is the difference output voltage $v_{D 2}-v_{D 1}$ ? What is the voltage gain $\left(v_{D 2}-v_{D 1}\right) / v_{o l}$ ? What value of $v_{o l}$ results in $i_{D 1}=0.07 \mathrm{~mA}$ and $i_{D 2}=0.09 \mathrm{~mA}$ ?

D 9.6 Design the circuit in Fig. P9.6 to obtain a dc voltage of +0.1 V at each of the drains of $Q_{1}$ and $Q_{2}$ when $v_{G 1}=v_{G 2}=0 \mathrm{~V}$. Operate all transistors at $V_{O V}=0.15 \mathrm{~V}$


Figure P9.6

[^0]
[^0]:    TIM = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
and assume that for the process technology in which the circuit is fabricated, $V_{m}=0.4 \mathrm{~V}$ and $\mu_{w} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$. Neglect channel-length modulation. Determine the values of $R, R_{D}$, and the $W / L$ ratios of $Q_{1}, Q_{2}, Q_{3}$, and $Q_{4}$. What is the input common-mode voltage range for your design?
9.7 The table providing the answers to Exercise 9.3 shows that as the maximum input signal to be applied to the differential pair is increased, linearity is maintained at the same level by operating at a higher $V_{O V}$. If $\left|v_{o l}\right|_{\max }$ is to be 220 mV , use the data in the table to determine the required $V_{O V}$ and the corresponding values of $W / L$ and $g_{m}$.
9.8 Use Eq. (9.23) to show that if the term involving $v_{o l}^{2}$ is to be kept to a maximum value of $k$ then the maximum possible fractional change in the transistor current is given by

$$
\frac{\Delta I_{\max }}{I / 2}=2 \sqrt{k(1-k)}
$$

and the corresponding maximum value of $v_{o l}$ is given by

$$
v_{o l \max }=2 \sqrt{k} V_{O V}
$$

Evaluate both expressions for $k=0.01,0.1$, and 0.2 .
9.9 A MOS differential amplifier biased with a current source $I=200 \mu \mathrm{~A}$ is found to switch currents completely to one side of the pair when a difference signal $v_{o l}=0.3 \mathrm{~V}$ is applied. At what overdrive voltage will each of $Q_{1}$ and $Q_{2}$ be operating when $v_{o l}=0$ ? If $v_{o l}$ for full current switching is to be 0.5 V , what must the bias current $I$ be changed to?

D 9.10 Design the MOS differential amplifier of Fig. 9.5 to operate at $V_{O V}=0.25 \mathrm{~V}$ and to provide a transconductance $g_{m}$ of $1 \mathrm{~mA} / \mathrm{V}$. Specify the $W / L$ ratios and the bias current. The technology available provides $V_{t}=0.5 \mathrm{~V}$ and $\mu_{w} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$.
9.11 For the MOS differential pair in Fig. 9.5, specify the value of $v_{o l} \equiv v_{01}-v_{02}$, in terms of $V_{O V}$, that
(a) causes $i_{D 1}$ to increase by $10 \%$ above its equilibrium value of $I / 2$.
(b) makes $i_{D 1} / i_{D 2}=1.0 ; 2.0 ; 1.1 ; 1.01 ; 20$.
9.12 An NMOS differential amplifier is operated at a bias current $I$ of 0.2 mA and has a $W / L$ ratio of 32 , $\mu_{w} C_{o s}=200 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{A}=10 \mathrm{~V}$, and $R_{D}=10 \mathrm{k} \Omega$. Find $V_{O V}, g_{m}$, $r_{a}$, and $A_{d}$.

D 9.13 It is required to design an NMOS differential amplifier to operate with a differential input voltage that
can be as high as 0.1 V while keeping the nonlinear term under the square root in Eq. (9.23) to a maximum of 0.04 . A transconductance $g_{m}$ of $2 \mathrm{~mA} / \mathrm{V}$ is needed and the amplifier is required to provide a differential output signal of 1 V when the input is at its maximum value. Find the required values of $V_{O V}, I, R_{D}$, and $W / L$. Assume that the technology available has $\mu_{w} C_{o s}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $\lambda=0$.

D 9.14 Design a MOS differential amplifier to operate from $\pm 1-\mathrm{V}$ power supplies and dissipate no more than 1 mW in the equilibrium state. The differential voltage gain $A_{d}$ is to be $10 \mathrm{~V} / \mathrm{V}$ and the output common-mode dc voltage is to be 0.2 V . (Note: This is the dc voltage at the drains.) Assume $\mu_{w} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$ and neglect the Early effect. Specify $I$, $R_{D}$, and $W / L$.

D 9.15 Design a MOS differential amplifier to operate from $\pm 1-\mathrm{V}$ supplies and dissipate no more than 1 mW in its equilibrium state. Select the value of $V_{O V}$ so that the value of $v_{o l}$ that steers the current from one side of the pair to the other is 0.25 V . The differential voltage gain $A_{d}$ is to be $10 \mathrm{~V} / \mathrm{V}$. Assume $k_{b}^{\prime}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$ and neglect the Early effect. Specify the required values of $I, R_{D}$, and $W / L$.
9.16 An NMOS differential amplifier employing equal drain resistors, $R_{D}=47 \mathrm{k} \Omega$, has a differential gain $A_{d}$ of $20 \mathrm{~V} / \mathrm{V}$.
(a) What is the value of $g_{m}$ for each of the two transistors?
(b) If each of the two transistors is operating at an overdrive voltage $V_{O V}=0.2 \mathrm{~V}$, what must the value of $I$ be?
(c) For $v_{o l}=0$, what is the dc voltage across each $R_{D}$ ?
(d) If $v_{o l}$ is $20-\mathrm{mV}$ peak-to-peak sine wave applied in a balanced manner but superimposed on $V_{C M}=0.5 \mathrm{~V}$, what is the peak of the sine-wave signal at each drain?
(e) What is the lowest value that $V_{D 0}$ must have to ensure saturation-mode operation for $Q_{1}$ and $Q_{2}$ at all times? Assume $V_{t}=0.5 \mathrm{~V}$.
9.17 A MOS differential amplifier is designed to have a differential gain $A_{d}$ equal to the voltage gain obtained from a common-source amplifier. Both amplifiers utilize the same values of $R_{D}$ and supply voltages, and all the transistors have the same $W / L$ ratios. What must the bias current $I$ of the differential pair be relative to the bias current $I_{D}$ of the CS amplifier? What is the ratio of the power dissipation of the two circuits?
9.18 A differential amplifier is designed to have a differential voltage gain equal to the voltage gain of a common-source amplifier. Both amplifiers use the same values of $R_{D}$ and supply voltages and are designed to dissipate equal amounts of power in their equilibrium or quiescent state. As well, all the transistors use the same channel length. What must the width $W$ of the differential-pair transistors be relative to the width of the CS transistor?

D 9.19 Figure P9.19 shows a MOS differential amplifer with the drain resistors $R_{D}$ implemented using diode-connected PMOS transistors, $Q_{3}$ and $Q_{4}$. Let $Q_{1}$ and $Q_{2}$ be matched, and $Q_{3}$ and $Q_{4}$ be matched.


Figure P9.19
(a) Find the differential half-circuit and use it to derive an expression for $A_{d}$ in terms of $g_{m 1,2}, g_{m 3,4}, r_{o 1,2}$, and $r_{o 3,4}$.
(b) Neglecting the effect of the output resistances $r_{o}$, find $A_{d}$ in terms of $\mu_{n}, \mu_{p},(W / L)_{1,2}$ and $(W / L)_{3,4}$.
(c) If $\mu_{n}=4 \mu_{p}$ and all four transistors have the same channel length, find $\left(W_{1,2} / W_{3,4}\right)$ that results in $A_{d}=10 \mathrm{~V} / \mathrm{V}$.
9.20 Find the differential half-circuit for the differential amplifier shown in Fig. P9.20 and use it to derive an expression for the differential gain $A_{d} \equiv v_{o d} / v_{i d}$ in terms of $g_{i n}, R_{D}$, and $R_{s}$. Neglect the Early effect. What is the gain with
$R_{s}=0$ ? What is the value of $R_{s}$ (in terms of $1 / g_{i n}$ ) that reduces the gain to half this value?


Figure P9.20
*9.21 The resistance $R_{s}$ in the circuit of Fig. P9.20 can be implemented by using a MOSFET operated in the triode region, as shown in Fig. P9.21. Here $Q_{3}$ implements $R_{s}$, with the value of $R_{s}$ determined by the voltage $V_{C}$ at the gate of $Q_{3}$.


Figure P9.21
(a) With $v_{G 1}=v_{G 2}=0 \mathrm{~V}$, and assuming that $Q_{1}$ and $Q_{2}$ are operating in saturation, what dc voltages appear

[^0]
[^0]:    9.18 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
at the sources of $Q_{1}$ and $Q_{2}$ ? Express these in terms of the overdrive voltage $V_{O V}$ at which each of $Q_{1}$ and $Q_{2}$ operates, and $V_{i}$.
(b) For the situation in (a), what current flows in $Q_{3}$ ? What overdrive voltage $V_{O V 3}$ is $Q_{3}$ operating at, in terms of $V_{C}$, $V_{O V}$, and $V_{i}$ ?
(c) Now consider the case $v_{G 1}=+v_{i d} / 2$ and $v_{G 2}=-v_{i d} / 2$, where $v_{i d}$ is a small signal. Convince yourself that $Q_{3}$ now conducts current and operates in the triode region with a small $v_{D S}$. What resistance $r_{D S}$ does it have, expressed in terms of the overdrive voltage $V_{O V 3}$ at which it is operating? This is the resistance $R_{s}$. Now if all three transistors have the same $W / L$, express $R_{s}$ in terms of $V_{O V}, V_{O V 3}$, and $g_{m 1,2}$.
(d) Find $V_{O V 3}$ and hence $V_{C}$ that result in (i) $R_{s}=1 / g_{m 1,2}$; (ii) $R_{s}=0.5 / g_{m 1,2}$.
*9.22 The circuit of Fig. P9.22 shows an effective way of implementing the resistance $R_{s}$ needed for the circuit in Fig. P9.20. Here $R_{s}$ is realized as the series equivalent of two MOSFETs $Q_{3}$ and $Q_{4}$ that are operated in the triode region, thus, $R_{s}=r_{D S 3}+r_{D S 4}$. Assume that $Q_{1}$ and $Q_{2}$ are matched and operate in saturation at an overdrive voltage $V_{O V}$ that corresponds to a drain bias current of $I / 2$. Also, assume that $Q_{3}$ and $Q_{4}$ are matched.


Figure P9.22
(a) With $v_{G 1}=v_{G 2}=0 \mathrm{~V}$, what dc voltages appear at the sources of $Q_{1}$ and $Q_{2}$ ? What current flows through $Q_{3}$
and $Q_{4}$ ? At what overdrive voltages are $Q_{3}$ and $Q_{4}$ operating? Find an expression for $r_{D S}$ for each of $Q_{3}$ and $Q_{4}$ and hence for $R_{s}$ in terms of $(W / L)_{1,2},(W / L)_{3,4}$, and $g_{m 1,2}$.
(b) Now with $v_{G 1}=v_{i d} / 2$ and $v_{G 2}=-v_{i d} / 2$, where $v_{i d}$ is a small signal, find an expression of the voltage gain $A_{d} \equiv v_{o d} / v_{i d}$ in terms of $g_{m 1,2}, R_{D},(W / L)_{1,2}$, and $(W / L)_{3,4}$.
D *9.23 Figure P9.23 shows a circuit for a differential amplifier with an active load. Here $Q_{1}$ and $Q_{2}$ form the differential pair, while the current source transistors $Q_{4}$ and $Q_{5}$ form the active loads for $Q_{1}$ and $Q_{2}$, respectively. The dc bias circuit that establishes an appropriate dc voltage at the drains of $Q_{1}$ and $Q_{2}$ is not shown. It is required to design the circuit to meet the following specifications:
(a) Differential gain $A_{d}=50 \mathrm{~V} / \mathrm{V}$.
(b) $I_{\mathrm{REF}}=I=200 \mu \mathrm{~A}$.
(c) The dc voltage at the gates of $Q_{6}$ and $Q_{3}$ is +0.8 V .
(d) The dc voltage at the gates of $Q_{7}, Q_{4}$, and $Q_{5}$ is -0.8 V .

The technology available is specified as follows: $\mu_{n} C_{o s}=$ $2.5 \mu_{p} C_{o s}=250 \mu \mathrm{~A} / \mathrm{V}^{2} ; V_{t n}=\left|V_{t p}\right|=0.5 \mathrm{~V}, V_{A n}=\left|V_{A p}\right|=10 \mathrm{~V}$. Specify the required value of $R$ and the $W / L$ ratios for all transistors. Also specify $I_{D}$ and $\left|V_{G S}\right|$ at which each transistor is operating. For dc bias calculations you may neglect channel-length modulation.


Figure P9.23

[^0]
[^0]:    534 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
*9.24 A design error has resulted in a gross mismatch in the circuit of Fig. P9.24. Specifically, $Q_{2}$ has twice the $W / L$ ratio of $Q_{1}$. If $v_{o l}$ is a small sine-wave signal, find:
(a) $I_{D 1}$ and $I_{D 2}$.
(b) $V_{O V}$ for each of $Q_{1}$ and $Q_{2}$.
(c) The differential gain $A_{d}$ in terms of $R_{D}, I$, and $V_{O V}$.


Figure P9.24
D 9.25 For the cascode differential amplifier of Fig. 9.13(a), show that if all transistors have the same channel length and are operated at the same $\left|V_{O V}\right|$ and assuming that $V_{A n}^{\prime}=\left|V_{A p}^{\prime}\right|=$ $\left|V_{A}^{\prime}\right|$, the differential gain $A_{d}$ is given by

$$
A_{d}=2\left(\left|V_{A}\right| /\left|V_{O V}\right|\right)^{2}
$$

Now design the amplifier to obtain a differential gain of $500 \mathrm{~V} / \mathrm{V}$. Use $\left|V_{O V}\right|=0.2 \mathrm{~V}$. If $\left|V_{A}^{\prime}\right|=5 \mathrm{~V} / \mu \mathrm{m}$, specify the required channel length $L$. If $g_{m}$ is to be as high as possible but the power dissipation in the amplifier (in equilibrium) is to be limited to 0.5 mW , what bias current $I$ would you use? Let $V_{D D}=V_{S S}=0.9 \mathrm{~V}$.

## Section 9.2: The BJT Differential Pair

9.26 For the differential amplifier of Fig. 9.15(a) let $I=$ $0.4 \mathrm{~mA}, V_{C C}=V_{E E}=2.5 \mathrm{~V}, V_{C M}=-1 \mathrm{~V}, R_{C}=5 \mathrm{k} \Omega$, and
$\beta=100$. Assume that the BJTs have $v_{B E}=0.7 \mathrm{~V}$ at $i_{C}=1 \mathrm{~mA}$. Find the voltage at the emitters and at the outputs.
9.27 An $n p n$ differential amplifier with $I=0.4 \mathrm{~mA}, V_{C C}=$ $V_{E E}=2.5 \mathrm{~V}$, and $R_{C}=5 \mathrm{k} \Omega$ utilizes BJTs with $\beta=100$ and $v_{B E}=0.7 \mathrm{~V}$ at $i_{C}=1 \mathrm{~mA}$. If $v_{B 2}=0$, find $V_{E}, V_{C 1}$, and $V_{C 2}$ obtained with $v_{B 1}=+0.5 \mathrm{~V}$, and with $v_{B 1}=-0.5 \mathrm{~V}$. Assume that the current source requires a minimum of 0.3 V for proper operation.
9.28 An $n p n$ differential amplifier with $I=0.4 \mathrm{~mA}, V_{C C}=$ $V_{E E}=2.5 \mathrm{~V}$, and $R_{C}=5 \mathrm{k} \Omega$ utilizes BJTs with $\beta=100$ and $v_{B E}=0.7 \mathrm{~V}$ at $i_{C}=1 \mathrm{~mA}$. Assuming that the bias current is obtained by a simple current source and that all transistors require a minimum $v_{C E}$ of 0.3 V for operation in the active mode, find the input common-mode range.
9.29 Repeat Exercise 9.7 for an input of -0.3 V .
9.30 An $n p n$ differential pair employs transistors for which $v_{B E}=690 \mathrm{mV}$ at $i_{C}=1 \mathrm{~mA}$, and $\beta=50$. The transistors leave the active mode at $v_{C E} \leq 0.3 \mathrm{~V}$. The collector resistors $R_{C}=82$ $\mathrm{k} \Omega$, and the power supplies are $\pm 1.2 \mathrm{~V}$. The bias current $I=20 \mu \mathrm{~A}$ and is supplied with a simple current source.
(a) For $v_{B 1}=v_{B 2}=V_{C M}=0 \mathrm{~V}$, find $V_{E}, V_{C 1}$, and $V_{C 2}$.
(b) Find the input common-mode range.
(c) If $v_{B 2}=0$, find the value of $v_{B 1}$ that increases the current in $Q_{1}$ by $10 \%$.
9.31 Consider the BJT differential amplifier when fed with a common-mode voltage $V_{C M}$ as shown in Fig. 9.15(a). As is often the case, the supply voltage $V_{C C}$ may not be pure dc but might include a ripple component $v_{r}$ of small amplitude and a frequency of 120 Hz (see Section 4.5). Thus the supply voltage becomes $V_{C C}+v_{r}$. Find the ripple component of the collector voltages, $v_{C 1}$ and $v_{C 2}$, as well as of the difference output voltage $v_{o d} \equiv v_{C 2}-v_{C 1}$. Comment on the differential amplifier response to this undesirable power-supply ripple.

D 9.32 Consider the differential amplifier of Fig. 9.14 and let the BJT $\beta$ be very large:
(a) What is the largest input common-mode signal that can be applied while the BJTs remain comfortably in the active region with $v_{C B}=0$ ?
(b) If the available power supply $V_{C C}$ is 2.0 V , what value of $I R_{C}$ should you choose in order to allow a common-mode input signal of $\pm 1.0 \mathrm{~V}$ ?
(c) For the value of $I R_{C}$ found in (b), select values for $I$ and $R_{C}$. Use the largest possible value for $I$ subject to the

[^0]
[^0]:    9.28 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
constraint that the base current of each transistor (when $I$ divides equally) should not exceed $2 \mu \mathrm{~A}$. Let $\beta=100$.
9.33 To provide insight into the possibility of nonlinear distortion resulting from large differential input signals applied to the differential amplifier of Fig. 9.14, evaluate the normalized change in the current $i_{E 1}, \Delta i_{E 1} / I=\left(i_{E 1}-(I / 2)\right) / I$, for differential input signals $v_{i d}$ of $2,5,8,10,20,30$, and 40 mV . Provide a tabulation of the ratio $\left(\Delta i_{E 1} / I\right) / v_{i d}$, which represents the proportional transconductance gain of the differential pair, versus $v_{i d}$. Comment on the linearity of the differential pair as an amplifier.

D 9.34 Design the circuit of Fig. 9.14 to provide a differential output voltage (i.e., one taken between the two collectors) of 1 V when the differential input signal is 10 mV . A current source of 1 mA and a positive supply of +5 V are available. What is the largest possible input common-mode voltage for which operation is as required? Assume $\alpha \simeq 1$.
*9.35 For the circuit in Fig. 9.14, assuming $\alpha=1$ and $I R_{C}=5 \mathrm{~V}$, use Eqs. (9.48) and (9.49) to find $i_{C 1}$ and $i_{C 2}$, and hence determine $v_{o d}=v_{C 2}-v_{C 1}$ for input differential signals $v_{i d} \equiv v_{B 1}-v_{B 2}$ of $2 \mathrm{mV}, 5 \mathrm{mV}, 10 \mathrm{mV}, 15 \mathrm{mV}, 20 \mathrm{mV}$, $25 \mathrm{mV}, 30 \mathrm{mV}, 35 \mathrm{mV}$, and 40 mV . Plot $v_{o d}$ versus $v_{o d}$, and hence comment on the amplifier linearity. As another way of visualizing linearity, determine the gain $\left(v_{o} / v_{o d}\right)$ versus $v_{i d}$. Comment on the resulting graph.
9.36 In a differential amplifier using a $1.5-\mathrm{mA}$ emitter bias current source, the two BJTs are not matched. Rather, one has twice the emitter junction area of the other. For a differential input signal of zero volts, what do the collector currents become? What difference input is needed to equalize the collector currents? Assume $\alpha=1$.
9.37 This problem explores the linearization of the transfer characteristics of the differential pair achieved by including emitter-degeneration resistances $R_{e}$ in the emitters (see Fig. 9.17). Consider the case $I=200 \mu \mathrm{~A}$ with the transistors exhibiting $v_{B E}=690 \mathrm{mV}$ at $i_{C}=1 \mathrm{~mA}$ and assume $\alpha \simeq 1$.
(a) With no emitter resistances $R_{e}$, what value of $V_{B E}$ results when $v_{i d}=0$ ?
(b) With no emitter resistances $R_{e}$, use the large-signal model to find $i_{C 1}$ and $i_{C 2}$ when $v_{i d}=20 \mathrm{mV}$.
(c) Now find the value of $R_{e}$ that will result in the same $i_{C 1}$ and $i_{C 2}$ as in (b) but with $v_{i d}=200 \mathrm{mV}$. Use the large-signal model.
(d) Calculate the effective transconductance $G_{m}$ as the ratio of the difference current, $\left(i_{C 1}-i_{C 2}\right)$, to $v_{i d}$ in the cases without and with the $R_{e}$ 's. By what factor is $G_{m}$ reduced? How does this factor relate to the increase in $v_{i d}$ ? Comment.
9.38 A BJT differential amplifier uses a $400-\mu \mathrm{A}$ bias current. What is the value of $g_{m}$ of each device? If $\beta$ is 160 , what is the differential input resistance?

D 9.39 Design the basic BJT differential amplifier circuit of Fig. 9.18 to provide a differential input resistance of at least $20 \mathrm{k} \Omega$ and a differential voltage gain of $100 \mathrm{~V} / \mathrm{V}$. The transistor $\beta$ is specified to be at least 100 . Specify $I$ and $R_{C}$.
9.40 For a differential amplifier to which a total difference signal of 10 mV is applied, what is the equivalent signal to its corresponding CE half-circuit? If the emitter current source $I$ is $200 \mu \mathrm{~A}$, what is $r_{e}$ of the half-circuit? For a load resistance of $10 \mathrm{k} \Omega$ in each collector, what is the half-circuit gain? What magnitude of signal output voltage would you expect at each collector? Between the two collectors?
9.41 A BJT differential amplifier is biased from a $0.5-\mathrm{mA}$ constant-current source and includes a $400-\Omega$ resistor in each emitter. The collectors are connected to $V_{C C}$ via $10-\mathrm{k} \Omega$ resistors. A differential input signal of 0.1 V is applied between the two bases.
(a) Find the signal current in the emitters $\left(i_{e}\right)$ and the signal voltage $v_{b e}$ for each BJT.
(b) What is the total emitter current in each BJT?
(c) What is the signal voltage at each collector? Assume $\alpha=1$.
(d) What is the voltage gain realized when the output is taken between the two collectors?

D 9.42 Design a BJT differential amplifier to amplify a differential input signal of 0.1 V and provide a differential output signal of 2 V . To ensure adequate linearity, it is required to limit the signal amplitude across each base-emitter junction to a maximum of 5 mV . Another design requirement is that the differential input resistance be at least $100 \mathrm{k} \Omega$. The BJTs available are specified to have $\beta \geq 100$. Give the circuit configuration and specify the values of all its components.

D 9.43 Design a bipolar differential amplifier such as that in Fig. 9.18 to operate from $\pm 2.5 \mathrm{~V}$ power supplies and to provide differential gain of $60 \mathrm{~V} / \mathrm{V}$. The power dissipation in the quiescent state should not exceed 1 mW .
(a) Specify the values of $I$ and $R_{C}$. What dc voltage appears at the collectors?
(b) If $\beta=100$, what is the input differential resistance?
(c) For $v_{i d}=10 \mathrm{mV}$, what is the signal voltage at each of the collectors?
(d) For the situation in (c), what is the maximum allowable value of the input common-mode voltage, $V_{C M}$ ? Recall that to maintain an $n p n$ BJT in saturation, $v_{B}$ should not exceed $v_{C}$ by more than 0.4 V .
$\mathbf{D}^{* 9.44}$ In this problem we explore the trade-off between input common-mode range and differential gain in the design of the bipolar BJT. Consider the bipolar differential amplifier in Fig. 9.14 with the input voltages

$$
\begin{aligned}
& v_{B 1}=V_{C M}+\left(v_{i d} / 2\right) \\
& v_{B 2}=V_{C M}-\left(v_{i d} / 2\right)
\end{aligned}
$$

(a) Bearing in mind that for a BJT to remain in the active mode, $v_{B C}$ should not exceed 0.4 V , show that when $v_{i d}$ has a peak $\hat{v}_{i d}$, the maximum input common-mode voltage $V_{C M \max }$ is given by

$$
V_{C M \max }=V_{C C}+0.4-\frac{\hat{v}_{i d}}{2}-A_{d}\left(V_{T}+\frac{\hat{v}_{i d}}{2}\right)
$$

(b) For the case $V_{C C}=2.5 \mathrm{~V}$ and $\hat{v}_{i d}=10 \mathrm{mV}$, use the relationship above to determine $V_{C M \max }$ for the case $A_{d}=$ $50 \mathrm{~V} / \mathrm{V}$. Also find the peak output signal $\hat{v}_{i d}$ and the required value of $I R_{C}$. Now if the power dissipation in the circuit is to be limited to 1 mW in the quiescent state (i.e., with $v_{i d}=0$ ), find $I$ and $R_{C}$. (Remember to include the power drawn from the negative power supply $\left.-V_{E E}=-2.5 \mathrm{~V}.\right)$
(c) If $V_{C M \max }$ is to be +1 V , and all other conditions remain the same, what maximum gain $A_{d}$ is achievable?
9.45 For the differential amplifier of Fig. 9.14, let $V_{C C}=$ +5 V and $I R_{C}=4 \mathrm{~V}$. Find the differential gain $A_{d}$. Sketch and clearly label the waveforms for the total collector voltages $v_{C 1}$ and $v_{C 2}$ and for $\left(v_{C 2}-v_{C 1}\right)$ for the case:

$$
\begin{aligned}
& v_{B 1}=1+0.005 \sin (\omega \mathrm{t}) \\
& v_{B 2}=1-0.005 \sin (\omega \mathrm{t})
\end{aligned}
$$

9.46 Consider a bipolar differential amplifier in which the collector resistors $R_{C}$ are replaced with simple current sources implemented using pnp transistors. Sketch the circuit and give its differential half-circuit. If $V_{A}=20 \mathrm{~V}$ for all transistors, find the differential voltage gain achieved.
9.47 For each of the emitter-degenerated differential amplifiers shown in Fig. P9.47, find the differential half-circuit and derive expressions for the differential gain $A_{d}$ and differential input resistance $R_{i d}$. For each circuit, what dc voltage appears across the bias current source(s) in the quiescent state (i.e., with $v_{i d}=0$ )? Hence, which of the two circuits will allow a larger negative $V_{C M}$ ?


Figure P9.47
9.48 Consider a bipolar differential amplifier that, in addition to the collector resistances $R_{C}$, has a load resistance $R_{L}$ connected between the two collectors. What does the differential gain $A_{d}$ become?
9.49 A bipolar differential amplifier having resistance $R_{r}$ inserted in series with each emitter (as in Fig. P9.47(a)) is biased with a constant current $I$. When both input terminals are grounded, the dc voltage measured across each $R_{r}$ is found to be $4 V_{T}$ and that measured across each $R_{C}$ is found to be $60 V_{T}$. What differential voltage gain $A_{d}$ do you expect the amplifier to have?
9.50 A bipolar differential amplifier with emitterdegeneration resistances $R_{s}$ and $R_{e}$ is fed with the arrangement shown in Fig. P9.50. Derive an expression for the overall differential voltage gain $G_{o} \equiv v_{o d} / v_{o i g}$. If $R_{\text {sig }}$ is of such a value that $v_{o l}=0.5 v_{o i g}$, find the gain $G_{o}$ in terms of $R_{C}$, $r_{e}, R_{e}$, and $\alpha$. Now if $\beta$ is doubled, by what factor does $G_{o}$ increase?


Figure P9.50
9.51 A particular differential amplifier operates from an emitter current source $I=0.4 \mathrm{~mA}$. Each of the collector resistances $R_{C}=20 \mathrm{k} \Omega$ and a load resistance $R_{L}=40 \mathrm{k} \Omega$ is connected between the two collectors. If the amplifier is fed in the manner shown in Fig. P9.50 with $R_{\text {sig }}=100 \mathrm{k} \Omega$, find the overall voltage gain. Let $\beta=100$.
9.52 Find the voltage gain and the input resistance of the amplifier shown in Fig. P9.52 assuming $\beta=100$.


Figure P9.52
9.53 Find the voltage gain and input resistance of the amplifier in Fig. P9.53 assuming that $\beta=100$.


Figure P9.53
9.54 Derive an expression for the small-signal voltage gain $v_{o} / v_{i}$ of the circuit shown in Fig. P9.54 in two different ways:
(a) as a differential amplifier
(b) as a cascade of a common-collector stage $Q_{1}$ and a common-base stage $Q_{2}$

[^0]
[^0]:    SIN = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem

Figure 1.26 Frequency response for (a) a capacitively coupled amplifier, (b) a direct-coupled amplifier, and (c) a tuned or bandpass amplifier.


Figure 1.27 Use of a capacitor to couple amplifier stages.
frequencies and cause the gain to be zero at dc. This is not at all surprising, since from Fig. 1.27 we observe that the coupling capacitor, acting together with the input resistance of the subsequent stage, forms a high-pass STC circuit. It is the frequency response of this high-pass circuit that accounts for the shape of the amplifier frequency response in Fig. 1.26(a) at the low-frequency end.

There are many applications in which it is important that the amplifier maintain its gain at low frequencies down to dc. Furthermore, monolithic integrated-circuit (IC) technology does not allow the fabrication of large coupling capacitors. Thus IC amplifiers are usually designed as directly coupled or dc amplifiers (as opposed to capacitively coupled, or ac amplifiers).
Figure 1.26(b) shows the frequency response of a dc amplifier. Such a frequency response characterizes what is referred to as a low-pass amplifier.

In a number of applications, such as in the design of radio and TV receivers, the need arises for an amplifier whose frequency response peaks around a certain frequency (called the center frequency) and falls off on both sides of this frequency, as shown in Fig. 1.26(c). Amplifiers with such a response are called tuned amplifiers, bandpass amplifiers, or bandpass filters. A tuned amplifier forms the heart of the front-end or tuner of a communication receiver; by adjusting its center frequency to coincide with the frequency of a desired communications channel (e.g., a radio station), the signal of this particular channel can be received while those of other channels are attenuated or filtered out.

# EXERCISES 

1.22 Consider a voltage amplifier having a frequency response of the low-pass STC type with a dc gain of 60 dB and a $3-\mathrm{dB}$ frequency of 1000 Hz . Find the gain in dB at $f=10 \mathrm{~Hz}, 10 \mathrm{kHz}, 100 \mathrm{kHz}$, and 1 MHz .
Ans. $60 \mathrm{~dB} ; 40 \mathrm{~dB} ; 20 \mathrm{~dB} ; 0 \mathrm{~dB}$
D1.23 Consider a transconductance amplifier having the model shown in Table 1.1 with $R_{i}=5 \mathrm{k} \Omega, R_{o}=$ $50 \mathrm{k} \Omega$, and $G_{m}=10 \mathrm{~mA} / \mathrm{V}$. If the amplifier load consists of a resistance $R_{L}$ in parallel with a capacitance $C_{L}$, convince yourself that the voltage transfer function realized, $V_{o} / V_{i}$, is of the low-pass STC type. What is the lowest value that $R_{L}$ can have while a dc gain of at least 40 dB is obtained? With this value of $R_{L}$ connected, find the highest value that $C_{L}$ can have while a $3-\mathrm{dB}$ bandwidth of at least 100 kHz is obtained.
Ans. $12.5 \mathrm{k} \Omega ; 159.2 \mathrm{pF}$
D1.24 Consider the situation illustrated in Fig. 1.27. Let the output resistance of the first voltage amplifier be $1 \mathrm{k} \Omega$ and the input resistance of the second voltage amplifier (including the resistor shown) be $9 \mathrm{k} \Omega$. The resulting equivalent circuit is shown in Fig. E1.24. Convince yourself that $V_{2} / V_{s}$ is a high-pass STC function. What is the smallest value for $C$ that will ensure that the $3-\mathrm{dB}$ frequency is not higher than 100 Hz ?
Ans. $0.16 \mu \mathrm{~F}$


Figure E1.24
## Summary

- An electrical signal source can be represented in either the Thévenin form (a voltage source $v_{s}$ in series with a source resistance $R_{s}$ ) or the Norton form (a current source $i_{s}$ in parallel with a source resistance $R_{s}$ ). The Thévenin voltage $v_{s}$ is the open-circuit voltage between the source terminals; the Norton current $i_{s}$ is equal to the short-circuit current between the source terminals. For the two representations to be equivalent, $v_{s}$ and $R_{s} i_{s}$ must be equal.
- A signal can be represented either by its waveform versus time or as the sum of sinusoids. The latter representation is known as the frequency spectrum of the signal.
- The sine-wave signal is completely characterized by its peak value (or rms value, which is the peak/ $\sqrt{2}$ ), its frequency ( $\omega$ in rad/s or $f$ in $\mathrm{Hz} ; \omega=2 \pi f$ and $f=1 / T$, where $T$ is the period in seconds), and its phase with respect to an arbitrary reference time.
- Analog signals have magnitudes that can assume any value. Electronic circuits that process analog signals are called analog circuits. Sampling the magnitude of an analog signal at discrete instants of time and representing each signal sample by a number results in a digital signal. Digital signals are processed by digital circuits.
- The simplest digital signals are obtained when the binary system is used. An individual digital signal then assumes one of only two possible values: low and high (say, 0 V and +5 V ), corresponding to logic 0 and logic 1 , respectively.
- An analog-to-digital converter (ADC) provides at its output the digits of the binary number representing the analog signal sample applied to its input. The output digital signal can then be processed using digital circuits. Refer to Fig. 1.10 and Eq. (1.3).
- The transfer characteristic, $v_{0}$ versus $v_{1}$, of a linear amplifier is a straight line with a slope equal to the voltage gain. Refer to Fig. 1.12.
- Amplifiers increase the signal power and thus require dc power supplies for their operation.
- The amplifier voltage gain can be expressed as a ratio $A_{o}$ in V/V or in decibels, $20 \log \left|A_{o}\right|$, dB. Similarly, for current gain: $A_{i} \mathrm{~A} / \mathrm{A}$ or $20 \log \left|A_{i}\right|$, dB. For power gain: $A_{p} \mathrm{~W} / \mathrm{W}$ or $10 \log A_{p}$, dB .
- Depending on the signal to be amplified (voltage or current) and on the desired form of output signal (voltage or current), there are four basic amplifier types: voltage, current, transconductance, and transresistance amplifiers. For the circuit models and ideal characteristics of these four amplifier types, refer to Table 1.1. A given amplifier can be modeled by any one of the four models, in which case their parameters are related by the formulas in Eqs. (1.14) to (1.16).
- A sinusoid is the only signal whose waveform is unchanged through a linear circuit. Sinusoidal signals are used to measure the frequency response of amplifiers.
- The transfer function $T(s) \equiv V_{o}(s) / V_{i}(s)$ of a voltage amplifier can be determined from circuit analysis. Substituting $s=j \omega$ gives $T(j \omega)$, whose magnitude $|T(j \omega)|$ is the magnitude response, and whose phase $\phi(\omega)$ is the phase response, of the amplifier.
- Amplifiers are classified according to the shape of their frequency response, $|T(j \omega)|$. Refer to Fig. 1.26.
- Single-time-constant (STC) networks are those networks that are composed of, or can be reduced to, one reactive component ( $L$ or $C$ ) and one resistance $(R)$. The time constant $\tau$ is either $L / R$ or $C R$.
- STC networks can be classified into two categories: low pass (LP) and high pass (HP). LP networks pass dc and low frequencies and attenuate high frequencies. The opposite is true for HP networks.
- The gain of an LP (HP) STC circuit drops by 3 dB below the zero-frequency (infinite-frequency) value at a frequency $\omega_{0}=1 / \tau$. At high frequencies (low frequencies) the gain falls off at the rate of $6 \mathrm{~dB} /$ octave or $20 \mathrm{~dB} /$ decade. Refer to Table 1.2 on page 36 and Figs. 1.23 and 1.24. Further details are given in Appendix E.
## Circuit Basics

As a review of the basics of circuit analysis and in order for the readers to gauge their preparedness for the study of electronic circuits, this section presents a number of relevant circuit analysis problems. For a summary of Thévenin's and Norton's theorems, refer to Appendix D. The problems are grouped in appropriate categories.

## Resistors and Ohm's Law

1.1 Ohm's law relates $V, I$, and $R$ for a resistor. For each of the situations following, find the missing item:
(a) $R=1 \mathrm{k} \Omega, V=5 \mathrm{~V}$
(b) $V=5 \mathrm{~V}, I=1 \mathrm{~mA}$
(c) $R=10 \mathrm{k} \Omega, I=0.1 \mathrm{~mA}$
(d) $R=100 \Omega, V=1 \mathrm{~V}$

Note: Volts, milliamps, and kilohms constitute a consistent set of units.
1.2 Measurements taken on various resistors are shown below. For each, calculate the power dissipated in the resistor and the power rating necessary for safe operation using standard components with power ratings of $1 / 8 \mathrm{~W}, 1 / 4 \mathrm{~W}$, $1 / 2 \mathrm{~W}, 1 \mathrm{~W}$, or 2 W :
(a) $1 \mathrm{k} \Omega$ conducting 20 mA
(b) $1 \mathrm{k} \Omega$ conducting 40 mA
(c) $100 \mathrm{k} \Omega$ conducting 1 mA
(d) $10 \mathrm{k} \Omega$ conducting 4 mA
(e) $1 \mathrm{k} \Omega$ dropping 20 V
(f) $1 \mathrm{k} \Omega$ dropping 11 V
1.3 Ohm's law and the power law for a resistor relate $V, I, R$, and $P$, making only two variables independent. For each pair identified below, find the other two:
(a) $R=1 \mathrm{k} \Omega, I=5 \mathrm{~mA}$
(b) $V=5 \mathrm{~V}, I=1 \mathrm{~mA}$
(c) $V=10 \mathrm{~V}, P=100 \mathrm{~mW}$
(d) $I=0.1 \mathrm{~mA}, P=1 \mathrm{~mW}$
(e) $R=1 \mathrm{k} \Omega, P=1 \mathrm{~W}$

## Combining Resistors

1.4 You are given three resistors whose values are $10 \mathrm{k} \Omega$, $20 \mathrm{k} \Omega$, and $40 \mathrm{k} \Omega$. How many different resistances can you create using series and parallel combinations of these three? List them in value order, lowest first. Be thorough and
organized. (Hint: In your search, first consider all parallel combinations, then consider series combinations, and then consider series-parallel combinations, of which there are two kinds.)
1.5 In the analysis and test of electronic circuits, it is often useful to connect one resistor in parallel with another to obtain a nonstandard value, one which is smaller than the smaller of the two resistors. Often, particularly during circuit testing, one resistor is already installed, in which case the second, when connected in parallel, is said to "shunt" the first. If the original resistor is $10 \mathrm{k} \Omega$, what is the value of the shunting resistor needed to reduce the combined value by $1 \%, 5 \%, 10 \%$, and $50 \%$ ? What is the result of shunting a $10-\mathrm{k} \Omega$ resistor by $1 \mathrm{M} \Omega$ ? By $100 \mathrm{k} \Omega$ ? By $10 \mathrm{k} \Omega$ ?

## Voltage Dividers

1.6 Figure P1.6(a) shows a two-resistor voltage divider. Its function is to generate a voltage $V_{o}$ (smaller than the power-supply voltage $V_{D D}$ ) at its output node X . The circuit looking back at node X is equivalent to that shown in Fig. P1.6(b). Observe that this is the Thévenin equivalent of the voltage-divider circuit. Find expressions for $V_{o}$ and $R_{o}$.


Figure P1.6
1.7 A two-resistor voltage divider employing a $2-\mathrm{k} \Omega$ and a $3-\mathrm{k} \Omega$ resistor is connected to a $5-\mathrm{V}$ ground-referenced power supply to provide a 2-V voltage. Sketch the circuit. Assuming exact-valued resistors, what output voltage (measured to ground) and equivalent output resistance result? If the resistors used are not ideal but have a $\pm 5 \%$ manufacturing tolerance, what are the extreme output voltages and resistances that can result?

[^0]
[^0]:    1.7M = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
D 1.8 You are given three resistors, each of $10 \mathrm{k} \Omega$, and a $9-\mathrm{V}$ battery whose negative terminal is connected to ground. With a voltage divider using some or all of your resistors, how many positive-voltage sources of magnitude less than 9 V can you design? List them in order, smallest first. What is the output resistance (i.e., the Thévenin resistance) of each?

D *1.9 Two resistors, with nominal values of $4.7 \mathrm{k} \Omega$ and 10 $\mathrm{k} \Omega$, are used in a voltage divider with a $+15-\mathrm{V}$ supply to create a nominal $+5-\mathrm{V}$ output. Assuming the resistor values to be exact, what is the actual output voltage produced? Which resistor must be shunted (paralleled) by what third resistor to create a voltage-divider output of 5.00 V ? If an output resistance of exactly $3.33 \mathrm{k} \Omega$ is also required, what do you suggest?

## Current Dividers

1.10 Current dividers play an important role in circuit design. Therefore it is important to develop a facility for dealing with current dividers in circuit analysis. Figure P1.10 shows a two-resistor current divider fed with an ideal current source $I$. Show that

$$
\begin{aligned}
& I_{1}=\frac{R_{2}}{R_{1}+R_{2}} I \\
& I_{2}=\frac{R_{1}}{R_{1}+R_{2}} I
\end{aligned}
$$

and find the voltage $V$ that develops across the current divider.


Figure P1.10
D 1.11 Design a simple current divider that will reduce the current provided to a $10-\mathrm{k} \Omega$ load to one-third of that available from the source.

D 1.12 A designer searches for a simple circuit to provide one-fifth of a signal current $I$ to a load resistance $R$. Suggest a solution using one resistor. What must its value be? What is the input resistance of the resulting current divider? For a particular value $R$, the designer discovers that the otherwise-best-available resistor is $10 \%$ too high. Suggest two circuit topologies using one additional resistor that will solve
this problem. What is the value of the resistor required in each case? What is the input resistance of the current divider in each case?

D 1.13 A particular electronic signal source generates currents in the range 0 mA to 0.5 mA under the condition that its load voltage not exceed 1 V . For loads causing more than 1 V to appear across the generator, the output current is no longer assured but will be reduced by some unknown amount. This circuit limitation, occurring, for example, at the peak of a sine-wave signal, will lead to undesirable signal distortion that must be avoided. If a $10-\mathrm{k} \Omega$ load is to be connected, what must be done? What is the name of the circuit you must use? How many resistors are needed? What is (are) the(ir) value(s)? What is the range of current through the load?

## Thévenin Equivalent Circuits

1.14 For the circuit in Fig. P1.14, find the Thévenin equivalent circuit between terminals (a) 1 and 2, (b) 2 and 3, and (c) 1 and 3 .


Figure P1.14
1.15 Through repeated application of Thévenin's theorem, find the Thévenin equivalent of the circuit in Fig. P1.15 between node 4 and ground, and hence find the current that flows through a load resistance of $3 \mathrm{k} \Omega$ connected between node 4 and ground.


Figure P1.15

[^0]
[^0]:    100 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
## Circuit Analysis

1.16 For the circuit shown in Fig. P1.16, find the current in each of the three resistors and the voltage (with respect to ground) at their common node using two methods:
(a) Loop Equations: Define branch currents $I_{1}$ and $I_{2}$ in $R_{1}$ and $R_{2}$, respectively; write two equations; and solve them.
(b) Node Equation: Define the node voltage $V$ at the common node; write a single equation; and solve it.

Which method do you prefer? Why?


Figure P1.16
1.17 The circuit shown in Fig. P1.17 represents the equivalent circuit of an unbalanced bridge. It is required to calculate the current in the detector branch $\left(R_{3}\right)$ and the voltage across it. Although this can be done by using loop and node equations,
a much easier approach is possible: Find the Thévenin equivalent of the circuit to the left of node 1 and the Thévenin equivalent of the circuit to the right of node 2 . Then solve the resulting simplified circuit.
*1.18 For the circuit in Fig. P1.18, find the equivalent resistance to ground, $R_{\mathrm{eq}}$. To do this, apply a voltage $V_{s}$ between terminal X and ground and find the current drawn from $V_{s}$. Note that you can use particular special properties of the circuit to get the result directly! Now, if $R_{4}$ is raised to $1.2 \mathrm{k} \Omega$, what does $R_{\mathrm{eq}}$ become?


Figure P1.18
1.19 Derive an expression for $v_{e} / v_{s}$ for the circuit shown in Fig. P1.19.


Figure P1.17


Figure P1.19

[^0]
[^0]:    SIN = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
## AC Circuits

1.20 The periodicity of recurrent waveforms, such as sine waves or square waves, can be completely specified using only one of three possible parameters: radian frequency, $\omega$, in radians per second ( $\mathrm{rad} / \mathrm{s}$ ); (conventional) frequency, $f$, in hertz $(\mathrm{Hz})$; or period $T$, in seconds (s). As well, each of the parameters can be specified numerically in one of several ways: using letter prefixes associated with the basic units, using scientific notation, or using some combination of both. Thus, for example, a particular period may be specified as $100 \mathrm{~ns}, 0.1 \mu \mathrm{~s}, 10^{-1} \mu \mathrm{~s}, 10^{5} \mathrm{ps}$, or $1 \times 10^{-5} \mathrm{~s}$. (For the definition of the various prefixes used in electronics, see Appendix J.) For each of the measures listed below, express the trio of terms in scientific notation associated with the basic unit (e.g., $10^{-3} \mathrm{~s}$ rather than $10^{-1} \mu \mathrm{~s}$ ).
(a) $T=10^{-4} \mathrm{~ms}$
(b) $f=1 \mathrm{GHz}$
(c) $\omega=6.28 \times 10^{2} \mathrm{rad} / \mathrm{s}$
(d) $T=10 \mathrm{~s}$
(e) $f=60 \mathrm{~Hz}$
(f) $\omega=1 \mathrm{krad} / \mathrm{s}$
(g) $f=1900 \mathrm{MHz}$
1.21 Find the complex impedance, $Z$, of each of the following basic circuit elements at $60 \mathrm{~Hz}, 100 \mathrm{kHz}$, and 1 GHz :
(a) $R=1 \mathrm{k} \Omega$
(b) $C=10 \mathrm{nF}$
(c) $C=10 \mathrm{pF}$
(d) $L=10 \mathrm{mH}$
(e) $L=1 \mu \mathrm{H}$
1.22 Find the complex impedance at 10 kHz of the following networks:
(a) $1 \mathrm{k} \Omega$ in series with 10 nF
(b) $10 \mathrm{k} \Omega$ in parallel with $0.01 \mu \mathrm{~F}$
(c) $100 \mathrm{k} \Omega$ in parallel with 100 pF
(d) $100 \Omega$ in series with 10 mH

## Section 1.1: Signals

1.23 Any given signal source provides an open-circuit voltage, $v_{\text {oc }}$, and a short-circuit current, $i_{\text {sc }}$. For the following
sources, calculate the internal resistance, $R_{i}$; the Norton current, $i_{s}$; and the Thévenin voltage, $v_{s}$ :
(a) $v_{\text {oc }}=1 \mathrm{~V}, i_{\text {sc }}=0.1 \mathrm{~mA}$
(b) $v_{\text {oc }}=0.1 \mathrm{~V}, i_{\text {sc }}=1 \mu \mathrm{~A}$
1.24 A particular signal source produces an output of 40 mV when loaded by a $100-\mathrm{k} \Omega$ resistor and 10 mV when loaded by a $10-\mathrm{k} \Omega$ resistor. Calculate the Thévenin voltage, Norton current, and source resistance.
1.25 A temperature sensor is specified to provide $2 \mathrm{mV} /{ }^{\circ} \mathrm{C}$. When connected to a load resistance of $5 \mathrm{k} \Omega$, the output voltage was measured to change by 10 mV , corresponding to a change in temperature of $10^{\circ} \mathrm{C}$. What is the source resistance of the sensor?
1.26 Refer to the Thévenin and Norton representations of the signal source (Fig. 1.1). If the current supplied by the source is denoted $i_{o}$ and the voltage appearing between the source output terminals is denoted $v_{o}$, sketch and clearly label $v_{o}$ versus $i_{o}$ for $0 \leq i_{o} \leq i_{s}$.
1.27 The connection of a signal source to an associated signal processor or amplifier generally involves some degree of signal loss as measured at the processor or amplifier input. Considering the two signal-source representations shown in Fig. 1.1, provide two sketches showing each signal-source representation connected to the input terminals (and corresponding input resistance) of a signal processor. What signal-processor input resistance will result in $95 \%$ of the open-circuit voltage being delivered to the processor? What input resistance will result in $95 \%$ of the short-circuit signal current entering the processor?

## Section 1.2: Frequency Spectrum of Signals

1.28 To familiarize yourself with typical values of angular frequency $\omega$, conventional frequency $f$, and period $T$, complete the entries in the following table:

| Case | $\omega(\mathrm{rad} / \mathrm{s})$ | $f(\mathrm{~Hz})$ | $T(\mathrm{~s})$ |
| :--: | :--: | :--: | :--: |
| a | $2 \times 10^{9}$ | $5 \times 10^{9}$ |  |
| b |  |  |  |
| c |  |  | $1 \times 10^{-10}$ |
| d |  | 60 |  |
| e | $6.28 \times 10^{4}$ |  |  |
| f |  |  | $1 \times 10^{-5}$ |

[^0]
[^0]:    1.22 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
1.29 For the following peak or rms values of some important sine waves, calculate the corresponding other value:
(a) 117 V rms, a household-power voltage in North America
(b) 33.9 V peak, a somewhat common peak voltage in rectifier circuits
(c) 220 V rms, a household-power voltage in parts of Europe
(d) 220 kV rms, a high-voltage transmission-line voltage in North America
1.30 Give expressions for the sine-wave voltage signals having:
(a) $10-\mathrm{V}$ peak amplitude and $1-\mathrm{kHz}$ frequency
(b) $120-\mathrm{V}$ rms and $60-\mathrm{Hz}$ frequency
(c) $0.2-\mathrm{V}$ peak-to-peak and $2000-\mathrm{rad} / \mathrm{s}$ frequency
(d) $100-\mathrm{mV}$ peak and $1-\mathrm{ms}$ period
1.31 Using the information provided by Eq. (1.2) in association with Fig. 1.5, characterize the signal represented by $v(t)=1 / 2+2 / \pi(\sin 2000 \pi t+\frac{1}{3} \sin 6000 \pi t+$ $\frac{1}{5} \sin 10,000 \pi t+\cdots)$. Sketch the waveform. What is its average value? Its peak-to-peak value? Its lowest value? Its highest value? Its frequency? Its period?
1.32 Measurements taken of a square-wave signal using a frequency-selective voltmeter (called a spectrum analyzer) show its spectrum to contain adjacent components (spectral lines) at 98 kHz and 126 kHz of amplitudes 63 mV and 49 mV , respectively. For this signal, what would direct measurement of the fundamental show its frequency and amplitude to be? What is the rms value of the fundamental? What are the peak-to-peak amplitude and period of the originating square wave?
1.33 Find the amplitude of a symmetrical square wave of period $T$ that provides the same power as a sine wave of peak
amplitude $\hat{V}$ and the same frequency. Does this result depend on equality of the frequencies of the two waveforms?

## Section 1.3: Analog and Digital Signals

1.34 Give the binary representation of the following decimal numbers: $0,6,11,28$, and 59 .
1.35 Consider a 4-bit digital word $b_{3} b_{2} b_{1} b_{0}$ in a format called signed-magnitude, in which the most significant bit, $b_{3}$, is interpreted as a sign bit- 0 for positive and 1 for negative values. List the values that can be represented by this scheme. What is peculiar about the representation of zero? For a particular analog-to-digital converter (ADC), each change in $b_{0}$ corresponds to a $0.5-\mathrm{V}$ change in the analog input. What is the full range of the analog signal that can be represented? What signed-magnitude digital code results for an input of +2.5 V ? For -3.0 V ? For +2.7 V ? For -2.8 V ?
1.36 Consider an $N$-bit ADC whose analog input varies between 0 and $V_{F S}$ (where the subscript $F S$ denotes "full scale").
(a) Show that the least significant bit (LSB) corresponds to a change in the analog signal of $V_{F S} /\left(2^{N}-1\right)$. This is the resolution of the converter.
(b) Convince yourself that the maximum error in the conversion (called the quantization error) is half the resolution; that is, the quantization error $=V_{F S} / 2\left(2^{N}-1\right)$.
(c) For $V_{F S}=5 \mathrm{~V}$, how many bits are required to obtain a resolution of 2 mV or better? What is the actual resolution obtained? What is the resulting quantization error?
1.37 Figure P1.37 shows the circuit of an $N$-bit digital-to-analog converter (DAC). Each of the $N$ bits of the digital word to be converted controls one of the switches.


Figure P1.37

[^0]
[^0]:    1.38 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
When the bit is 0 , the switch is in the position labeled 0 ; when the bit is 1 , the switch is in the position labeled 1 . The analog output is the current $i_{o} . V_{s t f}$ is a constant reference voltage.
(a) Show that

$$
i_{o}=\frac{V_{s t f}}{R}\left(\frac{b_{1}}{2^{1}}+\frac{b_{2}}{2^{2}}+\cdots+\frac{b_{N}}{2^{N}}\right)
$$

(b) Which bit is the LSB? Which is the MSB?
(c) For $V_{s t f}=10 \mathrm{~V}, R=10 \mathrm{k} \Omega$, and $N=8$, find the maximum value of $i_{o}$ obtained. What is the change in $i_{o}$ resulting from the LSB changing from 0 to 1 ?
1.38 In compact-disc (CD) audio technology, the audio signal is sampled at 44.1 kHz . Each sample is represented by 16 bits. What is the speed of this system in bits per second?

## Section 1.4: Amplifiers

1.39 Various amplifier and load combinations are measured as listed below using rms values. For each, find the voltage, current, and power gains ( $A_{v}, A_{i}$, and $A_{p}$, respectively) both as ratios and in dB :
(a) $v_{I}=100 \mathrm{mV}, i_{I}=100 \mu \mathrm{~A}, v_{o}=10 \mathrm{~V}, R_{L}=100 \Omega$
(b) $v_{I}=10 \mu \mathrm{~V}, i_{I}=100 \mathrm{nA}, v_{o}=1 \mathrm{~V}, R_{L}=10 \mathrm{k} \Omega$
(c) $v_{I}=1 \mathrm{~V}, i_{I}=1 \mathrm{~mA}, v_{o}=5 \mathrm{~V}, R_{L}=10 \Omega$
1.40 An amplifier operating from $\pm 3-\mathrm{V}$ supplies provides a $2.2-\mathrm{V}$ peak sine wave across a $100-\Omega$ load when provided with a $0.2-\mathrm{V}$ peak input from which 1.0 mA peak is drawn. The average current in each supply is measured to be 20 mA .Find the voltage gain, current gain, and power gain expressed as ratios and in decibels as well as the supply power, amplifier dissipation, and amplifier efficiency.
1.41 An amplifier using balanced power supplies is known to saturate for signals extending within 1.0 V of either supply. For linear operation, its gain is $200 \mathrm{~V} / \mathrm{V}$. What is the rms value of the largest undistorted sine-wave output available, and input needed, with $\pm 5-\mathrm{V}$ supplies? With $\pm 10-\mathrm{V}$ supplies? With $\pm 15-\mathrm{V}$ supplies?
1.42 Symmetrically saturating amplifiers, operating in the so-called clipping mode, can be used to convert sine waves to pseudo-square waves. For an amplifier with a small-signal gain of 1000 and clipping levels of $\pm 10 \mathrm{~V}$, what peak value of input sinusoid is needed to produce an output whose extremes are just at the edge of clipping? Clipped $90 \%$ of the time? Clipped $99 \%$ of the time?

## Section 1.5: Circuit Models for Amplifiers

1.43 Consider the voltage-amplifier circuit model shown in Fig. 1.16(b), in which $A_{v o}=100 \mathrm{~V} / \mathrm{V}$ under the following conditions:
(a) $R_{i}=10 R_{c}, R_{L}=10 R_{o}$
(b) $R_{i}=R_{c}, R_{L}=R_{o}$
(c) $R_{i}=R_{c} / 10, R_{L}=R_{o} / 10$

Calculate the overall voltage gain $v_{o} / v_{s}$ in each case, expressed both directly and in decibels.
1.44 An amplifier with 40 dB of small-signal, open-circuit voltage gain, an input resistance of $1 \mathrm{M} \Omega$, and an output resistance of $100 \Omega$, drives a load of $500 \Omega$. What voltage and power gains (expressed in dB ) would you expect with the load connected? If the amplifier has a peak output-current limitation of 20 mA , what is the rms value of the largest sine-wave input for which an undistorted output is possible? What is the corresponding output power available?
1.45 A $10-\mathrm{mV}$ signal source having an internal resistance of $100 \mathrm{k} \Omega$ is connected to an amplifier for which the input resistance is $10 \mathrm{k} \Omega$, the open-circuit voltage gain is $1000 \mathrm{~V} / \mathrm{V}$, and the output resistance is $1 \mathrm{k} \Omega$. The amplifier is connected in turn to a $100-\Omega$ load. What overall voltage gain results as measured from the source internal voltage to the load? Where did all the gain go? What would the gain be if the source was connected directly to the load? What is the ratio of these two gains? This ratio is a useful measure of the benefit the amplifier brings.
1.46 A buffer amplifier with a gain of $1 \mathrm{~V} / \mathrm{V}$ has an input resistance of $1 \mathrm{M} \Omega$ and an output resistance of $20 \Omega$. It is connected between a $1-\mathrm{V}, 200-\mathrm{k} \Omega$ source and a $100-\Omega$

[^0]
[^0]:    $2100=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
load. What load voltage results? What are the corresponding voltage, current, and power gains (in dB )?
1.47 Consider the cascade amplifier of Example 1.3. Find the overall voltage gain $v_{o} / v_{i}$ obtained when the first and second stages are interchanged. Compare this value with the result in Example 1.3, and comment.
1.48 You are given two amplifiers, A and B, to connect in cascade between a $10-\mathrm{mV}, 100-\mathrm{k} \Omega$ source and a $100-\Omega$ load. The amplifiers have voltage gain, input resistance, and output resistance as follows: for $\mathrm{A}, 100 \mathrm{~V} / \mathrm{V}, 100 \mathrm{k} \Omega, 10 \mathrm{k} \Omega$, respectively; for $\mathrm{B}, 10 \mathrm{~V} / \mathrm{V}, 10 \mathrm{k} \Omega, 1 \mathrm{k} \Omega$, respectively. Your problem is to decide how the amplifiers should be connected. To proceed, evaluate the two possible connections between source S and load L, namely, SABL and SBAL. Find the voltage gain for each both as a ratio and in decibels. Which amplifier arrangement is best?

D *1.49 A designer has available voltage amplifiers with an input resistance of $10 \mathrm{k} \Omega$, an output resistance of $1 \mathrm{k} \Omega$, and an open-circuit voltage gain of 10 . The signal source has a $10-\mathrm{k} \Omega$ resistance and provides a $5-\mathrm{mV}$ rms signal, and it is required to provide a signal of at least 3 V rms to a $200-\Omega$ load. How many amplifier stages are required? What is the output voltage actually obtained?

D *1.50 Design an amplifier that provides 0.5 W of signal power to a $100-\Omega$ load resistance. The signal source provides a $30-\mathrm{mV}$ rms signal and has a resistance of $0.5 \mathrm{M} \Omega$. Three types of voltage-amplifier stages are available:
(a) A high-input-resistance type with $R_{i}=1 \mathrm{M} \Omega, A_{v o}=10$, and $R_{o}=10 \mathrm{k} \Omega$
(b) A high-gain type with $R_{i}=10 \mathrm{k} \Omega, A_{v o}=100$, and $R_{o}=1 \mathrm{k} \Omega$
(c) A low-output-resistance type with $R_{i}=10 \mathrm{k} \Omega, A_{v o}=1$, and $R_{o}=20 \Omega$

Design a suitable amplifier using a combination of these stages. Your design should utilize the minimum number of stages and should ensure that the signal level is not reduced below 10 mV at any point in the amplifier chain. Find the load voltage and power output realized.

D *1.51 It is required to design a voltage amplifier to be driven from a signal source having a $5-\mathrm{mV}$ peak amplitude and a source resistance of $10 \mathrm{k} \Omega$ to supply a peak output of 2 V across a $1-\mathrm{k} \Omega$ load.
(a) What is the required voltage gain from the source to the load?
(b) If the peak current available from the source is $0.1 \mu \mathrm{~A}$, what is the smallest input resistance allowed? For the design with this value of $R_{i}$, find the overall current gain and power gain.
(c) If the amplifier power supply limits the peak value of the output open-circuit voltage to 3 V , what is the largest output resistance allowed?
(d) For the design with $R_{i}$ as in (b) and $R_{o}$ as in (c), what is the required value of open-circuit voltage gain, i.e., $\frac{v_{o}}{v_{i}} \biggr{\rvert}_{S_{L=\infty}}$, of the amplifier?
(e) If, as a possible design option, you are able to increase $R_{i}$ to the nearest value of the form $1 \times 10^{\prime \prime} \Omega$ and to decrease $R_{o}$ to the nearest value of the form $1 \times 10^{\prime \prime} \Omega$, find (i) the input resistance achievable; (ii) the output resistance achievable; and (iii) the open-circuit voltage gain now required to meet the specifications.

D 1.52 A voltage amplifier with an input resistance of $20 \mathrm{k} \Omega$, an output resistance of $100 \Omega$, and a gain of $1000 \mathrm{~V} / \mathrm{V}$ is connected between a $100-\mathrm{k} \Omega$ source with an open-circuit voltage of 10 mV and a $100-\Omega$ load. For this situation:
(a) What output voltage results?
(b) What is the voltage gain from source to load?
(c) What is the voltage gain from the amplifier input to the load?
(d) If the output voltage across the load is twice that needed and there are signs of internal amplifier overload, suggest the location and value of a single resistor that would produce the desired output. Choose an arrangement that would cause minimum disruption to an operating circuit. (Hint: Use parallel rather than series connections.)

Figure P9.54
Assume that the BJTs are matched and have a current gain $\alpha$, and neglect the Early effect. Verify that both approaches lead to the same result.

## Section 9.3: Common-Mode Rejection

31N 9.55 An NMOS differential pair is biased by a current source $I=0.2 \mathrm{~mA}$ having an output resistance $R_{S S}=100 \mathrm{k} \Omega$. The amplifier has drain resistances $R_{D}=10 \mathrm{k} \Omega$, using transistors with $k_{u}^{\prime} W / L=3 \mathrm{~mA} / \mathrm{V}^{2}$, and $r_{o}$ that is large. If the output is taken differentially and there is a $1 \%$ mismatch between the drain resistances, find $\left|A_{d}\right|,\left|A_{c m}\right|$, and CMRR.
9.56 For the differential amplifier shown in Fig. P9.2, let $Q_{1}$ and $Q_{2}$ have $k_{u}^{\prime}(W / L)=4 \mathrm{~mA} / \mathrm{V}^{2}$, and assume that the bias current source has an output resistance of $30 \mathrm{k} \Omega$. Find $\left|V_{O V}\right|$, $g_{m},\left|A_{d}\right|,\left|A_{c m}\right|$, and the CMRR (in dB ) obtained with the output taken differentially. The drain resistances are known to have a mismatch of $2 \%$.

31N D *9.57 The differential amplifier in Fig. P9.57 utilizes a resistor $R_{S S}$ to establish a $1-\mathrm{mA}$ dc bias current. Note that this amplifier uses a single $5-\mathrm{V}$ supply and thus the dc common-mode voltage $V_{C M}$ cannot be zero. Transistors $Q_{1}$ and $Q_{2}$ have $k_{u}^{\prime} W / L=2.5 \mathrm{~mA} / \mathrm{V}^{2}, V_{i}=0.7 \mathrm{~V}$, and $\lambda=0$.
(a) Find the required value of $V_{C M}$.
(b) Find the value of $R_{D}$ that results in a differential gain $A_{d}$ of $8 \mathrm{~V} / \mathrm{V}$.
(c) Determine the dc voltage at the drains.
(d) Determine the single-ended-output common-mode gain $\Delta V_{D 1} / \Delta V_{C M}$. (Hint: You need to take $1 / g_{m}$ into account.)
(e) Use the common-mode gain found in (d) to determine the change in $V_{C M}$ that results in $Q_{1}$ and $Q_{2}$ entering the triode region.


Figure P9.57
9.58 It can be shown that if the drain resistors of a MOS differential amplifier have a mismatch $\Delta R_{D}$ and if simultaneously the transconductances of $Q_{1}$ and $Q_{2}$ have a mismatch $\Delta g_{m}$, the common-mode gain is given by

$$
A_{c m} \simeq\left(\frac{R_{D}}{2 R_{S S}}\right)\left(\frac{\Delta g_{m}}{g_{m}}+\frac{\Delta R_{D}}{R_{D}}\right)
$$

Note that this equation indicates that $R_{D}$ can be deliberately varied to compensate for the initial variability in $g_{m}$ and $R_{D}$, that is, to minimize $A_{c m}$.

In a MOS differential amplifier for which $R_{D}=5 \mathrm{k} \Omega$ and $R_{S S}=25 \mathrm{k} \Omega$, the common-mode gain is measured and found to be $0.002 \mathrm{~V} / \mathrm{V}$. Find the percentage change required in one of the two drain resistors so as to reduce $A_{c m}$ to zero (or close to zero).

D 9.59 It is required to design a MOS differential amplifier to have a CMRR of 80 dB . The only source of mismatch in the circuit is a $2 \%$ difference between the $W / L$ ratios of the two transistors. Let $I=100 \mu \mathrm{~A}$ and assume that all transistors are operated at $V_{O V}=0.2 \mathrm{~V}$. For the $0.18-\mu \mathrm{m}$ CMOS fabrication process available, $V_{A}^{\prime}=5 \mathrm{~V} / \mu \mathrm{m}$. What is the value of $L$ required for the current-source transistor?
D 9.60 A MOS differential amplifier utilizing a simple current source to provide the bias current $I$ is found to have a CMRR of 60 dB . If it is required to raise the CMRR to 100 dB by adding a cascode transistor to the current source, what must the intrinsic gain $A_{0}$ of the cascode transistor be? If the cascode transistor is operated at $V_{O V}=0.2 \mathrm{~V}$, what must its $V_{A}$ be? If for the specific technology utilized $V_{A}^{\prime}=5 \mathrm{~V} / \mu \mathrm{m}$, specify the channel length $L$ of the cascode transistor.
9.61 The differential amplifier circuit of Fig. P9.61 utilizes a resistor connected to the negative power supply to establish the bias current $I$.
(a) For $v_{B 1}=v_{o f} / 2$ and $v_{B 2}=-v_{o f} / 2$, where $v_{o f}$ is a small signal with zero average, find the magnitude of the differential gain, $\left|v_{o} / v_{o f}\right|$.
(b) For $v_{B 1}=v_{B 2}=v_{t c m}$, where $v_{t c m}$ has a zero average, find the magnitude of the common-mode gain, $\left|v_{o} / v_{t c m}\right|$.
(c) Calculate the CMRR.
(d) If $v_{B 1}=0.1 \sin 2 \pi \times 60 t+0.005 \sin 2 \pi \times 1000 t$, volts, and $v_{B 2}=0.1 \sin 2 \pi \times 60 t-0.005 \sin 2 \pi \times 1000 t$, volts, find $v_{o}$.


Figure P9.61
9.62 For the differential amplifier shown in Fig. P9.62, identify and sketch the differential half-circuit and the common-mode half-circuit. Find the differential gain, the differential input resistance, the common-mode gain assuming the resistances $R_{C}$ have $1 \%$ tolerance, and the common-mode
input resistance. For these transistors, $\beta=100$ and $V_{A}=100 \mathrm{~V}$


Figure P9.62
9.63 Consider the basic differential circuit in which the transistors have $\beta=100$ and $V_{A}=100 \mathrm{~V}$, with $I=0.2 \mathrm{~mA}$, $R_{E E}=500 \mathrm{k} \Omega$, and $R_{C}=25 \mathrm{k} \Omega$. The collector resistances are matched to within $1 \%$. Find:
(a) the differential gain
(b) the differential input resistance
(c) the common-mode gain
(d) the common-mode rejection ratio
(e) the common-mode input resistance
9.64 In a bipolar differential-amplifier circuit, the bias current generator consists of a simple common-emitter transistor operating at $200 \mu \mathrm{~A}$. For this transistor, and those used in the differential pair, $V_{A}=20 \mathrm{~V}$ and $\beta=50$. What common-mode input resistance would result? Assume $R_{C} \ll r_{o}$.
9.65 A bipolar differential amplifier with $I=0.5 \mathrm{~mA}$ utilizes transistors for which $V_{A}=50 \mathrm{~V}$ and $\beta=100$. The collector resistances $R_{C}=5 \mathrm{k} \Omega$ and are matched to within $10 \%$. Find:
(a) the differential gain
(b) the common-mode gain and the CMRR if the bias current $I$ is generated using a simple current mirror
(c) the common-mode gain and the CMRR if the bias current $I$ is generated using a Wilson mirror. (Refer to Eq. 8.95 for $R_{o}$ of the Wilson mirror.)

D 9.66 It is required to design a differential amplifier to provide the largest possible signal to a pair of $10-\mathrm{k} \Omega$ load

[^0]
[^0]:    5111 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
resistances. The input differential signal is a sinusoid of $5-\mathrm{mV}$ peak amplitude, which is applied to one input terminal while the other input terminal is grounded. The power supply $V_{C C}$ available is 5 V . To determine the required bias current $I$, derive an expression for the total voltage at each of the collectors in terms of $V_{C C}$ and $I$ in the presence of the input signal. Then impose the condition that both transistors remain well out of saturation with a minimum $v_{C B}$ of approximately 0 V . Thus determine the required value of $I$. For this design, what differential gain is achieved? What is the amplitude of the signal voltage obtained between the two collectors? Assume $\alpha \simeq 1$.

D *9.67 Design a BJT differential amplifier that provides two single-ended outputs (at the collectors). The amplifier is to have a differential gain (to each of the two outputs) of at least $100 \mathrm{~V} / \mathrm{V}$, a differential input resistance $\geq 10 \mathrm{k} \Omega$, and a common-mode gain (to each of the two outputs) no greater than $0.1 \mathrm{~V} / \mathrm{V}$. Use a $2-\mathrm{mA}$ current source for biasing. Give the complete circuit with component values and suitable power supplies that allow for $\pm 2 \mathrm{~V}$ swing at each collector. Specify the minimum value that the output resistance of the bias current source must have. If the current source is realized by a simple mirror, what must the minimum value of $V_{A}$ be? The BJTs available have $\beta \geq 100$. What is the value of the input common-mode resistance when the bias source has the lowest acceptable output resistance?
9.68 When the output of a BJT differential amplifier is taken differentially, its CMRR is found to be 34 dB higher than when the output is taken single-endedly. If the only source of common-mode gain when the output is taken differentially is the mismatch in collector resistances, what must this mismatch be (in percent)?
*9.69 In a particular BJT differential amplifier, a production error results in one of the transistors having an emitter-base junction area that is twice that of the other. With the inputs grounded, how will the emitter bias current split between the two transistors? If the output resistance of the current source is $500 \mathrm{k} \Omega$ and the resistance in each collector $\left(R_{C}\right)$ is $12 \mathrm{k} \Omega$, find the common-mode gain obtained when the output is taken differentially. Assume $\alpha \simeq 1$. [Hint: The CM signal current $v_{o m} / R_{E E}$ will split between $Q_{1}$ and $Q_{2}$ in the same ratio as the bias current $I$ does.]

## Section 9.4: DC Offset

D 9.70 An NMOS differential pair is to be used in an amplifier whose drain resistors are $10 \mathrm{k} \Omega \pm 1 \%$. For the
pair, $k_{a}^{\prime} W / L=4 \mathrm{~mA} / \mathrm{V}^{2}$. A decision is to be made concerning the bias current $I$ to be used, whether $160 \mu \mathrm{~A}$ or $360 \mu \mathrm{~A}$. Contrast the differential gain and input offset voltage for the two possibilities.

D 9.71 An NMOS differential amplifier for which the MOSFETs have a transconductance parameter $k_{a}$ and whose drain resistances $R_{D}$ have a mismatch $\triangle R_{D}$ is biased with a current $I$.
(a) Find expressions for $A_{d}$ and $V_{O S}$ in terms of $k_{a}, R_{D}$, $\triangle R_{D} / R_{D}$, and $I$. Use these expressions to relate $V_{O S}$ and $A_{d}$.
(b) If $k_{a}=4 \mathrm{~mA} / \mathrm{V}^{2}, R_{D}=10 \mathrm{k} \Omega$, and $\triangle R_{D} / R_{D}=0.02$, find the maximum gain realized if $V_{O S}$ is to be limited to 1 $\mathrm{mV}, 2 \mathrm{mV}, 3 \mathrm{mV}, 4 \mathrm{mV}$, and 5 mV . For each case, give the value of the required bias current $I$. Note the trade-off between gain and offset voltage.

D 9.72 An NMOS amplifier, whose designed operating point is at $V_{O V}=0.3 \mathrm{~V}$, is suspected to have a variability of $V_{s}$ of $\pm 5$ mV , and of $W / L$ and $R_{D}$ (independently) of $\pm 1 \%$. What is the worst-case input offset voltage you would expect to find? What is the major contribution to this total offset? If you used a variation of one of the drain resistors to reduce the output offset to zero and thereby compensate for the uncertainties (including that of the other $R_{D}$ ), what percentage change from nominal would you require?
9.73 An NMOS differential pair operating at a bias current $I$ of $100 \mu \mathrm{~A}$ uses transistors for which $k_{a}^{\prime}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $W / L=10$. Find the three components of input offset voltage under the conditions that $\Delta R_{D} / R_{D}=4 \%, \Delta(W / L) /(W / L)=$ $4 \%$, and $\Delta V_{s}=5 \mathrm{mV}$. In the worst case, what might the total offset be? For the usual case of the three effects being independent, what is the offset likely to be?
9.74 A bipolar differential amplifier uses two well-matched transistors, but collector load resistors that are mismatched by $10 \%$. What input offset voltage is required to reduce the differential output voltage to zero?
9.75 A bipolar differential amplifier uses two transistors whose scale currents $I_{S}$ differ by $10 \%$. If the two collector resistors are well matched, find the resulting input offset voltage.
9.76 Modify Eq. (9.114) for the case of a differential amplifier having a resistance $R_{E}$ connected in the emitter of each transistor. Let the bias current source be $I$.
9.77 A differential amplifier uses two transistors whose $\beta$ values are $\beta_{1}$ and $\beta_{2}$. If everything else is matched, show that

[^0]
[^0]:    9.70 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
the input offset voltage is approximately $V_{T}\left[\left(1 / \beta_{1}\right)-\left(1 / \beta_{2}\right)\right]$. Evaluate $V_{O S}$ for $\beta_{1}=50$ and $\beta_{2}=100$.
9.78 Two possible differential amplifier designs are considered, one using BJTs and the other MOSFETs. In both cases, the collector (drain) resistors are maintained within $\pm 2 \%$ of nominal value. The MOSFETs are operated at $V_{O V}=200 \mathrm{mV}$. What input offset voltage results in each case? What does the MOS $V_{O S}$ become if the devices are increased in width by a factor of 4 while the bias current is kept constant?
*9.79 A differential amplifier uses two transistors having $V_{A}$ values of 100 V and 200 V . If everything else is matched, find the resulting input offset voltage. Assume that the two transistors are intended to be biased at a $V_{C E}$ of about 10 V .
*9.80 A differential amplifier is fed in a balanced or push-pull manner, and the source resistance in series with each base is $R_{s}$. Show that a mismatch $\Delta R_{s}$ between the values of the two source resistances gives rise to an input offset voltage of approximately $(I / 2 \beta) \Delta R_{s} /\left[1+\left(g_{m} R_{s}\right) / \beta\right]$.
9.81 One approach to "offset correction" involves the adjustment of the values of $R_{C 1}$ and $R_{C 2}$ so as to reduce the differential output voltage to zero when both input terminals are grounded. This offset-nulling process can be accomplished by utilizing a potentiometer in the collector circuit, as shown in Fig. P9.81. We wish to find the


Figure P9.81
potentiometer setting, represented by the fraction $x$ of its value connected in series with $R_{C 1}$, that is required for nulling the output offset voltage that results from:
(a) $R_{C 1}$ being $4 \%$ higher than nominal and $R_{C 2} 4 \%$ lower than nominal
(b) $Q_{1}$ having an area $5 \%$ larger than nominal, while $Q_{2}$ has area $5 \%$ smaller than nominal.
9.82 A differential amplifier for which the total emitter bias current is $400 \mu \mathrm{~A}$ uses transistors for which $\beta$ is specified to lie between 80 and 200. What is the largest possible input bias current? The smallest possible input bias current? The largest possible input offset current?
**9.83 In a particular BJT differential amplifier, a production error results in one of the transistors having an emitter-base junction area twice that of the other. With both inputs grounded, find the current in each of the two transistors and hence the dc offset voltage at the output, assuming that the collector resistances are equal. Use small-signal analysis to find the input voltage that would restore current balance to the differential pair. Repeat using large-signal analysis and compare results.

D 9.84 A large fraction of mass-produced differentialamplifier modules employing $20-\mathrm{k} \Omega$ collector resistors is found to have an input offset voltage ranging from +2 mV to -2 mV . By what amount must one collector resistor be adjusted to reduce the input offset to zero? If an adjustment mechanism is devised that raises one collector resistance while correspondingly lowering the other, what resistance change is needed? If a potentiometer connected as shown in Fig. P9.81 is used, what value of potentiometer resistance (specified to 1 significant digit) is needed? Assume that the offset is entirely due to the finite tolerance of $R_{C}$.

## Section 9.5: The Differential Amplifier with a Current-Mirror Load

9.85 The differential amplifier of Fig. 9.32(a) is measured and found to have a short-circuit transconductance of $2 \mathrm{~mA} / \mathrm{V}$. A differential input signal is applied and the output voltage is measured with a load resistance $R_{L}$ connected. It is found that when $R_{L}$ is reduced from $\infty$ to $20 \mathrm{k} \Omega$, the magnitude of the output signal is reduced by half. What do you estimate $R_{o}$ and $A_{d}$ (with $R_{L}$ disconnected) to be?
9.86 A current-mirror-loaded NMOS differential amplifier is fabricated in a technology for which $\left|V_{A}^{\prime}\right|=5 \mathrm{~V} / \mu \mathrm{m}$. All the

[^0]
[^0]:    9.79 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
transistors have $L=0.5 \mu \mathrm{~m}$. If the differential-pair transistors are operated at $V_{O V}=0.25 \mathrm{~V}$, what open-circuit differential gain is realized?
9.87 The differential amplifier of Fig. 9.32(a) is biased with $I=200 \mu \mathrm{~A}$. All transistors have $L=0.5 \mu \mathrm{~m}$, and $Q_{1}$ and $Q_{2}$ have $W / L=50$. The circuit is fabricated in a process for which $\mu_{n} C_{o s}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $\left|V_{A}^{\prime}\right|=5 \mathrm{~V} / \mu \mathrm{m}$. Find $g_{m 1,2}$, $r_{o 2}, r_{o 4}$, and $A_{d}$.
D 9.88 In a current-mirror-loaded differential amplifier of the form shown in Fig. 9.32(a), all transistors are characterized by $k^{\prime} W / L=4 \mathrm{~mA} / \mathrm{V}^{2}$, and $\left|V_{A}\right|=5 \mathrm{~V}$. Find the bias current $I$ for which the gain $v_{o} / v_{i d}=20 \mathrm{~V} / \mathrm{V}$.
D 9.89 Consider a current-mirror-loaded differential amplifier such as that shown in Fig. 9.32(a) with the bias current source implemented with the modified Wilson mirror of Fig. P9.89 with $I=200 \mu \mathrm{~A}$. The transistors have $\left|V_{i}\right|=0.5 \mathrm{~V}$ and $k^{\prime} W / L=5 \mathrm{~mA} / \mathrm{V}^{2}$. What is the lowest value of the total power supply $\left(V_{D D}+V_{S S}\right)$ that allows each transistor to operate with $\left|V_{D S}\right| \geq\left|V_{G S}\right|$ ?
*9.90 (a) Sketch the circuit of a current-mirror-loaded MOS differential amplifier in which the input transistors are cascoded and a cascode current mirror is used for the load.
(b) Show that if all transistors are operated at an overdrive voltage $V_{O V}$ and have equal Early voltages $\left|V_{A}\right|$, the gain is given by

$$
A_{d}=2\left(V_{A} / V_{O V}\right)^{2}
$$

Evaluate the gain for $V_{O V}=0.20 \mathrm{~V}$ and $V_{A}=10 \mathrm{~V}$.
9.91 Figure P9.91 shows the current-mirror-loaded MOS differential amplifier prepared for small-signal analysis. We have "pulled out" $r_{o}$ of each transistor; thus, the current in the drain of each transistor will be $g_{m} v_{g s}$. To help the reader, we have already indicated approximate values for some of the node voltages. For instance, the output voltage $v_{o}=$ $\frac{1}{2}\left(g_{m} r_{o}\right) v_{i d}$, which we have derived in the text. The voltage at the common sources has been found to be approximately $+v_{i d} / 4$, which is very far from the virtual ground one might assume. Also, the voltage at the gate of the mirror is approximately $-v_{i d} / 4$, confirming our contention that the voltage there is vastly different from the output voltage, hence the lack of balance in the circuit and the unavailability of a differential half-circuit. Find the currents labeled $i_{1}$ to $i_{13}$ in terms of $\left(g_{m} v_{i d}\right)$. Determine their values in the sequence of their numbering and assume $g_{m} r_{o} \gg 1$. Note that all transistors are assumed to be operating at the same $\left|V_{O V}\right|$. Write the current values on the circuit diagram and reflect on the results.


Figure P9.89


Figure P9.91

[^0]
[^0]:    ${ }^{\text {TIE }}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
9.92 A current-mirror-loaded NMOS differential amplifier operates with a bias current $I$ of $200 \mu \mathrm{~A}$. The NMOS transistors are operated at $V_{O V}=0.2 \mathrm{~V}$ and the PMOS devices at $\left|V_{O V}\right|=0.3 \mathrm{~V}$. The Early voltages are 20 V for the NMOS and 12 V for the PMOS transistors. Find $G_{m}, R_{o}$, and $A_{d}$. For what value of load resistance is the gain reduced by a factor of 2 ?
9.93 This problem investigates the effect of transistor mismatches on the input offset voltage of the current-mirror-loaded MOS differential amplifier of Fig. 9.32(a). For this purpose, ground both input terminals and short-circuit the output node to ground.
(a) If the amplifying transistors $Q_{1}$ and $Q_{2}$ exhibit a $W / L$ mismatch of $\Delta(W / L)_{A}$, find the resulting short-circuit output current and hence show that the corresponding $V_{O S}$ is given by

$$
V_{O S 1}=\left(V_{O V} / 2\right) \frac{\Delta(W / L)_{A}}{(W / L)_{A}}
$$

where $V_{O V}$ is the overdrive voltage at which $Q_{1}$ and $Q_{2}$ are operating.
(b) Repeat for a mismatch $\Delta(W / L)_{M}$ in the $W / L$ ratios of the mirror transistor $Q_{3}$ and $Q_{4}$ to show that the corresponding $V_{O S}$ is given by

$$
V_{O S 2}=\left(V_{O V} / 2\right) \frac{\Delta(W / L)_{M}}{(W / L)_{M}}
$$

where $V_{O V}$ is the overdrive voltage at which $Q_{1}$ and $Q_{2}$ are operating.
(c) For a circuit in which all transistors are operated at $\left|V_{O V}\right|=0.2 \mathrm{~V}$ and all $W / L$ ratios are accurate to within $\pm 1 \%$ of nominal, find the worst-case total offset voltage $V_{O S}$.
9.94 The differential amplifier in Fig. 9.36(a) is operated with $I=500 \mu \mathrm{~A}$, with devices for which $V_{d}=10 \mathrm{~V}$ and $\beta=100$. What differential input resistance, output resistance, short-circuit transconductance, and open-circuit voltage gain would you expect? What will the voltage gain be if the input resistance of the subsequent stage is equal to $R_{i d}$ of this stage?
9.95 A bipolar differential amplifier having a simple pnp current-mirror load is found to have an input offset voltage of 2 mV . If the offset is attributable entirely to the finite $\beta$ of the pnp transistors, what must $\beta_{P}$ be?
9.96 For the current-mirror-loaded bipolar differential pair, replacing the simple current-mirror load by the base-current-compensated mirror of Fig. 8.11, find the expected systematic input offset voltage. Evaluate $V_{O S}$ for $\beta_{P}=50$.
9.97 For the current-mirror-loaded bipolar differential pair, replacing the simple current-mirror load by the Wilson mirror of Fig. 8.40(a), find the expected systematic input offset voltage. Evaluate $V_{O S}$ for $\beta_{P},=50$.
9.98 Figure P9.98 shows a differential cascode amplifier with an active load formed by a Wilson current mirror. Utilizing the expressions derived in Chapter 8 for the output resistance of a bipolar cascode and the output resistance of the Wilson mirror, and assuming all transistors to be identical, show that the differential voltage gain $A_{d}$ is given approximately by

$$
A_{d}=\frac{1}{3} \beta g_{m} r_{o}
$$

Evaluate $A_{d}$ for the case of $\beta=100$ and $V_{A}=20 \mathrm{~V}$.


Figure P9.98
D 9.99 Consider the bias design of the Wilson-loaded cascode differential amplifier shown in Fig. P9.98.
(a) What is the largest signal voltage possible at the output without $Q_{7}$ saturating? Assume that the CB junction conducts when the voltage across it exceeds 0.4 V .
(b) What should the dc bias voltage established at the output (by an arrangement not shown) be in order to allow for positive output signal swing of 1.5 V ?
(c) What should the value of $V_{\text {BIAS }}$ be in order to allow for a negative output signal swing of 1.5 V ?
(d) What is the upper limit on the input common-mode voltage $v_{C M}$ ?
**9.100 Figure P9.100 shows a modified cascode differential amplifier. Here $Q_{3}$ and $Q_{4}$ are the cascode transistors. However, the manner in which $Q_{3}$ is connected with its base current feeding the current mirror $Q_{7}-Q_{8}$ results in very interesting input properties. Note that for simplicity the circuit is shown with the base of $Q_{2}$ grounded. Assume that all transistors have equal $\beta$ 's.


Figure P9. 100
(a) With $v_{I}=0 \mathrm{~V} \mathrm{dc}$, find the input bias current $I_{B}$ assuming all transistors have equal value of $\beta$. Compare with the case without the $Q_{7}-Q_{8}$ connection.
(b) With $v_{I}=0 \mathrm{~V}(\mathrm{dc})+v_{c d}$, find the input signal current $i_{i}$ and hence the input differential resistance $R_{c d}$. Compare with the case without the $Q_{7}-Q_{8}$ connection. By what factor does $R_{c d}$ increase?
9.101 For the folded-cascode differential amplifier of Fig. 9.38, find the value of $V_{\text {BIAS }}$ that results in the largest possible positive output swing, while keeping $Q_{3}, Q_{4}$, and the $p n p$ transistors that realize the current sources out of saturation. Assume $V_{C C}=V_{E E}=5 \mathrm{~V}$. If the dc level at the output is 0 V , find the maximum allowable output signal swing. For $I=0.5 \mathrm{~mA}, \beta_{p}=50, \beta_{N}=100$, and $V_{A}=100 \mathrm{~V}$ find $G_{m}, R_{o S}, R_{o S}, R_{o}$, and $A_{d}$.
9.102 For the BiCMOS differential amplifier in Fig. P9.102 let $V_{D D}=V_{S S}=3 \mathrm{~V}, I=0.2 \mathrm{~mA}, k_{b}^{\prime} W / L=6.4 \mathrm{~mA} / \mathrm{V}^{2} ;\left|V_{A}\right|$ for $p$-channel MOSFETs is $10 \mathrm{~V},\left|V_{A}\right|$ for $n p n$ transistors is 30 V . Find $G_{m}, R_{o}$, and $A_{d}$.


Figure P9. 102
S10 D 9.103 It is required to design the current-mirrorloaded differential MOS amplifier of Fig. 9.32 to obtain a differential gain of $50 \mathrm{~V} / \mathrm{V}$. The technology available provides $\mu_{n} C_{o s}=4 \mu_{p} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2},\left|V_{i}\right|=0.5 \mathrm{~V}$, and $\left|V_{A}^{\prime}\right|=$ $20 \mathrm{~V} / \mu \mathrm{m}$ and operates from $\pm 1 \mathrm{~V}$ supplies. Use a bias current $I=200 \mu \mathrm{~A}$ and operate all devices at $\left|V_{O V}\right|=0.2 \mathrm{~V}$.
(a) Find the $W / L$ ratios of the four transistors.
(b) Specify the channel length required of all transistors.
(c) If $V_{I C M}=0$, what is the allowable range of $v_{O}$ ?
(d) If $I$ is delivered by a simple NMOS current source operated at the same $V_{O V}$ and having the same channel length as the other four transistors, determine the CMRR obtained.
9.104 Consider the current-mirror-loaded MOS differential amplifier of Fig. 9.32(a) in two cases:
(a) Current source $I$ is implemented with a simple current mirror.
(b) Current source $I$ is implemented with the modified Wilson current mirror shown in Fig. P9.104.

Recalling that for the simple mirror $\left.R_{S S}=r_{o}\right|_{Q_{0}}$ and for the Wilson mirror $R_{S S} \simeq g_{m 7} r_{o 7} r_{o 5}$, and assuming that all transistors have the same $\left|V_{A}\right|$ and $k^{\prime} W / L$, show that for case (a)

$$
\mathrm{CMRR}=2\left(\frac{V_{A}}{V_{O V}}\right)^{2}
$$

and for case (b)

$$
\mathrm{CMRR}=2 \sqrt{2}\left(\frac{V_{A}}{V_{O V}}\right)^{2}
$$

where $V_{O V}$ is the overdrive voltage that corresponds to a drain current of $I / 2$. For $k^{\prime} W / L=4 \mathrm{~mA} / \mathrm{V}^{2}, I=160 \mu \mathrm{~A}$, and $\left|V_{A}\right|=5 \mathrm{~V}$, find CMRR for both cases.


Figure P9. 104
9.105 The MOS differential amplifier of Fig. 9.32(a) is biased with a simple current mirror delivering $I=200 \mu \mathrm{~A}$. All transistors are operated at $V_{O V}=0.2 \mathrm{~V}$ and have $V_{A}=5 \mathrm{~V}$. Find $G_{m}, R_{o}, A_{d}, R_{S S}, G_{m c m}, R_{i m}, A_{m}, R_{o m}, R_{o 2}, A_{c m}$, and CMRR.
9.106 A current-mirror-loaded MOS differential amplifier is found to have a differential voltage gain $A_{d}$ of $30 \mathrm{~V} / \mathrm{V}$. Its bias current source has an output resistance $R_{S S}=45 \mathrm{k} \Omega$. The current mirror utilized has a current gain $A_{m}$ of $0.98 \mathrm{~A} / \mathrm{A}$ and an output resistance $R_{o m}$ of $45 \mathrm{k} \Omega$. If the common-mode output resistances of the amplifier, $R_{o 1}$ and $R_{o 2}$, are very large, find $A_{c m}$ and CMRR.
9.107 A current-mirror-loaded MOS differential amplifier is found to have a differential voltage gain $A_{d}$ of $50 \mathrm{~V} / \mathrm{V}$ and a CMRR of 60 dB . If the output resistance of the bias current source is $20 \mathrm{k} \Omega$ and the output resistance of the current-mirror load is $20 \mathrm{k} \Omega$, what is the expected magnitude of the deviation from unity of the current gain of the load mirror?

D *9.108 Design the circuit of Fig. 9.36(a) using a basic current mirror to implement the current source $I$. It is required that the short-circuit transconductance be $5 \mathrm{~mA} / \mathrm{V}$. Use $\pm 5-\mathrm{V}$ power supplies and BJTs that have $\beta=100$ and $V_{A}=100 \mathrm{~V}$. Give the complete circuit with component values and specify the differential input resistance $R_{i d}$, the output resistance $R_{o}$, the open-circuit voltage gain $A_{d}$, the input bias current, the input common-mode range, the common-mode gain, and the CMRR.

D *9.109 Repeat the design of the amplifier specified in Problem 9.108 utilizing a Widlar current source (Fig. 8.42) to supply the bias current. Assume that the largest resistance available is $2 \mathrm{k} \Omega$.
9.110 A bipolar differential amplifier such as that shown in Fig. 9.36(a) has $I=0.4 \mathrm{~mA}, V_{A}=40 \mathrm{~V}$, and $\beta=150$. Find $G_{m}, R_{o}, A_{d}$, and $R_{o 1}$. If the bias current source is implemented with a simple $n p n$ current mirror, find $R_{E E}, A_{c m}$, and CMRR. If the amplifier is fed differentially with a source having a total of $30 \mathrm{k} \Omega$ resistance (i.e., $15 \mathrm{k} \Omega$ in series with the base lead of each of $Q_{1}$ and $Q_{2}$ ), find the overall differential voltage gain.

[^0]
[^0]:    504 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
9.111 For the current-mirror-loaded differential pair in Fig. P9.111, find:
(a) differential input resistance, $R_{i d}$
(b) $A_{d}$
(c) CMRR

Assume $\beta=100,\left|V_{B E}\right|=0.7 \mathrm{~V}$, and $\left|V_{A}\right|=60 \mathrm{~V}$.


Figure P9.111
9.112 For the current-mirror-loaded differential amplifier in Fig. P9.112, find:
(a) differential input resistance, $R_{i d}$
(b) $A_{d}$
(c) CMRR

Assume $\beta=100,\left|V_{B E}\right|=0.7 \mathrm{~V},\left|V_{A}\right|=60 \mathrm{~V}, V_{r}=0.7 \mathrm{~V}$, and $k^{\prime}(W / L)=2 \mathrm{~mA} / \mathrm{V}^{2}$.


Figure P9.112

## Section 9.6: Multistage Amplifiers

9.113 Consider the circuit in Fig. 9.40 with the device geometries (in $\mu \mathrm{m}$ ) shown in Table P9.113. Let $I_{\mathrm{REF}}=225 \mu \mathrm{~A},\left|V_{i}\right|=0.75 \mathrm{~V}$ for all devices, $\mu_{n} C_{e x}=180 \mu \mathrm{~A} / \mathrm{V}^{2}, \mu_{p} C_{e x}=60 \mu \mathrm{~A} / \mathrm{V}^{2},\left|V_{A}\right|=9 \mathrm{~V}$ for all devices, $V_{D D}=V_{S S}=1.5 \mathrm{~V}$. Determine the width of $Q_{h}, W$, that will ensure that the op amp will not have a systematic offset voltage. Then, for all devices evaluate $I_{D},\left|V_{O V}\right|,\left|V_{O S}\right|$, $g_{m}$, and $r_{o}$. Provide your results in a table similar to Table 9.1. Also find $A_{1}, A_{2}$, the open-loop voltage gain, the input

[^0]
[^0]:    $\mathrm{III}=\operatorname{Multisim} / \mathrm{PSpice} ;{ }^{*}=$ difficult problem; ${ }^{* *}=$ more difficult; ${ }^{* * *}=$ very challenging; $\mathrm{D}=$ design problem
Table P9.113

| Transistor | $Q_{1}$ | $Q_{2}$ | $Q_{3}$ | $Q_{4}$ | $Q_{5}$ | $Q_{6}$ | $Q_{7}$ | $Q_{8}$ |
| :-- | :-- | :-- | :-- | :-- | :-- | :-- | :-- | :-- |
| $W / L$ | $30 / 0.5$ | $30 / 0.5$ | $10 / 0.5$ | $10 / 0.5$ | $60 / 0.5$ | $W / 0.5$ | $60 / 0.5$ | $60 / 0.5$ |

common-mode range, and the output voltage range. Neglect the effect of $V_{A}$ on the bias currents.

D 9.114 The two-stage CMOS op amp in Fig. P9.114 is fabricated in a $0.18-\mu \mathrm{m}$ technology having $k_{n}^{\prime}=4 k_{p}^{\prime}=$ $400 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{m}=-V_{q s}=0.4 \mathrm{~V}$.
(a) With A and B grounded, perform a dc design that will result in each of $Q_{1}, Q_{2}, Q_{3}$, and $Q_{4}$ conducting a drain current of $100 \mu \mathrm{~A}$ and each of $Q_{6}$ and $Q_{7}$ a current of $200 \mu \mathrm{~A}$. Design so that all transistors operate at $0.2-\mathrm{V}$ overdrive voltages. Specify the $W / L$ ratio required for each MOSFET. Present your results in tabular form. What is the dc voltage at the output (ideally)?
(b) Find the input common-mode range.
(c) Find the allowable range of the output voltage.
(d) With $v_{A}=v_{o f} / 2$ and $v_{B}=-v_{o f} / 2$, find the voltage gain $v_{o} / v_{o f}$. Assume an Early voltage of 6 V .

D 9.115 In a particular design of the CMOS op amp of Fig. 9.40 the designer wishes to investigate the effects of increasing the $W / L$ ratio of both $Q_{1}$ and $Q_{2}$ by a factor of 4 . Assuming that all other parameters are kept unchanged, refer to Example 9.6 to help you answer the following questions:
(a) Find the resulting change in $\left|V_{D V}\right|$ and in $g_{m}$ of $Q_{1}$ and $Q_{2}$.
(b) What change results in the voltage gain of the input stage? In the overall voltage gain?
(c) What is the effect on the input offset voltages? (You might wish to refer to Section 9.4).


Figure P9.114

[^0]
[^0]:    $S I I I$ = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem9.116 Consider the amplifier of Fig. 9.40, whose parameters are specified in Example 9.6. If a manufacturing error results in the $W / L$ ratio of $Q_{3}$ being $48 / 0.8$, find the current that $Q_{3}$ will now conduct. Thus find the systematic offset voltage that will appear at the output. (Use the results of Example 9.6.) Assuming that the open-loop gain will remain approximately unchanged from the value found in Example 9.6, find the corresponding value of input offset voltage, $V_{O S}$.
9.117 Consider the input stage of the CMOS op amp in Fig. 9.40 with both inputs grounded. Assume that the two sides of the input stage are perfectly matched except that the threshold voltages of $Q_{3}$ and $Q_{4}$ have a mismatch $\Delta V_{t}$. Show that a current $g_{m 3} \Delta V_{t}$ appears at the output of the first stage. What is the corresponding input offset voltage?
9.118 The two-stage op amp in Figure P9.114 is fabricated in a $65-\mathrm{nm}$ technology having $k_{n}^{\prime}=5.4 \times k_{b}^{\prime}=540 \mu \mathrm{~A} / \mathrm{V}^{2}$ and $V_{t n}=-V_{t p}=0.35 \mathrm{~V}$. The amplifier is operated with $V_{D D}=+1.2 \mathrm{~V}$ and $V_{S S}=0 \mathrm{~V}$.
(a) With A and B at a dc voltage of $V_{D D} / 2$, perform a dc design that will result in each of $Q_{1}, Q_{2}, Q_{3}$, and $Q_{4}$ conducting a drain current of $200 \mu \mathrm{~A}$ and each of $Q_{6}$ and $Q_{7}$ conducting a current of $400 \mu \mathrm{~A}$. Design so that all transistors operate at $0.15-\mathrm{V}$ overdrive voltages. Specify the W/L ratio required for each MOSFET. Present all results in a table.
(b) Find the input common-mode range.
(c) Find the allowable range of the output voltage.
(d) With $v_{A}=v_{o l} / 2$ and $v_{B}=-v_{o l} / 2$, find the voltage gain $v_{o} / v_{o l}$. Assume an Early voltage of 1.8 V .
*9.119 Figure P9.119 shows a bipolar op-amp circuit that resembles the CMOS op amp of Fig. 9.40. Here, the input differential pair $Q_{1}-Q_{2}$ is loaded in a current mirror formed by $Q_{3}$ and $Q_{4}$. The second stage is formed by the current-source-loaded common-emitter transistor $Q_{5}$. Unlike the CMOS circuit, here there is an output stage formed by the emitter follower $Q_{6}$. The function of capacitor $C_{C}$ will be explained later, in Chapter 11. All transistors have $\beta=100,\left|V_{B E}\right|=0.7 \mathrm{~V}$, and $r_{o}=\infty$.


Figure P9.119

[^0]
[^0]:    9115 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
(a) For inputs grounded and output held at 0 V (by negative feedback, not shown) find the emitter currents of all transistors.
(b) Calculate the gain of the amplifier with $R_{L}=1 \mathrm{k} \Omega$.
9.120 A BJT differential amplifier, biased to have $r_{e}=50 \Omega$ and utilizing two $50-\Omega$ emitter resistors and $5-\mathrm{k} \Omega$ loads, drives a second differential stage biased to have $r_{e}=25 \Omega$. All BJTs have $\beta=100$. What is the voltage gain of the first stage? Also find the input resistance of the first stage, and the current gain from the input of the first stage to the collectors of the second stage.
9.121 In the multistage amplifier of Fig. 9.41, emitter resistors are to be introduced- $100 \Omega$ in the emitter lead of each of the first-stage transistors and $25 \Omega$ for each of the second-stage transistors. What is the effect on input resistance, the voltage gain of the first stage, and the overall voltage gain? Use the bias values found in Example 9.7.

D 9.122 Consider the circuit of Fig. 9.41 and its output resistance. Which resistor has the most effect on the output resistance? What should this resistor be changed to if the output resistance is to be reduced by a factor of 2 ? What will the amplifier gain become after this change? What other change can you make to restore the amplifier gain to approximately its prior value?

D 9.123 (a) If, in the multistage amplifier of Fig. 9.41, the resistor $R_{\mathrm{x}}$ is replaced by a constant-current source $\simeq 1 \mathrm{~mA}$, such that the bias situation is essentially unaffected, what does the overall voltage gain of the amplifier become? Assume that the output resistance of the current source is very high. Use the results of Example 9.8.
(b) With the modification suggested in (a), what is the effect of the change on output resistance? What is the overall gain of the amplifier when loaded by $100 \Omega$ to ground? The original amplifier (before modification) has an output resistance of $152 \Omega$ and a voltage gain of $8513 \mathrm{~V} / \mathrm{V}$. What is its gain when loaded by $100 \Omega$ ? Comment. Use $\beta=100$.
*9.124 Figure P9.124 shows a three-stage amplifier in which the stages are directly coupled. The amplifier, however, utilizes bypass capacitors, and, as such, its frequency response falls off at low frequencies. For our purposes here, we shall assume that the capacitors are large enough to act as perfect short circuits at all signal frequencies of interest.


Figure P9.124
(a) Find the dc bias current in each of the three transistors. Also find the dc voltage at the output. Assume $\left|V_{B E}\right|=$ $0.7 \mathrm{~V}, \beta=100$, and neglect the Early effect.
(b) Find the input resistance and the output resistance.
(c) Use the current-gain method to evaluate the voltage gain $v_{o} / v_{i}$.
9.125 For the current mirror in Fig. P9.125, replace the transistors with their hybrid- $\pi$ models and show that:

$$
\begin{gathered}
R_{i}=\frac{1}{g_{m 1}} \| r_{o 1} \\
A_{i s} \simeq A_{i s} \left\lvert\,_{\text {ideal }}\left(1-\frac{1}{g_{m 1} r_{o 1}}\right)\right. \\
\left.A_{i s}\right|_{\text {ideal }}=g_{m 2} / g_{m 1} \\
R_{o}=r_{o 2}
\end{gathered}
$$

where $A_{i s}$ denotes the short-circuit current gain.


Figure P9.125
**9.126 The MOS differential amplifier shown in Fig. P9.126 utilizes three current mirrors for signal transmission: $Q_{4}-Q_{6}$ has a transmission factor of 2 [i.e., $\left.(W / L)_{4} /(W / L)_{4}=2\right], Q_{3}-Q_{5}$ has a transmission factor of 1 , and $Q_{3}-Q_{8}$ has a transmission factor of 2 . All transistors are sized to operate at the same overdrive voltage, $\left|V_{O V}\right|$. All transistors have the same Early voltage $\left|V_{A}\right|$.


Figure P9.126
(a) Provide in tabular form the values of $I_{D}, g_{m}$, and $r_{o}$ of each of the eight transistors in terms of $I, V_{O V}$, and $V_{A}$.
(b) Show that the differential voltage gain $A_{d}$ is given by

$$
A_{d}=2 g_{m 1}\left(r_{o 6} \| r_{o 8}\right)=V_{A} / V_{O V}
$$

(c) Show that the CM gain is given by

$$
\left|A_{c m}\right| \simeq \frac{r_{o 6} \| r_{o 8}}{R_{S S}} \frac{1}{g_{m 2} r_{o 7}}
$$

where $R_{S S}$ is the output resistance of the bias current source I. [Hint: Replace each of $Q_{1}$ and $Q_{2}$ together with their source resistance $2 R_{S S}$ with a controlled current-source $v_{o, m} / 2 R_{S S}$ and an output resistance. For each current mirror, the current transfer ratio is given by

$$
A_{i} \simeq A_{i}(\text { ideal })\left(1-\frac{1}{g_{m} r_{o}}\right)
$$

where $g_{m}$ and $r_{o}$ are the parameters of the input transistor of the mirror. (see Problem 9.125 above.)]
(d) If the current source $I$ is implemented using a simple mirror and the MOS transistor is operated at the same
$V_{O V}$, show that the CMRR is given by

$$
\mathrm{CMRR}=4\left(V_{A} / V_{O V}\right)^{2}
$$

(e) Find the input CM range and the output linear range in terms of $V_{D D},\left|V_{i}\right|$, and $\left|V_{O V}\right|$.

D ***9.127 For the circuit shown in Fig. P9.127, which uses a folded cascode involving transistor $Q_{3}$, all transistors have $\left|V_{B E}\right|=0.7 \mathrm{~V}$ for the currents involved, $V_{A}=200 \mathrm{~V}$, and $\beta=100$. The circuit is relatively conventional except for $Q_{5}$, which operates in a Class B mode (we will study this in Chapter 12) to provide an increased negative output swing for low-resistance loads.


Figure P9.127
(a) Perform a bias calculation assuming $\left|V_{B E}\right|=0.7 \mathrm{~V}$, high $\beta, V_{A}=\infty, v_{o}=v_{-}=0 \mathrm{~V}$, and $v_{O}$ is stabilized by feedback to about 0 V . Find $R$ so that the reference current $I_{\text {REF }}$ is $100 \mu \mathrm{~A}$. What are the voltages at all the labeled nodes?
(b) Provide in tabular form the bias currents in all transistors together with $g_{m}$ and $r_{o}$ for the signal transistors $\left(Q_{1}, Q_{2}\right.$, $Q_{3}, Q_{4}$, and $\left.Q_{5}\right)$ and $r_{o}$ for $Q_{C}, Q_{D}$, and $Q_{G}$.
(c) Now, using $\beta=100$, find the voltage gain $v_{o} /\left(v_{o}-v_{-}\right)$, and in the process, verify the polarity of the input terminals.
(d) Find the input and output resistances.
(e) Find the input common-mode range for linear operation.
(f) For no load, what is the range of available output voltages, assuming $\left|V_{C E s a t}\right|=0.3 \mathrm{~V}$ ?
(g) Now consider the situation with a load resistance connected from the output to ground. At the positive and negative limits of the output signal swing, find the smallest load resistance that can be driven if one or the other of $Q_{1}$ or $Q_{2}$ is allowed to cut off.
D ***9.128 In the CMOS op amp shown in Fig. P9.128, all MOS devices have $\left|V_{i}\right|=1 \mathrm{~V}, \mu_{n} C_{o s}=2 \mu_{p} C_{o s}=40 \mu \mathrm{~A} / \mathrm{V}^{2}$, $\left|V_{A}\right|=50 \mathrm{~V}$, and $L=5 \mu \mathrm{~m}$. Device widths are indicated on the diagram as multiples of $W$, where $W=5 \mu \mathrm{~m}$.
(a) Design $R$ to provide a $10-\mu \mathrm{A}$ reference current.
(b) Assuming $v_{D}=0 \mathrm{~V}$, as established by external feedback, perform a bias analysis, finding all the labeled node voltages, and $V_{G S}$ and $I_{D}$ for all transistors.
(c) Provide in table form $I_{D}, V_{G S}, g_{m}$, and $r_{o}$ for all devices.
(d) Calculate the voltage gain $v_{o} /\left(v_{+}-v_{-}\right)$, the input resistance, and the output resistance.
(e) What is the input common-mode range?
(f) What is the output signal range for no load?
(g) For what load resistance connected to ground is the output negative voltage limited to -1 V before $Q_{2}$ begins to conduct?
(h) For a load resistance one-tenth of that found in (g), what is the output signal swing?


Figure P9.128
# CHAPTER 10 

## Frequency Response

Introduction 697
10.1 Low-Frequency Response of Discrete-Circuit Common-Source and Common-Emitter Amplifiers 699
10.2 Internal Capacitive Effects and the High-Frequency Model of the MOSFET and the BJT 711
10.3 High-Frequency Response of the CS and CE Amplifiers 722
10.4 Useful Tools for the Analysis of the High-Frequency Response of Amplifiers 739
10.5 High-Frequency Response of the Common-Gate and Cascode Amplifiers 748
10.6 High-Frequency Response of the Source and Emitter Followers 760
10.7 High-Frequency Response of Differential Amplifiers 768
10.8 Other Wideband Amplifier Configurations 778

Summary 788
Problems 789
# IN THIS CHAPTER YOU WILL LEARN 

1. How coupling and bypass capacitors cause the gain of discrete-circuit amplifiers to fall off at low frequencies, and how to obtain an estimate of the frequency $f_{L}$ at which the gain decreases by 3 dB below its value at midband.
2. The internal capacitive effects present in the MOSFET and the BJT and how to model these effects by adding capacitances to the hybrid- $\pi$ or $T$ model of each of the two transistor types.
3. The high-frequency limitation on the gain of the CS and CE amplifiers, and how the gain falloff and the upper 3-dB frequency $f_{H}$ are mostly determined by the small capacitance between the drain and gate (collector and base).
4. Powerful methods for the analysis of the high-frequency response of amplifier circuits of varying complexity.
5. How the cascode amplifier studied in Chapter 8 can be designed to obtain wider bandwidth than is possible with the CS and CE amplifiers.
6. The high-frequency performance of the source and emitter followers.
7. The high-frequency performance of differential amplifiers.
8. Circuit configurations for obtaining wideband amplification.

## Introduction

Our study of transistor amplifiers in Chapters 5 through 9 has assumed that their gain is constant independent of the frequency of the input signal. This would imply that their bandwidth is infinite, which of course is not true! To illustrate, we show in Fig. 10.1 a sketch of the magnitude of the gain versus the frequency of the input signal of a discrete-circuit BJT or MOS amplifier. Observe that there is indeed a wide frequency range over which the gain remains almost constant. This is the useful frequency range of operation for the particular amplifier. Thus far, we have been assuming that our amplifiers are operating in this band, called the middle-frequency band or midband. The amplifier is designed so that its midband coincides with the frequency spectrum of the signals it is required to amplify. If this were not the case, the amplifier would distort the frequency spectrum of the input signal, with different components of the input signal being amplified by different amounts.


Figure 10.1 Sketch of the magnitude of the gain of a discrete-circuit BJT or MOS amplifier versus frequency. The graph delineates the three frequency bands relevant to frequency-response determination.

Figure 10.1 indicates that at lower frequencies, the magnitude of the amplifier gain falls off. This occurs because the coupling and bypass capacitors no longer have low impedances. Recall that we assumed that their impedances were small enough to act as short circuits. Although this can be true at midband frequencies, as the frequency of the input signal is lowered, the reactance $1 / j \omega C$ of each of these capacitors becomes significant and, as will be shown in Section 10.1, this results in a decrease in the overall voltage gain of the amplifier. In the analysis of the low-frequency response of discrete-circuit amplifiers in Section 10.1 we will be particularly interested in the determination of the frequency $f_{L}$, which defines the lower end of the midband. It is usually defined as the frequency at which the gain drops by 3 dB below its value in midband. Integrated-circuit amplifiers do not utilize coupling and bypass capacitors, and thus their midband extends down to zero frequency (dc), as shown in Fig. 10.2.

Figures 10.1 and 10.2 indicate that the gain of the amplifier falls off at the high-frequency end. This is due to internal capacitive effects in the BJT and in the MOSFET. We shall study these effects in Section 10.2 and model them with capacitances that we will add to the hybrid- $\pi$ or T model of the BJT and the MOSFET. The resulting high-frequency device models will be utilized in Section 10.3 in the analysis of the high-frequency response of the CS and CE amplifiers, both discrete and integrated. We will be specifically interested in the determination of the frequency $f_{H}$, which defines the upper end of the midband. It is defined as the frequency at which the gain drops by 3 dB below its midband value. Thus, the amplifier bandwidth is defined by $f_{L}$ and $f_{H}\left(0\right.$ and $f_{H}$ for IC amplifiers):

$$
\begin{aligned}
& \mathrm{BW}=f_{H}-f_{L} \text { (discrete-circuit amplifiers) } \\
& \mathrm{BW}=f_{H} \text { (integrated-circuit amplifiers) }
\end{aligned}
$$

A figure of merit for the amplifier is its gain-bandwidth product, defined as

$$
G B=\left|A_{M}\right| \mathrm{BW}
$$

It will be seen that in amplifier design, it is usually possible to trade off gain for bandwidth.


Figure 10.2 Frequency response of a direct-coupled (dc) amplifier. Observe that the gain does not fall off at low frequencies, and the midband gain $A_{M}$ extends down to zero frequency.

The remainder of this chapter will be concerned with the frequency-response analysis of a variety of amplifier configurations of varying degrees of complexity. Of particular interest to us are ways to extend the amplifier bandwidth (i.e., increase $f_{H}$ ) either by adding specific circuit components, such as source and emitter-degeneration resistances, or by changing the circuit configuration altogether.

Before embarking on the study of this chapter, the reader is urged to review Section 1.6, which introduces the subject of amplifier frequency response and the extremely important topic of single-time-constant (STC) circuits. More details on STC circuits can be found in Appendix E. As well, Appendix F provides a review of important tools from circuit and system theory: poles, zeros, and Bode plots.

Finally, a note on notation: Since we will be dealing with quantities that are functions of frequency, or, equivalently, the Laplace variable $s$, we will be using capital letters with lowercase subscripts for our symbols. This practice conforms with the symbol notation introduced in Chapter 1.

# 10.1 Low-Frequency Response of Discrete-Circuit Common-Source and Common-Emitter Amplifiers 

In this section, we consider the effect of the coupling and bypass capacitors on the gain of discrete-circuit common-source (CS) and common-emitter (CE) amplifiers. As mentioned earlier, their effect manifests itself only at low frequencies (i.e., below the midband). We consider first the CS amplifier, since the infinite input resistance at the gate of the MOSFET makes the analysis of this circuit simpler than that of its CE counterpart.

### 10.1.1 The CS Amplifier

Figure 10.3(a) shows a discrete-circuit common-source amplifier utilizing the classical biasing arrangement (Section 7.5.1). Two coupling capacitors, $C_{C 1}$ and $C_{C 2}$, and a bypass capacitor $C_{S}$ are employed. At midband frequencies, these large capacitances have negligibly small


Figure 10.3 (a) Capacitatively coupled common-source amplifier. (b) The amplifier equivalent circuit at low frequencies. Note that the T model is used for the MOSFET and $r_{o}$ is neglected.
impedances and can be assumed to be perfect short circuits for the purpose of calculating the midband gain, as was done in Section 7.5.1. However, at low frequencies, the reactance $1 / j \omega C$ of each of the three capacitances increases and the amplifier gain decreases, as we shall now show.

To determine the amplifier gain $V_{o} / V_{\text {sig }}$ at low frequencies, we utilize the amplifier equivalent circuit shown in Fig. 10.3(b). This circuit is obtained by short-circuiting $V_{D D}$ and replacing the MOSFET with its T model, which is the most convenient model to use when an impedance, such as $Z_{S}$, is present in the source lead. The transistor $r_{o}$ has been omitted because including it would complicate the analysis considerably and, moreover, as mentioned in Chapter 7, $r_{o}$ has a negligible effect on the performance of discrete-circuit amplifiers, as can be verified using circuit simulation.
The gain $V_{g} / V_{\text {sig }}$ of the amplifier can be obtained from the equivalent circuit in Fig. 10.3(b) by starting at the source and working our way to the load, as

$$
\frac{V_{a}}{V_{\text {sig }}}=\frac{V_{g}}{V_{\text {sig }}} \times \frac{I_{d}}{V_{g}} \times \frac{V_{a}}{I_{d}}
$$

where $V_{g}$ is the voltage between gate and ground, and $I_{d}$ is the drain current. To find the fraction of $V_{\text {sig }}$ that appears at the transistor gate, $V_{g}$, we note that the input resistance at the gate is infinite and thus the amplifier input resistance is $R_{G}=R_{G 1} \| R_{G 2}$. Using the voltage-divider rule gives

$$
V_{g}=V_{\text {sig }} \frac{R_{G}}{R_{G}+\frac{1}{s C_{C 1}}+R_{\text {sig }}}
$$

which can be rearranged in the form

$$
\frac{V_{g}}{V_{\text {sig }}}=\frac{R_{G}}{R_{G}+R_{\text {sig }}} \frac{s}{s+\frac{1}{C_{C 1}\left(R_{G}+R_{\text {sig }}\right)}}
$$

Thus, we see that the effect of $C_{C 1}$ is to cause the expression for the signal transmission from the signal source to the amplifier input to acquire a frequency-dependent factor. From Section 1.6 we recognize this factor as the transfer function of a single-time-constant circuit of the high-pass type, with a pole frequency $\omega_{P 1}$,

$$
\omega_{P 1}=1 / C_{C 1}\left(R_{\mathrm{sig}}+R_{G}\right)
$$

In addition to the pole, $C_{C 1}$ introduces a zero at $s=0$ (dc). This is hardly surprising, since $C_{C 1}$ is included in the amplifier circuit because it blocks dc. Figure 10.4 shows a sketch of the magnitude of the frequency-dependent factor in the transfer function of Eq. (10.1) versus frequency $\omega$.

Continuing with the analysis, we next determine the drain current $I_{d}$, which is equal to the source current $I_{s}$. The latter can be found by dividing $V_{g}$ by the total impedance in the source


Figure 10.4 Sketch of the magnitude of the high-pass function $\frac{s}{s+\omega_{P 1}}$, that is, $\frac{\omega}{\sqrt{\omega^{2}+\omega_{P 1}^{2}}}$ versus frequency $\omega$.lead, $\left(1 / g_{m}+Z_{S}\right)$,

$$
I_{d}=I_{s}=\frac{V_{g}}{\frac{1}{g_{m}}+Z_{S}}=g_{m} V_{g} \frac{Y_{S}}{g_{m}+Y_{S}}
$$

where

$$
Y_{S}=\frac{1}{Z_{S}}=\frac{1}{R_{S}}+s C_{S}
$$

Thus,

$$
\frac{I_{d}}{V_{g}}=g_{m} \frac{s+\frac{1}{C_{S} R_{S}}}{s+\frac{g_{m}+1 / R_{S}}{C_{S}}}
$$

Thus, the bypass capacitor introduces a pole with frequency $\omega_{P 2}$,

$$
\omega_{P 2}=\frac{g_{m}+1 / R_{S}}{C_{S}}
$$

and a transmission zero on the negative real axis of the $s$ plane at

$$
s_{Z}=-\frac{1}{C_{S} R_{S}}
$$

and thus has a frequency

$$
\omega_{Z}=\frac{1}{C_{S} R_{S}}
$$

Observe that since $g_{m}$ is usually large, $\omega_{P 2} \gg \omega_{Z}$. That is, $\omega_{P 2}$ will be closer to the midband, and thus it plays a more significant role in determining $\omega_{L}$ than does $\omega_{Z}$. Figure 10.5 shows a sketch of the magnitude of the frequency-dependent factor of the transfer function in Eq. (10.3).

To complete the analysis, we find $V_{o}$ by first using the current-divider rule to determine the fraction of $I_{d}$ that flows through $R_{L}$,

$$
I_{o}=-I_{d} \frac{R_{D}}{R_{D}+\frac{1}{s C_{C 2}}+R_{L}}
$$



Figure 10.5 Sketch of the magnitude of the function $\frac{s+\omega_{Z}}{s+\omega_{P 2}}$ versus frequency $\omega$.


Figure 10.6 Sketch of the magnitude of the high-pass function $\frac{s}{s+\omega_{P 3}}$ versus frequency $\omega$.
and then multiplying $I_{o}$ by $R_{L}$. The result is

$$
\frac{V_{o}}{I_{d}}=-\frac{R_{D} R_{L}}{R_{D}+R_{L}} \frac{s}{s+\frac{1}{C_{C 2}\left(R_{D}+R_{L}\right)}}
$$

from which we see that $C_{C 2}$ introduces a pole with frequency,

$$
\omega_{P 3}=\frac{1}{C_{C 2}\left(R_{D}+R_{L}\right)}
$$

and a zero at $s=0$ (dc). A sketch of the magnitude of the frequency-dependent factor of the transfer function in Eq. (10.7) is shown in Fig. 10.6.

The overall low-frequency gain function of the amplifier can be found by combining Eqs. (10.1), (10.3), and (10.7),

$$
\begin{gathered}
\frac{V_{o}}{V_{\text {sig }}}=-\frac{R_{G}}{R_{G}+R_{\text {sig }}} g_{m}\left(R_{D} \| R_{L}\right)\left(\frac{s}{s+\omega_{P 1}}\right)\left(\frac{s+\omega_{Z}}{s+\omega_{P 2}}\right)\left(\frac{s}{s+\omega_{P 3}}\right) \\
\frac{V_{o}}{V_{\text {sig }}}=A_{M}\left(\frac{s}{s+\omega_{P 1}}\right)\left(\frac{s+\omega_{Z}}{s+\omega_{P 2}}\right)\left(\frac{s}{s+\omega_{P 3}}\right)
\end{gathered}
$$

where $A_{M}$, the midband gain, is given by

$$
A_{M}=-\frac{R_{G}}{R_{G}+R_{\text {sig }}} g_{m}\left(R_{D} \| R_{L}\right)
$$

which is the value we would have obtained, had we assumed that $C_{C 1}, C_{S}$, and $C_{C 2}$ were acting as perfect short circuits. In this regard, note from Eq. (10.9) that at midband frequencies-that is, at frequencies $s=j \omega$ with $\omega$ much higher than $\omega_{P 1}, \omega_{P 2}, \omega_{Z}$, and $\omega_{P 3}-V_{o} / V_{\text {sig }}$ approaches $A_{M}$, as should be expected.


Figure 10.7 Sketch of the low-frequency magnitude response of a CS amplifier for which the three pole frequencies are sufficiently separated for their effects to appear distinct.

Determining the 3-dB Frequency $f_{L} \quad$ The magnitude of the amplifier gain at a frequency $\omega$ can be obtained by substituting $s=j \omega$ in Eq. (10.9) and evaluating the magnitude of the resulting complex function. In this way, the low-frequency response of the amplifier can be plotted versus frequency, and the lower 3-dB frequency $f_{L}$ can be determined as the frequency at which $\left|V_{o} / V_{\text {sig }}\right|$ drops to $\left|A_{M}\right| / \sqrt{2}$.

A simpler approach for determining $f_{L}$ is possible if the poles and zeros are sufficiently separated from one another. In this case, we can employ the Bode plot rules (see Appendix F) to obtain a Bode plot for the gain magnitude. Such a plot is shown in Fig. 10.7. This graph is simply a combination of the graphs in Figs. 10.4, 10.5, and 10.6. Observe that since the poles and zeros are sufficiently separated, their effects appear distinct. As we move downward in frequency from the midband, we find that at each pole frequency, the slope of the asymptote to the gain function increases by $20 \mathrm{~dB} /$ decade, and at the zero frequency $\left(f_{Z}\right)$ it decreases by $20 \mathrm{~dB} /$ decade. Note that for the purpose of this sketch, we assumed $f_{P 2}$ to be the highest of the three poles and zero frequencies, and that the zero has the lowest frequency.

A quick way for estimating the 3-dB frequency $f_{L}$ is possible if the highest-frequency pole (here, assumed to be $f_{P 2}$ ) is separated from the nearest pole or zero (here, $f_{P 1}$ ) by at least a factor of 4 (two octaves). In such a case, $f_{L}$ is approximately equal to the highest of the pole frequencies,

$$
f_{L} \simeq f_{P 2}
$$

We refer to this situation as one in which a dominant pole exists, with the frequency of the dominant pole being $f_{P 2}$. Of course, if a dominant pole exists, $f_{L}$ can be estimated without the need for the Bode plot.


Figure 10.8 Circuits for determining the time constant of each of the three capacitors, and hence the pole associated with each one. Note that this determination is possible because in the circuit of Fig. 10.3, the capacitors do not interact.

If a dominant pole does not exist, the following approximate expression for $f_{L}$ can be used ${ }^{1}$

$$
f_{L} \simeq \sqrt{f_{P 1}^{2}+f_{P 2}^{2}+f_{P 3}^{2}-2 f_{Z}^{2}}
$$

Determining the Pole and Zero Frequencies by Inspection Since the capacitors in the CS amplifier circuit do not interact, a simple procedure exists for determining the frequencies of the pole and zero introduced by each capacitor.

Consider first the zeros. By its definition, a transmission zero is the value of $s$ at which the input does not reach the output, resulting in $V_{o}=0$. Examination of the circuit in Fig. 10.3(b) indicates that $C_{C 1}$ becomes an infinite impedance at $s=0$ and thus introduces a transmission zero at $s=0$ (i.e., blocks dc).

An identical statement applies to $C_{C 2}$. However, the bypass capacitor $C_{S}$ has a different effect: Its transmission zero is at the value of $s$ that causes $Z_{S}$ to become infinite, and hence $I_{r}, I_{d}$, and $V_{o}$ become zero, which is $s_{Z}$ given by Eq. (10.5).

To determine the poles, we set $V_{\text {sig }}=0 .^{2}$ This results in the three separate circuits shown in Fig. 10.8. Each of the three circuits can be used to determine the resistance "seen" by the particular capacitor, and hence the time constant associated with this capacitor. The corresponding pole frequency $\omega_{P}$ is the inverse of the time constant.

Selecting Values for the Coupling and Bypass Capacitors We now address the design issue of selecting appropriate values for $C_{C 1}, C_{S}$, and $C_{C 2}$. The design objective is to place the lower 3-dB frequency $f_{L}$ at a specified value while minimizing the capacitor values. Since the resistance seen by $C_{S},\left(\frac{1}{g_{m}} \| R_{S}\right)$, is usually the smallest of the three resistances, the total capacitance is minimized by selecting $C_{S}$ to provide the highest frequency pole; that is, making its pole frequency $f_{P 2}=f_{L}$. We then decide on the location of the other two pole frequencies, say, 5 to 10 times lower than the frequency of the dominant pole, $f_{P 2}$. However,

[^0]
[^0]:    ${ }^{1}$ The derivation of this expression is simple and is given in Chapter 9 of the fourth edition of this book.
    ${ }^{2}$ The poles of a circuit are its natural modes, and thus are independent of the value of the input signal.
the values selected for $f_{P 1}$ and $f_{P 3}$ should not be too low, for that would require larger values for $C_{C 1}$ and $C_{C 2}$ than may be necessary. The design procedure will be illustrated by an example.

# Example 10.1 

We wish to select appropriate values for the coupling capacitors $C_{C 1}$ and $C_{C 2}$ and the bypass capacitor $C_{S}$ for a CS amplifier for which $R_{G}=4.7 \mathrm{M} \Omega, R_{D}=R_{L}=15 \mathrm{k} \Omega, R_{\text {sig }}=100 \mathrm{k} \Omega, R_{S}=10 \mathrm{k} \Omega$, and $g_{m}=1 \mathrm{~mA} / \mathrm{V}$. It is required to have $f_{L}$ at 100 Hz and that the nearest break frequency be at least a decade lower.

## Solution

We select $C_{S}$ so that

$$
f_{P 2}=\frac{g_{m}+\frac{1}{R_{S}}}{2 \pi C_{S}}=f_{L}
$$

Thus,

$$
C_{S}=\frac{1.1 \times 10^{-3}}{2 \pi \times 100}=1.75 \mu \mathrm{~F}
$$

For $f_{P 1}=f_{P 3}=10 \mathrm{~Hz}$, we obtain

$$
10=\frac{1}{2 \pi C_{C 1}(0.1+4.7) \times 10^{6}}
$$

which yields

$$
C_{C 1}=3.3 \mathrm{nF}
$$

and

$$
10=\frac{1}{2 \pi C_{C 2}(15+15) \times 10^{3}}
$$

which results in

$$
C_{C 2}=0.53 \mu \mathrm{~F}
$$

Finally, we calculate the frequency of the zero $f_{Z}$ as

$$
\begin{aligned}
f_{Z}= & \frac{1}{2 \pi C_{S} R_{S}}=\frac{1}{2 \pi \times 1.75 \times 10^{-6} \times 10 \times 10^{3}} \\
& =9.1 \mathrm{~Hz}
\end{aligned}
$$

## EXERCISE

10.1 A CS amplifier has $C_{C 1}=C_{S}=C_{C 2}=1 \mu \mathrm{~F}, R_{G}=10 \mathrm{M} \Omega, R_{\text {sig }}=100 \mathrm{k} \Omega, g_{m}=2 \mathrm{~mA} / \mathrm{V}, R_{D}=R_{L}=$ $R_{S}=10 \mathrm{k} \Omega$. Find $A_{M}, f_{P 1}, f_{P 2}, f_{P 3}, f_{Z}$, and $f_{L}$.
Ans. $-9.9 \mathrm{~V} / \mathrm{V} ; 0.016 \mathrm{~Hz} ; 334.2 \mathrm{~Hz} ; 8 \mathrm{~Hz} ; 15.91 \mathrm{~Hz} ; 334.2 \mathrm{~Hz}$
# 10.1.2 The Method of Short-Circuit Time Constants 

In some circuits, such as that of the common-emitter amplifier discussed shortly, the capacitors interact, making it difficult to determine the pole frequencies. Fortunately, however, there is a simple method for obtaining an estimate for $f_{L}$ without the need to determine the frequencies of the poles. Although the method is predicated on the assumption that one of the poles is dominant, the resulting estimate for $f_{L}$ is usually very good even if this assumption is not strictly valid. The method is as follows ${ }^{3}$ :

1. Set the input signal $V_{\text {sig }}=0$.
2. Consider the capacitors one at a time. That is, while considering capacitor $C_{i}$, set all the other capacitors to infinite values (i.e., replace them with short circuits-hence the name of the method).
3. For each capacitor $C_{i}$, find the total resistance $R_{i}$ seen by $C_{i}$. This can be determined either by inspection or by replacing $C_{i}$ with a voltage source $V_{x}$ and finding the current $I_{x}$ drawn from $V_{x} ; R_{i} \equiv V_{x} / I_{x}$.
4. Calculate the $3-\mathrm{dB}$ frequency $f_{L}$ using

$$
f_{L} \simeq \sum_{i=1}^{n} \frac{1}{C_{i} R_{i}}
$$

where $n$ is the total number of capacitors.
Besides its simplicity, this method has a very important side benefit: Equation (10.13) indicates the relative contribution of each capacitor to the value of $f_{L}$. Specifically, the lower the value of the time constant associated with a particular capacitor, the greater the contribution of this capacitor to $f_{L}$. As will be seen shortly, this observation has important design implications. Application of the method of short-circuit time constants will be illustrated in the next section, where it is utilized to determine $f_{L}$ of the CE amplifier.

### 10.1.3 The CE Amplifier

Figure 10.9(a) shows a discrete-circuit common-emitter amplifier utilizing the classical biasing arrangement (Section 7.5.2), together with coupling capacitors $C_{C 1}$ and $C_{C 2}$, and bypass capacitor $C_{E}$. We wish to obtain an estimate of the frequency $f_{L}$ at which the gain of this amplifier drops by 3 dB below its value at midband. As well, we need to determine how to select appropriate values for $C_{C 1}, C_{E}$, and $C_{C 2}$ to ensure that $f_{L}$ is placed at a desired location while minimizing the total capacitance value required.

To analyze the low-frequency gain of the CE amplifier, we utilize the equivalent circuit shown in Fig. 10.9(b). This equivalent circuit is obtained by short-circuiting $V_{C C}$ and replacing the BJT with its T model, while neglecting $r_{o}$. The decision to neglect $r_{o}$ is based on the insignificant effect of the transistor's output resistance on the gain of discrete-circuit amplifiers, and the considerable complication its inclusion causes to the analysis. From the circuit in Fig. 10.9(b), we observe that the finite input current in the base of the BJT causes $C_{C 1}$ and $C_{C 2}$ to interact. That is, unlike the case of the CS amplifier, here each of the two poles caused by $C_{C 1}$ and $C_{C 2}$ will depend on both capacitor values in a complicated fashion that hinders design insight. Therefore, we shall not attempt to determine the pole frequencies

[^0]
[^0]:    ${ }^{3}$ A proof can be found in Gray and Searle, 1969. (See bibliography in Appendix I.)


Figure 10.9 (a) A discrete-circuit common-emitter amplifier. (b) Equivalent circuit of the amplifier in (a).
and, instead, we will use the method of short-circuit time constants to obtain an estimate of $f_{L}$ directly.

Applying the Method of Short-Circuit Time Constants Setting $V_{\text {sig }}=0$ in the circuit of Fig. 10.9(b) and considering each capacitor, one at a time, while short-circuiting the other two results in the three circuits shown in Fig. 10.10. These circuits can be used to determine the resistance seen by each capacitor and hence its effective time constant. For $C_{C 1}$ we use the circuit in Fig. 10.10(a) and note that $r_{\pi}$ is the input resistance at the base when $C_{E}$ is short-circuited. Capacitor $C_{C 1}$ sees a resistance $R_{C 1}$, which can be found by inspection as

$$
R_{C 1}=\left(R_{B} \| r_{\pi}\right)+R_{\text {sig }}
$$


Figure 10.10 Circuits for determining the short-circuit time constants for the amplifier in Fig. 10.9.
and the time constant associated with $C_{C 1}$ becomes

$$
\tau_{C 1}=C_{C 1} R_{C 1}
$$

For $C_{E}$, we use the circuit in Fig. 10.10(b). Here, we see that with $C_{C 1}$ shorted [refer to Fig. 10.9(b)], the resistance in the base becomes $\left(R_{B} \| R_{\text {sig }}\right)$, which can be reflected to the emitter side as $\left(R_{B} \| R_{\text {sig }}\right) /(\beta+1)$. The total resistance $R_{C E}$ seen by $C_{E}$ can be found by inspection from the circuit in Fig. 10.10(b) as

$$
R_{C E}=R_{E} \|\left[r_{e}+\frac{R_{B} \| R_{\text {sig }}}{\beta+1}\right]
$$

and the time constant becomes

$$
\tau_{C E}=C_{E} R_{C E}
$$

Finally, the resistance seen by $C_{C 2}$ can be determined by inspection of the circuit in Fig. 10.10(c) as

$$
R_{C 2}=R_{C}+R_{L}
$$

and the corresponding time constant $\tau_{C 2}$ as

$$
\tau_{C 2}=C_{C 2} R_{C 2}
$$
With the three time constants in hand, the 3-dB frequency $f_{L}$ can be found from

$$
f_{L}=\frac{\omega_{L}}{2 \pi}=\frac{1}{2 \pi}\left[\frac{1}{C_{C 1} R_{C 1}}+\frac{1}{C_{E} R_{E}}+\frac{1}{C_{C 2} R_{C 2}}\right]
$$

When numerical values are substituted in this expression, it quickly becomes obvious which of the three capacitors is contributing the most to $f_{L}$. Obviously, it is the capacitor that has the smallest time constants. In the CE amplifier, this is usually $C_{E}$ because the associated resistance $R_{C E}$ is typically small. Knowing which of the capacitors has the potential of dominating the determination of $f_{L}$ has significant design implications, as shown next.

Selecting Values for $C_{C 1}, C_{E}$, and $C_{C 2}$ We now address the design issue of selecting appropriate values for $C_{C 1}, C_{E}$, and $C_{C 2}$. The design objective is to place the lower 3-dB frequency $f_{L}$ at a specified location while minimizing the capacitor values. Since, as mentioned above, $C_{E}$ usually sees the lowest of the three resistances, the total capacitance is minimized by selecting $C_{E}$ so that its contribution to $f_{L}$ is dominant. That is, by reference to Eq. (10.20) we may select $C_{S}$ so that $1 /\left(C_{E} R_{E}\right)$ is, say, $80 \%$ of $\omega_{L}=2 \pi f_{L}$, leaving each of the other capacitors to contribute $10 \%$ to the value of $\omega_{L}$. Example 10.2 should help illustrate this process.

# Example 10.2 

We wish to select appropriate values for $C_{C 1}, C_{C 2}$, and $C_{E}$ for the common-emitter amplifier, which has $R_{B}=100 \mathrm{k} \Omega, R_{C}=8 \mathrm{k} \Omega, R_{L}=5 \mathrm{k} \Omega, R_{\text {sig }}=5 \mathrm{k} \Omega, R_{E}=5 \mathrm{k} \Omega, \beta=100, g_{m}=40 \mathrm{~mA} / \mathrm{V}$, and $r_{\pi}=2.5 \mathrm{k} \Omega$. It is required to have $f_{L}=100 \mathrm{~Hz}$.

## Solution

We first determine the resistances seen by the three capacitors $C_{C 1}, C_{E}$, and $C_{C 2}$ as follows:

$$
\begin{aligned}
R_{C 1} & =\left(R_{B} \| r_{\pi}\right)+R_{\text {sig }} \\
& =(100 \| 2.5)+5=7.44 \mathrm{k} \Omega \\
R_{C E} & =R_{E} \|\left[r_{e}+\frac{R_{B} \| R_{\text {sig }}}{\beta+1}\right] \\
& =5 \|\left(0.025+\frac{100 \| 5}{101}\right)=0.071 \mathrm{k} \Omega \\
R_{C 2} & =R_{C}+R_{L}=8+5=13 \mathrm{k} \Omega
\end{aligned}
$$

Now, selecting $C_{E}$ so that it contributes $80 \%$ of the value of $\omega_{L}$ gives

$$
\begin{aligned}
\frac{1}{C_{E} \times 71} & =0.8 \times 2 \pi \times 100 \\
C_{E} & =28 \mu \mathrm{~F}
\end{aligned}
$$

Next, if $C_{C 1}$ is to contribute $10 \%$ of $f_{L}$,

$$
\begin{aligned}
\frac{1}{C_{C 1} \times 7.44 \times 10^{3}} & =0.1 \times 2 \pi \times 100 \\
C_{C 1} & =2.1 \mu \mathrm{~F}
\end{aligned}
$$
Similarly, if $C_{C 2}$ is to contribute $10 \%$ of $f_{L}$, its value should be selected as follows:

$$
\begin{aligned}
\frac{1}{C_{C 2} \times 13 \times 10^{+}} & =0.1 \times 2 \pi \times 100 \\
C_{C 2} & =1.2 \mu \mathrm{~F}
\end{aligned}
$$

In practice, we would select the nearest standard values for the three capacitors while ensuring that $f_{L} \leq 100$ Hz . Finally, the frequency of the zero introduced by $C_{E}$ can be found,

$$
f_{Z}=\frac{1}{2 \pi C_{E} R_{E}}=\frac{1}{2 \pi \times 28 \times 10^{-6} \times 5 \times 10^{+}}=1.1 \mathrm{~Hz}
$$

which is very far from $f_{L}$ and thus has an insignificant effect.

# EXERCISE 

10.2 A common-emitter amplifier has $C_{C 1}=C_{E}=C_{C 2}=1 \mu \mathrm{~F}, R_{B}=100 \mathrm{k} \Omega, R_{\text {sig }}=5 \mathrm{k} \Omega, g_{m}=40 \mathrm{~mA} / \mathrm{V}$, $r_{a}=2.5 \mathrm{k} \Omega, R_{E}=5 \mathrm{k} \Omega, R_{C}=8 \mathrm{k} \Omega$, and $R_{L}=5 \mathrm{k} \Omega$. Find the value of the time constant associated with each capacitor, and hence estimate the value of $f_{L}$. Also compute the frequency of the transmission zero introduced by $C_{E}$ and comment on its effect on $f_{L}$.
Ans. $\tau_{C 1}=7.44 \mathrm{~ms} ; \tau_{C E}=0.071 \mathrm{~ms} ; \tau_{C 2}=13 \mathrm{~ms} ; f_{L}=2.28 \mathrm{kHz} ; f_{Z}=31.8 \mathrm{~Hz}$, which is much smaller than $f_{L}$ and thus has a negligible effect on $f_{L}$

### 10.2 Internal Capacitive Effects and the High-Frequency Model of the MOSFET and the BJT

While coupling and bypass capacitors cause the gain of transistor amplifiers to fall off at the low-frequency end, the gain falloff at high frequencies is caused by the capacitive effects internal to the transistors. In this section we shall briefly consider these effects and, more importantly, show how the device small-signal model can be augmented to take these effects into account.

### 10.2.1 The MOSFET

From our study of the physical operation of the MOSFET in Section 5.1, we know that the device has internal capacitances. In fact, we used one of these, the gate-to-channel capacitance, in our derivation of the MOSFET $i-v$ characteristics. We did, however, implicitly assume that the steady-state charges on these capacitances are acquired instantaneously. In other words,

Figure 10.11 A cross section of the $n$-channel MOSFET operating in the saturation region. The four internal capacitances, $C_{g s}, C_{g d}, C_{s b}$, and $C_{d b}$, are indicated. Note that the bias voltages are not shown. Also not shown, to keep the diagram simple, is the depletion region.
we did not account for the finite time required to charge and discharge the various internal capacitances. As a result, the device models we derived, such as the small-signal model, do not include any capacitances. The use of these models would predict constant amplifier gains independent of frequency. We know, however, that this (unfortunately) does not happen; in fact, the gain of every MOSFET amplifier falls off at some high frequency. Similarly, the MOSFET digital logic inverter (Chapter 14) exhibits a finite nonzero propagation delay. To be able to predict these results, the MOSFET model must be augmented by including internal capacitances. This is the subject of this section.

To visualize the physical origin of the various internal capacitances, refer to Fig. 10.11, which shows the cross section of an $n$-channel MOSFET operating in the saturation region, as signified by the tapered $n$ channel that is pinched off at the drain end. As indicated, there are four internal capacitances: Two of these, $C_{g s}$ and $C_{g d}$, result from the gate-capacitance effect; the other two, $C_{s b}$ and $C_{d b}$, are the depletion capacitances of the $p n$ junctions formed by the source region and the substrate, and the drain region and the substrate, respectively.

The gate-capacitive effect was discussed in Section 5.1. Briefly, the polysilicon gate forms a parallel-plate capacitor with the channel region, with the oxide layer serving as the capacitor dielectric. The gate (or oxide) capacitance per unit gate area is denoted $C_{o x}$. When the channel is tapered and pinched off, the gate capacitance is given by $\frac{2}{3} W L C_{o x}$. In addition to this capacitance, there are two other small capacitances resulting from the overlap of the gate with the source region (or source diffusion) and the drain region (or drain diffusion). Each of these overlaps has a length $L_{o v}$ and thus the resulting overlap capacitances $C_{o v}$ are given by

$$
C_{o v}=W L_{o v} C_{o x}
$$

Typically, $L_{o v}=0.05$ to 0.1 L . We can now express the gate-to-source capacitance $C_{g s}$ as

$$
C_{g s}=\frac{2}{3} W L C_{o x}+C_{o v}
$$

For the gate-to-drain capacitance, we note that the channel pinch-off at the drain end causes $C_{g d}$ to consist entirely of the overlap component $C_{o v}$,

$$
C_{g d}=C_{o v}
$$
The depletion-layer capacitances of the two reverse-biased $p n$ junctions formed between each of the source and the drain diffusions and the $p$-type substrate (body) can be determined using the formula developed in Section 3.6 (Eq. 3.47). Thus, for the source diffusion, we have the source-body capacitance, $C_{s b}$,

$$
C_{s b}=\frac{C_{s b 0}}{\sqrt{1+\frac{V_{S B}}{V_{0}}}}
$$

where $C_{s b 0}$ is the value of $C_{s b}$ at zero body-source bias, $V_{S B}$ is the magnitude of the reverse-bias voltage, and $V_{0}$ is the junction built-in voltage $(0.6 \mathrm{~V}$ to 0.8 V$)$. Similarly, for the drain diffusion, we have the drain-body capacitance $C_{d b}$,

$$
C_{d b}=\frac{C_{d b 0}}{\sqrt{1+\frac{V_{D B}}{V_{0}}}}
$$

where $C_{d b 0}$ is the capacitance value at zero reverse-bias voltage and $V_{D B}$ is the magnitude of this reverse-bias voltage. Note that we have assumed that for both junctions, the grading coefficient $m=\frac{1}{2}$.

It should be noted also that each of these junction capacitances includes a component arising from the bottom side of the diffusion and a component arising from the sidewalls of the diffusion. In this regard, observe that each diffusion has three sidewalls that are in contact with the substrate and thus contribute to the junction capacitance (the fourth wall is in contact with the channel).

The formulas for the junction capacitances in Eqs. (10.24) and (10.25) assume small-signal operation. Typical values for the various capacitances exhibited by an $n$-channel MOSFET in a $0.5-\mu \mathrm{m}$ CMOS process are given in the following exercise.

# EXERCISE 

10.3 For an $n$-channel MOSFET with $t_{o x}=10 \mathrm{~nm}, L=1.0 \mu \mathrm{~m}, W=10 \mu \mathrm{~m}, L_{o o}=0.05 \mu \mathrm{~m}, C_{s b 0}=$ $C_{d b 0}=10 \mathrm{fF}, V_{0}=0.6 \mathrm{~V}, V_{S B}=1 \mathrm{~V}$, and $V_{D S}=2 \mathrm{~V}$, calculate the following capacitances when the transistor is operating in saturation: $C_{o x}, C_{o o}, C_{g s}, C_{g d}, C_{s b}$, and $C_{d b}$.
Ans. $3.45 \mathrm{fF} / \mu \mathrm{m}^{2} ; 1.72 \mathrm{fF} ; 24.7 \mathrm{fF} ; 1.72 \mathrm{fF} ; 6.1 \mathrm{fF} ; 4.1 \mathrm{fF}$

The High-Frequency MOSFET Model Figure 10.12(a) shows the small-signal model of the MOSFET, including the four capacitances $C_{g s}, C_{g d}, C_{s b}$, and $C_{d b}$. This model can be used to predict the high-frequency response of MOSFET amplifiers. It is, however, quite complex for manual analysis, and its use is limited to computer simulation using, for example, SPICE. Fortunately, when the source is connected to the body, the model simplifies considerably, as shown in Fig. 10.12(b). In this model, $C_{g d}$, although small, plays a significant role in determining the high-frequency response of amplifiers and thus must be kept in the


Figure 10.12 (a) High-frequency, equivalent-circuit model for the MOSFET. (b) The equivalent circuit for the case in which the source is connected to the substrate (body). (c) The equivalent-circuit model of (b) with $C_{d b}$ neglected (to simplify analysis). (d) The simplified high-frequency T model.
model. Capacitance $C_{d b}$, on the other hand, can usually be neglected, resulting in significant simplification of manual analysis. The resulting circuit is shown in Fig. 10.12(c). Finally, we show in Fig. 10.12(d) the high-frequency T model in its simplified form.
The MOSFET Unity-Gain Frequency $\left(f_{T}\right)$ A figure of merit for the high-frequency operation of the MOSFET as an amplifier is the unity-gain frequency, $f_{T}$, also known as the transition frequency, which gives rise to the subscript $T$. This is defined as the frequency at which the short-circuit current gain of the common-source configuration becomes unity. Figure 10.13 shows the MOSFET hybrid- $\pi$ model with the source as the common terminal between the input and output ports. To determine the short-circuit current gain, the input is fed with a current-source signal $I_{i}$ and the output terminals are short-circuited. It can be seen that the current in the short circuit is given by

$$
I_{o}=g_{m} V_{g s}-s C_{g d} V_{g s}
$$

Recalling that $C_{g d}$ is small, at the frequencies of interest we can neglect the second term in this equation,

$$
I_{o} \simeq g_{m} V_{g s}
$$

From Fig. 10.13, we can express $V_{g s}$ in terms of the input current $I_{i}$ as

$$
V_{g s}=\frac{I_{i}}{s\left(C_{g s}+C_{g d}\right)}
$$

Equations (10.26) and (10.27) can be combined to obtain the short-circuit current gain,

$$
\frac{I_{o}}{I_{i}}=\frac{g_{m}}{s\left(C_{g s}+C_{g d}\right)}
$$

For physical frequencies $s=j \omega$, it can be seen that the magnitude of the current gain is

$$
\left|\frac{I_{o}}{I_{i}}\right|=\frac{g_{m}}{\omega\left(C_{g s}+C_{g d}\right)}
$$

and it becomes unity at the frequency

$$
\omega_{T}=g_{m} /\left(C_{g s}+C_{g d}\right)
$$

Thus the unity-gain frequency $f_{T}=\omega_{T} / 2 \pi$ is

$$
f_{T}=\frac{g_{m}}{2 \pi\left(C_{g s}+C_{g d}\right)}
$$

Since $f_{T}$ is proportional to $g_{m}$, which determines the midband gain, and inversely proportional to the MOSFET internal capacitances, which limit the amplifier bandwidth, the higher the value of $f_{T}$, the more effective the MOSFET becomes as an amplifier. Substituting for $g_{m}$ using Eq. (7.41), we can express $f_{T}$ in terms of the bias current $I_{D}$ (see Problem 10.15). Alternatively, we can substitute for $g_{m}$ from Eq. (7.40) to express $f_{T}$ in terms of the overdrive voltage $V_{O V}$ (see Problem 10.16). Both expressions yield additional insight into the high-frequency operation of the MOSFET. The reader is also referred to Appendix G for a further discussion of $f_{T}$.


Figure 10.13 Determining the short-circuit current gain $I_{o} / I_{i}$.
Typically, $f_{T}$ ranges from about 100 MHz for the older technologies (e.g., a $5-\mu \mathrm{m}$ CMOS process) to many GHz for newer high-speed technologies (e.g., a $0.13-\mu \mathrm{m}$ CMOS process).

# EXERCISE 

10.4 Calculate $f_{T}$ for the $n$-channel MOSFET whose capacitances were found in Exercise 10.3. Assume operation at $100 \mu \mathrm{~A}$ and that $k_{n}^{\prime}=160 \mu \mathrm{~A} / \mathrm{V}^{2}$.
Ans. 3.4 GHz

Summary We conclude this section by presenting a summary in Table 10.1.

Table 10.1 The MOSFET High-Frequency Model
Model


Model Parameters
$g_{m}=\mu_{n} C_{o s} \frac{W}{L}\left|V_{O V}\right|=\sqrt{2 \mu_{n} C_{o s} \frac{W}{L} I_{D}}=\frac{2 I_{D}}{\left|V_{O V}\right|}$
$C_{s b}=\frac{C_{s b b}}{\sqrt{1+\frac{\left|V_{s p}\right|}{V_{0}}}}$
$g_{m b}=\chi g_{m}, \quad \chi=0.1$ to 0.2
$r_{o}=\left|V_{h}\right| / I_{D}$
$C_{d b}=\frac{C_{d b 0}}{\sqrt{1+\frac{\left|V_{D B}\right|}{V_{0}}}}$
$C_{g s}=\frac{2}{3} W L C_{o s}+W L_{o s} C_{o s}$
$C_{g d}=W L_{o s} C_{o s}$
$f_{T}=\frac{g_{m}}{2 \pi\left(C_{g s}+C_{g d}\right)}$
# 10.2.2 The BJT 

In our study of the physical operation of the BJT in Section 6.1, we assumed transistor action to be instantaneous, and as a result the transistor models we developed do not include any elements (i.e., capacitors or inductors) that would cause time or frequency dependence. Actual transistors, however, exhibit charge-storage phenomena that limit the speed and frequency of their operation. We have already encountered such effects in our study of the $p n$ junction in Chapter 3 and have learned that they can be modeled using capacitances. In the following we study the charge-storage effects that take place in the BJT and take them into account by adding capacitances to the hybrid- $\pi$ and the T models. The resulting augmented BJT model will be able to predict the observed dependence of amplifier gain on frequency, and the time delays that transistor switches and logic gates exhibit.

The Base-Charging or Diffusion Capacitance $C_{d e}$ When the transistor is operating in the active mode, minority-carrier charge is stored in the base region. For an npn transistor, the stored electron charge in the base, $Q_{n}$, can be expressed in terms of the collector current $i_{C}$ as

$$
Q_{n}=\tau_{F} i_{C}
$$

where $\tau_{F}$ is a device constant with the dimension of time. It is known as the forward base-transit time and represents the average time a charge carrier (electron) spends in crossing the base. Typically, $\tau_{F}$ is in the range of 10 ps to 100 ps .

Equation (10.30) applies for large signals and, since $i_{C}$ is exponentially related to $v_{B E}, Q_{n}$ will similarly depend on $v_{B E}$. For small signals, we can define the small-signal diffusion capacitance $C_{d e}$,

$$
\begin{aligned}
C_{d e} & \equiv \frac{d Q_{n}}{d v_{B E}} \\
& =\tau_{F} \frac{d i_{C}}{d v_{B E}}
\end{aligned}
$$

resulting in

$$
C_{d e}=\tau_{F} g_{m}=\tau_{F} \frac{I_{C}}{V_{T}}
$$

where $I_{C}$ is the dc collector bias current at which the transistor is operating. Thus, whenever $v_{B E}$ changes by $v_{b e}$, the collector current changes by $g_{m} v_{b e}$ and the charge stored in the base changes by $C_{d e} v_{b e}=\left(\tau_{F} g_{m}\right) v_{b e}$. This incremental charge has to be supplied by the base current.

The Base-Emitter Junction Capacitance $C_{j e}$ A change in $v_{B E}$ changes not only the charge stored in the base region but also the charge stored in the base-emitter depletion layer. This distinct charge-storage effect is represented by the EBJ depletion-layer capacitance, $C_{j e}$. From the development in Chapter 3, we know that for a forward-biased junction, which the EBJ is, the depletion-layer capacitance is given approximately by

$$
C_{j e} \simeq 2 C_{j e 0}
$$

where $C_{j e 0}$ is the value of $C_{j e}$ at zero EBJ voltage.
The Collector-Base Junction Capacitance C $_{\mu}$ In active-mode operation, the CBJ is reverse biased, and its junction or depletion capacitance, usually denoted $C_{\mu}$, can be found from

$$
C_{\mu}=\frac{C_{\mu 0}}{\left(1+\frac{V_{C B}}{V_{0 c}}\right)^{m}}
$$

where $C_{\mu 0}$ is the value of $C_{\mu}$ at zero voltage; $V_{C B}$ is the magnitude of the CBJ reverse-bias voltage, $V_{0 c}$ is the CBJ built-in voltage (typically, 0.75 V ), and $m$ is its grading coefficient (typically, $0.2-0.5$ ).

The High-Frequency Models Figure 10.14 shows the hybrid- $\pi$ and T models of the BJT, including capacitive effects. Specifically, there are two capacitances: the emitter-base capacitance $C_{\pi}=C_{d e}+C_{j e}$ and the collector-base capacitance $C_{\mu}$. Typically, $C_{\pi}$ is in the range of a few picofarads to a few tens of picofarads, and $C_{\mu}$ is in the range of a fraction of a picofarad to a few picofarads. ${ }^{4}$ Note that we have also added a resistor $r_{s}$ to model

(a)

(b)

Figure 10.14 The high-frequency models of the BJT: (a) hybrid- $\pi$ model and (b) T model.

[^0]
[^0]:    ${ }^{4}$ These values apply for discrete devices and devices fabricated with a relatively old IC process technology (the so-called high-voltage process, see Appendix K). For modern IC fabrication processes, $C_{\pi}$ and $C_{\mu}$ are in the range of tens of femtofarads (fF).
the resistance of the silicon material of the base region between the base terminal B and a fictitious internal, or intrinsic, base terminal B' that is right under the emitter region (refer to Fig. 6.6). Typically, $r_{s}$ is a few tens of ohms, and its value depends on the current level in a rather complicated manner. Since (usually) $r_{s} \ll r_{\pi}$, its effect is negligible at low frequencies. Its presence is felt, however, at high frequencies, as will become apparent later.

The values of the model parameters can be determined at a given bias point using the formulas presented in this section and in Chapter 6. They can also be found from the terminal measurements specified on the BJT data sheets. For computer simulation, SPICE uses the parameters of the given IC technology to evaluate the BJT model parameters (see Appendix B).

The BJT Unity-Gain Frequency The transistor data sheets do not usually specify the value of $C_{\pi}$. Rather, the behavior of $\beta$ (or $h_{f e}$ ) versus frequency is normally given. In order to determine $C_{\pi}$ and $C_{\mu}$, we shall derive an expression for $h_{f e}$, the CE short-circuit current gain, as a function of frequency in terms of the hybrid- $\pi$ components. For this purpose consider the circuit shown in Fig. 10.15, in which the collector is shorted to the emitter. A node equation at C provides the short-circuit collector current $I_{c}$ as

$$
I_{c}=\left(g_{m}-s C_{\mu}\right) V_{\pi}
$$

A relationship between $V_{\pi}$ and $I_{b}$ can be established by multiplying $I_{b}$ by the impedance seen between B' and E:

$$
V_{\pi}=I_{b}\left(r_{\pi}\left\|C_{\pi}\right\| C_{\mu}\right)=\frac{I_{b}}{1 / r_{\pi}+s C_{\pi}+s C_{\mu}}
$$

Thus $h_{f e}$ can be obtained by combining Eqs. (10.35) and (10.36):

$$
h_{f e} \equiv \frac{I_{c}}{I_{b}}=\frac{g_{m}-s C_{\mu}}{1 / r_{\pi}+s\left(C_{\pi}+C_{\mu}\right)}
$$

At the frequencies for which this model is valid, $\omega C_{\mu} \ll g_{m}$; thus we can neglect the $s C_{\mu}$ term in the numerator and write

$$
h_{f e} \simeq \frac{g_{m} r_{\pi}}{1+s\left(C_{\pi}+C_{\mu}\right) r_{\pi}}
$$



Figure 10.15 Circuit for deriving an expression for $h_{f e}(s) \equiv I_{c} / I_{b}$.


Figure 10.16 Bode plot for $\left|h_{f r}\right|$.

Thus,

$$
h_{f r}=\frac{\beta_{0}}{1+s\left(C_{\pi}+C_{\mu}\right) r_{\pi}}
$$

where $\beta_{0}$ is the low-frequency value of $\beta$. Thus $h_{f r}$ has a single-pole (or single-time-constant) response with a $3-\mathrm{dB}$ frequency at $\omega=\omega_{\beta}$, where

$$
\omega_{\beta}=\frac{1}{\left(C_{\pi}+C_{\mu}\right) r_{\pi}}
$$

Figure 10.16 shows a Bode plot for $\left|h_{f r}\right|$. From the $-6-\mathrm{dB} /$ octave slope, it follows that the frequency at which $\left|h_{f r}\right|$ drops to unity, which is called the unity-gain bandwidth $\omega_{T}$, is given by

$$
\omega_{T}=\beta_{0} \omega_{\beta}
$$

Thus,

$$
\omega_{T}=\frac{g_{m}}{C_{\pi}+C_{\mu}}
$$

and

$$
f_{T}=\frac{g_{m}}{2 \pi\left(C_{\pi}+C_{\mu}\right)}
$$

This expression is identical to that of $f_{T}$ for the MOSFET (Eq. 10.29) with $C_{\pi}$ replacing $C_{g s}$ and $C_{\mu}$ replacing $C_{g d}$.

The unity-gain bandwidth $f_{T}$, also known as the transition frequency, which gives rise to the subscript $T$, is usually specified on the data sheets of a transistor. In some cases $f_{T}$ is given as a function of $I_{C}$ and $V_{C E}$. To see how $f_{T}$ changes with $I_{C}$, recall that $g_{m}$ is directly proportional to $I_{C}$, but only part of $C_{\pi}$ (the diffusion capacitance $C_{d e}$ ) is directly proportional to $I_{C}$. It follows that $f_{T}$ decreases at low currents, as shown in Fig. 10.17. However, the decrease in $f_{T}$ at high currents, also shown in Fig. 10.17, cannot be explained by this argument; rather, it is due to the same phenomenon that causes $\beta_{0}$ to decrease at high currents (Section 6.4.2). In the region where $f_{T}$ is almost constant, $C_{\pi}$ is dominated by the diffusion part and is much greater than $C_{\mu}$. That is, $C_{\pi}+C_{\mu} \simeq C_{d e}=\tau_{F} g_{m}$ and

$$
f_{T} \simeq \frac{1}{2 \pi \tau_{F}}
$$


Figure 10.17 Variation of $f_{T}$ with $I_{C}$.

Typically, $f_{T}$ is in the range of 100 MHz to tens of gigahertz. The value of $f_{T}$ can be used in Eq. (10.41) to determine $C_{\pi}+C_{\mu}$. The capacitance $C_{\mu}$ is usually determined separately by measuring the capacitance between base and collector at the desired reverse-bias voltage $V_{C B}$.

An important observation to make from the high-frequency model of Fig. 10.14(a) is that at frequencies above 5 to $10 f_{\beta}$, one may ignore the resistance $r_{\pi}$. It can be seen then that $r_{x}$ becomes the only resistive part of the input impedance at high frequencies. Thus $r_{x}$ plays an important role in determining the frequency response of transistor circuits at high frequencies. It follows that an accurate determination of $r_{x}$ can be made only from a high-frequency measurement.

Before leaving this section, we should mention that the high-frequency models of Fig. 10.14 characterize transistor operation fairly accurately up to a frequency of about $0.2 f_{T}$. At higher frequencies one has to add other parasitic elements to the model.

# EXERCISES 

10.5 Find $C_{d e}, C_{\mu}, C_{\alpha}, C_{\mu}$, and $f_{T}$ for a BJT operating at a dc collector current $I_{C}=1 \mathrm{~mA}$ and a CBJ reverse bias of 2 V . The device has $\tau_{F}=20 \mathrm{ps}, C_{\mu 0}=20 \mathrm{fF}, C_{\mu 0}=20 \mathrm{fF}, V_{0 e}=0.9 \mathrm{~V}, V_{0 c}=0.5 \mathrm{~V}$, and $m_{C B J}=0.33$.
Ans. $0.8 \mathrm{pF} ; 40 \mathrm{fF} ; 0.84 \mathrm{pF} ; 12 \mathrm{fF} ; 7.47 \mathrm{GHz}$
10.6 For a BJT operated at $I_{C}=1 \mathrm{~mA}$, determine $f_{T}$ and $C_{\pi}$ if $C_{\mu}=2 \mathrm{pF}$ and $\left|h_{f e}\right|=10$ at 50 MHz . Ans. $500 \mathrm{MHz} ; 10.7 \mathrm{pF}$
10.7 If $C_{\pi}$ of the BJT in Exercise 10.6 includes a relatively constant depletion-layer capacitance of 2 pF , find $f_{T}$ of the BJT when operated at $I_{C}=0.1 \mathrm{~mA}$.
Ans. 130.7 MHzSummary For convenient reference, Table 10.2 provides a summary of the relationships used to determine the values of the parameters of the BJT high-frequency model.

Table 10.2 The BJT High-Frequency Model


# 10.3 High-Frequency Response of the CS and CE Amplifiers 

Equipped with equivalent-circuit models that represent the high-frequency operation of the MOSFET and the BJT, we now address the question of the high-frequency performance of the CS and CE amplifiers. Our objective is to identify the mechanism that limits the high-frequency performance of these important amplifier configurations. As well, we need to find a simple approach to estimate the frequency $f_{H}$ at which the gain falls by 3 dB below its value at midband frequencies, $\left|A_{M}\right|$.

The analysis presented here applies equally well to discrete-circuit, capacitively coupled amplifiers and to IC amplifiers. The frequency response of the first was shown in Fig. 10.1 and that of the latter in Fig. 10.2. At the frequencies of interest to us here (the high-frequency band), all coupling and bypass capacitors behave as perfect short circuits, and amplifiers of both types have identical high-frequency equivalent circuits.

### 10.3.1 The Common-Source Amplifier

Figure 10.18(a) shows the high-frequency, equivalent-circuit model of a CS amplifier. It is obtained by replacing the MOSFET in an amplifier circuit such as that in Fig. 10.3(a) by its high-frequency, equivalent-circuit model of Fig. 10.6(c), while as always eliminating dc sources. Observe that the circuit in Fig. 10.18(a) is general; for instance, it includes a resistance $R_{G}$, which arises only in the case of a discrete-circuit amplifier such as that in Fig. 10.3(a), where $R_{G} \equiv R_{G 1} \| R_{G 2}$. Also, $R_{D}$ can be either a passive resistance or the output resistance of a current-source load, and similarly for $R_{L}$.
The equivalent circuit of Fig. 10.18(a) can be simplified by utilizing Thévenin theorem at the input side and by combining the three parallel resistances at the output side. The resulting simplified circuit is shown in Fig. 10.18(b). The midband gain $A_{M}$ can be found from this circuit by setting $C_{g s}$ and $C_{g d}$ to zero. The result is

$$
A_{M}=\frac{V_{o}}{V_{\text {sig }}}=-\frac{R_{G}}{R_{G}+R_{\text {sig }}}\left(g_{m} R_{L}^{\prime}\right)
$$

The circuit in Fig. 10.18(b) can be analyzed to obtain its transfer function $V_{o} / V_{\text {sig }}$ in terms of the complex frequency variable $s$. Because two capacitors, $C_{g s}$ and $C_{g d}$, are present, the resulting transfer function will be of second order. The poles and zeros can then be determined. This, however, will not provide us with simple expressions that reveal the essence of what limits the high-frequency operation of the CS amplifier. We need such insight in order to be able to make intelligent decisions when designing the circuit. Therefore, we shall not derive the transfer function and instead opt for an approximate approach that will reveal considerable information about the high-frequency operation of the CS amplifier.


Figure 10.18 Determining the high-frequency response of the CS amplifier: (a) equivalent circuit; (b) the circuit of (a) simplified at the input and the output; (c) the equivalent circuit with $C_{g d}$ replaced at the input side with the equivalent capacitance $C_{e q}$; (d) the frequency-response plot, which is that of a low-pass, single-time-constant circuit.


Figure 10.18 continued

Our approach is to focus on the input side of the circuit and seek to simplify the input circuit to a simple RC low-pass network. To do so we need to replace the bridging capacitor $C_{g d}$ by an equivalent capacitance $C_{e q}$ between node G and ground. Toward that end, consider first the output node. It can be seen that the load current is $\left(g_{m} V_{g s}-I_{g d}\right)$, where $\left(g_{m} V_{g s}\right)$ is the output current of the transistor and $I_{g d}$ is the current supplied through the very small capacitance $C_{g d}$. At frequencies in the vicinity of $f_{H}$, which defines the edge of the midband, it is reasonable to assume that $I_{g d}$ is still much smaller than $\left(g_{m} V_{g s}\right)$, with the result that $V_{o}$ can be given approximately by

$$
V_{o} \simeq-\left(g_{m} V_{g s}\right) R_{L}^{\prime}=-g_{m} R_{L}^{\prime} V_{g s}
$$

where

$$
R_{L}^{\prime}=r_{o}\left\|R_{D}\right\| R_{L}
$$
Since $V_{o}=V_{d s}$, Eq. (10.44) indicates that the gain from gate to drain is $-g_{m} R_{L}^{\prime}$, the same value as in the midband. The current $I_{g d}$ can now be found as

$$
\begin{aligned}
I_{g d} & =s C_{g d}\left(V_{g s}-V_{o}\right) \\
& =s C_{g d}\left[V_{g s}-\left(-g_{m} R_{L}^{\prime} V_{g s}\right)\right] \\
& =s C_{g d}\left(1+g_{m} R_{L}^{\prime}\right) V_{g s}
\end{aligned}
$$

Now, the left-hand side of the circuit in Fig. 10.18(b), at $X X^{\prime}$, knows of the existence of $C_{g d}$ only through the current $I_{g d}$. Therefore, we can replace $C_{g d}$ by an equivalent capacitance $C_{e q}$ between the gate and ground as long as $C_{e q}$ draws a current equal to $I_{g d}$. That is,

$$
s C_{e q} V_{g s}=s C_{g d}\left(1+g_{m} R_{L}^{\prime}\right) V_{g s}
$$

which results in

$$
C_{e q}=C_{g d}\left(1+g_{m} R_{L}^{\prime}\right)
$$

Thus $C_{g d}$ gives rise to a much larger capacitance $C_{e q}$, which appears at the amplifier input. The multiplication effect that $C_{g d}$ undergoes comes about because it is connected between circuit nodes G and D , whose voltages are related by a large negative gain $\left(-g_{m} R_{L}^{\prime}\right)$. This effect is known as the Miller effect, and $\left(1+g_{m} R_{L}^{\prime}\right)$ is known as the Miller multiplier.

Using $C_{e q}$ enables us to simplify the equivalent circuit at the input side to that shown in Fig. 10.18(c), which we recognize as a single-time-constant (STC) circuit of the low-pass type (Section 1.6 and Appendix E). Reference to Table 1.2 enables us to express the output voltage $V_{g s}$ of the STC circuit in the form

$$
V_{g s}=\left(\frac{R_{G}}{R_{G}+R_{\mathrm{sig}}} V_{\mathrm{sig}}\right) \frac{1}{1+\frac{s}{\omega_{0}}}
$$

where $\omega_{0}$ is the corner frequency, the break frequency, or the pole frequency of the STC circuit,

$$
\omega_{0}=1 / C_{\text {in }} R_{\text {sig }}^{\prime}
$$

with

$$
C_{\text {in }}=C_{g s}+C_{e q}=C_{g s}+C_{g d}\left(1+g_{m} R_{L}^{\prime}\right)
$$

and

$$
R_{\mathrm{sig}}^{\prime}=R_{\mathrm{sig}} \| R_{G}
$$

Combining Eqs. (10.44) and (10.46) results in the following expression for the high-frequency gain of the CS amplifier,

$$
\frac{V_{o}}{V_{\text {sig }}}=-\left(\frac{R_{G}}{R_{G}+R_{\text {sig }}}\right)\left(g_{m} R_{L}^{\prime}\right) \frac{1}{1+\frac{s}{\omega_{0}}}
$$

which can be expressed in the form

$$
\frac{V_{o}}{V_{\text {sig }}}=\frac{A_{M}}{1+\frac{s}{\omega_{H}}}
$$
where the midband gain $A_{M}$ is given by Eq. (10.43) and $\omega_{H}$ is the upper 3-dB frequency,

$$
\omega_{H}=\omega_{0}=\frac{1}{C_{\mathrm{in}} R_{\mathrm{sig}}^{\prime}}
$$

and

$$
f_{H}=\frac{\omega_{H}}{2 \pi}=\frac{1}{2 \pi C_{\mathrm{in}} R_{\mathrm{sig}}^{\prime}}
$$

We thus see that the high-frequency response will be that of a low-pass STC network with a 3-dB frequency $f_{H}$ determined by the time constant $C_{\text {in }} R_{\text {sig }}^{\prime}$. Figure 10.18(d) shows a sketch of the magnitude of the high-frequency gain.

Before leaving this section we wish to make a number of observations:

1. The upper 3-dB frequency is determined by the interaction of $R_{\text {sig }}^{\prime}=R_{\text {sig }} \| R_{G}$ and $C_{\text {in }}=C_{g s}+C_{g d}\left(1+g_{m} R_{L}^{\prime}\right)$. Since the bias resistance $R_{G}$ is usually very large, it can be neglected, resulting in $R_{\text {sig }} \simeq R_{\text {sig }}$, the resistance of the signal source. It follows that a large value of $R_{\text {sig }}$ will cause $f_{H}$ to be lowered.
2. The total input capacitance $C_{\text {in }}$ is usually dominated by $C_{e q}$, which in turn is made large by the multiplication effect that $C_{g d}$ undergoes. Thus, although $C_{g d}$ is usually a very small capacitance, its effect on the amplifier frequency response can be very significant as a result of its multiplication by the factor $\left(1+g_{m} R_{L}^{\prime}\right)$, which is approximately equal to the midband gain of the amplifier. This is the Miller effect, which causes the CS amplifier to have a large total input capacitance $C_{\text {in }}$ and hence a low $f_{H}$.
3. To extend the high-frequency response of a MOSFET amplifier, we have to find configurations in which the Miller effect is absent or at least reduced. We shall return to this subject at great length in Section 10.5 and beyond.
4. The above analysis, resulting in an STC or a single-pole response, is approximate. Specifically, it is based on neglecting $I_{g d}$ relative to $g_{m} V_{g s}$, an assumption that applies well at frequencies not too much higher than $f_{H}$. An exact analysis of the circuit in Fig. 10.18(a) reveals that the circuit has a second pole with a frequency much greater than $f_{H}$, and transmission zeros at $s=\infty$ and $s=g_{m} / C_{g d}$; the latter's frequency is also much greater than $f_{H}$. Thus both the second pole and the zero will have negligible effect on our estimate of $f_{H}$. Thus, the method that uses the Miller effect is more than sufficient for a quick estimate of $f_{H}$. As well, the approximate approach helps to reveal the primary limitation on the high-frequency response: the Miller effect.
5. The CS amplifier is said to have a dominant high-frequency pole with frequency $f_{P} \simeq f_{H}$.

# Example 10.3 

Find the midband gain $A_{M}$ and the upper 3-dB frequency $f_{H}$ of a CS amplifier fed with a signal source having an internal resistance $R_{\text {sig }}=100 \mathrm{k} \Omega$. The amplifier has $R_{G}=4.7 \mathrm{M} \Omega, R_{D}=R_{L}=15 \mathrm{k} \Omega, g_{m}=1 \mathrm{~mA} / \mathrm{V}$, $r_{o}=150 \mathrm{k} \Omega, C_{g s}=1 \mathrm{pF}$, and $C_{g d}=0.4 \mathrm{pF}$. Also, find the frequency of the transmission zero.
# Solution 

$$
A_{M}=-\frac{R_{G}}{R_{G}+R_{a q}} g_{m} R_{L}^{\prime}
$$

where

$$
\begin{gathered}
R_{L}^{\prime}=r_{o}\left\|R_{D}\right\| R_{L}=150\|15\| 15=7.14 \mathrm{k} \Omega \\
g_{m} R_{L}^{\prime}=1 \times 7.14=7.14 \mathrm{~V} / \mathrm{V}
\end{gathered}
$$

Thus,

$$
A_{M}=-\frac{4.7}{4.7+0.1} \times 7.14=-7 \mathrm{~V} / \mathrm{V}
$$

The equivalent capacitance, $C_{e q}$, is found as

$$
\begin{aligned}
C_{e q} & =\left(1+g_{m} R_{L}^{\prime}\right) C_{g d} \\
& =(1+7.14) \times 0.4=3.26 \mathrm{pF}
\end{aligned}
$$

The total input capacitance $C_{\mathrm{in}}$ can be now obtained as

$$
C_{\mathrm{in}}=C_{g s}+C_{e q}=1+3.26=4.26 \mathrm{pF}
$$

The upper 3-dB frequency $f_{H}$ is found from

$$
\begin{aligned}
f_{H} & =\frac{1}{2 \pi C_{\mathrm{in}}\left(R_{a q} \| R_{G}\right)} \\
& =\frac{1}{2 \pi \times 4.26 \times 10^{-12}(0.1\|4.7) \times 10^{6}} \\
& =382 \mathrm{kHz}
\end{aligned}
$$

Finally, the transmission zero has a frequency

$$
f_{Z}=\frac{g_{m}}{2 \pi C_{g d}}=\frac{1 \times 10^{-3}}{2 \pi \times 0.4 \times 10^{-12}}=398 \mathrm{MHz}
$$

which is more than 1000 times higher than $f_{H}$.

## EXERCISES

10.8 For the CS amplifier specified in Example 10.3, find the values of $A_{M}$ and $f_{H}$ that result when the signal-source resistance is reduced to $10 \mathrm{k} \Omega$.
Ans. $-7.12 \mathrm{~V} / \mathrm{V} ; 3.7 \mathrm{MHz}$
10.9 If it is possible to replace the MOSFET used in the amplifier in Example 10.3 with another having the same $C_{g s}$ but a smaller $C_{g d}$, what is the maximum value that its $C_{g d}$ can be in order to obtain an $f_{H}$ of at least 1 MHz ?
Ans. 0.08 pF
# 10.3.2 The Common-Emitter Amplifier 

Figure 10.19(a) shows the high-frequency equivalent circuit of a CE amplifier. It is obtained by replacing the BJT in a circuit such as that in Fig. 10.9(a) with its high-frequency, equivalent-circuit model of Fig. 10.14(a), and, as usual, eliminating all dc sources. Observe that the circuit in Fig. 10.19(a) is general and applies to both discrete- and integrated-circuit amplifiers. Thus, it includes $R_{B}$, which is usually present in discrete circuits. Also $R_{C}$ can be either a passive resistance or the output resistance of a current-source load, and similarly for $R_{L}$.

The equivalent circuit of Fig. 10.19(a) can be simplified by utilizing Thévenin theorem at the input side and by combining the three parallel resistances at the output side. Specifically, the reader should be able to show that applying Thévenin theorem twice simplifies the resistive network at the input side to a signal generator $V_{\text {sig }}^{\prime}$ and a resistance $R_{\text {sig }}^{\prime}$, with the values indicated in the figure.

The equivalent circuit in Fig. 10.19(b) can be used to obtain the midband gain $A_{M}$ by setting $C_{\pi}$ and $C_{\mu}$ to zero. The result is

$$
A_{M}=\frac{V_{o}}{V_{\text {sig }}}=-\frac{R_{B}}{R_{B}+R_{\text {sig }}} \frac{r_{\pi}}{r_{\pi}+r_{s}+\left(R_{\text {sig }} \| R_{B}\right)}\left(g_{m} R_{L}^{\prime}\right)
$$

where

$$
R_{L}^{\prime}=r_{o}\left\|R_{C}\right\| R_{L}
$$

Next we observe that the circuit in Fig. 10.19(b) is identical to that of the CS amplifier in Fig. 10.18(b). Thus the analysis can follow the same process we used for the CS case. The analysis is illustrated in Fig. 10.19(c) and (d). The final result is that the CE amplifier gain at high frequencies is given approximately by

$$
\frac{V_{o}}{V_{\text {sig }}}=\frac{A_{M}}{1+\frac{s}{\omega_{H}}}
$$

where $A_{M}$ is given by Eq. (10.54) and the 3-dB frequency $f_{H}$ is given by

$$
f_{H}=\frac{\omega_{H}}{2 \pi}=\frac{1}{2 \pi C_{\text {in }} R_{\text {sig }}^{\prime}}
$$

where

$$
C_{\text {in }}=C_{\pi}+C_{\mu}\left(1+g_{m} R_{L}^{\prime}\right)
$$

and

$$
R_{\text {sig }}^{\prime}=r_{\pi} \|\left[r_{s}+\left(R_{B} \| R_{\text {sig }}\right)\right]
$$

Observe that $C_{\text {in }}$ is simply the sum of $C_{\pi}$ and the Miller capacitance $C_{\mu}\left(1+g_{m} R_{L}^{\prime}\right)$. The resistance $R_{\text {sig }}^{\prime}$ seen by $C_{\text {in }}$ can be easily found from the circuit in Fig. 10.19(a) as follows: Reduce $V_{\text {sig }}$ to zero, "grab hold" of the terminals B' and E and look back (to the left). You will see $r_{\pi}$ in parallel with $r_{s}$, which is in series with $\left(R_{B} \| R_{\text {sig }}\right)$. This way of finding the resistance "seen by a capacitance" is very useful and spares one from tedious work!

Finally, comments very similar to those made on the high-frequency response of the CS amplifier can be made here as well.

(a)


$$
\begin{aligned}
V_{\text {sig }}^{\prime} & =V_{\text {sig }} \frac{R_{B}}{R_{B}+R_{\text {sig }}} \frac{r_{\pi}}{r_{\pi}+r_{s}+\left(R_{\text {sig }} \| R_{B}\right)} \quad R_{L}^{\prime}=r_{o} \| R_{C} \| R_{L} \\
R_{\text {sig }}^{\prime} & =r_{\pi} \|\left[r_{s}+\left(R_{B} \| R_{\text {sig }}\right)\right]
\end{aligned}
$$

(b)


$$
\begin{aligned}
C_{\text {in }} & =C_{\pi}+C_{e q} \\
& =C_{\pi}+C_{\mu}\left(1+g_{m} R_{L}^{\prime}\right)
\end{aligned} \quad V_{o}=-g_{m} R_{L}^{\prime} V_{\pi}
$$

(c)

Figure 10.19 Determining the high-frequency response of the CE amplifier: (a) equivalent circuit; (b) the circuit of (a) simplified at both the input side and the output side; (c) equivalent circuit with $C_{\mu}$ replaced at the input side with the equivalent capacitance $C_{e q}$; (d) sketch of the frequency-response plot, which is that of a low-pass STC circuit.


Figure 10.19 continued

# Example 10.4 

It is required to find the midband gain and the upper 3-dB frequency of the common-emitter amplifier of Fig. 10.9(a) for the following case: $I_{E}=1 \mathrm{~mA}, R_{B}=R_{B 1} \| R_{B 2}=100 \mathrm{k} \Omega, R_{C}=8 \mathrm{k} \Omega, R_{\text {sig }}=5 \mathrm{k} \Omega$, $R_{L}=5 \mathrm{k} \Omega, \beta_{0}=100, V_{A}=100 \mathrm{~V}, C_{o}=1 \mathrm{pF}, f_{T}=800 \mathrm{MHz}$, and $r_{s}=50 \Omega$. Also, determine the frequency of the transmission zero.

## Solution

The transistor is biased at $I_{C} \simeq 1 \mathrm{~mA}$. Thus the values of its hybrid- $\pi$ model parameters are

$$
\begin{aligned}
g_{m} & =\frac{I_{C}}{V_{T}}=\frac{1 \mathrm{~mA}}{25 \mathrm{mV}}=40 \mathrm{~mA} / \mathrm{V} \\
r_{\pi} & =\frac{\beta_{0}}{g_{m}}=\frac{100}{40 \mathrm{~mA} / \mathrm{V}}=2.5 \mathrm{k} \Omega \\
r_{o} & =\frac{V_{A}}{I_{C}}=\frac{100 \mathrm{~V}}{1 \mathrm{~mA}}=100 \mathrm{k} \Omega \\
C_{\pi}+C_{o} & =\frac{g_{m}}{\omega_{T}}=\frac{40 \times 10^{-3}}{2 \pi \times 800 \times 10^{6}}=8 \mathrm{pF} \\
C_{o} & =1 \mathrm{pF} \\
C_{\pi} & =7 \mathrm{pF} \\
r_{s} & =50 \Omega
\end{aligned}
$$

The midband voltage gain is

$$
A_{M}=-\frac{R_{B}}{R_{B}+R_{\text {sig }}} \frac{r_{\pi}}{r_{\pi}+r_{s}+\left(R_{B} \| R_{\text {sig }}\right)} g_{m} R_{L}^{\prime}
$$
where

$$
\begin{aligned}
R_{L}^{\prime} & =r_{o}\left\|R_{C}\right\| R_{L} \\
& =(100\|8\| 5) \mathrm{k} \Omega=3 \mathrm{k} \Omega
\end{aligned}
$$

Thus,

$$
g_{m} R_{L}^{\prime}=40 \times 3=120 \mathrm{~V} / \mathrm{V}
$$

and

$$
\begin{aligned}
A_{M} & =-\frac{100}{100+5} \times \frac{2.5}{2.5+0.05+(100\|5)} \times 120 \\
& =-39 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

and

$$
20 \log \left|A_{M}\right|=32 \mathrm{~dB}
$$

To determine $f_{H}$ we first find $C_{\text {in }}$,

$$
\begin{aligned}
C_{\text {in }} & =C_{\pi}+C_{\mu}\left(1+g_{m} R_{L}^{\prime}\right) \\
& =7+1(1+120)=128 \mathrm{pF}
\end{aligned}
$$

and the effective source resistance $R_{\text {sig }}^{\prime}$,

$$
\begin{aligned}
R_{\text {sig }}^{\prime} & =r_{\pi} \|\left[r_{\mathrm{s}}+\left(R_{B} \| R_{\text {sig }}\right)\right] \\
& =2.5 \|\{0.05+(100\|5)\} \\
& =1.65 \mathrm{k} \Omega
\end{aligned}
$$

Thus,

$$
f_{H}=\frac{1}{2 \pi C_{\text {in }} R_{\text {sig }}^{\prime}}=\frac{1}{2 \pi \times 128 \times 10^{-12} \times 1.65 \times 10^{3}}=754 \mathrm{kHz}
$$

Finally, as in the case of the CS amplifier, it can be shown that the CE amplifier has a transmission zero with frequency

$$
f_{Z}=\frac{g_{m}}{2 \pi C_{\mu}}=\frac{40 \times 10^{-3}}{2 \pi \times 1 \times 10^{-12}}=6.37 \mathrm{GHz}
$$

which is much higher than $f_{H}$.

# EXERCISE 

10.10 For the amplifier in Example 10.4, find the value of $R_{L}$ that reduces the midband gain to half the value found. What value of $f_{H}$ results? Note the trade-off between gain and bandwidth. Ans. $1.9 \mathrm{k} \Omega ; 1.42 \mathrm{MHz}$# 10.3.3 Miller's Theorem 

In our analysis of the high-frequency response of the common-source and common-emitter amplifiers, we employed a technique for replacing the bridging capacitance ( $C_{b}$, or $C_{o}$ ) by an equivalent input capacitance. This very useful and effective technique is based on a general theorem known as Miller's theorem, which we now present.

Consider the situation in Fig. 10.20(a). As part of a larger circuit that is not shown, we have isolated two circuit nodes, labeled 1 and 2, between which an impedance $Z$ is connected. Nodes 1 and 2 are also connected to other parts of the circuit, as signified by the broken lines emanating from the two nodes. Furthermore, it is assumed that somehow it has been determined that the voltage at node 2 is related to that at node 1 by

$$
V_{2}=K V_{1}
$$

In typical situations, $K$ is a gain factor that can be positive or negative and has a magnitude usually larger than unity. This, however, is not an assumption for Miller's theorem.

Miller's theorem states that impedance $Z$ can be replaced by two impedances: $Z_{1}$ connected between node 1 and ground and $Z_{2}$ connected between node 2 and ground, where

$$
Z_{1}=Z /(1-K)
$$

and

$$
Z_{2}=Z /\left(1-\frac{1}{K}\right)
$$

to obtain the equivalent circuit shown in Fig. 10.20(b).
The proof of Miller's theorem is achieved by deriving Eqs. (10.61) as follows: In the original circuit of Fig. 10.20(a), the only way that node 1 "feels the existence" of impedance $Z$ is through the current $I$ that $Z$ draws away from node 1 . Therefore, to keep this current unchanged in the equivalent circuit, we must choose the value of $Z_{1}$ so that it draws an equal current,

$$
I_{1}=\frac{V_{1}}{Z_{1}}=I=\frac{V_{1}-K V_{1}}{Z}
$$



Figure 10.20 The Miller equivalent circuit.
which yields the value of $Z_{1}$ in Eq. (10.61a). Similarly, to keep the current into node 2 unchanged, we must choose the value of $Z_{2}$ so that

$$
I_{2}=\frac{0-V_{2}}{Z_{2}}=\frac{0-K V_{1}}{Z_{2}}=I=\frac{V_{1}-K V_{1}}{Z}
$$

which yields the expression ${ }^{5}$ for $Z_{2}$ in Eq. (10.61b).

# Example 10.5 

Figure 10.21(a) shows an ideal voltage amplifier having a gain of $-100 \mathrm{~V} / \mathrm{V}$ with an impedance $Z$ connected between its output and input terminals. Find the Miller equivalent circuit when $Z$ is (a) a 1-M $\Omega$ resistance and (b) a 1-pF capacitance. In each case, use the equivalent circuit to determine $V_{o} / V_{\text {sig }}$.

## Solution

(a) For $Z=1 \mathrm{M} \Omega$, employing Miller's theorem results in the equivalent circuit in Fig. 10.21(b), where

$$
\begin{aligned}
& Z_{1}=\frac{Z}{1-K}=\frac{1000 \mathrm{k} \Omega}{1+100}=9.9 \mathrm{k} \Omega \\
& Z_{2}=\frac{Z}{1-\frac{1}{K}}=\frac{1 \mathrm{M} \Omega}{1+\frac{1}{100}}=0.99 \mathrm{M} \Omega
\end{aligned}
$$

The voltage gain can be found as follows:

$$
\begin{aligned}
\frac{V_{o}}{V_{\text {sig }}} & =\frac{V_{o}}{V_{i}} \frac{V_{i}}{V_{\text {sig }}}=-100 \times \frac{Z_{1}}{Z_{1}+R_{\text {sig }}} \\
& =-100 \times \frac{9.9}{9.9+10}=-49.7 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

(b) For $Z$ as a 1-pF capacitance-that is, $Z=1 / s C=1 / s \times 1 \times 10^{-12}$-applying Miller's theorem allows us to replace $Z$ by $Z_{1}$ and $Z_{2}$, where

$$
\begin{aligned}
& Z_{1}=\frac{Z}{1-K}=\frac{1 / s C}{1+100}=1 / s(101 C) \\
& Z_{2}=\frac{Z}{1-\frac{1}{K}}=\frac{1}{1.01} \frac{1}{s C}=\frac{1}{s(1.01 C)}
\end{aligned}
$$

[^0]
[^0]:    ${ }^{5}$ Although not highlighted, the Miller equivalent circuit derived above is valid only as long as the rest of the circuit remains unchanged; otherwise the ratio of $V_{2}$ to $V_{1}$ might change. It follows that the Miller equivalent circuit cannot be used directly to determine the output resistance of an amplifier. This is because in determining output resistances it is implicitly assumed that the source signal is reduced to zero and that a test-signal source (voltage or current) is applied to the output terminals-obviously a major change in the circuit, rendering the Miller equivalent circuit no longer valid.
Example 10.5 continued

(a)

(b)

(c)

Figure 10.21 Circuits for Example 10.5.
It follows that $Z_{1}$ is a capacitance $101 C=101 \mathrm{pF}$ and that $Z_{2}$ is a capacitance $1.01 C=1.01 \mathrm{pF}$. The resulting equivalent circuit is shown in Fig. 10.21(c), from which the voltage gain can be found as follows:

$$
\begin{aligned}
\frac{V_{o}}{V_{\text {sig }}} & =\frac{V_{o}}{V_{i}} \frac{V_{i}}{V_{\text {sig }}}=-100 \frac{1 / s C_{1}}{1 /\left(s C_{1}\right)+R_{\text {sig }}} \\
& =\frac{-100}{1+s C_{1} R_{\text {sig }}} \\
& =\frac{-100}{1+s \times 101 \times 1 \times 10^{-12} \times 10 \times 10^{3}} \\
& =\frac{-100}{1+s \times 1.01 \times 10^{-6}}
\end{aligned}
$$
This is the transfer function of a first-order low-pass network with a dc gain of -100 and a 3-dB frequency $f_{\text {3dB }}$ of

$$
f_{3 \mathrm{~dB}}=\frac{1}{2 \pi \times 1.01 \times 10^{-6}}=157.6 \mathrm{kHz}
$$

From Example 10.5, we observe that the Miller replacement of a feedback or bridging resistance results, for a negative $K$, in a smaller resistance [by a factor $(1-K)$ ] at the input. If the feedback element is a capacitance, its value is multiplied by $(1-K)$ to obtain the equivalent capacitance at the input side. The multiplication of a feedback capacitance by $(1-K)$ is referred to as Miller multiplication or Miller effect. We have encountered the Miller effect in the analysis of the CS and CE amplifiers. Note, however, that we neglected the Miller capacitance at the output because it is small; for the CS case, $C_{2}=C_{g d}\left(1+\frac{1}{g_{m} R_{L}^{\prime}}\right) \simeq C_{g d}$.

## JOHN MILTON MILLER-CAPACITANCE MULTIPLICATION:

In 1920 in the Scientific Papers of the National Bureau of Standards, John Miller first published data and analysis on the input capacitance of a vacuum-tube triode amplifier and the phenomenon ultimately known as the Miller effect. Attempts to eliminate or reduce this effect in amplifiers and oscillators led to several developments: First, in 1926, came vacuum-tube pentodes with internal grounded shielding elements; much later, in 1939, the cascode configuration was introduced, initially using vacuum-tube triodes and then with BJTs and MOSFETs.

# 10.3.4 Frequency Response of the CS Amplifier When $R_{\text {sig }}$ Is Low 

There are applications in which the CS amplifier is fed with a low-resistance signal source. In such a case, the high-frequency gain will no longer be limited by the interaction of the source resistance and the input capacitance. Rather, the high-frequency limitation occurs at the amplifier output as we shall now show.

Figure 10.22(a) shows the high-frequency equivalent circuit of the common-source amplifier in the limiting case when $R_{\text {sig }}$ is zero. Observe that we have included a capacitance $C_{L}$ across the load $R_{L}$. We have done this in the anticipation that a capacitance at the output node, even if it is very small, will play an important role in this case. Also, there always is some capacitance between the output node and ground. This can include $C_{d b}$ of the MOSFET [see the MOSFET high-frequency model of Fig. 10.12(b)], the input capacitance of another amplifier stage our amplifier feeds, other stray capacitances, and so on. Finally, we note that we did not include $C_{L}$ in the previous analysis because its role is not significant when $R_{\text {sig }}$ is large.

Returning to the circuit in Fig. 10.22(a), we can now derive its transfer function $V_{a} / V_{\text {sig }}$. First, note that

$$
V_{g s}=V_{\text {sig }}
$$

Second, the current $I_{g d}$ that flows through $C_{g d}$ can be expressed as

$$
I_{g d}=s C_{g d}\left(V_{g s}-V_{o}\right)
$$


Figure 10.22 (a) High-frequency equivalent circuit of a CS amplifier fed with a signal source having a very low (effectively zero) resistance. (b) The circuit with $V_{\text {sig }}$ reduced to zero. (c) Bode plot for the gain of the circuit in (a).

Next, we can write a node equation at the output node as

$$
I_{g d}=g_{m} V_{g s}+\frac{V_{o}}{R_{L}^{\prime}}+s C_{L} V_{o}
$$

where

$$
R_{L}^{\prime}=R_{L} \| r_{o}
$$

Combining Eqs. (10.63) and (10.64) to eliminate $I_{g d}$, substituting $V_{g s}=V_{\text {sig }}$ from Eq. (10.62), and manipulating the resulting equation to obtain the transfer function $V_{o} / V_{\text {sig }}$ results in

$$
\frac{V_{o}}{V_{\text {sig }}}=-g_{m} R_{L}^{\prime} \frac{1-s\left(C_{g d} / g_{m}\right)}{1+s\left(C_{L}+C_{g d}\right) R_{L}^{\prime}}
$$
Thus, while the dc gain from gate to drain remains equal to $g_{m} R_{L}^{\prime}$, and the frequency of the transmission zero remains unchanged at

$$
f_{Z}=\frac{g_{m}}{2 \pi C_{g d}}
$$

the high-frequency response is now determined by a pole formed by $\left(C_{L}+C_{g d}\right)$ together with $R_{L}^{\prime}$. Thus the 3-dB frequency $f_{H}$ is now given by

$$
f_{H}=\frac{1}{2 \pi\left(C_{L}+C_{g d}\right) R_{L}^{\prime}}
$$

To see how this pole is formed, refer to Fig. 10.22(b), which shows the equivalent circuit with $V_{\text {sig }}$ reduced to zero. Observe that the circuit reduces to a capacitance $\left(C_{L}+C_{g d}\right)$ in parallel with a resistance $R_{L}^{\prime}$.

We note that the transmission zero frequency, given by Eq. (10.66), is much higher than $f_{H}$,

$$
\frac{f_{Z}}{f_{H}}=\left(g_{m} R_{L}^{\prime}\right)\left(1+\frac{C_{L}}{C_{g d}}\right)
$$

Thus, $f_{Z}$ does not play a significant role in the vicinity of $f_{H}$. In fact, the gain decreases from its low-frequency value of $\left(g_{m} R_{L}^{\prime}\right)$ at a uniform rate of $-6 \mathrm{~dB} /$ octave ( $-20 \mathrm{~dB} /$ decade), reaching unity $(0 \mathrm{~dB})$ at a frequency $f_{t}$, which is equal to the gain-bandwidth product,

$$
\begin{aligned}
f_{t} & =\left|A_{M}\right| f_{H} \\
& =g_{m} R_{L}^{\prime} \frac{1}{2 \pi\left(C_{L}+C_{g d}\right) R_{L}^{\prime}}
\end{aligned}
$$

Thus,

$$
f_{t}=\frac{g_{m}}{2 \pi\left(C_{L}+C_{g d}\right)}
$$

Figure 10.22(c) shows a sketch of the high-frequency gain of the CS amplifier.

# Example 10.6 

Consider an IC CS amplifier fed with a source having $R_{\text {sig }}=0$ and having an effective load resistance $R_{L}^{\prime}$ composed of $r_{o}$ of the amplifier transistor in parallel with an equal resistance $r_{o}$ of the current-source load. Let $g_{m}=1.25 \mathrm{~mA} / \mathrm{V}, r_{o}=20 \mathrm{k} \Omega, C_{g s}=20 \mathrm{fF}, C_{g d}=5 \mathrm{fF}$, and $C_{L}=25 \mathrm{fF}$. Find $A_{M}, f_{H}, f_{t}$, and $f_{Z}$. If the amplifying transistor is to be operated at twice the original overdrive voltage while $W$ and $L$ remain unchanged, by what factor must the bias current be changed? What are the new values of $A_{M}, f_{H}, f_{t}$, and $f_{Z}$ ?

## Solution

The low-frequency gain $A_{M}$ is given by

$$
A_{M}=-g_{m} R_{L}^{\prime}=-g_{m}\left(r_{o} \| r_{o}\right)
$$
# Example 10.6 continued 

Thus,

$$
\begin{aligned}
A_{M} & =-\frac{1}{2} g_{m} r_{o}=-\frac{1}{2} \times 1.25 \times 20 \\
& =-12.5 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

The 3-dB frequency $f_{H}$ can be found using Eq. (10.67),

$$
\begin{aligned}
f_{H} & =\frac{1}{2 \pi\left(C_{L}+C_{g d}\right) R_{L}^{\prime}} \\
& =\frac{1}{2 \pi(25+5) \times 10^{-15} \times 10 \times 10^{3}} \\
& =530.5 \mathrm{MHz}
\end{aligned}
$$

and the unity-gain frequency, which is equal to the gain-bandwidth product, can be determined as

$$
f_{t}=\left|A_{M}\right| f_{H}=12.5 \times 530.5=6.63 \mathrm{GHz}
$$

The frequency of the zero is obtained using Eq. (10.66) as

$$
\begin{aligned}
f_{Z} & =\frac{1}{2 \pi} \frac{g_{m}}{C_{g d}} \\
& =\frac{1}{2 \pi} \frac{1.25 \times 10^{-3}}{5 \times 10^{-15}} \simeq 40 \mathrm{GHz}
\end{aligned}
$$

Now, to double $V_{O V}, I_{D}$ must be quadrupled. The new values of $g_{m}$ and $R_{L}^{\prime}$ can be found as follows:

$$
\begin{aligned}
& g_{m}=\frac{I_{D}}{V_{O V} / 2}=2.5 \mathrm{~mA} / \mathrm{V} \\
& R_{L}^{\prime}=\frac{1}{4} \times 10=2.5 \mathrm{k} \Omega
\end{aligned}
$$

Thus the new value of $A_{M}$ becomes

$$
A_{M}=-g_{m} R_{L}^{\prime}=-2.5 \times 2.5=-6.25 \mathrm{~V} / \mathrm{V}
$$

That of $f_{H}$ becomes

$$
\begin{aligned}
f_{H} & =\frac{1}{2 \pi\left(C_{L}+C_{g d}\right) R_{L}^{\prime}} \\
& =\frac{1}{2 \pi(25+5) \times 10^{-15} \times 2.5 \times 10^{3}} \\
& =2.12 \mathrm{GHz}
\end{aligned}
$$

and the unity-gain frequency (i.e., the gain-bandwidth product) becomes

$$
f_{t}=6.25 \times 2.12=13.3 \mathrm{GHz}
$$

We note that doubling $V_{O V}$ results in reducing the dc gain by a factor of 2 and increasing the bandwidth by a factor of 4 . Thus, the gain-bandwidth product is doubled-a good bargain!

Finally, the frequency of the transmission zero $f_{Z}$ will be doubled, becoming 80 GHz .
# EXERCISE 

10.11 For the CS amplifier considered in Example 10.6 operating at the original values of $V_{o v}$ and $I_{D}$, find the value to which $C_{L}$ should be increased to place $f_{i}$ at 2 GHz .
Ans. 94.5 fF

We conclude this section by noting that a CE amplifier fed with $R_{\text {sig }}=0$ can be analyzed in exactly the same way used for the CS case. The most general case when $R_{\text {sig }}$ is not zero and $C_{L}$ is present will be dealt with in the next section.

### 10.4 Useful Tools for the Analysis of the High-Frequency Response of Amplifiers

In Section 10.3 we presented an approximate method, utilizing the Miller effect, to analyze the high-frequency response of the CS and CE amplifiers; the method provides a reasonably accurate estimate of $f_{H}$ and, equally important, considerable insight into the mechanism that limits high-frequency operation. Unfortunately, however, this method cannot deal with the case when a load capacitance $C_{L}$ is present. As well, the method is not easily extendable to more complex amplifier circuits. For this reason, we will digress briefly into how to equip ourselves with a number of tools that will prove useful in the analysis of more complex circuits such as the cascode amplifier. We will begin by stepping back and more generally considering the amplifier high-frequency transfer function.

### 10.4.1 The High-Frequency Gain Function

The amplifier gain, taking into account the internal transistor capacitances, can be expressed as a function of the complex-frequency variable $s$ in the general form

$$
A(s)=A_{M} F_{H}(s)
$$

where $A_{M}$ is the midband gain, which for IC amplifiers is also equal to the low-frequency or dc gain (refer to Fig. 10.2). The value of $A_{M}$ can be determined by analyzing the amplifier equivalent circuit while neglecting the effect of the transistor internal capacitances-that is, by assuming that they act as perfect open circuits. By taking these capacitances into account, we see that the gain acquires the factor $F_{H}(s)$, which can be expressed in terms of its poles and zeros, which are usually real, as follows:

$$
F_{H}(s)=\frac{\left(1+s / \omega_{Z 1}\right)\left(1+s / \omega_{Z 2}\right) \cdots\left(1+s / \omega_{Z n}\right)}{\left(1+s / \omega_{P 1}\right)\left(1+s / \omega_{P 2}\right) \cdots\left(1+s / \omega_{P n}\right)}
$$
where $\omega_{P 1}, \omega_{P 2}, \ldots, \omega_{P n}$ are positive numbers representing the frequencies of the $n$ real poles ${ }^{6}$ and $\omega_{Z 1}, \omega_{Z 2}, \ldots, \omega_{Z n}$ are positive, negative, or infinite numbers representing the frequencies of the $n$ real transmission zeros. Since the frequencies of the zeros and poles are by definition greater than the midband frequencies, we see from Eq. (10.71) that as $s$ approaches midband frequencies, $F_{H}(s)$ approaches unity and the gain approaches $A_{M}$.

# 10.4.2 Determining the 3-dB Frequency $f_{H}$ 

The amplifier designer usually is particularly interested in the part of the high-frequency band that is close to the midband. This is because the designer needs to estimate-and, if need be, modify-the value of the upper 3-dB frequency $f_{H}$ (or $\omega_{H} ; f_{H}=\omega_{H} / 2 \pi$ ). Toward that end, it should be mentioned that in many cases the zeros are either at infinity or such high frequencies as to be of little significance to the determination of $\omega_{H}$. If in addition one of the poles, say $\omega_{P 1}$, is of much lower frequency than any of the other poles, then this pole will have the greatest effect on the value of the amplifier $\omega_{H}$. In other words, this pole will dominate the high-frequency response of the amplifier, and the amplifier is said to have a dominant-pole response. In such cases, the function $F_{H}(s)$ can be approximated by

$$
F_{H}(s) \simeq \frac{1}{1+s / \omega_{P 1}}
$$

which is the transfer function of a first-order (or STC) low-pass network (Appendix E). It follows that if a dominant pole exists, then the determination of $\omega_{H}$ is greatly simplified;

$$
\omega_{H} \simeq \omega_{P 1}
$$

This is the situation we encountered in the cases of the common-source and common-emitter amplifiers analyzed in Section 10.3. As a rule of thumb, a dominant pole exists if the lowest-frequency pole is at least two octaves (a factor of 4) away from the nearest pole or zero.

If a dominant pole does not exist, the 3-dB frequency $\omega_{H}$ can be determined from a plot of $\left|F_{H}(j \omega)\right|$. Alternatively, an approximate formula for $\omega_{H}$ can be derived as follows. Consider, for simplicity, the case of a circuit having two poles and two zeros in the high-frequency band; that is,

$$
F_{H}(s)=\frac{\left(1+s / \omega_{Z 1}\right)\left(1+s / \omega_{Z 2}\right)}{\left(1+s / \omega_{P 1}\right)\left(1+s / \omega_{P 2}\right)}
$$

Substituting $s=j \omega$ and taking the squared magnitude gives

$$
\left|F_{H}(j \omega)\right|^{2}=\frac{\left(1+\omega^{2} / \omega_{Z 1}^{2}\right)\left(1+\omega^{2} / \omega_{Z 2}^{2}\right)}{\left(1+\omega^{2} / \omega_{P 1}^{2}\right)\left(1+\omega^{2} / \omega_{P 2}^{2}\right)}
$$

[^0]
[^0]:    ${ }^{6}$ In certain cases, some of the poles can be complex. One notable such case is the source and emitter followers, which can have a pair of complex-conjugate poles (Section 10.6).
By definition, at $\omega=\omega_{H},\left|F_{H}\right|^{2}=\frac{1}{2}$; thus,

$$
\begin{aligned}
\frac{1}{2} & =\frac{\left(1+\omega_{H}^{2} / \omega_{Z 1}^{2}\right)\left(1+\omega_{H}^{2} / \omega_{Z 2}^{2}\right)}{\left(1+\omega_{H}^{2} / \omega_{P 1}^{2}\right)\left(1+\omega_{H}^{2} / \omega_{P 2}^{2}\right)} \\
& =\frac{1+\omega_{H}^{2}\left(\frac{1}{\omega_{Z 1}^{2}}+\frac{1}{\omega_{Z 2}^{2}}\right)+\omega_{H}^{4} / \omega_{Z 1}^{2} \omega_{Z 2}^{2}}{1+\omega_{H}^{2}\left(\frac{1}{\omega_{P 1}^{2}}+\frac{1}{\omega_{P 2}^{2}}\right)+\omega_{H}^{4} / \omega_{P 1}^{2} \omega_{P 2}^{2}}
\end{aligned}
$$

Since $\omega_{H}$ is usually smaller than the frequencies of all the poles and zeros, we may neglect the terms containing $\omega_{H}^{3}$ and solve for $\omega_{H}$ to obtain

$$
\omega_{H} \simeq 1 / \sqrt{\frac{1}{\omega_{P 1}^{2}}+\frac{1}{\omega_{P 2}^{2}}-\frac{2}{\omega_{Z 1}^{2}}-\frac{2}{\omega_{Z 2}^{2}}}
$$

This relationship can be extended to any number of poles and zeros as

$$
\omega_{H} \simeq 1 / \sqrt{\left(\frac{1}{\omega_{P 1}^{2}}+\frac{1}{\omega_{P 2}^{2}}+\cdots\right)-2\left(\frac{1}{\omega_{Z 1}^{2}}+\frac{1}{\omega_{Z 2}^{2}}+\cdots\right)}
$$

Note that if one of the poles, say $P_{1}$, is dominant, then $\omega_{P 1} \ll \omega_{P 2}, \omega_{P 3}, \ldots, \omega_{Z 1}, \omega_{Z 2}, \ldots$, and Eq. (10.77) reduces to Eq. (10.73).

# Example 10.7 

The high-frequency response of an amplifier is characterized by the transfer function

$$
F_{H}(s)=\frac{1-s / 10^{5}}{\left(1+s / 10^{4}\right)\left(1+s / 4 \times 10^{4}\right)}
$$

Determine the 3-dB frequency approximately and exactly.

## Solution

Noting that the lowest-frequency pole at $10^{4} \mathrm{rad} / \mathrm{s}$ is two octaves lower than the second pole and a decade lower than the zero, we find that a dominant-pole situation almost exists and $\omega_{H} \simeq 10^{4} \mathrm{rad} / \mathrm{s}$. A better estimate of $\omega_{H}$ can be obtained using Eq. (10.77), as follows:

$$
\begin{aligned}
\omega_{H} & =1 / \sqrt{\frac{1}{10^{8}}+\frac{1}{16 \times 10^{8}}-\frac{2}{10^{10}}} \\
& =9800 \mathrm{rad} / \mathrm{s}
\end{aligned}
$$

The exact value of $\omega_{H}$ can be determined from the given transfer function as $9537 \mathrm{rad} / \mathrm{s}$. Finally, we show in Fig. 10.23 a Bode plot and an exact plot for the given transfer function. Note that this is a plot of the high-frequency response of the amplifier normalized relative to its midband gain. That is, if the midband gain is, say, 100 dB , then the entire plot should be shifted upward by 100 dB .# Example 10.7 continued 



Figure 10.23 Normalized high-frequency response of the amplifier in Example 10.7.

## EXERCISES

10.12 A direct-coupled amplifier has a dc gain of $1000 \mathrm{~V} / \mathrm{V}$ and an upper 3-dB frequency of 100 kHz . Find the transfer function and the gain-bandwidth product in hertz.
Ans. $\frac{1000}{1+\frac{s}{2 \pi \times 10^{5}}} ; 10^{4} \mathrm{~Hz}$
10.13 The high-frequency response of an amplifier is characterized by two zeros at $s=\infty$ and two poles at $\omega_{P 1}$ and $\omega_{P 2}$. For $\omega_{P 2}=k \omega_{P 1}$, find the value of $k$ that results in the exact value of $\omega_{H}$ being $0.9 \omega_{P 1}$. Repeat for $\omega_{H}=0.99 \omega_{P 1}$.
Ans. $2.78 ; 9.88$
10.14 For the amplifier described in Exercise 10.13, find the exact and approximate values (using Eq. 10.77) of $\omega_{H}$ (as a function of $\omega_{P 1}$ ) for the cases $k=1,2$, and 4.
Ans. $0.64,0.71 ; 0.84,0.89 ; 0.95,0.97$
# 10.4.3 The Method of Open-Circuit Time Constants 

If the poles and zeros of the amplifier transfer function can be determined easily, then we can determine $f_{H}$ using the techniques above. In many cases, however, it is not a simple matter to determine the poles and zeros by quick hand analysis. In such cases an approximate value for $f_{H}$ can be obtained using the method of open-circuit time constants, which we describe next. This method is the dual of the method of short-circuit time constants we used in Section 10.1 for the estimation of $f_{L}$.

Consider the function $F_{H}(s)$ (Eq. 10.71), which determines the high-frequency response of the amplifier. The numerator and denominator factors can be multiplied out and $F_{H}(s)$ expressed in the alternative form

$$
F_{H}(s)=\frac{1+a_{1} s+a_{2} s^{2}+\cdots+a_{n} s^{n}}{1+b_{1} s+b_{2} s^{2}+\cdots+b_{n} s^{n}}
$$

where the coefficients $a$ and $b$ are related to the frequencies of the zeros and poles, respectively. Specifically, the coefficient $b_{1}$ is given by

$$
b_{1}=\frac{1}{\omega_{P 1}}+\frac{1}{\omega_{P 2}}+\cdots+\frac{1}{\omega_{P n}}
$$

It can be shown [see Gray and Searle (1969) ${ }^{7}$ ] that the value of $b_{1}$ can be obtained by setting the input signal to zero and considering the various capacitances in the high-frequency equivalent circuit one at a time while reducing all other capacitors to zero (or, equivalently, replacing them with open circuits). That is, to obtain the contribution of capacitance $C_{i}$, we reduce all other capacitances to zero, reduce the input signal source to zero, and determine the resistance $R_{i}$ seen by $C_{i}$. This can be done either by inspection or by replacing $C_{i}$ with a voltage source $V_{x}$, finding the current $I_{x}$ drawn from $V_{x}$, and calculating $R_{i} \equiv V_{x} / I_{x}$. The time constant $\tau_{i}$ associated with $C_{i}$ is then found as $\tau_{i}=C_{i} R_{i}$. This process is then repeated for all other capacitors in the circuit. The value of $b_{1}$ is computed by summing the individual time constants, called open-circuit time constants,

$$
b_{1}=\sum_{i=1}^{n} C_{i} R_{i}
$$

where we have assumed that there are $n$ capacitors in the high-frequency equivalent circuit.
This method for determining $b_{1}$ is exact; the approximation comes about in using the value of $b_{1}$ to determine $\omega_{H}$. Specifically, if the zeros are not dominant and if one of the poles, say $P_{1}$, is dominant, then from Eq. (10.79),

$$
b_{1} \simeq \frac{1}{\omega_{P 1}}
$$

But, also, the upper 3-dB frequency will be approximately equal to $\omega_{P 1}$, leading to

$$
\omega_{H} \simeq \frac{1}{b_{1}}=\frac{1}{\sum_{i} C_{i} R_{i}}
$$

Here it should be pointed out that in complex circuits we usually do not know whether a dominant pole exists. Nevertheless, using Eq. (10.82) to determine $\omega_{H}$ normally yields

[^0]
[^0]:    ${ }^{7}$ The bibliography is in Appendix I.
remarkably good results ${ }^{8}$ even if a dominant pole does not exist. Finally, we note that we will sometimes refer to the sum of time constants in Eq. (10.81) by $\tau_{H}$; that is, $\tau_{H}=b_{1}$, and is known as the effective high-frequency time constant.

# 10.4.4 Application of the Method of Open-Circuit Time Constants to the CS Amplifier 

Figure 10.24 shows a generalized high-frequency equivalent circuit for the common-source amplifier. Here, $V_{\text {sig }}^{\prime}$ and $R_{\text {sig }}^{\prime}$ are the Thévenin equivalent of the signal generator together with whatever bias circuit may be present at the amplifier input [e.g., $R_{G}$ in the circuit of Fig. 10.3(a)]. Resistance $R_{L}^{\prime}$ represents the total resistance between the output (drain) node and ground and includes $R_{D}, r_{o}$, and $R_{L}$ (if one is present). Similarly, $C_{L}$ represents the total capacitance between the drain node and ground and includes the MOSFET's drain-to-body capacitance $\left(C_{d b}\right)$, the capacitance introduced by a current-source load, the input capacitance of a succeeding amplifier stage (if one is present), and in some cases, as we will see in later chapters, a deliberately introduced capacitance. In IC MOS amplifiers, $C_{L}$ can be substantial.

The equivalent circuit in Fig. 10.24 can also be used to represent the CE amplifier. Thus, we will not need to repeat the analysis; rather, we can adapt the CS results to the CE case by simply renaming the components (i.e., replacing $C_{g s}$ by $C_{\pi}$ and $C_{g d}$ by $C_{\mu}$ ).

We wish to determine the 3-dB frequency $f_{H}$ of the CS amplifier in Fig. 10.24 using the method of open-circuit time constants. Toward that end, we set $V_{\text {sig }}=0$ and consider each of the three capacitances at a time, setting the other two to zero. Figure 10.25(a) shows the resulting circuit for determining the resistance $R_{g s}$ seen by $C_{g s}$, thus

$$
R_{g s}=R_{\text {sig }}^{\prime}
$$

For $C_{g d}$, we obtain the circuit in Fig. 10.25(b). This circuit is somewhat complex, and we cannot determine $R_{g d}$ by inspection. Rather, we apply a test current source $I_{x}$ and determine the voltage $V_{x}$ that results across $I_{x}$. We see that

$$
V_{g s}=-I_{x} R_{\text {sig }}^{\prime}
$$

A loop equation gives

$$
V_{d}=V_{x}+V_{g s}
$$



Figure 10.24 Generalized high-frequency equivalent circuit for the CS amplifier.

[^0]
[^0]:    ${ }^{8}$ The method of open-circuit time constants yields good results only when all the poles are real, as is the case in most of this chapter.


Figure 10.25 Application of the open-circuit time-constants method to the CS equivalent circuit of Fig. 10.24.

A node equation at D gives

$$
I_{s}=g_{m} V_{g s}+\frac{V_{d}}{R_{L}^{\prime}}
$$

Thus,

$$
I_{s}=g_{m} V_{g s}+\frac{V_{s}+V_{g s}}{R_{L}^{\prime}}
$$

Substituting for $V_{g s}$ from Eq. (10.84) and manipulating the resulting equation gives

$$
R_{g d} \equiv \frac{V_{s}}{I_{s}}=R_{\mathrm{sig}}^{\prime}\left(1+g_{m} R_{L}^{\prime}\right)+R_{L}^{\prime}
$$

Finally, for $C_{L}$ we obtain the circuit shown in Fig. 10.25(c), from which

$$
R_{C_{L}}=R_{L}^{\prime}
$$

Next, we use the resistance values in Eqs. (10.83), (10.85), and (10.86) to obtain the effective high-frequency time constant $\tau_{H}$,

$$
\begin{aligned}
\tau_{H} & =b_{1}=C_{g s} R_{g s}+C_{g d} R_{g d}+C_{L} R_{C_{L}} \\
& =C_{g s} R_{\mathrm{sig}}^{\prime}+C_{g d}\left[R_{\mathrm{sig}}^{\prime}\left(1+g_{m} R_{L}^{\prime}\right)+R_{L}^{\prime}\right]+C_{L} R_{L}^{\prime}
\end{aligned}
$$
and the 3-dB frequency $f_{H}$ is

$$
f_{H}=\frac{1}{2 \pi \tau_{H}}
$$

An important observation is available from Eq. (10.87), which can be rewritten as

$$
\tau_{H}=\left[C_{g s}+C_{g d}\left(1+g_{m} R_{L}^{\prime}\right)\right] R_{\mathrm{sig}}^{\prime}+\left(C_{g d}+C_{L}\right) R_{L}^{\prime}
$$

We note that the first term is simply $C_{\text {in }} R_{\text {sig }}^{\prime}$, where $C_{\text {in }}$ is dominated by the Miller capacitance $C_{g d}\left(1+g_{m} R_{L}^{\prime}\right)$. The method of open-circuit time constants, however, also provides the second term, which results from the interaction of $\left(C_{g d}+C_{L}\right)$ with $R_{L}^{\prime}$. Thus, while the first term in Eq. (10.88) arises at the input node, the second term occurs at the output node. The second term can be dominant in cases where $R_{\text {sig }}^{\prime}$ is small, as we have seen in Section 10.3.4.

# Example 10.8 

An integrated-circuit CS amplifier has $g_{m}=1.25 \mathrm{~mA} / \mathrm{V}, C_{g s}=20 \mathrm{fF}, C_{g d}=5 \mathrm{fF}, C_{L}=25 \mathrm{fF}, R_{\text {sig }}^{\prime}=10 \mathrm{k} \Omega$, and $R_{L}^{\prime}=10 \mathrm{k} \Omega$. Determine $f_{H}$ and the frequency of the transmission zero $f_{Z}$ caused by $C_{g d}$.

## Solution

To obtain $f_{H}$ we first use Eqs. (10.83), (10.85), and (10.86) to determine the resistances seen by the three capacitors $C_{g s}, C_{g d}$, and $C_{L}$, respectively,

$$
\begin{aligned}
R_{g s} & =R_{\mathrm{sig}}^{\prime}=10 \mathrm{k} \Omega \\
R_{g d} & =R_{\mathrm{sig}}^{\prime}\left(1+g_{m} R_{L}^{\prime}\right)+R_{L}^{\prime} \\
& =10(1+1.25 \times 10)+10=145 \mathrm{k} \Omega \\
R_{C_{L}} & =R_{L}^{\prime}=10 \mathrm{k} \Omega
\end{aligned}
$$

We then determine the three time constants:

$$
\begin{aligned}
\tau_{g s} & =C_{g s} R_{g s}=20 \times 10^{-15} \times 10 \times 10^{3}=200 \mathrm{ps} \\
\tau_{g d} & =C_{g d} R_{g d}=5 \times 10^{-15} \times 145 \times 10^{3}=725 \mathrm{ps} \\
\tau_{C_{L}} & =C_{L} R_{C_{L}}=25 \times 10^{-15} \times 10 \times 10^{3}=250 \mathrm{ps}
\end{aligned}
$$

The effective high-frequency time constant $\tau_{H}$ can now be obtained by summing the three time constants,

$$
\begin{aligned}
\tau_{H} & =\tau_{g s}+\tau_{g d}+\tau_{C_{L}} \\
& =200+725+250=1175 \mathrm{ps}
\end{aligned}
$$

and the 3-dB frequency $f_{H}$ is

$$
f_{H}=\frac{1}{2 \pi \tau_{H}}=\frac{1}{2 \pi \times 1175 \times 10^{-12}}=135.5 \mathrm{MHz}
$$

The frequency of the transmission zero can be determined by reference to the circuit in Fig. 10.24. Since at $s=s_{Z}, V_{o}$ will be zero, a node equation at the output node at $s=s_{Z}$ becomes

$$
s_{Z} C_{g d}\left(V_{g s}-0\right)=g_{m} V_{g s}
$$
Thus

$$
s_{Z}=\frac{g_{m}}{C_{g d}}
$$

and

$$
f_{Z}=\frac{g_{m}}{2 \pi C_{g d}}=\frac{1.25 \times 10^{-3}}{2 \pi \times 5 \times 10^{-15}}=39.8 \mathrm{GHz}
$$

which is much higher than $f_{H}$; hence it plays almost no role in the estimate of $f_{H}$.

# EXERCISES 

10.15 For the CS amplifier in Example 10.8, find the estimate of $f_{H}$ obtained using the Miller effect method of Section 10.3.1. By what percentage does this estimate differ from that obtained in Example 10.8 using the method of open-circuit time constants? Which of the two estimates is more realistic, and why?
Ans. 181.9 MHz ; greater by $34 \%$; the value obtained by the method of open-circuit time constants is more realistic because it includes the effect of $C_{L}$.
10.16 For the CS amplifier in Example 10.8, using the value of $f_{H}$ determined by the method of open-circuit time constants, find the gain-bandwidth product. Recall that $g_{m}=1.25 \mathrm{~mA} / \mathrm{V}$ and $R_{L}^{\prime}=10 \mathrm{k} \Omega$. Ans. GBW $=1.69 \mathrm{GHz}$
10.17 As a way to trade gain for bandwidth, the designer of the CS amplifier in Example 10.8 connects a load resistor at the output that results in halving the value of $R_{L}^{\prime}$. Find the new values of $\left|A_{M}\right|, f_{H}$, and the gain-bandwidth product.
Ans. $6.25 \mathrm{~V} / \mathrm{V} ; 223.4 \mathrm{MHz} ; 1.4 \mathrm{GHz}$
10.18 As another way to trade dc gain for bandwidth, the designer of the CS amplifier in Example 10.8 decides to operate the amplifying transistor at double the value of $V_{O V}$ by increasing the bias current fourfold. Find the new values of $g_{m}, R_{L}^{\prime},\left|A_{M}\right|, f_{H}$, and the gain-bandwidth product. Assume that $R_{L}^{\prime}$ is the parallel equivalent of $r_{o}$ of the amplifying transistor and that of the current-source load.
Ans. $2.5 \mathrm{~mA} / \mathrm{V} ; 2.5 \mathrm{k} \Omega ; 6.25 \mathrm{~V} / \mathrm{V} ; 250 \mathrm{MHz} ; 1.56 \mathrm{GHz}$

We conclude this section by emphasizing that the method of open-circuit time constants reveals to the circuit designer the relative contribution of the various capacitances to the determination of the amplifier bandwidth $f_{H}$. For instance, for the amplifier in Example 10.8, we see that while $C_{g d}$ contributes the most ( 725 ps of 1175 pF , or $62 \%$ ) because of the Miller effect, the contribution of each of $C_{g s}(17 \%)$ and $C_{L}(12 \%)$ is not insignificant. Such information can be useful in the amplifier-design process.
# 10.4.5 Application of the Method of Open-Circuit Time Constants to the CE Amplifier 

The formulas developed for the CS case can be easily adapted to the case of the CE amplifier whose equivalent circuit is shown in Fig. 10.19(b). For the general case of a capacitance $C_{L}$ that appears across the output terminals,

$$
\begin{gathered}
R_{\pi}=R_{\mathrm{sig}}^{\prime} \\
R_{\mu}=R_{\mathrm{sig}}^{\prime}\left(1+g_{m} R_{L}^{\prime}\right)+R_{L}^{\prime} \\
R_{C_{L}}=R_{L}^{\prime}
\end{gathered}
$$

Thus,

$$
\tau_{H}=C_{\pi} R_{\mathrm{sig}}^{\prime}+C_{\mu}\left[R_{\mathrm{sig}}^{\prime}\left(1+g_{m} R_{L}^{\prime}\right)+R_{L}^{\prime}\right]+C_{L} R_{L}^{\prime}
$$

and

$$
f_{H}=\frac{1}{2 \pi \tau_{H}}
$$

Note that expressions for $R_{\text {sig }}^{\prime}$ and $R_{L}^{\prime}$ are given in Fig. 10.19.

## EXERCISE

10.19 Consider a bipolar active-loaded CE amplifier having the load current source implemented with a pnp transistor. Let the circuit be operating at a $1-\mathrm{mA}$ bias current. The transistors are specified as follows: $\beta(n p n)=200, V_{A n}=130 \mathrm{~V},\left|V_{A p}\right|=50 \mathrm{~V}, C_{\pi}=16 \mathrm{pF}, C_{\mu}=0.3 \mathrm{pF}, C_{L}=5 \mathrm{pF}$, and $r_{s}=200 \Omega$. The amplifier is fed with a signal source having a resistance of $36 \mathrm{k} \Omega$. Determine: (a) $A_{M}$; (b) $C_{\mathrm{in}}$ and $f_{H}$ using the Miller effect; (c) $f_{H}$ using open-circuit time constants; (d) $f_{Z}$; and (e) the gain-bandwidth product.
Ans. (a) $-175 \mathrm{~V} / \mathrm{V}$; (b) $450 \mathrm{pF}, 80.6 \mathrm{kHz}$; (c) 73.5 kHz ; (d) 21.2 GHz ; (e) 12.9 MHz

### 10.5 High-Frequency Response of the Common-Gate and Cascode Amplifiers

Although common-source and common-emitter amplifiers provide substantial gain at midband frequencies, their gain falls off in the high-frequency band at a relatively low frequency. This is primarily due to the large input capacitance $C_{\text {in }}$, whose value is significantly increased by the Miller component. The latter is large because of the Miller multiplication effect, which the bridging capacitance $C_{g d}$ (or $C_{\mu}$ ) experiences. It follows that the key to obtaining wideband operation, that is, high $f_{H}$, is to use circuit configurations that do not suffer from the Miller effect. One such configuration is the common-gate circuit.

### 10.5.1 High-Frequency Response of the CG Amplifier

Figure 10.26(a) shows the CG amplifier with the MOSFET internal capacitances $C_{g s}$ and $C_{g d}$ pulled out of the model and indicated. For generality, a capacitance $C_{L}$ is included at the
output node to represent the combination of the output capacitance of a current-source load and the input capacitance of a succeeding amplifier stage. Capacitance $C_{L}$ also includes the MOSFET capacitance $C_{d b}$. Note the $C_{L}$ appears in effect in parallel with $C_{g d}$; therefore, in the following analysis we will lump the two capacitances together.

It is important to note at the outset that each of the three capacitances in the circuit of Fig. 10.26(a) has a grounded node. Therefore none of the capacitances undergoes the Miller multiplication effect observed in the CS stage. It follows that the CG circuit can be designed to have a much wider bandwidth than that of the CS circuit, especially when the resistance of the signal generator is large. To analyze the high-frequency response of the CG amplifier of Fig. 10.26(a), we replace the MOSFET with its T model. The resulting circuit, with $C_{g d}$ lumped with $C_{L}$, is shown in Fig. 10.26(b).

We shall consider first the case of a discrete-circuit CG amplifier in which $r_{o}$ can be neglected. Eliminating $r_{o}$ results in the circuit in Fig. 10.26(c). We immediately observe that there are two poles: one at the input side with a frequency $f_{P 1}$,

$$
f_{P 1}=\frac{1}{2 \pi C_{g s}\left(R_{\mathrm{sig}} \| \frac{1}{g_{m}}\right)}
$$

and the other at the output side with a frequency $f_{P 2}$,

$$
f_{P 2}=\frac{1}{2 \pi\left(C_{\mathrm{gd}}+C_{L}\right) R_{L}}
$$

The relative locations of the two poles will depend on the specific situation. However, $f_{P 2}$ is usually lower than $f_{P 1}$; thus $f_{P 2}$ can be dominant. The important point to note is that both $f_{P 1}$ and $f_{P 2}$ are usually much higher than the frequency of the dominant input pole in the CS stage. An approximate value for $f_{H}$ can be obtained by applying the method of open-circuit time constants to the circuit of Fig. 10.26(c), resulting in

$$
\tau_{g s}=C_{g s}\left(R_{\mathrm{sig}} \| \frac{1}{g_{m}}\right)=1 / 2 \pi f_{P 2}
$$

and

$$
\tau_{g d}=\left(C_{L}+C_{g d}\right) R_{L}=1 / 2 \pi f_{P 1}
$$

Thus,

$$
\tau_{H}=C_{g s}\left(R_{\mathrm{sig}} \| \frac{1}{g_{m}}\right)+\left(C_{L}+C_{g d}\right) R_{L}
$$

and

$$
f_{H}=\frac{1}{2 \pi \tau_{H}}=1 /\left(\frac{1}{f_{P 1}}+\frac{1}{f_{P 2}}\right)
$$

In IC amplifiers, $r_{o}$ has to be taken into account. Applying the method of open-circuit time constants to the equivalent circuit in Fig. 10.26(b), we obtain the circuit in Fig. 10.26(d) for determining $R_{g s}$. From this circuit we find that

$$
R_{g s}=R_{\mathrm{sig}} \| R_{\mathrm{in}}
$$

where $R_{\text {in }}$ is the input resistance of the CG amplifier with a load resistance $R_{L}$. An expression for $R_{\text {in }}$ was derived in Chapter 8 and given in Eq. (8.53),

$$
R_{\mathrm{in}}=\frac{r_{o}+R_{L}}{1+g_{m} r_{o}} \simeq \frac{r_{o}+R_{L}}{g_{m} r_{o}}
$$
The resistance $R_{g d}$ seen by $\left(C_{L}+C_{g d}\right)$ can be obtained from the circuit in Fig. 10.26(e),

$$
R_{g d}=R_{L} \| R_{o}
$$


(a)

(b)

(c)

Figure 10.26 (a) The common-gate amplifier with the transistor internal capacitances shown. A load capacitance $C_{L}$ is also included. (b) Equivalent circuit of the CG amplifier with the MOSFET replaced with its T model. (c) Equivalent circuit for the case in which $r_{o}$ is neglected. (d) Circuit for determining the resistance $R_{g s}$ seen by $C_{g s}$. (e) Circuit for determining the resistance $R_{g d}$ seen by $\left(C_{L}+C_{g d}\right)$.


Figure 10.26 continued
where $R_{o}$ is the output resistance of a CG amplifier with a resistance $R_{\text {sig }}$ connected between source and ground. From Chapter 8, Eq. (8.56), we have

$$
R_{o}=r_{o}+R_{\mathrm{sig}}+g_{m} r_{o} R_{\mathrm{sig}}
$$

Finally,

$$
\tau_{H}=\tau_{g s}+\tau_{g d}
$$

and

$$
f_{H}=\frac{1}{2 \pi \tau_{H}}
$$# Example 10.9 

Consider a common-gate amplifier with $g_{m}=1.25 \mathrm{~mA} / \mathrm{V}, r_{o}=20 \mathrm{k} \Omega, C_{g s}=20 \mathrm{fF}, C_{g d}=5 \mathrm{fF}, C_{L}=25 \mathrm{fF}$, $R_{\text {sig }}=10 \mathrm{k} \Omega$, and $R_{L}=20 \mathrm{k} \Omega$. Assume that $C_{L}$ includes $C_{d b}$. Determine the input resistance, the midband gain, and the upper 3-dB frequency $f_{H}$.

## Solution

Figure 10.27 shows the CG amplifier circuit at midband frequencies. We note that

$$
\begin{aligned}
v_{o} & =i R_{L} \\
v_{\text {sig }} & =i\left(R_{\text {sig }}+R_{\mathrm{m}}\right)
\end{aligned}
$$

Thus, the overall voltage gain is given by

$$
G_{o}=\frac{v_{o}}{v_{\text {sig }}}=\frac{R_{L}}{R_{\text {sig }}+R_{\mathrm{m}}}
$$



Figure 10.27 The CG amplifier circuit at midband.
The value of $R_{\mathrm{m}}$ is found from Eq. (10.101) as

$$
\begin{aligned}
R_{\mathrm{m}} & =\frac{r_{o}+R_{L}}{1+g_{m} r_{o}} \\
& =\frac{20+20}{1+(1.25 \times 20)}=1.54 \mathrm{k} \Omega
\end{aligned}
$$
Thus, $G_{o}$ can now be determined as

$$
G_{o}=\frac{20}{10+1.54}=1.73 \mathrm{~V} / \mathrm{V}
$$

Observe that as expected $G_{o}$ is very low. This is due to the fact that the CG amplifier draws a large input current, equal, in fact, to the load current $i$.

To obtain an estimate of the 3-dB frequency $f_{H}$, we first determine $R_{g s}$ and $R_{g d}$ using Eqs. (10.100) and (10.102),

$$
\begin{aligned}
R_{g s} & =R_{\text {sig }}\left\|R_{i n}=10\right\| 1.54=1.33 \mathrm{k} \Omega \\
R_{g d} & =R_{L} \| R_{o}
\end{aligned}
$$

where $R_{o}$ is given by Eq. (10.103),

$$
\begin{aligned}
R_{o} & =r_{o}+R_{\text {sig }}+\left(g_{i n} r_{o}\right) R_{\text {sig }} \\
& =20+10+25 \times 10=280 \mathrm{k} \Omega
\end{aligned}
$$

Thus,

$$
R_{g d}=20 \| 280=18.7 \mathrm{k} \Omega
$$

Now we can compute the sum of the open-circuit time constants, $\tau_{H}$,

$$
\begin{aligned}
\tau_{H} & =C_{g s} R_{g s}+\left(C_{g d}+C_{L}\right) R_{g d} \\
\tau_{H} & =20 \times 10^{-15} \times 1.33 \times 10^{7}+(5+25) \times 10^{-15} \times 18.7 \times 10^{3} \\
& =26.6 \times 10^{-12}+561 \times 10^{-12} \\
& =587.6 \mathrm{ps}
\end{aligned}
$$

and the upper 3-dB frequency $f_{H}$ can be obtained as

$$
f_{H}=\frac{1}{2 \pi \tau_{H}}=\frac{1}{2 \pi \times 587.6 \times 10^{-12}}=270.9 \mathrm{MHz}
$$

Observe that $f_{H}$ is indeed much higher than (about twice) the corresponding value for the CS amplifier found in Example 10.8. Another important observation can be made by examining the two components of $\tau_{H}$ : The contribution of the input circuit is 26.6 ps , while that of the output circuit is 561 ps ; thus the limitation on the high-frequency response is posed by the output circuit.

# EXERCISE 

10.20 In order to raise the midband gain of the CG amplifier in Example 10.9, the circuit designer decides to use a cascode current source for the load device, thus raising $R_{L}$ by a factor of $g_{i n} r_{o}=25$; that is, $R_{L}$ becomes $500 \mathrm{k} \Omega$. Find $R_{i n}$, the midband gain, and $f_{H}$. Comment on the results.
Ans. $20 \mathrm{k} \Omega ; 16.7 \mathrm{~V} / \mathrm{V} ; 28.8 \mathrm{MHz}$. While the midband gain has been increased substantially (by a factor of 9.7), the bandwidth $f_{H}$ has been substantially lowered (by a factor of about 9.4). Thus, the high-frequency advantage of the CG amplifier is completely lost!
We conclude this section by noting that a properly designed CG circuit can have a wide bandwidth. However, the input resistance will be low and the overall midband gain can be very low. It follows that the CG circuit alone will not do the job! However, combining the CG with the CS amplifier in the cascode configuration can result in a circuit having the high input resistance and gain of the CS amplifier together with the wide bandwidth of the CG amplifier, as we shall now see.

# 10.5.2 High-Frequency Response of the MOS Cascode Amplifier 

In Section 8.5 we studied the cascode amplifier and analyzed its performance at midband frequencies. There we learned that by combining the CS and CG configurations, the cascode amplifier exhibits a very high input resistance and a voltage gain that can be as high as $A_{0}^{2}$, where $A_{0}=g_{m} r_{o}$ is the intrinsic gain of the MOSFET. For our purposes here, we shall see that the versatility of the cascode circuit allows us to trade off some of this high midband gain in return for a wider bandwidth.

Figure 10.28 shows the cascode amplifier with all transistor internal capacitances indicated. Also included is a capacitance $C_{L}$ at the output node to represent the combination of $C_{d b 2}$, the output capacitance of a current-source load, and the input capacitance of a succeeding amplifier stage (if any). Note that $C_{d b 1}$ and $C_{g s 2}$ appear in parallel, and we shall combine them in the following analysis. Similarly, $C_{L}$ and $C_{g d 2}$ appear in parallel and will be combined.

The easiest and, in fact, quite insightful approach to determining the 3-dB frequency $f_{H}$ is to employ the open-circuit time-constants method:

1. Capacitance $C_{g s 1}$ sees a resistance $R_{\text {sig }}$.
2. Capacitance $C_{g d 1}$ is the gate-to-drain capacitance of the CS amplifier $Q_{1}$; thus it sees a resistance $R_{g d 1}$, which can be obtained by adapting the formula in Eq. (10.85),

$$
R_{g d 1}=\left(1+g_{m 1} R_{d 1}\right) R_{\mathrm{sig}}+R_{d 1}
$$

where $R_{d 1}$, the total resistance at $D_{1}$, is given by the parallel equivalent of the resistance looking into the drain of $Q_{1}\left(r_{o 1}\right)$ and the resistance looking into the source of $Q_{2}\left(R_{\text {in2 }}\right)$,


Figure 10.28 The cascode circuit with the various transistor capacitances indicated.
thus

$$
R_{d 1}=r_{o 1}\left\|R_{\mathrm{in} 2}=r_{o 1}\right\| \frac{r_{o 2}+R_{L}}{g_{m 2} r_{o 2}}
$$

3. Capacitance $\left(C_{d b 1}+C_{g s 2}\right)$ sees a resistance $R_{d 1}$.
4. Capacitance $\left(C_{L}+C_{g d 2}\right)$ sees a resistance $\left(R_{L} \| R_{o}\right)$ where $R_{o}$, the output resistance of the cascode amplifier, is given by

$$
R_{o}=r_{o 2}+r_{o 1}+\left(g_{m 2} r_{o 2}\right) r_{o 1}
$$

With the resistances determined, the effective time constant $\tau_{H}$ can be computed as

$$
\begin{aligned}
\tau_{H}= & C_{g s 1} R_{\mathrm{sig}}+C_{g d 1}\left[\left(1+g_{m 1} R_{d 1}\right) R_{\mathrm{sig}}+R_{d 1}\right] \\
& +\left(C_{d b 1}+C_{g s 2}\right) R_{d 1}+\left(C_{L}+C_{g d 2}\right)\left(R_{L} \| R_{o}\right)
\end{aligned}
$$

and the 3-dB frequency $f_{H}$ as

$$
f_{H} \simeq \frac{1}{2 \pi \tau_{H}}
$$

Design Insight and Trade-Offs To gain insight regarding what limits the high-frequency gain of the MOS cascode amplifier, we rewrite Eq. (10.108) in the form

$$
\begin{aligned}
\tau_{H}= & R_{\mathrm{sig}}\left[C_{g s 1}+C_{g d 1}\left(1+g_{m 1} R_{d 1}\right)\right]+R_{d 1}\left(C_{g d 1}+C_{d b 1}+C_{g s 2}\right) \\
& +\left(R_{L} \| R_{o}\right)\left(C_{L}+C_{g d 2}\right)
\end{aligned}
$$

Here we note that the first term arises at the input node, the second term at the middle node, namely $\left(D_{1}, S_{2}\right)$, and the third term at the output node. The first term is simply due to the interaction of the signal-source resistance $R_{\text {sig }}$ and the input capacitance of $Q_{1}$, which, as expected, includes the Miller capacitance $C_{g d 1}\left(1+g_{m 1} R_{d 1}\right)$.

In the case of a large $R_{\text {sig }}$, the first term can dominate, especially if the Miller multiplier $\left(1+g_{m 1} R_{d 1}\right)$ is large. This in turn happens when the load resistance $R_{L}$ is large (on the order of $A_{0} r_{o}$ ), causing $R_{\text {in } 2}$ and hence $R_{d 1}$ to be large and requiring the first stage, $Q_{1}$, to provide a large proportion of the gain (see Section 8.5.3). It follows that when $R_{\text {sig }}$ is large, to extend the bandwidth we have to lower $R_{L}$ to the order of $r_{o}$. This in turn lowers $R_{\text {in } 2}$ and hence $R_{d 1}$ and renders the Miller effect in $Q_{1}$ insignificant. Note, however, that the dc gain of the cascode will then be $A_{0}$. Thus, while the dc gain will be the same as (or a little higher than) that achieved in a CS amplifier, the bandwidth will be greater.

In the case when $R_{\text {sig }}$ is small, the Miller effect in $Q_{1}$ will not be of concern. A large value of $R_{L}$ (on the order of $A_{0} r_{o}$ ) can then be used to realize the large dc gain possible with a cascode amplifier-that is, a dc gain on the order of $A_{0}^{2}$. Equation (10.109) indicates that in this case the third term will usually be dominant. To pursue this point a little further, consider the case $R_{\text {sig }}=0$, and assume that the middle term is much smaller than the third term. It follows that

$$
\tau_{H} \simeq\left(C_{L}+C_{g d 2}\right)\left(R_{L} \| R_{o}\right)
$$

and the 3-dB frequency becomes

$$
f_{H}=\frac{1}{2 \pi\left(C_{L}+C_{g d 2}\right)\left(R_{L} \| R_{o}\right)}
$$
which is of the same form as the formula for the CS amplifier with $R_{\text {sig }}=0$ (Eq. 10.67). Here, however, $\left(R_{L} \| R_{o}\right)$ is larger that $R_{L}^{\prime}$ by a factor of about $A_{0}$. Thus the $f_{H}$ of the cascode will be lower than that of the CS amplifier by the same factor $A_{0}$. Figure 10.29 shows a sketch of the frequency response of the cascode and of the corresponding common-source amplifier. We observe that in this case, cascoding increases the dc gain by a factor $A_{0}$ while keeping the unity-gain frequency unchanged at

$$
f_{t} \simeq \frac{1}{2 \pi} \frac{g_{m}}{C_{L}+C_{g d 2}}
$$

|  | Common Source | Cascode |
| :--: | :--: | :--: |
| Circuit |  |  |
| DC Gain | $-g_{m} R_{L}^{\prime}$ | $-A_{0} g_{m} R_{L}^{\prime}$ |
| $f_{\text {MB }}$ | $\frac{1}{2 \pi\left(C_{L}+C_{g d}\right) R_{L}^{\prime}}$ | $\frac{1}{2 \pi\left(C_{L}+C_{g d}\right) A_{0} R_{L}^{\prime}}$ |
| $f_{t}$ | $\frac{g_{m}}{2 \pi\left(C_{L}+C_{g d}\right)}$ | $\frac{g_{m}}{2 \pi\left(C_{L}+C_{g d}\right)}$ |



Figure 10.29 Effect of cascoding on gain and bandwidth in the case $R_{\text {sig }}=0$. Cascoding can increase the dc gain by the factor $A_{0}$ while keeping the unity-gain frequency constant. Note that to achieve the high gain, the load resistance must be increased by the factor $A_{0}$.
# Example 10.10 

This example illustrates the advantages of cascoding by comparing the performance of a cascode amplifier with that of a common-source amplifier in two cases:
(a) The resistance of the signal source is significant, $R_{\text {sig }}=10 \mathrm{k} \Omega$.
(b) $R_{\text {sig }}$ is negligibly small.

Assume all MOSFETs have $g_{m}=1.25 \mathrm{~mA} / \mathrm{V}, r_{o}=20 \mathrm{k} \Omega, C_{g s}=20 \mathrm{fF}, C_{g d}=5 \mathrm{fF}, C_{d b}=5 \mathrm{fF}$, and $C_{L}$ (excluding $C_{d b}$ ) $=10 \mathrm{fF}$. For case (a), let $R_{L}=r_{o}=20 \mathrm{k} \Omega$ for both amplifiers. For case (b), let $R_{L}=r_{o}=20 \mathrm{k} \Omega$ for the CS amplifier and $R_{L}=R_{o}$ for the cascode amplifier. For all cases, determine $A_{v}$, $f_{H}$, and $f_{t}$.

## Solution

(a) For the CS amplifier:

$$
\begin{aligned}
A_{0} & =g_{m} r_{o}=1.25 \times 20=25 \mathrm{~V} / \mathrm{V} \\
A_{v} & =-g_{m}\left(R_{L} \| r_{o}\right)=-g_{m}\left(r_{o} \| r_{o}\right) \\
& =-\frac{1}{2} A_{0}=-12.5 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

To obtain $\tau_{H}$ we use Eq. (10.87) and note that $R_{\text {sig }}=R_{\text {sig }}$ and that here $C_{L}$ does not include $C_{d b}$, thus

$$
\tau_{H}=C_{g s} R_{\text {sig }}+C_{g d}\left[\left(1+g_{m} R_{L}^{\prime}\right) R_{\text {sig }}+R_{L}^{\prime}\right]+\left(C_{L}+C_{d b}\right) R_{L}^{\prime}
$$

where

$$
\begin{aligned}
R_{L}^{\prime} & =r_{o}\left\|R_{L}=r_{o}\right\| r_{o}=10 \mathrm{k} \Omega \\
\tau_{H} & =20 \times 10+5[(1+12.5) 10+10]+(10+5) 10 \\
& =200+725+150=1075 \mathrm{ps}
\end{aligned}
$$

Thus,

$$
\begin{aligned}
& f_{H}=\frac{1}{2 \pi \times 1075 \times 10^{-12}}=148 \mathrm{MHz} \\
& f_{t}=\left|A_{v}\right| f_{H}=12.5 \times 148=1.85 \mathrm{GHz}
\end{aligned}
$$

For the cascode amplifier:

$$
\begin{aligned}
R_{o} & =2 r_{o}+\left(g_{m} r_{o}\right) r_{o}=(2 \times 20)+(25 \times 20)=540 \mathrm{k} \Omega \\
A_{v} & =-g_{m}\left(R_{o} \| R_{L}\right) \\
& =-1.25(540\|20)=-24.1 \mathrm{~V} / \mathrm{V} \\
R_{\mathrm{m} 2} & =\frac{r_{o}+R_{L}}{g_{m} r_{o}}=\frac{r_{o}+r_{o}}{g_{m} r_{o}}=\frac{2}{g_{m}}=\frac{2}{1.25}=1.6 \mathrm{k} \Omega \\
R_{d 1} & =r_{o}\left\|R_{\mathrm{m} 2}=20\right\| 1.6=1.48 \mathrm{k} \Omega
\end{aligned}
$$
# Example 10.10 continued 

Using Eq. (10.109),

$$
\begin{aligned}
\tau_{H}= & R_{s i g}\left[C_{g s 1}+C_{g d 1}\left(1+g_{m 1} R_{d 1}\right)\right] \\
& +R_{d 1}\left(C_{g d 1}+C_{d b 1}+C_{g s 2}\right) \\
& +\left(R_{L} \| R_{o}\right)\left(C_{L}+C_{d b 2}+C_{g d 2}\right) \\
= & 10[20+5(1+1.25 \times 1.48)] \\
& +1.48(5+5+20) \\
& +(20 \| 540)(10+5+5) \\
= & 342.5+44.4+385.7 \\
= & 772.6 \mathrm{ps} \\
f_{H}= & \frac{1}{2 \pi \times 772.6 \times 10^{-12}}=206 \mathrm{MHz} \\
f_{t}= & 24.1 \times 206=4.96 \mathrm{GHz}
\end{aligned}
$$

Thus cascoding has increased both the dc gain and the 3-dB frequency, with the combined effect being an increase of $f_{t}$ by a factor of 2.7 .
(b) For the CS amplifier:

$$
\begin{aligned}
A_{o} & =-12.5 \mathrm{~V} / \mathrm{V} \\
\tau_{H} & =\left(C_{g d}+C_{L}+C_{d b}\right) R_{L}^{\prime} \\
& =(5+10+5) 10=200 \mathrm{ps} \\
f_{H} & =\frac{1}{2 \pi \times 200 \times 10^{-12}}=796 \mathrm{MHz} \\
f_{t} & =12.5 \times 796=9.95 \mathrm{GHz}
\end{aligned}
$$

For the cascode amplifier:

$$
\begin{aligned}
R_{L} & =R_{o}=540 \mathrm{k} \Omega \\
A_{o} & =-g_{m}\left(R_{o} \| R_{L}\right) \\
& =-1.25(540\|540)=-337.5 \mathrm{~V} / \mathrm{V} \\
R_{\mathrm{in} 2} & =\frac{r_{o}+R_{L}}{g_{m} r_{o}}=\frac{20+540}{1.25 \times 20}=22.4 \mathrm{k} \Omega \\
R_{d 1} & =r_{o 1}\left\|R_{\mathrm{in} 2}=20\right\| 22.4=10.6 \mathrm{k} \Omega
\end{aligned}
$$
$$
\begin{aligned}
\tau_{H} & =R_{d 1}\left(C_{g d 1}+C_{d b 1}+C_{g d 2}\right)+\left(R_{L} \| R_{o}\right)\left(C_{L}+C_{g d 2}+C_{d b 2}\right) \\
& =10.6(5+5+20)+(540\|540)(10+5+5) \\
& =318+5400=5718 \mathrm{ps} \\
f_{H} & =\frac{1}{2 \pi \times 5718 \times 10^{-12}}=27.8 \mathrm{MHz} \\
f_{t} & =337.5 \times 27.8=9.39 \mathrm{GHz}
\end{aligned}
$$

Thus cascoding increases the dc gain from $12.5 \mathrm{~V} / \mathrm{V}$ to $337.5 \mathrm{~V} / \mathrm{V}$. This increase has been obtained at the cost of a decrease in $f_{H}$ by approximately the same factor, resulting in the unity-gain frequency (which, in this case, is equal to the gain-bandwidth product) remaining nearly constant.

# EXERCISE 

10.21 In this exercise we wish to contrast the gain and bandwidth of a CS amplifier and a cascode amplifier. Assume that both are fed with a large source resistance $R_{\text {sig }}$ that effectively determines the high-frequency response. Thus, neglect components of $\tau_{H}$ that do not include $R_{\text {sig }}$. Also assume that all transistors are operated at the same conditions and thus corresponding small-signal parameters are equal. Also, both amplifiers have equal $R_{L}=r_{o}$, and $g_{m} r_{o}=40$.
(a) Find the ratio of the low-frequency gain of the cascode amplifier to that of the CS amplifier.
(b) For the case of $C_{g d}=0.25 C_{g s}$, find the ratio of $f_{H}$ of the cascode to that of the CS amplifier.
(c) Use (a) and (b) to find the ratio of $f_{t}$ of the cascode to that of the CS.

Ans. $2 ; 3.6 ; 7.2$

Conclusion The MOS cascode amplifier is a versatile circuit that, depending on the application at hand, can be designed to provide either higher dc gain, larger bandwidth, or a combination of both, than the CS amplifier.

### 10.5.3 High-Frequency Response of the Bipolar Cascode Amplifier

The analysis method studied in the previous section can be directly applied to the BJT cascode amplifier. Figure 10.30 presents the circuits and the formulas for determining the high-frequency response of the bipolar cascode. Note that some of these formulas rely on the study of the bipolar cascode in Section 8.5.6.


Figure 10.30 Determining the frequency response of the BJT cascode amplifier. Note that in addition to the BJT capacitances $C_{\alpha}$ and $C_{\rho}$, the capacitance between the collector and the substrate $C_{c s}$ for each transistor are included.

# EXERCISE 

10.22 The objective of this exercise is to evaluate the effect of cascoding on the performance of the CE amplifier of Exercise 10.19. The specifications are as follows: $I=1 \mathrm{~mA}, \beta=200, r_{o}=130 \mathrm{k} \Omega$, $C_{\pi}=16 \mathrm{pF}, C_{\mu}=0.3 \mathrm{pF}, r_{s}=200 \Omega, C_{c s 1}=C_{c s 2}=0, C_{L}=5 \mathrm{pF}, R_{\text {sig }}=36 \mathrm{k} \Omega, R_{L}=50 \mathrm{k} \Omega$. Find $R_{m}, A_{0}, R_{\mathrm{ct}}, R_{\mathrm{m} 2}, R_{\mathrm{c}}, A_{M}, f_{H}$, and $f_{r}$. Compare $A_{M}, f_{H}$, and $f_{t}$ with the corresponding values obtained in Exercise 10.19 for the CE amplifier. What should $C_{L}$ be reduced to in order to have $f_{H}=1 \mathrm{MHz}$ ? Ans. $5.2 \mathrm{k} \Omega ; 5200 \mathrm{~V} / \mathrm{V} ; 130 \mathrm{k} \Omega ; 35 \Omega ; 26 \mathrm{M} \Omega ;-242 \mathrm{~V} / \mathrm{V} ; 470 \mathrm{kHz} ; 113.8 \mathrm{MHz} .\left|A_{M}\right|$ has increased from 175 V/V to $248 \mathrm{~V} / \mathrm{V} ; f_{H}$ has increased from 73.5 kHz to $470 \mathrm{kHz} ; f_{t}$ has increased from 12.9 MHz to 113.8 MHz . $C_{L}$ must be reduced to 1.6 pF .

## 10.6 High-Frequency Response of the Source and Emitter Followers

In this section, we study the high-frequency response of two important circuit building blocks: the source follower and the emitter follower. Both have a midband voltage gain that is less than but close to unity. Their advantage lies in their high input resistance and low output resistance. Thus, they find application as the output stage of a multistage amplifier and as a voltage buffer. As will be seen shortly, these voltage followers have another important advantage, namely, a wide bandwidth.

Analysis of the high-frequency response of the source and emitter followers is somewhat involved. This is because the follower has two high-frequency poles that can be close to each
other on the negative real axis of the $s$ plane. Furthermore, in many cases, the poles can become complex. As a result, the method of open-circuit time constants cannot be used to determine $f_{H}$ of the followers except in special circumstances. Our approach, therefore, will be to analyze the follower circuit to determine its gain $V_{o} / V_{\text {sig }}$ as a function of frequency and then use it to determine $f_{H}$. Although the analysis is somewhat lengthy, the results can be applied easily. In the following we shall do the analysis of the source follower in detail. Then, because of similarity, the results for the emitter follower will be given without proof.

# 10.6.1 The Source-Follower Case 

Figure 10.31(a) shows a source follower without the biasing arrangement. The follower is driven by a signal source ( $V_{\text {sig }}, R_{\text {sig }}$ ) and is loaded with a resistance $R_{L}$ and, for generality, a capacitance $C_{L}$. Replacing the MOSFET with its hybrid- $\pi$ equivalent-circuit model results in the equivalent circuit shown in Fig. 10.31(b). Here, we have included the body-effect generator $g_{m b} V_{b s}$ because it plays an important role in determining the source-follower gain. Also, we are assuming that whatever capacitances exist between the MOSFET source and ground, such as $C_{s b}$ of Fig. 10.12(a), have been lumped into $C_{L}$.

Noting that the drain terminal is grounded, we see that $C_{g d}$ in fact appears across the input terminals of the source follower. Also, $r_{o}$ is in parallel with $R_{L}$ and can be combined with it. Finally, we observe that since the body terminal B is connected to ground, the voltage $V_{b s}$ appears across the controlled source $g_{m b} V_{b s}$. Thus we can utilize the source-absorption theorem (see Appendix D) to replace the controlled source with a resistance $1 / g_{m b}$. Since the latter appears between source and ground, it is in parallel with $R_{L}$ and can be combined with it.

Utilizing the above observations, we obtain the simplified equivalent circuit shown in Fig. 10.31(c) where

$$
R_{L}^{\prime}=R_{L}\left\|r_{o}\right\| \frac{1}{g_{m b}}
$$

Obtaining the Transfer Function $V_{o}(s) / V_{\text {sig }}(s)$ Analysis of the equivalent circuit in Fig. 10.31(c) to determine the transfer function $V_{o}(s) / V_{\text {sig }}(s)$ proceeds as follows.

1. A loop equation at the input yields

$$
V_{\mathrm{sig}}=I_{i} R_{\mathrm{sig}}+V_{g}
$$

where $V_{g}$ can be expressed as

$$
V_{g}=V_{g s}+V_{o}
$$

Thus,

$$
V_{\text {sig }}=I_{i} R_{\text {sig }}+V_{g s}+V_{o}
$$

2. A node equation at G provides

$$
\begin{aligned}
I_{i} & =s C_{g d} V_{g}+s C_{g s} V_{g s} \\
& =s C_{g d}\left(V_{g s}+V_{o}\right)+s C_{g s} V_{g s}
\end{aligned}
$$

which can be substituted into Eq. (10.114) to obtain

$$
V_{\text {sig }}=\left[1+s\left(C_{g s}+C_{g d}\right) R_{\text {sig }}\right] V_{g s}+\left[1+s C_{g d} R_{\text {sig }}\right] V_{o}
$$

Figure 10.31 (a) A directly coupled source follower without the bias detail; (b) high-frequency equivalent circuit of the source follower; (c) a simplified version of the equivalent circuit.
3. A node equation at $S$ gives

$$
\left(g_{m}+s C_{g s}\right) V_{g s}=\left(\frac{1}{R_{L}^{\prime}}+s C_{L}\right) V_{o}
$$

which can be used to express $V_{g s}$ in terms of $V_{o}$ as

$$
V_{g s}=\frac{1}{g_{m} R_{L}^{\prime}} \frac{1+s C_{L} R_{L}^{\prime}}{1+s\left(C_{g s} / g_{m}\right)} V_{o}
$$

Substituting this expression of $V_{g s}$ into Eq. (10.115) results in an equation containing only $V_{o}$ and $V_{\text {sig }}$; this equation can be manipulated to obtain the source-follower transfer function in the form

$$
\frac{V_{o}}{V_{\text {sig }}}(s)=A_{M} \frac{1+\left(\frac{s}{\omega_{Z}}\right)}{1+b_{1} s^{2}+b_{2} s^{2}}
$$

where

$$
\begin{gathered}
A_{M}=\frac{R_{L}^{\prime}}{R_{L}^{\prime}+\frac{1}{g_{m}}}=\frac{g_{m} R_{L}^{\prime}}{g_{m} R_{L}^{\prime}+1} \\
\omega_{Z}=g_{m} / C_{g s} \\
b_{1}=\left(C_{g d}+\frac{C_{g s}}{g_{m} R_{L}^{\prime}+1}\right) R_{\text {sig }}+\left(\frac{C_{g s}+C_{L}}{g_{m} R_{L}^{\prime}+1}\right) R_{L}^{\prime} \\
b_{2}=\frac{\left(C_{g s}+C_{g d}\right) C_{L}+C_{g s} C_{g d}}{g_{m} R_{L}^{\prime}+1} R_{\text {sig }} R_{L}^{\prime}
\end{gathered}
$$

Analysis of the Source-Follower Transfer Function We now make a number of observations on the transfer function in Eq. (10.117), which describes the gain of the source follower at high frequencies:

1. Since the source follower in Fig. 10.31(a) is directly coupled, the gain at dc is equal to $A_{M}$. This correlates with Eq. (10.117) as

$$
A_{M}=\left.V_{o} / V_{\text {sig }}\right|_{s=0}
$$

2. Although the equivalent circuit of Fig. 10.31(c) has three capacitors, the transfer function is of second order. This is because the three capacitors form a continuous loop.
3. The two transmission zeros can be found from Eq. (10.117) as the values of $s$ for which $V_{o} / V_{\text {sig }}=0$. From Eq. (10.117), we see that $V_{o} / V_{\text {sig }}$ approaches 0 as $s$ approaches $\infty$. Thus one transmission zero is at $s=\infty$. Physically, this zero is a result of $C_{g d}$, which appears across the input terminals, becoming a short circuit at infinite frequency and thus making $V_{o}=0$. From the numerator of Eq. (10.117) we see that the other transmission zero is at $s=-\omega_{Z}$ where $\omega_{Z}$ is given by Eq. (10.119). We note that $\omega_{Z}$ is slightly higher than the unity-gain frequency $\omega_{T}$ of the MOSFET [Eq. (10.29)],

$$
\omega_{T}=\frac{g_{m}}{C_{g s}+C_{g d}}
$$
Thus the finite transmission zero is at such a high frequency that its effect on the frequency response of the follower is negligibly small.
4. The two poles of the source follower can be found as the roots of the denominator polynomial $\left(1+b_{1} s+b_{2} s^{2}\right)$. If the poles are real, their frequencies, say $\omega_{P 1}$ and $\omega_{P 2}$, can be found from

$$
1+b_{1} s+b_{2} s^{2}=\left(1+\frac{s}{\omega_{P 1}}\right)\left(1+\frac{s}{\omega_{P 2}}\right)
$$

Now if $\omega_{P 2} \gg \omega_{P 1}$ (at least four times larger), a dominant pole exists with frequency $\omega_{P 1}$ and the 3-dB frequency $f_{H}$ is given by

$$
f_{H} \simeq f_{P 1} \simeq \frac{1}{2 \pi b_{1}}
$$

Here we remind the reader that $b_{1}$ is also $\tau_{H}$, the effective high-frequency time constant evaluated in the method of open-circuit time constants.
5. If the poles are real but none is dominant, the 3-dB frequency can be determined analytically from the transfer function as the frequency at which $\left|V_{o} / V_{\text {sig }}\right|=A_{M} / \sqrt{2}$. An approximate value can be obtained using the formula in Eq. (10.77),

$$
f_{H} \simeq 1 / \sqrt{\frac{1}{f_{P 1}^{2}}+\frac{1}{f_{P 2}^{2}}-\frac{2}{f_{Z}^{2}}}
$$

6. If the poles are complex, they are best described in terms of their frequency $\omega_{0}$ and $Q$-factor, where

$$
1+b_{1} s+b_{2} s^{2}=1+\frac{1}{Q} \frac{s}{\omega_{0}}+\frac{s^{2}}{\omega_{0}^{2}}
$$

and for complex poles, $Q>0.5$. Figure 10.32(a) provides a geometrical interpretation of $\omega_{0}$ and $Q$. From the study of second-order network responses in Chapter 17, it will be seen that the response of the source follower shows no peaking for $Q \leq 0.707$. The boundary case corresponding to $Q=0.707$ (poles at $45^{\circ}$ angles) results in what is known as a maximally flat response for which $f_{\text {sdh }}=f_{0}$. Figure 10.32(b) shows a number of possible responses obtained for various values of $Q$. In terms of the component values of the source follower,

$$
\begin{gathered}
\omega_{0}=\frac{1}{\sqrt{b_{2}}}=\sqrt{\frac{g_{m} R_{L}^{\prime}+1}{R_{\text {sig }} R_{L}^{\prime}\left[\left(C_{g s}+C_{g d}\right) C_{L}+C_{g s} C_{g d}\right]}} \\
Q=\frac{\sqrt{b_{2}}}{b_{1}}=\frac{\sqrt{g_{m} R_{L}^{\prime}+1} \sqrt{\left[\left(C_{g s}+C_{g d}\right) C_{L}+C_{g s} C_{g d}\right] R_{\text {sig }} R_{L}^{\prime}}}{\left[C_{g s}+C_{g d}\left(g_{m} R_{L}^{\prime}+1\right)\right] R_{\text {sig }}+\left(C_{g s}+C_{L}\right) R_{L}^{\prime}}
\end{gathered}
$$


Figure 10.32 (a) A pair of complex-conjugate poles with the definition of $\omega_{o}$ and $Q$ indicated. (b) Magnitude response of a source (or emitter) follower for different values of the parameter $Q$. Note that the response is normalized relative to $A_{M}$.

# Example 10.11 

A source follower operated at $g_{m}=2 \mathrm{~mA} / \mathrm{V}$ and $r_{o}=20 \mathrm{k} \Omega$ is fed with a signal source for which $R_{\text {sig }}=10 \mathrm{k} \Omega$ and is loaded in a resistance $R_{L}=20 \mathrm{k} \Omega$. The MOSFET has $C_{g s}=20 \mathrm{fF}, C_{g d}=5 \mathrm{fF}$, and $g_{m b}=\chi g_{m}$ where $\chi=0.2$, and the total capacitance at the output $C_{L}=15 \mathrm{fF}$. Determine $A_{M}, f_{T}, f_{Z}, Q, f_{P 1}, f_{P 2}$, and $f_{\mathrm{NB}}$.

## Solution

$$
\begin{aligned}
R_{L}^{\prime} & =R_{L}\left\|r_{o}\right\| \frac{1}{g_{m b}} \\
& =20\|20\| \frac{1}{0.2 \times 2}=20\|20\| 2.5=2 \mathrm{k} \Omega
\end{aligned}
$$
Example 10.11 continued

$$
\begin{aligned}
A_{M} & =\frac{R_{L}^{\prime}}{R_{L}^{\prime}+\frac{1}{g_{m}}}=\frac{2}{2+\frac{1}{2}}=0.8 \mathrm{~V} / \mathrm{V} \\
f_{T} & =\frac{g_{m}}{2 \pi\left(C_{g s}+C_{g d}\right)} \\
& =\frac{2 \times 10^{-3}}{2 \pi(20+5) \times 10^{-15}} \\
& =12.7 \mathrm{GHz} \\
f_{Z} & =\frac{g_{m}}{2 \pi C_{g s}}=\frac{2 \times 10^{-3}}{2 \pi \times 20 \times 10^{-15}}=15.9 \mathrm{GHz}
\end{aligned}
$$

To evaluate $Q$ we substitute the given component values into Eq. (10.128),

$$
Q=0.42
$$

Thus the poles are real. Their frequencies can be obtained by finding the roots of the polynomial $\left(1+b_{1} s+b_{2} s^{2}\right)$, where

$$
b_{1}=\tau_{H}=104 \mathrm{ps}
$$

and

$$
b_{2}=1.9 \times 10^{-21}
$$

Thus,

$$
\begin{aligned}
& f_{P 1}=1.98 \mathrm{GHz} \\
& f_{P 2}=6.73 \mathrm{GHz}
\end{aligned}
$$

Since $f_{P 2} / f_{P 1}=3.4<4$, no dominant pole exists. An approximate value for $f_{H}$ can be obtained as

$$
f_{H}=1 / \sqrt{\frac{1}{f_{P 1}^{2}}+\frac{1}{f_{P 2}^{2}}-\frac{2}{f_{Z}^{2}}}=1.93 \mathrm{GHz}
$$

The exact value of $f_{H}$ can be found from the transfer function as 1.86 GHz , which is not much different from the approximate value.

# EXERCISES 

10.23 Recalling that $\tau_{H}=b_{1}$, use the expression for $b_{1}$ in Eq. (10.120) to find expressions for the three resistances $R_{g s}, R_{g d}$, and $R_{C_{L}}$ for the source follower.
Ans. $R_{g s}=\frac{R_{\text {sig }}+R_{L}^{\prime}}{g_{m} R_{L}^{\prime}+1} ; R_{g d}=R_{\text {sig }} ; R_{C_{L}}=\frac{R_{L}^{\prime}}{g_{m} R_{L}^{\prime}+1}$
10.24 In Example 10.11, even though we found that a dominant pole does not exist, use the method of open-circuit time constants to obtain an estimate for $f_{H}$. (Hint: Recall that $\tau_{H}=b_{1}$.)
Ans. $f_{H}=1.53 \mathrm{GHz}$; about $18 \%$ lower than the exact value of 1.86 GHz ; still not a bad estimate!
# 10.6.2 The Emitter-Follower Case 

Figure 10.33 provides the results for the case of the emitter follower. The analysis here is a little more complicated because of the finite $\beta$ of the BJT.


Figure 10.33 (a) Emitter follower. (b) High-frequency equivalent circuit. (c) Simplified equivalent circuit. (d) Transfer function.

## EXERCISE

10.25 For an emitter follower biased at $I_{C}=1 \mathrm{~mA}$ and having $R_{\text {sig }}=R_{L}=1 \mathrm{k} \Omega, r_{o}=100 \mathrm{k} \Omega, \beta=100$, $C_{o}=2 \mathrm{pF}, C_{L}=0, r_{s}=0$, and $f_{T}=400 \mathrm{MHz}$, find the low-frequency gain $A_{M}, f_{Z}, f_{P 1}, f_{P 2}$, and an estimate for $f_{H}$.
Ans. $0.97 \mathrm{~V} / \mathrm{V} ; 458 \mathrm{MHz} ; 67.2 \mathrm{MHz} ; 562 \mathrm{MHz} ; 67.2 \mathrm{MHz}$
# 10.7 High-Frequency Response of Differential Amplifiers 

In this section we study the high-frequency response of the differential amplifier. We will consider the variation with frequency of both the differential gain and the common-mode gain and hence of the CMRR. We will rely heavily on the study of frequency response of single-ended amplifiers presented in the sections above. Also, we will consider MOS circuits only; the bipolar case is a straightforward extension, as we saw above on a number of occasions.

### 10.7.1 Analysis of the Resistively Loaded MOS Amplifier

We begin with the basic, resistively loaded MOS differential pair shown in Fig. 10.34(a). Note that we have explicitly shown transistor $Q_{S}$ that supplies the bias current $I$. Although we are showing a dc bias voltage $V_{\text {BIAS }}$ at its gate, usually $Q_{S}$ is part of a current mirror. This detail, however, is of no consequence to our present needs. Most importantly, we are interested in the total impedance between node $S$ and ground, $Z_{S S}$, because this impedance plays a significant role in determining the common-mode gain and the CMRR of the differential amplifier. Resistance $R_{S S}$ is simply the output resistance of current source $Q_{S}$. Capacitance $C_{S S}$ is the total capacitance between node $S$ and ground and includes $C_{d b}$ and $C_{g d}$ of $Q_{S}$, as well as $C_{s b 1}$ and $C_{s b 2}$. This capacitance can be significant, especially if wide transistors are used for $Q_{S}, Q_{1}$, and $Q_{2}$.

The differential half-circuit shown in Fig. 10.34(b) can be used to determine the frequency dependence of the differential gain $V_{o} / V_{s d}$. Indeed the gain function $A_{d}(s)$ of the differential


Figure 10.34 (a) A resistively loaded MOS differential pair; the transistor supplying the bias current is explicitly shown. It is assumed that the total impedance between node $S$ and ground, $Z_{S S}$, consists of a resistance $R_{S S}$ in parallel with a capacitance $C_{S S}$. (b) Differential half-circuit. (c) Common-mode half-circuit.
amplifier will be identical to the transfer function of this common-source amplifier. ${ }^{9}$ We studied the frequency response of the common-source amplifier at great length in Sections 10.3 and 10.4 and will not repeat this material here.

# EXERCISE 

10.26 A MOSFET differential amplifier such as that in Fig. 10.34(a) is biased with a current $I=0.8 \mathrm{~mA}$. The transistors $Q_{1}$ and $Q_{2}$ have $W / L=100, k_{b}^{\prime}=0.2 \mathrm{~mA} / \mathrm{V}^{2}, V_{A}=20 \mathrm{~V}, C_{g s}=50 \mathrm{fF}, C_{g d}=10 \mathrm{fF}$, and $C_{d b}=10 \mathrm{fF}$. The drain resistors are $5 \mathrm{k} \Omega$ each. Also, there is a $100-\mathrm{fF}$ capacitive load between each drain and ground.
(a) Find $V_{O V}$ and $g_{m}$ for each transistor.
(b) Find the differential gain $A_{d}$.
(c) If the input signal source has a small resistance $R_{s i g}$ and thus the frequency response is determined primarily by the output pole, estimate the 3-dB frequency $f_{H}$. [Hint: Refer to Section 10.3.4 and specifically to Eq. (10.67).]
(d) If, in a different situation, the amplifier is fed symmetrically with a signal source of $20 \mathrm{k} \Omega$ resistance (i.e., $10 \mathrm{k} \Omega$ in series with each gate terminal), use the open-circuit time-constants method to estimate $f_{H}$. [Hint: Refer to Section 10.4.4 and specifically to Eq. (10.87).] Ans. (a) $0.2 \mathrm{~V}, 4 \mathrm{~mA} / \mathrm{V}$; (b) $18.2 \mathrm{~V} / \mathrm{V}$; (c) 292 MHz ; (d) 53.7 MHz

The common-mode half-circuit is shown in Fig. 10.34(c). Although this circuit has other capacitances, namely, $C_{g s}, C_{g d}$, and $C_{d b}$ of the transistor in addition to other stray capacitances, we have chosen to show only $C_{S S} / 2$. This is because $\left(C_{S S} / 2\right)$ together with $\left(2 R_{S S}\right)$ form a real-axis zero in the common-mode gain function at a frequency much lower than those of the other poles and zeros of the circuit. This zero then dominates the frequency dependence of $A_{c m}$ and CMRR.

If the output of the differential amplifier is taken single-endedly, then the common-mode gain of interest is $V_{o c m} / V_{i c m}$. More typically, the output is taken differentially. Nevertheless, as we have seen in Section 9.3, $V_{o c m} / V_{i c m}$ still plays a major role in determining the common-mode gain. To be specific, consider what happens when the output is taken differentially and there is a mismatch $\Delta R_{D}$ between the two drain resistances. The resulting common-mode gain was found in Section 9.3 to be (Eq. 9.80)

$$
A_{c m}=-\left(\frac{R_{D}}{2 R_{S S}}\right) \frac{\Delta R_{D}}{R_{D}}
$$

which is simply the product of $V_{o c m} / V_{i c m}$ and the per-unit mismatch $\left(\Delta R_{D} / R_{D}\right)$. Similar expressions can be found for the effects of other circuit mismatches. The important point to note is that the factor $R_{D} / 2 R_{S S}$ is always present in these expressions. Thus, the frequency dependence of $A_{c m}$ can be obtained by simply replacing $R_{S S}$ by $Z_{S S}$ in this factor. Doing so for

[^0]
[^0]:    ${ }^{9}$ Here we are not showing the resistance of the signal source $R_{s i g}$, which, of course, must be included in the frequency-response analysis, as we have done in the case of the CS amplifier. See Exercise 10.26.
the expression in Eq. (10.129) gives

$$
\begin{aligned}
A_{c m}(s) & =-\frac{R_{D}}{2 Z_{S S}}\left(\frac{\Delta R_{D}}{R_{D}}\right) \\
& =-\frac{1}{2} R_{D}\left(\frac{\Delta R_{D}}{R_{D}}\right) Y_{S S} \\
& =-\frac{1}{2} R_{D}\left(\frac{\Delta R_{D}}{R_{D}}\right)\left(\frac{1}{R_{S S}}+s C_{S S}\right) \\
& =-\frac{R_{D}}{2 R_{S S}}\left(\frac{\Delta R_{D}}{R_{D}}\right)\left(1+s C_{S S} R_{S S}\right)
\end{aligned}
$$

from which we see that $A_{c m}$ acquires a zero on the negative real axis of the $s$ plane with frequency $\omega_{Z}$,

$$
\omega_{Z}=\frac{1}{C_{S S} R_{S S}}
$$

or in hertz,

$$
f_{Z}=\frac{\omega_{Z}}{2 \pi}=\frac{1}{2 \pi C_{S S} R_{S S}}
$$

As mentioned above, usually $f_{Z}$ is much lower than the frequencies of the other poles and zeros. As a result, the common-mode gain increases at the rate of $+6 \mathrm{~dB} /$ octave ( $20 \mathrm{~dB} /$ decade) starting at a relatively low frequency, as indicated in Fig. 10.35(a). Of course, $A_{c m}$ drops off at high frequencies because of the other poles of the common-mode half-circuit. It is, however, $f_{Z}$ that is significant, for it is the frequency at which the CMRR of the differential amplifier begins to decrease, as indicated in Fig. 10.35(c). Note that if both $A_{d}$ and $A_{c m}$ are expressed and plotted in dB , then CMRR in dB is simply the difference between $A_{d}$ and $A_{c m}$.

Although in the foregoing we considered only the common-mode gain resulting from an $R_{D}$ mismatch, the results apply to the common-mode gain resulting from any other mismatch. For instance, it applies equally well to the case of a $g_{m}$ mismatch, modifying Eq. (9.87) by replacing $R_{S S}$ by $Z_{S S}$, and so on.

Before leaving this section, it is interesting to point out an important trade-off found in the design of the current-source transistor $Q_{S}$ : In order to operate this current source with a small $V_{D S}$ (to conserve the already low $V_{D D}$ ), we desire to operate the transistor at a low overdrive voltage $V_{O V}$. For a given value of the current $I$, however, this means using a large $W / L$ ratio (i.e., a wide transistor). This in turn increases $C_{S S}$ and hence lowers $f_{Z}$ with the result that the CMRR deteriorates (i.e., decreases) at a relatively low frequency. Thus there is a trade-off between the need to reduce the dc voltage across $Q_{S}$ and the need to keep the CMRR reasonably high at higher frequencies.

To appreciate the need for high CMRR at higher frequencies, consider the situation illustrated in Fig. 10.36: We show two stages of a differential amplifier whose power-supply voltage $V_{D D}$ is corrupted with high-frequency noise. Since the quiescent voltage at each of the drains of $Q_{1}$ and $Q_{2}$ is $\left[V_{D D}-(I / 2) R_{D}\right]$ we see that $v_{D 1}$ and $v_{D 2}$ will have the same high-frequency noise as $V_{D D}$. This high-frequency noise then constitutes a common-mode input signal to the second differential stage, formed by $Q_{3}$ and $Q_{4}$. If the second differential stage is perfectly matched, its differential output voltage $V_{o}$ should be free of high-frequency


Figure 10.35 Variation of (a) common-mode gain, (b) differential gain, and (c) common-mode rejection ratio with frequency.
noise. However, in practice there is no such thing as perfect matching, and the second stage will have a finite common-mode gain. Furthermore, because of the zero formed by $R_{S S}$ and $C_{S S}$ of the second stage, the common-mode gain will increase with frequency, causing some of the noise to make its way to $V_{o}$. With careful design, this undesirable component of $V_{o}$ can be kept small.

Figure 10.36 The second stage in a differential amplifier, which is relied on to suppress high-frequency noise injected by the power supply of the first stage, and therefore must maintain a high CMRR at higher frequencies.

# EXERCISE 

10.27 The differential amplifier specified in Exercise 10.26 has $R_{S S}=75 \mathrm{k} \Omega$ and $C_{S S}=0.4 \mathrm{pF}$. Find the $3-\mathrm{dB}$ frequency of the CMRR.
Ans. 5.3 MHz

## RFID-IDENTIFICATION AT A DISTANCE:

Radio-frequency identification (RFID) tags are increasingly important elements in our daily lives. These tiny devices embody a wide range of electronic techniques: linear, digital, radio, power, and signaling, all at very low power levels. They are activated (and powered) by an external interrogation signal that can be located a few feet away. Once activated, they respond with the requested data, most often simply an identifying number. Applications are incredibly diverse, ranging from automobile key fobs to tags that permit the recovery of lost pets.

### 10.7.2 Analysis of the Current-Mirror-Loaded MOS Amplifier

We next consider the frequency response of the current-mirror-loaded MOS differential-pair circuit studied in Section 9.5. The circuit is shown in Fig. 10.37(a) with two capacitances indicated: $C_{m}$, which is the total capacitance at the input node of the current mirror, and $C_{L}$, which is the total capacitance at the output node. Capacitance $C_{m}$ is mainly formed by $C_{q s 3}$


Figure 10.37 (a) Frequency-response analysis of the active-loaded MOS differential amplifier. (b) The overall transconductance $G_{m}$ as a function of frequency.
and $C_{g s 4}$ but also includes $C_{g d 1}, C_{d b 1}$, and $C_{d b 3}$,

$$
C_{m}=C_{g d 1}+C_{d b 1}+C_{d b 3}+C_{g s 3}+C_{g s 4}
$$

Capacitance $C_{L}$ includes $C_{g d 2}, C_{d b 2}, C_{d b 4}$, and $C_{g d 4}$ as well as an actual load capacitance and/or the input capacitance of a subsequent stage $\left(C_{x}\right)$,

$$
C_{L}=C_{g d 2}+C_{d b 2}+C_{g d 4}+C_{d b 4}+C_{x}
$$

These two capacitances primarily determine the dependence of the differential gain of this amplifier on frequency.

The overall voltage gain of the differential amplifier will be determined by multiplying its short-circuit transconductance $G_{m}$ by the total impedance at the output mode. As indicated in Fig. 10.37(a) the input differential signal $V_{i d}$ is applied in a balanced fashion and the output node is short-circuited to ground in order to determine the transconductance $G_{m} ; G_{m} \equiv I_{o} / V_{i d}$. Obviously, because of the output short circuit, $C_{L}$ will have no effect on $G_{m}$. Transistor $Q_{1}$ will conduct a drain current signal of $g_{m} V_{i d} / 2$, which, neglecting $r_{o 1}$, flows through the parallel combination of the diode-connected transistor $Q_{3}$ and $C_{m}$. Neglecting the resistances $r_{o i}$ and $r_{o 3}$, which are much larger than the resistance $\left(1 / g_{m 3}\right)$ of $Q_{3}$ we have

$$
V_{g 3}=-\frac{g_{m} V_{i d} / 2}{g_{m 3}+s C_{m}}
$$

In response to $V_{g 3}$, transistor $Q_{4}$ conducts a drain current $I_{d 4}$,

$$
I_{d 4}=-g_{m 4} V_{g 3}=\frac{g_{m 4} g_{m} V_{i d} / 2}{g_{m 3}+s C_{m}}
$$

Since $g_{m 3}=g_{m 4}$, this equation reduces to

$$
I_{d 4}=\frac{g_{m} V_{i d} / 2}{1+s \frac{C_{m}}{g_{m 3}}}
$$
Now, at the output node the total output current that flows through the short circuit is

$$
\begin{aligned}
I_{o} & =I_{d 4}+I_{d 2} \\
& =\frac{g_{m} V_{i d} / 2}{1+s \frac{C_{m}}{g_{m 3}}}+g_{m} V_{i d} / 2
\end{aligned}
$$

We can now obtain $G_{m}$ as

$$
G_{m} \equiv \frac{I_{o}}{V_{i d}}=g_{m} \frac{1+s \frac{C_{m}}{2 g_{m 3}}}{1+s \frac{C_{m}}{g_{m 3}}}
$$

Thus, as expected, the low-frequency value of $G_{m}$ is equal to $g_{m}$ of $Q_{1}$ and $Q_{2}$. At high frequencies, $G_{m}$ acquires a pole and a zero, the frequencies of which are

$$
f_{P 2}=\frac{g_{m 3}}{2 \pi C_{m}}
$$

and

$$
f_{Z}=\frac{2 g_{m 3}}{2 \pi C_{m}}
$$

That is, the zero frequency is twice that of the pole. Since $C_{m}$ is approximately equal to $C_{g s 2}+C_{g s 4}=2 C_{g s}$, we also have

$$
f_{P 2}=\frac{g_{m 3}}{2 \pi C_{m}} \simeq \frac{g_{m 3}}{2 \pi\left(2 C_{g s}\right)} \simeq f_{T} / 2
$$

and

$$
f_{Z} \simeq f_{T}
$$

where $f_{T}$ is the unity-gain frequency of the MOSFET $Q_{3}$. Thus, the mirror pole and zero occur at very high frequencies. Nevertheless, their effect can be significant.

Figure 10.37(b) shows a sketch of the magnitude of $G_{m}$ versus frequency. It is interesting and useful to observe that the path of the signal current produced by $Q_{1}$ has a transfer function different from that of the signal current produced by $Q_{2}$. It is the first signal that encounters $C_{m}$ and experiences the mirror pole. This observation leads to an interesting view of the effect of $C_{m}$ on the overall transconductance $G_{m}$ of the differential amplifier. As we learned in Section 9.5 , at low frequencies $I_{d 1}$ is replicated by the mirror $Q_{3}-Q_{4}$ in the drain of $Q_{4}$ as $I_{d 4}$, which adds to $I_{d 2}$ to provide a factor-of-2 increase in $G_{m}$ (thus making $G_{m}$ equal to $g_{m}$, which is double the value available without the current mirror). Now, at high frequencies $C_{m}$ acts as a short circuit causing $V_{g 3}$ to be zero, and hence $I_{d 4}$ will be zero, that is, destroying the action of the current mirror and reducing $G_{m}$ to $g_{m} / 2$, as borne out by the sketch in Fig. 10.37(b).
Having determined the short-circuit output current $I_{o}$, we now multiply it by the total impedance between the output node and ground to determine the output voltage $V_{o}$,

$$
\begin{aligned}
V_{o} & =I_{o} \frac{1}{\frac{1}{R_{o}}+s C_{L}} \\
& =G_{m} V_{i d} \frac{R_{o}}{1+s C_{L} R_{o}}
\end{aligned}
$$

where

$$
R_{o}=r_{o 2} \| r_{o 4}
$$

Thus,

$$
\frac{V_{o}}{V_{i d}}=\left(g_{m} R_{o}\right)\left(\frac{1+s \frac{C_{m}}{2 g_{m 3}}}{1+s \frac{C_{m}}{g_{m 3}}}\right)\left(\frac{1}{1+s C_{L} R_{o}}\right)
$$

Thus, in addition to the pole and zero of $G_{m}$, the gain of the differential amplifier will have a pole with frequency $f_{P 1}$,

$$
f_{P 1}=\frac{1}{2 \pi C_{L} R_{o}}
$$

This, of course, is entirely expected, and in fact this output pole is often dominant, especially when a large load capacitance is present.

# Example 10.12 

Consider an active-loaded MOS differential amplifier of the type shown in Fig. 10.37(a). Assume that for all transistors, $W / L=7.2 \mu \mathrm{~m} / 0.36 \mu \mathrm{~m}, C_{g s}=20 \mathrm{fF}, C_{g d}=5 \mathrm{fF}$, and $C_{d b}=5 \mathrm{fF}$. Also, let $\mu_{u} C_{o s}=387 \mu \mathrm{~A} / \mathrm{V}^{2}, \mu_{p} C_{o s}=86 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{A u}^{\prime}=5 \mathrm{~V} / \mu \mathrm{m}$, and $\left|V_{A p}^{\prime}\right|=6 \mathrm{~V} / \mu \mathrm{m}$. The bias current $I=0.2 \mathrm{~mA}$, and the bias current source has an output resistance $R_{S S}=25 \mathrm{k} \Omega$ and an output capacitance $C_{S S}=0.2 \mathrm{pF}$. In addition to the capacitances introduced by the transistors at the output node, there is a capacitance $C_{s}$ of 25 fF . It is required to determine the low-frequency values of $A_{d}, A_{c m}$, and CMRR. It is also required to find the poles and zero of $A_{d}$ and the dominant pole of CMRR.

## Solution

Since $I=0.2 \mathrm{~mA}$, each of the four transistors is operating at a bias current of $100 \mu \mathrm{~A}$. Thus, for $Q_{1}$ and $Q_{2}$,

$$
100=\frac{1}{2} \times 387 \times \frac{7.2}{0.36} \times V_{O V}^{2}
$$

which leads to

$$
V_{O V}=0.16 \mathrm{~V}
$$
# Example 10.12 continued 

Thus,

$$
\begin{gathered}
g_{m}=g_{m 1}=g_{m 2}=\frac{2 \times 0.1}{0.16}=1.25 \mathrm{~mA} / \mathrm{V} \\
r_{o 1}=r_{o 2}=\frac{5 \times 0.36}{0.1}=18 \mathrm{k} \Omega
\end{gathered}
$$

For $Q_{3}$ and $Q_{4}$ we have

$$
100=\frac{1}{2} \times 86 \times \frac{7.2}{0.36} V_{O V 3,4}^{2}
$$

Thus,

$$
\left|V_{O V 3,4}\right|=0.34 \mathrm{~V}
$$

and

$$
\begin{aligned}
& g_{m 3}=g_{m 4}=\frac{2 \times 0.1}{0.34}=0.6 \mathrm{~mA} / \mathrm{V} \\
& r_{o 3}=r_{o 4}=\frac{6 \times 0.36}{0.1}=21.6 \mathrm{k} \Omega
\end{aligned}
$$

The low-frequency value of the differential gain can be determined from

$$
\begin{aligned}
A_{d} & =g_{m}\left(r_{o 2} \| r_{o 4}\right) \\
& =1.25(18\|21.6)=12.3 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

The low-frequency value of the common-mode gain can be determined from Eq. (9.157) as

$$
\begin{aligned}
A_{c m} & =-\frac{1}{2 g_{m 2} R_{S S}} \\
& =-\frac{1}{2 \times 0.6 \times 25}=-0.033 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

The low-frequency value of the CMRR can now be determined as

$$
\mathrm{CMRR}=\frac{\left|A_{d}\right|}{\left|A_{c m}\right|}=\frac{12.3}{0.033}=369
$$

or,

$$
20 \log 369=51.3 \mathrm{~dB}
$$

To determine the poles and zero of $A_{d}$ we first compute the values of the two pertinent capacitances $C_{m}$ and $C_{L}$. Using Eq. (10.133),

$$
\begin{aligned}
C_{m} & =C_{g d 1}+C_{d b 1}+C_{d b 3}+C_{g s 3}+C_{g s 4} \\
& =5+5+5+20+20=55 \mathrm{fF}
\end{aligned}
$$
Capacitance $C_{L}$ is found using Eq. (10.134) as

$$
\begin{aligned}
C_{L} & =C_{g d 2}+C_{d b 2}+C_{g d 4}+C_{d b 4}+C_{x} \\
& =5+5+5+5+25=45 \mathrm{fF}
\end{aligned}
$$

Now, the poles and zero of $A_{d}$ can be found from Eqs. (10.145), (10.139), and (10.140) as

$$
\begin{aligned}
f_{P 1} & =\frac{1}{2 \pi C_{L} R_{s}} \\
& =\frac{1}{2 \pi \times C_{L}\left(r_{o 2} \| r_{o 4}\right)} \\
& =\frac{1}{2 \pi \times 45 \times 10^{-15}(18\|21.6) 10^{3}} \\
& =360 \mathrm{MHz} \\
f_{P 2} & =\frac{g_{m 3}}{2 \pi C_{m}}=\frac{0.6 \times 10^{-3}}{2 \pi \times 55 \times 10^{-15}}=1.74 \mathrm{GHz} \\
f_{Z} & =2 f_{P 2}=3.5 \mathrm{GHz}
\end{aligned}
$$

Thus the dominant pole is that produced by $C_{L}$ at the output node. As expected, the pole and zero of the mirror are at much higher frequencies.

The dominant pole of the CMRR is at the location of the common-mode-gain zero introduced by $C_{S S}$ and $R_{S S}$, that is,

$$
\begin{aligned}
f_{Z} & =\frac{1}{2 \pi C_{S S} R_{S S}} \\
& =\frac{1}{2 \pi \times 0.2 \times 10^{-12} \times 25 \times 10^{3}} \\
& =31.8 \mathrm{MHz}
\end{aligned}
$$

Thus, the CMRR begins to decrease at 31.8 MHz , which is much lower than $f_{P 1}$.

# EXERCISE 

10.28 A bipolar current-mirror-loaded differential amplifier is biased with a current source $I=1 \mathrm{~mA}$. The transistors are specified to have $\left|V_{A}\right|=100 \mathrm{~V}$. The total capacitance at the output node is 2 pF . Find the dc value, and the frequency of the dominant high-frequency pole, of the differential voltage gain.
Ans. $2000 \mathrm{~V} / \mathrm{V} ; 0.8 \mathrm{MHz}$
# 10.8 Other Wideband Amplifier Configurations 

Thus far, we have studied one wideband amplifier configuration: the cascode amplifier (Section 10.5). Cascoding can, of course, be applied to differential amplifiers to obtain wideband differential amplification. In this section we discuss a number of other circuit configurations that are capable of achieving wide bandwidths.

### 10.8.1 Obtaining Wideband Amplification by Source and Emitter Degeneration

As we discussed in Chapter 7, adding a resistance in the source (emitter) lead of a CS (CE) amplifier can result in a number of performance improvements at the expense of a reduction in voltage gain. Extension of the amplifier bandwidth, which is the topic of interest to us in this section, is among those improvements.

Figure 10.38(a) shows a common-source amplifier with a source-degeneration resistance $R_{s}$. As indicated in Fig. 10.38(b), the output of the amplifier can be modeled at low frequencies by a controlled current-source $G_{m} V_{i}$ and an output resistance $R_{o}$, where, for the usual case of $g_{m} r_{o} \gg 1$, the transconductance $G_{m}$ can be shown to be given by

$$
G_{m} \simeq \frac{g_{m}}{1+g_{m} R_{s}}
$$

and the output resistance is given by Eq. (8.61), that is,

$$
R_{o} \simeq r_{o}\left(1+g_{m} R_{s}\right)
$$

Thus, source degeneration reduces the transconductance and increases the output resistance by the same factor, $\left(1+g_{m} R_{s}\right)$. The low-frequency voltage gain can be obtained as

$$
A_{M}=\frac{V_{o}}{V_{\text {sig }}}=-G_{m}\left(R_{o} \| R_{L}\right)=-G_{m} R_{L}^{\prime}
$$

where

$$
R_{L}^{\prime}=R_{L} \| R_{o}
$$

Let's now consider the high-frequency response of the source-degenerated amplifier. Figure 10.38(c) shows the amplifier, indicating the capacitances $C_{g s}$ and $C_{g d}$. A capacitance $C_{L}$ that includes the MOSFET capacitance $C_{d h}$ is also shown at the output. The method of open-circuit time constants can be employed to obtain an estimate of the 3-dB frequency $f_{H}$. Toward that end, we show in Fig. 10.38(d) the circuit for determining $R_{g d}$, which is the resistance seen by $C_{g d}$. Straightforward analysis yields

$$
R_{g d}=R_{\text {sig }}\left(1+G_{m} R_{L}^{\prime}\right)+R_{L}^{\prime}
$$

Note that the expression for $R_{g d}$ in Eq. (10.150) is similar to that for the CS amplifier in Eq. (10.85) with $g_{m}$ replaced with $G_{m}$, and $R_{L}^{\prime}=r_{o} \| R_{L}$ of the CS replaced with $R_{L}^{\prime}=R_{o} \| R_{L}$ for the source-degenerated case.


Figure 10.38 (a) The CS amplifier circuit, with a source resistance $R_{s}$. (b) Equivalent-circuit representation of the amplifier output. (c) The circuit prepared for frequency-response analysis. (d) Determining the resistance $R_{g d}$ seen by the capacitance $C_{g d}$.
The formula for $R_{C_{L}}$ can be seen to be simply

$$
R_{C_{L}}=R_{L} \| R_{\mathrm{o}}=R_{L}^{\prime}
$$

The formula for $R_{g s}$ is the most difficult to derive, and the derivation should be performed with the hybrid- $\pi$ model explicitly utilized. Straightforward, though somewhat tedious, circuit analysis yields (for $g_{m} r_{\mathrm{o}} \gg 1$ ),

$$
R_{g s} \simeq \frac{R_{\mathrm{sig}}+R_{s}+R_{\mathrm{sig}} R_{s} /\left(r_{\mathrm{o}}+R_{L}\right)}{1+g_{m} R_{s}\left(\frac{r_{\mathrm{o}}}{r_{\mathrm{o}}+R_{L}}\right)}
$$

Next we compute $\tau_{H}$,

$$
\tau_{H}=C_{g s} R_{g s}+C_{g d} R_{g d}+C_{L} R_{C_{L}}
$$

and use it to determine $f_{H}$,

$$
f_{H}=\frac{1}{2 \pi \tau_{H}}
$$

It is interesting and instructive to consider the case when $R_{\text {sig }}$ is relatively large: The frequency response will be dominated by the Miller multiplication of $C_{g d}$. Another way for saying this is that $C_{g d} R_{g d}$ will be the largest of the three open-circuit time constants that make up $\tau_{H}$ in Eq. (10.153), enabling us to approximate $\tau_{H}$ as

$$
\tau_{H} \simeq C_{g d} R_{g d}
$$

and correspondingly to obtain $f_{H}$ as

$$
f_{H} \simeq \frac{1}{2 \pi C_{g d} R_{g d}}
$$

Now, as $R_{s}$ is increased, the gain magnitude, $\left|A_{M}\right|=G_{m} R_{L}^{\prime}$, will decrease, causing $R_{g d}$ to decrease (Eq. 10.150), which in turn causes $f_{H}$ to increase (Eq. 10.155). To highlight the trade-off between gain and bandwidth that $R_{s}$ affords the designer, let us simplify the expression for $R_{g d}$ in Eq. (10.150) by assuming that $G_{m} R_{L}^{\prime} \gg 1$ and $G_{m} R_{\text {sig }} \gg 1$, thus

$$
R_{g d} \simeq G_{m} R_{L}^{\prime} R_{\mathrm{sig}}=\left|A_{M}\right| R_{\mathrm{sig}}
$$

which can be substituted in Eq. (10.155) to obtain

$$
f_{H}=\frac{1}{2 \pi C_{g d} R_{\mathrm{sig}}\left|A_{M}\right|}
$$

which very clearly shows the gain-bandwidth trade-off. The gain-bandwidth product remains constant at

$$
\text { Gain-bandwidth product }=\left|A_{M}\right| f_{H}=\frac{1}{2 \pi C_{g d} R_{\text {sig }}}
$$

In practice, however, the other capacitances will play a role in determining $f_{H}$, and the gain-bandwidth product will decrease somewhat as $R_{s}$ is increased.
# EXERCISE 

10.29 Consider a CS amplifier having $g_{m}=2 \mathrm{~mA} / \mathrm{V}, r_{o}=20 \mathrm{k} \Omega, R_{L}=20 \mathrm{k} \Omega, R_{\text {sig }}=20 \mathrm{k} \Omega, C_{g s}=20 \mathrm{fF}$, $C_{g d}=5 \mathrm{fF}$, and $C_{L}=5 \mathrm{fF}$. (a) Find the voltage gain $A_{M}$ and the 3-dB frequency $f_{H}$ (using the method of open-circuit time constants) and hence the gain-bandwidth product. (b) Repeat (a) for the case in which a resistance $R_{s}$ is connected in series with the source terminal with a value selected so that $g_{m} R_{s}=2$.
Ans. (a) $-20 \mathrm{~V} / \mathrm{V}, 61.2 \mathrm{MHz}, 1.22 \mathrm{GHz}$; (b) $-10 \mathrm{~V} / \mathrm{V}, 109 \mathrm{MHz}, 1.1 \mathrm{GHz}$

### 10.8.2 The CD-CS, CC-CE, and CD-CE Configurations

In Section 8.7.1 we discussed the performance improvements obtained by preceding the CS and CE amplifiers by a buffer implemented by a CD or a CC amplifier, as in the circuits shown in Fig. 10.39. A major advantage of each of these circuits is wider bandwidth than that obtained in the CS or CE stage alone. To see how this comes about, consider as an example the CD-CS amplifier in Fig 10.39(a) and note that the CS transistor $Q_{2}$ will still exhibit a Miller effect that results in a large input capacitance, $C_{\text {in } 2}$, between its gate and ground. However, the resistance that this capacitance interacts with will be much lower than $R_{\text {sig }}$; the buffering action of the source follower causes a relatively low resistance, approximately equal to $1 / g_{m 1}$, to appear between the source of $Q_{1}$ and ground across $C_{\text {in } 2}$.


Figure 10.39 (a) CD-CS amplifier. (b) CC-CE amplifier. (c) CD-CE amplifier.

## Example 10.13

Consider a CC-CE amplifier such as that in Fig. 10.39(b) with the following specifications: $I_{1}=I_{2}=$ 1 mA and identical transistors with $\beta=100, f_{T}=400 \mathrm{MHz}$, and $C_{\mu}=2 \mathrm{pF}$. Let the amplifier be fed with a source $V_{\text {sig }}$ having a resistance $R_{\text {sig }}=4 \mathrm{k} \Omega$, and assume a load resistance of $4 \mathrm{k} \Omega$. Find the voltage gain $A_{M}$,1.53 A voltage amplifier delivers 200 mV across a load resistance of $1 \mathrm{k} \Omega$. It was found that the output voltage decreases by 5 mV when $R_{L}$ is decreased to $780 \Omega$. What are the values of the open-circuit output voltage and the output resistance of the amplifier?
1.54 A current amplifier supplies 1 mA to a load resistance of $1 \mathrm{k} \Omega$. When the load resistance is increased to $12 \mathrm{k} \Omega$, the output current decreases to 0.5 mA . What are the values of the short-circuit output current and the output resistance of the amplifier?
1.55 A current amplifier for which $R_{i}=100 \Omega, R_{o}=$ $10 \mathrm{k} \Omega$, and $A_{i s}=100 \mathrm{~A} / \mathrm{A}$ is to be connected between a $100-\mathrm{mV}$ source with a resistance of $10 \mathrm{k} \Omega$ and a load of $1 \mathrm{k} \Omega$. What are the values of current gain $i_{o} / i_{i}$, of voltage gain $v_{o} / v_{s}$, and of power gain expressed directly and in decibels?
1.56 A transconductance amplifier with $R_{i}=2 \mathrm{k} \Omega, G_{m}=$ $60 \mathrm{~mA} / \mathrm{V}$, and $R_{o}=20 \mathrm{k} \Omega$ is fed with a voltage source having a source resistance of $1 \mathrm{k} \Omega$ and is loaded with a $1-\mathrm{k} \Omega$ resistance. Find the voltage gain realized.

D **1.57 A designer is required to provide, across a $10-\mathrm{k} \Omega$ load, the weighted sum, $v_{i 1}=10 v_{1}+20 v_{2}$, of input signals $v_{1}$ and $v_{2}$, each having a source resistance of 10 $\mathrm{k} \Omega$. She has a number of transconductance amplifiers for which the input and output resistances are both $10 \mathrm{k} \Omega$ and $G_{m}=20 \mathrm{~mA} / \mathrm{V}$, together with a selection of suitable resistors. Sketch an appropriate amplifier topology with additional resistors selected to provide the desired result. Your design should utilize the minimum number of amplifiers and resistors. (Hint: In your design, arrange to add currents.)
1.58 Figure P1.58 shows a transconductance amplifier whose output is fed back to its input. Find the input resistance $R_{\mathrm{in}}$ of the resulting one-port network. (Hint: Apply a test voltage $v_{s}$ between the two input terminals, and find the current $i_{s}$ drawn from the source. Then, $R_{\mathrm{in}} \equiv v_{s} / i_{s}$.)


Figure P1.58

D 1.59 It is required to design an amplifier to sense the open-circuit output voltage of a transducer and to provide a proportional voltage across a load resistor. The equivalent source resistance of the transducer is specified to vary in the range of $1 \mathrm{k} \Omega$ to $10 \mathrm{k} \Omega$. Also, the load resistance varies in the range of $1 \mathrm{k} \Omega$ to $10 \mathrm{k} \Omega$. The change in load voltage corresponding to the specified change in $R_{s}$ should be $10 \%$ at most. Similarly, the change in load voltage corresponding to the specified change in $R_{L}$ should be limited to $10 \%$. Also, corresponding to a $10-\mathrm{mV}$ transducer open-circuit output voltage, the amplifier should provide a minimum of 1 V across the load. What type of amplifier is required? Sketch its circuit model, and specify the values of its parameters. Specify appropriate values for $R_{i}$ and $R_{o}$ of the form $1 \times 10^{\prime \prime} \Omega$.

D 1.60 It is required to design an amplifier to sense the short-circuit output current of a transducer and to provide a proportional current through a load resistor. The equivalent source resistance of the transducer is specified to vary in the range of $1 \mathrm{k} \Omega$ to $10 \mathrm{k} \Omega$. Similarly, the load resistance is known to vary over the range of $1 \mathrm{k} \Omega$ to $10 \mathrm{k} \Omega$. The change in load current corresponding to the specified change in $R_{s}$ is required to be limited to $10 \%$. Similarly, the change in load current corresponding to the specified change in $R_{L}$
should be $10 \%$ at most. Also, for a nominal short-circuit output current of the transducer of $10 \mu \mathrm{~A}$, the amplifier is required to provide a minimum of 1 mA through the load. What type of amplifier is required? Sketch the circuit model of the amplifier, and specify values for its parameters. Select appropriate values for $R_{i}$ and $R_{o}$ in the form $1 \times 10^{\prime \prime} \Omega$.

D 1.61 It is required to design an amplifier to sense the open-circuit output voltage of a transducer and to provide a proportional current through a load resistor. The equivalent source resistance of the transducer is specified to vary in the range of $1 \mathrm{k} \Omega$ to $10 \mathrm{k} \Omega$. Also, the load resistance is known to vary in the range of $1 \mathrm{k} \Omega$ to $10 \mathrm{k} \Omega$. The change in the current supplied to the load corresponding to the specified change in $R_{s}$ is to be $10 \%$ at most. Similarly, the change in load current corresponding to the specified change in $R_{L}$ is to be $10 \%$ at most. Also, for a nominal transducer open-circuit output voltage of 10 mV , the amplifier is required to provide a minimum of 1 mA current through the load. What type of amplifier is required? Sketch the amplifier circuit model, and specify values for its parameters. For $R_{i}$ and $R_{o}$, specify values in the form $1 \times 10^{\prime \prime} \Omega$.

D 1.62 It is required to design an amplifier to sense the short-circuit output current of a transducer and to provide a proportional voltage across a load resistor. The equivalent source resistance of the transducer is specified to vary in the range of $1 \mathrm{k} \Omega$ to $10 \mathrm{k} \Omega$. Similarly, the load resistance is known to vary in the range of $1 \mathrm{k} \Omega$ to $10 \mathrm{k} \Omega$. The change in load voltage corresponding to the specified change in $R_{s}$ should be $10 \%$ at most. Similarly, the change in load voltage corresponding to the specified change in $R_{L}$ is to be limited to $10 \%$. Also, for a nominal transducer short-circuit output current of $10 \mu \mathrm{~A}$, the amplifier is required to provide a minimum voltage across the load of 1 V . What type of amplifier is required? Sketch its circuit model, and specify the values of the model parameters. For $R_{i}$ and $R_{o}$, specify appropriate values in the form $1 \times 10^{\prime \prime} \Omega$.
1.63 For the circuit in Fig. P1.63, show that

$$
\frac{v_{c}}{v_{b}}=\frac{-\beta R_{L}}{r_{a}+(\beta+1) R_{E}}
$$

and

$$
\frac{v_{s}}{v_{b}}=\frac{R_{E}}{R_{E}+\left[r_{a} /(\beta+1)\right]}
$$



Figure P1.63
1.64 An amplifier with an input resistance of $5 \mathrm{k} \Omega$, when driven by a current source of $1 \mu \mathrm{~A}$ and a source resistance of $200 \mathrm{k} \Omega$, has a short-circuit output current of 5 mA and an open-circuit output voltage of 10 V . If the amplifier is used to drive a $2-\mathrm{k} \Omega$ load, give the values of the voltage gain, current gain, and power gain expressed as ratios and in decibels.
1.65 Figure P1.65(a) shows two transconductance amplifiers connected in a special configuration. Find $v_{o}$ in terms of $v_{1}$ and $v_{2}$. Let $g_{m}=100 \mathrm{~mA} / \mathrm{V}$ and $R=5 \mathrm{k} \Omega$. If $v_{1}=$ $v_{2}=1 \mathrm{~V}$, find the value of $v_{o}$. Also, find $v_{o}$ for the case $v_{1}=1.01 \mathrm{~V}$ and $v_{2}=0.99 \mathrm{~V}$. (Note: This circuit is called a differential amplifier and is given the symbol shown
in Fig. P1.65(b). A particular type of differential amplifier known as an operational amplifier will be studied in Chapter 2.)


Figure P1.65
1.66 Any linear two-port network including linear amplifiers can be represented by one of four possible parameter sets, given in Appendix C. For the voltage amplifier, the most convenient representation is in terms of the $g$ parameters. If the amplifier input port is labeled as port 1 and the output port as port 2 , its $g$-parameter representation is described by the two equations:

$$
\begin{aligned}
& I_{1}=g_{11} V_{1}+g_{12} I_{2} \\
& V_{2}=g_{21} V_{1}+g_{22} I_{2}
\end{aligned}
$$

Figure P1.66 shows an equivalent circuit representation of these two equations. By comparing this equivalent circuit
to that of the voltage amplifier in Fig. 1.16(a), identify corresponding currents and voltages as well as the correspondence between the parameters of the amplifier equivalent circuit and the $g$ parameters. Hence give the $g$ parameter that corresponds to each of $R_{i}, A_{v o}$, and $R_{o}$. Notice that there is an additional $g$ parameter with no correspondence in the amplifier equivalent circuit. Which one? What does it signify? What assumption did we make about the amplifier that resulted in the absence of this particular $g$ parameter from the equivalent circuit in Fig. 1.16(a)?


Figure P1.66

## Section 1.6: Frequency Response of Amplifiers

1.67 Use the voltage-divider rule to derive the transfer functions $T(s) \equiv V_{o}(s) / V_{i}(s)$ of the circuits shown in Fig. 1.22, and show that the transfer functions are of the form given at the top of Table 1.2.
1.68 Figure P1.68 shows a signal source connected to the input of an amplifier. Here $R_{s}$ is the source resistance, and $R_{i}$ and $C_{i}$ are the input resistance and input capacitance, respectively, of the amplifier. Derive an expression for $V_{i}(s) / V_{s}(s)$, and show that it is of the low-pass STC type. Find the 3-dB frequency for the case $R_{s}=10 \mathrm{k} \Omega, R_{i}=40 \mathrm{k} \Omega$, and $C_{i}=5 \mathrm{pF}$.


Figure P1.68
1.69 For the circuit shown in Fig. P1.69, find the transfer function $T(s)=V_{o}(s) / V_{i}(s)$, and arrange it in the appropriate standard form from Table 1.2. Is this a high-pass or a low-pass network? What is its transmission at very high frequencies? [Estimate this directly, as well as by letting $s \rightarrow \infty$ in your expression for $T(s)$.] What is the corner frequency $\omega_{0}$ ? For $R_{1}=10 \mathrm{k} \Omega, R_{2}=40 \mathrm{k} \Omega$, and $C=1 \mu \mathrm{~F}$, find $f_{0}$. What is the value of $\left|T\left(j \omega_{o}\right)\right|$ ?


Figure P1.69

D 1.70 It is required to couple a voltage source $V_{s}$ with a resistance $R_{s}$ to a load $R_{L}$ via a capacitor $C$. Derive an expression for the transfer function from source to load (i.e., $V_{i} / V_{s}$ ), and show that it is of the high-pass STC type. For $R_{s}=5 \mathrm{k} \Omega$ and $R_{L}=20 \mathrm{k} \Omega$, find the smallest coupling capacitor that will result in a 3-dB frequency no greater than 100 Hz .
1.71 Measurement of the frequency response of an amplifier yields the data in the following table:

| $\boldsymbol{f}(\mathrm{Hz})$ | $\|\boldsymbol{T}\|(\mathrm{dB})$ | $\angle \boldsymbol{T}\left({ }^{\circ}\right)$ |
| :--: | :--: | :--: |
| 0 | 40 | 0 |
| 100 | 40 | 0 |
| 1000 |  |  |
| $10^{4}$ | 37 | -45 |
| $10^{5}$ | 20 |  |
|  | 0 |  |

Provide plausible approximate values for the missing entries. Also, sketch and clearly label the magnitude frequency response (i.e., provide a Bode plot) for this amplifier.
1.72 Measurement of the frequency response of an amplifier yields the data in the following table:

| $\boldsymbol{f}(\mathrm{Hz})$ |  | 10 | $10^{2}$ | $10^{3}$ | $10^{4}$ | $10^{5}$ | $10^{6}$ | $10^{7}$ |  |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| $\|\boldsymbol{T}\|(\mathrm{dB})$ | 0 | 20 | 37 | 40 |  |  | 37 | 20 | 0 |

Provide approximate plausible values for the missing table entries. Also, sketch and clearly label the magnitude frequency response (Bode plot) of this amplifier.
1.73 The unity-gain voltage amplifiers in the circuit of Fig. P1.73 have infinite input resistances and zero output


Figure P1.73

[^0]
[^0]:    1.73 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
resistances and thus function as perfect buffers. Furthermore, assume that their gain is frequency independent. Convince yourself that the overall gain $V_{o} / V_{i}$ will drop by 3 dB below the value at dc at the frequency for which the gain of each $R C$ circuit is 1.0 dB down. What is that frequency in terms of $C R$ ?
1.74 A manufacturing error causes an internal node of a high-frequency amplifier whose Thévenin-equivalent node resistance is $100 \mathrm{k} \Omega$ to be accidentally shunted to ground by a capacitor (i.e., the node is connected to ground through a capacitor). If the measured 3-dB bandwidth of the amplifier is reduced from the expected 5 MHz to 100 kHz , estimate the value of the shunting capacitor. If the original cutoff frequency can be attributed to a small parasitic capacitor at the same internal node (i.e., between the node and ground), what would you estimate it to be?

D *1.75 A designer wishing to lower the overall upper 3-dB frequency of a three-stage amplifier to 10 kHz considers shunting one of two nodes: Node A, between the output of the first stage and the input of the second stage, and Node B, between the output of the second stage and the input of the third stage, to ground with a small capacitor. While measuring the overall frequency response of the amplifier, she connects a capacitor of 1 nF , first to node A and then to node B, lowering the 3-dB frequency from 3 MHz to 200 kHz and 20 kHz , respectively. If she knows that each amplifier stage has an input resistance of $100 \mathrm{k} \Omega$, what output resistance must the driving stage have at node A? At node B? What capacitor value should she connect to which node to solve her design problem most economically?

D 1.76 An amplifier with an input resistance of $100 \mathrm{k} \Omega$ and an output resistance of $1 \mathrm{k} \Omega$ is to be capacitor-coupled to a $10-\mathrm{k} \Omega$ source and a $1-\mathrm{k} \Omega$ load. Available capacitors have values only of the form $1 \times 10^{-4} \mathrm{~F}$. What are the values of the smallest capacitors needed to ensure that the corner frequency associated with each is less than 100 Hz ? What actual corner frequencies result? For the situation in which the basic amplifier has an open-circuit voltage gain $\left(A_{v o}\right)$ of $100 \mathrm{~V} / \mathrm{V}$, find an expression for $T(s)=V_{o}(s) / V_{s}(s)$.
*1.77 A voltage amplifier has the transfer function

$$
A_{v}=\frac{1000}{\left(1+j \frac{f}{10^{5}}\right)\left(1+\frac{10^{7}}{j f}\right)}
$$

Using the Bode plots for low-pass and high-pass STC networks (Figs. 1.23 and 1.24), sketch a Bode plot for $\left|A_{v}\right|$. Give approximate values for the gain magnitude at $f=10 \mathrm{~Hz}$, $10^{2} \mathrm{~Hz}, 10^{3} \mathrm{~Hz}, 10^{4} \mathrm{~Hz}, 10^{5} \mathrm{~Hz}, 10^{6} \mathrm{~Hz}, 10^{7} \mathrm{~Hz}$, and $10^{8} \mathrm{~Hz}$. Find the bandwidth of the amplifier (defined as the frequency range over which the gain remains within 3 dB of the maximum value).
*1.78 For the circuit shown in Fig. P1.78, first evaluate $T_{i}(s)=V_{i}(s) / V_{s}(s)$ and the corresponding cutoff (corner) frequency. Second, evaluate $T_{o}(s)=V_{o}(s) / V_{i}(s)$ and the corresponding cutoff frequency. Put each of the transfer functions in the standard form (see Table 1.2), and combine them to form the overall transfer function, $T(s)=T_{i}(s) \times$ $T_{o}(s)$. Provide a Bode magnitude plot for $|T(j \omega)|$. What is the bandwidth between 3-dB cutoff points?


Figure P1.78

[^0]
[^0]:    1.78 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
D **1.79 A transconductance amplifier having the equivalent circuit shown in Table 1.1 is fed with a voltage source $V_{s}$ having a source resistance $R_{s}$, and its output is connected to a load consisting of a resistance $R_{L}$ in parallel with a capacitance $C_{L}$. For given values of $R_{s}, R_{L}$, and $C_{L}$, it is required to specify the values of the amplifier parameters $R_{i}, G_{m}$, and $R_{o}$ to meet the following design constraints:
(a) At most, $x \%$ of the input signal is lost in coupling the signal source to the amplifier (i.e., $V_{i} \geq[1-(x / 100)] V_{s}$ ).
(b) The 3-dB frequency of the amplifier is equal to or greater than a specified value $f_{3 \mathrm{~dB}}$.
(c) The dc gain $V_{o} / V_{s}$ is equal to or greater than a specified value $A_{0}$.

Show that these constraints can be met by selecting

$$
\begin{aligned}
R_{i} & \geq\left(\frac{100}{x}-1\right) R_{s} \\
R_{o} & \leq \frac{1}{2 \pi f_{3 \mathrm{~dB}} C_{L}-\left(1 / R_{L}\right)} \\
G_{m} & \geq \frac{A_{0} /[1-(x / 100)]}{\left(R_{L} \| R_{o}\right)}
\end{aligned}
$$

Find $R_{i}, R_{o}$, and $G_{m}$ for $R_{s}=10 \mathrm{k} \Omega, x=10 \%, A_{0}=$ $100 \mathrm{~V} / \mathrm{V}, R_{L}=10 \mathrm{k} \Omega, C_{L}=20 \mathrm{pF}$, and $f_{3 \mathrm{~dB}}=2 \mathrm{MHz}$.
*1.80 Use the voltage-divider rule to find the transfer function $V_{o}(s) / V_{i}(s)$ of the circuit in Fig. P1.80. Show that the transfer function can be made independent of frequency if the condition $C_{1} R_{1}=C_{2} R_{2}$ applies. Under this condition
the circuit is called a compensated attenuator and is frequently employed in the design of oscilloscope probes. Find the transmission of the compensated attenuator in terms of $R_{1}$ and $R_{2}$.


Figure P1.80
*1.81 An amplifier with a frequency response of the type shown in Fig. 1.21 is specified to have a phase shift of magnitude no greater than $5.7^{\circ}$ over the amplifier bandwidth, which extends from 100 Hz to 1 kHz . It has been found that the gain falloff at the low-frequency end is determined by the response of a high-pass STC circuit and that at the high-frequency end it is determined by a low-pass STC circuit. What do you expect the corner frequencies of these two circuits to be? What is the drop in gain in decibels (relative to the maximum gain) at the two frequencies that define the amplifier bandwidth? What are the frequencies at which the drop in gain is 3 dB ? (Hint: Refer to Figs. 1.23 and 1.24.)
# CHAPTER 2 

## Operational Amplifiers

Introduction 59
2.1 The Ideal Op Amp 60
2.2 The Inverting Configuration 64
2.3 The Noninverting Configuration 73
2.4 Difference Amplifiers 77
2.5 Integrators and Differentiators 87
2.6 DC Imperfections 96
2.7 Effect of Finite Open-Loop Gain and Bandwidth on Circuit Performance 105
2.8 Large-Signal Operation of Op Amps 110

Summary 115
Problems 116
# IN THIS CHAPTER YOU WILL LEARN 

1. The terminal characteristics of the ideal op amp.
2. How to analyze circuits containing op amps, resistors, and capacitors.
3. How to use op amps to design amplifiers having precise characteristics.
4. How to design more sophisticated op-amp circuits, including summing amplifiers, instrumentation amplifiers, integrators, and differentiators.
5. Important nonideal characteristics of op amps and how these limit the performance of basic op-amp circuits.

## Introduction

Having learned basic amplifier concepts and terminology, we are now ready to undertake the study of a circuit building block of universal importance: the operational amplifier (op amp). Op amps have been in use for a long time, their initial applications being primarily in the areas of analog computation and sophisticated instrumentation. Early op amps were constructed from discrete components (vacuum tubes and then transistors, and resistors), and their cost was prohibitively high (tens of dollars). In the mid-1960s the first integrated-circuit (IC) op amp was produced. This unit (the $\mu \mathrm{A} 709$ ) was made up of a relatively large number of transistors and resistors all on the same silicon chip. Although its characteristics were poor (by today's standards) and its price was still quite high, its appearance signaled a new era in electronic circuit design. Electronics engineers started using op amps in large quantities, which caused their price to drop dramatically. They also demanded better-quality op amps. Semiconductor manufacturers responded quickly, and within the span of a few years, high-quality op amps became available at extremely low prices (tens of cents) from a large number of suppliers.

One of the reasons for the popularity of the op amp is its versatility. As we will shortly see, one can do almost anything with op amps! Equally important is the fact that the IC op amp has characteristics that closely approach the assumed ideal. This implies that it is quite easy to design circuits using the IC op amp. Also, op-amp circuits work at performance levels that are quite close to those predicted theoretically. It is for this reason that we are studying op amps at this early stage. It is expected that by the end of this chapter the reader should be able to successfully design nontrivial circuits using op amps.

As already implied, an IC op amp is made up of a large number (about 20) of transistors together with resistors, and (usually) one capacitor connected in a rather complex circuit. Since
we have not yet studied transistor circuits, the circuit inside the op amp will not be discussed in this chapter. Rather, we will treat the op amp as a circuit building block and study its terminal characteristics and its applications. This approach is quite satisfactory in many op-amp applications. Nevertheless, for the more difficult and demanding applications it is quite useful to know what is inside the op-amp package. This topic will be studied in Chapter 13. More advanced applications of op amps will appear in later chapters.

# 2.1 The Ideal Op Amp 

### 2.1.1 The Op-Amp Terminals

From a signal point of view the op amp has three terminals: two input terminals and one output terminal. Figure 2.1 shows the symbol we shall use to represent the op amp. Terminals 1 and 2 are input terminals, and terminal 3 is the output terminal. As explained in Section 1.4, amplifiers require dc power to operate. Most IC op amps require two dc power supplies, as shown in Fig. 2.2. Two terminals, 4 and 5, are brought out of the op-amp package and connected to a positive voltage $V_{C C}$ and a negative voltage $-V_{E E}$, respectively. In Fig. 2.2(b) we explicitly show the two dc power supplies as batteries with a common ground. It is interesting to note that the reference grounding point in op-amp circuits is just the common terminal of the two power supplies; that is, no terminal of the op-amp package is physically connected to ground. In what follows we will not, for simplicity, explicitly show the op-amp power supplies.


Figure 2.1 Circuit symbol for the op amp.


Figure 2.2 The op amp shown connected to dc power supplies.
In addition to the three signal terminals and the two power-supply terminals, an op amp may have other terminals for specific purposes. These other terminals can include terminals for frequency compensation and terminals for offset nulling; both functions will be explained in later sections.

# EXERCISE 

2.1 What is the minimum number of terminals required by a single op amp? What is the minimum number of terminals required on an integrated-circuit package containing four op amps (called a quad op amp)? Ans. 5; 14

### 2.1.2 Function and Characteristics of the Ideal Op Amp

We now consider the circuit function of the op amp. The op amp is designed to sense the difference between the voltage signals applied at its two input terminals (i.e., the quantity $v_{2}-v_{1}$ ), multiply this by a number $A$, and cause the resulting voltage $A\left(v_{2}-v_{1}\right)$ to appear at output terminal 3. Thus $v_{3}=A\left(v_{2}-v_{1}\right)$. Here it should be emphasized that when we talk about the voltage at a terminal we mean the voltage between that terminal and ground; thus $v_{1}$ means the voltage applied between terminal 1 and ground.

The ideal op amp is not supposed to draw any input current; that is, the signal current into terminal 1 and the signal current into terminal 2 are both zero. In other words, the input impedance of an ideal op amp is supposed to be infinite.

How about the output terminal 3? This terminal is supposed to act as the output terminal of an ideal voltage source. That is, the voltage between terminal 3 and ground will always be equal to $A\left(v_{2}-v_{1}\right)$, independent of the current that may be drawn from terminal 3 into a load impedance. In other words, the output impedance of an ideal op amp is supposed to be zero.

Putting together all of the above, we arrive at the equivalent circuit model shown in Fig. 2.3. Note that the output is in phase with (has the same sign as) $v_{2}$ and is out of phase with (has the opposite sign of) $v_{1}$. For this reason, input terminal 1 is called the inverting input terminal and is distinguished by a " - " sign, while input terminal 2 is called the noninverting input terminal and is distinguished by a " + " sign.

As can be seen from the above description, the op amp responds only to the difference signal $v_{2}-v_{1}$ and hence ignores any signal common to both inputs. That is, if $v_{1}=v_{2}=1 \mathrm{~V}$, then the output will (ideally) be zero. We call this property common-mode rejection, and we conclude that an ideal op amp has zero common-mode gain or, equivalently, infinite common-mode rejection. We will have more to say about this point later. For the time being note that the op amp is a differential-input, single-ended-output amplifier, with the latter term referring to the fact that the output appears between terminal 3 and ground. ${ }^{1}$

[^0]
[^0]:    ${ }^{1}$ Some op amps are designed to have differential outputs. This topic will not be discussed in this book. Rather, we confine ourselves here to single-ended-output op amps, which constitute the vast majority of commercially available op amps.# Example 10.13 continued 

and estimate the 3-dB frequency, $f_{H}$. Compare the results with those obtained with a CE amplifier operating under the same conditions. For simplicity, neglect $r_{o}$ and $r_{s}$.

## Solution

At an emitter bias current of $1 \mathrm{~mA}, Q_{1}$ and $Q_{2}$ have

$$
\begin{aligned}
g_{m} & =40 \mathrm{~mA} / \mathrm{V} \\
r_{e} & =25 \Omega \\
r_{\pi} & =\frac{\beta}{g_{m}}=\frac{100}{40}=2.5 \mathrm{k} \Omega \\
C_{\pi}+C_{\mu} & =\frac{g_{m}}{\omega_{T}}=\frac{g_{m}}{2 \pi f_{T}} \\
& =\frac{40 \times 10^{-3}}{2 \pi \times 400 \times 10^{6}}=15.9 \mathrm{pF} \\
C_{\mu} & =2 \mathrm{pF} \\
C_{\pi} & =13.9 \mathrm{pF}
\end{aligned}
$$

The voltage gain $A_{M}$ can be determined from the circuit shown in Fig. 10.40(a) as follows:

$$
\begin{aligned}
R_{\mathrm{in} 2} & =r_{\pi 2}=2.5 \mathrm{k} \Omega \\
R_{\mathrm{in}} & =\left(\beta_{1}+1\right)\left(r_{e 1}+R_{\mathrm{in} 2}\right) \\
& =101(0.025+2.5)=255 \mathrm{k} \Omega \\
\frac{V_{\mathrm{b} 1}}{V_{\text {sig }}} & =\frac{R_{\mathrm{in}}}{R_{\mathrm{in}}+R_{\text {sig }}}=\frac{255}{255+4}=0.98 \mathrm{~V} / \mathrm{V} \\
\frac{V_{\mathrm{b} 2}}{V_{\mathrm{b} 1}} & =\frac{R_{\mathrm{in} 2}}{R_{\mathrm{in} 2}+r_{e 1}}=\frac{2.5}{2.5+0.025}=0.99 \mathrm{~V} / \mathrm{V} \\
\frac{V_{\mathrm{o}}}{V_{\mathrm{b} 2}} & =-g_{m 2} R_{L}=-40 \times 4=-160 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

Thus,

$$
A_{M}=\frac{V_{o}}{V_{\text {sig }}}=-160 \times 0.99 \times 0.98=-155 \mathrm{~V} / \mathrm{V}
$$

To determine $f_{H}$ we use the method of open-circuit time constants. Figure 10.40(b) shows the circuit with $V_{\text {sig }}$ set to zero and the four capacitances indicated. Capacitance $C_{\mu 1}$ sees a resistance $R_{\mu 1}$,

$$
\begin{aligned}
R_{\mu 1} & =R_{\text {sig }} \| R_{\text {in }} \\
& =4 \| 255=3.94 \mathrm{k} \Omega
\end{aligned}
$$

(b)

(c)

Figure 10.40 Circuits for Example 10.14: (a) the CC-CE circuit prepared for low-frequency, small-signal analysis; (b) the circuit at high frequencies, with $V_{\text {sig }}$ set to zero to enable determination of the open-circuit time constants; (c) equivalent circuit for the determination of $R_{\pi 1}$; (d) a CE amplifier for comparison.
Example 10.13 continued


Figure 10.40 continued

To find the resistance $R_{\pi 1}$ seen by capacitance $C_{\pi 1}$ we refer to the equivalent circuit in Fig. 10.40(c). Analysis of this circuit results in

$$
\begin{aligned}
R_{\pi 1} \equiv \frac{V_{s}}{I_{s}} & =\frac{R_{\text {sig }}+R_{\text {int }}}{1+\frac{R_{\text {sig }}}{r_{\pi 1}}+\frac{R_{\text {int }}}{r_{e 1}}} \\
& =\frac{4000+2500}{1+\frac{4000}{2500}+\frac{2500}{25}}=63.4 \Omega
\end{aligned}
$$

Capacitance $C_{\pi 2}$ sees a resistance $R_{\pi 2}$,

$$
\begin{aligned}
R_{\pi 2} & =R_{\text {in } 2} \| R_{\text {out } 1} \\
& =r_{\pi 2} \|\left[r_{e 1}+\frac{R_{\text {sig }}}{\beta_{1}+1}\right] \\
& =2500 \|\left[25+\frac{4000}{101}\right]=63 \Omega
\end{aligned}
$$

Capacitance $C_{\mu 2}$ sees a resistance $R_{\mu 2}$. To determine $R_{\mu 2}$ we refer to the analysis of the frequency response of the CE amplifier in Section 10.4.4 to obtain

$$
\begin{aligned}
R_{\mu 2} & =\left(1+g_{m 2} R_{L}\right)\left(R_{\text {in } 2} \| R_{\text {out } 1}\right)+R_{L} \\
& =(1+40 \times 4)\left[2500 \|\left(25+\frac{4000}{101}\right)\right]+4000 \\
& =14,143 \Omega \simeq 14.1 \mathrm{k} \Omega
\end{aligned}
$$
We now can determine $\tau_{H}$ from

$$
\begin{aligned}
\tau_{H} & =C_{\mu 1} R_{\mu 1}+C_{\pi 1} R_{\pi 1}+C_{\mu 2} R_{\mu 2}+C_{\pi 2} R_{\pi 2} \\
& =2 \times 3.94+13.9 \times 0.0634+2 \times 14.1+13.9 \times 0.063 \\
& =7.88+0.88+28.2+0.88=37.8 \mathrm{~ns}
\end{aligned}
$$

We observe that $C_{\pi 1}$ and $C_{\pi 2}$ play minor roles in determining the high-frequency response. As expected, $C_{\mu 2}$ through the Miller effect plays the most significant role. Capacitor $C_{\mu 1}$, which interacts directly with $\left(R_{\text {sig }} \| R_{i u}\right)$, also plays an important role. The 3-dB frequency $f_{H}$ can be found as follows:

$$
f_{H}=\frac{1}{2 \pi \tau_{H}}=\frac{1}{2 \pi \times 37.8 \times 10^{-9}}=4.2 \mathrm{MHz}
$$

For comparison, we evaluate $A_{M}$ and $f_{H}$ of a CE amplifier operating under the same conditions. Refer to Fig. 10.40(d). The voltage gain $A_{M}$ is given by

$$
\begin{aligned}
A_{M} & =\frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}}\left(-g_{m} R_{L}\right) \\
& =\frac{r_{\pi}}{r_{\pi}+R_{\text {sig }}}\left(-g_{m} R_{L}\right) \\
& =\frac{2.5}{2.5+4}(-40 \times 4) \\
& =-61.5 \mathrm{~V} / \mathrm{V} \\
R_{\pi} & =r_{\pi} \| R_{\text {sig }}=2.5\|4=1.54 \mathrm{k} \Omega \\
R_{\mu} & =\left(1+g_{m} R_{L}\right)\left(R_{\text {sig }} \| r_{\pi}\right)+R_{L} \\
& =(1+40 \times 4)(4\|2.5)+4 \\
& =251.7 \mathrm{k} \Omega
\end{aligned}
$$

Thus,

$$
\begin{aligned}
\tau_{H} & =C_{\pi} R_{\pi}+C_{\mu} R_{\mu} \\
& =13.9 \times 1.54+2 \times 251.7 \\
& =21.4+503.4=524.8 \mathrm{~ns}
\end{aligned}
$$

Observe the dominant role played by $C_{\mu}$. The 3-dB frequency $f_{H}$ is

$$
f_{H}=\frac{1}{2 \pi \tau_{H}}=\frac{1}{2 \pi \times 524.8 \times 10^{-9}}=303 \mathrm{kHz}
$$

Thus, including the buffering transistor $Q_{1}$ increases the gain, $\left|A_{M}\right|$, from $61.5 \mathrm{~V} / \mathrm{V}$ to $155 \mathrm{~V} / \mathrm{V}$-a factor of 2.5 -and increases the bandwidth from 303 kHz to 4.2 MHz -a factor of 13.9 ! The gain-bandwidth product is increased from 18.63 MHz to 651 MHz -a factor of 35 !
# 10.8.3 The CC-CB and CD-CG Configurations 

In Section 8.7.3 we showed that preceding a CB or CG transistor with a buffer implemented with a CC or a CD transistor solves the low-input-resistance problem of the CB and CG amplifiers. Examples of the resulting compound-transistor amplifiers are shown in Fig. 10.41. Since in each of these circuits, neither of the two transistors suffers from the Miller effect, the resulting amplifiers have even wider bandwidths than those achieved in the compound amplifier stages of the last section. To illustrate, consider as an example the circuit in Fig. 10.41(a). ${ }^{10}$ The low-frequency analysis of this circuit in Section 8.7.3 provides for the input resistance,

$$
R_{\mathrm{in}}=\left(\beta_{1}+1\right)\left(r_{e 1}+r_{e 2}\right)
$$

which for $r_{e 1}=r_{e 2}=r_{e}$ and $\beta_{1}=\beta_{2}=\beta$ becomes

$$
R_{\mathrm{in}}=2 r_{\pi}
$$

If a load resistance $R_{L}$ is connected at the output, the voltage gain $V_{o} / V_{i}$ will be

$$
\frac{V_{o}}{V_{i}}=\frac{\alpha_{2} R_{L}}{r_{e 1}+r_{e 2}}=\frac{1}{2} g_{m} R_{L}
$$

Now, if the amplifier is fed with a voltage signal $V_{\text {sig }}$ from a source with a resistance $R_{\text {sig }}$, the overall voltage gain will be

$$
\frac{V_{o}}{V_{\text {sig }}}=\frac{1}{2}\left(\frac{R_{\text {in }}}{R_{\text {in }}+R_{\text {sig }}}\right)\left(g_{m} R_{L}\right)
$$

The high-frequency analysis is illustrated in Fig. 10.42(a). Here we have drawn the hybrid- $\pi$ equivalent circuit for each of $Q_{1}$ and $Q_{2}$. Recalling that the two transistors are operating at equal bias currents, their corresponding model components will be equal (i.e., $r_{\pi 1}=r_{\pi 2}, C_{\pi 1}=C_{\pi 2}$, etc.). With this in mind the reader should be able to see that $V_{\pi 1}=-V_{\pi 2}$ and the horizontal line through the node labeled E in Fig. 10.42(a) can be deleted. Thus the circuit reduces to that in Fig. 10.42(b). This is a very attractive outcome because the circuit shows clearly the two poles that determine the high-frequency response: The pole at the input, with a frequency $f_{P 1}$, is

$$
f_{P 1}=\frac{1}{2 \pi\left(\frac{C_{\pi}}{2}+C_{\mu}\right)\left(R_{\text {sig }} \| 2 r_{\pi}\right)}
$$

and the pole at the output, with a frequency $f_{P 2}$, is

$$
f_{P 2}=\frac{1}{2 \pi C_{\mu} R_{L}}
$$

This result is also intuitively obvious: The input impedance at $B_{1}$ of the circuit in Fig. 10.42(a) consists of the series connection of $r_{\pi 1}$ and $r_{\pi 2}$ in parallel with the series connection of $C_{\pi 1}$ and $C_{\pi 2}$. Then there is $C_{\mu 1}$ in parallel. At the output, we simply have $R_{L}$ in parallel with $C_{\mu}$.

[^0]
[^0]:    ${ }^{10}$ The results derived for the circuit in Fig. 10.41(a) apply directly to the circuit of Fig. 10.41(b) and with appropriate change of variables to the MOS circuit of Fig. 10.41(c).

(a)

(b)

(c)

Figure 10.41 (a) A CC-CB amplifier. (b) Another version of the CC-CB circuit with $Q_{2}$ implemented using a pnp transistor. (c) The MOSFET version of the circuit in (a).

(a)

(b)

Figure 10.42 (a) Equivalent circuit for the amplifier in Fig. 10.41(a). (b) Simplified equivalent circuit. Note that the equivalent circuits in (a) and (b) also apply to the circuit shown in Fig. 10.41(b). In addition, they can be easily adapted for the MOSFET circuit in Fig. 10.41(c), with $2 r_{\pi}$ eliminated, $C_{\pi}$ replaced with $C_{g_{1}}, C_{\mu}$ replaced with $C_{g d}$, and $V_{\pi}$ replaced with $V_{g s}$.
Whether one of the two poles is dominant will depend on the relative values of $R_{\text {sig }}$ and $R_{L}$. If the two poles are close to each other, then the $3-\mathrm{dB}$ frequency $f_{H}$ can be determined either by exact analysis-that is, finding the frequency at which the gain is down by 3 dB -or by using the approximate formula in Eq. (10.77),

$$
f_{H} \simeq 1 / \sqrt{\frac{1}{f_{P 1}^{2}}+\frac{1}{f_{P 2}^{2}}}
$$

# EXERCISE 

10.30 For the CC-CB amplifier of Fig. 10.41(a), let $I=0.5 \mathrm{~mA}, \beta=100, C_{\pi}=6 \mathrm{pF}, C_{\mu}=2 \mathrm{pF}, R_{\text {sig }}=$ $10 \mathrm{k} \Omega$, and $R_{L}=10 \mathrm{k} \Omega$. Find the low-frequency overall voltage gain $A_{M}$, the frequencies of the poles, and the 3-dB frequency $f_{H}$. Find $f_{H}$ both exactly and using the approximate formula in Eq. (10.164). Ans. $50 \mathrm{~V} / \mathrm{V} ; 6.4 \mathrm{MHz}$ and $8 \mathrm{MHz} ; f_{H}$ by exact evaluation $=4.6 \mathrm{MHz} ; f_{H}$ using Eq. $(10.164)=$ 5 MHz .

## Summary

- The coupling and bypass capacitors utilized in discrete-circuit amplifiers cause the amplifier gain to fall off at low frequencies. In the CS amplifier, the capacitors do not interact, and the frequencies of the low-frequency poles can be estimated by considering each of these capacitors separately and determining the resistance seen by the capacitor. The highest-frequency pole is the one that determines the lower 3-dB frequency $f_{L}$. In the CE amplifier, the capacitors interact, and thus the poles cannot be easily determined. Rather the method of short-circuit time constants can be used to obtain an estimate of the $3-\mathrm{dB}$ frequency, $f_{L}$.
- Both the MOSFET and the BJT have internal capacitive effects that can be modeled by augmenting the device hybrid- $\pi$ model with capacitances. Usually at least two capacitances are needed: $C_{g s}$ and $C_{g d}\left(C_{\pi}\right.$ and $C_{\mu}$ for the BJT). A figure of merit for the high-frequency operation of the transistor is the frequency $f_{T}$ at which the short-circuit current gain of the CS (CE) transistor reduces to unity. For the MOSFET, $f_{T}=g_{m} / 2 \pi\left(C_{g s}+C_{g d}\right)$, and for the BJT, $f_{T}=g_{m} / 2 \pi\left(C_{\pi}+C_{\mu}\right)$.
- The internal capacitances of the MOSFET and the BJT cause the amplifier gain to fall off at high frequencies. An estimate of the amplifier bandwidth is provided by the frequency $f_{H}$ at which the gain drops 3 dB below its value at midband, $A_{M}$. A figure of merit for the amplifier is the gain-bandwidth product $G B=A_{M} f_{H}$. Usually, it
is possible to trade off gain for increased bandwidth, with $G B$ remaining nearly constant. For amplifiers with a dominant pole with frequency $f_{H}$, the gain falls off at a uniform $6-\mathrm{dB} /$ octave ( $20-\mathrm{dB} /$ decade) rate, reaching 0 dB at $f_{i}=G B$.
- The high-frequency response of the CS and CE amplifiers is severely limited by the Miller effect: The small capacitance $C_{g d}\left(C_{\mu}\right)$ is multiplied by a factor approximately equal to the gain from gate to drain (base to collector) $g_{m} R_{L}^{\prime}$ and thus gives rise to a large capacitance at the amplifier input. The increased $C_{i n}$ interacts with the effective signal-source resistance $R_{\text {sig }}^{\prime}$ and causes the amplifier gain to have a 3-dB frequency $f_{H}=1 / 2 \pi R_{\text {sig }}^{\prime} C_{\text {in }}$.
- The method of open-circuit time constants provides a simple and powerful way to obtain a reasonably good estimate of the upper 3-dB frequency $f_{H}$. The capacitors that limit the high-frequency response are considered one at time with $V_{\text {sig }}=0$ and all the other capacitances set to zero (open circuited). The resistance seen by each capacitance is determined, and the overall time constant $\tau_{H}$ is obtained by summing the individual time constants. Then $f_{H}$ is found as $1 / 2 \pi \tau_{H}$.
- The CG and CB amplifiers do not suffer from the Miller effect. Thus the cascode amplifier, which consists of a cascade of CS and CG stages (CE and CB stages), can be designed to obtain wider bandwidth than that achieved
in the CS (CE) amplifier alone. The key, however, is to design the cascode so that the gain obtained in the CS (CE) stage is minimized.

- The source and emitter followers can have complex poles. Thus, their frequency response is evaluated using the complete transfer function. Followers of both types exhibit wide bandwidths.
- The high-frequency response of the differential amplifier can be obtained by considering the differential and common-mode half-circuits. The CMRR falls off at
a relatively low frequency determined by the output impedance of the bias current source.
- The high-frequency response of the current-mirror-loaded differential amplifier is complicated by the fact that there are two signal paths between input and output: a direct path and one through the current mirror.
- Combining two transistors in a way that eliminates or minimizes the Miller effect can result in a much wider bandwidth. Some such configurations are presented in Section 10.8 .


## Computer Simulation Problems

10.1 Problems identified by the Multisim/PSpice icon are intended to demonstrate the value of using SPICE simulation to verify hand analysis and design, and to investigate important issues such as gain-bandwidth trade-off. Instructions to assist in setting up PSpice and Multisim simulations for all the indicated problems can be found in the corresponding files on the website. Note that if a particular parameter value is not specified in the problem statement, you are to make a reasonable assumption.

## Section 10.1: Low-Frequency Response of Discrete-Circuit Common-Source and Common-Emitter Amplifiers

D 10.1 For the amplifier in Fig. 10.3(a), if $R_{G 1}=2 \mathrm{M} \Omega$, $R_{G 2}=1 \mathrm{M} \Omega$, and $R_{s i g}=200 \mathrm{k} \Omega$, find the value of the coupling capacitor $C_{C 1}$ (specified to one significant digit) that places the associated pole at 10 Hz or lower.

D 10.2 For the amplifier in Fig. 10.3(a), if $R_{D}=10 \mathrm{k} \Omega$, $R_{L}=10 \mathrm{k} \Omega$, and $r_{o}$ is very large, find the value of $C_{C 2}$ (specified to one significant digit) that places the associated pole at 10 Hz or lower.

D 10.3 The amplifier in Fig. 10.3(a) is biased to operate at $g_{m}=5 \mathrm{~mA} / \mathrm{V}$, and $R_{S}=1.8 \mathrm{k} \Omega$. Find the value of $C_{S}$ (specified to one significant digit) that places its associated pole at 100 Hz or lower. What are the actual frequencies of the pole and zero realized?
10.4 The amplifier in Fig. 10.3(a) is biased to operate at $g_{m}=5 \mathrm{~mA} / \mathrm{V}$, and has the following component values: $R_{s i g}=100 \mathrm{k} \Omega, R_{G 1}=47 \mathrm{M} \Omega, R_{G 2}=10 \mathrm{M} \Omega, C_{C 1}=0.01 \mu \mathrm{~F}$, $R_{S}=2 \mathrm{k} \Omega, C_{S}=10 \mu \mathrm{~F}, R_{D}=4.7 \mathrm{k} \Omega, R_{L}=10 \mathrm{k} \Omega$, and $C_{C 2}=1 \mu \mathrm{~F}$. Find $A_{M}, f_{P 1}, f_{P 2}, f_{Z}, f_{P 3}$, and $f_{L}$.

D 10.5 The amplifier in Fig. P10.5 is biased to operate at $g_{m}=2 \mathrm{~mA} / \mathrm{V}$. Neglect $r_{o}$.


Figure P10.5
(a) Determine the value of $R_{D}$ that results in a midband gain of -20 V/V.
(b) Determine the value of $C_{S}$ that results in a pole frequency of 100 Hz .
(c) What is the frequency of the transmission zero introduced by $C_{S}$ ?
(d) Give an approximate value for the 3-dB frequency $f_{L}$.

[^0]
[^0]:    10.1 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
(e) Sketch a Bode plot for the gain of this amplifier. What does the plot tell you about the gain at dc? Does this make sense? Why or why not?

D 10.6 Figure P10.6 shows a CS amplifier biased by a constant-current source $I$. Let $R_{\text {sig }}=0.5 \mathrm{M} \Omega, R_{G}=2 \mathrm{M} \Omega$, $g_{m}=3 \mathrm{~mA} / \mathrm{V}, R_{D}=20 \mathrm{k} \Omega$, and $R_{L}=10 \mathrm{k} \Omega$. Find $A_{M}$. Also,
design the coupling and bypass capacitors to locate the three low-frequency poles at $100 \mathrm{~Hz}, 10 \mathrm{~Hz}$, and 1 Hz . Use a minimum total capacitance, with the capacitors specified only to a single significant digit. What value of $f_{L}$ results?

D 10.7 Figure P10.7 shows a current-biased CE amplifier operating at $100 \mu \mathrm{~A}$ from $\pm 3-\mathrm{V}$ power supplies. It employs


Figure P10.6


Figure P10.7

[^0]
[^0]:    318 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
$R_{C}=20 \mathrm{k} \Omega, R_{B}=200 \mathrm{k} \Omega$, and operates between a $20-\mathrm{k} \Omega$ source and a $10-\mathrm{k} \Omega$ load. The transistor $\beta=100$. Select $C_{E}$ first, for a minimum value specified to one significant digit and providing up to $80 \%$ of $f_{L}$ where $f_{L}$ is to be 100 Hz . Then choose $C_{C 1}$ and $C_{C 2}$, each specified to one significant digit, and each contributing about $10 \%$ of $f_{L}$. What $f_{L}$ results? What total capacitance is needed?
10.8 Consider the common-emitter amplifier of Fig. 10.9(a) under the following conditions: $R_{\text {sig }}=5 \mathrm{k} \Omega, R_{B 1}=33 \mathrm{k} \Omega$, $R_{B 2}=22 \mathrm{k} \Omega, \quad R_{E}=3.9 \mathrm{k} \Omega, \quad R_{C}=4.7 \mathrm{k} \Omega, \quad R_{L}=5.6 \mathrm{k} \Omega$, $V_{C C}=5 \mathrm{~V}$. The dc emitter current can be shown to be $I_{E} \simeq 0.3 \mathrm{~mA}$, at which $\beta=120$. Find the input resistance $R_{\mathrm{in}}$ and the midband gain $A_{M}$. If $C_{C 1}=C_{C 2}=1 \mu \mathrm{~F}$ and $C_{E}=20 \mu \mathrm{~F}$, find the three short-circuit time constants and an estimate for $f_{L}$.
D 10.9 For the amplifier described in Problem 10.8, design the coupling and bypass capacitors for a lower 3-dB frequency of 50 Hz . Design so that the contribution of each of $C_{C 1}$ and $C_{C 2}$ to determining $f_{L}$ is only $10 \%$.
10.10 Consider the circuit of Fig. 10.9(a). For $R_{\text {sig }}=5 \mathrm{k} \Omega$, $R_{B} \equiv R_{B 1} \| R_{B 2}=10 \mathrm{k} \Omega, \quad r_{n}=1 \mathrm{k} \Omega, \quad \beta_{0}=100$, and $R_{E}=1.5 \mathrm{k} \Omega$, what is the ratio $C_{E} / C_{C 1}$ that makes their contributions to the determination of $f_{L}$ equal?
D *10.11 For the common-emitter amplifier of Fig. P10.11, neglect $r_{o}$ and assume the current source to be ideal.


Figure P10.11
(a) Derive an expression for the midband gain.
(b) Convince yourself that the two poles caused by $C_{E}$ and $C_{C}$ do not interact. Find expressions for their frequencies, $\omega_{P E}$ and $\omega_{P C}$.
(c) Give an expression for the amplifier voltage gain $V_{o}(s) / V_{\text {sig }}(s)$ in terms of $A_{M}, \omega_{P E}$, and $\omega_{P C}$.
(d) For $R_{\text {sig }}=R_{C}=R_{L}=10 \mathrm{k} \Omega, \beta=100$, and $I=1 \mathrm{~mA}$, find the value of the midband gain.
(e) Select values for $C_{E}$ and $C_{C}$ to place the two pole frequencies a decade apart and to obtain a lower 3-dB frequency of 100 Hz while minimizing the total capacitance.
(f) Sketch a Bode plot for the gain magnitude, and estimate the frequency at which the gain becomes unity.
*10.12 The BJT common-emitter amplifier of Fig. P10.12 includes an emitter-degeneration resistance $R_{e}$.


Figure P10.12
(a) Assuming $\alpha \simeq 1$, neglecting $r_{o}$, and assuming the current source to be ideal, derive an expression for the small-signal voltage gain $A(s) \equiv V_{o} / V_{\text {sig }}$ that applies in the midband and the low-frequency band. Hence find the midband gain $A_{M}$ and the lower 3-dB frequency $f_{L}$.(b) Show that including $R_{e}$ reduces the magnitude of $A_{M}$ by a certain factor. What is this factor?
(c) Show that including $R_{e}$ reduces $f_{L}$ by the same factor as in (b) and thus one can use $R_{e}$ to trade off gain for bandwidth.
(d) For $I=0.25 \mathrm{~mA}, R_{C}=10 \mathrm{k} \Omega$, and $C_{E}=10 \mu \mathrm{~F}$, find $\left|A_{M}\right|$ and $f_{L}$ with $R_{e}=0$. Now find the value of $R_{e}$ that lowers $f_{L}$ by a factor of 10 . What will the gain become? Sketch on the same diagram a Bode plot for the gain magnitude for both cases.

## Section 10.2: Internal Capacitive Effects and the High-Frequency Model of the MOSFET and the BJT

10.13 Refer to the MOSFET high-frequency model in Fig. 10.12(a). Evaluate the model parameters for an NMOS transistor operating at $I_{D}=200 \mu \mathrm{~A}, V_{E B}=1 \mathrm{~V}$, and $V_{D S}=1.5 \mathrm{~V}$. The MOSFET has $W=20 \mu \mathrm{~m}, L=1 \mu \mathrm{~m}$, $t_{o s}=8 \mathrm{~nm}, \mu_{n}=450 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}, \gamma=0.5 \mathrm{~V}^{1 / 2}, 2 \phi_{f}=0.65 \mathrm{~V}$, $\lambda=0.05 \mathrm{~V}^{-1}, V_{0}=0.7 \mathrm{~V}, C_{s b 0}=C_{d b 0}=20 \mathrm{fF}$, and $L_{o v}=0.05 \mu \mathrm{~m}$. [Recall that $g_{m b}=\chi g_{m}$, where $\chi=$ $\gamma /\left(2 \sqrt{2 \phi_{f}+V_{S B}}\right)$, and that $\epsilon_{o s}=3.45 \times 10^{-11} \mathrm{~F} / \mathrm{m}$.]
10.14 Find $f_{T}$ for a MOSFET operating at $I_{D}=200 \mu \mathrm{~A}$ and $V_{O V}=0.3 \mathrm{~V}$. The MOSFET has $C_{g s}=25 \mathrm{fF}$ and $C_{g d}=5 \mathrm{fF}$.
10.15 Starting from the expression of $f_{T}$ for a MOSFET,

$$
f_{T}=\frac{g_{m}}{2 \pi\left(C_{g s}+C_{g d}\right)}
$$

and making the approximation that $C_{g s} \gg C_{g d}$ and that the overlap component of $C_{g s}$ is negligibly small, show that

$$
f_{T} \simeq \frac{1.5}{\pi L} \sqrt{\frac{\mu_{n} I_{D}}{2 C_{o s} W L}}
$$

Thus note that to obtain a high $f_{T}$ from a given device, it must be operated at a high current. Also note that faster operation is obtained from smaller devices.
10.16 Starting from the expression for the MOSFET unity-gain frequency,

$$
f_{T}=\frac{g_{m}}{2 \pi\left(C_{g s}+C_{g d}\right)}
$$

and making the approximation that $C_{g s} \gg C_{g d}$ and that the overlap component of $C_{g s}$ is negligibly small, show that for an $n$-channel device

$$
f_{T} \simeq \frac{3 \mu_{n} V_{O V}}{4 \pi L^{2}}
$$

Observe that for a given channel length, $f_{T}$ can be increased by operating the MOSFET at a higher overdrive voltage. Evaluate $f_{T}$ for devices with $L=0.5 \mu \mathrm{~m}$ operated at overdrive voltages of 0.2 V and 0.4 V . Use $\mu_{n}=450 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$.
10.17 It is required to calculate the intrinsic gain $A_{0}$ and the unity-gain frequency $f_{T}$ of an $n$-channel transistor fabricated in a $0.13-\mu \mathrm{m}$ CMOS process for which $L_{o v}=0.1 L, \mu_{n}=$ $400 \mathrm{~cm}^{2} / \mathrm{V} \cdot \mathrm{s}$, and $V_{A}^{\prime}=5 \mathrm{~V} / \mu \mathrm{m}$. The device is operated at $V_{O V}=0.2 \mathrm{~V}$. Find $A_{0}$ and $f_{T}$ for devices with $L=L_{\text {min }}$, $2 L_{\text {min }}, 3 L_{\text {min }}, 4 L_{\text {min }}$, and $5 L_{\text {min }}$. Present your results in a table. (Hint: For $f_{T}$, use the approximate expression $f_{T} \simeq \frac{3 \mu_{n} V_{O V}}{4 \pi L^{2}}$.)
10.18 A particular BJT operating at $I_{C}=0.5 \mathrm{~mA}$ has $C_{\mu}=$ $1 \mathrm{pF}, C_{\pi}=8 \mathrm{pF}$, and $\beta=100$. What are $f_{T}$ and $f_{p}$ for this situation?
10.19 For the transistor described in Problem 10.18, $C_{\pi}$ includes a relatively constant depletion-layer capacitance

| Transistor | $I_{E}(\mathrm{~mA})$ | $r_{e}(\Omega)$ | $g_{m}(\mathrm{~mA} / \mathrm{V})$ | $r_{e}(\mathrm{k} \Omega)$ | $\beta_{0}$ | $f_{T}(\mathrm{MHz})$ | $C_{e}(\mathrm{pF})$ | $C_{e}(\mathrm{pF})$ | $f_{p}(\mathrm{MHz})$ |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| (a) | 2 |  |  |  | 100 | 500 | 2 |  |  |
| (b) |  | 25 |  |  |  |  | 2 | 10.7 | 4 |
| (c) |  |  |  | 2.5 | 100 | 500 |  | 10.7 |  |
| (d) | 10 |  |  |  | 100 | 500 | 2 |  |  |
| (e) | 0.1 |  |  |  | 100 | 150 | 2 |  |  |
| (f) | 1 |  |  |  | 10 | 500 | 2 |  |  |
| (g) |  |  |  |  |  | 800 | 1 | 9 | 80 |

[^0]
[^0]:    118 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
of 2 pF . If the device is operated at $I_{C}=0.25 \mathrm{~mA}$, what does its $f_{T}$ become?
10.20 An npn transistor is operated at $I_{C}=1 \mathrm{~mA}$ and $V_{C B}=2 \mathrm{~V}$. It has $\beta_{0}=100, V_{A}=50 \mathrm{~V}, \tau_{F}=30 \mathrm{ps}$, $C_{p 0}=20 \mathrm{fF}, C_{p 0}=30 \mathrm{fF}, V_{0 s}=0.75 \mathrm{~V}, m_{C B J}=0.5$, and $r_{s}=100 \Omega$. Sketch the complete hybrid- $\pi$ model, and specify the values of all its components. Also, find $f_{T}$.
10.21 Measurement of $h_{f e}$ of an $n p n$ transistor at 50 MHz shows that $\left|h_{f e}\right|=10$ at $I_{C}=0.2 \mathrm{~mA}$ and 12 at $I_{C}=1.0 \mathrm{~mA}$. Furthermore, $C_{o}$ was measured and found to be 0.1 pF . Find $f_{T}$ at each of the two collector currents used. What must $\tau_{F}$ and $C_{p}$, be?
10.22 A particular small-geometry BJT has $f_{T}$ of 10 GHz and $C_{o}=0.1 \mathrm{pF}$ when operated at $I_{C}=1.0 \mathrm{~mA}$. What is $C_{o}$ in this situation? Also, find $g_{m}$. For $\beta=120$, find $r_{s}$ and $f_{\beta}$.
10.23 For a BJT whose unity-gain bandwidth is 2 GHz and $\beta_{0}=200$, at what frequency does the magnitude of $h_{f e}$ become 40 ? What is $f_{\beta}$ ?
*10.24 For a sufficiently high frequency, measurement of the complex input impedance of a BJT having (ac) grounded emitter and collector yields a real part approximating $r_{s}$. For what frequency, defined in terms of $\omega_{\beta}$, is such an estimate of $r_{s}$ good to within $10 \%$ under the condition that $r_{s} \leq r_{s} / 10$ ?
*10.25 Complete the table entries on the previous page for transistors (a) through (g), under the conditions indicated. Neglect $r_{s}$.

## Section 10.3: High-Frequency Response of the CS and CE Amplifiers

10.26 In a particular common-source amplifier for which the midband voltage gain between gate and drain (i.e., $-g_{m} R_{L}^{\prime}$ ) is $-39 \mathrm{~V} / \mathrm{V}$, the NMOS transistor has $C_{g s}=1.0 \mathrm{pF}$ and $C_{g d}=0.1 \mathrm{pF}$. What input capacitance would you expect? For what range of signal-source resistances can you expect the 3-dB frequency to exceed 1 MHz ? Neglect the effect of $R_{G}$.

D 10.27 In the circuit of Fig. P10.27, the voltage amplifier is ideal (i.e., it has an infinite input resistance and a zero output resistance).
(a) Use the Miller approach to find an expression for the input capacitance $C_{\text {in }}$ in terms of $A$ and $C$.
(b) Use the expression for $C_{\text {in }}$ to obtain the transfer function $V_{o}(s) / V_{\text {sig }}(s)$.


Figure P10.27
(c) If $R_{\text {sig }}=1 \mathrm{k} \Omega$, and the gain $V_{o} / V_{\text {sig }}$ is to have a dc value of 40 dB and a 3-dB frequency of 100 kHz , find the values required for $A$ and $C$.
(d) Sketch a Bode plot for the gain and use it to determine the frequency at which its magnitude reduces to unity.
10.28 An ideal voltage amplifier having a voltage gain of $-1000 \mathrm{~V} / \mathrm{V}$ has a $0.2-\mathrm{pF}$ capacitance connected between its output and input terminals. What is the input capacitance of the amplifier? If the amplifier is fed from a voltage source $V_{\text {sig }}$ having a resistance $R_{\text {sig }}=1 \mathrm{k} \Omega$, find the transfer function $V_{o} / V_{\text {sig }}$ as a function of the complex-frequency variable $s$ and hence the 3-dB frequency $f_{H}$ and the unity-gain frequency $f_{i}$.
D 10.29 A design is required for a CS amplifier for which the MOSFET is operated at $g_{m}=5 \mathrm{~mA} / \mathrm{V}$ and has $C_{g s}=5 \mathrm{pF}$ and $C_{g d}=1 \mathrm{pF}$. The amplifier is fed with a signal source having $R_{\text {sig }}=1 \mathrm{k} \Omega$, and $R_{G}$ is very large. What is the largest value of $R_{L}^{\prime}$ for which the upper 3-dB frequency is at least 6 MHz ? What is the corresponding value of midband gain and gain-bandwidth product? If the specification on the upper 3-dB frequency can be relaxed by a factor of 3 , that is, to 2 MHz , what can $A_{M}$ and $G B$ become?
10.30 Reconsider Example 10.3 for the situation in which the transistor is replaced by one whose width $W$ is half that of the original transistor while the bias current remains unchanged. Find modified values for all the device parameters along with $A_{M}, f_{H}$, and the gain-bandwidth product, $G B$. Contrast this with the original design by calculating the ratios of new value to old for $W, V_{O V}, g_{m}, C_{g s}, C_{g d}, C_{\text {in }}, A_{M}, f_{H}$, and $G B$.
D *10.31 In a CS amplifier, such as that in Fig. 10.3(a), the resistance of the source $R_{\text {sig }}=100 \mathrm{k} \Omega$, amplifier

[^0]
[^0]:    10.30 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
input resistance (which is due to the biasing network) $R_{\mathrm{in}}=100 \mathrm{k} \Omega, \quad C_{g s}=1 \mathrm{pF}, \quad C_{g d}=0.2 \mathrm{pF}, \quad g_{m}=3 \mathrm{~mA} / \mathrm{V}$, $r_{o}=50 \mathrm{k} \Omega, R_{D}=8 \mathrm{k} \Omega$, and $R_{L}=10 \mathrm{k} \Omega$. Determine the expected $3-\mathrm{dB}$ cutoff frequency $f_{H}$ and the midband gain. In evaluating ways to double $f_{H}$, a designer considers the alternatives of changing either $R_{L}$ or $R_{\text {in }}$. To raise $f_{H}$ as described, what separate change in each would be required? What midband voltage gain results in each case?
10.32 A discrete MOSFET common-source amplifier has $R_{G}=2 \mathrm{M} \Omega, g_{m}=5 \mathrm{~mA} / \mathrm{V}, r_{o}=100 \mathrm{k} \Omega, R_{D}=20 \mathrm{k} \Omega$, $C_{g s}=3 \mathrm{pF}$, and $C_{g d}=0.5 \mathrm{pF}$. The amplifier is fed from a voltage source with an internal resistance of $500 \mathrm{k} \Omega$ and is connected to a $20-\mathrm{k} \Omega$ load. Find:
(a) the overall midband gain $A_{M}$
(b) the upper 3-dB frequency $f_{H}$
(c) the frequency of the transmission zero, $f_{Z}$.
10.33 For the discrete-circuit CS amplifier in Fig. 10.3(a) let $R_{\text {sig }}=100 \mathrm{k} \Omega, R_{G 1}=47 \mathrm{M} \Omega, R_{G 2}=10 \mathrm{M} \Omega, R_{S}=2 \mathrm{k} \Omega$, $R_{D}=4.7 \mathrm{k} \Omega, R_{L}=10 \mathrm{k} \Omega, g_{m}=3 \mathrm{~mA} / \mathrm{V}, r_{o}=100 \mathrm{k} \Omega$, $C_{g s}=1 \mathrm{pF}$, and $C_{g d}=0.2 \mathrm{pF}$. Find $A_{M}$ and $f_{H}$.
10.34 Consider the integrated-circuit CS amplifier in Fig. P10.34 for the case $I_{\text {BIAS }}=100 \mu \mathrm{~A}, Q_{2}$ and $Q_{3}$ are matched, and $R_{\text {sig }}=200 \mathrm{k} \Omega$. For $Q_{1}: \mu_{n} C_{o s}=90 \mu \mathrm{~A} / \mathrm{V}^{2}$, $V_{A}=12.8 \mathrm{~V}, W / L=100 \mu \mathrm{~m} / 1.6 \mu \mathrm{~m}, C_{g s}=0.2 \mathrm{pF}$, and $C_{g d}=0.015 \mathrm{pF}$. For $Q_{2}:\left|V_{A}\right|=19.2 \mathrm{~V}$. Neglecting the effect of the capacitance inevitably present at the output node, find the low-frequency gain, the 3-dB frequency $f_{H}$, and the frequency of the zero $f_{Z}$.


Figure P10.34
10.35 A common-emitter amplifier is measured at midband and found to have a gain of $-50 \mathrm{~V} / \mathrm{V}$ between base and collector. If $C_{n}=10 \mathrm{pF}, C_{o}=1 \mathrm{pF}$, and the effective source resistance $R_{\text {sig }}^{*}=5 \mathrm{k} \Omega$ [refer to Fig. 10.19(b)], find $C_{\text {in }}$ and the 3-dB frequency $f_{H}$.
10.36 For a CE amplifier represented by the equivalent circuit in Fig. 10.19(a), let $R_{\text {sig }}=10 \mathrm{k} \Omega, R_{B}=100 \mathrm{k} \Omega, r_{s}=$ $100 \Omega, C_{n}=10 \mathrm{pF}, C_{\mu}=1 \mathrm{pF}, g_{m}=40 \mathrm{~mA} / \mathrm{V}, r_{o}=100 \mathrm{k} \Omega$, $R_{C}=10 \mathrm{k} \Omega, R_{L}=10 \mathrm{k} \Omega$, and $\beta=100$. Find the midband gain and the 3-dB frequency $f_{H}$.
10.37 A designer wishes to investigate the effect of changing the bias current $I_{E}$ on the midband gain and high-frequency response of the CE amplifier considered in Example 10.4. Let $I_{E}$ be doubled to 2 mA , and assume that $\beta_{0}$ and $f_{T}$ remain unchanged at 100 and 800 MHz , respectively. To keep the node voltages nearly unchanged, the designer reduces $R_{B}$ and $R_{C}$ by a factor of 2 , to $50 \mathrm{k} \Omega$ and $4 \mathrm{k} \Omega$, respectively. Assume $r_{s}=50 \Omega$, and recall that $V_{A}=100 \mathrm{~V}$ and that $C_{\mu}$ remains constant at 1 pF . As before, the amplifier is fed with a source having $R_{\text {sig }}=5 \mathrm{k} \Omega$ and feeds a load $R_{L}=5 \mathrm{k} \Omega$. Find the new values of $A_{M}, f_{H}$, and the gain-bandwidth product, $\left|A_{M}\right| f_{H}$. Comment on the results. Note that the price paid for whatever improvement in performance is achieved is an increase in power. By what factor does the power dissipation increase?
*10.38 The purpose of this problem is to investigate the high-frequency response of the CE amplifier when it is fed with a relatively large source resistance $R_{\text {sig }}$. Refer to the amplifier in Fig. 10.9(a) and to its high-frequency, equivalent-circuit model and the analysis shown in Fig. 10.19. Let $R_{B} \gg R_{\text {sig }}, r_{s} \ll R_{\text {sig }}, R_{\text {sig }} \gg r_{n}, g_{m} R_{L}^{\prime} \gg 1$, and $g_{m} R_{L}^{\prime} C_{\mu} \gg$ $C_{n}$. Under these conditions, show that:
(a) the midband gain $A_{M} \simeq-\beta R_{L}^{\prime} / R_{\text {sig }}$
(b) the upper 3-dB frequency $f_{H} \simeq 1 / 2 \pi C_{\mu} \beta R_{L}^{\prime}$
(c) the gain-bandwidth product $\left|A_{M}\right| f_{H} \simeq 1 / 2 \pi C_{\mu} R_{\text {sig }}$

Evaluate this approximate value of the gain-bandwidth product for the case $R_{\text {sig }}=25 \mathrm{k} \Omega$ and $C_{\mu}=1 \mathrm{pF}$. Now, if the transistor is biased at $I_{C}=1 \mathrm{~mA}$ and has $\beta=100$, find the midband gain and $f_{H}$ for the two cases $R_{L}^{\prime}=25 \mathrm{k} \Omega$ and $R_{L}^{\prime}=2.5 \mathrm{k} \Omega$. On the same coordinates, sketch Bode plots for the gain magnitude versus frequency for the two cases. What $f_{H}$ is obtained when the gain is unity? What value of $R_{L}^{\prime}$ corresponds?
10.39 For a version of the CE amplifier circuit in Fig. 10.9(a), $R_{\text {sig }}=10 \mathrm{k} \Omega, \quad R_{B 1}=68 \mathrm{k} \Omega, \quad R_{B 2}=27 \mathrm{k} \Omega$,

[^0]
[^0]:    10.38 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
$R_{E}=2.2 \mathrm{k} \Omega, R_{C}=4.7 \mathrm{k} \Omega$, and $R_{L}=10 \mathrm{k} \Omega$. The collector current is $0.8 \mathrm{~mA}, \beta=200, f_{T}=1 \mathrm{GHz}$, and $C_{o}=0.8 \mathrm{pF}$. Neglecting the effect of $r_{s}$ and $r_{o}$, find the midband voltage gain and the upper 3-dB frequency $f_{H}$.
10.40 Consider an ideal voltage amplifier with a gain of $0.9 \mathrm{~V} / \mathrm{V}$, and a resistance $R=100 \mathrm{k} \Omega$ connected in the feedback path-that is, between the output and input terminals. Use Miller's theorem to find the input resistance of this circuit.
10.41 The amplifiers listed below are characterized by the descriptor $(A, C)$, where $A$ is the voltage gain from input to output and $C$ is an internal capacitor connected between input and output. For each, find the equivalent capacitances at the input and at the output as provided by the use of Miller's theorem:
(a) $-1000 \mathrm{~V} / \mathrm{V}, 1 \mathrm{pF}$
(b) $-10 \mathrm{~V} / \mathrm{V}, 10 \mathrm{pF}$
(c) $-1 \mathrm{~V} / \mathrm{V}, 10 \mathrm{pF}$
(d) $+1 \mathrm{~V} / \mathrm{V}, 10 \mathrm{pF}$
(e) $+10 \mathrm{~V} / \mathrm{V}, 10 \mathrm{pF}$

Note that the input capacitance found in case (e) can be used to cancel the effect of other capacitance connected from input to ground. In (e), what capacitance can be canceled?
*10.42 Figure P10.42 shows an ideal voltage amplifier with a gain of $+2 \mathrm{~V} / \mathrm{V}$ (usually implemented with an op amp connected in the noninverting configuration) and a resistance $R$ connected between output and input.
(a) Using Miller's theorem, show that the input resistance $R_{\text {in }}=-R$.
(b) Use Norton's theorem to replace $V_{\text {sig }}, R_{\text {sig }}$, and $R_{\text {in }}$ with a signal current source and an equivalent parallel resistance. Show that by selecting $R_{\text {sig }}=R$, the equivalent parallel


Figure P10.42
resistance becomes infinite and the current $I_{L}$ into the load impedance $Z_{L}$ becomes $V_{\text {sig }} / R$. The circuit then functions as an ideal voltage-controlled current source with an output current $I_{L}$.
(c) If $Z_{L}$ is a capacitor $C$, find the transfer function $V_{o} / V_{\text {sig }}$ and show it is that of an ideal noninverting integrator.
10.43 Use Miller's theorem to investigate the performance of the inverting op-amp circuit shown in Fig. P10.43. Assume the op amp to be ideal except for having a finite differential gain, $A$. Without using any knowledge of op-amp circuit analysis, find $R_{\text {in }}, V_{i}, V_{o}$, and $V_{o} / V_{\text {sig }}$, for each of the following values of $A: 10 \mathrm{~V} / \mathrm{V}, 100 \mathrm{~V} / \mathrm{V}, 1000 \mathrm{~V} / \mathrm{V}$, and $10,000 \mathrm{~V} / \mathrm{V}$. Assume $V_{\text {sig }}=1 \mathrm{~V}$. Present your results in the table below.


Figure P10.43

| $\boldsymbol{A}$ | $\boldsymbol{R}_{\text {in }}$ | $\boldsymbol{V}_{\boldsymbol{i}}$ | $\boldsymbol{V}_{\boldsymbol{o}}$ | $\boldsymbol{V}_{\boldsymbol{o}} / \boldsymbol{V}_{\text {sig }}$ |
| :--: | :--: | :--: | :--: | :--: |
| $10 \mathrm{~V} / \mathrm{V}$ |  |  |  |  |
| $100 \mathrm{~V} / \mathrm{V}$ |  |  |  |  |
| $1000 \mathrm{~V} / \mathrm{V}$ |  |  |  |  |
| $10,000 \mathrm{~V} / \mathrm{V}$ |  |  |  |  |
*10.44 The amplifier shown in Fig. P10.44 has $R_{\text {sig }}=R_{L}=1 \mathrm{k} \Omega, \quad R_{C}=1 \mathrm{k} \Omega, \quad R_{B}=47 \mathrm{k} \Omega, \quad \beta=100$, $C_{o}=0.8 \mathrm{pF}$, and $f_{T}=600 \mathrm{MHz}$. Assume the coupling capacitors to be very large.
(a) Find the dc collector current of the transistor.
(b) Find $g_{m}$ and $r_{n}$.
(c) Neglecting $r_{c}$, find the midband voltage gain from base to collector (neglect the effect of $R_{B}$ ).
(d) Use the gain obtained in (c) to find the component of $R_{\text {in }}$ that arises as a result of $R_{B}$. Hence find $R_{\text {in }}$.
(e) Find the overall gain at midband.
(f) Find $C_{\text {in }}$.
(g) Find $f_{H}$.


Figure P10.44
*10.45 Figure P10.45 shows a diode-connected transistor with the bias circuit omitted. Utilizing the BJT high-frequency, hybrid- $\pi$ model with $r_{s}=0$ and $r_{o}=\infty$, derive an expression for $Z_{i}(s)$ as a function of $r_{s}$ and $C_{o}$. Find the frequency at which the impedance has a phase angle of $45^{\circ}$ for the case in which the BJT has $f_{T}=400 \mathrm{MHz}$ and the bias current is relatively high. What is the frequency when the bias current is reduced so that $C_{o} \simeq C_{\mu}$ ? Assume $\alpha=1$.


Figure P10.45
10.46 A CS amplifier modeled with the equivalent circuit of Fig. 10.22(a) is specified to have $C_{g s}=2 \mathrm{pF}, C_{g d}=0.1 \mathrm{pF}$, $g_{m}=4 \mathrm{~mA} / \mathrm{V}, C_{L}=2 \mathrm{pF}$, and $R_{L}^{\prime}=20 \mathrm{k} \Omega$. Find $A_{M}, f_{3 d B}, f_{Z}$, and $f_{i}$.

D 10.47 A common-source amplifier fed with a low-resistance signal source and operating with $g_{m}=2 \mathrm{~mA} / \mathrm{V}$ has a unity-gain frequency of 2 GHz . What additional capacitance must be connected to the drain node to reduce $f_{i}$ to 1 GHz ?
*10.48 It is required to analyze the high-frequency response of the CMOS amplifier shown in Fig. P10.34 for the case $R_{\text {sig }}=0$. The dc bias current is $100 \mu \mathrm{~A}$. For $Q_{1}$, $\mu_{a} C_{o s}=90 \mu \mathrm{~A} / \mathrm{V}^{2}, \quad V_{h}=12.8 \mathrm{~V}, \quad W / L=100 \mu \mathrm{~m} / 1.6 \mu \mathrm{~m}$, $C_{g s}=0.2 \mathrm{pF}, C_{g d}=0.015 \mathrm{pF}$, and $C_{d h}=20 \mathrm{fF}$. For $Q_{2}$, $C_{g d}=0.015 \mathrm{pF}, C_{d h}=36 \mathrm{fF}$, and $\left|V_{A}\right|=19.2 \mathrm{~V}$. For simplicity, assume that the signal voltage at the gate of $Q_{2}$ is zero. Find the low-frequency gain, the frequency of the pole, and the frequency of the zero. (Hint: The total capacitance at the output mode $=C_{d b 1}+C_{d b 2}+C_{g d 2}$ ).
10.49 Consider an active-loaded common-emitter amplifier. Let the amplifier be fed with an ideal voltage source $V_{i}$, and neglect the effect of $r_{s}$. Assume that the load current source has a very high resistance and that there is a capacitance $C_{L}$ present between the output node and ground. This capacitance represents the sum of the input capacitance of the subsequent stage and the inevitable parasitic capacitance between collector and ground. Show that the voltage gain is given by

$$
\frac{V_{o}}{V_{i}}=-g_{m} r_{o} \frac{1-s\left(C_{o} / g_{m}\right)}{1+s\left(C_{L}+C_{\mu}\right) r_{o}}
$$

If the transistor is biased at $I_{C}=200 \mu \mathrm{~A}$ and $V_{h}=100 \mathrm{~V}$, $C_{\mu}=0.2 \mathrm{pF}$, and $C_{L}=1 \mathrm{pF}$, find the dc gain, the $3-\mathrm{dB}$ frequency, the frequency of the zero, and the frequency at which the gain reduces to unity. Sketch a Bode plot for the gain magnitude.
10.50 A particular BJT operating at 2 mA is specified to have $f_{T}=2 \mathrm{GHz}, C_{o}=1 \mathrm{pF}, r_{s}=100 \Omega$, and $\beta=120$. The device is used in a CE amplifier operating from a very-low-resistance voltage source.
(a) If the midband gain obtained is $-10 \mathrm{~V} / \mathrm{V}$, what is the value of $f_{H}$ ?
(b) If the midband gain is reduced to $-1 \mathrm{~V} / \mathrm{V}$ (by changing $R_{L}^{\prime}$ ), what $f_{H}$ is obtained?

[^0]
[^0]:    $\mathrm{THF}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; $\mathrm{D}=$ design problem
## Section 10.4: Useful Tools for the Analysis of the High-Frequency Response of Amplifiers

10.51 A direct-coupled amplifier has a low-frequency gain of 40 dB , poles at 2 MHz and 20 MHz , a zero on the negative real axis at 200 MHz , and another zero at infinite frequency. Express the amplifier gain function in the form of Eqs. (10.70) and (10.71), and sketch a Bode plot for the gain magnitude. What do you estimate the 3-dB frequency $f_{H}$ to be?
10.52 An amplifier with a dc gain of 60 dB has a single-pole, high-frequency response with a 3-dB frequency of 100 kHz .
(a) Give an expression for the gain function $A(s)$.
(b) Sketch Bode diagrams for the gain magnitude and phase.
(c) What is the gain-bandwidth product?
(d) What is the unity-gain frequency?
(e) If a change in the amplifier circuit causes its transfer function to acquire another pole at 1 MHz , sketch the resulting gain magnitude and specify the unity-gain frequency. Note that this is an example of an amplifier with a unity-gain bandwidth that is different from its gain-bandwidth product.
10.53 Consider an amplifier whose $F_{H}(s)$ is given by

$$
F_{H}(s)=\frac{1}{\left(1+\frac{s}{\omega_{P 1}}\right)\left(1+\frac{s}{\omega_{P 2}}\right)}
$$

with $\omega_{P 1}<\omega_{P 2}$. Find the ratio $\omega_{P 2} / \omega_{P 1}$ for which the value of the $3-\mathrm{dB}$ frequency $\omega_{H}$ calculated using the dominant-pole approximation differs from that calculated using the root-sum-of-squares formula (Eq. 10.77) by:
(a) $10 \%$
(b) $1 \%$
10.54 The high-frequency response of a direct-coupled amplifier having a dc gain of $-1000 \mathrm{~V} / \mathrm{V}$ incorporates zeros at $\infty$ and $10^{5} \mathrm{rad} / \mathrm{s}$ (one at each frequency) and poles at $10^{5} \mathrm{rad} / \mathrm{s}$ and $10^{5} \mathrm{rad} / \mathrm{s}$ (one at each frequency). Write an expression for the amplifier transfer function. Find $\omega_{H}$ using
(a) the dominant-pole approximation
(b) the root-sum-of-squares approximation (Eq. 10.77).

If a way is found to lower the frequency of the finite zero to $10^{3} \mathrm{rad} / \mathrm{s}$, what does the transfer function become? What is the 3-dB frequency of the resulting amplifier?
10.55 A direct-coupled amplifier has a dominant pole at $1000 \mathrm{rad} / \mathrm{s}$ and three coincident poles at a much higher frequency. These nondominant poles cause the phase lag of the amplifier at high frequencies to exceed the $90^{\circ}$ angle due to the dominant pole. It is required to limit the excess phase at $\omega=$ $10^{7} \mathrm{rad} / \mathrm{s}$ to $30^{\circ}$ (i.e., to limit the total phase angle to $-120^{\circ}$ ). Find the corresponding frequency of the nondominant poles.
10.56 An IC CS amplifier has $g_{m}=2 \mathrm{~mA} / \mathrm{V}, C_{g s}=30 \mathrm{fF}$, $C_{p d}=5 \mathrm{fF}, C_{L}=30 \mathrm{fF}, R_{\text {sig }}^{\prime}=10 \mathrm{k} \Omega$, and $R_{L}^{\prime}=20 \mathrm{k} \Omega$. Use the method of open-circuit time constants to obtain an estimate for $f_{H}$. Also, find the frequency of the transmission zero, $f_{Z}$.
10.57 For a particular amplifier modeled by the circuit of Fig. 10.18(a), $g_{m}=5 \mathrm{~mA} / \mathrm{V}, R_{\text {sig }}=150 \mathrm{k} \Omega, R_{G}=0.65 \mathrm{M} \Omega$, $R_{L}^{\prime}=10 \mathrm{k} \Omega, C_{g s}=2 \mathrm{pF}$, and $C_{p d}=0.5 \mathrm{pF}$. There is also a load capacitance of 30 pF . Find the corresponding midband voltage gain, the open-circuit time constants, and an estimate of the 3-dB frequency.
10.58 Consider the high-frequency response of an amplifier consisting of two identical stages in cascade, each with an input resistance of $10 \mathrm{k} \Omega$ and an output resistance of $2 \mathrm{k} \Omega$. The two-stage amplifier is driven from a $10-\mathrm{k} \Omega$ source and drives a $1-\mathrm{k} \Omega$ load. Associated with each stage is a parasitic input capacitance (to ground) of 10 pF and a parasitic output capacitance (to ground) of 2 pF . Parasitic capacitances of 10 pF and 7 pF also are associated with the signal-source and load connections, respectively. For this arrangement, find the three poles and estimate the 3-dB frequency $f_{H}$.
10.59 A CS amplifier that can be represented by the equivalent circuit of Fig. 10.24 has $C_{g s}=2 \mathrm{pF}, C_{p d}=0.1 \mathrm{pF}$, $C_{L}=2 \mathrm{pF}, g_{m}=4 \mathrm{~mA} / \mathrm{V}$, and $R_{\text {sig }}^{\prime}=R_{L}^{\prime}=20 \mathrm{k} \Omega$. Find the midband gain $A_{M}$, the input capacitance $C_{i n}$ using the Miller approximation, and hence an estimate of the 3-dB frequency $f_{H}$. Also, obtain another estimate of $f_{H}$ using open-circuit time constants. Which of the two estimates is more appropriate and why?

D 10.60 For a CS amplifier with $g_{m}=5 \mathrm{~mA} / \mathrm{V}, C_{g s}=5 \mathrm{pF}$, $C_{p d}=1 \mathrm{pF}, C_{L}=5 \mathrm{pF}, R_{\text {sig }}^{\prime}=10 \mathrm{k} \Omega$, and $R_{L}^{\prime}=10 \mathrm{k} \Omega$, find $\tau_{H}$ and $f_{H}$. What is the percentage of $\tau_{H}$ that is caused by the interaction of $R_{\text {sig }}^{\prime}$ with the input capacitance? To what value must $R_{\text {sig }}^{\prime}$ be lowered in order to double $f_{H}$ ?

D 10.61 For the CS amplifier in Example 10.8, find the value of the additional capacitance to be connected at the output node in order to lower $f_{H}$ to 100 MHz .

[^0]
[^0]:    3111 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
10.62 Consider the CE amplifier whose equivalent circuit is shown in Fig. 10.19(a) but with a capacitance $C_{L}$ connected across the output terminals. Let $R_{\text {sig }}^{\prime}=5 \mathrm{k} \Omega, R_{B}=\infty, r_{s}=0$, $g_{m}=20 \mathrm{~mA} / \mathrm{V}, \beta=100, C_{\pi}=10 \mathrm{pF}, C_{\mu}=1 \mathrm{pF}, R_{L}^{\prime}=5 \mathrm{k} \Omega$, and $C_{L}=10 \mathrm{pF}$. Find $A_{M}$ and $f_{H}$.
10.63 A common-emitter amplifier has $C_{\pi}=10 \mathrm{pF}, C_{\mu}=$ $0.3 \mathrm{pF}, C_{L}=3 \mathrm{pF}, g_{m}=40 \mathrm{~mA} / \mathrm{V}, \beta=100, r_{s}=100 \Omega$, $R_{L}^{\prime}=5 \mathrm{k} \Omega$, and $R_{\text {sig }}=1 \mathrm{k} \Omega$. Find the midband gain $A_{M}$ and an estimate of the 3-dB frequency $f_{H}$ using the Miller approximation. Also, obtain another estimate of $f_{H}$ using the method of open-circuit time constants. Which of the two estimates would you consider to be more realistic, and why?
10.64 Consider a CS amplifier loaded in a current source with an output resistance equal to $r_{o}$ of the amplifying transistor. The amplifier is fed from a signal source with $R_{\text {sig }}=$ $r_{o} / 2$. The transistor is biased to operate at $g_{m}=2 \mathrm{~mA} / \mathrm{V}$ and $r_{o}=20 \mathrm{k} \Omega ; C_{g s}=C_{g d}=0.1 \mathrm{pF}$. Use the Miller approximation to determine an estimate of $f_{H}$. Repeat for the following two cases: (i) the bias current $I$ in the entire system is reduced by a factor of 4 , and (ii) the bias current $I$ in the entire system is increased by a factor of 4 . Remember that both $R_{\text {sig }}$ and $R_{L}$ will change as $r_{o}$ changes.
10.65 Use the method of open-circuit time constants to find $f_{H}$ for a CS amplifier for which $g_{m}=1.5 \mathrm{~mA} / \mathrm{V}, C_{g s}=$ $C_{g d}=0.2 \mathrm{pF}, r_{o}=20 \mathrm{k} \Omega, R_{L}=12 \mathrm{k} \Omega$, and $R_{\text {sig }}=100 \mathrm{k} \Omega$ for the following cases: (a) $C_{L}=0$, (b) $C_{L}=10 \mathrm{pF}$, and (c) $C_{L}=50 \mathrm{pF}$. Compare with the value of $f_{H}$ obtained using the Miller approximation.

## Section 10.5: High-Frequency Response of the Common-Gate and Cascode Amplifiers

10.66 A CG amplifier is specified to have $C_{g s}=4 \mathrm{pF}, C_{g d}=$ $0.2 \mathrm{pF}, C_{L}=2 \mathrm{pF}, g_{m}=5 \mathrm{~mA} / \mathrm{V}, R_{\text {sig }}=1 \mathrm{k} \Omega$, and $R_{L}=$ $10 \mathrm{k} \Omega$. Neglecting the effects of $r_{o}$, find the low-frequency gain $V_{o} / V_{\text {sig }}$, the frequencies of the poles $f_{P 1}$ and $f_{P 2}$, and hence an estimate of the 3-dB frequency $f_{H}$.
*10.67 Sketch the high-frequency equivalent circuit of a CB amplifier fed from a signal generator characterized by $V_{\text {sig }}$ and $R_{\text {sig }}$ and feeding a load resistance $R_{L}$ in parallel with a capacitance $C_{L}$.
(a) Show that for $r_{s}=0$ and $r_{o}=\infty$, the circuit can be separated into two parts: an input part that produces a
pole at

$$
f_{P 1}=\frac{1}{2 \pi C_{\pi}\left(R_{\text {sig }} \| r_{s}\right)}
$$

and an output part that forms a pole at

$$
f_{P 2}=\frac{1}{2 \pi\left(C_{\mu}+C_{L}\right) R_{L}}
$$

Note that these are the bipolar counterparts of the MOS expressions in Eqs. (10.94) and (10.95).
(b) Evaluate $f_{P 1}$ and $f_{P 2}$ and hence obtain an estimate for $f_{H}$ for the case $C_{\pi}=10 \mathrm{pF}, C_{\mu}=1 \mathrm{pF}, C_{L}=1 \mathrm{pF}$, $I_{C}=1 \mathrm{~mA}, R_{\text {sig }}=1 \mathrm{k} \Omega$, and $R_{L}=10 \mathrm{k} \Omega$. Also, find $f_{T}$ of the transistor.
10.68 Consider a CG amplifier loaded in a resistance $R_{L}=r_{o}$ and fed with a signal source having a resistance $R_{\text {sig }}=r_{o} / 2$. Also let $C_{L}=C_{g s}$. Use the method of open-circuit time constants to show that for $g_{m} r_{o} \gg 1$, the upper 3-dB frequency is related to the MOSFET $f_{T}$ by the approximate expression

$$
f_{H}=f_{T} /\left(g_{m} r_{o}\right)
$$

10.69 For the CG amplifier in Example 10.9, how much additional capacitance should be connected between the output node and ground to reduce $f_{H}$ to 200 MHz ?
10.70 An IC CG amplifier is fed from a signal source with $R_{\text {sig }}=r_{o} / 2$, where $r_{o}$ is the MOSFET output resistance. It has a current-source load with an output resistance equal to $r_{o}$. The MOSFET is operated at $I_{D}=100 \mu \mathrm{~A}$ and has $g_{m}=1.5 \mathrm{~mA} / \mathrm{V}$, $V_{A}=10 \mathrm{~V}, C_{g s}=0.2 \mathrm{pF}, C_{g d}=0.015 \mathrm{pF}$, and $C_{d b}=20 \mathrm{fF}$. As well, the current-source load provides an additional 30 fF capacitance at the output node. Find $f_{H}$.
10.71 Find the dc gain and the 3-dB frequency of a MOS cascode amplifier operated at $g_{m}=2 \mathrm{~mA} / \mathrm{V}$ and $r_{o}=20 \mathrm{k} \Omega$. The MOSFETs have $C_{g s}=20 \mathrm{fF}, C_{g d}=5 \mathrm{fF}$, and $C_{d b}=5 \mathrm{fF}$. The amplifier is fed from a signal source with $R_{\text {sig }}=100 \mathrm{k} \Omega$ and is connected to a load resistance of $1 \mathrm{M} \Omega$. There is also a load capacitance $C_{L}$ of 20 fF .
*10.72 (a) Consider a CS amplifier having $C_{g d}=0.2 \mathrm{pF}$, $R_{\text {sig }}=R_{L}=20 \mathrm{k} \Omega, g_{m}=4 \mathrm{~mA} / \mathrm{V}, C_{g s}=2 \mathrm{pF}, C_{L}$ (including $\left.C_{d b}\right)=1 \mathrm{pF}, C_{d b}=0.2 \mathrm{pF}$, and $r_{o}=20 \mathrm{k} \Omega$. Find the low-frequency gain $A_{M}$, and estimate $f_{H}$ using open-circuit time constants. Hence determine the gain-bandwidth product. (b) If a CG stage utilizing an identical MOSFET is cascaded with the CS transistor in (a) to create a cascode amplifier, determine the new values of $A_{M}, f_{H}$, and gain-bandwidth product. Assume $R_{L}$ remains unchanged.

[^0]
[^0]:    10.72 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
D 10.73 It is required to design a cascode amplifier to provide a dc gain of 74 dB when driven with a low-resistance generator and utilizing NMOS transistors for which $V_{A}=$ $10 \mathrm{~V}, \mu_{n} C_{o s}=200 \mu \mathrm{~A} / \mathrm{V}^{2}, W / L=50, C_{g d}=0.1 \mathrm{pF}$, and $C_{L}=1 \mathrm{pF}$. Assuming that $R_{L}=R_{o}$, determine the overdrive voltage and the drain current at which the MOSFETs should be operated. Find the unity-gain frequency and the 3-dB frequency. If the cascode transistor is removed and $R_{L}$ remains unchanged, what will the dc gain become?
10.74 (a) Show that introducing a cascode transistor to an IC CS amplifier whose bandwidth is limited by the interaction of $R_{\text {sig }}$ and the input capacitance, and whose load resistance is equal to $r_{o}$, increases the dc gain by approximately a factor of 2 and $f_{H}$ by the factor $N$,

$$
N=\frac{C_{g s}+\frac{1}{2}\left(g_{m} r_{o}\right) C_{g d}}{C_{g s}+3 C_{g d}}
$$

Assume that the bandwidth of the cascode amplifier is primarily determined by the input circuit.
(b) If $C_{g d}=0.1 C_{g s}$ and the dc gain of the CS amplifier is 50 , what is the value of $N$ ?
(c) If $V_{A}=10 \mathrm{~V}, \mu_{n} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $W / L=10$, find $V_{D V}$ and $I_{D}$ at which the transistors must be operating.
10.75 (a) For an integrated-circuit MOS cascode amplifier fed with a source having a very small resistance and loaded in a resistance equal to its $R_{o}$, use the expression for the unity-gain bandwidth in Fig. 10.29 to show that

$$
f_{t}=\frac{\sqrt{2 \mu_{n} C_{o s}(W / L)}}{2 \pi\left(C_{L}+C_{g d}\right)} \sqrt{I_{D}}
$$

(b) For $\mu_{n} C_{o s}=400 \mu \mathrm{~A} / \mathrm{V}^{2}, W / L=20, C_{L}=20 \mathrm{fF}, C_{g d}=$ 5 fF , and $V_{A}=10 \mathrm{~V}$, provide in table form $f_{t}(\mathrm{GHz}), V_{D V}(\mathrm{~V})$, $g_{m}(\mathrm{~mA} / \mathrm{V}), r_{o}(\mathrm{k} \Omega), R_{o}(\mathrm{M} \Omega), A_{M}(\mathrm{~V} / \mathrm{V})$, and $f_{H}(\mathrm{MHz})$ for $I_{D}=100 \mu \mathrm{~A}, 200 \mu \mathrm{~A}$, and $500 \mu \mathrm{~A}$.
10.76 Consider a bipolar cascode amplifier biased at a current of 1 mA . The transistors used have $\beta=100, r_{o}=$ $100 \mathrm{k} \Omega, C_{\pi}=10 \mathrm{pF}, C_{o}=2 \mathrm{pF}, C_{c s}=0$, and $r_{s}=50 \Omega$. The amplifier is fed with a signal source having $R_{\text {sig }}=5 \mathrm{k} \Omega$. The load resistance $R_{L}=2 \mathrm{k} \Omega$. Find the low-frequency gain $A_{M}$, and estimate the value of the 3-dB frequency $f_{H}$.
*10.77 In this problem we consider the frequency response of the bipolar cascode amplifier in the case that $r_{o}$ can be neglected.
(a) Refer to the circuit in Fig. 10.30, and note that the total resistance between the collector of $Q_{1}$ and ground will be equal to $r_{e 2}$, which is usually very small. It follows that the pole introduced at this node will typically be at a very high frequency and thus will have negligible effect on $f_{H}$. It also follows that at the frequencies of interest the gain from the base to the collector of $Q_{1}$ will be $-g_{m 1} r_{e 2} \simeq-1$. Use this to find the capacitance at the input of $Q_{1}$ and hence show that the pole introduced at the input node will have a frequency

$$
f_{P 1} \simeq \frac{1}{2 \pi R_{\text {sig }}^{\prime}\left(C_{\pi 1}+2 C_{\mu 1}\right)}
$$

Then show that the pole introduced at the output node will have a frequency

$$
f_{P 2} \simeq \frac{1}{2 \pi R_{L}\left(C_{L}+C_{c s 2}+C_{\mu 2}\right)}
$$

(b) Evaluate $f_{P 1}$ and $f_{P 2}$, and use the sum-of-the-squares formula to estimate $f_{H}$ for the amplifier with $I=1 \mathrm{~mA}$, $C_{\pi}=10 \mathrm{pF}, C_{o}=2 \mathrm{pF}, C_{c s}=C_{L}=0, \beta=100, R_{L}=2$ $\mathrm{k} \Omega$, and $r_{s}=0$ in the following two cases:
(i) $R_{\text {sig }}=1 \mathrm{k} \Omega$
(ii) $R_{\text {sig }}=10 \mathrm{k} \Omega$
10.78 A BJT cascode amplifier uses transistors for which $\beta=100, V_{A}=100 \mathrm{~V}, f_{T}=1 \mathrm{GHz}$, and $C_{o}=0.1 \mathrm{pF}$. It operates at a bias current of 0.1 mA between a source with $R_{\text {sig }}=r_{\pi}$ and a load $R_{L}=\beta r_{o}$. Let $C_{L}=C_{c s}=0$, and $r_{s}=0$. Find the overall voltage gain at dc. By evaluating the various components of $\tau_{H}$ show that the pole introduced at the output mode is dominant. Find its frequency and hence an estimate of $f_{H}$ and $f_{t}$.

## Section 10.6: High-Frequency Response of the Source and Emitter Followers

10.79 A source follower has $g_{m}=5 \mathrm{~mA} / \mathrm{V}, g_{m b}=0, r_{o}=$ $20 \mathrm{k} \Omega, R_{\text {sig }}=20 \mathrm{k} \Omega, R_{L}=2 \mathrm{k} \Omega, C_{g s}=2 \mathrm{pF}, C_{g d}=0.1 \mathrm{pF}$, and $C_{L}=1 \mathrm{pF}$. Find $A_{M}, R_{o}, f_{Z}$, the frequencies of the two poles, and an estimate of $f_{H}$.
10.80 Using the expression for the source follower $f_{H}$ in Eq. (10.124) show that for situations in which $C_{L}=0, R_{\text {sig }}$

[^0]
[^0]:    10.79 A multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
is large and $R_{L}$ is small,

$$
f_{H} \simeq \frac{1}{2 \pi R_{o q}\left(C_{g d}+\frac{C_{g s}}{1+g_{m} R_{L}}\right)}
$$

Find $f_{H}$ for the case $R_{o q}=100 \mathrm{k} \Omega, R_{L}=2 \mathrm{k} \Omega, r_{o}=20 \mathrm{k} \Omega$, $g_{m}=5 \mathrm{~mA} / \mathrm{V}, C_{g d}=10 \mathrm{pF}$, and $C_{g s}=2 \mathrm{pF}$.
10.81 Refer to Fig. 10.31(c). In situations in which $R_{o q}$ is large, the high-frequency response of the source follower is determined by the low-pass circuit formed by $R_{o q}$ and the input capacitance. An estimate of $C_{\text {in }}$ can be obtained by using the Miller approximation to replace $C_{g s}$ with an input capacitance $C_{e q}=C_{g s}(1-K)$ where $K$ is the gain from gate to source. Using the low-frequency value of $K=g_{m} R_{L}^{\prime} /\left(1+g_{m} R_{L}^{\prime}\right)$ find $C_{e q}$ and hence $C_{\text {in }}$ and an estimate of $f_{H}$.
10.82 A source follower has a maximally flat gain response with a dc gain of 0.8 and a 3-dB frequency of 1 MHz . Give its transfer function.
10.83 A discrete-circuit source follower driven with $R_{o q}=$ $100 \mathrm{k} \Omega$ has $C_{g s}=10 \mathrm{pF}, C_{g d}=1 \mathrm{pF}, C_{L}=10 \mathrm{pF}, g_{m b}=0$, and $r_{o}$ very large. The transfer function of the source follower is measured as $R_{L}$ is varied. At what value of $R_{L}$ will the transfer function be maximally flat? At this value of $R_{L}$ the dc gain is found to be $0.9 \mathrm{~V} / \mathrm{V}$. What is the $3-\mathrm{dB}$ frequency? What is the value of $g_{m}$ at which the source follower is operating?
10.84 For an emitter follower biased at $I_{C}=1 \mathrm{~mA}$, having $R_{\text {sig }}=R_{L}=1 \mathrm{k} \Omega$, and using a transistor specified to have $f_{T}=2 \mathrm{GHz}, C_{o}=0.1 \mathrm{pF}, C_{L}=0, r_{s}=100 \Omega, \beta=100$, and $V_{A}=20 \mathrm{~V}$, evaluate the low-frequency gain $A_{M}$, the frequency of the transmission zero, the pole frequencies, and an estimate of the 3-dB frequency $f_{H}$.

## Section 10.7: High-Frequency Response of Differential Amplifiers

10.85 A MOSFET differential amplifier such as that shown in Fig. 10.34(a) is biased with a current source $I=400 \mu \mathrm{~A}$. The transistors have $W / L=16, k_{n}^{\prime}=400 \mu \mathrm{~A} / \mathrm{V}^{2}, V_{A}=20 \mathrm{~V}$, $C_{g s}=40 \mathrm{fF}, C_{g d}=5 \mathrm{fF}$, and $C_{d h}=5 \mathrm{fF}$. The drain resistors are $10 \mathrm{k} \Omega$ each. Also, there is a $100-\mathrm{fF}$ capacitive load between each drain and ground.
(a) Find $V_{O V}$ and $g_{m}$ for each transistor.
(b) Find the differential gain $A_{d}$.
(c) If the input signal source has a small resistance $R_{o q}$ and thus the frequency response is determined primarily by the output pole, estimate the 3-dB frequency $f_{H}$.
(d) If, in a different situation, the amplifier is fed symmetrically with a signal source of $40 \mathrm{k} \Omega$ resistance (i.e., $20 \mathrm{k} \Omega$ in series with each gate terminal), use the open-circuit time-constants method to estimate $f_{H}$.
10.86 A MOS differential amplifier is biased with a current source having an output resistance $R_{S S}=100 \mathrm{k} \Omega$ and an output capacitance $C_{S S}=1 \mathrm{pF}$. If the differential gain is found to have a dominant pole at 20 MHz , what is the 3-dB frequency of the CMRR?
10.87 The differential gain of a MOS amplifier is $100 \mathrm{~V} / \mathrm{V}$ with a dominant pole at 10 MHz . The common-mode gain is $0.1 \mathrm{~V} / \mathrm{V}$ at low frequencies and has a transmission zero at 1 MHz . Sketch a Bode plot for the CMRR.
10.88 In a particular MOS differential amplifier design, the bias current $I=100 \mu \mathrm{~A}$ is provided by a single transistor operating at $V_{O V}=0.4 \mathrm{~V}$ with $V_{A}=40 \mathrm{~V}$ and output capacitance $C_{S S}$ of 100 fF . What is the frequency of the common-mode gain zero $\left(f_{Z}\right)$ at which $A_{c m}$ begins to rise above its low-frequency value? To meet a requirement for reduced power supply, consideration is given to reducing $V_{O V}$ to 0.2 V while keeping $I$ unchanged. Assuming the current-source capacitance to be directly proportional to the device width, what is the impact on $f_{Z}$ of this proposed change?
10.89 Repeat Exercise 10.26 for the situation in which the bias current is reduced to $80 \mu \mathrm{~A}$ and $R_{D}$ is raised to $20 \mathrm{k} \Omega$. For (d), let $R_{o q}$ be raised from $20 \mathrm{k} \Omega$ to $100 \mathrm{k} \Omega$. (Note: This is a low-voltage, low-power design.)
10.90 A BJT differential amplifier operating with a $0.5-\mathrm{mA}$ current source uses transistors for which $\beta=100, f_{T}=500$ $\mathrm{MHz}, C_{o}=0.5 \mathrm{pF}$, and $r_{s}=100 \Omega$. Each of the collector resistances is $10 \mathrm{k} \Omega$, and $r_{o}$ is very large. The amplifier is fed in a symmetrical fashion with a source resistance of $10 \mathrm{k} \Omega$ in series with each of the two input terminals.
(a) Sketch the differential half-circuit and its high-frequency equivalent circuit.
(b) Determine the low-frequency value of the overall differential gain.
(c) Use the Miller approximation to determine the input capacitance and hence estimate the 3-dB frequency $f_{H}$ and the gain-bandwidth product.
10.91 A differential amplifier is biased by a current source having an output resistance of $1 \mathrm{M} \Omega$ and an output capacitance of 1 pF . The differential gain exhibits a dominant pole at 2 MHz . What are the poles of the CMRR?
10.92 A current-mirror-loaded MOS differential amplifier is biased with a current source $I=0.2 \mathrm{~mA}$. The two NMOS transistors of the differential pair are operating at $V_{O V}=0.2 \mathrm{~V}$, and the PMOS devices of the mirror are operating at $\left|V_{O V}\right|=$ 0.2 V . The Early voltage $V_{A a}=\left|V_{A p}\right|=10 \mathrm{~V}$. The total capacitance at the input node of the mirror is 0.1 pF and that at the output node of the amplifier is 0.2 pF . Find the dc value and the frequencies of the poles and zero of the differential voltage gain.
10.93 Consider the current-mirror-loaded CMOS differential amplifier of Fig. 10.37(a) for the case of all transistors operated at the same $\left|V_{O V}\right|$ and having the same $\left|V_{A}\right|$. Also let the total capacitance at the output node $\left(C_{L}\right)$ be four times the total capacitance at the input node of the current mirror $C_{m}$. Give expressions for $A_{d}, f_{P 1}, f_{P 2}$, and $f_{Z}$. Hence show that $f_{P 2} / f_{P 1}=4 A_{d}$ and $f_{i}=g_{m} / 2 \pi C_{L}$. For $V_{A}=20 \mathrm{~V}, V_{O V}=0.2 \mathrm{~V}$, $I=0.2 \mathrm{~mA}, C_{L}=100 \mathrm{fF}$, and $C_{m}=25 \mathrm{fF}$, find the dc value of $A_{d}$, and the value of $f_{P 1}, f_{i}, f_{P 2}$, and $f_{Z}$ and sketch a Bode plot for $\left|A_{d}\right|$.
*10.94 For the current mirror in Fig. P10.94, derive an expression for the current transfer function $I_{c}(s) / I_{i}(s)$ taking into account the BJT internal capacitances and neglecting $r_{s}$ and $r_{o}$. Assume the BJTs to be identical. Observe that a signal ground appears at the collector of $Q_{2}$. If the mirror is biased at 1 mA and the BJTs at this operating point are characterized by $f_{T}=500 \mathrm{MHz}, C_{o}=2 \mathrm{pF}$, and $\beta_{0}=100$, find the frequencies of the pole and zero of the transfer function.


Figure P10.94

## Section 10.8: Other Wideband Amplifier Configurations

10.95 Consider the case of a discrete-circuit CS amplifier in which a source-degeneration resistance is utilized to control the bandwidth. Assume that $r_{o}$ is very large and $C_{L}$ is negligibly small. Adapt the formulas given in the text for this case and thus give the expressions for $A_{M}$ and $f_{H}$. Let $R_{\text {sig }}=100 \mathrm{k} \Omega, g_{m}=5 \mathrm{~mA} / \mathrm{V}, R_{L}=5 \mathrm{k} \Omega, C_{g s}=10 \mathrm{pF}$, and $C_{g d}=2 \mathrm{pF}$. Find $\left|A_{M}\right|, f_{H}$, and the gain-bandwidth product for these three cases: $R_{s}=0,100 \Omega$, and $200 \Omega$.
10.96 A CS amplifier is specified to have $g_{m}=5 \mathrm{~mA} / \mathrm{V}$, $r_{o}=40 \quad \mathrm{k} \Omega, \quad C_{g s}=2 \mathrm{pF}, \quad g_{g d}=0.1 \mathrm{pF}, \quad C_{L}=1 \mathrm{pF}$, $R_{\text {sig }}=20 \mathrm{k} \Omega$, and $R_{L}=40 \mathrm{k} \Omega$.
(a) Find the low-frequency gain $A_{M}$, and use open-circuit time constants to estimate the 3-dB frequency $f_{H}$. Hence determine the gain-bandwidth product.
(b) If a $400-\Omega$ resistance is connected in the source lead, find the new values of $\left|A_{M}\right|, f_{H}$, and the gain-bandwidth product.

D 10.97 (a) Use the approximate expression in Eq. (10.156) to determine the gain-bandwidth product of a CS amplifier with a source-degeneration resistance. Assume $C_{g d}=0.2 \mathrm{pF}$ and $R_{\text {sig }}=100 \mathrm{k} \Omega$.
(b) If a low-frequency gain of $20 \mathrm{~V} / \mathrm{V}$ is required, what $f_{H}$ corresponds?
(c) For $g_{m}=5 \mathrm{~mA} / \mathrm{V}, A_{0}=100 \mathrm{~V} / \mathrm{V}$, and $R_{L}=20 \mathrm{k} \Omega$, find the required value of $R_{s}$.
10.98 For the CS amplifier with a source-degeneration resistance $R_{s}$, show for $R_{\text {sig }} \gg R_{s}, r_{o} \gg R_{s}$, and $R_{L}=r_{o}$ that

$$
A_{M}=\frac{-A_{0}}{2+k}
$$

and

$$
\begin{aligned}
\tau_{H} \simeq & \frac{C_{g s} R_{\text {sig }}}{1+(k / 2)}+C_{g d} R_{\text {sig }}\left(1+\frac{A_{0}}{2+k}\right) \\
& +\left(C_{L}+C_{g d}\right) r_{o}\left(\frac{1+k}{2+k}\right)
\end{aligned}
$$

where $k \equiv g_{m} R_{s}$
D*10.99 It is required to generate a table of $\left|A_{M}\right|$, $f_{H}$, and $f_{i}$ versus $k \equiv g_{m} R_{s}$ for a CS amplifier with a source-degeneration resistance $R_{s}$. The table should have entries for $k=0,1,2, \ldots, 15$. The amplifier is specified to have $g_{m}=5 \mathrm{~mA} / \mathrm{V}, r_{o}=40 \mathrm{k} \Omega, R_{L}=40 \mathrm{k} \Omega, R_{\text {sig }}=20 \mathrm{k} \Omega$, $C_{g s}=2 \mathrm{pF}, C_{g d}=0.1 \mathrm{pF}$, and $C_{L}=1 \mathrm{pF}$. Use the formulasfor $A_{M}$ and $\tau_{H}$ given in the statement for Problem 10.98. If $f_{H}=2 \mathrm{MHz}$ is required, find the value needed for $R_{s}$ and the corresponding value of $\left|A_{M}\right|$.
*10.100 In this problem we investigate the bandwidth extension obtained by placing a source follower between the signal source and the input of the CS amplifier.
(a) First consider the CS amplifier of Fig. P10.100(a). Show that

$$
\begin{aligned}
A_{M} & =-g_{m} r_{o} \\
\tau_{H} & =C_{g s} R_{\text {sig }}+C_{g d}\left[R_{\text {sig }}\left(1+g_{m} r_{o}\right)+r_{o}\right]+C_{L} r_{o}
\end{aligned}
$$

where $C_{L}$ is the total capacitance between the output node and ground. Calculate the value of $A_{M}, f_{H}$, and the gain-bandwidth product for the case $g_{m}=1 \mathrm{~mA} / \mathrm{V}$, $r_{o}=20 \mathrm{k} \Omega, R_{\text {sig }}=20 \mathrm{k} \Omega, C_{g s}=20 \mathrm{fF}, C_{g d}=5 \mathrm{fF}$, and $C_{L}=10 \mathrm{fF}$.
(b) For the CD-CS amplifier in Fig. P10.100(b), show that

$$
\begin{aligned}
A_{M}= & -\frac{r_{o 1}}{1 / g_{m 1}+r_{o 1}}\left(g_{m 2} r_{o 2}\right) \\
\tau_{H}= & C_{g d 1} R_{\text {sig }}+C_{g s 1} \frac{R_{\text {sig }}+r_{o 1}}{1+g_{m 1} r_{o 1}}+C_{g s 2}\left(\frac{1}{g_{m 1}} \| r_{o 1}\right) \\
& +C_{g d 2}\left[\left(\frac{1}{g_{m 1}} \| r_{o 1}\right)\left(1+g_{m 2} r_{o 2}\right)+r_{o 2}\right] \\
& +C_{L} r_{o 2}
\end{aligned}
$$

Calculate the values of $A_{M}, f_{H}$, and the gain-bandwidth product for the same parameter values used in (a). Compare with the results of (a).
*10.101 The transistors in the circuit of Fig. P10.101 have $\beta_{\|}=100, V_{A}=100 \mathrm{~V}$, and $C_{o}=0.2 \mathrm{pF}$. At a bias current of $100 \mu \mathrm{~A}, f_{T}=200 \mathrm{MHz}$. (Note that the bias details are not shown.)


Figure P10.100


Figure P10.101

SIM = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
(a) Find $R_{i n}$ and the midband gain.
(b) Find an estimate of the upper 3-dB frequency $f_{H}$. Which capacitor dominates? Which one is the second most significant?
(Hint: Use the formulas in Example 10.13.)
10.102 Consider the circuit of Fig. P10.102 for the case: $I=200 \mu \mathrm{~A}$ and $V_{O V}=0.2 \mathrm{~V}, R_{\text {sig }}=100 \mathrm{k} \Omega, R_{D}=50 \mathrm{k} \Omega$, $C_{g s}=4 \mathrm{pF}$, and $C_{g d}=0.5 \mathrm{pF}$. Find the dc gain, the high-frequency poles, and an estimate of $f_{H}$.


Figure P10.102
10.103 For the amplifier in Fig. 10.41(a), let $I=1 \mathrm{~mA}$, $\beta=120, f_{T}=500 \mathrm{MHz}$, and $C_{o}=0.5 \mathrm{pF}$, and neglect $r_{s}$ and $r_{o}$. Assume that a load resistance of $10 \mathrm{k} \Omega$ is connected to the output terminal. If the amplifier is fed with a signal $V_{\text {sig }}$ having a source resistance $R_{\text {sig }}=12 \mathrm{k} \Omega$, find $A_{M}$ and $f_{H}$.
10.104 Consider the CD-CG amplifier of Fig. 10.41(c) for the case $g_{m}=5 \mathrm{~mA} / \mathrm{V}, C_{g s}=2 \mathrm{pF}, C_{g d}=0.1 \mathrm{pF}, C_{L}$ (at the output node) $=1 \mathrm{pF}$, and $R_{\text {sig }}=R_{L}=20 \mathrm{k} \Omega$. Neglecting $r_{o}$, find $A_{M}$ and $f_{H}$. (Hint: Evaluate $f_{H}$ directly from the transfer function.)

D **10.105 This problem investigates the use of MOSFETs in the design of wideband amplifiers (Steininger, 1990). Such amplifiers can be realized by cascading low-gain stages.
(a) Show that for the case $C_{g d} \ll C_{g s}$ and the gain of the common-source amplifier is low so that the Miller effect is negligible, the MOSFET can be modeled by the approximate equivalent circuit shown in Fig. P10.105(a), where $\omega_{T}$ is the unity-gain frequency of the MOSFET.
(b) Figure P10.105(b) shows an amplifier stage suitable for the realization of low gain and wide bandwidth. Transistors $Q_{1}$ and $Q_{2}$ have the same channel length $L$ but different widths $W_{1}$ and $W_{2}$. They are biased at the same $V_{G S}$ and have the same $f_{T}$. Use the MOSFET equivalent circuit of Fig. P10.105(a) to model this amplifier stage, assuming that its output is connected to the input of an identical stage. Show that the voltage gain $V_{o} / V_{i}$ is given by

$$
\frac{V_{o}}{V_{i}}=-\frac{G_{0}}{1+\frac{s}{\omega_{T} /\left(G_{0}+1\right)}}
$$

where

$$
G_{0}=\frac{g_{m 1}}{g_{m 2}}=\frac{W_{1}}{W_{2}}
$$


(a)

(b)

Figure P10.105
(c) For $L=0.5 \mu \mathrm{~m}, W_{2}=25 \mu \mathrm{~m}, f_{T}=12 \mathrm{GHz}$, and $\mu_{o} C_{o s}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$, design the circuit to obtain a gain of $3 \mathrm{~V} / \mathrm{V}$ per stage. Bias the MOSFETs at $V_{O V}=0.3 \mathrm{~V}$. Specify the required values of $W_{1}$ and $I$. What is the 3-dB frequency achieved?

[^0]
[^0]:    $\mathrm{SHM}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
*10.106 Figure P10.106 shows an amplifier formed by cascading two CS stages. Note that the input bias voltage is not shown. Each of $Q_{1}$ and $Q_{2}$ is operated at an overdrive voltage of 0.2 V , and $\left|V_{4}\right|=10 \mathrm{~V}$. The transistor capacitances are as follows: $C_{g s}=20 \mathrm{fF}, C_{g d}=5 \mathrm{fF}$, and $C_{d b}=5 \mathrm{fF}$. The signal-source resistance $R_{\text {sig }}=10 \mathrm{k} \Omega$.
(a) Find the dc voltage gain.
(b) Use the method of open-circuit time constants to determine an estimate for the 3-dB frequency $f_{H}$.


Figure P10.106
**10.107 Consider the BiCMOS amplifier shown in Fig. P10.107. The BJT has $\left|V_{B E}\right|=0.7 \mathrm{~V}, \beta=200$, $C_{a}=0.8 \mathrm{pF}$, and $f_{T}=600 \mathrm{MHz}$. The NMOS transistor has $V_{i}=1 \mathrm{~V}, k_{b}^{\prime} W / L=2 \mathrm{~mA} / \mathrm{V}^{2}$, and $C_{g s}=C_{g d}=1 \mathrm{pF}$.
(a) Consider the dc bias circuit. Neglect the base current of $Q_{2}$ in determining the current in $Q_{1}$. Find the dc bias currents in $Q_{1}$ and $Q_{2}$, and show that they are approximately $100 \mu \mathrm{~A}$ and 1 mA , respectively.
(b) Evaluate the small-signal parameters of $Q_{1}$ and $Q_{2}$ at their bias points.
(c) Consider the circuit at midband frequencies. First, determine the small-signal voltage gain $V_{o} / V_{i}$. (Note that $R_{G}$ can be neglected in this process.) Then use Miller's theorem on $R_{G}$ to determine the amplifier input resistance $R_{\mathrm{in}}$. Finally, determine the overall voltage gain $V_{o} / V_{\text {sig }}$. Assume $r_{o}$ of both transistors to be very large.
(d) Consider the circuit at low frequencies. Determine the frequency of the poles due to $C_{1}$ and $C_{2}$, and hence estimate the lower 3-dB frequency, $f_{L}$.
(e) Consider the circuit at higher frequencies. Use Miller's theorem to replace $R_{G}$ with a resistance at the input. (The one at the output will be too large to matter.) Use open-circuit time constants to estimate $f_{H}$.
***10.108 In each of the six circuits in Fig. P10.108, let $\beta=100, C_{a}=2 \mathrm{pF}$, and $f_{T}=400 \mathrm{MHz}$, and neglect $r_{s}$ and $r_{o}$. Calculate the midband gain $A_{M}$ and the 3-dB frequency $f_{H}$.


Figure P10.107

[^0]
[^0]:    $\mathrm{SHR}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; $\mathrm{D}=$ design problem


Figure P10.108
# CHAPTER 11 

## Feedback

Introduction 807
11.1 The General Feedback Structure 808
11.2 Some Properties of Negative Feedback 815
11.3 The Feedback Voltage Amplifier 820
11.4 Systematic Analysis of Feedback Voltage Amplifiers 828
11.5 Other Feedback-Amplifier Types 840
11.6 Summary of the Feedback-Analysis Method 871
11.7 The Stability Problem 871
11.8 Effect of Feedback on the Amplifier Poles 875
11.9 Stability Study Using Bode Plots 885
11.10 Frequency Compensation 889

Summary 895
Problems 896
# IN THIS CHAPTER YOU WILL LEARN 

1. The general structure of the negative-feedback amplifier and the basic principle that underlies its operation.
2. The advantages of negative feedback, how these come about, and at what cost.
3. The appropriate feedback topology to employ with amplifiers of each of the four types: voltage, current, transconductance, and transresistance.
4. An intuitive and insightful approach for the analysis of practical feedback-amplifier circuits.
5. Why and how negative-feedback amplifiers can become unstable (i.e., oscillate) and how to design the circuit to ensure stable performance.

## Introduction

Most physical systems incorporate some form of feedback. It is interesting to note, though, that the theory of negative feedback has been developed by electronics engineers. In his search for methods for the design of amplifiers with stable gain for use in transatlantic telephone repeaters, Harold Black, an electronics engineer with the Western Electric Company, invented the feedback amplifier in 1928. Since then, the technique has been so widely used that it is almost impossible to think of electronic circuits without some form of feedback, either implicit or explicit. Furthermore, the concept of feedback and its associated theory are currently used in areas other than engineering, such as in the modeling of biological systems.

Feedback can be either negative or positive. In amplifier design, negative feedback is applied to effect one or more of the following goals:

1. Desensitize the gain: that is, make the value of the gain less sensitive to variations in the values of circuit components, such as might be caused by changes in temperature.
2. Reduce nonlinear distortion: that is, make the output proportional to the input (in other words, make the gain constant, independent of signal level).
3. Reduce the effect of noise: that is, minimize the contribution to the output of unwanted electric signals generated, either by the circuit components themselves or by extraneous interference.
4. Control the input and output resistances: that is, raise or lower the input and output resistances by the selection of an appropriate feedback topology.
5. Extend the bandwidth of the amplifier.
All of the desirable properties above are obtained at the expense of a reduction in gain. It will be shown that the gain-reduction factor, called the amount of feedback, is the factor by which the circuit is desensitized, by which the input resistance of a voltage amplifier is increased, by which the bandwidth is extended, and so on. In short, the basic idea of negative feedback is to trade off gain for other desirable properties. This chapter is devoted to the study of negative-feedback amplifiers: their analysis, design, and characteristics.

Under certain conditions, the negative feedback in an amplifier can become positive and of such a magnitude as to cause oscillation. In fact, in Chapter 18 we will study the use of positive feedback in the design of oscillators and bistable circuits. Here, in this chapter, however, we are interested in the design of stable amplifiers. We shall therefore study the stability problem of negative-feedback amplifiers and their potential for oscillation.

It should not be implied, however, that positive feedback always leads to instability. In fact, positive feedback is quite useful in a number of nonregenerative applications, such as the design of active filters, which are studied in Chapter 17.

Before we begin our study of negative feedback, we wish to remind the reader that we have already encountered negative feedback in a number of applications. Almost all op-amp circuits (Chapter 2) employ negative feedback. Another popular application of negative feedback is the use of the emitter resistance $R_{E}$ to stabilize the bias point of bipolar transistors and to increase the input resistance, bandwidth, and linearity of a BJT amplifier. In addition, the source follower and the emitter follower both employ a large amount of negative feedback. The question then arises about the need for a formal study of negative feedback. As will be appreciated by the end of this chapter, the formal study of feedback provides an invaluable tool for the analysis and design of electronic circuits. Also, the insight gained by thinking in terms of feedback can be extremely profitable.

# 11.1 The General Feedback Structure 

### 11.1.1 Signal-Flow Diagram

Figure 11.1 shows the basic structure of a feedback amplifier. Rather than showing voltages and currents, Fig. 11.1 is a signal-flow diagram, where each of the quantities $x$ can represent either a voltage or a current signal. The basic amplifier is unilateral and has a gain $A$, known as the open-loop gain; thus its output $x_{o}$ is related to the input $x_{i}$ by

$$
x_{o}=A x_{i}
$$



Figure 11.1 General structure of the feedback amplifier. This is a signal-flow diagram, and the quantities $x$ represent either voltage or current signals.
The feedback network measures or samples the output signal $x_{o}$ and provides a feedback signal $x_{f}$ that is related to $x_{o}$ by the feedback factor $\beta$,

$$
x_{f}=\beta x_{o}
$$

It is assumed that connecting the feedback network to the amplifier output does not change the gain $A$ or the value of $x_{o}$; that is, the feedback network does not load the amplifier output. Also, the feedback network is unilateral.

The feedback signal $x_{f}$ is subtracted from the source signal $x_{s}$, which is the input to the complete feedback amplifier, ${ }^{1}$ to produce the signal $x_{i}$, which is the input to the basic amplifier,

$$
x_{i}=x_{s}-x_{f}
$$

Here we note that it is this subtraction that makes the feedback negative. In essence, negative feedback reduces the signal that appears at the input of the basic amplifier. Here, too, we assume that connecting the output of the feedback network to the amplifier input, through the subtractor or differencing circuit, does not change the gain $A$; that is, the feedback network does not load the amplifier input.

# 11.1.2 The Closed-Loop Gain 

The gain of the feedback amplifier, known as the closed-loop gain or the gain-with-feedback and denoted $A_{f}$, is defined as

$$
A_{f} \equiv \frac{x_{o}}{x_{s}}
$$

Combining Eqs. (11.1) through (11.3) provides the following expression for $A_{f}$ :

$$
A_{f}=\frac{A}{1+A \beta}
$$

The quantity $A \beta$ is called the loop gain, a name that follows from Fig. 11.1. For the feedback to be negative, the loop gain $A \beta$ must be positive; that is, the feedback signal $x_{f}$ should have the same sign as $x_{s}$, thus resulting in a smaller difference signal $x_{i}$. Equation (11.4) indicates that for positive $A \beta$ the gain with feedback $A_{f}$ will be smaller than the open-loop gain $A$ by a factor equal to $1+A \beta$, which is called the amount of feedback.

If, as is the case in many circuits, the loop gain $A \beta$ is large, $A \beta \gg 1$, then from Eq. (11.4) it follows that

$$
A_{f} \simeq \frac{1}{\beta}
$$

which is a very interesting result: When the loop gain is large, the gain of the feedback amplifier is almost entirely determined by the feedback network. Since the feedback network usually consists of passive components, which usually can be chosen to be as accurate as one wishes, the advantage of negative feedback in obtaining accurate, predictable, and stable gain

[^0]
[^0]:    ${ }^{1}$ In earlier chapters, we used the subscript "sig" for quantities associated with the signal source (e.g., $v_{\text {sig }}$ and $R_{\text {sig }}$ ). We did that to avoid confusion with the subscript " $s$," which is usually used with FETs to denote quantities associated with the source terminal of the transistor. At this point, however, it is expected that readers have become sufficiently familiar with the subject that the possibility of confusion is minimal. Therefore, we will revert to using the simpler subscript $s$ for signal-source quantities.
should be apparent. In other words, the overall gain will have very little dependence on the gain of the basic amplifier, $A$, a desirable property because the gain $A$ is usually a function of many manufacturing and application parameters, some of which might have wide tolerances. We have seen a dramatic illustration of all of these effects in op-amp circuits in Chapter 2, where the closed-loop gain is almost entirely determined by the feedback elements. Generally, we will consider $(1 / \beta)$ to be the ideal value of $A_{f}$.

Equations (11.1) through (11.3) can be combined to obtain the following expression for the feedback signal $x_{f}$ :

$$
x_{f}=\frac{A \beta}{1+A \beta} x_{s}
$$

Thus for $A \beta \gg 1$ we see that $x_{f} \simeq x_{s}$, which implies that the signal $x_{i}$ at the input of the basic amplifier is reduced to almost zero. Thus if a large amount of negative feedback is employed, the feedback signal $x_{f}$ becomes an almost identical replica of the input signal $x_{s}$. The difference between $x_{s}$ and $x_{f}$, which is $x_{i}$, is sometimes referred to as the error signal. ${ }^{2}$ Accordingly, the input differencing circuit is often also called a comparison circuit. (It is also known as a mixer.) An expression for $x_{i}$ can be easily determined as

$$
x_{i}=\frac{1}{1+A \beta} x_{s}
$$

from which we can verify that for $A \beta \gg 1, x_{i}$ becomes very small. An outcome of this property is the tracking of the two input terminals of an op amp. Observe that negative feedback reduces the signal that appears at the input terminals of the basic amplifier by the amount of feedback $(1+A \beta)$. As will be seen later, it is this reduction of input signal that results in the increased linearity of the feedback amplifier. ${ }^{3}$

# 11.1.3 The Loop Gain 

From the discussion above we see that the loop gain $A \beta$ is a very important-in fact, the most important-characteristic parameter of a feedback amplifier:

1. The sign of $A \beta$ determines the polarity of the feedback; the loop gain $A \beta$ must be positive for the feedback to be negative.
2. The magnitude of $A \beta$ determines how close the closed-loop gain $A_{f}$ is to the ideal value of $1 / \beta$.
3. The magnitude of $A \beta$ determines the amount of feedback $(1+A \beta)$ and hence, as we shall see in the next section, the magnitude of the various improvements in amplifier performance resulting from the negative feedback.
4. As we shall see in later sections, the inevitable variation of $A \beta$ with frequency can cause $A \beta$ to become negative, which in turn can cause the feedback amplifier to become unstable. It follows that the design of a stable feedback amplifier may involve modifying the frequency behaviors of its loop gain $A \beta$ appropriately (Section 11.10).
[^0]
[^0]:    ${ }^{2}$ This terminology is more common in feedback control systems than in feedback amplifiers.
    ${ }^{3}$ We have in fact already seen examples of this: adding a resistance $R_{s}$ in the emitter of a CE amplifier (or a resistance $R_{s}$ in the source of a CS amplifier) increases the linearity of these amplifiers because for the same input signal as before, $v_{b e}$ and $v_{g s}$ are now smaller (by the amount of feedback).


Figure 11.2 Determining the loop gain by breaking the feedback loop at the output of the basic amplifier, applying a test signal $x_{t}$, and measuring the returned signal $x_{r}: A \beta \equiv$ $-x_{r} / x_{t}$

The significance of the loop gain requires us to consider its determination. Reference to Fig. 11.1 indicates that the value of the loop gain $A \beta$ can be determined as follows:

1. Set $x_{r}=0$.
2. Break the feedback loop at a convenient location, ensuring that the values of $A$ and $\beta$ do not change. Since we assumed that the feedback network does not load the amplifier output, we can break the loop at the amplifier output (see Fig. 11.2) without causing $A$ to change.
3. Apply a test signal $x_{t}$ to the input of the loop (where the break has been made) and determine the returned signal $x_{r}$ at the loop output (i.e., at the other side of the break). From Fig. 11.2 we see that

$$
x_{r}=-A \beta x_{t}
$$

and the loop gain $A \beta$ is obtained as

$$
A \beta=-\frac{x_{r}}{x_{t}}
$$

We observe that since $A \beta$ is positive, the returned signal $x_{r}$ will be out of phase with the test signal $x_{t}$, verifying that the feedback is indeed negative. In fact, this approach is used qualitatively to ascertain the polarity of the feedback. We will have a lot more to say about the loop gain in subsequent sections.

# Example 11.1 

The noninverting op-amp configuration shown in Fig. 11.3(a) provides a direct implementation of the feedback loop of Fig. 11.1.
(a) Assume that the op amp has infinite input resistance and zero output resistance. Find an expression for the feedback factor $\beta$.
(b) Find the condition the open-loop gain $A$ must satisfy so that the closed-loop gain $A_{f}$ is almost entirely determined by the feedback network. Also, give the value of $A_{f}$ in this case.Example 11.1 continued


Figure 11.3 (a) A noninverting op-amp circuit for Example 11.1. (b) The circuit in (a) with the op amp replaced with its equivalent circuit.
(c) If the open-loop gain $A=10^{4} \mathrm{~V} / \mathrm{V}$, find $R_{2} / R_{1}$ to obtain a closed-loop gain $A_{f}$ of $10 \mathrm{~V} / \mathrm{V}$.
(d) What is the amount of feedback in decibels?
(e) If $V_{s}=1 \mathrm{~V}$, find $V_{o}, V_{f}$, and $V_{i}$.
(f) If $A$ decreases by $20 \%$, what is the corresponding decrease in $A_{f}$ ?

# Solution 

(a) To be able to see more clearly the direct correspondence between the circuit in Fig. 11.3(a) and the block diagram in Fig. 11.1, we replace the op amp with its equivalent-circuit model, as shown in Fig. 11.3(b). Since the op amp is assumed to have infinite input resistance and zero output resistance, its model is simply an ideal voltage-controlled voltage source of gain $A$. From Fig. 11.3(b) we observe that the feedback network, consisting of the voltage divider $\left(R_{1}, R_{2}\right)$, is connected directly to the output and feeds a signal $V_{f}$ to the inverting input terminal of the op amp. It is important at this point to note that the zero output resistance of the op amp causes the output voltage to be $A V_{s}$ irrespective of the values of $R_{1}$ and $R_{2}$. That is what we meant by the statement that in the block diagram of Fig. 11.1, the feedback network is assumed to not load the basic amplifier. Now we can easily determine the feedback factor $\beta$ from

$$
\beta \equiv \frac{V_{f}}{V_{o}}=\frac{R_{1}}{R_{1}+R_{2}}
$$

Let's next examine how $V_{f}$ is subtracted from $V_{s}$ at the input side. The subtraction is effectively performed by the differential action of the op amp; by its very nature, a differential-input amplifier takes the difference between the signals at its two input terminals. Observe also that because the input resistance of the op amp is assumed to be infinite, no current flows into the negative input terminal of the op amp and that the feedback network does not load the amplifier at the input side.
(b) The closed-loop gain $A_{f}$ is given by

$$
A_{f}=\frac{A}{1+A \beta}
$$
To make $A_{f}$ nearly independent of $A$, we must ensure that the loop gain $A \beta$ is much larger than unity

$$
A \beta \gg 1
$$

in which case

$$
A_{f} \simeq 1 / \beta
$$

Thus,

$$
A / A_{f} \gg 1
$$

or equivalently,

$$
A \gg A_{f}
$$

and

$$
A_{f} \simeq \frac{1}{\beta}=1+\frac{R_{2}}{R_{1}}
$$

(c) For $A=10^{4} \mathrm{~V} / \mathrm{V}$ and $A_{f}=10 \mathrm{~V} / \mathrm{V}$, we see that $A \gg A_{f}$, thus we can select $R_{1}$ and $R_{2}$ to obtain

$$
\beta \simeq \frac{1}{A_{f}}=0.1
$$

Thus,

$$
\frac{1}{\beta}=1+\frac{R_{2}}{R_{1}}=A_{f}=10
$$

which yields

$$
R_{2} / R_{1}=9
$$

A more exact value for the required ratio $R_{2} / R_{1}$ can be obtained from

$$
\begin{aligned}
& A_{f}=\frac{A}{1+A \beta} \\
& 10=\frac{10^{4}}{1+10^{4} \beta}
\end{aligned}
$$

which results in

$$
\beta=0.0999
$$

and,

$$
\frac{R_{2}}{R_{1}}=9.01
$$
# Example 11.1 continued 

(d) The amount of feedback is

$$
1+A \beta=\frac{A}{A_{f}}=\frac{10^{4}}{10}=1000
$$

which is 60 dB .
(e) For $V_{s}=1 \mathrm{~V}$,

$$
\begin{aligned}
& V_{o}=A_{f} V_{s}=10 \times 1=10 \mathrm{~V} \\
& V_{f}=\beta V_{o}=0.0999 \times 10=0.999 \mathrm{~V} \\
& V_{i}=\frac{V_{o}}{A}=\frac{10}{10^{4}}=0.001 \mathrm{~V}
\end{aligned}
$$

Note that if we had used the approximate value of $\beta=0.1$, we would have obtained $V_{f}=1 \mathrm{~V}$ and $V_{i}=0 \mathrm{~V}$.
(f) If A decreases by $20 \%$, thus becoming

$$
A=0.8 \times 10^{4} \mathrm{~V} / \mathrm{V}
$$

the value of $A_{f}$ becomes

$$
A_{f}=\frac{0.8 \times 10^{4}}{1+0.8 \times 10^{4} \times 0.0999}=9.9975 \mathrm{~V} / \mathrm{V}
$$

that is, it decreases by $0.025 \%$, which is less than the percentage change in $A$ by approximately a factor $(1+A \beta)$.

## EXERCISES

11.1 Repeat Example 11.1 (c) to (f) for $A=100 \mathrm{~V} / \mathrm{V}$.

Ans. (c) 10.11 ; (d) 20 dB ; (e) $10 \mathrm{~V}, 0.9 \mathrm{~V}, 0.1 \mathrm{~V}$; (f) $2.44 \%$
11.2 Repeat Example 11.1 (c) to (f) for $A_{f}=10^{3} \mathrm{~V} / \mathrm{V}$. For (e) use $V_{s}=0.01 \mathrm{~V}$.

Ans. (c) 1110.1 ; (d) 20 dB ; (e) $10 \mathrm{~V}, 0.009 \mathrm{~V}, 0.001 \mathrm{~V}$; (f) $2.44 \%$

### 11.1.4 Summary

We conclude this section by presenting in Table 11.1 a summary of the important parameters and formulas that characterize the ideal negative-feedback amplifier structure of Fig. 11.1.
Table 11.1 Summary of the Parameters and Formulas for the Ideal Feedback-Amplifier Structure of Fig. 11.1

- Open-loop gain $\equiv A$
- Feedback factor $\equiv \beta$
- Loop gain $\equiv A \beta$ (positive number)
- Amount of feedback $\equiv 1+A \beta$
- Closed-loop gain $\equiv A_{f}=\frac{x_{s}}{x_{s}}=\frac{A}{1+A \beta}$
- Feedback signal $\equiv x_{f}=\frac{A \beta}{1+A \beta} x_{s}$
- Input signal to basic amplifier $\equiv x_{i}=\frac{1}{1+A \beta} x_{s}$
- Closed-loop gain as a function of the ideal value $\frac{1}{\beta}: A_{f}=\left(\frac{1}{\beta}\right) \frac{1}{1+1 / A \beta}$
- For large loop gain, $A \beta \gg 1$,
$A_{f} \simeq \frac{1}{\beta} \quad x_{f} \simeq x_{s} \quad x_{i} \simeq 0$


# 11.2 Some Properties of Negative Feedback 

The properties of negative feedback were mentioned in the introduction. In the following, we shall consider some of these properties in more detail.

### 11.2.1 Gain Desensitivity

The effect of negative feedback on desensitizing the closed-loop gain was demonstrated in Example 11.1, where we saw that a $20 \%$ reduction in the gain of the basic amplifier gave rise to only a $0.025 \%$ reduction in the gain of the closed-loop amplifier. This sensitivity-reduction property can be analytically established as follows.

Assume that $\beta$ is constant. Taking differentials of both sides of Eq. (11.4) results in

$$
d A_{f}=\frac{d A}{(1+A \beta)^{2}}
$$

Dividing Eq. (11.9) by Eq. (11.4) yields

$$
\frac{d A_{f}}{A_{f}}=\frac{1}{(1+A \beta)} \frac{d A}{A}
$$

which says that the percentage change in $A_{f}$ (due to variations in some circuit parameter) is smaller than the percentage change in $A$ by a factor equal to the amount of feedback. For this reason, the amount of feedback, $1+A \beta$, is also known as the desensitivity factor.
# EXERCISE 

11.3 An amplifier with a nominal gain $A=1000 \mathrm{~V} / \mathrm{V}$ exhibits a gain change of $10 \%$ as the operating temperature changes from $25^{\circ} \mathrm{C}$ to $75^{\circ} \mathrm{C}$. If it is required to constrain the change to $0.1 \%$ by applying negative feedback, what is the largest closed-loop gain possible? If three of these feedback amplifiers are placed in cascade, what overall gain and gain stability are achieved?
Ans. $10 \mathrm{~V} / \mathrm{V} ; 1000 \mathrm{~V} / \mathrm{V}$, with a maximum variability of $0.3 \%$ over the specified temperature range.

### 11.2.2 Bandwidth Extension

Consider an amplifier whose high-frequency response is characterized by a single pole. Its gain at mid and high frequencies can be expressed as

$$
A(s)=\frac{A_{M}}{1+s / \omega_{H}}
$$

where $A_{M}$ denotes the midband gain and $\omega_{H}$ is the upper 3-dB frequency. Application of negative feedback, with a frequency-independent factor $\beta$, around this amplifier results in a closed-loop gain $A_{f}(s)$ given by

$$
A_{f}(s)=\frac{A(s)}{1+\beta A(s)}
$$

Substituting for $A(s)$ from Eq. (11.11) results, after a little manipulation, in

$$
A_{f}(s)=\frac{A_{M} /\left(1+A_{M} \beta\right)}{1+s / \omega_{H}\left(1+A_{M} \beta\right)}
$$

Thus the feedback amplifier will have a midband gain of $A_{M} /\left(1+A_{M} \beta\right)$ and an upper 3-dB frequency $\omega_{H f}$ given by

$$
\omega_{H f}=\omega_{H}\left(1+A_{M} \beta\right)
$$

It follows that the upper 3-dB frequency is increased by a factor equal to the amount of feedback.

Similarly, it can be shown that if the open-loop gain is characterized by a dominant low-frequency pole giving rise to a lower 3-dB frequency $\omega_{L}$, then the feedback amplifier will have a lower 3-dB frequency $\omega_{L f}$,

$$
\omega_{L f}=\frac{\omega_{L}}{1+A_{M} \beta}
$$

Note that the amplifier bandwidth is increased by the same factor by which its midband gain is decreased, maintaining the gain-bandwidth product at a constant value. This point is further illustrated by the Bode plot in Fig. 11.4.

Finally, note that the action of negative feedback in extending the amplifier bandwidth should not be surprising: Negative feedback works to minimize the change in gain magnitude, including its change with frequency.


Figure 11.4 Application of negative feedback reduces the midband gain, increases $f_{H}$, and reduces $f_{L}$, all by the same factor, $\left(1+A_{M} \beta\right)$, which is equal to the amount of feedback.

# EXERCISE 

11.4 Consider the noninverting op-amp circuit of Example 11.1. Let the open-loop gain $A$ have a low-frequency value of $10^{4}$ and a uniform $-6-\mathrm{dB} /$ octave rolloff at high frequencies with a $3-\mathrm{dB}$ frequency of 100 Hz . Find the low-frequency gain and the upper $3-\mathrm{dB}$ frequency of a closed-loop amplifier with $R_{1}=1 \mathrm{k} \Omega$ and $R_{2}=9 \mathrm{k} \Omega$.
Ans. $9.99 \mathrm{~V} / \mathrm{V} ; 100.1 \mathrm{kHz}$

### 11.2.3 Interference Reduction

Negative feedback can be employed to reduce the interference in an amplifier or, more precisely, to increase the ratio of signal to interference. However, as we shall now explain, this interference-reduction process is possible only under certain conditions. Consider the situation illustrated in Fig. 11.5. Figure 11.5(a) shows an amplifier with gain $A_{1}$, an input signal $V_{s}$, and interference, $V_{n}$. It is assumed that for some reason this amplifier suffers from interference and that the interference can be assumed to be introduced at the input of the amplifier. The signal-to-interference ratio for this amplifier is

$$
S / I=V_{s} / V_{n}
$$

Consider next the circuit in Fig. 11.5(b). Here we assume that it is possible to build another amplifier stage with gain $A_{2}$ that does not suffer from the interference problem. If this is the


Figure 11.5 Illustrating the application of negative feedback to improve the signal-to-interference ratio in amplifiers.
case, then we may precede our original amplifier $A_{1}$ by the clean amplifier $A_{2}$ and apply negative feedback around the overall cascade of such an amount as to keep the overall gain unchanged. The output voltage of the circuit in Fig. 11.5(b) can be found by superposition:

$$
V_{o}=V_{s} \frac{A_{1} A_{2}}{1+A_{1} A_{2} \beta}+V_{n} \frac{A_{1}}{1+A_{1} A_{2} \beta}
$$

Thus the signal-to-interference ratio at the output becomes

$$
\frac{S}{I}=\frac{V_{s}}{V_{o}} A_{2}
$$

which is $A_{2}$ times higher than in the original case.
We emphasize once more that the improvement in signal-to-interference ratio by the application of feedback is possible only if one can precede the interference-prone stage by a (relatively) interference-free stage. This situation, however, is not uncommon in practice. The best example is found in the output power-amplifier stage of an audio amplifier. Such a stage usually suffers from a problem known as power-supply hum. The problem arises because of the large currents that this stage draws from the power supply and because it is difficult to provide adequate power-supply filtering inexpensively. The power-output stage is required to provide large power gain but little or no voltage gain. We may therefore precede the power-output stage by a small-signal amplifier that provides large voltage gain and then apply a large amount of negative feedback, thus restoring the voltage gain to its original value. Since the small-signal amplifier can be fed from another, less hefty (and hence better regulated) power supply, it will not suffer from the hum problem. The
hum at the output will then be reduced by the amount of the voltage gain of this added preamplifier.

# EXERCISE 

11.5 Consider a power-output stage with voltage gain $A_{1}=1$, an input signal $V_{s}=1 \mathrm{~V}$, and a hum $V_{o}$ of 1 V . Assume that this power stage is preceded by a small-signal stage with gain $A_{2}=100 \mathrm{~V} / \mathrm{V}$ and that overall feedback with $\beta=1$ is applied. If $V_{s}$ and $V_{o}$ remain unchanged, find the signal and interference voltages at the output and hence the improvement in $S / I$.
Ans. $\simeq 1 \mathrm{~V} ; \simeq 0.01 \mathrm{~V} ; 100(40 \mathrm{~dB})$

### 11.2.4 Reduction in Nonlinear Distortion

Curve (a) in Fig. 11.6 shows the transfer characteristic $v_{O}$ versus $v_{I}$ of an amplifier. As indicated, the characteristic is piecewise linear, with the voltage gain changing from 1000 to 100 and then to 0 . This nonlinear transfer characteristic will result in this amplifier generating a large amount of nonlinear distortion.

The amplifier transfer characteristic can be considerably linearized (i.e., made less nonlinear) through the application of negative feedback. That this is possible should not be too surprising, since we have already seen that negative feedback reduces the dependence of the overall closed-loop amplifier gain on the open-loop gain of the basic amplifier. Thus large


Figure 11.6 Illustrating the application of negative feedback to reduce the nonlinear distortion in amplifiers. Curve (a) shows the amplifier transfer characteristic ( $v_{O}$ versus $v_{I}$ ) without feedback. Curve (b) shows the characteristic $\left(v_{O}\right.$ versus $\left.v_{S}\right)$ with negative feedback $(\beta=0.01)$ applied.
changes in open-loop gain (1000 to 100 in this case) give rise to much smaller corresponding changes in the closed-loop gain.

To illustrate, let us apply negative feedback with $\beta=0.01$ to the amplifier whose open-loop voltage transfer characteristic is depicted in Fig. 11.6. The resulting transfer characteristic of the closed-loop amplifier, $v_{O}$ versus $v_{S}$, is shown in Fig. 11.6 as curve (b). Here the slope of the steepest segment is given by

$$
A_{f 1}=\frac{1000}{1+1000 \times 0.01}=90.9
$$

and the slope of the next segment is given by

$$
A_{f 2}=\frac{100}{1+100 \times 0.01}=50
$$

Thus the order-of-magnitude change in slope has been considerably reduced. The price paid, of course, is a reduction in voltage gain. Thus if the overall gain has to be restored, a preamplifier should be added. This preamplifier should not present a severe nonlinear-distortion problem, since it will be dealing with smaller signals.

Finally, it should be noted that negative feedback can do nothing at all about amplifier saturation, since in saturation the gain is very small (almost zero) and hence the amount of feedback is almost unity.

# 11.3 The Feedback Voltage Amplifier 

Based on the quantity to be amplified (voltage or current) and on the desired form of output (voltage or current), amplifiers can be classified into four categories. These categories were discussed in Chapter 1. In this section we study the most common amplifier type: the voltage amplifier. We begin by identifying the appropriate configuration for applying negative feedback to a voltage amplifier. Then, we present a simple method for the analysis of the feedback voltage amplifier. The method makes use of the loop gain $A \beta$, whose determination was discussed in Section 11.1.3.

### 11.3.1 The Series-Shunt Feedback Topology

Voltage amplifiers are intended to amplify an input voltage signal and provide an output voltage signal. The voltage amplifier is essentially a voltage-controlled voltage source. The input resistance is required to be high, and the output resistance is required to be low. Since the signal source is essentially a voltage source, it is appropriately represented in terms of a Thévenin equivalent circuit. As the output quantity of interest is the output voltage, the feedback network should sample the output voltage, just as a voltmeter measures a voltage. Also, because of the Thévenin representation of the source, the feedback signal $x_{f}$ should be a voltage that can be mixed with the source voltage in series.

From the discussion above, it follows that the most suitable feedback topology for the voltage amplifier is the voltage-mixing, voltage-sampling one shown in Fig. 11.7. Because of the series connection at the input and the parallel or shunt connection at the output, this feedback topology is also known as series-shunt feedback. As will be shown, this topology not only stabilizes the voltage gain $V_{o} / V_{s}$ but also results in a higher input resistance $R_{\text {in }}$ (intuitively, a result of the series connection at the input) and a lower output resistance $R_{\text {out }}$


Figure 11.7 Block diagram of a feedback voltage amplifier. Here the appropriate feedback topology is series-shunt.
(intuitively, a result of the parallel connection at the output), which are desirable properties for a voltage amplifier.

The increased input resistance results because $V_{f}$ subtracts from $V_{s}$, resulting in a smaller signal $V_{i}$ at the input of the basic amplifier. The lower $V_{i}$, in turn, causes the input current to be smaller, with the result that the resistance seen by $V_{s}$ will be larger. We shall derive a formula for the input resistance of the feedback voltage amplifier in the next section.

The decreased output resistance results because the feedback works to keep $V_{o}$ as constant as possible. Thus if the current drawn from the amplifier output changes by $\Delta I_{o}$, the change $\Delta V_{o}$ in $V_{o}$ will be lower than it would have been if feedback were not present. Thus the output resistance $\Delta V_{o} / \Delta I_{o}$ will be lower than that of the open-loop amplifier. In the following section we shall derive an expression for the output resistance of the feedback voltage amplifier.

# 11.3.2 Examples of Series-Shunt Feedback Amplifiers 

Three examples of series-shunt feedback amplifiers are shown in Fig. 11.8. The amplifier in Fig. 11.8(a) is the familiar noninverting op-amp configuration. The feedback network, composed of the voltage divider $\left(R_{1}, R_{2}\right)$, develops a voltage $V_{f}$ that is applied to the negative input terminal of the op amp. The subtraction of $V_{f}$ from $V_{s}$ is achieved by utilizing the differencing action of the op-amp differential input. For the feedback to be negative, $V_{f}$ must be of the same polarity as $V_{s}$, thus resulting in a smaller signal at the input of the basic amplifier. To ascertain that this is the case, we follow the signal around the loop, as follows: As $V_{s}$ increases, $V_{o}$ increases and the voltage divider causes $V_{f}$ to increase. Thus the change in $V_{f}$ is of the same polarity as the change in $V_{s}$, and the feedback is negative.

The second feedback voltage amplifier, shown in Fig. 11.8(b), utilizes two MOSFET amplifier stages in cascade. The output voltage $V_{o}$ is sampled by the feedback network composed of the voltage divider $\left(R_{1}, R_{2}\right)$, and the feedback signal $V_{f}$ is fed to the source terminal of $Q_{1}$. The subtraction is implemented by applying $V_{s}$ to the gate of $Q_{1}$ and $V_{f}$ to its source, with the result that the signal at this amplifier input $V_{i}=V_{g s}=V_{s}-V_{f}$. To ascertain that the feedback is negative, let $V_{s}$ increase. The drain voltage of $Q_{1}$ will decrease, and since this is applied to the gate of $Q_{2}$, its drain voltage $V_{o}$ will increase. The feedback network will

Figure 11.8 Examples of a feedback voltage amplifier. All these circuits employ series-shunt feedback. Note that the dc bias circuits are only partially shown.
then cause $V_{f}$ to increase, which is the same polarity initially assumed for the change in $V_{s}$. Thus the feedback is indeed negative.

The third example of series-shunt feedback, shown in Fig. 11.8(c), utilizes a CG transistor $Q$ with a fraction $V_{f}$ of the output voltage $V_{o}$ fed back to the gate through a voltage divider $\left(R_{1}, R_{2}\right)$. Observe that the subtraction of $V_{f}$ from $V_{s}$ is effected by applying $V_{s}$ to the source, thus the input $V_{i}$ to the CG amplifier is obtained as $V_{s}-V_{f}$. As usual, however, we must check the polarity of the feedback: If $V_{s}$ increases, $V_{d}$ (which is $V_{o}$ ) will increase and $V_{f}$ will correspondingly increase. Thus $V_{f}$ and $V_{s}$ change in the same direction, verifying that the feedback is negative.
## FEEDBACKHISTORICAL NOTE:

The idea of feedback as an element of self-regulating behavior dates back to the eighteenth century, but the term itself did not appear in the context of a discussion on economics until the 1860s. Still later, in 1909, Karl Ferdinand Braun, a German physicist working at the University of Strasbourg, referred publicly to feedback as an undesired coupling between components of a vacuum-tube electronic system. The occasion was the lecture Braun delivered as a recipient of the Nobel Prize in Physics, shared with Guglielmo Marconi (often solely credited as the inventor of radio).

In 1927, Harold Black, at Bell Labs, invented the negative-feedback amplifier, which he described in detail in a seminal paper, "Stabilized Feedback Amplifiers," published in 1934. This invention was motivated by the need to provide low-distortion amplifiers that could be concatenated in long-distance transcontinental telephone circuits.

# 11.3.3 Analysis of the Feedback Voltage Amplifier Utilizing the Loop Gain 

The feedback analysis method studied in Section 11.1 cannot be directly applied to a practical feedback voltage amplifier such as those in Fig. 11.8. This is because the analysis method of Section 11.1 is predicated on the assumption that the feedback network does not load the basic amplifier. Unfortunately, this assumption does not hold in most practical amplifier circuits. As shown in the circuits of Fig. 11.8, the feedback network is a simple resistive circuit that obviously loads the basic amplifier. As an example, in the circuit of Fig. 11.8(b), the values of the resistances $R_{2}$ and $R_{1}$, which comprise the feedback network, affect the gain of the common-source stage $Q_{2}$, which is part of the basic amplifier. Also, the value of the feedback-network resistance $R_{1}$ affects the gain of the $Q_{1}$ amplifier stage, which is part of the basic amplifier. It follows that we cannot easily disassemble a practical amplifier circuit to determine $A$ and $\beta$ and thus be able to use the feedback formulas of Sections 11.1 and 11.2.

While it is not easy to determine $A$ and $\beta$, their product, the loop gain $A \beta$, can always be determined using the method presented in Section 11.1.3. Also, we can easily obtain the value of $\beta$ by identifying and isolating the feedback network (e.g., the resistive divider $\left(R_{1}, R_{2}\right)$ in each of the circuits in Fig. 11.8). We can then use the values of $A \beta$ and $\beta$ to determine $A$ and $A_{f}$. This loop-gain method is simple, and we shall use it in this section to perform the analysis of the feedback voltage amplifier. The method, however, has limitations that will be mentioned later. A more accurate and systematic approach for the analysis of feedback voltage amplifiers will be presented in the next section.

The loop-gain analysis method comprises four steps:

1. Identify the feedback network and use it to determine the value of $\beta$.
2. Determine the ideal value of the closed-loop gain $A_{f}$ as $1 / \beta$. This value of $A_{f}$ is approached when $A \beta \gg 1$. The ideal or upper-bound value of $A_{f}$ can be used in the initial design of the feedback amplifier. It also serves as a check on the actual value of $A_{f}$ calculated below.
3. Use the method described in Section 11.1.3 to determine the loop gain $A \beta$. Recall that in breaking the loop, care should be taken to not change the conditions in the loop. Thus, if we break a feedback loop at $\mathrm{XX}^{\prime}$, as shown in Fig. 11.9(a), and apply a test voltage $V_{t}$ to the terminals thus created to the left of $\mathrm{XX}^{\prime}$, the terminals to the right of $\mathrm{XX}^{\prime}$ must be connected to an impedance $Z_{t}$. The value of $Z_{t}$ is equal


Figure 11.9 Breaking the conceptual feedback loop in (a) to determine the loop gain requires the termination of the loop as shown in (b), to ensure that the loop conditions do not change.
to the impedance previously seen looking to the left of $\mathrm{XX}^{\prime}$. The loop gain is then determined from

$$
A \beta=-\frac{V_{r}}{V_{t}}
$$

Whenever possible, we should break the loop at a location where $Z_{t}$ is infinite.
4. Use the value of $A \beta$ together with that of $\beta$ to determine the open-loop gain $A$. Then, determine the closed-loop gain $A_{f}$ from

$$
A_{f}=\frac{A}{1+A \beta}
$$

We shall illustrate the application of the loop-gain method via two examples.

# Example 11.2 

For the series-shunt feedback amplifier of Fig. 11.8(b), neglect the MOSFETs' $r_{o}$ and
(a) give the feedback network ( $\beta$ circuit) and an expression for $\beta$. Also give an expression for the ideal or upper-bound value of the closed-loop gain $A_{f}$.
(b) find the ratio $R_{2} / R_{1}$ that results in an ideal closed-loop gain of $10 \mathrm{~V} / \mathrm{V}$. If $R_{1}=1 \mathrm{k} \Omega$, what value must $R_{2}$ have?
(c) find an expression for the loop gain $A \beta$.
(d) if $g_{m 1}=g_{m 2}=4 \mathrm{~mA} / \mathrm{V}$ and $R_{D 1}=R_{D 2}=10 \mathrm{k} \Omega$, determine the values of $A \beta, A$, and $A_{f}$.


Figure 11.10 Determining: (a) the feedback factor $\beta$; and (b) the loop gain $A \beta$ for the feedback voltage amplifier of Fig. 11.8(b).

# Solution 

(a) The feedback network is highlighted in Fig. 11.8(b) and is redrawn in Fig. 11.10(a). It is a simple resistive voltage divider. Thus,

$$
\beta=\frac{V_{f}}{V_{o}}=\frac{R_{1}}{R_{1}+R_{2}}
$$

For $A \beta \gg 1$, the closed-loop gain $A_{f}=V_{o} / V_{s}$ is given by

$$
A_{f} \simeq \frac{1}{\beta}=1+\frac{R_{2}}{R_{1}}
$$

This is the ideal or upper-bound value of $A_{f}$.
(b) For $A_{f}$ to have an ideal value of 10 ,

$$
10=1+\frac{R_{2}}{R_{1}}
$$

Thus,

$$
\frac{R_{2}}{R_{1}}=9
$$

For $R_{1}=1 \mathrm{k} \Omega, R_{2}=9 \mathrm{k} \Omega$.
(c) To determine the loop gain, we set $V_{s}=0$. Examining the feedback loop reveals that it is most convenient to break the loop at the connection between the drain of $Q_{1}$ and the gate of $Q_{2}$. This is
# Example 11.2 continued 

because of the infinite input impedance at the gate of $Q_{2}$. The resulting circuit is shown in Fig. 11.10(b), for which the analysis to determine $A \beta \equiv-V_{r} / V_{s}$ proceeds as follows:

$$
\begin{aligned}
I_{d 2} & =g_{m 2} V_{t} \\
I_{1} & =-I_{d 2} \frac{R_{D 2}}{R_{D 2}+R_{2}+\left(R_{1} \| \frac{1}{g_{m 1}}\right)} \\
I_{d 1} & =I_{1} \frac{R_{1}}{R_{1}+\frac{1}{g_{m 1}}} \\
V_{r} & =I_{d 1} R_{D 1}
\end{aligned}
$$

Combining these four equations results in

$$
A \beta \equiv-\frac{V_{r}}{V_{t}}=\left(g_{m 1} R_{D 1}\right)\left(g_{m 2} R_{D 2}\right) \frac{1}{1+g_{m 1} R_{1}} \frac{R_{1}}{R_{D 2}+R_{2}+\left(R_{1} \| \frac{1}{g_{m 1}}\right)}
$$

(d)

$$
\begin{aligned}
A \beta & =4 \times 10 \times 4 \times 10 \times \frac{1}{1+4 \times 1} \times \frac{1}{10+9+\left(1 \|\frac{1}{4}\right)} \\
& =16.67
\end{aligned}
$$

Since

$$
\begin{aligned}
& \beta=\frac{R_{1}}{R_{1}+R_{2}}=\frac{1}{1+9}=0.1 \\
& A=\frac{A \beta}{\beta}=\frac{16.67}{0.1}=166.7 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

and

$$
A_{f}=\frac{A}{1+A \beta}=\frac{166.7}{1+16.67}=\frac{166.7}{17.67}=9.43 \mathrm{~V} / \mathrm{V}
$$

which, given that the loop gain (16.67) is only moderately high, is reasonably close to the ideal value of $10 \mathrm{~V} / \mathrm{V}$.

## Example 11.3

In the series-shunt feedback amplifier of Fig. 11.11(a), the op amp has an input resistance $R_{o l}$, an open-circuit voltage gain $\mu$, and an output resistance $r_{o}$. Find expressions for $\beta$, the ideal value of $A_{f} \equiv V_{o} / V_{s}$, and the loop gain $A \beta$.


Figure 11.11 Example 11.3. (a) A series-shunt feedback amplifier; (b) the feedback loop obtained by setting $V_{s}=0$ and replacing the op amp with its equivalent-circuit model; (c) breaking the feedback loop to determine the loop gain $A \beta=-V_{s} / V_{i}$.

# Solution 

The feedback network consists of the voltage divider $\left(R_{1}, R_{2}\right)$, thus

$$
\beta=\frac{R_{1}}{R_{1}+R_{2}}
$$

and the ideal value of $A_{f}$ is

$$
A_{f}=\frac{1}{\beta}=1+\frac{R_{2}}{R_{1}}
$$

To determine the loop gain, we set $V_{s}=0$ and replace the op amp with its equivalent-circuit model. The resulting circuit is shown in Fig. 11.11(b). Next, we break the loop to apply a test voltage $V_{i}$ while terminating the loop at the break in an impedance equal to that seen prior to breaking the loop. The resulting circuit is shown in Fig. 11.11(c), where the loop has been broken at the input terminals of the op amp and the left-hand-side terminals are connected to a resistance equal to $R_{i d}$. Analysis of the circuit to determine
# Example 11.3 continued 

$A \beta \equiv-V_{s} / V_{i}$ involves repeated application of the voltage divider rule, resulting in

$$
\begin{aligned}
A \beta= & \mu \frac{\left\{R_{L} \|\left[R_{2}+R_{1} \|\left(R_{i d}+R_{s}\right)\right]\right\}}{\left\{R_{L} \|\left[R_{2}+R_{1} \|\left(R_{i d}+R_{s}\right)\right]\right\}+r_{o}} \times \\
& \frac{\left[R_{1} \|\left(R_{i d}+R_{s}\right)\right]}{\left[R_{1} \|\left(R_{i d}+R_{s}\right)\right]+R_{2}} \times \frac{R_{i d}}{R_{i d}+R_{s}}
\end{aligned}
$$

## EXERCISE

11.6 For the feedback voltage amplifier of Fig. 11.8(c):
(a) Find an expression for $\beta$.
(b) Neglecting the MOSFET $r_{o}$, find an expression for the loop gain $A \beta$. (Hint: Break the loop at the gate of $Q$.)
(c) Find an expression for the open-loop gain $A$.
(d) For $g_{m}=4 \mathrm{~mA} / \mathrm{V}, R_{D}=10 \mathrm{k} \Omega, R_{1}=20 \mathrm{k} \Omega$, and $R_{2}=80 \mathrm{k} \Omega$, find the values of $\beta, A \beta, A$, and the closed-loop gain $A_{f}$. What would $A_{f}$ be if $A \beta$ were much greater than unity?

Ans. (a) $\frac{R_{1}}{R_{1}+R_{2}}$; (b) $g_{m} \frac{R_{D} R_{1}}{R_{D}+R_{1}+R_{2}}$; (c) $g_{m} \frac{R_{D}\left(R_{1}+R_{2}\right)}{R_{D}+R_{1}+R_{2}}$; (d) $0.2,7.27,36.36 \mathrm{~V} / \mathrm{V}, 4.4 \mathrm{~V} / \mathrm{V}, 5 \mathrm{~V} / \mathrm{V}$.

### 11.3.4 A Final Remark

The loop-gain analysis method, though simple, is not complete: It does not enable us to find the input and output resistances of the feedback amplifier. This shortcoming is remedied in the next section, where we present a systematic approach to the analysis of feedback voltage amplifiers.

### 11.4 Systematic Analysis of Feedback Voltage Amplifiers

In this section we provide a systematic procedure for the analysis of feedback voltage amplifiers. The procedure essentially disassembles a given feedback voltage-amplifier circuit so as to obtain the " $A$ circuit," from which we can determine the open-loop gain $A$ and other parameters of the open-loop amplifier, such as the input and output resistances, and the " $\beta$ circuit" from which the value of the feedback factor $\beta$ can be found. We can then use the
feedback formulas to determine the characteristic parameters of the feedback amplifier, such as the closed-loop gain $A_{f}$ and the input and output resistances with feedback.

Our approach will be to first consider the ideal case in which the feedback network does not load the basic amplifier. Then, we consider the practical case in which not only does the feedback network load the basic amplifier, but also there is a finite source resistance $R_{s}$ and a finite load resistance $R_{L}$.

# 11.4.1 The Ideal Case 

As mentioned before, series-shunt is the appropriate feedback topology for a voltage amplifier. The ideal structure of the series-shunt feedback amplifier is shown in Fig. 11.12(a). It consists of a unilateral open-loop amplifier (the $A$ circuit) and an ideal voltage-sampling, voltage-mixing feedback network (the $\beta$ circuit). The $A$ circuit has an input resistance $R_{i}$, an open-circuit voltage gain $A$, and an output resistance $R_{o}$. It is assumed that the source is ideal with a zero resistance and that there is no load resistance. Furthermore, note that the $\beta$ circuit


Figure 11.12 The series-shunt feedback amplifier: (a) ideal structure; (b) equivalent circuit.
does not load the $A$ circuit; that is, connecting the $\beta$ circuit does not change the value of $A$ (defined as $A \equiv V_{o} / V_{i}$ ).

The circuit of Fig. 11.12(a) exactly follows the ideal feedback model of Fig. 11.1. Therefore the closed-loop voltage gain $A_{f}$ is given by

$$
A_{f} \equiv \frac{V_{o}}{V_{s}}=\frac{A}{1+A \beta}
$$

The equivalent-circuit model of the series-shunt feedback amplifier is shown in Fig. 11.12(b). Observe that $A_{f}$ is the open-circuit voltage gain of the feedback amplifier, $R_{i f}$ is its input resistance, and $R_{o f}$ is its output resistance. Expressions for $R_{i f}$ and $R_{o f}$ can be derived as follows.

For $R_{i f}$, refer to the input loop of the circuit in Fig. 11.12(a). The series mixing subtracts $V_{f}$ from $V_{s}$ and thus reduces $V_{i}$ by a factor equal to the amount of feedback (Eq. 11.7),

$$
V_{i}=\frac{V_{s}}{1+A \beta}
$$

Thus the input current $I_{i}$ becomes

$$
I_{i}=\frac{V_{i}}{R_{i}}=\frac{V_{s}}{(1+A \beta) R_{i}}
$$

Since $I_{i}$ is the current drawn from $V_{s}$, the input resistance $R_{i f}$ can be expressed as

$$
R_{i f} \equiv \frac{V_{s}}{I_{i}}
$$

and using Eq. (11.19) is found to be

$$
R_{i f}=(1+A \beta) R_{i}
$$

Thus, as expected, the series-mixing feedback results in an increase in the amplifier input resistance by a factor equal to the amount of feedback, $(1+A \beta)$, a highly desirable property for a voltage amplifier.

To determine the output resistance $R_{o f}$ of the feedback amplifier in Fig. 11.12(a), we set $V_{s}=0$ and apply a test voltage $V_{x}$ between the output terminals, as shown in Fig. 11.13. If the current drawn from $V_{s}$ is $I_{s}$, the output resistance $R_{o f}$ is

$$
R_{o f} \equiv \frac{V_{s}}{I_{s}}
$$

An equation for the output loop yields

$$
I_{s}=\frac{V_{s}-A V_{i}}{R_{o}}
$$

From the input loop we see that

$$
V_{i}=-V_{f}
$$

Now $V_{f}=\beta V_{o}=\beta V_{x}$; thus,

$$
V_{i}=-\beta V_{x}
$$


Figure 11.13 Determining the output resistance of the feedback amplifier of Fig. 11.12(a): $R_{o f}=V_{s} / I_{s}$.
which when substituted in Eq. (11.22) yields

$$
I_{s}=\frac{V_{s}(1+A \beta)}{R_{o}}
$$

Substituting this value of $I_{s}$ into Eq. (11.21) provides the following expression for $R_{o f}$,

$$
R_{o f}=\frac{R_{o}}{1+A \beta}
$$

Thus, as expected, the shunt sampling (or voltage sampling) at the output results in a decrease in the amplifier output resistance by a factor equal to the amount of negative feedback, $(1+A \beta)$, another highly desirable property for a voltage amplifier.

Although perhaps not entirely obvious, the reduction of the output resistance is a result only of the method of sampling the output and does not depend on the method of mixing. Thus, the transistance amplifier, which is the other amplifier type in which shunt (or voltage) sampling is employed, will also exhibit a reduced output resistance.

# 11.4.2 The Practical Case 

In a practical series-shunt feedback amplifier, the feedback network will not be an ideal voltage-controlled voltage source. Rather, as in the circuits of Fig. 11.8, the feedback network is usually resistive and hence will load the basic amplifier and thus affect the values of $A$, $R_{i}$, and $R_{o}$. In addition, there will be finite source and load resistances, which in turn will affect these three parameters. Thus the problem we have is as follows: Given a series-shunt feedback amplifier represented by the block diagram of Fig. 11.14(a), find the $A$ circuit and the $\beta$ circuit.

The problem in essence is to represent the general feedback voltage amplifier of Fig. 11.14(a) with the ideal structure of Fig. 11.12(a). The solution is presented, without derivation, in Fig. 11.14(b). We make the following observations.

1. The $A$ circuit is obtained by augmenting the basic amplifier at the input with the source resistance $R_{s}$ and a resistance $R_{11}$, and at the output with the load resistance $R_{L}$ and a resistance $R_{22}$. Resistances $R_{11}$ and $R_{22}$ represent the loading effect of the feedback network on the basic amplifier at the input and the output, respectively.
2. Resistance $R_{11}$ is the resistance looking into port 1 of the feedback network while port 2 is short-circuited. Resistance $R_{22}$ is the resistance looking into port 2 of the

Figure 11.14 (a) Block diagram of a practical series-shunt feedback amplifier. (b) The circuit in (a) represented by the ideal structure of Fig. 11.12(a). (c) Definition of $R_{11}$ and $R_{22}$. (d) Determination of the feedback factor $\beta$. (e) The $A$ circuit, showing the open-loop resistances $R_{s}$ and $R_{o}$.


Figure 11.14 continued
feedback network while port 1 is open-circuited. These definitions are illustrated in Fig. 11.14(c). Since the feedback network is connected in shunt with the output, shorting its port 2 destroys the feedback. Similarly, because the feedback network is connected in series with the input, opening its port 1 destroys the feedback. It follows that the loading effect of the feedback network is obtained by looking into its appropriate port while the other port is open-circuited or short-circuited so as to destroy the feedback. ${ }^{4}$
3. The feedback factor $\beta$ is the transmission from port 2 to port 1 of the feedback network, with port 1 open-circuited (which destroys the feedback). Reference to Fig. 11.14(c) shows that

$$
\beta \equiv\left.\frac{V_{f}}{V_{o}}\right|_{I_{1}=0}
$$

4. The open-loop gain $A$ can be obtained from the $A$ circuit in Fig. 11.14(e) as $A=\frac{V_{o}}{V_{i}}$
5. The values of $A$ and $\beta$ can be used to determine the closed-loop gain $A_{f}$,

$$
A_{f} \equiv \frac{V_{o}}{V_{s}}=\frac{A}{1+A \beta}
$$

6. The open-loop input resistance $R_{i}$ and output resistance $R_{o}$ can be determined from the $A$ circuit [see Fig. 11.14(e)]. These values can be used to determine the input and output resistances with feedback,

$$
\begin{aligned}
& R_{i f}=R_{i}(1+A \beta) \\
& R_{o f}=R_{o} /(1+A \beta)
\end{aligned}
$$

From Fig. 11.14(a) we see that $R_{i f}$ is the resistance seen by the ideal signal source $V_{s}$. The actual input resistance of the feedback amplifier $R_{\text {in }}$ excludes $R_{s}$ and is found from $R_{i f}$,

$$
R_{\mathrm{in}}=R_{i f}-R_{s}
$$

[^0]
[^0]:    ${ }^{4} \mathrm{~A}$ simple rule to remember: If the connection is shunt, short it; if series, sever it.
Similarly, $R_{o f}$ is the output resistance of the feedback amplifier including $R_{L}$. The actual output resistance excludes $R_{L}$ (see Fig. 11.14(a)) and is found from $R_{o f}$,

$$
R_{\text {out }}=1 /\left(\frac{1}{R_{o f}}-\frac{1}{R_{L}}\right)
$$

A final and important note: The representation in Fig. 11.14(b) is only approximately equivalent to the original circuit in Fig. 11.14(a). The approximation is a result of neglecting the small forward transmission in the feedback network relative to the much larger forward transmission in the basic amplifier. Also, recall that we continue to assume that the basic amplifier is unilateral-that is, it does not have internal feedback; all the feedback occurs in the feedback network and is represented by the feedback factor $\beta$.

# Example 11.4 

Figure 11.15(a) shows an op amp connected in the noninverting configuration. The op amp has an open-circuit voltage gain $\mu$, a differential input resistance $R_{a l}$, and an output resistance $r_{o}$. Recall that in our analysis of op-amp circuits in Chapter 2, we neglected the effects of $R_{a l}$ (assumed it to be infinite) and of $r_{o}$ (assumed it to be zero). Here we wish to use the feedback method to analyze the circuit taking both $R_{a l}$ and $r_{o}$ into account. Find expressions for $A, \beta$, the closed-loop gain $V_{o} / V_{i}$, the input resistance $R_{\text {in }}$ [see Fig. 11.15(a)], and the output resistance $R_{\text {out }}$. Also find numerical values, given $\mu=10^{4}, R_{a l}=100 \mathrm{k} \Omega$, $r_{o}=1 \mathrm{k} \Omega, R_{L}=2 \mathrm{k} \Omega, R_{1}=1 \mathrm{k} \Omega, R_{2}=1 \mathrm{M} \Omega$, and $R_{s}=10 \mathrm{k} \Omega$. Note that this circuit was analyzed in Example 11.3 using the loop-gain method and, where appropriate, compare results.

## Solution

We observe that the feedback network consists of $R_{2}$ and $R_{1}$. This network samples the output voltage $V_{o}$ and provides a voltage signal (across $R_{1}$ ) that is mixed in series with the input source $V_{i}$.

The $A$ circuit can be easily obtained following the rules of Fig. 11.14, and is shown in Fig. 11.15(b). Observe that the loading effect of the feedback network at the input side is obtained by short-circuiting port 2 of the feedback network (because it is connected in shunt) and looking into port 1 , with the result that $R_{11}=R_{1} \| R_{2}$. The loading effect of the feedback network at the output side is found by open-circuiting port 1 (because it is connected in series) and looking into port 2 , with the result that $R_{22}=R_{2}+R_{1}$. For the resulting $A$ circuit in Fig. 11.15(b), we can write by inspection:

$$
A \equiv \frac{V_{o}}{V_{i}}=\mu \frac{R_{L} \|\left(R_{1}+R_{2}\right)}{\left[R_{L} \|\left(R_{1}+R_{2}\right)\right]+r_{o}} \frac{R_{a l}}{R_{a l}+R_{s}+\left(R_{1} \| R_{2}\right)}
$$

For the values given, we find that $A \simeq 6000 \mathrm{~V} / \mathrm{V}$.
The circuit for determining $\beta$ is shown in Fig. 11.15(c), from which we obtain

$$
\beta \equiv \frac{V_{f}}{V_{o}}=\frac{R_{1}}{R_{1}+R_{2}} \simeq 10^{-3} \mathrm{~V} / \mathrm{V}
$$

Thus,

$$
A \beta=6000 \times 10^{-3}=6
$$


Figure 11.15 Circuits for Example 11.4.
and

$$
1+A \beta=7
$$

Identical results are obtained by substituting the given numerical values into the expression for $A \beta$ derived in Example 11.3.

The voltage gain with feedback can now be obtained as

$$
A_{f} \equiv \frac{V_{o}}{V_{s}}=\frac{A}{1+A \beta}=\frac{6000}{7}=857 \mathrm{~V} / \mathrm{V}
$$
# Example 11.4 continued 

The input resistance $R_{i f}$ determined by the feedback equations is the resistance seen by the external source (see Fig. 11.15a), and is given by

$$
R_{i f}=R_{i}(1+A \beta)
$$

where $R_{i}$ is the input resistance of the $A$ circuit in Fig. 11.15(b):

$$
R_{i}=R_{s}+R_{i d}+\left(R_{1} \| R_{2}\right)
$$

For the values given, $R_{i} \simeq 111 \mathrm{k} \Omega$, resulting in

$$
R_{i f}=111 \times 7=777 \mathrm{k} \Omega
$$

This, however, is not the resistance asked for. What is required is $R_{\mathrm{in}}$, indicated in Fig. 11.15(a). To obtain $R_{\text {in }}$ we subtract $R_{s}$ from $R_{i f}$ :

$$
R_{\mathrm{in}}=R_{i f}-R_{s}=767 \mathrm{k} \Omega
$$

The resistance $R_{o f}$ given by the feedback equations is the output resistance of the feedback amplifier, including the load resistance $R_{L}$, as indicated in Fig. 11.15(a). $R_{o f}$ is given by

$$
R_{o f}=\frac{R_{o}}{1+A \beta}
$$

where $R_{o}$ is the output resistance of the $A$ circuit. $R_{o}$ can be obtained by inspection of Fig.11.15(b) with $V_{i}$ set to zero, as

$$
R_{o}=r_{o}\left\|R_{L}\right\|\left(R_{2}+R_{1}\right)
$$

For the values given, $R_{o} \simeq 666 \Omega$, and

$$
R_{o f}=\frac{666}{7}=95.2 \Omega
$$

The resistance asked for, $R_{\text {out }}$, is the output resistance of the feedback amplifier excluding $R_{L}$. From Fig. 11.15(a) we see that

$$
R_{o f}=R_{\text {out }} \| R_{L}
$$

Thus

$$
R_{\text {out }} \simeq 100 \Omega
$$
# Example 11.5 

As another example of a series-shunt feedback amplifier, consider the circuit shown in Fig. 11.8(b), which we analyzed in Example 11.2 by determining the loop gain $A \beta$. In this example we wish to first analyze the circuit using our systematic procedure and then compare the results to those obtained in Example 11.2. For convenience, the circuit is repeated in Fig. 11.16(a). It is required to obtain the voltage gain $V_{o} / V_{s}$, input resistance $R_{\text {in }}$, and output resistance $R_{\text {out }}$. Find numerical values for the case $g_{m 1}=g_{m 2}=$ $4 \mathrm{~mA} / \mathrm{V}, R_{D 1}=R_{D 2}=10 \mathrm{k} \Omega, R_{1}=1 \mathrm{k} \Omega$, and $R_{2}=9 \mathrm{k} \Omega$. For simplicity, neglect $r_{o}$ of each of $Q_{1}$ and $Q_{2}$.


Figure 11.16 (a) Series-shunt feedback amplifier for Example 11.5; (b) the $A$ circuit; (c) the $\beta$ circuit.
# Example 11.5 continued 

## Solution

We identify the feedback network as the voltage divider $\left(R_{1}, R_{2}\right)$. Its loading effect at the input is obtained by short-circuiting its port 2 (because it is connected in shunt with the output). Then, looking into its port 1 , we see $R_{1} \| R_{2}$. The loading effect at the output is obtained by open-circuiting port 1 of the feedback network (because it is connected in series with the input). Then, looking into port 2 , we see $R_{2}$ in series with $R_{1}$. The $A$ circuit will therefore be as shown in Fig. 11.16(b). The gain $A$ is determined as the product of the gain of $Q_{1}$ and the gain of $Q_{2}$ as follows:

$$
\begin{aligned}
& A_{1}=\frac{V_{d 1}}{V_{i}}=-\frac{R_{D 1}}{1 / g_{m 1}+\left(R_{1} \| R_{2}\right)}=-\frac{g_{m 1} R_{D 1}}{1+g_{m 1}\left(R_{1} \| R_{2}\right)} \\
& A_{2}=\frac{V_{o}}{V_{d 1}}=-g_{m 2}\left[R_{D 2} \|\left(R_{1}+R_{2}\right)\right] \\
& A=\frac{V_{o}}{V_{i}}=A_{1} A_{2}=\frac{g_{m 1} R_{D 1} g_{m 2}\left[R_{D 2} \|\left(R_{1}+R_{2}\right)\right]}{1+g_{m 1}\left(R_{1} \| R_{2}\right)}
\end{aligned}
$$

For the numerical values given,

$$
A=\frac{4 \times 10 \times 4[10\|(1+9)]}{1+4(1\|9)}=173.9 \mathrm{~V} / \mathrm{V}
$$

which is reasonably close to the value of $166.7 \mathrm{~V} / \mathrm{V}$ obtained in Example 11.2.
The value of $\beta$ is determined from the $\beta$ circuit in Fig. 11.16(c),

$$
\beta \equiv \frac{V_{f}}{V_{o}}=\frac{R_{1}}{R_{1}+R_{2}}
$$

For the numerical values given,

$$
\beta=\frac{1}{1+9}=0.1
$$

The closed-loop gain $V_{o} / V_{s}$ can now be found as

$$
\frac{V_{o}}{V_{s}}=A_{f}=\frac{A}{1+A \beta}=\frac{173.9}{1+173.9 \times 0.1}=9.46 \mathrm{~V} / \mathrm{V}
$$

which is very close to the value of $9.43 \mathrm{~V} / \mathrm{V}$ obtained in Example 11.2.
The input resistance is obviously infinite because of the infinite input resistance of the MOSFET. The output resistance $R_{\text {out }}$ is obtained as follows,

$$
R_{\text {out }}=R_{o f}=\frac{R_{o}}{1+A \beta}
$$
where $R_{o}$ is the output resistance of the $A$ circuit. From Fig. 11.16(b),

$$
\begin{aligned}
R_{o} & =R_{D 2} \|\left(R_{1}+R_{2}\right) \\
& =10 \| 10=5 \mathrm{k} \Omega
\end{aligned}
$$

The amount of feedback is

$$
1+A \beta=1+(173.9 \times 0.1)=18.39
$$

Thus,

$$
R_{\text {out }}=\frac{5000}{18.39}=272 \Omega
$$

which is relatively low given that the open-loop amplifier has $R_{o}=5000 \Omega$. We finally note that the loop-gain method utilized in Example 11.2 cannot provide the input and output resistances because the $A$ circuit is not determined.

# EXERCISES 

11.7 If the op amp of Example 11.4 has a uniform $-6-\mathrm{dB} /$ octave high-frequency rolloff with $f_{\text {3dB }}=1 \mathrm{kHz}$, find the 3-dB frequency of the closed-loop gain $V_{o} / V_{s}$.
Ans. 7 kHz
11.8 The circuit shown in Fig. E11.18 consists of a differential stage followed by an emitter follower, with series-shunt feedback supplied by the resistors $R_{1}$ and $R_{2}$. Assuming that the dc component of $V_{s}$ is zero, and that $\beta$ of the BJTs is very high, find the dc operating current of each of the three transistors and show that the dc voltage at the output is approximately zero. Then find the values of $A, \beta, A_{f} \equiv V_{s} / V_{s}, R_{\text {in }}$, and $R_{\text {out }}$. Assume that the transistors have $\beta=100$.
Ans. $0.5 \mathrm{~mA}, 0.5 \mathrm{~mA}, 5 \mathrm{~mA} ; 85.7 \mathrm{~V} / \mathrm{V} ; 0.1 \mathrm{~V} / \mathrm{V} ; 8.96 \mathrm{~V} / \mathrm{V} ; 191 \mathrm{k} \Omega ; 19.1 \Omega$.


Figure E11.8
11.9 For the series-shunt amplifier in Fig. 11.8(c), which was considered in Exercise 11.6, find $A, \beta, A_{f}$, $R_{\text {in }}$, and $R_{\text {out }}$. Neglect $r_{o}$ of $Q$. Compare results to those obtained in Exercise 11.6.
Ans. $A=g_{m}\left[R_{D} \|\left(R_{1}+R_{2}\right)\right] ; \beta=R_{1} /\left(R_{1}+R_{2}\right)$;

$$
\begin{aligned}
A_{f} & =A /(1+A \beta) ; R_{\text {in }}=\left(1 / g_{m}\right)(1+A \beta) \\
R_{\text {out }} & =\left[R_{D} \|\left(R_{1}+R_{2}\right)\right] /(1+A \beta)
\end{aligned}
$$

Comparison: $A$ and $\beta$ are identical to the corresponding expressions found in Exercise 11.6. However, $R_{\text {in }}$ and $R_{\text {out }}$ cannot be determined using the method of Exercise 11.6.

# 11.5 Other Feedback-Amplifier Types 

Having studied in detail the most common feedback-amplifier type, the feedback voltage amplifier, we now consider the three other types of feedback amplifier: the feedback transconductance amplifier, the feedback current amplifier, and the feedback transresistance amplifier. The presentation builds on that of the feedback voltage amplifier, and the results will be given without derivation. The analysis method will be illustrated with a large number of worked-out examples dealing with practical and widely utilized circuits.

### 11.5.1 Basic Principles

1. Sensing: The feedback network must sample the output signal of interest. Thus if $V_{o}$ is the output signal of interest, as in the case of voltage and transresistance amplifiers, the feedback network is connected in parallel (or shunt) with the amplifier output node, just as a voltmeter is connected to measure a voltage. On the other hand, if $I_{o}$ is the output signal of interest, as in the case of transconductance and current amplifiers, the feedback network is connected in series with the output loop, just as a current meter is connected to measure a current.
2. Mixing: If the input signal to be amplified is a voltage, as in the case of voltage and transconductance amplifiers, the signal source is represented by its Thévenin equivalent and the feedback voltage signal $V_{f}$ is connected in series with the input signal source $V_{s}$. On the other hand, if the signal to be amplified is a current, as in the case of current and transresistance amplifiers, the Norton form is used to represent the signal source, and the feedback current signal $I_{f}$ is connected in parallel (shunt) with the input signal source $I_{s}$.
3. Feedback topology: From the above, it follows that for each of the four amplifier types there is a uniquely appropriate feedback topology:

| Amplifier Type | Appropriate Feedback Topology |
| :-- | :-- |
| Voltage | Series-Shunt |
| Transconductance | Series-Series |
| Current | Shunt-Series |
| Transresistance | Shunt-Shunt |
The appropriate feedback topology not only stabilizes the gain of interest (e.g., the transconductance $A_{f} \equiv I_{o} / V_{s}$ in a transconductance amplifier), but also makes the input and output resistances more ideal (e.g., the shunt-series topology decreases the input resistance and increases the output resistance of a current amplifier).
4. Input and output resistance: The increase or decrease of the input or output resistance depends solely on the type of connection: Series connection always increases the resistance; parallel (shunt) connection always decreases the resistance. Furthermore, the increase or decrease is always by the amount of feedback, $(1+A \beta)$. Thus, as an example, for the feedback current amplifier, the shunt connection at the input decreases the input resistance; $R_{i f}=R_{i} /(1+A \beta)$, and the series connection at the output increases the output resistance; $R_{o f}=(1+A \beta) R_{o}$, where $R_{i}$ and $R_{o}$ are the input and output resistances of the open-loop amplifier ( $A$ circuit).
5. Dimensions of $A, \beta, A \beta$, and $A_{f}$ : Depending on the amplifier type, $A, \beta$, and $A_{f}$ have the dimensions of V/V, A/A, V/A, or A/V. However, $A \beta$ is always dimensionless. For a feedback transconductance amplifier, for example, $A \equiv I_{o} / V_{i}(\mathrm{~A} / \mathrm{V}), \beta \equiv V_{f} / I_{o}$ $(\mathrm{V} / \mathrm{A}), A_{f} \equiv I_{o} / V_{s}(\mathrm{~A} / \mathrm{V})$, and $A \beta$ is in V/V or essentially dimensionless.
6. Analysis using the loop gain: For any feedback-amplifier type, the loop gain $A \beta$ can be determined using the method described in Section 11.3.3. The loop gain can then be used together with the feedback factor $\beta$ to determine the open-loop gain $A$ and hence the closed-loop gain $A_{f}$. This approach, however, does not enable the determination of the input and output resistances of the feedback amplifier. For these, we need to obtain the $A$ circuit using the systematic analysis approach described below.

# Example 11.6 

Figure 11.17(a) shows a feedback transconductance amplifier utilizing an op amp together with an NMOS transistor. The feedback network consists of a resistor $R_{F}$ that senses the output current $I_{o}$ (recall that the drain and source currents of the MOSFET are equal) and provides a feedback voltage that is subtracted from $V_{s}$ by means of the differencing action of the op-amp input. Observe that the feedback topology is series-series, which is uniquely appropriate for transconductance amplifiers.
(a) Find $\beta$ and hence the closed-loop gain $A_{f} \equiv I_{o} / V_{s}$ obtained when $A \beta \gg 1$.
(b) Replace the op amp with its equivalent-circuit model characterized by an open-circuit voltage gain $\mu$, an input differential resistance $R_{i d}$, and an output resistance $r_{o 1}$. Also, replace the MOSFET with its hybrid- $\pi$ model characterized by a transconductance $g_{m}$ and an output resistance $r_{o 2}$. With the complete equivalent circuit in hand, set $V_{s}=0$ and break the loop to determine $A \beta$.
(c) Use $A \beta$ together with $\beta$ to find $A$.
(d) For $\mu=1000, R_{i d}=100 \mathrm{k} \Omega, g_{m}=2 \mathrm{~mA} / \mathrm{V}, r_{o 2}=20 \mathrm{k} \Omega$, and $R_{F}=1 \mathrm{k} \Omega$, find the values of $\beta, A \beta$, $A$, and $A_{f}$. Compare $A_{f}$ to the ideal value obtained when $A \beta \gg 1$.Example 11.6 continued


Figure 11.17 Example 11.6.
# Solution 

(a) The two-port feedback network is shown in Fig. 11.17(b). When port 2 is fed with a current $I_{o}$ the voltage $V_{f}$ appearing across port 1 is $I_{o} R_{F}$, thus

$$
\beta=R_{F}
$$

When $A \beta \gg 1$,

$$
A_{f} \equiv \frac{I_{o}}{V_{s}} \simeq \frac{1}{\beta}=\frac{1}{R_{F}}
$$

(b) Figure 11.7(c) shows the equivalent-circuit model of the feedback transconductance amplifier. To determine $A \beta$, we set $V_{s}=0$ and break the loop at the input terminals of the op amp as shown in Fig. 11.17(d). Note that we have applied an input voltage $V_{i}$ and terminated the loop at the break in the resistance $R_{s d}$ to prevent any change in the loop conditions. This circuit can be easily analyzed to determine $A \beta \equiv-V_{s} / V_{i}$ as follows:

$$
\begin{aligned}
V_{g s} & =\mu V_{s}-\left(-V_{s}\right)=\mu V_{i}+V_{s} \\
-V_{r} & =g_{m} V_{g s}\left(R_{F}\left\|R_{s d}\right\| r_{o 2}\right)
\end{aligned}
$$

Combining these two equations yields

$$
A \beta \equiv-\frac{V_{s}}{V_{i}}=\mu \frac{g_{m}\left(R_{F}\left\|R_{s d}\right\| r_{o 2}\right)}{1+g_{m}\left(R_{F}\left\|R_{s d}\right\| r_{o 2}\right)}
$$

(c) Substituting $\beta=R_{F}$ provides

$$
A=\frac{\mu}{R_{F}} \frac{g_{m}\left(R_{F}\left\|R_{s d}\right\| r_{o 2}\right)}{1+g_{m}\left(R_{F}\left\|R_{s d}\right\| r_{o 2}\right)}
$$

(d) For the given numerical values,

$$
\begin{aligned}
\beta & =1 \mathrm{k} \Omega \\
A \beta & =1000 \times \frac{2(1\|100\| 20)}{1+2(1\|100\| 20)} \\
& =653.6 \\
A & =653.6 \mathrm{~mA} / \mathrm{V} \\
A_{f} & \equiv \frac{I_{o}}{V_{s}}=\frac{653.6}{1+653.6}=0.9985 \mathrm{~mA} / \mathrm{V}
\end{aligned}
$$

Since the ideal value of $A_{f}$ is $1 \mathrm{~mA} / \mathrm{V}$, the actual $A_{f}$ is only $0.15 \%$ lower than ideal.
# EXERCISES 

11.10 For the circuit in Example 11.6, let the op-amp gain decrease by $10 \%$. What is the corresponding percentage change in $A_{f} \equiv I_{o} / V_{s}$ ?
Ans. $-0.02 \%$
D11.11 Redesign the circuit in Example 11.6 to obtain a nominal closed-loop transconductance of $2 \mathrm{~mA} / \mathrm{V}$. What is the required value of $R_{F}$, and what is the actual transconductance $A_{f}$ realized?
Ans. $R_{F}=500 \Omega ; A_{f}=1.996 \mathrm{~mA} / \mathrm{V}$

### 11.5.2 The Feedback Transconductance Amplifier (Series-Series)

Figure 11.18(a) shows the ideal structure of the feedback transconductance amplifier. The open-loop amplifier ( $A$ circuit) is unilateral, has an input resistance $R_{i}$, a short-circuit transconductance gain $A$ in $\mathrm{A} / \mathrm{V}$, and an output resistance $R_{o}$. The short-circuit output current $I_{o}=A V_{i}$ is sensed by the feedback network. Note that since the resistance looking into port 2 of the feedback network is zero, the feedback network does not load the amplifier output. The feedback network provides at port 1 a voltage signal $V_{f}=\beta I_{o}$, where the feedback factor $\beta$ has the dimensions of V/A. The feedback signal is connected in series with the input signal source $V_{s}$, and the feedback network does not load the amplifier input. Finally, note the definitions of the input resistance with feedback, $R_{i f}$, and the output resistance with feedback, $R_{o f}$. The latter is the resistance found by looking into the output loop between any two nodes such as $O$ and $O^{\prime}$.

The equivalent circuit of the feedback transconductance amplifier is shown in Fig. 11.18(b). Note that the closed-loop gain $A_{f}$ is the ratio of the short-circuit output current $I_{o}$ and the input voltage $V_{s}$, thus it is the short-circuit transconductance of the feedback amplifier. Also, $R_{o f}$ is the resistance seen between any two nodes in the output loop, such as $O$ and $O^{\prime}$, while $V_{s}$ is set to zero. Finally, Fig. 11.18(c) provides the formulas for determining $A_{f}, R_{i f}$, and $R_{o f}$.

With the ideal case in hand, we now consider the general or practical case of a feedback transconductance amplifier, shown in Fig. 11.19(a). To be able to apply feedback analysis to this circuit, we have to find the $A$ circuit and $\beta$. These are shown in Fig. 11.19(b). The $A$ circuit is obtained by augmenting the basic amplifier with $R_{s}$ and $R_{L}$ and the two resistances $R_{11}$ and $R_{22}$, which represent the loading effect of the feedback network on the basic amplifier at the input and output, respectively. Figure 11.19(b) shows how $R_{11}$ and $R_{22}$ are determined. Here, the series connection at both the input and the output means that the other port of the feedback network must be left open-circuited. This is also the case when $\beta$ is determined.

(b) Equivalent Circuit

(c) Formulas

$$
\begin{aligned}
& A_{f}=\frac{I_{o}}{V_{s}}=\frac{A}{1+A \beta} \\
& R_{i f}=(1+A \beta) R_{i} \\
& R_{o f}=(1+A \beta) R_{o}
\end{aligned}
$$

Figure 11.18 The feedback transconductance amplifier (series-series).

Finally Fig. 11.19(c) gives the formulas for determining the actual values of the input and output resistances, $R_{\mathrm{in}}$ and $R_{\text {out }}$, of the feedback amplifier from $R_{i f}$ and $R_{o f}$. To see how these formulas come about, note from Fig. 11.19(a) that unlike $R_{i f}, R_{\mathrm{in}}$ does not include $R_{s}$, and unlike $R_{o f}, R_{\text {out }}$ does not include $R_{L}$.
(a) General Structure

(b) Finding the $A$ Circuit and $\beta$
(i) The $A$ circuit is

(ii) $\beta$ is obtained from


$$
\beta \equiv\left.\frac{V_{f}}{I_{o}}\right|_{I_{1}=0}
$$

(c) Gain, Input, and Output Resistance

- Use the formulas in Fig. 11.18 to find $A_{f}, R_{i f}$, and $R_{o f}$.
- $R_{\text {in }}$ and $R_{\text {out }}$ can then be found from

$$
\begin{aligned}
R_{\mathrm{in}} & =R_{i f}-R_{i} \\
R_{\text {out }} & =R_{o f}-R_{L}
\end{aligned}
$$

Figure 11.19 The feedback transconductance amplifier (series-series).
# Example 11.7 

Figure 11.20(a) shows a feedback transconductance amplifier composed of a differential amplifier $A_{1}$ with an input differential resistance $R_{i d}$, an open-circuit voltage gain $A_{1}$, and an output resistance $R_{o 1}$, connected in cascade with a common source MOSFET $Q_{2}$ having a transconductance $g_{m 2}$ and an output resistance $r_{o 2}$. Use the feedback-analysis method to determine the closed-loop transconductance $A_{F} \equiv I_{o} / V_{i}$, the input resistance $R_{\text {in }}$, and the output resistance $R_{\text {out }}$. The latter is the resistance seen between the terminals of $R_{L}$, looking back into the output loop.


Figure 11.20 Circuits for Example 11.7.
# Example 11.7 continued 

## Solution

First we identify the basic amplifier and the feedback circuit. The basic amplifier consists of the differential amplifier $A_{1}$ cascaded with the CS PMOS transistor $Q_{2}$. The output current $I_{o}$ is sensed by the series resistance $R_{F}$. The latter is the feedback network (Fig. 11.20b). It develops a voltage $V_{f}$ that is mixed in series with the input loop.

The second step is to ascertain that the feedback is negative. This can be done by assuming an increase in $V_{s}$ and following the resulting change around the loop. An increase in $V_{s}$ will cause the voltage at the inverting input terminal of $A_{1}$ to increase. This in turn causes a decrease in the output voltage of $A_{1}$, which is the voltage at the gate of $Q_{2}$. Thus, transistor $Q_{2}$ will have a larger $V_{S G}$, which will cause $I_{o}$ to increase. This in turn causes an increase in the voltage across $R_{F}$, which is the same polarity as the change in $V_{s}$. Thus, the feedback is indeed negative.

Next, we determine an approximate value for $A_{f} \equiv I_{o} / V_{s}$ under the assumption that the loop gain $A \beta$ is much greater than unity. This value, found before any analysis is undertaken, will help us determine at the end whether our analysis is correct: If the loop gain is found to be much greater than unity, then the final $A_{f}$ should be close to the value initially determined. From the circuit of Fig. 11.20(d),

$$
\beta=R_{F}
$$

and thus for large $A \beta$,

$$
A_{f} \simeq \frac{1}{\beta}=\frac{1}{R_{F}}
$$

Next, we determine the $A$ circuit. Since the feedback network (Fig. 11.20b) is connected in series with both the input and output loops, we include a resistance $R_{F}$ in each of these loops (which is equivalent to saying we include, at the input, the input resistance of the feedback circuit with port 2 open and, at the output, the input resistance of the feedback circuit with port 1 open). Doing this, including $R_{s}$ and $R_{L}$ in the $A$ circuit, and replacing $A_{1}$ and $Q_{2}$ with their small-signal models, results in the $A$ circuit shown in Fig. 11.20(c). Analysis of this circuit is straightforward:

$$
\begin{gathered}
V_{s d}=-V_{i} \frac{R_{s d}}{R_{s d}+R_{s}+R_{F}} \\
V_{g s 2}=A_{1} V_{s d} \\
I_{o}=-g_{m 2} V_{g s 2} \frac{r_{o 2}}{r_{o 2}+R_{L}+R_{F}}
\end{gathered}
$$

Combining these three equations results in

$$
A \equiv \frac{I_{o}}{V_{s}}=\left(A_{1} g_{m 2}\right)\left(\frac{R_{s d}}{R_{s d}+R_{s}+R_{F}}\right)\left(\frac{r_{o 2}}{r_{o 2}+R_{L}+R_{F}}\right)
$$

Usually $R_{s d} \gg\left(R_{s}+R_{F}\right), r_{o 2} \gg\left(R_{L}+R_{F}\right)$, resulting in the approximate expression for $A$ :

$$
A \simeq A_{1} g_{m 2}
$$
The input resistance $R_{i}$ can be found by inspection as

$$
R_{i}=R_{s}+R_{o 1}+R_{F}
$$

The output resistance $R_{o}$ is found by setting $V_{i}=0$, and breaking the output loop at any location, say between $D_{2}$ and $D_{2}^{\prime}$. Thus,

$$
R_{o}=r_{o 2}+R_{L}+R_{F}
$$

The loop gain $A \beta$ is thus

$$
\begin{aligned}
A \beta & =\left(A_{1} g_{m 2} R_{F}\right)\left(\frac{R_{o f}}{R_{o f}+R_{s}+R_{F}}\right)\left(\frac{r_{o 2}}{r_{o 2}+R_{L}+R_{F}}\right) \\
& \simeq A_{1} g_{m 2} R_{F}
\end{aligned}
$$

With numerical values, one can now obtain the value of $A \beta$ and determine whether it is indeed much greater than unity. We next determine the closed-loop gain

$$
A_{f}=\frac{A}{1+A \beta}
$$

Substituting for $A$ from Eq. (11.31) and for $A \beta$ from Eq. (11.35), we have

$$
A_{f} \simeq \frac{A_{1} g_{m 2}}{1+A_{1} g_{m 2} R_{F}}
$$

For $A_{1} g_{m 2} R_{F} \gg 1$,

$$
A_{f} \simeq \frac{1}{R_{F}}
$$

which is the value we found at the outset.
The series mixing raises the input resistance with feedback,

$$
R_{i f}=R_{i}(1+A \beta)
$$

and $R_{i n}$ can be obtained by subtracting $R_{s}$ from $R_{i f}$.
To obtain $R_{o f}$, we note that the series connection at the output raises the output resistance, thus,

$$
R_{o f}=R_{o}(1+A \beta)
$$

and $R_{\text {out }}$, which is the resistance seen by $R_{L}$, can be obtained by subtracting $R_{L}$ from $R_{o f}$.
# EXERCISES 

D11.12 For the circuit analyzed in Example 11.7, select a value for $R_{F}$ that will result in $A_{f} \simeq 5 \mathrm{~mA} / \mathrm{V}$. Now, for $A_{1}=200 \mathrm{~V} / \mathrm{V}, g_{m 2}=2 \mathrm{~mA} / \mathrm{V}, R_{a l}=100 \mathrm{k} \Omega, r_{o 2}=20 \mathrm{k} \Omega$, and assuming that $R_{s} \ll R_{a l}$ and $R_{L} \ll r_{o 2}$, find the value of $A_{f}$ realized and the input and output resistances of the feedback transconductance amplifier. If for some reason $g_{m 2}$ drops in value by $50 \%$, what is the corresponding percentage change in $A_{f}$ ?
Ans. $200 \Omega ; 4.94 \mathrm{~mA} / \mathrm{V} ; 8.1 \mathrm{M} \Omega ; 1.64 \mathrm{M} \Omega ;-1.25 \%$
11.13 Determine the loop gain of the feedback amplifier of Fig. 11.20(a) by setting $V_{s}=0$, breaking the feedback loop at $G_{2}$, applying a voltage $V_{g 2}$, and determining the voltage $V_{o 1}$ that appears at the output of $A_{1} ; A \beta \equiv-V_{o 1} / V_{g 2}$. Assume $R_{F} \ll\left(R_{a l}+R_{s}\right)$ and $r_{o 2} \gg R_{L}+R_{F}$.
Ans. $A \beta \simeq A_{1} g_{m 2} R_{F}$
11.14 Utilizing the full expression for $A \beta$ in Eq. (11.34) but assuming that $r_{o 2} \gg R_{L}+R_{F}$ and $R_{F} \ll R_{a l}$, show that

$$
R_{\mathrm{m}} \simeq R_{a l}\left(1+A_{1} g_{m 2} R_{F}\right)
$$

11.15 Utilizing the full expression for $A \beta$ in Eq. (11.34) but assuming that $R_{a l} \gg R_{s}+R_{F}$ and $R_{F} \ll r_{o 2}$ show that

$$
R_{\mathrm{out}} \simeq r_{o 2}\left(1+A_{1} g_{m 2} R_{F}\right)
$$

## Example 11.8

Because negative feedback extends the amplifier bandwidth, it is commonly used in the design of broadband amplifiers. One such amplifier is the MC1553. Part of the circuit of the MC1553 is shown in Fig. 11.21(a). The circuit shown (called a feedback triple) is composed of three gain stages with series-series feedback provided by the network composed of $R_{E 1}, R_{F}$, and $R_{E 2}$.

Observe that the feedback network samples the emitter current $I_{o}$ of $Q_{3}$, and thus $I_{o}$ is the output quantity of the feedback amplifier. However, practically speaking, $I_{o}$ is rather difficult to utilize. Thus it is usual to take as the output $I_{c}$, the collector current of $Q_{3}$. This current is of course almost equal to $I_{o} ; I_{c}=\alpha I_{o}$. Thus, as a transconductance amplifier with $I_{c}$ as the output current, the output resistance of interest is that labeled $R_{\text {out }}$ in Fig. 11.21(a). In some applications, $I_{c}$ is passed through a load resistance, such as $R_{C 3}$, and the voltage $V_{o}$ is taken as the output. Assume that the bias circuit, which is not shown, establishes $I_{C 1}=0.6 \mathrm{~mA}, I_{C 2}=1 \mathrm{~mA}$, and $I_{C 3}=4 \mathrm{~mA}$. Also assume that for all three transistors, ${ }^{*} h_{f e}=100$ and $r_{o}=\infty$.

[^0]
[^0]:    *To avoid possible confusion of the BJT current gain $\beta$ and the feedback factor $\beta$, we sometimes use $h_{f e}$ to denote the transistor $\beta$.

(a)

(b)

(c)

(d)

Figure 11.21 Circuits for Example 11.8.# Example 11.8 continued 

(a) Anticipating that the loop gain will be large, find an approximate expression and value for the closed-loop gain $A_{f} \equiv I_{o} / V_{s}$ and hence for $I_{c} / V_{s}$. Also find $V_{o} / V_{s}$.
(b) Use feedback analysis to find $A, \beta, A_{f}, V_{s} / V_{s}, R_{\mathrm{in}}$, and $R_{\text {out }}$. For the calculation of $R_{\text {out }}$, assume that $r_{o}$ of $Q_{3}$ is $25 \mathrm{k} \Omega$.

## Solution

(a) When $A \beta \gg 1$,

$$
A_{f} \equiv \frac{I_{o}}{V_{s}} \simeq \frac{1}{\beta}
$$

where the feedback factor $\beta$ can be found from the feedback network. The feedback network is highlighted in Fig. 11.21(a), and the determination of the value of $\beta$ is illustrated in Fig. 11.21(b), from which we find

$$
\begin{aligned}
\beta & \equiv \frac{V_{f}}{I_{o}}=\frac{R_{E 2}}{R_{E 2}+R_{F}+R_{E 1}} \times R_{E 1} \\
& =\frac{100}{100+640+100} \times 100=11.9 \Omega
\end{aligned}
$$

Thus,

$$
\begin{aligned}
A_{f} & \simeq \frac{1}{\beta} \\
& =\frac{1}{R_{E 2}}\left(1+\frac{R_{E 2}+R_{F}}{R_{E 1}}\right) \\
& =\frac{1}{11.9}=84 \mathrm{~mA} / \mathrm{V} \\
\frac{I_{o}}{V_{s}} & \simeq \frac{I_{o}}{V_{s}}=84 \mathrm{~mA} / \mathrm{V} \\
\frac{V_{o}}{V_{s}} & =\frac{-I_{c} R_{C 2}}{V_{s}}=-84 \times 0.6=-50.4 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

(b) Employing the loading rules given in Fig. 11.19, we obtain the $A$ circuit shown in Fig. 11.21(c). To find $A \equiv I_{o} / V_{i}$ we first determine the gain of the first stage. This can be written by inspection as

$$
\frac{V_{e 1}}{V_{i}}=\frac{-\alpha_{1}\left(R_{C 1} \| r_{\alpha 2}\right)}{r_{e 1}+\left[R_{E 1} \|\left(R_{F}+R_{E 2}\right)\right]}
$$

Since $Q_{1}$ is biased at $0.6 \mathrm{~mA}, r_{e 1}=41.7 \Omega$. Transistor $Q_{2}$ is biased as 1 mA ; thus $r_{\alpha 2}=h_{b} / g_{m 2}=100 / 40=$ $2.5 \mathrm{k} \Omega$. Substituting these values together with $\alpha_{1}=0.99, R_{C 1}=9 \mathrm{k} \Omega, R_{E 1}=100 \Omega, R_{F}=640 \Omega$, and $R_{E 2}=100 \Omega$, results in

$$
\frac{V_{e 1}}{V_{i}}=-14.92 \mathrm{~V} / \mathrm{V}
$$
Next, we determine the gain of the second stage, which can be written by inspection (noting that $V_{b 2}=V_{c 1}$ ) as

$$
\frac{V_{c 2}}{V_{c 1}}=-g_{m 2}\left\{R_{C 2} \|\left(h_{f e}+1\right)\left[r_{e 3}+\left(R_{E 2} \|\left(R_{F}+R_{E 1}\right)\right)\right]\right\}
$$

Substituting $g_{m 2}=40 \mathrm{~mA} / \mathrm{V}, R_{C 2}=5 \mathrm{k} \Omega, h_{f e}=100, r_{e 3}=25 / 4=6.25 \Omega, R_{E 2}=100 \Omega, R_{F}=640 \Omega$, and $R_{E 1}=100 \Omega$ results in

$$
\frac{V_{c 2}}{V_{c 1}}=-131.2 \mathrm{~V} / \mathrm{V}
$$

Finally, for the third stage we can write by inspection

$$
\begin{aligned}
\frac{I_{o}}{V_{c 2}} & =\frac{I_{e 3}}{V_{b 3}}=\frac{1}{r_{e 3}+\left(R_{E 2} \|\left(R_{F}+R_{E 1}\right)\right)} \\
& =\frac{1}{6.25+(100 \| 740)}=10.6 \mathrm{~mA} / \mathrm{V}
\end{aligned}
$$

Combining the gains of the three stages results in

$$
\begin{aligned}
A \equiv \frac{I_{o}}{V_{t}} & =-14.92 \times-131.2 \times 10.6 \times 10^{-3} \\
& =20.7 \mathrm{~A} / \mathrm{V}
\end{aligned}
$$

The closed-loop gain $A_{f}$ can now be found from

$$
\begin{aligned}
A_{f} \equiv \frac{I_{o}}{V_{s}} & =\frac{A}{1+A \beta} \\
& =\frac{20.7}{1+20.7 \times 11.9}=83.7 \mathrm{~mA} / \mathrm{V}
\end{aligned}
$$

which we note is very close to the ideal value found in (a) above. This is not surprising, since the loop gain $A \beta=20.7 \times 11.9=246.3$ is large $(\gg 1)$.

The voltage gain is found from

$$
\begin{aligned}
\frac{V_{o}}{V_{s}} & =\frac{-I_{s} R_{C 3}}{V_{s}} \simeq \frac{-I_{o} R_{C 3}}{V_{s}}=-A_{f} R_{C 3} \\
& =-83.7 \times 10^{-3} \times 600=-50.2 \mathrm{~V} / \mathrm{V}
\end{aligned}
$$

which is also very close to the approximate value found in (a) above.
# Example 11.8 continued 

The input resistance of the feedback amplifier is given by

$$
R_{\mathrm{in}}=R_{i f}=R_{i}(1+A \beta)
$$

where $R_{i}$ is the input resistance of the $A$ circuit. The value of $R_{i}$ can be found from the circuit in Fig. 11.21(c) as follows:

$$
\begin{aligned}
R_{i} & =\left(h_{f e}+1\right)\left[r_{e 1}+\left(R_{E 1} \|\left(R_{F}+R_{E 2}\right)\right)\right] \\
& =13.11 \mathrm{k} \Omega
\end{aligned}
$$

Thus,

$$
R_{i f}=13.11(1+20.7 \times 11.9)=3.24 \mathrm{M} \Omega
$$

To determine the output resistance $R_{\text {out }}$, which is the resistance looking into the collector of $Q_{3}$, we face a dilemma. The feedback does not sample $I_{c}$ and thus we cannot employ the feedback formulas directly. ${ }^{6}$ Nevertheless, we present a somewhat indirect solution to this problem below. Here we note parenthetically that had $Q_{1}$ been a MOSFET, this problem would not have existed, since $I_{d}=I_{s}$.

Since the feedback senses the emitter current $I_{o}$, the output resistance given by the feedback analysis will be the resistance seen in the emitter circuit, say between $Y$ and $Y^{\prime}$,

$$
R_{o f}=R_{o}(1+A \beta)
$$

where $R_{o}$ can be determined from the $A$ circuit in Fig. 11.21(c) by breaking the circuit between $Y$ and $Y^{\prime}$. The resistance looking between these two nodes can be found to be

$$
R_{o}=\left[R_{E 2} \|\left(R_{F}+R_{E 1}\right)\right]+r_{e 3}+\frac{R_{C 2}}{h_{f e}+1}
$$

which, for the values given, yields $R_{o}=143.9 \Omega$. The output resistance $R_{o f}$ of the feedback amplifier can now be found as

$$
R_{o f}=R_{o}(1+A \beta)=143.9(1+20.7 \times 11.9)=35.6 \mathrm{k} \Omega
$$

[^0]
[^0]:    ${ }^{6}$ This important point was first brought to the authors' attention by Gordon Roberts (see Roberts and Sedra, 1992).
We can now use the value of $R_{o f}$ to obtain an approximate value for $R_{\text {out }}$. To do this, we assume that the effect of the feedback is to place a resistance $R_{o f}(35.6 \mathrm{k} \Omega)$ in the emitter of $Q_{3}$, and find the output resistance from the equivalent circuit shown in Fig. 11.21(d). This is the output resistance of a BJT with a resistance $R_{o f}$ in its emitter and a resistance $R_{C 2}$ in its base. The formula we have for this (Eq. 8.66) does not unfortunately account for a resistance in the base. The formula, however, can be modified (see Problem 11.54) to obtain

$$
\begin{aligned}
R_{\text {out }} & =r_{o 3}+\left[R_{o f} \|\left(r_{\pi 3}+R_{C 2}\right)\right]\left[1+g_{m 3} r_{o 3} \frac{r_{\pi 3}}{r_{\pi 3}+R_{C 2}}\right] \\
& =25+[35.6\|(0.625+5)]\left[1+160 \times 25 \times \frac{0.625}{0.625+5}\right] \\
& =2.19 \mathrm{M} \Omega
\end{aligned}
$$

Thus $R_{\text {out }}$ is increased (from $r_{o 3}$ ) but not by $(1+A \beta)$.

# EXERCISES 

D11.16 For the feedback triple in Fig. 11.21(a), analyzed in Example 11.8, modify the value of $R_{F}$ to obtain a closed-loop transconductance $I_{o} / V_{s}$ of approximately $100 \mathrm{~mA} / \mathrm{V}$. Assume that the loop gain remains large. What is the new value of $R_{F}$ ? For this value, what is the approximate value of the voltage gain if the output voltage is taken at the collector of $Q_{3}$ ?
Ans. $800 \Omega ;-60 \mathrm{~V} / \mathrm{V}$
11.17 Determine the loop gain of the feedback amplifier of Fig. 11.21(a). Set $V_{s}=0$, break the loop between the collector of $Q_{1}$ and the base of $Q_{2}$, apply a voltage $V_{t}$ to the base of $Q_{2}$, and connect a resistance equal to $r_{\pi 2}$ between the collector of $Q_{1}$ and ground. Find $A \beta$ as $\left(-V_{s} / V_{t}\right)$ where $V_{s}=V_{c 1}$.
Ans. $A \beta=248.9$ (slightly different from the value found in Example 11.8 because of the approximations inherent in the systematic feedback-analysis method).

### 11.5.3 The Feedback Transresistance Amplifier (Shunt-Shunt)

Figure 11.22(a) shows the ideal feedback transresistance amplifier, which, as expected, utilizes the shunt-shunt topology. The amplifier equivalent circuit is shown in Fig. 11.22(b), with the formulas for determining $A_{f}, R_{i f}$, and $R_{o f}$ given in Fig. 11.22(c).
(a) Ideal Structure

(b) Equivalent Circuit

(c) Formulas

$$
\begin{aligned}
& A_{f} \equiv \frac{V_{o}}{I_{o}}=\frac{A}{1+A \beta} \\
& R_{i f}=R_{i} /(1+A \beta) \\
& R_{o f}=R_{o} /(1+A \beta)
\end{aligned}
$$

Figure 11.22 The feedback transresistance amplifier (shunt-shunt).

Application of the feedback-analysis method to a general transresistance amplifier is shown in Fig. 11.23, which presents all the steps and formulas needed. The method is now illustrated by a detailed example.
(a) General Structure

(b) Finding the $A$ Circuit and $\beta$
(i) The $A$ circuit is

(ii) $\beta$ is obtained from


$$
\beta \equiv \frac{I_{f}}{V_{o}} \left\lvert\,_{V_{1}=0}\right.
$$

(c) Gain, Input, and Output Resistance

- Use the formulas in Fig. 11.21 to find $A_{f}, R_{i f}$, and $R_{o f}$.
- $R_{\text {in }}$ and $R_{\text {out }}$ can then be found from

$$
\begin{aligned}
R_{\text {in }} & =1 /\left(\frac{1}{R_{i f}}-\frac{1}{R_{s}}\right) \\
R_{\text {out }} & =1 /\left(\frac{1}{R_{o f}}-\frac{1}{R_{L}}\right)
\end{aligned}
$$

Figure 11.23 The feedback transresistance amplifier (shunt-shunt).
# Example 11.9 

Figure 11.24(a) shows a feedback transresistance amplifier. It is formed by connecting a resistance $R_{F}$ in the negative-feedback path of a voltage amplifier with gain $\mu$, an input resistance $R_{i d}$, and an output resistance $r_{o}$. The amplifier $\mu$ can be implemented with an op amp, a simple differential amplifier, a single-ended inverting amplifier, or, in the limit, a single-transistor CE or CS amplifier. The latter case will be considered in Exercise 11.18. Of course, the higher the gain $\mu$, the more ideal the characteristics of the feedback transresistance amplifier will be, simply because of the concomitant increase in loop gain.
(a) If the loop gain is large, find an approximate expression for the closed-loop transresistance $V_{o} / I_{s}$ of the feedback amplifier.
(b) Find the $A$ circuit and expressions for $A, R_{i}$, and $R_{o}$.
(c) Find expressions for the loop gain, $A_{f}, R_{i f}, R_{\text {in }}, R_{i f}$, and $R_{\text {out }}$.
(d) Find the values of $R_{i}, R_{o}, A, \beta, A \beta, A_{f}, R_{i f}, R_{\text {in }}, R_{o f}$, and $R_{\text {out }}$ for the case $\mu=10^{4} \mathrm{~V} / \mathrm{V}, R_{i d}=\infty$, $r_{o}=100 \Omega, R_{F}=10 \mathrm{k} \Omega$, and $R_{s}=R_{L}=1 \mathrm{k} \Omega$.
(e) If instead of a current source $I_{s}$ having a source resistance $R_{s}=1 \mathrm{k} \Omega$, the amplifier is fed from a voltage source $V_{s}$ having a source resistance $R_{s}=1 \mathrm{k} \Omega$, find an expression for and the value of the voltage gain $V_{o} / V_{s}$.

## Solution

(a) If the loop gain $A \beta$ is large,

$$
A_{f} \equiv \frac{V_{o}}{I_{s}} \simeq \frac{1}{\beta}
$$

where $\beta$ can be found from the $\beta$ circuit in Fig. 11.24(b) as shown in Fig. 11.24(c),

$$
\beta \equiv \frac{I_{s}}{V_{o}}=-\frac{1}{R_{F}}
$$

Thus,

$$
\frac{V_{o}}{I_{s}} \simeq-R_{F}
$$

Note that in this case the voltage at the input node (the inverting input terminal of $\mu$ ) will be very close to ground and thus very little, if any, current flows into the input terminal of the amplifier. Nearly all of $I_{s}$ will flow through $R_{F}$, resulting in $V_{o} \simeq 0-I_{s} R_{F}=-I_{s} R_{F}$. This should be reminiscent of the inverting op-amp configuration studied in Section 2.2.
(b) From the feedback network in Fig. 11.24(b), we see that the loading effect at the amplifier input and output will simply be $R_{F}$. This is indicated in the $A$ circuit shown in Fig. 11.24(c), where we have replaced the amplifier $\mu$ with its equivalent-circuit model. The open-loop transresistance $A$ can be obtained as follows:

$$
V_{i d}=I_{i} R_{i}
$$


Figure 11.24 (a) A feedback transresistance amplifier; (b) the $\beta$ circuit; (c) determining $\beta$; (d) the $A$ circuit.
# Example 11.9 continued 

where

$$
\begin{aligned}
& R_{i}=R_{s l} \| R_{F} \| R_{s} \\
& V_{o}=-\mu V_{o l} \frac{\left(R_{F} \| R_{L}\right)}{r_{o}+\left(R_{F} \| R_{L}\right)}
\end{aligned}
$$

Combining Eqs. (11.38) and (11.40) gives

$$
A \equiv \frac{V_{o}}{I_{i}}=-\mu R_{i} \frac{\left(R_{F} \| R_{L}\right)}{r_{o}+\left(R_{F} \| R_{L}\right)}
$$

The open-loop output resistance can be obtained by inspection of the $A$ circuit with $I_{i}$ set to 0 . We see that $V_{o l}=0$, and

$$
R_{o}=r_{o}\left\|R_{F}\right\| R_{L}
$$

(c) The loop gain $A \beta$ can be obtained by combining Eqs. (11.37) and (11.41),

$$
A \beta=\mu\left(\frac{R_{i}}{R_{F}}\right) \frac{\left(R_{F} \| R_{L}\right)}{r_{o}+\left(R_{F} \| R_{L}\right)}
$$

Observe that although both $A$ and $\beta$ are negative, $A \beta$ is positive, a comforting fact confirming that the feedback is negative. Also note that $A \beta$ is dimensionless, as it must always be.

The closed-loop gain $A_{f}$ can now be found as

$$
A_{f} \equiv \frac{V_{o}}{I_{i}}=\frac{A}{1+A \beta}
$$

Thus

$$
A_{f}=\frac{-\mu R_{i} \frac{\left(R_{F} \| R_{L}\right)}{r_{o}+\left(R_{F} \| R_{L}\right)}}{1+\mu \frac{R_{i}}{R_{F}} \frac{\left(R_{F} \| R_{L}\right)}{r_{o}+\left(R_{F} \| R_{L}\right)}}
$$

Note that the condition of $A \beta \gg 1$ that results in $A_{f} \simeq-R_{F}$ corresponds to

$$
\mu\left(\frac{R_{i}}{R_{F}}\right) \frac{\left(R_{F} \| R_{L}\right)}{r_{o}+\left(R_{F} \| R_{L}\right)} \gg 1
$$
The input resistance with feedback, $R_{i f}$, is obtained by dividing $R_{i}$ by $(1+A \beta)$ with the result

$$
R_{i f}=\frac{R_{i}}{1+A \beta}
$$

or

$$
\frac{1}{R_{i f}}=\frac{1}{R_{i}}+\frac{A \beta}{R_{i}}=\frac{1}{R_{i}}+\frac{\mu}{R_{F}} \frac{\left(R_{F} \| R_{L}\right)}{r_{o}+\left(R_{F} \| R_{L}\right)}
$$

Substituting for $R_{i}$ from Eq. (11.39) and replacing $\mu\left(R_{F} \| R_{L}\right) /\left[r_{o}+\left(R_{F} \| R_{L}\right)\right]$ by $\mu^{\prime}$, where $\mu^{\prime}$ is lower than but usually close to the value of $\mu$, results in

$$
R_{i f}=R_{i d}\left\|R_{F}\right\| R_{s} \|\left(R_{F} / \mu^{\prime}\right)
$$

The two terms containing $R_{F}$ can be combined,

$$
R_{i f}=R_{s}\left\|R_{i d}\right\|\left[R_{F} /\left(\mu^{\prime}+1\right)\right]
$$

Since $R_{i f}=R_{s} \| R_{\mathrm{in}}$, we see that

$$
R_{\mathrm{in}}=R_{i d} \|\left[R_{F} /\left(\mu^{\prime}+1\right)\right]
$$

Usually $R_{i d}$ is large and thus

$$
R_{\mathrm{in}} \simeq \frac{R_{F}}{\mu^{\prime}+1} \simeq \frac{R_{F}}{\mu^{\prime}}
$$

from which we observe that for large amplifier gain $\mu$, the input resistance will be low.
The output resistance with feedback $R_{o f}$ can be found by dividing $R_{o}$ by $(1+A \beta)$ :

$$
R_{o f}=\frac{R_{o}}{1+A \beta}
$$

Thus,

$$
\begin{aligned}
\frac{1}{R_{o f}} & =\frac{1}{R_{o}}+\frac{A \beta}{R_{o}} \\
& =\frac{1}{R_{o}}+\mu \frac{R_{i}}{R_{F}} \frac{\left(R_{F} \| R_{L}\right)}{r_{o}+\left(R_{F} \| R_{L}\right)} \frac{1}{R_{o}}
\end{aligned}
$$# Example 11.9 continued 

Substituting for $R_{o}$ from Eq. (11.42),

$$
\begin{aligned}
\frac{1}{R_{o f}} & =\frac{1}{R_{L}}+\frac{1}{R_{F}}+\frac{1}{r_{o}}+\mu \frac{R_{i}}{R_{F}} \frac{1}{r_{o}} \\
& =\frac{1}{R_{L}}+\frac{1}{R_{F}}+\frac{1}{r_{o}}\left(1+\mu \frac{R_{i}}{R_{F}}\right)
\end{aligned}
$$

Thus,

$$
R_{o f}=R_{L}\left\|R_{F}\right\| \frac{r_{o}}{1+\mu \frac{R_{i}}{R_{F}}}
$$

Since, moreover,

$$
R_{o f}=R_{L} \| R_{\text {out }}
$$

we obtain for $R_{\text {out }}$

$$
R_{\text {out }}=R_{F} \| \frac{r_{o}}{1+\mu \frac{R_{i}}{R_{F}}}
$$

Usually $R_{F} \gg r_{o} /\left[1+\mu\left(R_{i} / R_{F}\right)\right]$; thus,

$$
R_{\text {out }} \simeq \frac{r_{o}}{1+\mu \frac{R_{i}}{R_{F}}} \simeq\left(\frac{R_{F}}{R_{i}}\right)\left(\frac{r_{o}}{\mu}\right)
$$

from which we see that for large $\mu$, the output resistance will be considerably reduced.
(d) For the numerical values given:

$$
\begin{aligned}
R_{i} & =R_{o f}\left\|R_{F}\right\| R_{s} \\
& =\infty\|10\| 1=0.91 \mathrm{k} \Omega \\
R_{o} & =r_{o}\left\|R_{F}\right\| R_{s} \\
& =0.1\|10\| 1=90 \Omega \\
A & =-\mu R_{s} \frac{\left(R_{F} \| R_{L}\right)}{r_{o}+\left(R_{F} \| R_{L}\right)}
\end{aligned}
$$
$$
\begin{aligned}
& =-10^{4} \times 0.91 \times \frac{(10 \| 1)}{0.1+(10 \| 1)}=-8198 \mathrm{k} \Omega \\
\beta & =-\frac{1}{R_{F}}=-\frac{1}{10}=-0.1 \mathrm{~mA} / \mathrm{V} \\
A \beta & =819.8 \\
1+A \beta & =820.8 \\
A_{f} & =\frac{A}{1+A \beta}=-\frac{8198}{820.8}=-9.99 \mathrm{k} \Omega
\end{aligned}
$$

which is very close to the ideal value of $-R_{F}=-10 \mathrm{k} \Omega$.

$$
\begin{aligned}
& R_{i f}=\frac{R_{i}}{1+A \beta}=\frac{910}{820.8}=1.11 \Omega \\
& R_{\text {in }}=\frac{1}{\frac{1}{R_{i f}}-\frac{1}{R_{i}}}-\frac{1}{\frac{1}{1.11}-\frac{1}{1000}} \simeq 1.11 \Omega
\end{aligned}
$$

which is very low, a highly desirable property. We also have

$$
\begin{aligned}
& R_{o f}=\frac{R_{o}}{1+A \beta}=\frac{90}{820.8}=0.11 \Omega \\
& R_{o u t}=\frac{1}{\frac{1}{R_{o f}}-\frac{1}{R_{L}}}=\frac{1}{\frac{1}{0.11}-\frac{1}{1000}} \simeq 0.11 \Omega
\end{aligned}
$$

which as well is very low, another highly desirable property.
(e) If the amplifier is fed with a voltage source $V_{s}$ having a resistance $R_{s}=1 \mathrm{k} \Omega$, the output voltage can be found from

$$
V_{o}=A_{f} I_{s}=A_{f} \frac{V_{s}}{R_{s}}
$$

Thus,

$$
\frac{V_{o}}{V_{s}}=\frac{A_{f}}{R_{s}}=\frac{9.99 \mathrm{k} \Omega}{1 \mathrm{k} \Omega}=-9.99 \mathrm{~V} / \mathrm{V}
$$
# EXERCISES 

11.18 It is required to determine the loop gain of the amplifier of Fig. 11.24(a) directly. Set $I_{s}=0$, replace the amplifier $\mu$ with its equivalent circuit, and break the loop at the amplifier input, ensuring that a resistance equal to $R_{a l}$ is connected across $R_{s}$. Show that

$$
A \beta=\frac{\mu R_{L}\left(R_{a l} \| R_{s}\right)}{r_{o}\left[R_{L}+R_{F}+\left(R_{a l} \| R_{s}\right)\right]+R_{L}\left[R_{F}+\left(R_{a l} \| R_{s}\right)\right]}
$$

Evaluate $A \beta$ using the numerical values given in Example 11.9.
Ans. $A \beta=819.7$
11.19 For the transresistance amplifier in Fig. E11.19, replace the MOSFET with its small-signal equivalent-circuit model and use feedback analysis to show the following:


Figure E11.19
(a) For large loop gain (which cannot be achieved here), $A_{f} \equiv V_{o} / I_{s} \simeq-R_{F}$.
(b) $A_{f}=\frac{-\left(R_{s} \| R_{F}\right) g_{m}\left(r_{o} \| R_{F}\right)}{1+\left(R_{s} \| R_{F}\right) g_{m}\left(r_{o} \| R_{F}\right) / R_{F}}$
(c) $R_{m}=\frac{R_{F}}{\left[1+g_{m}\left(r_{o} \| R_{F}\right)\right]}$
(d) $R_{\text {out }}=r_{o} \| \frac{R_{F}}{1+g_{m}\left(R_{s} \| R_{F}\right)}$
(e) For $g_{m}=5 \mathrm{~mA} / \mathrm{V}, r_{o}=20 \mathrm{k} \Omega, R_{F}=10 \mathrm{k} \Omega$, and $R_{s}=1 \mathrm{k} \Omega$, find $A, \beta, A \beta, A_{f} R_{i}, R_{o}, R_{i f}, R_{i u}, R_{o f}$, and $R_{\text {out }}$.
Ans. (e) $-30.3 \mathrm{k} \Omega ;-0.1 \mathrm{~mA} / \mathrm{V} ; 3.03 ;-7.52 \mathrm{k} \Omega$ (compare to the ideal value of $-10 \mathrm{k} \Omega$ ); $909 \Omega$; $6.67 \mathrm{k} \Omega ; 226 \Omega ; 291 \Omega ; 1.66 \mathrm{k} \Omega ; 1.66 \mathrm{k} \Omega$
# 11.5.4 The Feedback Current Amplifier (Shunt-Series) 

Figure 11.25(a) shows the ideal feedback current amplifier, which, as expected, utilizes the shunt-series topology. The amplifier equivalent circuit is shown in Fig. 11.25(b), with the formulas for determining $A_{f}, R_{i f}$, and $R_{o f}$ given in Fig. 11.25(c).

Figure 11.26 shows how the feedback-analysis method can be applied to a general feedback current amplifier. All the necessary analysis steps and the formulas are given. The method is now illustrated by a detailed example.
(a) Ideal Structure

(b) Equivalent Circuit

(c) Formulas

$$
\begin{aligned}
& A_{f} \equiv \frac{I_{o}}{I_{s}}=\frac{A}{1+A \beta} \\
& R_{i f}=R_{i} /(1+A \beta) \\
& R_{o f}=(1+A \beta) R_{o}
\end{aligned}
$$

Figure 11.25 The feedback current amplifier (shunt-series).
(a) General Structure

(b) Finding the $A$ Circuit and $\beta$
(i) The $A$ circuit is

where $R_{11}$ is obtained from
and $R_{22}$ is obtained from

and the gain $A$ is defined as $A \equiv \frac{I_{o}}{I_{i}}$
(ii) $\beta$ is obtained from

$$
\begin{aligned}
& I_{f} \stackrel{\text { a }}{\mid} \stackrel{+}{V_{1}}=0 \text { (1) Feedback } \\
& \text { network }
\end{aligned}
$$

$$
\beta \equiv \frac{I_{f}}{I_{o}} \|_{V_{1}=0}
$$

(c) Gain, Input, and Output Resistance

- Use the formulas in Fig. 11.25 to find $A_{f}, R_{i f}$, and $R_{o f}$.
- $R_{\text {in }}$ and $R_{\text {out }}$ can then be found from

$$
\begin{aligned}
& R_{\text {in }}=1 /\left(\frac{1}{R_{i f}}-\frac{1}{R_{i}}\right) \\
& R_{\text {out }}=R_{o f}-R_{L}
\end{aligned}
$$

Figure 11.26 The feedback current amplifier (shunt-series).
# Example 11.10 

Figure 11.27 shows a feedback current amplifier formed by cascading an inverting voltage amplifier $\mu$ with a MOSFET $Q$. The output current $I_{o}$ is the drain current of $Q$. The feedback network, consisting of resistors $R_{1}$ and $R_{2}$, senses an exactly equal current, namely, the source current of $Q$, and provides a feedback current signal that is mixed with $I_{s}$ at the input node. Note that the bias arrangement is not shown.

The amplifier $\mu$ can be implemented in a variety of ways, including by means of an op amp, a differential amplifier, or a single-ended inverting amplifier. The simplest approach is to implement $\mu$ with a CS


Figure 11.27 Circuit for Example 11.10.
Example 11.10 continued


Figure 11.27 continued
MOSFET amplifier. However, in such a case the loop gain will be very limited. Assume that the amplifier $\mu$ has an input resistance $R_{i d}$, an open-circuit voltage gain $\mu$, and an output resistance $r_{o 1}$.
(a) If the loop gain is large, find an approximate expression for the closed-loop gain $A_{f} \equiv I_{o} / I_{s}$.
(b) Find the $A$ circuit and derive expressions for $A, R_{i}$, and $R_{o}$.
(c) Give expressions for $A \beta, A_{f}, R_{i f}, R_{\mathrm{in}}, R_{o f}$, and $R_{\text {out }}$.
(d) Find numerical values for $A, \beta, A \beta, A_{f}, R_{i}, R_{i f}, R_{\mathrm{in}}, R_{o}, R_{o f}$, and $R_{\text {out }}$ for the following case: $\mu=$ $1000 \mathrm{~V} / \mathrm{V}, R_{s}=\infty, R_{i d}=\infty, r_{o 1}=1 \mathrm{k} \Omega, R_{1}=10 \mathrm{k} \Omega, R_{2}=90 \mathrm{k} \Omega$; for $Q: g_{m}=5 \mathrm{~mA} / \mathrm{V}$ and $r_{o}=20 \mathrm{k} \Omega$.

# Solution 

(a) When the loop gain $A \beta \gg 1, A_{f} \simeq 1 / \beta$. The $\beta$ circuit, shown in Fig. 11.27(b), is used to determine $\beta$ as shown in Fig. 11.27(c),

$$
\beta \equiv \frac{I_{f}}{I_{o}}=-\frac{R_{1}}{R_{1}+R_{2}}
$$

Thus,

$$
A_{f} \simeq \frac{1}{\beta}=-\left(1+\frac{R_{2}}{R_{1}}\right)
$$

To see what happens in this case more clearly, refer to Fig. 11.27(d). Here we have assumed the loop gain to be large, so that $I_{i} \simeq 0$ and thus $I_{f} \simeq I_{s}$. Also note that because $I_{i} \simeq 0, V_{i}$ will be close to zero. Thus, we can easily determine the voltage at the source of $Q$ as $-I_{1} R_{2} \simeq-I_{s} R_{2}$. The current through $R_{1}$ will then be $I_{s} R_{2} / R_{1}$. The source current of $Q$ will be $-\left(I_{s}+I_{s} R_{2} / R_{1}\right)$, which means that the output current $I_{o}$ will be

$$
I_{o}=-I_{s}\left(1+\frac{R_{2}}{R_{1}}\right)
$$

which confirms the expression for $A_{f}$ obtained above (Eq. 11.49).
(b) To obtain the $A$ circuit we load the input side of the basic amplifier with $R_{s}$ and $R_{11}$. The latter in this case is simply $R_{1}+R_{2}$ (because port 2 of the feedback network is opened). We also load the output of the basic amplifier with $R_{22}$, which in this case is $R_{1} \| R_{2}$ (because port 1 of the feedback network is shorted). The resulting $A$ circuit is shown in Fig. 11.27(e), where we have replaced the amplifier $\mu$ with its equivalent circuit. Analysis of the $A$ circuit is straightforward and proceeds as follows:

$$
\begin{gathered}
R_{i}=R_{s}\left\|R_{i d}\right\|\left(R_{1}+R_{2}\right) \\
V_{i}=I_{i} R_{i} \\
I_{o}=-\mu V_{i} \frac{1}{1 / g_{m}+\left(R_{1}\left\|R_{2}\right\| r_{o 2}\right)} \frac{r_{o 2}}{r_{o 2}+\left(R_{1} \| R_{2}\right)}
\end{gathered}
$$

Combining Eqs. (11.51) and (11.52) results in $A$ :

$$
A \equiv \frac{I_{o}}{I_{i}}=-\mu \frac{R_{i}}{1 / g_{m}+\left(R_{1}\left\|R_{2}\right\| r_{o 2}\right)} \frac{r_{o 2}}{r_{o 2}+\left(R_{1} \| R_{2}\right)}
$$

which with some manipulation can be expressed in the form

$$
A=-\mu \frac{R_{i}}{\left(R_{1} \| R_{2}\right)} \frac{\left(R_{1}\left\|R_{2}\right\| r_{o 2}\right)}{1 / g_{m}+\left(R_{1}\left\|R_{2}\right\| r_{o 2}\right)}
$$

Noting that $R_{o}$ is the output resistance of $Q$, which has a resistance $\left(R_{1} \| R_{2}\right)$ in its source lead, we can write

$$
R_{o}=r_{o 2}+\left(R_{1} \| R_{2}\right)+\left(g_{m} r_{o 2}\right)\left(R_{1} \| R_{2}\right)
$$

(c) The loop gain is obtained by combining Eqs. (11.48) and (11.53),

$$
A \beta=\mu \frac{R_{i}}{R_{2}} \frac{\left(R_{1}\left\|R_{2}\right\| r_{o 2}\right)}{1 / g_{m}+\left(R_{1}\left\|R_{2}\right\| r_{o 2}\right)}
$$

The closed-loop gain $A_{f}$ can be obtained by substituting the expressions of $A$ and $A \beta$ (Eqs. 11.54 and 11.56) in $A_{f}=A /(1+A \beta)$.

The input resistance $R_{i f}$ is found as

$$
R_{i f}=R_{i} /(1+A \beta)
$$

Since by definition,

$$
R_{i f}=R_{s} \| R_{\mathrm{in}}
$$

we can easily find $R_{\mathrm{in}}$.
For the output resistance, we have

$$
R_{\text {out }}=R_{o f}=R_{o}(1+A \beta)
$$

(d) For the numerical values given,

$$
R_{i}=\infty\|\infty\|(10+90)=100 \mathrm{k} \Omega
$$
# Example 11.10 continued 

The open-loop gain $A$ can be determined by using Eq. (11.54),

$$
A=-10,764 \mathrm{~A} / \mathrm{A}
$$

and the feedback factor $\beta$ can be found by using Eq. (11.48),

$$
\beta=-\frac{R_{1}}{R_{1}+R_{2}}=-\frac{10}{10+90}=-0.1 \mathrm{~A} / \mathrm{A}
$$

Thus,

$$
A \beta=1076.4
$$

and

$$
A_{f}=-\frac{10,764}{1+1076.4}=-9.99 \mathrm{~A} / \mathrm{A}
$$

which is very close to the ideal value of

$$
\begin{aligned}
& A_{f} \simeq-\left(1+\frac{R_{2}}{R_{1}}\right)=-\left(1+\frac{90}{10}\right)=-10 \mathrm{~A} / \mathrm{A} \\
& R_{i f}=\frac{R_{i}}{1+A \beta}=\frac{100 \mathrm{k} \Omega}{1+1076.4}=92.8 \Omega
\end{aligned}
$$

since $R_{s}=\infty$,

$$
\begin{aligned}
R_{\text {in }} & =R_{i f}=92.8 \Omega \\
R_{o} & =r_{o 2}+\left(R_{1} \| R_{2}\right)+g_{m} r_{o 2}\left(R_{1} \| R_{2}\right)=929 \mathrm{k} \Omega \\
R_{\text {out }} & =R_{o f}=(1+A \beta) R_{o}=1077.4 \times 929=1001 \mathrm{M} \Omega
\end{aligned}
$$

## EXERCISES

11.20 For the amplifier in Example 11.10, find the values of $A_{f}, R_{\text {in }}$, and $R_{\text {out }}$ when the value of $\mu$ is 10 times lower, that is, when $\mu=100$.
Ans. $-9.91 \mathrm{~A} / \mathrm{A} ; 920 \Omega ; 101 \mathrm{M} \Omega$
11.21 If in the circuit in Fig. 11.27(a), $R_{2}$ is short-circuited, find the ideal value of $A_{f}$. For the case $R_{s}=R_{o l}=$ $\infty$, give expressions for $R_{i}, R_{o}, A, \beta, A_{f}, R_{\text {in }}$, and $R_{\text {out }}$.
Ans. $A_{f}=-1 \mathrm{~A} / \mathrm{A} ; R_{i}=R_{1} ; R_{o}=r_{o 2}, A=-\mu g_{m} R_{1} ; \beta=-1 ; A_{f}=-\mu g_{m} R_{1} /\left(1+\mu g_{m} R_{1}\right) ; R_{\text {in }} \simeq 1 / \mu g_{m}$; $R_{\text {out }} \simeq \mu\left(g_{m} r_{o 2}\right) R_{1}$.
# 11.6 Summary of the Feedback-Analysis Method 

Table 11.2 provides a summary of the rules and relationships employed in the analysis and design of the four types of feedback amplifier. In addition to the wealth of information in Table 11.2, we offer the following important analysis tips.

1. Always begin the analysis by determining an approximate value for the closed-loop gain $A_{f}$, assuming that the loop gain $A \beta$ is large and thus

$$
A_{f} \simeq 1 / \beta
$$

This value should serve as a check on the final value you find for $A_{f}$. How close the actual $A_{f}$ is to this ideal value will depend on how large $A \beta$ is compared to unity.
2. The shunt connection at input or output always results in reducing the corresponding resistance (input or output). The series connection at input or output always results in increasing the corresponding resistance (input or output).
3. In utilizing negative feedback to improve the properties of an amplifier under design, the starting point in the design is the selection of the feedback topology appropriate for the application at hand. Then the required amount of negative feedback $(1+A \beta)$ can be ascertained utilizing the fact that it is this quantity that determines the magnitude of improvement in the various amplifier parameters. Also, the feedback factor $\beta$ can be determined from the required closed-loop gain $A_{f}$,

$$
\beta \simeq 1 / A_{f}
$$

### 11.7 The Stability Problem

### 11.7.1 Transfer Function of the Feedback Amplifier

In a feedback amplifier such as that represented by the general structure of Fig. 11.1, the open-loop gain $A$ is generally a function of frequency, and it should therefore be more accurately called the open-loop transfer function, $A(s)$. Also, we have been assuming for the most part that the feedback network is resistive and hence that the feedback factor $\beta$ is constant, but this need not be always the case. We shall therefore assume that in the general case the feedback transfer function is $\beta(s)$. It follows that the closed-loop transfer function $A_{f}(s)$ is given by

$$
A_{f}(s)=\frac{A(s)}{1+A(s) \beta(s)}
$$

To focus attention on the points central to our discussion in this section, we shall assume that the amplifier is direct coupled with constant dc gain $A_{0}$ and with poles and zeros occurring in the high-frequency band. Also, for the time being let us assume that at low frequencies $\beta(s)$ reduces to a constant value. Thus at low frequencies the loop gain $A(s) \beta(s)$ becomes a constant, which should be a positive number; otherwise the feedback would not be negative. The question then is: What happens at higher frequencies?|  |  |  |  |  |  |  |  |  |  | Loading of Feedback <br> Network Is Obtained |  | To Find $\beta$, <br> Apply to <br> Port 2 of <br> Feedback <br> Network | $R_{1 f}$ | $R_{s f}$ | Refer <br> to Figs. |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| Feedback <br> Amplifier | Feedback <br> Topology |  | $x_{1}$ | $x_{o}$ | $x_{f}$ | $x_{s}$ | A | $\beta$ | $A_{f}$ | Source <br> Form | At Input | At Output |  |  |  |
| Voltage | Series-shunt |  | $V_{i}$ | $V_{o}$ | $V_{f}$ | $V_{s}$ | $\frac{V_{o}}{V_{i}}$ | $\frac{V_{s}}{V_{o}}$ | $\frac{V_{f}}{V_{s}}$ | Thévenin | By shortcircuiting port 2 of feedback network | By opencircuiting port 1 of feedback network | a voltage, and find the open-circuit voltage at port 1 | $R_{i}(1+A \beta)$ | $\frac{R_{o}}{1+A \beta}$ | $\begin{aligned} & 11.12 \\ & 11.14 \end{aligned}$ |
| Current | Shunt-series |  | $I_{i}$ | $I_{s}$ | $I_{f}$ | $I_{s}$ | $\frac{I_{o}}{I_{i}}$ | $\frac{I_{f}}{I_{o}}$ | $\frac{I_{f}}{I_{s}}$ | Norton | By opencircuiting port 2 of feedback network | By shortcircuiting port 1 of feedback network | a current, and find the short-circuit current at port 1 | $\frac{R_{i}}{1+A \beta}$ | $R_{o}(1+A \beta)$ | $\begin{aligned} & 11.25 \\ & 11.26 \end{aligned}$ |
| Transconductance | Series-series |  | $V_{i}$ | $I_{s}$ | $V_{f}$ | $V_{o}$ | $\frac{I_{o}}{V_{i}}$ | $\frac{V_{f}}{I_{o}}$ | $\frac{I_{o}}{V_{i}}$ | Thévenin | By opencircuiting port 2 of feedback network | By opencircuiting port 1 of feedback network | a current, and find the open-circuit voltage at port 1 | $R_{i}(1+A \beta)$ | $R_{o}(1+A \beta)$ | $\begin{aligned} & 11.18 \\ & 11.19 \end{aligned}$ |
| Transresistance | Shunt-shunt |  | $I_{i}$ | $V_{o}$ | $I_{f}$ | $I_{s}$ | $\frac{V_{o}}{I_{i}}$ | $\frac{I_{f}}{V_{o}}$ | $\frac{V_{o}}{I_{s}}$ | Norton | By shortcircuiting port 2 of feedback network | By shortcircuiting port 1 of feedback network | a voltage, and find the short-circuit current at port 1 | $\frac{R_{i}}{1+A \beta}$ | $\frac{R_{o}}{1+A \beta}$ | $\begin{aligned} & 11.22 \\ & 11.23 \end{aligned}$ |
For physical frequencies $s=j \omega$, Eq. (11.57) becomes

$$
A_{f}(j \omega)=\frac{A(j \omega)}{1+A(j \omega) \beta(j \omega)}
$$

Thus the loop gain $A(j \omega) \beta(j \omega)$ is a complex number that can be represented by its magnitude and phase,

$$
\begin{aligned}
L(j \omega) & \equiv A(j \omega) \beta(j \omega) \\
& =|A(j \omega) \beta(j \omega)| e^{j \phi(\omega)}
\end{aligned}
$$

It is the manner in which the loop gain varies with frequency that determines the stability or instability of the feedback amplifier. To appreciate this fact, consider the frequency at which the phase angle $\phi(\omega)$ becomes $180^{\circ}$. At this frequency, $\omega_{180}$, the loop gain $A(j \omega) \beta(j \omega)$ will be a real number with a negative sign. Thus at this frequency the feedback will become positive. If at $\omega=\omega_{180}$ the magnitude of the loop gain is less than unity, then from Eq. (11.58) we see that the closed-loop gain $A_{f}(j \omega)$ will be greater than the open-loop gain $A(j \omega)$, since the denominator of Eq. (11.58) will be smaller than unity. Nevertheless, the feedback amplifier will be stable.

On the other hand, if at the frequency $\omega_{180}$ the magnitude of the loop gain is equal to unity, it follows from Eq. (11.58) that $A_{f}(j \omega)$ will be infinite. This means that the amplifier will have an output for zero input; this is by definition an oscillator. To visualize how this feedback loop may oscillate, consider the general loop of Fig. 11.1 with the external input $x_{s}$ set to zero. Any disturbance in the circuit, such as the closure of the power-supply switch, will generate a signal $x_{i}(t)$ at the input to the amplifier. Such a noise signal usually contains a wide range of frequencies, and we shall now concentrate on the component with frequency $\omega=\omega_{180}$, that is, the signal $X_{i} \sin \left(\omega_{180} t\right)$. This input signal will result in a feedback signal given by

$$
X_{f}=A\left(j \omega_{180}\right) \beta\left(j \omega_{180}\right) X_{i}=-X_{i}
$$

Since $X_{f}$ is further multiplied by -1 in the summer block at the input, we see that the feedback causes the signal $X_{i}$ at the amplifier input to be sustained. That is, from this point on, there will be sinusoidal signals at the amplifier input and output of frequency $\omega_{180}$. Thus the amplifier is said to oscillate at the frequency $\omega_{180}$.

The question now is: What happens if at $\omega_{180}$ the magnitude of the loop gain is greater than unity? We shall answer this question, not in general, but for the restricted yet very important class of circuits in which we are interested here. The answer, which is not obvious from Eq. (11.58), is that the circuit will oscillate, and the oscillations will grow in amplitude until some nonlinearity (which is always present in some form) reduces the magnitude of the loop gain to exactly unity, at which point sustained oscillations will be obtained. This mechanism for starting oscillations by using positive feedback with a loop gain greater than unity, and then using a nonlinearity to reduce the loop gain to unity at the desired amplitude, will be exploited in the design of sinusoidal oscillators in Chapter 18. Our objective here is just the opposite: Now that we know how oscillations could occur in a negative-feedback amplifier, we wish to find methods to prevent their occurrence.

# 11.7.2 The Nyquist Plot 

The Nyquist plot is a formalized approach for testing for stability based on the discussion above. It is simply a polar plot of loop gain, with frequency used as a parameter. Figure 11.28


Figure 11.28 The Nyquist plot of an unstable amplifier.
shows such a plot. Note that the radial distance is $|A \beta|$ and the angle is the phase angle $\phi$. The solid-line plot is for positive frequencies. Since the loop gain-and for that matter any gain function of a physical network-has a magnitude that is an even function of frequency and a phase that is an odd function of frequency, the $A \beta$ plot for negative frequencies (shown in Fig. 11.28 as a broken line) can be drawn as a mirror image through the Re axis.

The Nyquist plot intersects the negative real axis at the frequency $\omega_{180}$. Thus, if this intersection occurs to the left of the point $(-1,0)$, we know that the magnitude of loop gain at this frequency is greater than unity and the amplifier will be unstable. On the other hand, if the intersection occurs to the right of the point $(-1,0)$ the amplifier will be stable. It follows that if the Nyquist plot encircles the point $(-1,0)$ then the amplifier will be unstable. It should be mentioned, however, that this statement is a simplified version of the Nyquist criterion; nevertheless, it applies to all the circuits in which we are interested. For the full theory behind the Nyquist method and for details of its application, consult Haykin (1970).

# EXERCISE 

11.22 Consider a feedback amplifier for which the open-loop transfer function $A(s)$ is given by

$$
A(s)=\left(\frac{10}{1+s / 10^{3}}\right)^{3}
$$

Let the feedback factor $\beta$ be a constant independent of frequency. Find the frequency $\omega_{180}$ at which the phase shift is $180^{\circ}$. Then, show that the feedback amplifier will be stable if the feedback
factor $\beta$ is less than a critical value $\beta_{\text {cr }}$ and unstable if $\beta \geq \beta_{\text {cr }}$, and find the value of $\beta_{\text {cr }}$. Hence, find the minimum value of the closed-loop gain for which the amplifier is stable.
Ans. $\omega_{180}=\sqrt{3} \times 10^{4} \mathrm{rad} / \mathrm{s} ; \beta_{\text {cr }}=0.008 ; A_{f \text { min }}=111.1$

## HARRY NYQUISTA DIVERSE ELECTRONICS FUNDAMENTALIST:

Harry Nyquist, a Swedish-born electrical engineer working for Bell Labs and its predecessor, was responsible for developments in communications electronics involving thermal noise, feedback-amplifier stability, telegraphy, facsimile, television, and many other areas.

In The Idea Factory, an excellent book on the history of Bell Labs, Jon Gertner notes that


#### Abstract

[S]ome lawyers in the patent office of the Bell Labs decided to study whether there was an organizing principle that could explain why certain individuals were more productive than others. They discerned only one common thread: Workers with the most patents often shared lunch or breakfast with a Bell Labs electrical engineer named Harry Nyquist. It wasn't the case that Nyquist gave them specific ideas. Rather, as one scientist recalled, "he drew people out, got them thinking." More than anything, Nyquist asked good questions.


# 11.8 Effect of Feedback on the Amplifier Poles 

The amplifier frequency response and stability are determined directly by its poles. Therefore we shall investigate the effect of feedback on the poles of the amplifier.

### 11.8.1 Stability and Pole Location

We shall begin by considering the relationship between stability and pole location. For an amplifier or any other system to be stable, its poles should lie in the left half of the $s$ plane. A pair of complex-conjugate poles on the $j \omega$ axis gives rise to sustained sinusoidal oscillations. Poles in the right half of the $s$ plane give rise to growing oscillations.

To verify the statement above, consider an amplifier with a pole pair at $s=\sigma_{0} \pm j \omega_{n}$. If this amplifier is subjected to a disturbance, such as that caused by closure of the power-supply switch, its transient response will contain terms of the form

$$
v(t)=e^{\sigma_{0} t}\left[e^{+j \omega_{n} t}+e^{-j \omega_{n} t}\right]=2 e^{\sigma_{0} t} \cos \left(\omega_{n} t\right)
$$

This is a sinusoidal signal with an envelope $e^{\sigma_{0} t}$. Now if the poles are in the left half of the $s$ plane, then $\sigma_{0}$ will be negative and the oscillations will decay exponentially toward zero, as shown in Fig. 11.29(a), indicating that the system is stable. If, on the other hand, the poles are in

[^0]
[^0]:    ${ }^{7}$ For a brief review of poles and zeros and related concepts, refer to Appendix F.


Figure 11.29 Relationship between pole location and transient response.
the right half-plane, then $\sigma_{0}$ will be positive, and the oscillations will grow exponentially (until some nonlinearity limits their growth), as shown in Fig. 11.29(b). Finally, if the poles are on the $j \omega$ axis, then $\sigma_{0}$ will be zero and the oscillations will be sustained, as shown in Fig. 11.29(c).

Although the discussion above is in terms of complex-conjugate poles, it can be shown that the existence of any right-half-plane poles results in instability.

# 11.8.2 Poles of the Feedback Amplifier 

From the closed-loop transfer function in Eq. (11.57), we see that the poles of the feedback amplifier are the zeros of $1+A(s) \beta(s)$. That is, the feedback amplifier poles are obtained by solving the equation

$$
1+A(s) \beta(s)=0
$$

which is called the characteristic equation of the feedback loop. It should therefore be apparent that applying feedback to an amplifier changes its poles.
In the following, we shall consider how feedback affects the amplifier poles. For this purpose we shall assume that the open-loop amplifier has real poles and no finite zeros (i.e., all the zeros are at $s=\infty$ ). This will simplify the analysis and enable us to focus our attention on the fundamental concepts involved. We shall also assume that the feedback factor $\beta$ is independent of frequency.

# 11.8.3 Amplifier with a Single-Pole Response 

Consider first the case of an amplifier whose open-loop transfer function is characterized by a single pole:

$$
A(s)=\frac{A_{0}}{1+s / \omega_{P}}
$$

The closed-loop transfer function is given by

$$
A_{f}(s)=\frac{A_{0} /\left(1+A_{0} \beta\right)}{1+s / \omega_{P}\left(1+A_{0} \beta\right)}
$$

Thus the feedback moves the pole along the negative real axis to a frequency $\omega_{P y}$,

$$
\omega_{P y}=\omega_{P}\left(1+A_{0} \beta\right)
$$

This process is illustrated in Fig. 11.30(a). Figure 11.30(b) shows Bode plots for $|A|$ and $\left|A_{f}\right|$. Note that while at low frequencies the difference between the two plots is $20 \log \left(1+A_{0} \beta\right)$, the two curves coincide at high frequencies. One can show that this indeed is the case by approximating Eq. (11.63) for frequencies $\omega \gg \omega_{P}\left(1+A_{0} \beta\right)$ :

$$
A_{f}(s) \simeq \frac{A_{0} \omega_{P}}{s} \simeq A(s)
$$

Physically speaking, at such high frequencies the loop gain is much smaller than unity and the feedback is ineffective.

Figure 11.30(b) clearly illustrates the fact that applying negative feedback to an amplifier results in extending its bandwidth at the expense of a reduction in gain. Since the pole of the


Figure 11.30 Effect of feedback on (a) the pole location and (b) the frequency response of an amplifier having a single-pole, open-loop response.
closed-loop amplifier never enters the right half of the $s$ plane, the single-pole amplifier is stable for any value of $\beta$. Thus this amplifier is said to be unconditionally stable. This result, however, is hardly surprising, since the phase lag associated with a single-pole response can never be greater than $90^{\circ}$. Thus the loop gain never achieves the $180^{\circ}$ phase shift required for the feedback to become positive.

# EXERCISE 

11.23 An op amp having a single-pole rolloff at 100 Hz and a low-frequency gain of $10^{5}$ is operated in a feedback loop with $\beta=0.01$. What is the factor by which feedback shifts the pole? To what frequency? If $\beta$ is changed to a value that results in a nominal closed-loop gain of +1 , to what frequency does the pole shift?
Ans. $1001 ; 100.1 \mathrm{kHz} ; 10 \mathrm{MHz}$

### 11.8.4 Amplifier with a Two-Pole Response

Consider next an amplifier whose open-loop transfer function is characterized by two real-axis poles:

$$
A(s)=\frac{A_{0}}{\left(1+s / \omega_{P 1}\right)\left(1+s / \omega_{P 2}\right)}
$$

In this case, the closed-loop poles are obtained from $1+A(s) \beta=0$, which leads to

$$
s^{2}+s\left(\omega_{P 1}+\omega_{P 2}\right)+\left(1+A_{0} \beta\right) \omega_{P 1} \omega_{P 2}=0
$$

Thus the closed-loop poles are given by

$$
s=-\frac{1}{2}\left(\omega_{P 1}+\omega_{P 2}\right) \pm \frac{1}{2} \sqrt{\left(\omega_{P 1}+\omega_{P 2}\right)^{2}-4\left(1+A_{0} \beta\right) \omega_{P 1} \omega_{P 2}}
$$

From Eq. (11.68) we see that as the loop gain $A_{0} \beta$ is increased from zero, the poles are brought closer together. Then a value of loop gain is reached at which the poles become coincident. If the loop gain is further increased, the poles become complex conjugate and move along a vertical line. Figure 11.31 shows the locus of the poles for increasing loop gain. This plot is called a root-locus diagram, where "root" refers to the fact that the poles are the roots of the characteristic equation.

From the root-locus diagram of Fig. 11.31 we see that this feedback amplifier also is unconditionally stable. Again, this result should come as no surprise; the maximum phase shift of $A(s)$ in this case is $180^{\circ}\left(90^{\circ}\right.$ per pole $)$, but this value is reached at $\omega=\infty$. Thus there is no finite frequency at which the phase shift reaches $180^{\circ}$.

Another observation to make on the root-locus diagram of Fig. 11.31 is that the open-loop amplifier might have a dominant pole, but this is not necessarily the case for the closed-loop amplifier. The response of the closed-loop amplifier can, of course, always be plotted once the poles have been found from Eq. (11.68). As is the case with second-order responses generally, the closed-loop response can show a peak (see Chapter 17). To be more specific,


Figure 11.31 Root-locus diagram for a feedback amplifier whose open-loop transfer function has two real poles.
the characteristic equation of a second-order network can be written in the standard form

$$
s^{2}+s \frac{\omega_{0}}{Q}+\omega_{0}^{2}=0
$$

where $\omega_{0}$ is called the pole frequency and $Q$ is called pole $Q$ factor. The poles are complex if $Q$ is greater than 0.5 . A geometric interpretation for $\omega_{0}$ and $Q$ of a pair of complex-conjugate poles is given in Fig. 11.32, from which we note that $\omega_{0}$ is the radial distance of the poles from the origin and that $Q$ indicates the distance of the poles from the $j \omega$ axis. Poles on the $j \omega$ axis have $Q=\infty$.

By comparing Eqs. (11.67) and (11.69), we obtain the $Q$ factor for the poles of the feedback amplifier as

$$
Q=\frac{\sqrt{\left(1+A_{0} \beta\right) \omega_{P 1} \omega_{P 2}}}{\omega_{P 1}+\omega_{P 2}}
$$

From the study of second-order network responses in Chapter 17, it will be seen that the response of the feedback amplifier under consideration shows no peaking for $Q \leq 0.707$. The boundary case corresponding to $Q=0.707$ (poles at $45^{\circ}$ angles) results in the maximally flat response. Figure 11.33 shows a number of possible responses obtained for various values of $Q$ (or, correspondingly, various values of $A_{0} \beta$ ).


Figure 11.32 Definition of $\omega_{0}$ and $Q$ of a pair of complexconjugate poles.


Figure 11.33 Normalized gain of a two-pole feedback amplifier for various values of $Q$. Note that $Q$ is determined by the loop gain according to Eq. (11.70).

# EXERCISE 

11.24 An amplifier with a low-frequency gain of 100 and poles at $10^{4} \mathrm{rad} / \mathrm{s}$ and $10^{6} \mathrm{rad} / \mathrm{s}$ is incorporated in a negative-feedback loop with feedback factor $\beta$. For what value of $\beta$ do the poles of the closed-loop amplifier coincide? What is the corresponding $Q$ of the resulting second-order system? For what value of $\beta$ is a maximally flat response achieved? What is the low-frequency closed-loop gain in the maximally flat case?
Ans. $0.245 ; 0.5 ; 0.5 ; 1.96 \mathrm{~V} / \mathrm{V}$

## Example 11.11

As an illustration of some of the ideas just discussed, we consider the positive-feedback circuit shown in Fig. 11.34(a). Find the loop transmission $L(s)$ and the characteristic equation. Sketch a root-locus diagram for varying $K$, and find the value of $K$ that results in a maximally flat response and the value of $K$ that makes the circuit oscillate. Assume that the amplifier has frequency-independent gain, infinite input impedance, and zero output impedance.

## Solution

To obtain the loop transmission, we short-circuit the signal source and break the loop at the amplifier input. We then apply a test voltage $V_{t}$ and find the returned voltage $V_{r}$, as indicated in Fig. 11.34(b). The


Figure 11.34 Circuits and plot for Example 11.11.
loop transmission $L(s) \equiv A(s) \beta(s)$ is given by

$$
L(s)=-\frac{V_{s}}{V_{i}}=-K T(s)
$$

Figure 2.3 Equivalent circuit of the ideal op amp.

Furthermore, gain $A$ is called the differential gain, for obvious reasons. Perhaps not so obvious is another name that we will attach to $A$ : the open-loop gain. The reason for this name will become obvious later on when we "close the loop" around the op amp and define another gain, the closed-loop gain.

An important characteristic of op amps is that they are direct-coupled or dc amplifiers, where dc stands for direct-coupled (it could equally well stand for direct current, since a direct-coupled amplifier is one that amplifies signals whose frequency is as low as zero). The fact that op amps are direct-coupled devices will allow us to use them in many important applications. Unfortunately, though, the direct-coupling property can cause some serious practical problems, as will be discussed in a later section.

How about bandwidth? The ideal op amp has a gain $A$ that remains constant down to zero frequency and up to infinite frequency. That is, ideal op amps will amplify signals of any frequency with equal gain, and are thus said to have infinite bandwidth.

We have discussed all of the properties of the ideal op amp except for one, which in fact is the most important. This has to do with the value of $A$. The ideal op amp should have a gain $A$ whose value is very large and ideally infinite. One may justifiably ask: If the gain $A$ is infinite, how are we going to use the op amp? The answer is very simple: In almost all applications the op amp will not be used alone in a so-called open-loop configuration. Rather, we will use other components to apply feedback to close the loop around the op amp, as will be illustrated in detail in Section 2.2.

For future reference, Table 2.1 lists the characteristics of the ideal op amp.

Table 2.1 Characteristics of the Ideal Op Amp

1. Infinite input impedance
2. Zero output impedance
3. Zero common-mode gain or, equivalently, infinite common-mode rejection
4. Infinite open-loop gain $A$
5. Infinite bandwidth
# 2.1.3 Differential and Common-Mode Signals 

The differential input signal $v_{k i}$ is simply the difference between the two input signals $v_{1}$ and $v_{2}$; that is,

$$
v_{k i}=v_{2}-v_{1}
$$

The common-mode input signal $v_{k: m}$ is the average of the two input signals $v_{1}$ and $v_{2}$; namely,

$$
v_{k: m}=\frac{1}{2}\left(v_{1}+v_{2}\right)
$$

Equations (2.1) and (2.2) can be used to express the input signals $v_{1}$ and $v_{2}$ in terms of their differential and common-mode components as follows:

$$
v_{1}=v_{k: m}-v_{k i} / 2
$$

and

$$
v_{2}=v_{k: m}+v_{k i} / 2
$$

These equations can in turn lead to the pictorial representation in Fig. 2.4.


Figure 2.4 Representation of the signal sources $v_{1}$ and $v_{2}$ in terms of their differential and common-mode components.

## EXERCISES

2.2 Consider an op amp that is ideal except that its open-loop gain $A=10^{3}$. The op amp is used in a feedback circuit, and the voltages appearing at two of its three signal terminals are measured. In each of the following cases, use the measured values to find the expected value of the voltage at the third terminal. Also give the differential and common-mode input signals in each case. (a) $v_{2}=0 \mathrm{~V}$ and $v_{3}=2 \mathrm{~V}$; (b) $v_{2}=+5 \mathrm{~V}$ and $v_{3}=-10 \mathrm{~V}$; (c) $v_{1}=1.002 \mathrm{~V}$ and $v_{2}=0.998 \mathrm{~V}$; (d) $v_{1}=-3.6 \mathrm{~V}$ and $v_{3}=-3.6 \mathrm{~V}$. Ans. (a) $v_{1}=-0.002 \mathrm{~V}, v_{k i}=2 \mathrm{mV}, v_{k: m}=-1 \mathrm{mV}$; (b) $v_{1}=+5.01 \mathrm{~V}, v_{k i}=-10 \mathrm{mV}, v_{k: m}=5.005 \simeq$ $5 \mathrm{~V} ;$ (c) $v_{3}=-4 \mathrm{~V}, v_{k i}=-4 \mathrm{mV}, v_{k: m}=1 \mathrm{~V}$; (d) $v_{2}=-3.6036 \mathrm{~V}, v_{k i}=-3.6 \mathrm{mV}, v_{k: m} \simeq-3.6 \mathrm{~V}$
2.3 The internal circuit of a particular op amp can be modeled by the circuit shown in Fig. E2.3. Express $v_{3}$ as a function of $v_{1}$ and $v_{2}$. For the case $G_{m}=10 \mathrm{~mA} / \mathrm{V}, R=10 \mathrm{k} \Omega$, and $\mu=100$, find the value of the open-loop gain $A$.
Ans. $v_{3}=\mu G_{m} R\left(v_{2}-v_{1}\right) ; A=10,000 \mathrm{~V} / \mathrm{V}$ or 80 dB


Figure E2.3

# 2.2 The Inverting Configuration 

As mentioned above, op amps are not used alone; rather, the op amp is connected to passive components in a feedback circuit. There are two such basic circuit configurations employing an op amp and two resistors: the inverting configuration, which is studied in this section, and the noninverting configuration, which we shall study in the next section.

Figure 2.5 shows the inverting configuration. It consists of one op amp and two resistors $R_{1}$ and $R_{2}$. Resistor $R_{2}$ is connected from the output terminal of the op amp, terminal 3, back to the inverting or negative input terminal, terminal 1. We speak of $R_{2}$ as applying negative feedback; if $R_{2}$ were connected between terminals 3 and 2 we would have called this positive feedback. Note also that $R_{2}$ closes the loop around the op amp. In addition to adding $R_{2}$, we have grounded terminal 2 and connected a resistor $R_{1}$ between terminal 1 and an input signal source


Figure 2.5 The inverting closed-loop configuration.
with a voltage $v_{I}$. The output of the overall circuit is taken at terminal 3 (i.e., between terminal 3 and ground). Terminal 3 is, of course, a convenient point from which to take the output, since the impedance level there is ideally zero. Thus the voltage $v_{O}$ will not depend on the value of the current that might be supplied to a load impedance connected between terminal 3 and ground.

# 2.2.1 The Closed-Loop Gain 

We now wish to analyze the circuit in Fig. 2.5 to determine the closed-loop gain $G$, defined as

$$
G \equiv \frac{v_{O}}{v_{I}}
$$

We will do so assuming the op amp to be ideal. Figure 2.6(a) shows the equivalent circuit, and the analysis proceeds as follows: The gain $A$ is very large (ideally infinite). If we assume that the circuit is "working" and producing a finite output voltage at terminal 3, then the voltage between the op-amp input terminals should be negligibly small and ideally zero. Specifically, if we call the output voltage $v_{O}$, then, by definition,

$$
v_{2}-v_{1}=\frac{v_{O}}{A}=0
$$

It follows that the voltage at the inverting input terminal $\left(v_{1}\right)$ is given by $v_{1}=v_{2}$. That is, because the gain $A$ approaches infinity, the voltage $v_{1}$ approaches and ideally equals $v_{2}$. We speak of this as the two input terminals "tracking each other in potential." We also speak of a "virtual short circuit" that exists between the two input terminals. Here the word virtual should be emphasized, and one should not make the mistake of physically shorting terminals 1 and 2 together while analyzing a circuit. A virtual short circuit means that whatever voltage is at 2 will automatically appear at 1 because of the infinite gain $A$. But terminal 2 happens to be connected to ground; thus $v_{2}=0$ and $v_{1}=0$. We speak of terminal 1 as being a virtual ground-that is, having zero voltage but not physically connected to ground.

Now that we have determined $v_{1}$ we are in a position to apply Ohm's law and find the current $i_{1}$ through $R_{1}$ (see Fig. 2.6) as follows:

$$
i_{1}=\frac{v_{I}-v_{1}}{R_{1}}=\frac{v_{I}-0}{R_{1}}=\frac{v_{I}}{R_{1}}
$$

Where will this current go? It cannot go into the op amp, since the ideal op amp has an infinite input impedance and hence draws zero current. It follows that $i_{1}$ will have to flow through $R_{2}$ to the low-impedance terminal 3. We can then apply Ohm's law to $R_{2}$ and determine $v_{O}$; that is,

$$
\begin{aligned}
v_{O} & =v_{1}-i_{1} R_{2} \\
& =0-\frac{v_{I}}{R_{1}} R_{2}
\end{aligned}
$$

Thus,

$$
\frac{v_{O}}{v_{I}}=-\frac{R_{2}}{R_{1}}
$$


Figure 2.6 Analysis of the inverting configuration. The circled numbers indicate the order of the analysis steps.
which is the required closed-loop gain. Figure 2.6(b) illustrates these steps and indicates by the circled numbers the order in which the analysis is performed.

We thus see that the closed-loop gain is simply the ratio of the two resistances $R_{2}$ and $R_{1}$. The minus sign means that the closed-loop amplifier provides signal inversion. Thus if $R_{2} / R_{1}=10$ and we apply at the input $\left(v_{I}\right)$ a sine-wave signal of 1 V peak-to-peak, then the output $v_{O}$ will be a sine wave of 10 V peak-to-peak and phase-shifted $180^{\circ}$ with respect to the input sine wave. Because of the minus sign associated with the closed-loop gain, this configuration is called the inverting configuration.
The fact that the closed-loop gain depends entirely on external passive components (resistors $R_{1}$ and $R_{2}$ ) is very significant. It means that we can make the closed-loop gain as accurate as we want by selecting passive components of appropriate accuracy. It also means that the closed-loop gain is (ideally) independent of the op-amp gain. This is a dramatic illustration of negative feedback: We started out with an amplifier having very large gain $A$, and through applying negative feedback we have obtained a closed-loop gain $R_{2} / R_{1}$ that is much smaller than $A$ but is stable and predictable. That is, we are trading gain for accuracy.

# 2.2.2 Effect of Finite Open-Loop Gain 

The points just made are more clearly illustrated by deriving an expression for the closed-loop gain under the assumption that the op-amp open-loop gain $A$ is finite. Figure 2.7 shows the analysis. If we denote the output voltage $v_{O}$, then the voltage between the two input terminals of the op amp will be $v_{O} / A$. Since the positive input terminal is grounded, the voltage at the negative input terminal must be $-v_{O} / A$. The current $i_{1}$ through $R_{1}$ can now be found from

$$
i_{1}=\frac{v_{I}-\left(-v_{O} / A\right)}{R_{1}}=\frac{v_{I}+v_{O} / A}{R_{1}}
$$



Figure 2.7 Analysis of the inverting configuration taking into account the finite open-loop gain of the op amp.

The infinite input impedance of the op amp forces the current $i_{1}$ to flow entirely through $R_{2}$. The output voltage $v_{O}$ can thus be determined from

$$
\begin{aligned}
v_{O} & =-\frac{v_{O}}{A}-i_{1} R_{2} \\
& =-\frac{v_{O}}{A}-\left(\frac{v_{I}+v_{O} / A}{R_{1}}\right) R_{2}
\end{aligned}
$$

Collecting terms, the closed-loop gain $G$ is found as

$$
G \equiv \frac{v_{O}}{v_{I}}=\frac{-R_{2} / R_{1}}{1+\left(1+R_{2} / R_{1}\right) / A}
$$

We note that as $A$ approaches $\infty, G$ approaches the ideal value of $-R_{2} / R_{1}$. Also, from Fig. 2.7 we see that as $A$ approaches $\infty$, the voltage at the inverting input terminal approaches zero. This is the virtual-ground assumption we used in our earlier analysis when the op amp was
assumed to be ideal. Finally, note that Eq. (2.5) in fact indicates that to minimize the dependence of the closed-loop gain $G$ on the value of the open-loop gain $A$, we should make

$$
1+\frac{R_{2}}{R_{1}} \ll A
$$

# Example 2.1 

Consider the inverting configuration with $R_{1}=1 \mathrm{k} \Omega$ and $R_{2}=100 \mathrm{k} \Omega$, that is, having an ideal closed-loop gain of -100 .
(a) Find the closed-loop gain for the cases $A=10^{3}, 10^{4}$, and $10^{5}$. In each case determine the percentage error in the magnitude of $G$ relative to the ideal value of $R_{2} / R_{1}$ (obtained with $A=\infty$ ). Also determine the voltage $v_{1}$ that appears at the inverting input terminal when $v_{I}=0.1 \mathrm{~V}$.
(b) If the open-loop gain $A$ changes from 100,000 to 50,000 (i.e., drops by $50 \%$ ), what is the corresponding percentage change in the magnitude of the closed-loop gain $G$ ?

## Solution

(a) Substituting the given values in Eq. (2.5), we obtain the values given in the following table, where the percentage error $\epsilon$ is defined as

$$
\epsilon \equiv \frac{|G|-\left(R_{2} / R_{1}\right)}{\left(R_{2} / R_{1}\right)} \times 100
$$

The values of $v_{1}$ are obtained from $v_{1}=-v_{O} / A=G v_{I} / A$ with $v_{I}=-0.1 \mathrm{~V}$.

| $\boldsymbol{A}$ | $\|\boldsymbol{G}\|$ | $\boldsymbol{\epsilon}$ | $\boldsymbol{v}_{\mathbf{1}}$ |
| :--: | :--: | :--: | :--: |
| $10^{3}$ | 90.83 | $-9.17 \%$ | -9.08 mV |
| $10^{4}$ | 99.00 | $-1.00 \%$ | -0.99 mV |
| $10^{5}$ | 99.90 | $-0.10 \%$ | -0.10 mV |

(b) Using Eq. (2.5), we find that for $A=50,000,|G|=99.80$. Thus a $-50 \%$ change in the open-loop gain results in a change in $|G|$ from 99.90 to 99.80 , which is only $-0.1 \%$ !

### 2.2.3 Input and Output Resistances

Assuming an ideal op amp with infinite open-loop gain, the input resistance of the closed-loop inverting amplifier of Fig. 2.5 is simply equal to $R_{1}$. This can be seen from Fig. 2.6(b), where

$$
R_{i} \equiv \frac{v_{I}}{i_{1}}=\frac{v_{I}}{v_{I} / R_{1}}=R_{1}
$$

Now recall that in Section 1.5 we learned that the amplifier input resistance forms a voltage divider with the resistance of the source that feeds the amplifier. Thus, to avoid the loss of signal strength, voltage amplifiers are required to have high input resistance. In the case of the inverting op-amp configuration we are studying, to make $R_{i}$ high we should select a high value for $R_{1}$. However, if the required gain $R_{2} / R_{1}$ is also high, then $R_{2}$ could become impractically large
(e.g., greater than a few megohms). We may conclude that the inverting configuration suffers from a low input resistance. A solution to this problem is discussed in Example 2.2 below.

Since the output of the inverting configuration is taken at the terminals of the ideal voltage source $A\left(v_{2}-v_{1}\right)$ (see Fig. 2.6a), it follows that the output resistance of the closed-loop amplifier is zero.

# Example 2.2 

Assuming the op amp to be ideal, derive an expression for the closed-loop gain $v_{o} / v_{l}$ of the circuit shown in Fig. 2.8. Use this circuit to design an inverting amplifier with a gain of 100 and an input resistance of $1 \mathrm{M} \Omega$. Assume that for practical reasons it is required not to use resistors greater than $1 \mathrm{M} \Omega$. Compare your design with that based on the inverting configuration of Fig. 2.5.


Figure 2.8 Circuit for Example 2.2. The circled numbers indicate the sequence of the steps in the analysis.

## Solution

The analysis begins at the inverting input terminal of the op amp, where the voltage is

$$
v_{1}=\frac{-v_{o}}{A}=\frac{-v_{o}}{\infty}=0
$$

Here we have assumed that the circuit is "working" and producing a finite output voltage $v_{o}$. Knowing $v_{1}$, we can determine the current $i_{1}$ as follows:

$$
i_{1}=\frac{v_{l}-v_{1}}{R_{1}}=\frac{v_{l}-0}{R_{1}}=\frac{v_{l}}{R_{1}}
$$

Since zero current flows into the inverting input terminal, all of $i_{1}$ will flow through $R_{2}$, and thus

$$
i_{2}=i_{1}=\frac{v_{l}}{R_{1}}
$$

Now we can determine the voltage at node $x$ :

$$
v_{x}=v_{1}-i_{2} R_{2}=0-\frac{v_{l}}{R_{1}} R_{2}=-\frac{R_{2}}{R_{1}} v_{l}
$$
# Example 2.2 continued 

This in turn enables us to find the current $i_{3}$ :

$$
i_{3}=\frac{0-v_{s}}{R_{3}}=\frac{R_{3}}{R_{1} R_{3}} v_{I}
$$

Next, a node equation at $x$ yields $i_{4}$ :

$$
i_{4}=i_{2}+i_{3}=\frac{v_{I}}{R_{1}}+\frac{R_{2}}{R_{1} R_{3}} v_{I}
$$

Finally, we can determine $v_{O}$ from

$$
\begin{aligned}
v_{O} & =v_{s}-i_{4} R_{4} \\
& =-\frac{R_{2}}{R_{1}} v_{I}-\left(\frac{v_{I}}{R_{1}}+\frac{R_{2}}{R_{1} R_{3}} v_{I}\right) R_{4}
\end{aligned}
$$

Thus the voltage gain is given by

$$
\frac{v_{O}}{v_{I}}=-\left[\frac{R_{2}}{R_{1}}+\frac{R_{4}}{R_{1}}\left(1+\frac{R_{2}}{R_{3}}\right)\right]
$$

which can be written in the form

$$
\frac{v_{O}}{v_{I}}=-\frac{R_{2}}{R_{1}}\left(1+\frac{R_{4}}{R_{2}}+\frac{R_{4}}{R_{3}}\right)
$$

Now, since an input resistance of $1 \mathrm{M} \Omega$ is required, we select $R_{1}=1 \mathrm{M} \Omega$. Then, with the limitation of using resistors no greater than $1 \mathrm{M} \Omega$, the maximum value possible for the first factor in the gain expression is 1 and is obtained by selecting $R_{2}=1 \mathrm{M} \Omega$. To obtain a gain of $-100, R_{3}$ and $R_{4}$ must be selected so that the second factor in the gain expression is 100 . If we select the maximum allowed (in this example) value of $1 \mathrm{M} \Omega$ for $R_{4}$, then the required value of $R_{3}$ can be calculated to be $10.2 \mathrm{k} \Omega$. Thus this circuit utilizes three $1-\mathrm{M} \Omega$ resistors and a $10.2-\mathrm{k} \Omega$ resistor. In comparison, if the inverting configuration were used with $R_{1}=1 \mathrm{M} \Omega$ we would have required a feedback resistor of $100 \mathrm{M} \Omega$, an impractically large value!

Before leaving this example it is insightful to inquire into the mechanism by which the circuit is able to realize a large voltage gain without using large resistances in the feedback path. Toward that end, observe that because of the virtual ground at the inverting input terminal of the op amp, $R_{2}$ and $R_{3}$ are in effect in parallel. Thus, by making $R_{3}$ lower than $R_{2}$ by, say, a factor $k$ (i.e., where $k>1$ ), $R_{3}$ is forced to carry a current $k$-times that in $R_{2}$. Thus, while $i_{2}=i_{1}, i_{3}=k i_{1}$ and $i_{4}=(k+1) i_{1}$. It is the current multiplication by a factor of $(k+1)$ that enables a large voltage drop to develop across $R_{4}$ and hence a large $v_{O}$ without using a large value for $R_{4}$. Notice also that the current through $R_{4}$ is independent of the value of $R_{4}$. It follows that the circuit can be used as a current amplifier as shown in Fig. 2.9.


Figure 2.9 A current amplifier based on the circuit of Fig. 2.8. The amplifier delivers its output current to $R_{4}$. It has a current gain of $\left(1+R_{2} / R_{3}\right)$, a zero input resistance, and an infinite output resistance. The load $\left(R_{4}\right)$, however, must be floating (i.e., neither of its two terminals can be connected to ground).
# EXERCISES 

D2.4 Use the circuit of Fig. 2.5 to design an inverting amplifier having a gain of -10 and an input resistance of $100 \mathrm{k} \Omega$. Give the values of $R_{1}$ and $R_{2}$.
Ans. $R_{1}=100 \mathrm{k} \Omega ; R_{2}=1 \mathrm{M} \Omega$
2.5 The circuit shown in Fig. E2.5(a) can be used to implement a transresistance amplifier (see Table 1.1 in Section 1.5). Find the value of the input resistance $R_{i}$, the transresistance $R_{m}$, and the output resistance $R_{o}$ of the transresistance amplifier. If the signal source shown in Fig. E2.5(b) is connected to the input of the transresistance amplifier, find the amplifier output voltage.
Ans. $R_{i}=0 ; R_{m}=-10 \mathrm{k} \Omega ; R_{o}=0 ; v_{O}=-5 \mathrm{~V}$


Figure E2.5
2.6 For the circuit in Fig. E2.6 determine the values of $v_{1}, i_{1}, i_{2}, v_{O}, i_{L}$, and $i_{O}$. Also determine the voltage gain $v_{O} / v_{f}$, current gain $i_{L} / i_{f}$, and power gain $P_{O} / P_{f}$.
Ans. $0 \mathrm{~V} ; 1 \mathrm{~mA} ; 1 \mathrm{~mA} ;-10 \mathrm{~V} ;-10 \mathrm{~mA} ;-11 \mathrm{~mA} ;-10 \mathrm{~V} / \mathrm{V}(20 \mathrm{~dB}),-10 \mathrm{~A} / \mathrm{A}(20 \mathrm{~dB})$; $100 \mathrm{~W} / \mathrm{W}(20 \mathrm{~dB})$


Figure E2.6

### 2.2.4 An Important Application—The Weighted Summer

A very important application of the inverting configuration is the weighted-summer circuit shown in Fig. 2.10. Here we have a resistance $R_{f}$ in the negative-feedback path (as before), but we have a number of input signals $v_{1}, v_{2}, \ldots, v_{n}$ each applied to a corresponding resistor# Example 11.11 continued 

where $T(s)$ is the transfer function of the two-port $R C$ network shown inside the broken-line box in Fig. 11.34(b):

$$
T(s) \equiv \frac{V_{s}}{V_{1}}=\frac{s(1 / C R)}{s^{2}+s(3 / C R)+(1 / C R)^{2}}
$$

Thus,

$$
L(s)=\frac{-s(K / C R)}{s^{2}+s(3 / C R)+(1 / C R)^{2}}
$$

The characteristic equation is

$$
1+L(s)=0
$$

that is,

$$
\begin{aligned}
s^{2}+s \frac{3}{C R}+\left(\frac{1}{C R}\right)^{2}-s \frac{K}{C R} & =0 \\
s^{2}+s \frac{3-K}{C R}+\left(\frac{1}{C R}\right)^{2} & =0
\end{aligned}
$$

By comparing this equation to the standard form of the second-order characteristic equation (Eq. 11.69), we see that the pole frequency $\omega_{0}$ is given by

$$
\omega_{0}=\frac{1}{C R}
$$

and the $Q$ factor is

$$
Q=\frac{1}{3-K}
$$

Thus for $K=0$, the poles have $Q=\frac{1}{3}$ and are therefore located on the negative real axis. As $K$ is increased, the poles are brought closer together and eventually coincide $(Q=0.5, K=1)$. Further increasing $K$ results in the poles becoming complex and conjugate. The root locus is then a circle because the radial distance $\omega_{0}$ remains constant (Eq. 11.76) independent of the value of $K$.

The maximally flat response is obtained when $Q=0.707$, which results when $K=1.586$. In this case the poles are at $45^{\circ}$ angles, as indicated in Fig. 11.34(c). The poles cross the $j \omega$ axis into the right half of the $s$ plane at the value of $K$ that results in $Q=\infty$, that is, $K=3$. Thus for $K \geq 3$ this circuit becomes unstable. This might appear to contradict our earlier conclusion that the feedback amplifier with a second-order response is unconditionally stable. Note, however, that the circuit in this example is quite different from the negative-feedback amplifier that we have been studying. Here we have an amplifier with a positive gain $K$ and a feedback network whose transfer function $T(s)$ is frequency dependent. This feedback is in fact positive, and the circuit will oscillate at the frequency for which the phase of $T(j \omega)$ is zero (which is $1 / C R$ ).

Example 11.11 illustrates the use of feedback (positive feedback in this case) to move the poles of an $R C$ network from their negative real-axis locations to complex-conjugate locations. One can accomplish the same task using negative feedback, as the root-locus diagram of


Figure 11.35 Root-locus diagram for an amplifier with three poles. The arrows indicate the pole movement as $A_{0} \beta$ is increased.

Fig. 11.31 demonstrates. The process of pole control is the essence of active-filter design, as will be discussed in Chapter 17.

# 11.8.5 Amplifiers with Three or More Poles 

Figure 11.35 shows the root-locus diagram for a feedback amplifier whose open-loop response is characterized by three poles. As indicated, increasing the loop gain from zero moves the highest-frequency pole outward while the two other poles are brought closer together. As $A_{0} \beta$ is increased further, the two poles become coincident and then become complex and conjugate. A value of $A_{0} \beta$ exists at which this pair of complex-conjugate poles enters the right half of the $s$ plane, thus causing the amplifier to become unstable.

This result is not entirely unexpected, since an amplifier with three poles has a phase shift that reaches $-270^{\circ}$ as $\omega$ approaches $\infty$. Thus there exists a finite frequency, $\omega_{180}$, at which the loop gain has $180^{\circ}$ phase shift.

From the root-locus diagram of Fig. 11.35, we observe that one can always maintain amplifier stability by keeping the loop gain $A_{0} \beta$ smaller than the value corresponding to the poles entering the right half-plane. In terms of the Nyquist diagram, the critical value of $A_{0} \beta$ is that for which the diagram passes through the $(-1,0)$ point. Reducing $A_{0} \beta$ below this value causes the Nyquist plot to shrink and thus intersect the negative real axis to the right of the $(-1,0)$ point, indicating stable amplifier performance. On the other hand, increasing $A_{0} \beta$ above the critical value causes the Nyquist plot to expand, thus encircling the $(-1,0)$ point and indicating unstable performance.

For a given open-loop gain $A_{0}$ the conclusions above can be stated in terms of the feedback factor $\beta$. That is, there exists a maximum value for $\beta$ above which the feedback amplifier becomes unstable. Alternatively, we can state that there exists a minimum value for the closed-loop gain $A_{f 0}$ below which the amplifier becomes unstable. To obtain lower values of closed-loop gain, one needs therefore to alter the loop transfer function $L(s)$. This is the process known as frequency compensation. We shall study the theory and techniques of frequency compensation in Section 11.10.
Before leaving this section, we point out that construction of the root-locus diagram for amplifiers having three or more poles as well as finite zeros is an involved process for which a systematic procedure exists. However, such a procedure will not be presented here, and the interested reader should consult Haykin (1970). Although the root-locus diagram provides the amplifier designer with considerable insight, other, simpler techniques based on Bode plots can be effectively employed, as will be explained in Section 11.9.

# EXERCISE 

11.25 Consider a feedback amplifier for which the open-loop transfer function $A(s)$ is given by

$$
A(s)=\left(\frac{10}{1+s / 10^{4}}\right)^{3}
$$

Let the feedback factor $\beta$ be frequency independent. Find the closed-loop poles as functions of $\beta$, and show that the root locus is that of Fig. E11.26. Also find the value of $\beta$ at which the amplifier becomes unstable. (Note: This is the same amplifier that was considered in Exercise 11.22.)


Figure E11.26

Ans. See Fig. E11.26; $\beta_{\text {critical }}=0.008$
# 11.9 Stability Study Using Bode Plots 

### 11.9.1 Gain and Phase Margins

From Sections 11.17 and 11.18 we know that whether a feedback amplifier is or is not stable can be determined by examining its loop gain $A \beta$ as a function of frequency. One of the simplest and most effective means for doing this is through the use of a Bode plot for $A \beta$, such as the one shown in Fig. 11.36. (Note that because the phase approaches $-360^{\circ}$, the circuit examined is a fourth-order one.) The feedback amplifier whose loop gain is plotted in Fig. 11.36 will be stable, since at the frequency of $180^{\circ}$ phase shift, $\omega_{180}$, the magnitude of the loop gain is less than unity (negative dB ). The difference between the value of $|A \beta|$ at $\omega_{180}$ and unity, called the gain margin, is usually expressed in decibels. The gain margin represents the amount by which the loop gain can be increased while stability is maintained. Feedback amplifiers are usually designed to have sufficient gain margin to allow for the inevitable changes in loop gain with temperature, time, and so on.

Another way to investigate the stability and to express its degree is to examine the Bode plot at the frequency for which $|A \beta|=1$, which is the point at which the magnitude plot crosses the 0 -dB line. If at this frequency the phase angle is less (in magnitude) than $180^{\circ}$, then the amplifier is stable. This is the situation illustrated in Fig. 11.36. The difference between the phase angle at this frequency and $180^{\circ}$ is termed the phase margin. On the other hand, if at the frequency of unity loop-gain magnitude, the phase lag is in excess of $180^{\circ}$, the amplifier will be unstable.


Figure 11.36 Bode plot for the loop gain $A \beta$ illustrating the definitions of the gain and phase margins.
# EXERCISE 

11.26 Consider an op amp having a single-pole, open-loop response with $A_{0}=10^{5}$ and $f_{P}=10 \mathrm{~Hz}$. Let the op amp be ideal otherwise (infinite input impedance, zero output impedance, etc.). If this amplifier is connected in the noninverting configuration with a nominal low-frequency, closed-loop gain of 100, find the frequency at which $|A \beta|=1$. Also, find the phase margin.
Ans. $10^{5} \mathrm{~Hz} ; 90^{\circ}$

### 11.9.2 Effect of Phase Margin on Closed-Loop Response

Feedback amplifiers are normally designed with a phase margin of at least $45^{\circ}$. The amount of phase margin has a profound effect on the shape of the closed-loop gain response. To see this relationship, consider a feedback amplifier with a large low-frequency loop gain, $A_{0} \beta \gg 1$. It follows that the closed-loop gain at low frequencies is approximately $1 / \beta$. Denoting the frequency at which the magnitude of loop gain is unity by $\omega_{1}$, we have (refer to Fig. 11.36)

$$
A\left(j \omega_{1}\right) \beta=1 \times e^{-j \theta}
$$

where

$$
\theta=180^{\circ}-\text { phase margin }
$$

At $\omega_{1}$ the closed-loop gain is

$$
A_{f}\left(j \omega_{1}\right)=\frac{A\left(j \omega_{1}\right)}{1+A\left(j \omega_{1}\right) \beta}
$$

Substituting from Eq. (11.78) gives

$$
A_{f}\left(j \omega_{1}\right)=\frac{(1 / \beta) e^{-j \theta}}{1+e^{-j \theta}}
$$

Thus the magnitude of the gain at $\omega_{1}$ is

$$
\left|A_{f}\left(j \omega_{1}\right)\right|=\frac{1 / \beta}{\left|1+e^{-j \theta}\right|}
$$

For a phase margin of $45^{\circ}, \theta=135^{\circ}$; and we obtain

$$
\left|A_{f}\left(j \omega_{1}\right)\right|=1.3 \frac{1}{\beta}
$$

That is, the gain peaks by a factor of 1.3 above the low-frequency value of $1 / \beta$. This peaking increases as the phase margin is reduced, eventually reaching $\infty$ when the phase margin is zero. Zero phase margin, of course, implies that the amplifier can sustain oscillations [poles on the $j \omega$ axis; Nyquist plot passing through $(-1,0)$ ].
# EXERCISE 

11.27 Find the closed-loop gain at $\omega_{1}$ relative to the low-frequency gain when the phase margin is $30^{\circ}, 60^{\circ}$, and $90^{\circ}$.
Ans. 1.93; 1; 0.707

### 11.9.3 An Alternative Approach for Investigating Stability

Investigating stability by constructing Bode plots for the loop gain $A \beta$ can be a tedious and time-consuming process, especially if we have to investigate the stability of a given amplifier for a variety of feedback networks. An alternative approach, which is much simpler, is to construct a Bode plot for the open-loop gain $A(j \omega)$ only. Assuming for the time being that $\beta$ is independent of frequency, we can plot $20 \log (1 / \beta)$ as a horizontal straight line on the same plane used for $20 \log |A|$. The difference between the two curves will be

$$
20 \log |A(j \omega)|-20 \log \frac{1}{\beta}=20 \log |A \beta|
$$

which is the loop gain (in dB ). We may therefore study stability by examining the difference between the two plots. If we wish to evaluate stability for a different feedback factor, we simply draw another horizontal straight line at the level $20 \log (1 / \beta)$.

To illustrate, consider an amplifier whose open-loop transfer function is characterized by three poles. For simplicity let the three poles be widely separated-say, at $0.1 \mathrm{MHz}, 1 \mathrm{MHz}$, and 10 MHz , as shown in Fig. 11.37. Note that because the poles are widely separated, the phase is approximately $-45^{\circ}$ at the first pole frequency, $-135^{\circ}$ at the second, and $-225^{\circ}$ at the third. The frequency at which the phase of $A(j \omega)$ is $-180^{\circ}$ lies on the $-40-\mathrm{dB} /$ decade segment, as indicated in Fig. 11.37.

The open-loop gain of this amplifier can be expressed as

$$
A=\frac{10^{5}}{\left(1+j f / 10^{5}\right)\left(1+j f / 10^{6}\right)\left(1+j f / 10^{7}\right)}
$$

from which $|A|$ can be easily determined for any frequency $f$ (in Hz ), and the phase can be obtained as

$$
\phi=-\left[\tan ^{-1}\left(f / 10^{5}\right)+\tan ^{-1}\left(f / 10^{6}\right)+\tan ^{-1}\left(f / 10^{7}\right)\right]
$$

The magnitude and phase graphs shown in Fig. 11.37 are obtained using the method for constructing Bode plots (Appendix F). These graphs provide approximate values for important amplifier parameters, with more exact values obtainable from Eqs. (11.85) and (11.86). For example, the frequency $f_{180}$ at which the phase angle is $180^{\circ}$ can be found from Fig. 11.37 to be approximately $3.2 \times 10^{6} \mathrm{~Hz}$. Using this value as a starting point, a more exact value can be found by trial and error using Eq. (11.86). The result is $f_{180}=3.34 \times 10^{6} \mathrm{~Hz}$. At this frequency, Eq. (11.85) gives a gain magnitude of 58.2 dB , which is reasonably close to the approximate value of 60 dB given by Fig. 11.37.


Figure 11.37 Stability analysis using Bode plot of $|A|$.

Consider next the straight line labeled (a) in Fig. 11.37. This line represents a feedback factor for which $20 \log (1 / \beta)=85 \mathrm{~dB}$, which corresponds to $\beta=5.623 \times 10^{-5}$ and a closed-loop gain of 83.6 dB . Since the loop gain is the difference between the $|A|$ curve and the $1 / \beta$ line, the point of intersection $X_{1}$ corresponds to the frequency at which $|A \beta|=1$. Using the graphs of Fig. 11.37, this frequency can be found to be approximately $5.6 \times 10^{5} \mathrm{~Hz}$. A more exact value of $4.936 \times 10^{5}$ can be obtained using the transfer function equations. At this frequency the phase angle is approximately $-108^{\circ}$. Thus the closed-loop amplifier, for which $20 \log (1 / \beta)$ $=85 \mathrm{~dB}$, will be stable with a phase margin of $72^{\circ}$. The gain margin can be easily obtained from Fig. 11.37; it is 25 dB .

Next, suppose that we wish to use this amplifier to obtain a closed-loop gain of $50-\mathrm{dB}$ nominal value. Since $A_{0}=100 \mathrm{~dB}$, we see that $A_{0} \beta \gg 1$ and $20 \log \left(A_{0} \beta\right) \simeq 50 \mathrm{~dB}$, resulting in $20 \log (1 / \beta) \simeq 50 \mathrm{~dB}$. To see whether this closed-loop amplifier is or is not stable, we draw line (b) in Fig. 11.37 with a height of 50 dB . This line intersects the open-loop gain curve at point $X_{2}$, where the corresponding phase is greater than $180^{\circ}$. Thus the closed-loop amplifier with $50-\mathrm{dB}$ gain will be unstable.
In fact, it can easily be seen from Fig. 11.37 that the minimum value of $20 \log (1 / \beta)$ that can be used, with the resulting amplifier being stable, is 60 dB . In other words, the minimum value of stable closed-loop gain obtained with this amplifier is approximately 60 dB . At this value of gain, however, a manufactured version of this amplifier may still oscillate, since no margin is left to allow for possible changes in gain.

Since the $180^{\circ}$-phase point always occurs on the $-40-\mathrm{dB} /$ decade segment of the Bode plot for $|A|$, a rule of thumb to guarantee stability is as follows: The closed-loop amplifier will be stable if the $20 \log (1 / \beta)$ line intersects the $20 \log |A|$ curve at a point on the $-20-\mathrm{dB} /$ decade segment. Following this rule ensures that a phase margin of at least $45^{\circ}$ is obtained. For the example of Fig. 11.37, the rule implies that the maximum value of $\beta$ is $10^{-4}$, which corresponds to a closed-loop gain of approximately 80 dB .

The rule of thumb above can be generalized for the case in which $\beta$ is a function of frequency. The general rule states that at the intersection of $20 \log [1 /|\beta(j \omega)|]$ and $20 \log |A(j \omega)|$ the difference of slopes (called the rate of closure) should not exceed $20 \mathrm{~dB} /$ decade.

# EXERCISE 

11.28 Consider an op amp whose open-loop gain is identical to that of Fig. 11.37. Assume that the op amp is ideal otherwise. Let the op amp be connected as a differentiator. Use the rule of thumb above to show that for stable performance the differentiator time constant should be greater than 159 ms . [Hint: Recall that for a differentiator, the Bode plot for $1 /|\beta(j \omega)|$ has a slope of $+20 \mathrm{~dB} /$ decade and intersects the $0-\mathrm{dB}$ line at $1 / \tau$, where $\tau$ is the differentiator time constant.]

### 11.10 Frequency Compensation

In this section, we shall discuss methods for modifying the open-loop transfer function $A(s)$ of an amplifier having three or more poles so that the closed-loop amplifier is stable for a given desired value of closed-loop gain. This process is referred to as frequency compensation.

### 11.10.1 Theory

The simplest method of frequency compensation consists of introducing a new pole in the function $A(s)$ at a frequency, $f_{D}$, sufficiently low that the modified open-loop gain, $A^{\prime}(s)$, intersects the $20 \log (1 /|\beta|)$ curve with a slope difference of $20 \mathrm{~dB} /$ decade. As an example, let it be required to compensate the amplifier whose $A(s)$ is shown in Fig. 11.38 such that closed-loop amplifiers with $\beta$ as high as $10^{-2}$ (i.e., closed-loop gains as low as approximately 40 dB ) will be stable. First, we draw a horizontal straight line at the $40-\mathrm{dB}$ level to represent $20 \log (1 / \beta)$, as shown in Fig. 11.38. We then locate point $Y$ on this line at the frequency of the first pole, $f_{P 1}$. From $Y$ we draw a line with $-20-\mathrm{dB} /$ decade slope and determine the point at which this line intersects the dc gain line, point $Y^{\prime}$. This latter point


Figure 11.38 Frequency compensation for $\beta=10^{-3}$. The response labeled $A^{\prime}$ is obtained by introducing an additional pole at $f_{D}$. The $A^{\prime \prime}$ response is obtained by moving the original low-frequency pole to $f_{D}^{\prime}$.
gives the frequency $f_{D}$ of the new pole that has to be introduced in the open-loop transfer function.

The compensated open-loop response $A^{\prime}(s)$ is indicated in Fig. 11.38. It has four poles: at $f_{D}, f_{P 1}, f_{P 2}$, and $f_{P 3}$. Thus $\left|A^{\prime}\right|$ begins to roll off with a slope of $-20 \mathrm{~dB} /$ decade at $f_{D}$. At $f_{P 1}$ the slope changes to $-40 \mathrm{~dB} /$ decade, at $f_{P 2}$ it changes to $-60 \mathrm{~dB} /$ decade, and so on. Since the $20 \log (1 / \beta)$ line intersects the $20 \log \left|A^{\prime}\right|$ curve at point $Y$ on the $-20-\mathrm{dB} /$ decade segment, the closed-loop amplifier with this $\beta$ value (or lower values) will be stable.

A serious disadvantage of this compensation method is that at most frequencies the open-loop gain has been drastically reduced. This means that at most frequencies the amount of feedback available will be small. Since all the advantages of negative feedback are directly proportional to the amount of feedback, the performance of the compensated amplifier will be impaired.

Careful examination of Fig. 11.38 shows that the gain $A^{\prime}(s)$ is low because of the pole at $f_{P 1}$. If we can somehow eliminate this pole, then-rather than locating point $Y$, drawing $Y Y^{\prime}$, and so on-we can start from point $Z$ (at the frequency of the second pole) and draw the line $Z Z^{\prime}$. This would result in the open-loop curve $A^{\prime \prime}(s)$, which shows considerably higher gain than $A^{\prime}(s)$.

Although it is not possible to eliminate the pole at $f_{P 1}$, it is usually possible to shift that pole from $f=f_{P 1}$ to $f=f_{D}^{\prime}$. This makes the pole dominant and eliminates the need for introducing an additional lower-frequency pole, as will be explained next.


Figure 11.39 (a) Two cascaded gain stages of a multistage amplifier. (b) Equivalent circuit for the interface between the two stages in (a). (c) Same circuit as in (b), but with a compensating capacitor $C_{C}$ added. Note that the analysis here applies equally well to MOS amplifiers.

# 11.10.2 Implementation 

We shall now address the question of implementing the frequency-compensation scheme discussed above. The amplifier circuit normally consists of a number of cascaded gain stages, with each stage responsible for one or more of the transfer function poles. Through manual and/or computer analysis of the circuit, one identifies the stage that introduces each of the important poles $f_{P 1}, f_{P 2}$, and so on. For the purpose of our discussion, assume that the first pole $f_{P 1}$ is introduced at the interface between the two cascaded differential stages shown in Fig. 11.39(a). In Fig. 11.39(b) we show a simple small-signal model of the circuit at this interface. Current source $I_{s}$ represents the output-signal current of the $Q_{1}-Q_{2}$ stage. Resistance $R_{s}$ and capacitance $C_{s}$ represent the total resistance and capacitance between the two nodes B and $\mathrm{B}^{\prime}$. It follows that the pole $f_{P 1}$ is given by

$$
f_{P 1}=\frac{1}{2 \pi C_{s} R_{s}}
$$

Let us now connect the compensating capacitor $C_{C}$ between nodes B and $\mathrm{B}^{\prime}$. This will result in the modified equivalent circuit shown in Fig. 11.39(c), from which we see that the pole introduced will no longer be at $f_{P 1}$; rather, the pole can be at any desired lower frequency $f_{D}^{\prime}$ :

$$
f_{D}^{\prime}=\frac{1}{2 \pi\left(C_{s}+C_{C}\right) R_{s}}
$$We thus conclude that one can select an appropriate value for $C_{C}$ to shift the pole frequency from $f_{P 1}$ to the value $f_{D}^{\prime}$ determined by point $Z^{\prime}$ in Fig. 11.38.

At this juncture it should be pointed out that adding the capacitor $C_{C}$ will usually result in changes in the location of the other poles (those at $f_{P 2}$ and $f_{P 3}$ ). One might therefore need to calculate the new location of $f_{P 2}$ and perform a few iterations to arrive at the required value for $C_{C}$.

A disadvantage of this implementation method is that the required value of $C_{C}$ is usually quite large. Thus if the amplifier to be compensated is an IC op amp, it will be difficult, and probably impossible, to include this compensating capacitor on the IC chip. (As pointed out in Chapter 8 and in Appendix A, the maximum practical size of a monolithic capacitor is about 100 pF .) An elegant solution to this problem is to connect the compensating capacitor in the feedback path of an inverting amplifier stage. Because of the Miller effect (Section 10.3), the compensating capacitance will be multiplied by the stage gain, resulting in a much larger effective capacitance. Furthermore, as explained later, another unexpected benefit accrues.

# 11.10.3 Miller Compensation and Pole Splitting 

Figure 11.40(a) shows one gain stage in a multistage amplifier. For simplicity, the stage is shown as a common-emitter amplifier, but in practice it can be a more elaborate circuit. In the feedback path of this common-emitter stage we have placed a compensating capacitor $C_{f}$.

Figure 11.40(b) shows a simplified equivalent circuit of the gain stage of Fig. 11.40(a). Here $R_{1}$ and $C_{1}$ represent the total resistance and total capacitance between node B and ground. Similarly, $R_{2}$ and $C_{2}$ represent the total resistance and total capacitance between node C and ground. Furthermore, it is assumed that $C_{1}$ includes the Miller component due to capacitance $C_{o}$, and $C_{2}$ includes the input capacitance of the succeeding amplifier stage. Finally, $I_{i}$ represents the output signal current of the preceding stage.

In the absence of the compensating capacitor $C_{f}$, we can see from Fig. 11.40(b) that there are two poles-one at the input and one at the output. Let us assume that these two poles are $f_{P 1}$ and $f_{P 2}$ of Fig. 11.38; thus,

$$
f_{P 1}=\frac{1}{2 \pi C_{1} R_{1}} \quad f_{P 2}=\frac{1}{2 \pi C_{2} R_{2}}
$$



Figure 11.40 (a) A gain stage in a multistage amplifier with a compensating capacitor connected in the feedback path, and (b) equivalent circuit. Note that although a BJT is shown, the analysis applies equally well to the MOSFET case.
With $C_{f}$ present, analysis of the circuit yields the transfer function

$$
\frac{V_{o}}{I_{i}}=\frac{\left(s C_{f}-g_{m}\right) R_{1} R_{2}}{1+s\left[C_{1} R_{1}+C_{2} R_{2}+C_{f}\left(g_{m} R_{1} R_{2}+R_{1}+R_{2}\right)\right]+s^{2}\left[C_{1} C_{2}+C_{f}\left(C_{1}+C_{2}\right)\right] R_{1} R_{2}}
$$

The zero is usually at a much higher frequency than the dominant pole, and we shall neglect its effect. The denominator polynomial $D(s)$ can be written in the form

$$
D(s)=\left(1+\frac{s}{\omega_{P 1}^{\prime}}\right)\left(1+\frac{s}{\omega_{P 2}^{\prime}}\right)=1+s\left(\frac{1}{\omega_{P 1}^{\prime}}+\frac{1}{\omega_{P 2}^{\prime}}\right)+\frac{s^{2}}{\omega_{P 1}^{\prime} \omega_{P 2}^{\prime}}
$$

where $\omega_{P 1}^{\prime}$ and $\omega_{P 2}^{\prime}$ are the new frequencies of the two poles. Normally one of the poles will be dominant; $\omega_{P 1}^{\prime} \ll \omega_{P 2}^{\prime}$. Thus,

$$
D(s) \simeq 1+\frac{s}{\omega_{P 1}^{\prime}}+\frac{s^{2}}{\omega_{P 1}^{\prime} \omega_{P 2}^{\prime}}
$$

Equating the coefficients of $s$ in the denominator of Eq. (11.90) and in Eq. (11.92) results in

$$
\omega_{P 1}^{\prime}=\frac{1}{C_{1} R_{1}+C_{2} R_{2}+C_{f}\left(g_{m} R_{1} R_{2}+R_{1}+R_{2}\right)}
$$

which can be approximated by

$$
\omega_{P 1}^{\prime} \simeq \frac{1}{g_{m} R_{2} C_{f} R_{1}}
$$

To obtain $\omega_{P 2}^{\prime}$ we equate the coefficients of $s^{2}$ in the denominator of Eq. (11.90) and in Eq. (11.92) and use Eq. (11.93):

$$
\omega_{P 2}^{\prime} \simeq \frac{g_{m} C_{f}}{C_{1} C_{2}+C_{f}\left(C_{1}+C_{2}\right)}
$$

From Eqs. (11.93) and (11.94), we see that as $C_{f}$ is increased, $\omega_{P 1}^{\prime}$ is reduced and $\omega_{P 2}^{\prime}$ is increased. This action is referred to as pole splitting. Note that the increase in $\omega_{P 2}^{\prime}$ is highly beneficial; it allows us to move point $Z$ (see Fig. 11.38) further to the right, thus resulting in higher compensated open-loop gain. Finally, note from Eq. (11.93) that $C_{f}$ is multiplied by the Miller effect factor $g_{m} R_{2}$, thus resulting in a much larger effective capacitance, $g_{m} R_{2} C_{f}$. In other words, the required value of $C_{f}$ will be much smaller than that of $C_{C}$ in Fig. 11.39.

# Example 11.12 

Consider an op amp whose open-loop transfer function is identical to that shown in Fig. 11.37. We wish to compensate this op amp so that the closed-loop amplifier with resistive feedback is stable for any gain (i.e., for $\beta$ up to unity). Assume that the op-amp circuit includes a stage such as that of Fig. 11.40 with $C_{1}=100 \mathrm{pF}, C_{2}=5 \mathrm{pF}$, and $g_{m}=40 \mathrm{~mA} / \mathrm{V}$, that the pole at $f_{P 1}$ is caused by the input circuit of that stage, and that the pole at $f_{P 2}$ is introduced by the output circuit. Find the value of the compensating capacitor
# Example 11.12 continued 

for two cases: either if it is connected between the input node B and ground or in the feedback path of the transistor.

## Solution

First we determine $R_{1}$ and $R_{2}$ from

$$
f_{P 1}=0.1 \mathrm{MHz}=\frac{1}{2 \pi C_{1} R_{1}}
$$

Thus,

$$
\begin{aligned}
R_{1} & =\frac{10^{5}}{2 \pi} \Omega \\
f_{P 2} & =1 \mathrm{MHz}=\frac{1}{2 \pi C_{2} R_{2}}
\end{aligned}
$$

Thus,

$$
R_{2}=\frac{10^{5}}{\pi} \Omega
$$

If a compensating capacitor $C_{C}$ is connected across the input terminals of the transistor stage, then the frequency of the first pole changes from $f_{P 1}$ to $f_{D}^{\prime}$ :

$$
f_{D}^{\prime}=\frac{1}{2 \pi\left(C_{1}+C_{C}\right) R_{1}}
$$

The second pole remains unchanged at 1 MHz . The required value for $f_{D}^{\prime}$ is determined by drawing a $-20-\mathrm{dB} /$ decade line from the $1-\mathrm{MHz}$ frequency point on the $20 \log (1 / \beta)=20 \log 1=0 \mathrm{~dB}$ line. This line will intersect the $100-\mathrm{dB}$ dc gain line at 10 Hz . Thus,

$$
f_{D}^{\prime}=10 \mathrm{~Hz}=\frac{1}{2 \pi\left(C_{1}+C_{C}\right) R_{1}}
$$

which results in $C_{C} \simeq 1 \mu \mathrm{~F}$, which is quite large and certainly cannot be included on the IC chip.
Next, if a compensating capacitor $C_{f}$ is connected in the feedback path of the transistor, then both poles change location to the values given by Eqs. (11.93) and (11.94):

$$
f_{P 1}^{\prime} \simeq \frac{1}{2 \pi g_{m} R_{2} C_{f} R_{1}} \quad f_{P 2}^{\prime} \simeq \frac{g_{m} C_{f}}{2 \pi\left[C_{1} C_{2}+C_{f}\left(C_{1}+C_{2}\right)\right]}
$$

To determine where we should locate the first pole, we need to know the value of $f_{P 2}^{\prime}$. As an approximation, let us assume that $C_{f} \gg C_{2}$, which enables us to obtain

$$
f_{P 2}^{\prime} \simeq \frac{g_{m}}{2 \pi\left(C_{1}+C_{2}\right)}=60.6 \mathrm{MHz}
$$

Thus it appears that this pole will move to a frequency higher than $f_{P 3}$ (which is 10 MHz ). Let us therefore assume that the second pole will be at $f_{P 3}$. This requires that the modified first pole be located at

$$
f_{P 1}^{\prime}=\frac{f_{P 3}}{A_{0}}=\frac{10^{7} \mathrm{~Hz}}{10^{5}}=100 \mathrm{~Hz}
$$
Thus,

$$
f_{P 1}^{\prime}=100 \mathrm{~Hz}=\frac{1}{2 \pi g_{m} R_{2} C_{f} R_{1}}
$$

which results in $C_{f}=78.5 \mathrm{pF}$. Although this value is indeed much greater than $C_{2}$, we can determine the location of the pole $f_{P 2}^{\prime}$ from Eq. (11.95), which yields $f_{P 2}^{\prime}=57.2 \mathrm{MHz}$, confirming that this pole has indeed been moved past $f_{P 3}$.

We conclude that using Miller compensation not only results in a much smaller compensating capacitor but, owing to pole splitting, also enables us to place the dominant pole a decade higher in frequency. This results in a wider bandwidth for the compensated op amp.

# EXERCISES 

11.29 A multipole amplifier having a first pole at 1 MHz and an open-loop gain of 100 dB is to be compensated for closed-loop gains as low as 20 dB by the introduction of a new dominant pole. At what frequency must the new pole be placed?
Ans. 100 Hz
11.30 For the amplifier described in Exercise 11.29, rather than introducing a new dominant pole, we can use additional capacitance at the circuit node at which the first pole is formed to reduce the frequency of the first pole. If the frequency of the second pole is 10 MHz and if it remains unchanged while additional capacitance is introduced as mentioned, find the frequency to which the first pole must be lowered so that the resulting amplifier is stable for closed-loop gains as low as 20 dB . By what factor must the capacitance at the controlling node be increased?
Ans. $1000 \mathrm{~Hz} ; 1000$

## Summary

- Negative feedback is employed to make the amplifier gain less sensitive to component variations; to control input and output resistances; to extend bandwidth; to reduce nonlinear distortion; and to enhance signal-to-interference ratio.
- The advantages above are obtained at the expense of a reduction in gain and at the risk of the amplifier becoming unstable (that is, oscillating). The latter problem is solved by careful design.
- The structure of an ideal negative-feedback amplifier is shown in Fig. 11.1. Table 11.1 summarizes the parameters
and relationships governing the operation of the ideal structure.
- For each of the four basic types of amplifier, there is an appropriate feedback topology. The four topologies, together with their analysis procedure and their effects on input and output impedances, are summarized in Table 11.2 in Section 11.6.
- The key feedback parameters are the loop gain $(A \beta)$, which for negative feedback must be a positive dimensionless number, and the amount of feedback $(1+$ $A \beta)$. The latter directly determines gain reduction, gain
desensitivity, bandwidth extension, and changes in $R_{i}$ and $R_{o}$.

- The loop gain $A \beta$ can be determined by breaking the feedback loop, as illustrated in Figs. 11.2 and 11.9. The value of $A \beta$ can be used together with the feedback factor $\beta$ to determine $A$ and hence $A_{f}$. This method, though simple, is incomplete as it does not enable the determination of the input and output resistances. For these, we utilize the systematic method for feedback analysis (refer to Table 11.2).
- The ideal or upper-bound value of the closed-loop gain $A_{f}$ is $1 / \beta$ and is approached when $A \beta \gg 1$.
- Since $A$ and $\beta$ are in general frequency dependent, the poles of the feedback amplifier are obtained by solving the characteristic equation $1+A(s) \beta(s)=0$.
- For the feedback amplifier to be stable, its poles must all be in the left half of the $s$ plane.
- Stability is guaranteed if at the frequency for which the phase angle of $A \beta$ is $180^{\circ}$ (i.e., $\omega_{180}$ ), $|A \beta|$ is less than unity; the amount by which it is less than unity, expressed in decibels, is the gain margin. Alternatively, the amplifier is stable if, at the frequency at which $|A \beta|=1$, the phase angle is less than $180^{\circ}$; the difference is the phase margin.
- The stability of a feedback amplifier can be analyzed by constructing a Bode plot for $|A|$ and superimposing on it a plot for $20 \log 1 /|\beta|$. Stability is guaranteed if the two plots intersect with a difference in slope no greater than $6 \mathrm{~dB} /$ octave.
- To make a given amplifier stable for a given feedback factor $\beta$, the open-loop frequency response is suitably modified by a process known as frequency compensation.
- A popular method for frequency compensation involves connecting a feedback capacitor across an inverting stage in the amplifier. This causes the pole formed at the input of the amplifier stage to shift to a lower frequency and thus become dominant, while the pole formed at the output of the amplifier stage is moved to a very high frequency and thus becomes unimportant. This process is known as pole splitting.


# PROBLEMS 

## Computer Simulation Problems

SIIR Problems identified by the Multisim/PSpice icon are intended to demonstrate the value of using SPICE simulation to verify hand analysis and design, and to investigate important issues such as allowable signal swing and amplifier nonlinear distortion. Instructions to assist in setting up PSpice and Multisim simulations for all the indicated problems can be found in the corresponding files on the website. Note that if a particular parameter value is not specified in the problem statement, you are to make a reasonable assumption.

## Section 11.1: The General Feedback Structure

11.1 A negative-feedback amplifier has a closed-loop gain $A_{f}=200$ and an open-loop gain $A=10^{4}$. What is the feedback factor $\beta$ ? If a manufacturing error results in a reduction of $A$ to $10^{7}$, what closed-loop gain results? What is the percentage change in $A_{f}$ corresponding to this factor of 10 reduction in $A$ ?
11.2 Consider the op-amp circuit shown in Fig. P11.2, where the op amp has infinite input resistance and zero output resistance but finite open-loop gain $A$.


Figure P11.2
(a) Convince yourself that $\beta=R_{1} /\left(R_{1}+R_{2}\right)$.
(b) If $R_{1}=10 \mathrm{k} \Omega$, find $R_{2}$ that results in $A_{f}=10 \mathrm{~V} / \mathrm{V}$ for the following three cases: (i) $A=1000 \mathrm{~V} / \mathrm{V}$; (ii) $A=200 \mathrm{~V} / \mathrm{V}$; (iii) $A=15 \mathrm{~V} / \mathrm{V}$.
(c) For each of the three cases in (b), find the percentage change in $A_{f}$ that results when $A$ decreases by $20 \%$. Comment on the results.
11.3 The noninverting buffer op-amp configuration shown in Fig. P11.3 provides a direct implementation of the feedback loop of Fig. 11.1. Assuming that the op amp has infinite input resistance and zero output resistance, what is $\beta$ ? If $A=1000$, what is the closed-loop voltage gain? What is the amount of feedback (in dB )? For $V_{s}=1 \mathrm{~V}$, find $V_{o}$ and $V_{i}$. If $A$ decreases by $10 \%$, what is the corresponding percentage decrease in $A_{f}$ ?


Figure P11.3
11.4 In a particular circuit represented by the block diagram of Fig. 11.1, a signal of 1 V from the source results in a difference signal of 10 mV being provided to the amplifying element $A$, and 5 V appearing at the output. For this arrangement, identify the values of $A$ and $\beta$ that apply.
11.5 (a) Show that in a negative-feedback amplifier with loop gain $A \beta \gg 1$, the closed-loop gain $A_{f}$ is lower than its ideal value of $1 / \beta$ by $(100 / A \beta) \%$.
(b) What is the minimum loop gain required so that $A_{f}$ is within (i) $0.1 \%$, (ii) $1 \%$, and (iii) $5 \%$ of its ideal value?
11.6 In a particular amplifier design, the $\beta$ network consists of a linear potentiometer for which $\beta$ is 0.00 at one end, 1.00 at the other end, and 0.50 in the middle. As the potentiometer is adjusted, find the three values of closed-loop gain that result when the amplifier open-loop gain is (a) $1 \mathrm{~V} / \mathrm{V}$, (b) $10 \mathrm{~V} / \mathrm{V}$, (c) $100 \mathrm{~V} / \mathrm{V}$, (d) $1000 \mathrm{~V} / \mathrm{V}$, and (e) $10,000 \mathrm{~V} / \mathrm{V}$. Provide your results in a table in which there is a row for each value of $A$ and a column for each value of $\beta$.
11.7 A newly constructed feedback amplifier undergoes a performance test with the following results: With the feedback connection removed, a source signal of 2 mV is required to provide a $5-\mathrm{V}$ output; with the feedback connected, a $5-\mathrm{V}$ output requires a $100-\mathrm{mV}$ source signal. For this amplifier, identify values of $A, \beta, A \beta$, the closed-loop gain, and the amount of feedback (in dB ).

D 11.8 An amplifier has an open-loop gain with a nominal value of 1000 but can vary from unit to unit by as much as $\pm 50 \%$ of nominal. It is required to apply negative feedback to this amplifier so that the variability of the closed-loop gain of the resulting feedback amplifier is limited to $\pm 1 \%$. What is the largest possible nominal value of closed-loop gain that can be achieved? Now if three of these feedback amplifiers are placed in cascade, what is the nominal value of the gain of the resulting cascade amplifier? What is the expected variability of this gain?
11.9 The op amp in the circuit of Fig. P11.9 has an open-circuit voltage gain $\mu$, a differential input resistance $R_{i d}$, and a negligibly small output resistance. It is connected in the noninverting configuration with a feedback network consisting of a voltage divider $\left(R_{1}, R_{2}\right)$. While $\beta$ is still determined by the divider ratio [i.e., $\beta=R_{1} /\left(R_{1}+R_{2}\right)$ ], the open-loop gain $A$ is no longer simply equal to $\mu$. This is because the feedback network now loads the input of the amplifier (because of the finite $R_{i d}$ ). To determine the value of $A$, use the method outlined in Section 11.1.3 to determine the loop gain $A \beta$. Thus show that

$$
A=\mu \frac{R_{i d}}{R_{i d}+\left(R_{1} \| R_{2}\right)}
$$



Figure P11.9

## Section 11.2: Some Properties of Negative Feedback

11.10 For the negative-feedback loop of Fig. 11.1, find the loop gain $A \beta$ for which the sensitivity of closed-loop gain to open-loop gain [i.e., $\left(d A_{f} / A_{f}\right) /(d A / A)$ ] is -40 dB . For what value of $A \beta$ does the sensitivity become $1 / 5$ ?
D 11.11 A designer is considering two possible designs of a feedback amplifier. The ultimate goal is $A_{f}=10 \mathrm{~V} / \mathrm{V}$. One design employs an amplifier for which $A=1000 \mathrm{~V} / \mathrm{V}$ and the other uses $A=500 \mathrm{~V} / \mathrm{V}$. Find $\beta$ and the desensitivity factor in both cases. If the $A=1000$ amplifier units have a gain uncertainty of $\pm 10 \%$, what is the gain uncertainty for the closed-loop amplifiers utilizing this amplifier type? If the same result is to be achieved with the $A=500$ amplifier, what is the maximum allowable uncertainty in its gain?

D 11.12 A designer is required to achieve a closed-loop gain of $10 \pm 0.1 \% \mathrm{~V} / \mathrm{V}$ using a basic amplifier whose gain variation is $\pm 10 \%$. What nominal value of $A$ and $\beta$ (assumed constant) are required?

D 11.13 A circuit designer requires a gain of $25 \pm 1 \% \mathrm{~V} / \mathrm{V}$ using an amplifier whose gain varies by a factor of 10 over temperature and time. What is the lowest gain required? The value of $\beta$ ? (Hint: Since the change in the open-loop gain is very large, do not use differential analysis.)

D 11.14 A power amplifier employs an output stage whose gain varies from 2 to 12 for various reasons. What is the gain of an ideal (nonvarying) amplifier connected to drive it so that an overall gain with feedback of $100 \pm 5 \% \mathrm{~V} / \mathrm{V}$ can be achieved? What is the value of $\beta$ to be used? What are the requirements if $A_{f}$ must be held within $\pm 0.5 \%$ ? For each of these situations, what preamplifier gain and feedback factor $\beta$ are required if $A_{f}$ is to be $10 \mathrm{~V} / \mathrm{V}$ (with the two possible tolerances)? (Hint: Since the change in the open-loop gain is very large, do not use differential analysis.)

D 11.15 It is required to design an amplifier with a gain of 100 that is accurate to within $\pm 1 \%$. You have available amplifier stages with a gain of 1000 that is accurate to within $\pm 30 \%$. Provide a design that uses a number of these gain stages in cascade, with each stage employing negative feedback of an appropriate amount. Obviously, your design should use the lowest possible number of stages while meeting specification.

D *11.16 It is required to design an amplifier to have a nominal closed-loop gain of $10 \mathrm{~V} / \mathrm{V}$ using a battery-operated amplifier whose gain reduces to half its normal full-battery value over the life of the battery. If only $2 \%$ drop in closed-loop gain is desired, what nominal open-loop amplifier gain must be used in the design? (Note that since the change in $A$ is large, it is inaccurate to use differentials.) What value
of $\beta$ should be chosen? If component-value variation in the $\beta$ network may produce as much as a $\pm 1 \%$ variation in $\beta$, to what value must $A$ be raised to ensure the required minimum gain?

D 11.17 Design a feedback amplifier that has a closed-loop gain of $100 \mathrm{~V} / \mathrm{V}$ and is relatively insensitive to change in basic-amplifier gain. In particular, it should provide a reduction in $A_{f}$ to $99 \mathrm{~V} / \mathrm{V}$ for a reduction in $A$ to one-tenth its nominal value. What is the required loop gain? What nominal value of $A$ is required? What value of $\beta$ should be used? What would the closed-loop gain become if $A$ were increased tenfold? If $A$ were made infinite?
11.18 Consider an amplifier having a midband gain $A_{M}$ and a low-frequency response characterized by a pole at $s=-\omega_{L}$ and a zero at $s=0$. Let the amplifier be connected in a negative-feedback loop with a feedback factor $\beta$. Find an expression for the midband gain and the lower 3-dB frequency of the closed-loop amplifier. By what factor have both changed?
11.19 A capacitively coupled amplifier has a midband gain of $1000 \mathrm{~V} / \mathrm{V}$, a single high-frequency pole at 10 kHz , and a single low-frequency pole at 100 Hz . Negative feedback is employed so that the midband gain is reduced to 10 . What are the upper and lower 3-dB frequencies of the closed-loop gain?

D 11.20 Low-cost audio power amplifiers often avoid direct coupling of the loudspeaker to the output stage because any resulting dc bias current in the speaker can use up (and thereby waste) its limited mechanical dynamic range. Unfortunately, the coupling capacitor needed can be large! But feedback helps. For example, for an $8-\Omega$ loudspeaker and $f_{L}=100 \mathrm{~Hz}$, what size capacitor is needed? Now, if feedback is arranged around the amplifier and the speaker so that a closed-loop gain $A_{f}=10 \mathrm{~V} / \mathrm{V}$ is obtained from an amplifier whose open-loop gain is $1000 \mathrm{~V} / \mathrm{V}$, what value of $f_{L C}$ results? If the ultimate product-design specification requires a $50-\mathrm{Hz}$ cutoff, what capacitor can be used?

D *11.21 It is required to design a dc amplifier with a low-frequency gain of 1000 and a 3-dB frequency of 1 MHz . You have available gain stages with a gain of 1000 but with a dominant high-frequency pole at 20 kHz . Provide a design that employs a number of such stages in cascade, each with negative feedback of an appropriate amount. Use identical stages.

[^0]
[^0]:    11.10 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
Hint: The 3-dB frequency of a cascade of $N$ identical gain stages, each with a $3-\mathrm{dB}$ frequency $\left.f_{3 \mathrm{~dB}}\right|_{\text {stage }}$ is given by

$$
\left.f_{3 \mathrm{~dB}}\right|_{\text {cascade }}=\left.f_{3 \mathrm{~dB}}\right|_{\text {stage }} \sqrt{2^{1 / N}-1}
$$

D 11.22 Design a supply-ripple-reduced power amplifier for which the output stage can be modeled by the block diagram of Fig. 11.5, where $A_{1}=0.9 \mathrm{~V} / \mathrm{V}$, and the power-supply ripple $V_{N}= \pm 1 \mathrm{~V}$. A closed-loop gain of $10 \mathrm{~V} / \mathrm{V}$ is desired. What is the gain of the low-ripple preamplifier needed to reduce the output ripple to $\pm 100 \mathrm{mV}$ ? To $\pm 10 \mathrm{mV}$ ? To $\pm 1 \mathrm{mV}$ ? For each case, specify the value required for the feedback factor $\beta$.

D 11.23 A feedback amplifier is to be designed using a feedback loop connected around a two-stage amplifier. The first stage is a direct-coupled, small-signal amplifier with a high upper 3-dB frequency. The second stage is a power-output stage with a midband gain of $10 \mathrm{~V} / \mathrm{V}$ and upper and lower 3-dB frequencies of 8 kHz and 80 Hz , respectively. The feedback amplifier should have a midband gain of $100 \mathrm{~V} / \mathrm{V}$ and an upper $3-\mathrm{dB}$ frequency of 40 kHz . What is the required gain of the small-signal amplifier? What value of $\beta$ should be used? What does the lower 3-dB frequency of the overall amplifier become?
*11.24 The complementary BJT follower shown in Fig. P11.24(a) has the approximate transfer characteristic shown in Fig. P11.24(b). Observe that for $-0.7 \mathrm{~V} \leq v_{I} \leq$ +0.7 V , the output is zero. This "dead band" leads to crossover distortion (see Section 12.3). Consider this follower to be driven by the output of a differential amplifier of gain 100

(a)

Figure P11.24

(b)

Figure P11.24 continued
whose positive-input terminal is connected to the input signal source $v_{S}$ and whose negative-input terminal is connected to the emitters of the follower. Sketch the transfer characteristic $v_{O}$ versus $v_{S}$ of the resulting feedback amplifier. What are the limits of the dead band, and what are the gains outside the dead band?

D 11.25 A particular amplifier has a nonlinear transfer characteristic that can be approximated as follows:
(a) For small input signals, $\left|v_{I}\right| \leq 10 \mathrm{mV}, v_{O} / v_{I}=10^{5}$.
(b) For intermediate input signals, $10 \mathrm{mV} \leq\left|v_{I}\right| \leq 60 \mathrm{mV}$, $\Delta v_{O} / \Delta v_{I}=10^{5}$.
(c) For large input signals, $\left|v_{I}\right| \geq 60 \mathrm{mV}$, the output saturates.

If the amplifier is connected in a negative-feedback loop, find the feedback factor $\beta$ that reduces the factor-of-10 change in gain (occurring at $\left|v_{I}\right|=10 \mathrm{mV}$ ) to only a $10 \%$ change. What is the transfer characteristic $v_{O}$ versus $v_{S}$ of the amplifier with feedback?

## Section 11.3: The Feedback Voltage Amplifier

D 11.26 For the feedback voltage amplifier of Fig. 11.8(a), let the op amp have an infinite input resistance, a zero output resistance, and a finite open-loop gain of $1000 \mathrm{~V} / \mathrm{V}$. If $R_{1}=10 \mathrm{k} \Omega$, what value should $R_{2}$ have to obtain an ideal closed-loop gain of 10? Now, calculate the loop gain $A \beta$ and use it to find the actual value of the closed-loop gain $A_{f}$. If $A_{f}$ is to be exactly 10 , what must the value of $R_{2}$ be?

D 11.27 Consider the series-shunt feedback amplifier in Fig. 11.11(a), which is analyzed in Example 11.3.
(a) If $R_{1}=10 \mathrm{k} \Omega$, find the value of $R_{2}$ that results in an ideal closed-loop gain of 10 .


Figure P11.29
(b) Use the expression for $A \beta$ derived in Example 11.3 to find the value of the loop gain for the case $\mu=1000$, $R_{a l}=100 \mathrm{k} \Omega, r_{o}=1 \mathrm{k} \Omega, R_{s}=100 \mathrm{k} \Omega$, and $R_{L}=10 \mathrm{k} \Omega$. Hence determine the value of the closed-loop gain $A_{f}$.
(c) By what factor must $\mu$ be increased to ensure that $A_{f}$ is within $1 \%$ of the ideal value of 10 ?

D 11.28 Consider the series-shunt feedback amplifier of Fig. 11.8(b) that is analyzed in Example 11.2.
(a) If $R_{1}=1 \mathrm{k} \Omega$, what value should $R_{2}$ have to obtain a closed-loop gain whose ideal value is $5 \mathrm{~V} / \mathrm{V}$ ?
(b) If $g_{m 1}=g_{m 2}=4 \mathrm{~mA} / \mathrm{V}, R_{D 1}=R_{D 2}=10 \mathrm{k} \Omega$, and the MOSFET's $r_{o}$ is very large, use the expression for $A \beta$ derived in Example 11.2 to find the value of $A \beta$ and hence determine the closed-loop gain $A_{f}$.
*11.29 In the series-shunt feedback amplifier shown in Fig. P11.29, the devices operate with $V_{B E}=0.7 \mathrm{~V}$ and have $\beta_{1}=\beta_{2}=100$. The input signal $V_{s}$ has a zero dc component. Resistances $R_{s}=100 \Omega, R_{1}=1 \mathrm{k} \Omega, R_{2}=10 \mathrm{k} \Omega$, and $R_{L}=1 \mathrm{k} \Omega$.
(a) If the loop gain is large, what do you expect the closed-loop gain to be? Give both an expression and its value.
(b) Find the dc emitter current in each of $Q_{1}$ and $Q_{2}$. Also, find the dc voltage at the emitter of $Q_{2}$.
(c) Calculate the value of the loop gain $A \beta$. (Hint: Set $V_{s}=0$ and break the loop at the base of $Q_{1}$. Simplify the circuit by eliminating dc sources.)
(d) Calculate the value of $A_{f}$.

D 11.30 Consider the series-shunt feedback amplifier of Fig. 11.8(c), which was the subject of Exercise 11.6. Assume that the voltage divider $\left(R_{1}, R_{2}\right)$ is implemented with a 1-M $\Omega$ potentiometer. Assume that the MOSFET is biased so that $g_{m}=4 \mathrm{~mA} / \mathrm{V}$ and $r_{o}$ is large. Also, $R_{D}=10 \mathrm{k} \Omega$. Find the value of $R_{1}$ that results in a closed-loop gain of $5 \mathrm{~V} / \mathrm{V}$.

D 11.31 Figure P11.31 shows a series-shunt feedback amplifier known as a "feedback triple." All three MOSFETs are biased to operate at $g_{m}=4 \mathrm{~mA} / \mathrm{V}$. You may neglect their $r_{o}$ 's.
(a) Select a value for $R_{F}$ that results in a closed-loop gain that is ideally $10 \mathrm{~V} / \mathrm{V}$.


Figure P11.31
(b) Determine the loop gain $A \beta$ and hence the value of $A_{f}$. By what percentage does $A_{f}$ differ from the ideal value you designed for? How can you adjust the circuit to make $A_{f}$ equal to 10 ?
11.32 Figure P11.32 shows a series-shunt feedback amplifier without details of the bias circuit.


Figure P11.32
(a) If $R_{E}$ is selected to be $50 \Omega$, find the value for $R_{F}$ that results in a closed-loop gain with an ideal value of $25 \mathrm{~V} / \mathrm{V}$.
(b) If $Q_{1}$ is biased at $1 \mathrm{~mA}, Q_{2}$ at 2 mA , and $Q_{3}$ at 5 mA , and assuming that the transistors have $h_{l o}=100$ and large $r_{o}$, and that $R_{C 1}=2 \mathrm{k} \Omega$ and $R_{C 2}=1 \mathrm{k} \Omega$, find the value of the loop gain $A \beta$ and hence of the closed-loop gain $A_{f}$.

D 11.33 The current-mirror-loaded differential amplifier in Fig. P11.33 has a feedback network consisting of the voltage divider $\left(R_{1}, R_{3}\right)$, with $R_{1}+R_{2}=1 \mathrm{M} \Omega$. The devices are sized to operate at $\left|V_{O V}\right|=0.2 \mathrm{~V}$. For all devices, $\left|V_{A}\right|=10 \mathrm{~V}$. The input signal source has a zero dc component.
(a) Find the loop gain $A \beta$ and hence the value of $A$.
(b) Find the values of $R_{1}$ and $R_{2}$ that result in a closed-loop gain of exactly $5 \mathrm{~V} / \mathrm{V}$.

## Section 11.4: Systematic Analysis of Feedback Voltage Amplifiers (Series-Shunt)

11.34 A series-shunt feedback amplifier employs a basic amplifier with input and output resistances each of $2 \mathrm{k} \Omega$ and gain $A=1000 \mathrm{~V} / \mathrm{V}$. The feedback factor $\beta=0.1 \mathrm{~V} / \mathrm{V}$. Find


Figure P11.33

[^0]
[^0]:    SIN = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problemthe gain $A_{f}$, the input resistance $R_{i f}$, and the output resistance $R_{o f}$ of the closed-loop amplifier.
11.35 For a particular amplifier connected in a feedback loop in which the output voltage is sampled, measurement of the output resistance before and after the loop is connected shows a change by a factor of 200 . Is the resistance with feedback higher or lower? What is the value of the loop gain $A \beta$ ? If $R_{o f}$ is $100 \Omega$, what is $R_{o}$ without feedback?
11.36 The formulas for $R_{i f}$ and $R_{o f}$ in Eqs. (11.20) and (11.23), respectively, also apply for the case in which $A$ is a function of frequency. In this case, the resulting impedances $Z_{i f}$ and $Z_{o f}$ will be functions of frequency. Consider the case of a series-shunt amplifier that has an input resistance $R_{i}$, an output resistance $R_{o}$, and open-loop gain $A=A_{0} /\left(1+\left(s / \omega_{B}\right)\right)$, and a feedback factor $\beta$ that is independent of frequency. Find $Z_{i f}$ and $Z_{o f}$ and give an equivalent circuit for each, together with the values of all the elements in the equivalent circuits.
11.37 A feedback amplifier utilizing voltage sampling and employing a basic voltage amplifier with a gain of $1000 \mathrm{~V} / \mathrm{V}$ and an input resistance of $1000 \Omega$ has a closed-loop input resistance of $10 \mathrm{k} \Omega$. What is the closed-loop gain? If the basic amplifier is used to implement a unity-gain voltage buffer, what input resistance do you expect?
11.38 Consider the noninverting op-amp circuit of Example 11.4 for the case $R_{1}=\infty$ and $R_{2}=0$.
(a) What is the value of $\beta$, and what is the ideal value of the closed-loop gain?
(b) Adapt the expressions found in Example 11.4 to obtain expressions for $A$ and $A \beta$ for this case.
(c) For $\mu=10^{4}, R_{o l}=100 \mathrm{k} \Omega, R_{s}=10 \mathrm{k} \Omega, r_{o}=1 \mathrm{k} \Omega$, and $R_{L}=2 \mathrm{k} \Omega$, find $A, A \beta, A_{f}, R_{\mathrm{m}}$, and $R_{\text {out }}$.
*11.39 This problem deals with the series-shunt feedback amplifier of Fig. P11.29 and overlaps somewhat with Problem 11.29. Thus, if you have already solved 11.29, you can use some of the results in the solution of this problem. The devices operate with $V_{B E}=0.7 \mathrm{~V}$ and have $\beta_{1}=\beta_{2}=100$. The input signal $V_{s}$ has a zero dc component. Resistances $R_{s}=100 \Omega$, $R_{1}=1 \mathrm{k} \Omega, R_{2}=10 \mathrm{k} \Omega$, and $R_{L}=1 \mathrm{k} \Omega$.
(a) If the loop gain is large, what do you expect the closed-loop gain $V_{s} / V_{s}$ to be? Give both an expression and its approximate value.
(b) Find the dc emitter current in each of $Q_{1}$ and $Q_{2}$. Also find the dc voltage at the emitter of $Q_{2}$.
(c) Sketch the $A$ circuit without the dc sources. Derive expressions for $A, R_{i}$, and $R_{o}$, and find their values.
(d) Give an expression for $\beta$ and find its value.
(e) Find the closed-loop gain $V_{o} / V_{s}$, the input resistance $R_{\mathrm{m}}$, and the output resistance $R_{\text {out }}$. By what percentage does the value of $A_{f}$ differ from the approximate value found in (a)?
\$104 D *11.40 Figure P11.40 shows a series-shunt amplifier with a feedback factor $\beta=1$. The amplifier is designed so that $v_{O}=0$ for $v_{S}=0$, with small deviations in $v_{O}$ from 0 V dc being minimized by the negative-feedback action. The technology utilized has $k_{n}^{\prime}=2 k_{p}^{\prime}=120 \mu \mathrm{~A} / \mathrm{V}^{2},\left|V_{i}\right|=0.7 \mathrm{~V}$, and $\left|V_{A}^{\prime}\right|=24 \mathrm{~V} / \mu \mathrm{m}$.
(a) Show that the feedback is negative.
(b) With the feedback loop opened at the gate of $Q_{2}$, and the gate terminals of $Q_{1}$ and $Q_{2}$ grounded, find the dc current and the overdrive voltage at which each of $Q_{1}$ to $Q_{5}$ is operating. Ignore the Early effect. Also find the dc voltage at the output.
(c) Find $g_{m}$ and $r_{o}$ of each of the five transistors.
(d) Find expressions and values of $A$ and $R_{o}$. Assume that the bias current sources are ideal.
(e) Find the gain with feedback, $A_{f}$, and the output resistance $R_{\text {out }}$.
(f) How would you modify the circuit to realize a closed-loop voltage gain of $5 \mathrm{~V} / \mathrm{V}$ ? What is the value of output resistance obtained?
*11.41 Figure P11.41 shows a series-shunt amplifier in which the three MOSFETs are sized to operate at $\left|V_{O V}\right|=$ 0.2 V . Let $\left|V_{s}\right|=0.5 \mathrm{~V}$ and $\left|V_{A}\right|=10 \mathrm{~V}$. The current sources utilize single transistors and thus have output resistances equal to $r_{o}$.
(a) Show that the feedback is negative.
(b) Assuming the loop gain to be large, what do you expect the closed-loop voltage gain $V_{o} / V_{s}$ to be approximately?
(c) If $V_{s}$ has a zero dc component, find the dc voltages at nodes $\mathrm{S}_{1}, \mathrm{G}_{2}, \mathrm{~S}_{3}$, and $\mathrm{G}_{3}$. Verify that each of the current sources has the minimum required dc voltage across it for proper operation.
(d) Find the $A$ circuit. Calculate the gain of each of the three stages and the overall voltage gain, $A$.

[^0]
[^0]:    114 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem


Figure P11.40


Figure P11.41
[Hint: A CS amplifier with a resistance $R_{s}$ in the source lead has an effective transconductance $g_{m} /\left(1+g_{m} R_{s}\right)$ and an output resistance $r_{o}\left(1+g_{m} R_{s}\right)$.]
(e) Find $\beta$.
(f) Find $A_{l}=V_{o} / V_{s}$. By what percentage does this value differ from the approximate value obtained in (b)?
(g) Find the output resistance $R_{\text {out }}$.


Figure P11.43

D*11.42 This problem deals with the series-shunt feedback amplifier of Fig. P11.33. Certain aspects of this amplifier were considered in Problem 11.33. If you have already solved problem 11.33, you will have the opportunity to compare results. The current-mirror-loaded differential amplifier has a feedback network consisting of the voltage divider $\left(R_{1}, R_{2}\right)$, with $R_{1}+R_{2}=1 \mathrm{M} \Omega$. The devices are sized to operate at $\left|V_{O V}\right|=0.2 \mathrm{~V}$. For all devices, $\left|V_{A}\right|=10 \mathrm{~V}$. The input signal source has a zero dc component.
(a) Show that the feedback is negative.
(b) What do you expect the dc voltage at the gate of $Q_{2}$ to be? At the output? (Neglect the Early effect.)
(c) Find the $A$ circuit. Derive an expression for $A$ and find its value.
(d) Select values for $R_{1}$ and $R_{2}$ to obtain a closed-loop voltage gain $V_{o} / V_{r}=5 \mathrm{~V} / \mathrm{V}$.
(e) Find the value of $R_{\text {out }}$.
(f) Utilizing the open-circuit, closed-loop gain ( $5 \mathrm{~V} / \mathrm{V}$ ) and the value of $R_{\text {out }}$ found in (e), find the value of gain obtained when a resistance $R_{L}=10 \mathrm{k} \Omega$ is connected to the output.
(g) As an alternative approach to (f) above, redo the analysis of the $A$ circuit including $R_{L}$. Then utilize the values of
$R_{1}$ and $R_{2}$ found in (d) to determine $\beta$ and $A_{f}$. Compare the value of $A_{f}$ to that found in (f).

D**11.43 The CMOS op amp in Fig. P11.43(a) is fabricated in a $1-\mu \mathrm{m}$ technology for which $V_{t o}=-V_{t p}=0.75 \mathrm{~V}, \mu_{a} C_{o s}=$ $2 \mu_{g} C_{o s}=100 \mu \mathrm{~A} / \mathrm{V}^{2}$, and $V_{A}^{\prime}=10 \mathrm{~V} / \mu \mathrm{m}$. All transistors in the circuit have $L=1 \mu \mathrm{~m}$.
(a) It is required to perform a dc bias design of the circuit. For this purpose, let the two input terminals be at zero volts dc and neglect channel-length modulation (i.e., let $V_{A}=\infty$ ). Design to obtain $I_{D 1}=I_{D 2}=50 \mu \mathrm{~A}, I_{D 5}=250$ $\mu \mathrm{A}$, and $V_{O}=0$, and operate all transistors except for the source follower $Q_{5}$ at $V_{O V}=0.25 \mathrm{~V}$. Assume that $Q_{1}$ and $Q_{2}$ are perfectly matched, and similarly for $Q_{3}$ and $Q_{4}$. For each transistor, find $I_{D}$ and $W / L$.
(b) What is the allowable range of input common-mode voltage?
(c) Find $g_{m}$ for each of $Q_{1}, Q_{2}$, and $Q_{5}$.
(d) For each transistor, calculate $r_{o}$.
(e) The $100-\mathrm{k} \Omega$ potentiometer shown in Fig. 11.43(b) is connected between the output terminal (Out) and the inverting input terminal (-In) to provide negative

[^0]
[^0]:    $510=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem


Figure P11.45
feedback whose amount is controlled by the setting of the wiper. A voltage signal $V_{s}$ is applied between the noninverting input $(+\mathrm{In})$ and ground. A load resistance $R_{L}=100 \mathrm{k} \Omega$ is connected between the output terminal and ground. The potentiometer is adjusted to obtain a closed-loop gain $A_{f} \equiv V_{o} / V_{s} \simeq 10 \mathrm{~V} / \mathrm{V}$.

Specify the required setting of the potentiometer by giving the values of $R_{1}$ and $R_{2}$. Toward this end, find the $A$ circuit (supply a circuit diagram), the value of $A$, the $\beta$ circuit (supply a circuit diagram), and the value of $\beta$.
(f) What is the output resistance of the feedback amplifier, excluding $R_{L}$ ?

D *11.44 Figure P11.32 shows a series-shunt feedback amplifier without details of the bias circuit.
(a) Eliminating the dc sources, sketch the $A$ circuit and the circuit for determining $\beta$.
(b) Show that if $A \beta$ is large then the closed-loop voltage gain is given approximately by

$$
A_{f} \equiv \frac{V_{o}}{V_{s}} \simeq \frac{R_{E}+R_{E}}{R_{E}}
$$

(c) If $R_{E}$ is selected equal to $50 \Omega$, find $R_{E}$ that will result in a closed-loop gain of approximately $25 \mathrm{~V} / \mathrm{V}$.
(d) If $Q_{1}$ is biased at $1 \mathrm{~mA}, Q_{2}$ at 2 mA , and $Q_{3}$ at 5 mA , and assuming that the transistors have $h_{f e}=100$, find approximate values for $R_{C 1}$ and $R_{C 2}$ to obtain gains from the stages of the $A$ circuit as follows: a voltage gain of $Q_{1}$ of about -10 and a voltage gain of $Q_{2}$ of about -50 .
(e) For your design, what is the closed-loop voltage gain realized?
(f) Calculate the input and output resistances of the closed-loop amplifier designed.

D *11.45 Figure P11.45 shows a three-stage feedback amplifier:
$A_{1}$ has an $82-\mathrm{k} \Omega$ differential input resistance, a $20-\mathrm{V} / \mathrm{V}$ open-circuit differential voltage gain, and a $3.2-\mathrm{k} \Omega$ output resistance.
$A_{2}$ has a $5-\mathrm{k} \Omega$ input resistance, a $20-\mathrm{mA} / \mathrm{V}$ short-circuit transconductance, and a $20-\mathrm{k} \Omega$ output resistance.
$A_{3}$ has a $20-\mathrm{k} \Omega$ input resistance, unity open-circuit voltage gain, and a $1-\mathrm{k} \Omega$ output resistance.
The feedback amplifier feeds a $1-\mathrm{k} \Omega$ load resistance and is fed by a signal source with a $9-\mathrm{k} \Omega$ resistance.
(a) Show that the feedback is negative.
(b) If $R_{1}=20 \mathrm{k} \Omega$, find the value of $R_{2}$ that results in a closed-loop gain $V_{o} / V_{s}$ that is ideally $5 \mathrm{~V} / \mathrm{V}$.
(c) Supply the small-signal equivalent circuit.
(d) Sketch the $A$ circuit and determine $A$.
(e) Find $\beta$ and the amount of feedback.
(f) Find the closed-loop gain $A_{f} \equiv V_{o} / V_{s}$.
(g) Find the feedback amplifier's input resistance $R_{\mathrm{in}}$.
(h) Find the feedback amplifier's output resistance $R_{\text {out }}$.
(i) If the high-frequency response of the open-loop gain $A$ is dominated by a pole at 100 Hz , what is the upper $3-\mathrm{dB}$ frequency of the closed-loop gain?
(j) If for some reason $A_{1}$ drops to half its nominal value, what is the percentage change in $A_{f}$ ?
## Section 11.5: Other Feedback-Amplifier Types

D 11.46 Refer to the circuit in Fig. 11.17(a), which is analyzed in Example 11.6. Select a value for $R_{F}$ that results in a closed-loop transconductance $A_{f} \equiv I_{o} / V_{s} \simeq 10 \mathrm{~mA} / \mathrm{V}$. Use the formulas derived in Example 11.6 to find the actual value of $A_{f}$ realized. Let $\mu=1000, R_{s d}=100 \mathrm{k} \Omega, g_{m}=2 \mathrm{~mA} / \mathrm{V}$, and $r_{o 2}=20 \mathrm{k} \Omega$.

D 11.47 Figure P11.47 shows a feedback current amplifier. The feedback network consists of the highlighted two-port network comprising $R_{M}$ and $R_{F}$. It is fed with the output current $I_{o}$ and delivers a feedback current $I_{f}$ at its port 1 to the input node. The feedback factor $\beta$ is the current ratio $I_{f} / I_{o}$ measured with port 1 short-circuited (because it is connected in shunt with the amplifier input).
(a) Find an expression for $\beta$ and hence for the ideal value of $A_{f} \equiv I_{o} / I_{s}$.
(b) Setting $I_{s}=0$, break the loop at the gate of $Q_{2}$ and thus determine the loop gain $A \beta$. Show that

$$
A=-\frac{g_{m 2} R_{D}}{1+1 /\left[g_{m 1}\left(R_{M}+R_{F}\right)\right]}
$$

(c) For $g_{m 1}=g_{m 2}=4 \mathrm{~mA} / \mathrm{V}, R_{D}=10 \mathrm{k} \Omega$, and $\left(R_{M}+R_{F}\right)=$ $1 \mathrm{k} \Omega$, find the value of $R_{M}$ that results in a closed-loop current gain of $5 \mathrm{~A} / \mathrm{A}$.


Figure P11.47
D 11.48 Figure P11.48(a) shows a feedback transresistance amplifier formed by an op amp and a feedback resistance $R_{F}$.

Assume that the op amp is modeled by an input resistance $R_{i d}$, an open-circuit voltage gain $\mu$, and an output resistance $r_{o}$.


Figure P11.48
(a) Show that the feedback factor $\beta$, determined as shown in Fig. P11.48(b), is given by $\beta=-1 / R_{F}$. Hence find the ideal value of the closed-loop gain $A_{f} \equiv V_{o} / I_{s}$. Find $R_{F}$ that results in $A_{f}$ of approximately $1 \mathrm{k} \Omega$.
(b) By setting $I_{s}=0$ and breaking the loop at the input terminals of the op amp, show that the loop gain is given by

$$
A \beta=\mu \frac{R_{i d}}{R_{i d}+R_{F}+r_{o}}
$$

(c) For $\mu=1000, R_{i d}=100 \mathrm{k} \Omega, r_{o}=1 \mathrm{k} \Omega$, and $R_{F}$ having the value found in (a), what is the actual value of $A_{f}$ realized?

## Feedback Transconductance Amplifiers (Series-Series)

11.49 A series-series feedback amplifier employs a transconductance amplifier having a short-circuit transconductance $G_{m}$ of $0.6 \mathrm{~A} / \mathrm{V}$, input resistance of $10 \mathrm{k} \Omega$, and output resistance of $100 \mathrm{k} \Omega$. The feedback network has $\beta=200 \Omega$,
an input resistance (with port 1 open-circuited) of $200 \Omega$, and an input resistance (with port 2 open-circuited) of $10 \mathrm{k} \Omega$. The amplifier operates with a signal source having a resistance of $10 \mathrm{k} \Omega$ and with a load resistance of $10 \mathrm{k} \Omega$. Find $A_{f}, R_{\mathrm{in}}$, and $R_{\text {out }}$.
11.50 Reconsider the circuit in Fig. 11.21(a), analyzed in Example 11.8, this time with the output voltage taken at the emitter of $Q_{3}$. In this case the feedback can be considered to be of the series-shunt type. Note that $R_{E 2}$ should now be considered part of the basic amplifier and not of the feedback network.
(a) Determine $\beta$.
(b) Find an approximate value for $A_{f} \equiv V_{o 3} / V_{s}$ assuming that the loop gain remains large (a safe assumption, since the loop in fact does not change).
[Note: If you continue with the feedback analysis, you'll find that $A \beta$ in fact changes somewhat; this is a result of the different approximations made in the feedback analysis approach.]
(c) If the loop gain remains at the value calculated in Example 11.8 (i.e., 246.3), find the output resistance $R_{\text {out }}$ (measured between the emitter of $Q_{3}$ and ground). (Neglect the effect of $r_{03}$.)
$\mathbf{D}^{*}$ 11.51 Figure P11.31 (page 851) shows a feedback triple utilizing MOSFETs. All three MOSFETs are biased and sized to operate at $g_{m}=4 \mathrm{~mA} / \mathrm{V}$. You may neglect their $r_{o}$ 's (except for the calculation of $R_{\text {out1 }}$ as indicated below).
(a) Considering the feedback amplifier as a transconductance amplifier with output current $I_{o}$, find the value of $R_{F}$ that results in a closed-loop transconductance of approximately $100 \mathrm{~mA} / \mathrm{V}$.
(b) Sketch the $A$ circuit and find the value of $A \equiv I_{o} / V_{s}$.
(c) Find $1+A \beta$ and $A_{f} \equiv I_{o} / V_{s}$. Compare to the value of $A_{f}$ you designed for. What is the percentage difference? What resistance can you change to make $A_{f}$ exactly $100 \mathrm{~mA} / \mathrm{V}$, and in which direction (increase or decrease)?
(d) Assuming that $r_{o 3}=20 \mathrm{k} \Omega$, find $R_{o}$ of the $A$ circuit. For this purpose, recall that the resistance looking into the drain of a MOSFET having a resistance $R_{s}$ in its source is $\left(r_{o}+R_{s}+g_{m} r_{o} R_{s}\right)$. Hence find the output resistance $R_{\text {out1 }}$. Since the current sampled by the feedback network is exactly equal to the output current, you can use the feedback formula.
(e) If the voltage $V_{o}$ is taken as the output, in which case the amplifier becomes series-shunt feedback, what is
the value of the closed-loop voltage gain $V_{o} / V_{s}$ ? Assume that $R_{F}$ has the original value you selected in (a). Note that in this case $R_{E 2}$ should be considered part of the amplifier and not the feedback network. The feedback analysis will reveal that $A \beta$ changes somewhat, which may be puzzling given that the feedback loop did not change. The change is due to the different approximation used.
(f) What is the closed-loop output resistance $R_{\text {out } 2}$ of the voltage amplifier in (e) above?
11.52 Consider the circuit in Fig. P11.52 as a transconductance amplifier with input $V_{s}$ and output $I_{o}$. The transistor is specified in terms of its $g_{m}$ and $r_{o}$.
(a) Sketch the small-signal equivalent circuit using the hybrid- $\pi$ model of the MOSFET and convince yourself that the feedback circuit is comprised of resistor $R_{F}$.
(b) Find the $A$ circuit and the $\beta$ circuit.
(c) Derive expressions for $A, \beta,(1+A \beta), A_{f}, R_{o}$, and $R_{o f}$.


Figure P11.52

D 11.53 The transconductance amplifier in Fig. P11.53 utilizes a differential amplifier with gain $\mu$ and a very high input resistance. The differential amplifier drives a transistor $Q$ characterized by its $g_{m}$ and $r_{o}$. A resistor $R_{F}$ senses the output current $I_{o}$.
(a) For $A \beta \gg 1$, find an approximate expression for the closed-loop transconductance $A_{f} \equiv I_{o} / V_{s}$. Hence, select a value for $R_{F}$ that results in $A_{f} \simeq 5 \mathrm{~mA} / \mathrm{V}$.
(b) Find the $A$ circuit and derive an expression for $A$. Evaluate $A$ for the case $\mu=1000 \mathrm{~V} / \mathrm{V}, g_{m}=2 \mathrm{~mA} / \mathrm{V}$, $r_{o}=20 \mathrm{k} \Omega$, and the value of $R_{F}$ you selected in (a).
(c) Give an expression for $A \beta$ and evaluate its value and that of $1+A \beta$.
(d) Find the closed-loop gain $A_{f}$ and compare to the value you designed for in (a) above.
(e) Find expressions and values for $R_{o}$ and $R_{o f} \cdot$ [Hint: The resistance looking into the drain of a MOSFET with a resistance $R_{s}$ in its source is $\left.\left(r_{o}+R_{s}+g_{m} r_{o} R_{s}\right) .\right]$


Figure P11.53
*11.54 It is required to show that the output resistance of the BJT circuit in Fig. P11.54 is given by

$$
R_{o}=r_{o}+\left[R_{s} \|\left(r_{\pi}+R_{b}\right)\right]\left(1+g_{m} r_{o} \frac{r_{\pi}}{r_{\pi}+R_{b}}\right)
$$



Figure P11.54
To derive this expression, set $V_{s}=0$, replace the BJT with its small-signal, hybrid- $\pi$ model, apply a test voltage $V_{s}$ to the collector, and find the current $I_{s}$ drawn from $V_{s}$ and hence $R_{o}$ as $V_{s} / I_{s}$. Note that the bias arrangement is not shown. For the case of $R_{b}=0$, find the maximum possible value for $R_{o}$. Note that this theoretical maximum is obtained when $R_{s}$ is so large that the signal current in the emitter is nearly zero. In this case, with $V_{s}$ applied and $V_{s}=0$, what is the current in
the base, in the $g_{m} V_{\pi}$ generator, and in $r_{o}$, all in terms of $I_{s}$ ? Show these currents on a sketch of the equivalent circuit with $R_{s}$ set to $\infty$.
11.55 As we found out in Example 11.8, whenever the feedback network senses the emitter current of the BJT, the feedback output resistance formula cannot predict the output resistance looking into the collector. To understand this issue more clearly, consider the feedback transconductance amplifier shown in Fig. P11.55(a). To determine the output resistance, we set $V_{s}=0$ and apply a test voltage $V_{s}$ to the collector, as shown in Fig. P11.55(b). Now, let $\mu$ be increased to the point where the feedback signal across $R_{F}$ almost equals the input to the positive terminal of the differential amplifier,


Figure P11.55

[^0]
[^0]:    $\overline{\text { SIN }}=$ Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
now zero. Thus the signal current through $R_{F}$ will be almost zero. By replacing the BJT with its hybrid- $\pi$ model, show that

$$
R_{\text {out }}=r_{a}+\left(h_{f e}+1\right) r_{o} \simeq h_{f e} r_{o}
$$

where $h_{f e}$ is the transistor $\beta$. Thus for large amounts of feedback, $R_{\text {out }}$ is limited to a maximum of $h_{f e} r_{o}$ independent of the amount of feedback. This phenomenon does not occur in the MOSFET version of this circuit, where the output resistance can be theoretically made infinite.
11.56 For the feedback transconductance amplifier of Fig. P11.56 derive expressions for $A, \beta, A \beta, A_{f}, R_{o}$, and $R_{o f}$. Evaluate $A_{f}$ and $R_{o f}$ for the case of $g_{m 1}=g_{m 2}=4 \mathrm{~mA} / \mathrm{V}$, $R_{D}=20 \mathrm{k} \Omega, r_{o 2}=20 \mathrm{k} \Omega, R_{F}=100 \Omega$, and $R_{L}=1 \mathrm{k} \Omega$. For simplicity, neglect $r_{o 1}$ and take $r_{o 2}$ into account only when calculating output resistances.


Figure P11.56

D 11.57 For the feedback transconductance amplifier in Fig. P11.57, derive an approximate expression for the closed-loop transconductance $A_{f} \equiv I_{o} / V_{s}$ for the case of $A \beta \gg$ 1. Hence select a value for $R_{2}$ to obtain $A_{f}=100 \mathrm{~mA} / \mathrm{V}$. If $Q$ is biased to obtain $g_{m}=1 \mathrm{~mA} / \mathrm{V}$, specify the value of the gain $\mu$ of the differential amplifier to obtain an amount of feedback of 60 dB . If $Q$ has $r_{o}=50 \mathrm{k} \Omega$, find the output resistance $R_{\text {out }}$. [Hint: Recall that for a MOSFET with a resistance $R_{s}$ in its source, the resistance looking into the drain is $\left(r_{o}+R_{s}+g_{m} r_{o} R_{s}\right)$.]


Figure P11.57

SIM 11.58 All the MOS transistors in the feedback transconductance amplifier (series-series) of Fig. P11.58 are sized to operate at $\left|V_{O V}\right|=0.2 \mathrm{~V}$. For all transistors, $\left|V_{s}\right|=$ 0.4 V and $\left|V_{A}\right|=20 \mathrm{~V}$.
(a) If $V_{s}$ has a zero dc component, find the dc voltage at the output, at the drain of $Q_{1}$, and at the drain of $Q_{2}$.
(b) Find an approximate expression and value for $A_{f} \equiv$ $I_{o} / V_{s}$ for the case $A \beta \gg 1$.
(c) Use feedback analysis to obtain a more precise value for $A_{f}$.
(d) Find the value of $R_{\text {out }}$.
(e) If the voltage at the source of $Q_{5}$ is taken as the output, find the voltage gain using the value of $I_{o} / V_{s}$ obtained in (c). Also find the output resistance of this series-shunt voltage amplifier.
11.59 By setting $V_{s}=0$ and breaking the feedback loop, show that the loop gain of the amplifier circuit in Fig. P11.58 is

$$
A \beta=g_{m 1,2}\left(r_{o 2} \| r_{o 4}\right) \frac{R_{F} \| r_{o 5}}{\left(R_{F} \| r_{o 5}\right)+1 / g_{m 5}}
$$

where $g_{m 1,2}$ is the $g_{m}$ of each of $Q_{1}$ and $Q_{2}$.

## Feedback Transresistance Amplifiers (Shunt-Shunt)

11.60 For the transresistance amplifier analyzed in Example 11.9 , use the formulas derived there to evaluate $A_{f}, R_{m}$, and $R_{\text {out }}$ when $\mu$ is one-tenth the value used in the example. That is, evaluate for $\mu=10^{3} \mathrm{~V} / \mathrm{V}, R_{o f}=\infty, r_{o}=100 \Omega, R_{F}=10 \mathrm{k} \Omega$, and $R_{s}=R_{L}=1 \mathrm{k} \Omega$. Compare to the corresponding values obtained in Example 11.9.


Figure P11.58
11.61 Use the formulas derived in Example 11.9 to solve the problem in Exercise 11.19. Show that the results are identical to those given in the answer to Exercise 11.19.
11.62 By setting $I_{x}=0$, replacing the MOSFET with its hybrid- $\pi$ model, and breaking the feedback loop, determine the loop gain of the feedback amplifier in Fig. E11.19. Hence find the open-loop gain. Evaluate $A \beta, \beta, A$, and $A_{f}$ for the numerical values given in Exercise 11.8. Why do the results differ somewhat from those given in the answer to Exercise 11.19?
11.63 The CE BJT amplifier in Fig. P11.63 employs shunt-shunt feedback: Feedback resistor $R_{F}$ senses the output voltage $V_{o}$ and provides a feedback current to the base node.
(a) If $V_{s}$ has a zero dc component, find the dc collector current of the BJT. Assume the transistor $\beta=100$.
(b) Find the small-signal equivalent circuit of the amplifier with the signal source represented by its Norton equivalent (as we usually do when the feedback connection at the input is shunt).
(c) Find the $A$ circuit and determine the value of $A, R_{i}$, and $R_{o}$.
(d) Find $\beta$ and hence $A \beta$ and $1+A \beta$.
(e) Find $A_{f}, R_{i f}$, and $R_{o f}$ and hence $R_{\text {in }}$ and $R_{\text {out }}$.
(f) What voltage gain $V_{s} / V_{s}$ is realized? How does this value compare to the ideal value obtained if the loop gain is very large and thus the signal voltage at the base becomes almost zero (like what happens in an inverting op-amp circuit). Note that this single-transistor poor-man's op amp is not that bad!


Figure P11.63

[^0]
[^0]:    115 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem
D 11.64 The circuit in Fig. P11.64 utilizes a voltage amplifier with gain $\mu$ in a shunt-shunt feedback topology with the feedback network composed of resistor $R_{F}$. In order to be able to use the feedback equations, you should first convert the signal source to its Norton representation. You will then see that all the formulas derived in Example 11.9 apply here as well.
(a) If the loop gain is very large, what approximate closed-loop voltage gain $V_{o} / V_{s}$ is realized? If $R_{s}=2 \mathrm{k} \Omega$, give the value of $R_{F}$ that will result in $V_{o} / V_{s} \simeq-10 \mathrm{~V} / \mathrm{V}$.
(b) If the amplifier $\mu$ has a dc gain of $10^{3} \mathrm{~V} / \mathrm{V}$, an input resistance $R_{\text {id }}=100 \mathrm{k} \Omega$, and an output resistance $r_{o}=$ $2 \mathrm{k} \Omega$, find the actual $V_{o} / V_{s}$ realized. Also find $R_{\text {in }}$ and $R_{\text {out }}$ (indicated on the circuit diagram). You may use formulas derived in Example 11.9.
(c) If the amplifier $\mu$ has an upper 3-dB frequency of 1 kHz and a uniform $-20-\mathrm{dB} /$ decade gain rolloff, what is the $3-\mathrm{dB}$ frequency of the gain $\left|V_{o} / V_{s}\right|$ ?


Figure P11.64
11.65 The feedback transresistance amplifier in Fig. P11.65 utilizes two identical MOSFETs biased by ideal current sources $I=0.4 \mathrm{~mA}$. The MOSFETs are sized to operate at $V_{D V}=0.2 \mathrm{~V}$ and have $V_{i}=0.5 \mathrm{~V}$ and $V_{A}=16 \mathrm{~V}$. The feedback resistance $R_{F}=10 \mathrm{k} \Omega$.
(a) If $I_{s}$ has a zero dc component, find the dc voltage at the input, at the drain of $Q_{1}$, and at the output.
(b) Find $g_{m}$ and $r_{o}$ of $Q_{1}$ and $Q_{2}$.
(c) Provide the $A$ circuit and derive an expression for $A$ in terms of $g_{m 1}, r_{o 1}, g_{m 2}, r_{o 2}$, and $R_{F}$.
(d) What is $\beta$ ? Give an expression for the loop gain $A \beta$ and the amount of feedback $(1+A \beta)$.
(e) Derive an expression for $A_{f}$.
(f) Derive expressions for $R_{i}, R_{\text {in }}, R_{o}$, and $R_{\text {out }}$.
(g) Evaluate $A, \beta, A \beta, A_{f}, R_{i}, R_{o}, R_{\text {in }}$, and $R_{\text {out }}$ for the component values given.


Figure P11.65
11.66 By setting $I_{s}=0$ and breaking the feedback loop, find the loop gain of the feedback amplifier in Fig. P11.65. If you have already solved Problem 11.65, compare results. Which result do you think is more accurate, and why? For the numerical values given in Problem 11.65, by how much (in percent) do the two values of loop gain differ?
11.67 Analyze the circuit in Fig. E11.19 from first principles (i.e., do not use the feedback approach) and hence show that

$$
A_{f} \equiv \frac{V_{o}}{I_{s}}=-\frac{\left(R_{i} \| R_{F}\right)\left(g_{m}-\frac{1}{R_{F}}\right)\left(r_{o} \| R_{F}\right)}{1+\left(R_{s} \| R_{F}\right)\left(g_{m}-\frac{1}{R_{F}}\right)\left(r_{o} \| R_{F}\right) / R_{F}}
$$Comparing this expression to the one given in Exercise 11.19, part (b), you will note that the only difference is that $g_{m}$ has been replaced by $\left(g_{m}-1 / R_{F}\right)$. Note that $-1 / R_{F}$ represents the forward transmission in the feedback network, which the feedback-analysis method neglects. What is the condition then for the feedback-analysis method to be reasonably accurate for this circuit?

D 11.68 For the feedback amplifier in Fig. P11.68, select a value for $R_{F}$ that results in a closed-loop gain $A_{f} \equiv$ $V_{o} / I_{s} \simeq-10 \mathrm{k} \Omega$. Then, analyze the circuit to determine the actual value of $A_{f}$ realized. As well, determine $R_{\text {in }}$ and $R_{\text {out }}$. Transistors $Q_{1}$ and $Q_{2}$ are operated so that $g_{m 1}=$ $g_{m 2}=4 \mathrm{~mA} / \mathrm{V}$ and $r_{o 1}$ and $r_{o 2}$ can be neglected. Also, $R_{D 1}=R_{D 2}=10 \mathrm{k} \Omega$.


Figure P11.68
11.69 For the feedback transresistance amplifier in Fig. P11.69, let $V_{C C}=-V_{E E}=5 \mathrm{~V}, R_{C}=R_{E}=R_{F}=10 \mathrm{k} \Omega$. The transistors have $V_{B E}=0.7 \mathrm{~V}$ and $\beta=100$.
(a) If $I_{s}$ has a zero dc component, show that $Q_{1}$ and $Q_{2}$ are operating at dc collector currents of approximately 0.35 mA and 0.58 mA , respectively. What is the dc voltage at the output?


Figure P11.69
(b) Find the $A$ circuit and the value of $A, R_{i}$, and $R_{o}$. Neglect $r_{o 1}$ and $r_{o 2}$.
(c) Find the value of $\beta$, the loop gain, and the amount of feedback.
(d) Find $A_{f} \equiv V_{o} / I_{s}$, the input resistance $R_{\text {in }}$, and the output resistance $R_{\text {out }}$.

D **11.70 (a) Show that for the circuit in Fig. P11.70(a), if the loop gain is large, the voltage gain $V_{o} / V_{s}$ is given approximately by

$$
\frac{V_{o}}{V_{s}} \simeq-\frac{R_{f}}{R_{s}}
$$

(b) Using three cascaded stages of the type shown in Fig. P11.70(b) to implement the amplifier $\mu$, design a feedback amplifier with a voltage gain of approximately $-100 \mathrm{~V} / \mathrm{V}$. The amplifier is to operate between a source resistance $R_{s}=10 \mathrm{k} \Omega$ and a load resistance $R_{\mathrm{L}}=1 \mathrm{k} \Omega$. Calculate the actual value of $V_{o} / V_{s}$ realized, the input resistance (excluding $R_{i}$ ), and the output resistance (excluding $R_{L}$ ). Assume that the BJTs have $h_{f e}$ of 100. [Note: In practice, the three amplifier stages are not made identical, for stability reasons.]


Figure P11.70

D 11.71 Negative feedback is to be used to modify the characteristics of a particular amplifier for various purposes. Identify the feedback topology to be used if:
(a) input resistance is to be lowered and output resistance raised.
(b) both input and output resistances are to be raised.
(c) both input and output resistances are to be lowered.
11.72 The feedback amplifier of Fig. P11.72 consists of a common-gate amplifier formed by $Q_{1}$ and $R_{D}$, and a feedback circuit formed by the capacitive divider $\left(C_{1}, C_{2}\right)$ and the common-source transistor $Q_{f}$. Note that the bias circuit for $Q_{f}$
is not shown. It is required to derive expressions for $A_{f} \equiv V_{o} / I_{s}$, $R_{i n}$, and $R_{\text {out }}$. Assume that $C_{1}$ and $C_{2}$ are sufficiently small that their loading effect on the basic amplifier can be neglected. Also neglect $r_{o}$. Find the values of $A_{f}, R_{i n}$, and $R_{\text {out }}$ for the case in which $g_{m 1}=5 \mathrm{~mA} / \mathrm{V}, R_{D}=10 \mathrm{k} \Omega, C_{1}=0.9 \mathrm{pF}, C_{2}=0.1$ pF , and $g_{m f}=2 \mathrm{~mA} / \mathrm{V}$.


Figure P11.72

D *11.73 Figure P11.73 shows a shunt-shunt feedback amplifier. The MOSFETs have $V_{m}=0.6 \mathrm{~V}, V_{A}=20 \mathrm{~V}$, and $\mu_{n} C_{o s}=200 \mu \mathrm{~A} / \mathrm{V}^{2}$. The power supply $V_{D D}=3.3 \mathrm{~V}$, and $R_{L}=2 \mathrm{k} \Omega$. The coupling capacitor $C_{C}$ can be assumed to be very large.
(a) Perform a dc design to meet the following specifications: $I_{D 1}=100 \mu \mathrm{~A}, I_{D 2}=1 \mathrm{~mA}, I_{R 2, R 1}=10 \mu \mathrm{~A}, V_{D V 1}=$ $V_{D V 2}=0.2 \mathrm{~V}$. Neglect the Early effect. Specify the values required for $I_{1}, R_{1}, R_{2},(W / L)_{1}$, and $(W / L)_{2}$.
(b) Find an expression for $\beta$ and hence an expression for the ideal value of $V_{o} / V_{s}$.
(c) Find the value of $R_{s}$ that results in $V_{o} / V_{s}$ being ideally $-6 \mathrm{~V} / \mathrm{V}$.


Figure P11.73
(d) Find the $A$ circuit and use it to determine the values of $A$, $R_{i}$, and $R_{o}$.
(e) Find the value obtained for $V_{o} / V_{s}$.
(f) Find $R_{\text {in }}$ and $R_{\text {out }}$.

## Feedback Current Amplifiers (Shunt-Series)

11.74 For the feedback current amplifier in Fig. P11.47:
(a) Provide the $A$ circuit and derive expressions for $R_{i}$ and $A$. Neglect $r_{o}$ of both transistors.
(b) Provide the $\beta$ circuit and an expression for $\beta$.
(c) Find an expression for $A \beta$.
(d) For $g_{m 1}=g_{m 2}=5 \mathrm{~mA} / \mathrm{V}, R_{D}=20 \mathrm{k} \Omega, R_{M}=10 \mathrm{k} \Omega$, and $R_{F}=90 \mathrm{k} \Omega$, find the values of $A, \beta, A \beta, A_{f}, R_{i}$, and $R_{i f}$.
(e) If $r_{o 2}=20 \mathrm{k} \Omega$ and $R_{L}=1 \mathrm{k} \Omega$, find the output resistance as seen by $R_{L}$.

D 11.75 Design the feedback current amplifier of Fig. 11.27(a) to meet the following specifications:
(i) $A_{f} \equiv I_{o} / I_{s}=-100 \mathrm{~A} / \mathrm{A}$
(ii) amount of feedback $\simeq 40 \mathrm{~dB}$
(iii) $R_{\text {in }} \simeq 1 \mathrm{k} \Omega$

Specify the values of $R_{1}, R_{2}$, and $\mu$. Assume that the amplifier $\mu$ has infinite input resistance and that $R_{s}=\infty$. For the

MOSFET, $g_{m}=5 \mathrm{~mA} / \mathrm{V}$ and $r_{o}=20 \mathrm{k} \Omega$. What $R_{\text {out }}$ is obtained?
11.76 Consider the feedback current amplifier in Fig. 11.27(a) (which was analyzed in Example 11.10). Let $R_{s}=R_{u f}=\infty$. By setting $I_{s}=0$ and breaking the feedback loop at the gate of $Q$, find an expression for the loop gain $A \beta$. Evaluate $A \beta$ for the component values given in Example 11.10 and hence determine $A$ and $A_{f}$. Why do the results differ somewhat from those found in Example 11.10?
11.77 The feedback current amplifier in Fig. P11.77 utilizes two identical NMOS transistors sized so that at $I_{D}=0.2 \mathrm{~mA}$ they operate at $V_{O V}=0.2 \mathrm{~V}$. Both devices have $V_{i}=0.5 \mathrm{~V}$ and $V_{A}=10 \mathrm{~V}$.
(a) If $I_{s}$ has zero dc component, show that both $Q_{1}$ and $Q_{2}$ are operating at $I_{D}=0.2 \mathrm{~mA}$. What is the dc voltage at the input?
(b) Find $g_{m}$ and $r_{o}$ for each of $Q_{1}$ and $Q_{2}$.
(c) Find the $A$ circuit and the value of $R_{i}, A$, and $R_{o}$.
(d) Find the value of $\beta$.
(e) Find $A \beta$ and $A_{f}$.
(f) Find $R_{\text {in }}$ and $R_{\text {out }}$.


Figure P11.77
*11.78 The feedback current amplifier in Fig. P11.78(a) can be thought of as a "super" CG transistor. Note that rather than connecting the gate of $Q_{2}$ to signal ground, an amplifier is placed between source and gate.
(a) If $\mu$ is very large, what is the signal voltage at the input terminal? What is the input resistance? What is the current gain $I_{o} / I_{i}$ ?
(b) For finite $\mu$ but assuming that the input resistance of the amplifier $\mu$ is very large, find the $A$ circuit and derive expressions for $A, R_{i}$, and $R_{n}$.
(c) What is the value of $\beta$ ?
(d) Find $A \beta$ and $A_{i}$. If $\mu$ is large, what is the value of $A_{i}$ ?
(e) Find $R_{\text {in }}$ and $R_{\text {out }}$ assuming the loop gain is large.
(f) The "super" CG transistor can be utilized in the cascode configuration shown in Fig. P11.78(b), where $V_{G}$ is a dc bias voltage. Replacing $Q_{1}$ by its small-signal model, use the analogy of the resulting circuit to that in Fig. P11.78(a) to find $I_{o}$ and $R_{\text {out }}$.
*11.79 Figure P11.79 shows an interesting and very useful application of feedback to improve the performance of the current mirror formed by $Q_{1}$ and $Q_{2}$. Rather than connecting the drain of $Q_{1}$ to the gate, as is the case in simple current mirrors, an amplifier of gain $+\mu$ is connected between the drain and the gate. Note that the feedback loop does not include transistor $Q_{2}$. The feedback loop ensures that the value of the gate-to-source voltage of $Q_{1}$ is such that $I_{o 1}$ equals $I_{r}$. This regulated $V_{\mathrm{gs}}$ is also applied to $Q_{2}$. Thus, if $W / L$ of $Q_{2}$


Figure P11.78


Figure P11.79
is $n$ times $W / L$ of $Q_{1}, I_{o 2}=n I_{o 1}=n I_{i}$. This current tracking, however, is not regulated by the feedback loop.
(a) Show that the feedback is negative.
(b) If $\mu$ is very large and the input resistance of the amplifier $\mu$ is infinite, what dc voltage appears at the drain of $Q_{1}$ ? If $Q_{1}$ is to operate at an overdrive voltage of 0.2 V , what is the minimum value that $V_{\text {BIAX }}$ must have?
(c) Replacing $Q_{1}$ by its small-signal model, find an expression for the small-signal input resistance $R_{\text {in }}$ assuming finite gain but infinite input resistance for the amplifier $\mu$. Note that here it is much easier to do the analysis directly than to use the feedback-analysis approach. For large $\mu$, what does $R_{\text {in }}$ become?
(d) What is the output resistance $R_{\text {out }}$ ?
*11.80 The circuit in Fig. P11.80 is an implementation of a particular circuit building block known as second-generation current convoyer (CCII). It has three terminals besides ground: $x, y$, and $z$. The heart of the circuit is the feedback amplifier consisting of the differential amplifier $\mu$ and the complementary source follower $\left(Q_{N}, Q_{P}\right)$. (Note that this feedback circuit is one we have encountered a number of times in this chapter, albeit with only one source-follower transistor.) In the following, assume that the differential amplifier has a very large gain $\mu$ and infinite differential input resistance. Also, let the two current mirrors have unity current-transfer ratios.


Figure P11.80
(a) If a resistance $R$ is connected between $y$ and ground, a voltage signal $V_{s}$ is connected between $x$ and ground, and $z$ is short-circuited to ground. Find the current $I_{z}$ through the short circuit. Show how this current is developed and its path for $V_{s}$ positive and for $V_{s}$ negative.
(b) If $x$ is connected to ground, a current source $I_{x}$ is connected to input terminal $y$, and $z$ is connected to ground, what voltage appears at $y$ and what is the input resistance seen by $I_{y}$ ? What is the current $I_{y}$ that flows through the output short circuit? Also, explain the current flow through the circuit for $I_{z}$ positive and for $I_{z}$ negative.
(c) What is the output resistance at $z$ ?

310 *11.81 For the amplifier circuit in Fig. P11.81, assuming that $V_{s}$ has a zero dc component, find the dc voltages at all nodes and the dc emitter currents of $Q_{1}$ and $Q_{2}$. Let the BJTs have $\beta=100$. Use feedback analysis to find $V_{o} / V_{s}$ and $R_{\text {in }}$. Let $V_{B E}=0.7 \mathrm{~V}$.


Figure P11.81
**11.82 Figure P11.82 shows a feedback amplifier utilizing the shunt-series topology. All transistors have $\beta=100$ and $V_{B E}=0.7 \mathrm{~V}$. Neglect $r_{o}$ except in (f).
(a) Perform a dc analysis to find the dc emitter currents in $Q_{1}$ and $Q_{2}$ and hence determine their small-signal parameters.

310 = Multisim/PSpice; * = difficult problem; ** = more difficult; *** = very challenging; D = design problem


Figure P11.82
(b) Replacing the BJTs with their hybrid- $\pi$ models, give the equivalent circuit of the feedback amplifier.
(c) Give the $A$ circuit and determine $A, R_{s}$, and $R_{o}$. Note that $R_{o}$ is the resistance determined by breaking the emitter loop of $Q_{2}$ and measuring the resistance between the terminals thus created.
(d) Find the $\beta$ circuit and determine the value of $\beta$.
(e) Find $A \beta, 1+A \beta, A_{f}, R_{s f}$, and $R_{o f}$. Note that $R_{o f}$ represents the resistance that in effect appears in the emitter of $Q_{2}$ as a result of the feedback.
(f) Determine $R_{i n}, I_{\text {out }} / I_{\text {in }}$, and $R_{\text {out }}$. To determine $R_{\text {out }}$, use $V_{A 2}=75 \mathrm{~V}$ and recall that the maximum possible output resistance looking into the collector of a BJT is approximately $\beta r_{o}$, where $\beta$ is the BJT's $\beta$ (see Problem 11.55).

## Section 11.7: The Stability Problem

11.83 An op amp designed to have a low-frequency gain of $10^{5}$ and a high-frequency response dominated by a single pole at $100 \mathrm{rad} / \mathrm{s}$ acquires, through a manufacturing error, a pair of additional poles at $20,000 \mathrm{rad} / \mathrm{s}$. At what frequency does the total phase shift reach $180^{\circ}$ ? At this frequency, for what value of $\beta$, assumed to be frequency independent, does the loop gain reach a value of unity? What is the corresponding value of closed-loop gain at low frequencies?
*11.84 For the situation described in Problem 11.83, sketch Nyquist plots for $\beta=1.0$ and $10^{-3}$. (Plot for $\omega=0 \mathrm{rad} / \mathrm{s}, 100$ $\mathrm{rad} / \mathrm{s}, 10^{5} \mathrm{rad} / \mathrm{s}, 10^{4} \mathrm{rad} / \mathrm{s}, 2 \times 10^{4} \mathrm{rad} / \mathrm{s}$, and $\infty \mathrm{rad} / \mathrm{s}$.)
11.85 An op amp having a low-frequency gain of $10^{4}$ and a single-pole rolloff at $10^{3} \mathrm{rad} / \mathrm{s}$ is connected in a negative-feedback loop via a feedback network having a transmission $k$ and a two-pole rolloff at $10^{3} \mathrm{rad} / \mathrm{s}$. Find the value of $k$ above which the closed-loop amplifier becomes unstable.
11.86 Consider a feedback amplifier for which the open-loop gain $A(s)$ is given by

$$
A(s)=\frac{10,000}{\left(1+s / 10^{4}\right)\left(1+s / 10^{4}\right)^{2}}
$$

If the feedback factor $\beta$ is independent of frequency, find the frequency at which the phase shift is $180^{\circ}$, and find the critical value of $\beta$ at which oscillation will commence.

## Section 11.8: Effect of Feedback on the Amplifier Poles

11.87 A dc amplifier having a single-pole response with pole frequency 10 Hz and unity-gain frequency of 1 MHz is operated in a loop whose frequency-independent feedback factor is 0.1 . Find the low-frequency gain, the $3-\mathrm{dB}$ frequency, and the unity-gain frequency of the closed-loop amplifier. By what factor does the pole shift?
11.88 An amplifier has dc open-loop gain of 80 dB and a single pole with $100-\mathrm{Hz}$ frequency. It is utilized to design a feedback amplifier with a 3-dB frequency of 10 kHz . What $\beta$ is needed? What is the dc closed-loop gain realized? Give an expression for $A_{f}(s)$.
*11.89 An amplifier having a low-frequency gain of $10^{4}$ and poles at $10^{4} \mathrm{~Hz}$ and $10^{5} \mathrm{~Hz}$ is operated in a closed negative-feedback loop with a frequency-independent $\beta$.
(a) For what value of $\beta$ do the closed-loop poles become coincident? At what frequency?
(b) What is the low-frequency, closed-loop gain corresponding to the situation in (a)? What is the value of the closed-loop gain at the frequency of the coincident poles?
(c) What is the value of $Q$ corresponding to the situation in (a)?
(d) If $\beta$ is increased by a factor of 10 , what are the new pole locations? What is the corresponding pole $Q$ ?

D 11.90 A dc amplifier has an open-loop gain of 1000 and two poles, a dominant one at 1 kHz and a high-frequency one whose location can be controlled. It is required to connect this amplifier in a negative-feedback loop that provides a dc closed-loop gain of 10 and a maximally flat response. Find the required value of $\beta$ and the frequency at which the second pole should be placed. What is the 3-dB frequency of the closed-loop amplifier?
11.91 Reconsider Example 11.11 with the circuit in Fig. 11.34, modified to incorporate a so-called tapered network, in which the components immediately adjacent to the amplifier input are raised in impedance to $C / 10$ and $10 R$. Find expressions for the resulting pole frequency $\omega_{0}$ and $Q$ factor. For what value of $K$ do the poles coincide? For what value of $K$ does the response become maximally flat? For what value of $K$ does the circuit oscillate?

D 11.92 A feedback amplifier having a dc closed-loop gain of 10 and a maximally flat second-order response with a 3-dB frequency of 1 kHz is required. The open-loop amplifier utilizes a cascade of two identical amplifier stages, each having a single-pole frequency response. Find the values required for $\beta$, the 3-dB frequency, and the dc gain of each of the two amplifier stages. Give an expression for $A_{f}(s)$.
11.93 Three identical inverting amplifier stages, each characterized by a low-frequency gain $K$ and a single-pole response with $f_{\text {sim }}=100 \mathrm{kHz}$, are connected in a feedback loop with $\beta=1$. What is the minimum value of $K$ at which the circuit oscillates? What would the frequency of oscillation be?

## Section 11.9: Stability Study Using Bode Plots

11.94 Reconsider Exercise 11.26 for the case of the op amp wired as a unity-gain buffer. At what frequency is $|A \beta|=1$ ? What is the corresponding phase margin?
11.95 Reconsider Exercise 11.26 for the case of a manufacturing error introducing a second pole at $10^{5} \mathrm{~Hz}$. What is now the frequency for which $|A \beta|=1$ ? What is the corresponding phase margin? For what values of $\beta$ is the phase margin $45^{\circ}$ or more?
11.96 For what phase margin does the gain peaking have a value of $5 \%$ ? Of $10 \%$ ? Of 0.1 dB ? Of 1 dB ? Of 3 dB ? [Hint: Use the result in Eq. (11.82).]
11.97 An amplifier has a dc gain of $10^{4}$ and poles at $10^{5} \mathrm{~Hz}$, $3.16 \times 10^{5} \mathrm{~Hz}$, and $10^{6} \mathrm{~Hz}$. Find the value of $\beta$, and the corresponding closed-loop gain, for which a phase margin of $45^{\circ}$ is obtained.
11.98 A two-pole amplifier for which $A_{0}=10^{3}$ and having poles at 1 MHz and 10 MHz is to be connected as a differentiator. On the basis of the rate-of-closure rule, what is the smallest differentiator time constant for which operation is stable? What are the corresponding gain and phase margins?
11.99 For the amplifier described by Fig. 11.37 and with frequency-independent feedback, what is the minimum closed-loop voltage gain that can be obtained for phase margins of $90^{\circ}$ and $45^{\circ}$ ?

## Section 11.10: Frequency Compensation

D 11.100 A multipole amplifier having a first pole at 1 MHz and a dc open-loop gain of 80 dB is to be compensated for closed-loop gains as low as unity by the introduction of a new dominant pole. At what frequency must the new pole be placed?

D 11.101 For the amplifier described in Problem 11.100, rather than introducing a new dominant pole we can use additional capacitance at the circuit node at which the pole is formed to reduce the frequency of the first pole. If the frequency of the second pole is 20 MHz and if it remains unchanged while additional capacitance is introduced as
mentioned, find the frequency to which the first pole must be lowered so that the resulting amplifier is stable for closed-loop gains as low as unity. By what factor is the capacitance at the controlling node increased?
11.102 For the amplifier whose $A(s)$ is depicted in Fig. 11.38, to what value must the first pole frequency be lowered to obtain stable performance for (a) $\beta=0.001$ and (b) $\beta=0.1$ ?
11.103 Contemplate the effects of pole splitting by considering Eqs. (11.89), (11.93), and (11.94) under the conditions that $R_{1} \simeq R_{2}=R, C_{2} \simeq C_{1} / 10=C, C_{l} \gg C$, and $g_{m}=100 / R$, by calculating $\omega_{P 1}, \omega_{P 2}$, and $\omega_{P 1}^{\prime}, \omega_{P 2}^{\prime}$. Comment on the results.
D 11.104 An op amp with open-loop voltage gain of $10^{5}$ and poles at $10^{6} \mathrm{~Hz}, 10^{7} \mathrm{~Hz}$, and $10^{8} \mathrm{~Hz}$ is to be compensated by the addition of a fourth dominant pole to operate stably with unity feedback $(\beta=1)$. What is the frequency of the required dominant pole? The compensation network is to consist of an $R C$ low-pass network placed in the negative-feedback path of the op amp. The dc bias conditions are such that a $1-\mathrm{M} \Omega$ resistor can be tolerated in series with each of the negative and positive input terminals. What capacitor is required between the negative input and ground to implement the required fourth pole?

D *11.105 An op amp with an open-loop voltage gain of 80 dB and poles at $10^{5} \mathrm{~Hz}, 10^{6} \mathrm{~Hz}$, and $2 \times 10^{6} \mathrm{~Hz}$ is to be compensated to be stable for unity $\beta$. Assume that the op amp incorporates an amplifier equivalent to that in Fig. 11.40,
with $C_{1}=150 \mathrm{pF}, C_{2}=5 \mathrm{pF}$, and $g_{m}=40 \mathrm{~mA} / \mathrm{V}$, and that $f_{P 1}$ is caused by the input circuit and $f_{P 2}$ by the output circuit of this amplifier. Find the required value of the compensating Miller capacitance and the new frequency of the output pole.

SUB **11.106 The op amp in the circuit of Fig. P11.106 has an open-loop gain of $10^{5}$ and a single-pole rolloff with $\omega_{3 \mathrm{~dB}}=10 \mathrm{rad} / \mathrm{s}$.
(a) Sketch a Bode plot for the loop gain.
(b) Find the frequency at which $|A \beta|=1$, and find the corresponding phase margin.
(c) Find the closed-loop transfer function, including its zero and poles. Sketch a pole-zero plot. Sketch the magnitude of the transfer function versus frequency, and label the important parameters on your sketch.


Figure P11.106
# CHAPTER 12 

## Output Stages and Power Amplifiers

Introduction 921
12.1 Classification of Output Stages 922
12.2 Class A Output Stage 923
12.3 Class B Output Stage 929
12.4 Class AB Output Stage 935
12.5 Biasing the Class AB Circuit 940
12.6 Variations on the Class AB Configuration 945
12.7 CMOS Class AB Output Stages 950
12.8 IC Power Amplifiers 961
12.9 Class D Power Amplifiers 967
12.10 Power Transistors 971

Summary 982
Problems 983
# IN THIS CHAPTER YOU WILL LEARN 

1. The classification of amplifier output stages on the basis of the fraction of the cycle of an input sine wave during which the transistor conducts.
2. Analysis and design of a variety of output-stage types ranging from the simple but power-inefficient emitter follower (class A) to the popular push-pull class AB circuit in both bipolar and CMOS technologies, and the power-efficient class D amplifier.
3. Useful and interesting circuit techniques employed in the design of power amplifiers.
4. The special structures and characteristics of bipolar and MOS power transistors.
5. Thermal considerations in the design and fabrication of high-output-power circuits.

## Introduction

An important function of the output stage is to provide the amplifier with a low output resistance so that it can deliver the output signal to the load without loss of gain. Since the output stage is the final stage of the amplifier, it usually deals with relatively large signals. Thus the small-signal approximations and models either are not applicable or must be used with care. Nevertheless, linearity remains a very important requirement. In fact, a measure of goodness of the output stage is the amount of total harmonic distortion (THD) it introduces. This is the rms value of the harmonic components of the output signal, excluding the fundamental, expressed as a percentage of the rms value of the fundamental. A high-fidelity audio power amplifier features a THD in the order of a fraction of a percent.

The most challenging requirement in the design of an output stage is for it to deliver the required amount of power to the load in an efficient manner. This implies that the power dissipated in the output-stage transistors must be as low as possible. This requirement stems mainly from the fact that the power dissipated in a transistor raises its internal junction temperature (the temperature of the silicon die), and there is a maximum temperature (in the range of $150^{\circ} \mathrm{C}$ to $200^{\circ} \mathrm{C}$ for silicon devices) above which the transistor is destroyed. A high power-conversion efficiency is also required to prolong the battery life of portable electronics, to permit a smaller, lower-cost power supply, or to obviate the need for cooling fans.

We begin this chapter with a study of the various output-stage configurations employed in amplifiers that handle both low and high power. In this context, "high power" generally means greater than 1 W . Examples include the transmitter of a cell phone, which is typically required to deliver 1 W of power to its antenna, and a stereo system that delivers hundreds of watts of audio power to its speakers.A power amplifier is simply an amplifier with a high-power output stage. Examples of discrete- and integrated-circuit power amplifiers will be presented. Of particular interest is the class D amplifier; it combines analog and digital techniques to achieve very high power-conversion efficiencies.

The chapter concludes with a study of power BJTs and MOSFETs. These are the devices employed in the various circuits studied in this chapter.

# 12.1 Classification of Output Stages 

Output stages are classified according to the collector-current waveform that results when an input signal is applied. Figure 12.1 illustrates the classification for the case of a sinusoidal input signal. The class A stage, whose associated waveform is shown in Fig. 12.1(a), is biased at a current $I_{C}$ that is greater than the amplitude of the signal current, $\hat{I}_{c}$. Thus the transistor in a class A stage conducts for the entire cycle of the input signal; that is, the conduction angle is $360^{\circ}$. In contrast, the class B stage, whose associated waveform is shown in Fig. 12.1(b),


Figure 12.1 Collector-current waveforms for transistors operating in (a) class A, (b) class B, (c) class AB, and (d) class C amplifier stages.
is biased at zero dc current. Thus a transistor in a class B stage conducts for only half the cycle of the input sine wave, resulting in a conduction angle of $180^{\circ}$. As will be seen later, the negative halves of the sinusoid will be supplied by another transistor that also operates in the class B mode and conducts during the alternate half-cycles.

An intermediate class between A and B , appropriately named class AB , involves biasing the transistor at a nonzero dc current much smaller than the peak current of the sine-wave signal. As a result, the transistor conducts for an interval slightly greater than half a cycle, as illustrated in Fig. 12.1(c). The resulting conduction angle is greater than $180^{\circ}$ but much less than $360^{\circ}$. The class AB stage has another transistor that conducts for an interval slightly greater than that of the negative half-cycle, and the currents from the two transistors are combined in the load. It follows that, during the intervals near the zero crossings of the input sinusoid, both transistors conduct.

Figure 12.1(d) shows the collector-current waveform for a transistor operated as a class C amplifier. Observe that the transistor conducts for an interval shorter than that of a half-cycle; that is, the conduction angle is less than $180^{\circ}$. The result is the periodically pulsating current waveform shown. To obtain a sinusoidal output voltage, this current is passed through a parallel $L C$ circuit, tuned to the frequency of the input sinusoid. The tuned circuit acts as a bandpass filter (Chapter 17) and provides an output voltage proportional to the amplitude of the fundamental component in the Fourier-series representation of the current waveform.

Class $\mathrm{A}, \mathrm{AB}$, and B amplifiers are studied in this chapter. They are employed as output stages of op amps and audio power amplifiers. In the latter application, class AB is the preferred choice, for reasons that will be explained in the sections to follow. A variation on the class AB , called the class $\mathrm{G} / \mathrm{H}$ amplifier, utilizes two pairs of power supplies (e.g., the regular $\pm 30-\mathrm{V}$ supply and a higher-voltage supply of $\pm 70 \mathrm{~V}$ ). The higher-voltage supply is called upon only occasionally-for instance, to provide a short burst of high output power for a drum roll. Since the high-voltage supply operates infrequently, it can be of a low-cost design. Also, this is a more power-efficient arrangement than would be obtained if a class AB circuit were used and operated continuously from the higher-voltage supply.

Class C amplifiers are usually employed for radio-frequency (RF) power amplification (required, e.g., in mobile phones and radio and TV transmitters). The design of class C amplifiers is a rather specialized topic and is not included in this book. However, we should point out that the tuned-resonator oscillator circuits described in Chapter 18 operate inherently in the class C mode.

Another important type of output stage is the class D switching amplifier. It utilizes the power transistors as on-off switches and thus achieves much higher power efficiency than that obtained in the other amplifier classes. The class D amplifier will be studied briefly in Section 12.9. Although the BJT in Fig. 12.1 has been used to illustrate the definition of the various output-stage classes, the same classification applies to output stages implemented with MOSFETs. Furthermore, the classification above extends to amplifier stages other than those used at the output. In this regard, all the common-emitter, common-base, and common-collector amplifiers (and their FET counterparts) studied in earlier chapters fall into the class A category.

# 12.2 Class A Output Stage 

Because of its low output resistance, the emitter follower is the most popular class A output stage. We have already studied the emitter follower in Chapter 7; in the following we consider its large-signal operation.
# 12.2.1 Transfer Characteristic 

Figure 12.2 shows an emitter follower $Q_{1}$ biased with a constant current $I$ supplied by transistor $Q_{2}$. Since the emitter current $i_{E 1}=I+i_{L}$, the bias current $I$ must be greater than the largest negative load current; otherwise, $Q_{1}$ cuts off and class A operation will no longer be maintained.

The transfer characteristic of the emitter follower of Fig. 12.2 is described by

$$
v_{O}=v_{I}-v_{B E 1}
$$

where $v_{B E 1}$ depends on the emitter current $i_{E 1}$ and thus on the load current $i_{L}$. If we neglect the relatively small changes in $v_{B E 1}$ ( 60 mV for every factor-of-10 change in emitter current), the linear transfer curve shown in Fig. 12.3 results. As indicated, the positive limit of the linear region is determined by the saturation of $Q_{1}$; thus

$$
v_{O \max }=V_{C C}-V_{C E 1 \text { sat }}
$$

In the negative direction, depending on the values of $I$ and $R_{L}$, the limit of the linear region is determined either by $Q_{1}$ turning off,

$$
v_{O \min }=-I R_{L}
$$

or by $Q_{2}$ saturating,

$$
v_{O \min }=-V_{C C}+V_{C E 2 \text { sat }}
$$

The absolutely lowest (most negative) output voltage is that given by Eq. (12.4) and is achieved provided the bias current $I$ is greater than the magnitude of the corresponding load current,

$$
I \geq \frac{\left|-V_{C C}+V_{C E 2 \text { sat }}\right|}{R_{L}}
$$



Figure 12.2 An emitter follower $\left(Q_{1}\right)$ biased with a constant current $I$ supplied by transistor $Q_{2}$.


Figure 12.3 Transfer characteristic of the emitter follower in Fig. 12.2. This linear characteristic is obtained by neglecting the change in $v_{B E 1}$ with $i_{L}$. The maximum positive output is determined by the saturation of $Q_{1}$. In the negative direction, the limit of the linear region is determined either by $Q_{1}$ turning off or by $Q_{2}$ saturating, depending on the values of $I$ and $R_{L}$.

# EXERCISES 

D12.1 For the emitter follower in Fig. 12.2, $V_{C C}=15 \mathrm{~V}, V_{C E \text { sat }}=0.2 \mathrm{~V}, V_{B E}=0.7 \mathrm{~V}$ and constant, and $\beta$ is very high. Find the value of $R$ that will establish a bias current sufficiently large to allow the largest possible output signal swing for $R_{L}=1 \mathrm{k} \Omega$. Determine the resulting output signal swing and the minimum and maximum emitter currents for $Q_{1}$.
Ans. $0.97 \mathrm{k} \Omega ;-14.8 \mathrm{~V}$ to $+14.8 \mathrm{~V} ; 0$ to 29.6 mA
12.2 For the emitter follower of Exercise 12.1, in which $I=14.8 \mathrm{~mA}$ and $R_{L}=1 \mathrm{k} \Omega$, consider the case in which $v_{O}$ is limited to the range -10 V to +10 V . Let $Q_{1}$ have $v_{B E}=0.6 \mathrm{~V}$ at $i_{C}=1 \mathrm{~mA}$, and assume $\alpha \simeq 1$. Find $v_{I}$ corresponding to $v_{O}=-10 \mathrm{~V}, 0 \mathrm{~V}$, and +10 V . At each of these points, use small-signal analysis to determine the voltage gain $v_{o} / v_{i}$. Note that the incremental voltage gain gives the slope of the $v_{O}$-versus- $v_{I}$ characteristic.
Ans. $-9.36 \mathrm{~V}, 0.67 \mathrm{~V}, 10.68 \mathrm{~V} ; 0.995 \mathrm{~V} / \mathrm{V}, 0.998 \mathrm{~V} / \mathrm{V}, 0.999 \mathrm{~V} / \mathrm{V}$

### 12.2.2 Signal Waveforms

Consider the operation of the emitter-follower circuit of Fig. 12.2 for sine-wave input. Neglecting $V_{C E \text { sat }}$, we see that if the bias current $I$ is properly selected, the output voltage can swing from $-V_{C C}$ to $+V_{C C}$ with the quiescent value being zero, as shown in Fig. 12.4(a).


Figure 12.4 Maximum signal waveforms in the class A output stage of Fig. 12.2 under the condition $I=V_{C C} / R_{L}$ or, equivalently, $R_{L}=V_{C C} / I$. Note that the transistor saturation voltages have been neglected.

Figure 12.4(b) shows the corresponding waveform of $v_{C E 1}=V_{C C}-v_{O}$. Now, assuming that the bias current $I$ is selected to allow a maximum negative load current of $V_{C C} / R_{L}$, that is,

$$
I=V_{C C} / R_{L}
$$

the collector current of $Q_{1}$ will have the waveform shown in Fig. 12.4(c). Finally, Fig. 12.4(d) shows the waveform of the instantaneous power dissipation in $Q_{1}$,

$$
p_{D 1} \equiv v_{C E 1} i_{C 1}
$$

# 12.2.3 Power Dissipation 

Figure 12.4(d) indicates that the maximum instantaneous power dissipation in $Q_{1}$ is $V_{C C} I$. This is equal to the power dissipation in $Q_{1}$ with no input signal applied, that is, the quiescent power dissipation. Thus the emitter-follower transistor dissipates the largest amount of power when $v_{O}=0$. Since this condition (no input signal) can easily prevail for prolonged periods of time, transistor $Q_{1}$ must be able to withstand a continuous power dissipation of $V_{C C} I$.

The power dissipation in $Q_{1}$ depends on the value of $R_{L}$. Consider the extreme case of an output open circuit, that is, $R_{L}=\infty$. In this case, $i_{C 1}=I$ is constant and the instantaneous power dissipation in $Q_{1}$ will depend on the instantaneous value of $v_{O}$. The maximum power dissipation will occur when $v_{O}=-V_{C C}$, for in this case $v_{C E 1}$ is a maximum of $2 V_{C C}$ and $p_{D 1}=2 V_{C C} I$. This condition, however, would not normally persist for a prolonged interval, so the design need not be that conservative. Observe that with an open-circuit load, the
average power dissipation in $Q_{1}$ is $V_{C C} I$. A far more dangerous situation occurs at the other extreme of $R_{L}$-specifically, $R_{L}=0$. In the event of an output short circuit, a positive input voltage would theoretically result in an infinite load current. In practice, a very large current may flow through $Q_{1}$, and if the short-circuit condition persists, the resulting large power dissipation in $Q_{1}$ can raise its junction temperature beyond the maximum allowed, causing permanent damage. To guard against such a situation, output stages are usually equipped with short-circuit protection, as will be explained later.

The power dissipation in $Q_{2}$ also must be taken into account in designing an emitter-follower output stage. Since $Q_{2}$ conducts a constant current $I$, and the maximum value of $v_{C E 2}$ is $2 V_{C C}$, the maximum instantaneous power dissipation in $Q_{2}$ is $2 V_{C C} I$. This maximum, however, occurs when $v_{O}=V_{C C}$, a condition that would not normally prevail for a prolonged period of time. A more significant quantity for design purposes is the average power dissipation in $Q_{2}$, which is $V_{C C} I$.

# Example 12.1 

Consider the emitter follower in Fig. 12.2 with $V_{C C}=10 \mathrm{~V}, I=100 \mathrm{~mA}$, and $R_{L}=100 \Omega$.
(a) Find the power dissipated in $Q_{1}$ and $Q_{2}$ under quiescent conditions $\left(v_{O}=0\right)$.
(b) For a sinusoidal output voltage of maximum possible amplitude (neglecting $V_{C E \text { sat }}$ ), find the average power dissipation in $Q_{1}$ and $Q_{2}$. Also find the load power.

## Solution

(a) Under quiescent conditions $v_{O}=0$, and each of $Q_{1}$ and $Q_{2}$ conducts a current $I=100 \mathrm{~mA}=0.1 \mathrm{~A}$ and has a voltage $V_{C E}=V_{C C}=10 \mathrm{~V}$, thus

$$
P_{D 1}=P_{D 2}=V_{C C} I=10 \times 0.1=1 \mathrm{~W}
$$

(b) For a sinusoidal output voltage of maximum possible amplitude (i.e., $10-\mathrm{V}$ peak), the instantaneous power dissipation in $Q_{1}$ will be as shown in Fig. 12.4(d). Thus the average power dissipation in $Q_{1}$ will be

$$
P_{D 1}=\frac{1}{2} V_{C C} I=\frac{1}{2} \times 10 \times 0.1=0.5 \mathrm{~W}
$$

For $Q_{2}$, the current is constant at $I=0.1 \mathrm{~A}$ and the voltage at the collector will have an average value of 0 V . Thus the average voltage across $Q_{2}$ will be $V_{C C}$ and the average dissipation will be

$$
\begin{aligned}
P_{D 2} & =\left.I \times v_{C E}\right|_{\text {average }} \\
& =I \times V_{C C}=0.1 \times 10=1 \mathrm{~W}
\end{aligned}
$$

Finally, the power delivered to the load can be found from

$$
\begin{aligned}
P_{L} & =\frac{V_{\text {omn }}^{2}}{R_{L}} \\
& =\frac{(10 / \sqrt{2})^{2}}{100}=0.5 \mathrm{~W}
\end{aligned}
$$
# 12.2.4 Power-Conversion Efficiency 

The power-conversion efficiency of an output stage is defined as

$$
\eta \equiv \frac{\text { Load power }\left(P_{L}\right)}{\text { Supply power }\left(P_{S}\right)}
$$

For the emitter follower of Fig. 12.2, assuming that the output voltage is a sinusoid with the peak value $\hat{V}_{o}$, the average load power will be

$$
P_{L}=\frac{\left(\hat{V}_{o} / \sqrt{2}\right)^{2}}{R_{L}}=\frac{1}{2} \frac{\hat{V}_{o}^{2}}{R_{L}}
$$

Since the current in $Q_{2}$ is constant $(I)$, the power drawn from the negative supply ${ }^{1}$ is $V_{C C} I$. The average current in $Q_{1}$ is equal to $I$, and thus the average power drawn from the positive supply is $V_{C C} I$. Thus the total average supply power is

$$
P_{S}=2 V_{C C} I
$$

Equations (12.8) and (12.9) can be combined to yield

$$
\begin{aligned}
\eta & =\frac{1}{4} \frac{\hat{V}_{o}^{2}}{I R_{L} V_{C C}} \\
& =\frac{1}{4}\left(\frac{\hat{V}_{o}}{I R_{L}}\right)\left(\frac{\hat{V}_{o}}{V_{C C}}\right)
\end{aligned}
$$

Since $\hat{V}_{o} \leq V_{C C}$ and $\hat{V}_{o} \leq I R_{L}$, maximum efficiency is obtained when

$$
\hat{V}_{o}=V_{C C}=I R_{L}
$$

The maximum efficiency attainable is $25 \%$. Because this is a rather low figure, the class A output stage is rarely used in high-power applications ( $>1 \mathrm{~W}$ ). Note also that in practice the output voltage swing is limited to lower values to avoid transistor saturation and associated nonlinear distortion. Thus the efficiency achieved in practice is usually in the $10 \%$ to $20 \%$ range.

## EXERCISE

12.3 For the emitter follower of Fig. 12.2, let $V_{C C}=10 \mathrm{~V}, I=100 \mathrm{~mA}$, and $R_{L}=100 \Omega$. If the output voltage is an 8 -V-peak sinusoid, find the following: (a) the power delivered to the load; (b) the average power drawn from the supplies; (c) the power-conversion efficiency. Ignore the loss in $Q_{3}$ and $R$. Ans. $0.32 \mathrm{~W} ; 2 \mathrm{~W} ; 16 \%$

[^0]
[^0]:    ${ }^{1}$ This does not include the power drawn by the biasing resistor $R$ and the diode-connected transistor $Q_{3}$.
# 12.3 Class B Output Stage 

Figure 12.5 shows a class B output stage. It consists of a complementary pair of transistors (an $n p n$ and a $p n p$ ) connected in such a way that both cannot conduct simultaneously.

### 12.3.1 Circuit Operation

When the input voltage $v_{I}$ is zero, both transistors are cut off and the output voltage $v_{O}$ is zero. As $v_{I}$ goes positive and exceeds about $0.5 \mathrm{~V}, Q_{N}$ conducts and operates as an emitter follower. In this case $v_{O}$ follows $v_{I}$ (i.e., $v_{O}=v_{I}-v_{B E N}$ ) and $Q_{N}$ supplies the load current. Meanwhile, the emitter-base junction of $Q_{P}$ will be reverse biased by the $V_{B E}$ of $Q_{N}$, which is approximately 0.7 V . Thus $Q_{P}$ will be cut off.

If the input goes negative by more than about $0.5 \mathrm{~V}, Q_{P}$ turns on and acts as an emitter follower. Again $v_{O}$ follows $v_{I}$ (i.e., $v_{O}=v_{I}+v_{E B P}$ ), but in this case $Q_{P}$ supplies the load current (in the direction opposite to that of $i_{L}$, since $v_{O}$ will be negative), and $Q_{N}$ will be cut off.

We conclude that the transistors in the class B stage of Fig. 12.5 are biased at zero current and conduct only when the input signal is present. The circuit operates in a push-pull fashion: $Q_{N}$ pushes (sources) current into the load when $v_{I}$ is positive, and $Q_{P}$ pulls (sinks) current from the load when $v_{I}$ is negative.

### 12.3.2 Transfer Characteristic

A sketch of the transfer characteristic of the class B stage is shown in Fig. 12.6. Note that there exists a range of $v_{I}$ centered around zero where both transistors are cut off and $v_{O}$ is zero. This dead band results in the crossover distortion illustrated in Fig. 12.7 for the case of an input sine wave. The effect of crossover distortion will be most pronounced when the amplitude of the input signal is small. Crossover distortion in audio power amplifiers gives rise to unpleasant sounds.


Figure 12.5 A class B output stage.


Figure 12.6 Transfer characteristic for the class B output stage in Fig. 12.5.


Figure 12.7 Illustrating how the dead band in the class B transfer characteristic results in crossover distortion.

# 12.3.3 Power-Conversion Efficiency 

To calculate the power-conversion efficiency, $\eta$, of the class B stage, we neglect the crossover distortion and consider the case of an output sinusoid of peak amplitude $\hat{V}_{o}$. The average load power will be

$$
P_{L}=\frac{1}{2} \frac{\hat{V}_{o}^{2}}{R_{L}}
$$
The current drawn from each supply will consist of half-sine waves of peak amplitude $\left(\hat{V}_{o} / R_{L}\right)$. Thus the average current drawn from each of the two power supplies will be $\hat{V}_{o} / \pi R_{L}$. It follows that the average power drawn from each of the two power supplies will be the same,

$$
P_{S+}=P_{S-}=\frac{1}{\pi} \frac{\hat{V}_{o}}{R_{L}} V_{C C}
$$

and the total supply power will be

$$
P_{S}=\frac{2}{\pi} \frac{\hat{V}_{o}}{R_{L}} V_{C C}
$$

Thus the efficiency will be given by

$$
\eta=\left(\frac{1}{2} \frac{\hat{V}_{o}^{2}}{R_{L}}\right) /\left(\frac{2}{\pi} \frac{\hat{V}_{o}}{R_{L}} V_{C C}\right)=\frac{\pi}{4} \frac{\hat{V}_{o}}{V_{C C}}
$$

It follows that the maximum efficiency is obtained when $\hat{V}_{o}$ is at its maximum. This maximum is limited by the saturation of $Q_{N}$ and $Q_{P}$ to $V_{C C}-V_{C E \text { sat }} \simeq V_{C C}$. At this value of peak output voltage, the power-conversion efficiency is

$$
\eta_{\max }=\frac{\pi}{4}=78.5 \%
$$

This value is much larger than that obtained in the class A stage (25\%). Finally, we note that the maximum average power available from a class B output stage is obtained by substituting $\hat{V}_{o}=V_{C C}$ in Eq. (12.12),

$$
P_{L \max }=\frac{1}{2} \frac{V_{C C}^{2}}{R_{L}}
$$

# 12.3.4 Power Dissipation 

Unlike the class A stage, which dissipates maximum power under quiescent conditions $\left(v_{O}=0\right)$, the quiescent power dissipation of the class B stage is zero. When an input signal is applied, the average power dissipated in the class B stage is given by

$$
P_{D}=P_{S}-P_{L}
$$

Substituting for $P_{S}$ from Eq. (12.14) and for $P_{L}$ from Eq. (12.12) results in

$$
P_{D}=\frac{2}{\pi} \frac{\hat{V}_{o}}{R_{L}} V_{C C}-\frac{1}{2} \frac{\hat{V}_{o}^{2}}{R_{L}}
$$

From symmetry we see that half of $P_{D}$ is dissipated in $Q_{N}$ and the other half in $Q_{P}$. Thus $Q_{N}$ and $Q_{P}$ must be capable of safely dissipating $\frac{1}{2} P_{D}$ watts. Since $P_{D}$ depends on $\hat{V}_{o}$, we must find the worst-case power dissipation, $P_{D \max }$. Differentiating Eq. (12.19) with respect to $\hat{V}_{o}$ and equating the derivative to zero gives the value of $\hat{V}_{o}$ that results in maximum average power dissipation as

$$
\left.\hat{V}_{o}\right|_{P_{D \max }}=\frac{2}{\pi} V_{C C}
$$

Figure 12.8 Power dissipation of the class B output stage versus amplitude of the output sinusoid.

Substituting this value in Eq. (12.19) gives

$$
P_{D \max }=\frac{2 V_{C C}^{2}}{\pi^{2} R_{L}}
$$

Thus,

$$
P_{D N \max }=P_{D P \max }=\frac{V_{C C}^{2}}{\pi^{2} R_{L}}
$$

At the point of maximum power dissipation, the efficiency can be evaluated by substituting for $\hat{V}_{o}$ from Eq. (12.20) into Eq. (12.15); hence, $\eta=50 \%$.

Figure 12.8 shows a sketch of $P_{D}$ (Eq. 12.19) versus the peak output voltage $\hat{V}_{o}$. Curves such as this are usually given on the data sheets of IC power amplifiers. [Usually, however, $P_{D}$ is plotted versus $P_{L}$, as $P_{L}=\frac{1}{2}\left(\hat{V}_{o}^{2} / R_{L}\right)$ rather than $\hat{V}_{o}$.] An interesting observation follows from Fig. 12.8: Increasing $\hat{V}_{o}$ beyond $2 V_{C C} / \pi$ decreases the power dissipated in the class B stage while increasing the load power. The price paid is an increase in nonlinear distortion as a result of approaching the saturation region of operation of $Q_{N}$ and $Q_{P}$. Transistor saturation flattens the peaks of the output sine waveform. Unfortunately, this type of distortion cannot be significantly reduced by the application of negative feedback (see Section 11.2), and thus transistor saturation should be avoided in applications requiring low THD.

# Example 12.2 

It is required to design a class B output stage to deliver an average power of 20 W to an $8-\Omega$ load. The power supply is to be selected such that $V_{C C}$ is about 5 V greater than the peak output voltage. This avoids transistor saturation and the associated nonlinear distortion, and allows for including short-circuit protection circuitry. (The latter will be discussed in Section 12.6.) Determine the supply voltage required,
the peak current drawn from each supply, the total supply power, and the power-conversion efficiency. Also determine the maximum power that each transistor must be able to dissipate safely.

# Solution 

Since

$$
P_{L}=\frac{1}{2} \frac{\hat{V}_{o}^{2}}{R_{L}}
$$

then

$$
\begin{aligned}
\hat{V}_{o} & =\sqrt{2 P_{L} R_{L}} \\
& =\sqrt{2 \times 20 \times 8}=17.9 \mathrm{~V}
\end{aligned}
$$

Therefore we select $V_{C C}=23 \mathrm{~V}$.
The peak current drawn from each supply is

$$
\hat{I}_{o}=\frac{\hat{V}_{o}}{R_{L}}=\frac{17.9}{8}=2.24 \mathrm{~A}
$$

Since each supply provides a current waveform of half-sinusoids, the average current drawn from each supply will be $\hat{I}_{o} / \pi$. Thus the average power drawn from each supply is

$$
P_{S+}=P_{S-}=\frac{1}{\pi} \times 2.24 \times 23=16.4 \mathrm{~W}
$$

for a total supply power of 32.8 W . The power-conversion efficiency is

$$
\eta=\frac{P_{L}}{P_{S}}=\frac{20}{32.8} \times 100=61 \%
$$

The maximum power dissipated in each transistor is given by Eq. (12.22); thus,

$$
\begin{aligned}
P_{D N \max } & =P_{D P \max }=\frac{V_{C C}^{2}}{\pi^{2} R_{L}} \\
& =\frac{(23)^{2}}{\pi^{2} \times 8}=6.7 \mathrm{~W}
\end{aligned}
$$

### 12.3.5 Reducing Crossover Distortion

The crossover distortion of a class B output stage can be reduced substantially by employing a high-gain op amp and overall negative feedback, as shown in Fig. 12.9. The $\pm 0.7-\mathrm{V}$ dead band is reduced to $\pm 0.7 / A_{0}$ volt, where $A_{0}$ is the dc gain of the op amp. Nevertheless, the slew-rate limitation of the op amp will cause the alternate turning on and off of the output transistors to be noticeable, especially at high frequencies. A more practical method for reducing and almost eliminating crossover distortion is found in the class AB stage, which will be studied in the next section.


Figure 12.9 Class B circuit with an op amp connected in a negative-feedback loop to reduce crossover distortion.


Figure 12.10 Class B output stage operated with a single power supply.

# 12.3.6 Single-Supply Operation 

The class B stage can be operated from a single power supply, in which case the load is capacitively coupled, as shown in Fig. 12.10. Note that to make the formulas derived in Section 12.3.4 directly applicable, the single power supply is denoted $2 V_{C C}$.

## EXERCISE

12.4 For the class B output stage of Fig. 12.5, let $V_{C C}=6 \mathrm{~V}$ and $R_{L}=4 \Omega$. If the output is a sinusoid with $4.5-\mathrm{V}$ peak amplitude, find (a) the output power; (b) the average power drawn from each supply; (c) the power efficiency obtained at this output voltage; (d) the peak currents supplied by $v_{I}$, assuming that $\beta_{N}=\beta_{P}=50$; and (e) the maximum power that each transistor must be capable of dissipating safely.
Ans. (a) 2.53 W ; (b) 2.15 W ; (c) $59 \%$; (d) 22.1 mA ; (e) 0.91 W
# 12.4 Class AB Output Stage 

Crossover distortion can be virtually eliminated by biasing the complementary output transistors at a small nonzero current. The result is the class AB output stage shown in Fig. 12.11. A bias voltage $V_{B B}$ is applied between the bases of $Q_{N}$ and $Q_{P}$. For $v_{I}=0, v_{O}=0$, and a voltage $V_{B B} / 2$ appears across the base-emitter junction of each of $Q_{N}$ and $Q_{P}$. Assuming matched devices,

$$
i_{N}=i_{P}=I_{Q}=I_{S} e^{V_{B B} / 2 V_{T}}
$$

The value of $V_{B B}$ is selected to yield the required quiescent current $I_{Q}$.

### 12.4.1 Circuit Operation

When $v_{I}$ goes positive by a certain amount, the voltage at the base of $Q_{N}$ increases by the same amount, and the output becomes positive at an almost equal value,

$$
v_{O}=v_{I}+\frac{V_{B B}}{2}-v_{B E N}
$$

The positive $v_{O}$ causes a current $i_{L}$ to flow through $R_{L}$, and thus $i_{N}$ must increase; that is,

$$
i_{N}=i_{P}+i_{L}
$$

The increase in $i_{N}$ will be accompanied by a corresponding increase in $v_{B E N}$ (above the quiescent value of $V_{B B} / 2$ ). However, since the voltage between the two bases remains constant


Figure 12.11 Class AB output stage. A bias voltage $V_{B B}$ is applied between the bases of $Q_{N}$ and $Q_{P}$, giving rise to a bias current $I_{Q}$ given by Eq. (12.23). Thus, for small $v_{I}$, both transistors conduct and crossover distortion is almost completely eliminated.
at $V_{B B}$, the increase in $v_{B E N}$ will result in an equal decrease in $v_{E B P}$ and hence in $i_{P}$. The relationship between $i_{N}$ and $i_{P}$ can be derived as follows:

$$
\begin{aligned}
v_{B E N}+v_{E B P} & =V_{B B} \\
V_{T} \ln \frac{i_{N}}{I_{S}}+V_{T} \ln \frac{i_{P}}{I_{S}} & =2 V_{T} \ln \frac{I_{Q}}{I_{S}} \\
i_{N} i_{P} & =I_{Q}^{2}
\end{aligned}
$$

Thus, as $i_{N}$ increases, $i_{P}$ decreases by the same ratio while the product remains constant. Equations (12.25) and (12.26) can be combined to yield $i_{N}$ for a given $i_{L}$ as the solution to the quadratic equation

$$
i_{N}^{2}-i_{L} i_{N}-I_{Q}^{2}=0
$$

From the equations above, we can see that for positive output voltages, the load current is supplied by $Q_{N}$, which acts as the output emitter follower. Meanwhile, $Q_{P}$ will be conducting a current that decreases as $v_{O}$ increases; for large $v_{O}$ the current in $Q_{P}$ can be ignored altogether.

For negative input voltages the opposite occurs: The load current will be supplied by $Q_{P}$, which acts as the output emitter follower, while $Q_{N}$ conducts a current that gets smaller as $v_{I}$ becomes more negative. Equation (12.26), relating $i_{N}$ and $i_{P}$, holds for negative inputs as well.

We conclude that the class AB stage operates in much the same manner as the class B circuit, with one important exception: For small $v_{I}$, both transistors conduct, and as $v_{I}$ is increased or decreased, one of the two transistors takes over the operation. Since the transition is a smooth one, crossover distortion will be almost totally eliminated. Figure 12.12 shows the transfer characteristic of the class AB stage.


Figure 12.12 Transfer characteristic of the class AB stage in Fig. 12.11.


Figure 12.13 Determining the small-signal output resistance of the class AB circuit of Fig. 12.11.

The power relationships in the class AB stage are almost identical to those derived for the class B circuit in Section 12.3. The only difference is that under quiescent conditions the class AB circuit dissipates a power of $V_{C C} I_{Q}$ per transistor. Since $I_{Q}$ is usually much smaller than the peak load current, the quiescent power dissipation is usually small. Nevertheless, it can be taken into account easily. Specifically, we can simply add the quiescent dissipation per transistor to its maximum power dissipation with an input signal applied, to obtain the total power dissipation that the transistor must be able to handle safely.

# 12.4.2 Output Resistance 

If we assume that the source supplying $v_{I}$ is ideal, then the output resistance of the class AB stage can be determined from the circuit in Fig. 12.13 as

$$
R_{\text {out }}=r_{e N} \| r_{e P}
$$

where $r_{e N}$ and $r_{e P}$ are the small-signal emitter resistances of $Q_{N}$ and $Q_{P}$, respectively. At a given input voltage, the currents $i_{N}$ and $i_{P}$ can be determined, and $r_{e N}$ and $r_{e P}$ are given by

$$
\begin{aligned}
& r_{e N}=\frac{V_{T}}{i_{N}} \\
& r_{e P}=\frac{V_{T}}{i_{P}}
\end{aligned}
$$

Thus,

$$
R_{\text {out }}=\frac{V_{T}}{i_{N}} \| \frac{V_{T}}{i_{P}}=\frac{V_{T}}{i_{P}+i_{N}}
$$

Since as $i_{N}$ increases, $i_{P}$ decreases, and vice versa, the output resistance remains approximately constant in the region around $v_{I}=0$. This, in effect, is the reason for the virtual absence of crossover distortion. At larger load currents, either $i_{N}$ or $i_{P}$ will be significant, and $R_{\text {out }}$ decreases as the load current increases.
# Example 12.3 

In this example we explore the details of the transfer characteristic, $v_{O}$ versus $v_{I}$, of the class AB circuit in Fig. 12.11. For this purpose let $V_{C C}=15 \mathrm{~V}, I_{Q}=2 \mathrm{~mA}$, and $R_{L}=100 \Omega$. Assume that $Q_{N}$ and $Q_{P}$ are matched and have $I_{S}=10^{-13} \mathrm{~A}$. First, determine the required value of the bias voltage $V_{B B}$. Then, find the transfer characteristic for $v_{O}$ in the range -10 V to +10 V .

## Solution

To determine the required value of $V_{B B}$ we use Eq. (12.23) with $I_{Q}=2 \mathrm{~mA}$ and $I_{S}=10^{-13} \mathrm{~A}$. Thus,

$$
\begin{aligned}
V_{B B} & =2 V_{T} \ln \left(I_{Q} / I_{S}\right) \\
& =2 \times 0.025 \ln \left(2 \times 10^{-3} / 10^{-13}\right)=1.186 \mathrm{~V}
\end{aligned}
$$

The easiest way to determine the transfer characteristic is to work backward; that is, for a given $v_{O}$ we determine the corresponding value of $v_{I}$. We shall outline the process for positive $v_{O}$ :

1. Assume a value for $v_{O}$.
2. Determine the load current $i_{L}$,

$$
i_{L}=v_{O} / R_{L}
$$

3. Use Eq. (12.27) to determine the current conducted by $Q_{N}, i_{N}$.
4. Determine $v_{B E N}$ from

$$
v_{B E N}=V_{T} \ln \left(i_{N} / I_{S}\right)
$$

5. Determine $v_{I}$ from

$$
v_{I}=v_{O}+v_{B E N}-V_{B B} / 2
$$

It is also useful to find $i_{P}$ and $v_{E B P}$ as follows:

$$
\begin{aligned}
i_{P} & =i_{N}-i_{L} \\
v_{E B P} & =V_{T} \ln \left(i_{P} / I_{S}\right)
\end{aligned}
$$

A similar process can be employed for negative $v_{O}$. However, symmetry can be utilized, obviating the need to repeat the calculations. The results obtained are displayed in the following table:
| $v_{o}(\mathrm{~V})$ | $i_{L}(\mathrm{~mA})$ | $i_{N}(\mathrm{~mA})$ | $i_{P}(\mathrm{~mA})$ | $v_{R E N}(\mathrm{~V})$ | $v_{E R P}(\mathrm{~V})$ | $v_{l}(\mathrm{~V})$ | $v_{o} / v_{l}$ | $R_{\text {out }}(\Omega)$ | $v_{o} / v_{i}$ |
| --: | --: | --: | --: | --: | --: | --: | --: | --: | --: |
| +10.0 | 100 | 100.04 | 0.04 | 0.691 | 0.495 | 10.1 | 0.99 | 0.25 | 1.00 |
| +5.0 | 50 | 50.08 | 0.08 | 0.673 | 0.513 | 5.08 | 0.98 | 0.50 | 1.00 |
| +1.0 | 10 | 10.39 | 0.39 | 0.634 | 0.552 | 1.041 | 0.96 | 2.32 | 0.98 |
| +0.5 | 5 | 5.70 | 0.70 | 0.619 | 0.567 | 0.526 | 0.95 | 4.03 | 0.96 |
| +0.2 | 2 | 3.24 | 1.24 | 0.605 | 0.581 | 0.212 | 0.94 | 5.58 | 0.95 |
| +0.1 | 1 | 2.56 | 1.56 | 0.599 | 0.587 | 0.106 | 0.94 | 6.07 | 0.94 |
| 0 | 0 | 2 | 2 | 0.593 | 0.593 | 0 | - | 6.25 | 0.94 |
| -0.1 | -1 | 1.56 | 2.56 | 0.587 | 0.599 | -0.106 | 0.94 | 6.07 | 0.94 |
| -0.2 | -2 | 1.24 | 3.24 | 0.581 | 0.605 | -0.212 | 0.94 | 5.58 | 0.95 |
| -0.5 | -5 | 0.70 | 5.70 | 0.567 | 0.619 | -0.526 | 0.95 | 4.03 | 0.96 |
| -1.0 | -10 | 0.39 | 10.39 | 0.552 | 0.634 | -1.041 | 0.96 | 2.32 | 0.98 |
| -5.0 | -50 | 0.08 | 50.08 | 0.513 | 0.673 | -5.08 | 0.98 | 0.50 | 1.00 |
| -10.0 | -100 | 0.04 | 100.04 | 0.495 | 0.691 | -10.1 | 0.99 | 0.25 | 1.00 |

The table also provides values for the dc gain $v_{o} / v_{l}$ as well as the incremental gain $v_{o} / v_{i}$ at the various values of $v_{o}$. The incremental gain is computed as follows

$$
\frac{v_{o}}{v_{i}}=\frac{R_{L}}{R_{L}+R_{\text {out }}}
$$

where $R_{\text {out }}$ is the small-signal output resistance of the amplifier, given by Eq. (12.31). The incremental gain is the slope of the voltage-transfer characteristic, and the magnitude of its variation over the range of $v_{o}$ is an indication of the linearity of the output stage. Observe that for $0 \leq\left|v_{o}\right| \leq 10 \mathrm{~V}$, the incremental gain changes from 0.94 to 1.00 , about $6 \%$. Also observe as $v_{o}$ becomes positive, $Q_{N}$ supplies more and more of $i_{L}$ and the current in $Q_{P}$ is correspondingly reduced. The opposite happens for negative $v_{o}$.

# EXERCISE 

12.5 To increase the linearity of the class AB output stage, the quiescent current $I_{Q}$ is increased. The price paid is an increase in quiescent power dissipation. For the output stage considered in Example 12.3:
(a) Find the quiescent power dissipation.
(b) If $I_{Q}$ is increased to 10 mA , find $v_{o} / v_{i}$ at $v_{o}=0$ and at $\left|v_{o}\right|=10 \mathrm{~V}$, and hence the percentage change. Compare to the case in Example 12.3.
(c) Find the quiescent power dissipation for the case in (b).

Ans. (a) 60 mW ; (b) 0.988 to 1.00 ; for a change of $1.2 \%$ compared to the $6 \%$ change in Example 12.3;
(c) 300 mW
# 12.5 Biasing the Class AB Circuit 

In this section we discuss two approaches for generating the voltage $V_{B B}$ required for biasing the class AB output stage.

### 12.5.1 Biasing Using Diodes

Figure 12.14 shows a class AB circuit in which the bias voltage $V_{B B}$ is generated by passing a constant current $I_{\text {BIAS }}$ through a pair of diodes, or diode-connected transistors, $D_{1}$ and $D_{2}$. In circuits that supply large amounts of power, the output transistors are large-geometry devices. The biasing diodes, however, need not be large devices, and thus the quiescent current $I_{Q}$ established in $Q_{N}$ and $Q_{P}$ will be $I_{Q}=n I_{\text {BIAS }}$, where $n$ is the ratio of the emitter-junction area of the output devices to the junction area of the biasing diodes. In other words, the saturation (or scale) current $I_{S}$ of the output transistors is $n$ times that of the biasing diodes. Area ratioing is simple to implement in integrated circuits but difficult to realize in discrete-circuit designs.

When the output stage of Fig. 12.14 is sourcing current to the load, the base current of $Q_{N}$ increases from $I_{Q} / \beta_{N}$ (which is usually small) to approximately $i_{L} / \beta_{N}$. This base current drive must be supplied by the current source $I_{\text {BIAS }}$. It follows that $I_{\text {BIAS }}$ must be greater than the maximum anticipated base drive for $Q_{N}$. This sets a lower limit on the value of $I_{\text {BIAS }}$. Now, since $n=I_{Q} / I_{\text {BIAS }}$, and since $I_{Q}$ is usually much smaller than the peak load current $(<10 \%)$, we see that we cannot make $n$ a large number. In other words, we cannot make the diodes much smaller than the output devices. This is a disadvantage of the diode biasing scheme.

From the discussion above we see that the current through the biasing diodes will decrease when the output stage is sourcing current to the load. Thus the bias voltage $V_{B B}$ will also decrease, and the analysis of Section 12.4 must be modified to take this effect into account.

The diode biasing arrangement has an important advantage: It can provide thermal stabilization of the quiescent current in the output stage. To appreciate this point, recall that the class AB output stage dissipates power under quiescent conditions. Power dissipation


Figure 12.14 A class AB output stage utilizing diodes for biasing. If the junction area of the output devices, $Q_{N}$ and $Q_{P}$, is $n$ times that of the biasing devices $D_{1}$ and $D_{2}$, a quiescent current $I_{Q}=n I_{\text {BIAS }}$ flows in the output devices.
raises the internal temperature of the BJTs. From Chapter 6 we know that a rise in transistor temperature results in a decrease in its $V_{B E}$ (approximately $-2 \mathrm{mV} /{ }^{\circ} \mathrm{C}$ ) if the collector current is held constant. Alternatively, if $V_{B E}$ is held constant and the temperature increases, the collector current increases. The increase in collector current increases the power dissipation, which in turn increases the junction temperature and hence, once more, the collector current. Thus a positive-feedback mechanism exists that can result in a phenomenon called thermal runaway. Unless checked, thermal runaway can lead to the ultimate destruction of the BJT. Diode biasing can be arranged to provide a compensating effect that can protect the output transistors against thermal runaway under quiescent conditions. Specifically, if the diodes are in close thermal contact with the output transistors, their temperature will increase by the same amount as that of $Q_{N}$ and $Q_{P}$. Thus $V_{B B}$ will decrease at the same rate as $V_{B E N}+V_{E B P}$, with the result that $I_{Q}$ remains constant. Close thermal contact is easily achieved in IC fabrication. It is obtained in discrete circuits by mounting the bias diodes on the metal case of $Q_{N}$ or $Q_{P}$. Finally, it is important to note that thermal runaway does not occur in MOS circuits.

# Example 12.4 

Consider the class AB output stage under the conditions that $V_{C C}=15 \mathrm{~V}, R_{L}=100 \Omega$, and the output is sinusoidal with a maximum amplitude of 10 V . Let $Q_{N}$ and $Q_{P}$ be matched with $I_{S}=10^{-13} \mathrm{~A}$ and $\beta=50$. Assume that the biasing diodes have one-third the junction area of the output devices. Find the value of $I_{\text {BIAS }}$ that guarantees a minimum of 1 mA through the diodes at all times. Determine the quiescent current and the quiescent power dissipation in the output transistors (i.e., at $v_{O}=0$ ). Also find $V_{B B}$ for $v_{O}=0$, +10 V , and -10 V .

## Solution

The maximum current through $Q_{N}$ is approximately equal to $i_{L \max }=10 \mathrm{~V} / 0.1 \mathrm{k} \Omega=100 \mathrm{~mA}$. Thus the maximum base current in $Q_{N}$ is approximately 2 mA . To maintain a minimum of 1 mA through the diodes, we select $I_{\text {BIAS }}=3 \mathrm{~mA}$. The area ratio of 3 yields a quiescent current of 9 mA through $Q_{N}$ and $Q_{P}$. The quiescent power dissipation is

$$
P_{D Q}=2 \times 15 \times 9=270 \mathrm{~mW}
$$

For $v_{O}=0$, the base current of $Q_{N}$ is $9 / 51 \simeq 0.18 \mathrm{~mA}$, leaving a current of $3-0.18=2.82 \mathrm{~mA}$ to flow through the diodes. Since the diodes have $I_{S}=\frac{1}{3} \times 10^{-13} \mathrm{~A}$, the voltage $V_{B B}$ will be

$$
V_{B B}=2 V_{F} \ln \left(\frac{2.82 \mathrm{~mA}}{I_{S}}\right)=1.26 \mathrm{~V}
$$

At $v_{O}=+10 \mathrm{~V}$, the current through the diodes will decrease to 1 mA , resulting in $V_{B B} \simeq 1.21 \mathrm{~V}$. At the other extreme of $v_{O}=-10 \mathrm{~V}, Q_{N}$ will be conducting a very small current; thus its base current will be negligibly small and all of $I_{\text {BIAS }}(3 \mathrm{~mA})$ flows through the diodes, resulting in $V_{B B} \simeq 1.26 \mathrm{~V}$.# EXERCISES 

12.6 For the circuit of Example 12.4, find $i_{N}$ and $i_{P}$ for $v_{O}=+10 \mathrm{~V}$ and $v_{O}=-10 \mathrm{~V}$. (Hint: Use the $V_{B B}$ values found in Example 12.4.)
Ans. $100.1 \mathrm{~mA}, 0.1 \mathrm{~mA} ; 0.8 \mathrm{~mA}, 100.8 \mathrm{~mA}$
12.7 If the collector current of a transistor is held constant, its $v_{B E}$ decreases by 2 mV for every $1^{\circ} \mathrm{C}$ rise in temperature. Alternatively, if $v_{B E}$ is held constant, then $i_{C}$ increases by approximately $g_{m} \times 2 \mathrm{mV}$ for every $1^{\circ} \mathrm{C}$ rise in temperature. For a device operating at $I_{C}=10 \mathrm{~mA}$, find the change in collector current resulting from an increase in temperature of $5^{\circ} \mathrm{C}$.
Ans. 4 mA

### 12.5.2 Biasing Using the $V_{B E}$ Multiplier

An alternative biasing arrangement that provides the designer with considerably more flexibility in both discrete and integrated designs is shown in Fig. 12.15. The bias circuit consists of transistor $Q_{1}$ with a resistor $R_{1}$ connected between base and emitter and a feedback resistor $R_{2}$ connected between collector and base. The resulting two-terminal network is fed with a constant-current source $I_{\text {BIAS }}$. If we neglect the base current of $Q_{1}$, then $R_{1}$ and $R_{2}$ will carry the same current $I_{R}$, given by

$$
I_{R}=\frac{V_{B E 1}}{R_{1}}
$$



Figure 12.15 A class AB output stage utilizing a $V_{B E}$ multiplier for biasing.


Figure 12.16 A discrete-circuit class AB output stage with a potentiometer used in the $V_{B E}$ multiplier. The potentiometer is adjusted to yield the desired value of quiescent current in $Q_{N}$ and $Q_{P}$.
and the voltage $V_{B B}$ across the bias network will be

$$
\begin{aligned}
V_{B B} & =I_{R}\left(R_{1}+R_{2}\right) \\
& =V_{B E 1}\left(1+\frac{R_{2}}{R_{1}}\right)
\end{aligned}
$$

Thus the circuit simply multiplies $V_{B E 1}$ by the factor $\left(1+R_{2} / R_{1}\right)$ and is known as the " $V_{B E}$ multiplier." The multiplication factor is obviously under the designer's control and can be used to establish the value of $V_{B B}$ required to yield a desired quiescent current $I_{Q}$. In IC design it is relatively easy to control accurately the ratio of two resistances. In discrete-circuit design, a potentiometer can be used, as shown in Fig. 12.16, and is manually set to produce the desired value of $I_{Q}$.

The value of $V_{B E 1}$ in Eq. (12.33) is determined by the portion of $I_{\text {BIAS }}$ that flows through the collector of $Q_{1}$; that is,

$$
\begin{aligned}
I_{C 1} & =I_{\mathrm{BIAS}}-I_{R} \\
V_{B E 1} & =V_{T} \ln \frac{I_{C 1}}{I_{S 1}}
\end{aligned}
$$

where we have neglected the base current of $Q_{N}$, which is normally small both under quiescent conditions and when the output voltage is swinging negative. However, for positive $v_{O}$, especially at and near its peak value, the base current of $Q_{N}$ can become sizable and will
reduce the current available for the $V_{B E}$ multiplier. Nevertheless, since large changes in $I_{C 1}$ correspond to only small changes in $V_{B E 1}$, the decrease in current will be mostly absorbed by $Q_{1}$, leaving $I_{R}$, and hence $V_{B B}$, almost constant.

# EXERCISE 

12.8 Consider a $V_{B E}$ multiplier with $R_{1}=R_{2}=1.2 \mathrm{k} \Omega$, utilizing a transistor that has $V_{B E}=0.6 \mathrm{~V}$ at $I_{C}=1 \mathrm{~mA}$, and a very high $\beta$. (a) Find the value of the current $I$ that should be supplied to the multiplier to obtain a terminal voltage of 1.2 V . (b) Find the value of $I$ that will result in the terminal voltage changing (from the $1.2-\mathrm{V}$ value) by $+50 \mathrm{mV},+100 \mathrm{mV},+200 \mathrm{mV},-50 \mathrm{mV},-100 \mathrm{mV},-200 \mathrm{mV}$. Ans. (a) 1.5 mA ; (b) $3.24 \mathrm{~mA}, 7.93 \mathrm{~mA}, 55.18 \mathrm{~mA}, 0.85 \mathrm{~mA}, 0.59 \mathrm{~mA}, 0.43 \mathrm{~mA}$

Like the diode biasing network, the $V_{B E}$-multiplier circuit can provide thermal stabilization of $I_{Q}$. This is especially true if $R_{1}=R_{2}$, and $Q_{1}$ is in close thermal contact with the output transistors.

## Example 12.5

It is required to redesign the output stage of Example 12.4 utilizing a $V_{B E}$ multiplier for biasing. Use a small-geometry transistor for $Q_{1}$ with $I_{S}=10^{-14} \mathrm{~A}$ and design for a quiescent current $I_{Q}=2 \mathrm{~mA}$.

## Solution

Since the peak positive current is 100 mA , the base current of $Q_{N}$ can be as high as 2 mA . We shall therefore select $I_{\text {BIAS }}=3 \mathrm{~mA}$, thus providing the multiplier with a minimum current of 1 mA .

Under quiescent conditions ( $v_{O}=0$ and $i_{L}=0$ ) the base current of $Q_{N}$ can be neglected and all of $I_{\text {BIAS }}$ flows through the multiplier. We now must decide on how this current $(3 \mathrm{~mA})$ is to be divided between $I_{C 1}$ and $I_{R}$. If we select $I_{R}$ greater than 1 mA , the transistor will be almost cut off at the positive peak of $v_{O}$. Therefore, we shall select $I_{R}=0.5 \mathrm{~mA}$, leaving 2.5 mA for $I_{C 1}$.

To obtain a quiescent current of 2 mA in the output transistors, $V_{B B}$ should be

$$
V_{B B}=2 V_{T} \ln \frac{2 \times 10^{-3}}{10^{-13}}=1.19 \mathrm{~V}
$$

We can now determine $R_{1}+R_{2}$ as follows:

$$
R_{1}+R_{2}=\frac{V_{B B}}{I_{R}}=\frac{1.19}{0.5}=2.38 \mathrm{k} \Omega
$$

At a collector current of $2.5 \mathrm{~mA}, Q_{1}$ has

$$
V_{B E 1}=V_{T} \ln \frac{2.5 \times 10^{-3}}{10^{-14}}=0.66 \mathrm{~V}
$$
The value of $R_{1}$ can now be determined as

$$
R_{1}=\frac{0.66}{0.5}=1.32 \mathrm{k} \Omega
$$

and $R_{2}$ as

$$
R_{2}=2.38-1.32=1.06 \mathrm{k} \Omega
$$

# 12.6 Variations on the Class AB Configuration 

In this section, we discuss a number of circuit improvements and protection techniques for the BJT class AB output stage.

### 12.6.1 Use of Input Emitter Followers

Figure 12.17 shows a class AB circuit biased using transistors $Q_{1}$ and $Q_{2}$, which also function as emitter followers, thus providing the circuit with a high input resistance. In effect, the


Figure 12.17 A class AB output stage with an input buffer. In addition to providing a high input resistance, the buffer transistors $Q_{1}$ and $Q_{2}$ bias the output transistors $Q_{3}$ and $Q_{4}$.
$Q_{1}-Q_{2}$ circuit functions as a unity-gain buffer amplifier. Since all four transistors are usually matched, and neglecting the effect of $R_{3}$ and $R_{4}$, we see that the quiescent current ( $v_{I}=0$, $R_{L}=\infty$ ) in $Q_{3}$ and $Q_{4}$ is equal to that in $Q_{1}$ and $Q_{2}$. Resistors $R_{3}$ and $R_{4}$ are usually very small and are included to compensate for possible mismatches between $Q_{3}$ and $Q_{4}$ and to guard against the possibility of thermal runaway due to temperature differences between the inputand output-stage transistors. The latter point can be appreciated by noting that an increase in the current of, say, $Q_{3}$ causes an increase in the voltage drop across $R_{3}$ and a corresponding decrease in $V_{B E 3}$. Thus $R_{3}$ provides negative feedback that helps stabilize the current through $Q_{3}$.

Because the circuit of Fig. 12.17 requires high-quality pnp transistors, it is not suitable for implementation in conventional monolithic IC technology. However, excellent results have been obtained with this circuit implemented in hybrid thick-film technology (Wong and Sherwin, 1979). This technology permits component trimming, for instance, to minimize the output offset voltage. The circuit can be used alone or together with an op amp to provide increased output driving capability.

# EXERCISE 

12.9 (Note: Although rather long, this exercise is very instructive.) Consider the circuit of Fig. 12.17 with $R_{1}=R_{2}=5 \mathrm{k} \Omega, R_{3}=R_{4}=0 \Omega$, and $V_{C C}=15 \mathrm{~V}$. Let the transistors be matched with $I_{S}=3.3 \times 10^{-14} \mathrm{~A}$ and $\beta=200$. (These are the values used in the LH002 manufactured by National Semiconductor, except that $R_{3}=R_{4}=2 \Omega$ there.) (a) For $v_{I}=0$ and $R_{L}=\infty$, find the quiescent current in each of the four transistors and $v_{O}$. (b) For $R_{L}=\infty$, find $i_{C 1}, i_{C 2}, i_{C 3}, i_{C 4}$, and $v_{O}$ for $v_{I}=+10 \mathrm{~V}$ and -10 V . (c) Repeat (b) for $R_{L}=100 \Omega$.
Ans. (a) $2.87 \mathrm{~mA} ; 0 \mathrm{~V}$; (b) for $v_{I}=+10 \mathrm{~V}: 0.88 \mathrm{~mA}, 4.87 \mathrm{~mA}, 1.95 \mathrm{~mA}, 1.95 \mathrm{~mA},+9.98 \mathrm{~V}$; for $v_{I}=-10 \mathrm{~V}: 4.87 \mathrm{~mA}, 0.88 \mathrm{~mA}, 1.95 \mathrm{~mA}, 1.95 \mathrm{~mA},-9.98 \mathrm{~V}$; (c) for $v_{I}=+10 \mathrm{~V}: 0.38 \mathrm{~mA}$, $4.87 \mathrm{~mA}, 100 \mathrm{~mA}, 0.02 \mathrm{~mA},+9.86 \mathrm{~V}$; for $v_{I}=-10 \mathrm{~V}: 4.87 \mathrm{~mA}, 0.38 \mathrm{~mA}, 0.02 \mathrm{~mA}, 100 \mathrm{~mA}$, -9.86 V

### 12.6.2 Use of Compound Devices

To increase the current gain of the output-stage transistors, and thus reduce the required base current drive, the Darlington configuration shown in Fig. 12.18 is frequently used to replace the $n p n$ transistor of the class AB stage. The Darlington configuration is equivalent to a single $n p n$ transistor having $\beta \simeq \beta_{1} \beta_{2}$, but almost twice the value of $V_{B E}$.

The Darlington configuration can be also used for $p n p$ transistors, and this is indeed done in discrete-circuit design. In IC design, however, the lack of good-quality pnp transistors prompted the use of the alternative compound configuration shown in Fig. 12.19. This compound device is equivalent to a single $p n p$ transistor having $\beta \simeq \beta_{1} \beta_{2}$. When fabricated with standard IC technology, $Q_{1}$ is usually a lateral pnp having a low $\beta(\beta=5-10)$ and poor high-frequency response ( $f_{T} \simeq 5 \mathrm{MHz}$ ); see Appendix A and Appendix K. The compound


Figure 12.18 The Darlington configuration.


Figure 12.19 The compound-pnp configuration.
device, although it has a relatively high equivalent $\beta$, still suffers from a poor high-frequency response. It also suffers from another problem: The feedback loop formed by $Q_{1}$ and $Q_{2}$ is prone to high-frequency oscillations (with frequency near $f_{T}$ of the $p n p$ device, i.e., about 5 MHz ). Methods exist for preventing such oscillations. The subject of feedback-amplifier stability was studied in Chapter 11.

To illustrate the application of the Darlington configuration and of the compound pnp, we show in Fig. 12.20 an output stage utilizing both. Class AB biasing is achieved using a $V_{B E}$ multiplier. Note that the Darlington $n p n$ adds one more $V_{B E}$ drop, and thus the $V_{B E}$ multiplier is required to provide a bias voltage of about 2 V . The design of this class AB stage is investigated in Problem 12.39.


Figure 12.20 A class AB output stage utilizing a Darlington $n p n$ and a compound $p n p$. Biasing is obtained using a $V_{B E}$ multiplier.

# EXERCISE 

12.10 (a) Refer to Fig. 12.19. Show that, for the composite pnp transistor,

$$
i_{B} \simeq \frac{i_{C}}{\beta_{N} \beta_{P}}
$$

and

$$
i_{E} \simeq i_{C}
$$

Hence show that

$$
i_{C} \simeq \beta_{N} I_{S P} e^{v_{E B} / v_{T}}
$$

and thus the transistor has an effective scale current

$$
I_{S}=\beta_{N} I_{S P}
$$

where $I_{S P}$ is the scale current of the $p n p$ transistor $Q_{1}$.
(b) For $\beta_{P}=20, \beta_{N}=50, \mathrm{I}_{S P}=10^{-14} \mathrm{~A}$, find the effective current gain of the compound device and its $v_{E B}$ when $i_{C}=100 \mathrm{~mA}$.
Ans. (b) $1000 ; 0.651 \mathrm{~V}$


Figure 12.21 A class AB output stage with short-circuit protection. The protection circuit shown operates in the event of an output short circuit while $v_{O}$ is positive.

# 12.6.3 Short-Circuit Protection 

Figure 12.21 shows a class AB output stage equipped with protection against the effect of short-circuiting the output while the stage is sourcing current. The large current that flows through $Q_{1}$ in the event of a short circuit will develop a voltage drop across $R_{E 1}$ of sufficient value to turn $Q_{5}$ on. The collector of $Q_{5}$ will then conduct most of the current $I_{\text {BIAS }}$, robbing $Q_{1}$ of its base drive. The current through $Q_{1}$ will thus be reduced to a safe operating level.

This method of short-circuit protection is effective in ensuring device safety, but it has the disadvantage that under normal operation about 0.5 V drop might appear across each $R_{E}$. This means that the voltage swing at the output will be reduced by that much, in each direction. On the other hand, the inclusion of emitter resistors provides the additional benefit of protecting the output transistors against thermal runaway.

## EXERCISE

D12.11 In the circuit of Fig. 12.21 let $I_{\text {BIAS }}=2 \mathrm{~mA}$. Find the value of $R_{E 1}$ that causes $Q_{5}$ to turn on and absorb all 2 mA when the output current being sourced reaches 150 mA . For $Q_{5}, I_{S}=10^{-14} \mathrm{~A}$. If the normal peak output current is 100 mA , find the voltage drop across $R_{E 1}$ and the collector current of $Q_{5}$.
Ans. $4.3 \Omega ; 430 \mathrm{mV} ; 0.3 \mu \mathrm{~A}$


Figure 12.22 Thermal-shutdown circuit.

# 12.6.4 Thermal Shutdown 

In addition to short-circuit protection, most IC power amplifiers are usually equipped with a circuit that senses the temperature of the chip and turns on a transistor in the event that the temperature exceeds a safe preset value. The turned-on transistor is connected in such a way that it absorbs the bias current of the amplifier, thus virtually shutting down its operation.

Figure 12.22 shows a thermal-shutdown circuit. Here, transistor $Q_{2}$ is normally off. As the chip temperature rises, the combination of the positive temperature coefficient of zener diode $Z_{1}$ and the negative temperature coefficient of $V_{B E 1}$ causes the voltage at the emitter of $Q_{1}$ to rise. This in turn raises the voltage at the base of $Q_{2}$ to the point at which $Q_{2}$ turns on.

### 12.7 CMOS Class AB Output Stages

In this section we study CMOS class AB output stages. We begin with the CMOS counterpart of the BJT class AB output stage studied in Section 12.5. As we shall see, this circuit suffers from a relatively low output signal swing, a serious limitation, especially in view of the shrinking power-supply voltages characteristic of modern deep-submicron CMOS technologies. We will then look at an attractive alternative circuit that overcomes this problem.

### 12.7.1 The Classical Configuration

Figure 12.23 shows the classical CMOS class AB output stage. The circuit is the exact counterpart of the bipolar circuit shown in Fig. 12.14 with the biasing diodes implemented with diode-connected transistors $Q_{1}$ and $Q_{2}$. The constant current $I_{\text {BIAS }}$ flowing through $Q_{1}$ and $Q_{2}$ establishes a dc bias voltage $V_{G G}$ between the gates of $Q_{N}$ and $Q_{P}$. This voltage in turn establishes the quiescent $\left(v_{O}=0\right)$ current $I_{Q}$ in $Q_{N}$ and $Q_{P}$. Unlike the BJT circuit in Fig. 12.14, here the zero dc gate current of $Q_{N}$ results in the current through $Q_{1}$ and $Q_{2}$ remaining constant


Figure 12.23 Classical CMOS class AB output stage. This circuit is the CMOS counterpart of the BJT circuit in Fig. 11.14 with the biasing diodes implemented with diode-connected MOSFETs $Q_{1}$ and $Q_{2}$
at $I_{\text {BIAS }}$ irrespective of the value of $v_{O}$ and the load current $i_{L}$. Thus $V_{G G}$ remains constant and the circuit is more like the idealized bipolar case shown in Fig. 12.11.

The value of $I_{Q}$ can be determined by utilizing the $i_{D}-v_{G S}$ equations for the four MOS transistors for the case $v_{O}=0$. Neglecting channel-length modulation, we can write for $Q_{1}$,

$$
I_{D 1}=I_{\mathrm{BIAS}}=\frac{1}{2} k_{n}^{\prime}(W / L)_{1}\left(V_{G S 1}-V_{m}\right)^{2}
$$

and for $Q_{2}$,

$$
I_{D 2}=I_{\mathrm{BIAS}}=\frac{1}{2} k_{p}^{\prime}(W / L)_{2}\left(V_{S G 2}-\left|V_{i p}\right|\right)^{2}
$$

Equations (12.36) and (12.37) can be used to find $V_{G S 1}$ and $V_{S G 2}$, which when summed yield $V_{G G}$; thus,

$$
V_{G G}=V_{G S 1}+V_{S G 2}=V_{m}+\left|V_{i p}\right|+\sqrt{2 I_{\mathrm{BIAS}}}\left(\frac{1}{\sqrt{k_{n}^{\prime}(W / L)_{1}}}+\frac{1}{\sqrt{k_{p}^{\prime}(W / L)_{2}}}\right)
$$

We can follow a similar process for $Q_{N}$ and $Q_{P}$, which, for $v_{O}=0$, are conducting the quiescent current $I_{Q}$; thus,

$$
V_{G G}=V_{G S N}+V_{S G P}=V_{m}+\left|V_{i p}\right|+\sqrt{2 I_{Q}}\left(\frac{1}{\sqrt{k_{n}^{\prime}(W / L)_{n}}}+\frac{1}{\sqrt{k_{p}^{\prime}(W / L)_{p}}}\right)
$$

Equations (12.38) and (12.39) can be combined to obtain

$$
I_{Q}=I_{\mathrm{BIAS}}\left[\frac{1 / \sqrt{k_{n}^{\prime}(W / L)_{1}}+1 / \sqrt{k_{p}^{\prime}(W / L)_{2}}}{1 / \sqrt{k_{n}^{\prime}(W / L)_{n}}+1 / \sqrt{k_{p}^{\prime}(W / L)_{p}}}\right]^{2}
$$which indicates that $I_{Q}$ is determined by $I_{\text {BIAS }}$ together with the $(W / L)$ ratios of the four transistors. For the case $Q_{1}$ and $Q_{2}$ are matched, that is,

$$
k_{p}^{\prime}(W / L)_{2}=k_{n}^{\prime}(W / L)_{1}
$$

and $Q_{N}$ and $Q_{P}$ are matched, that is,

$$
k_{p}^{\prime}(W / L)_{p}=k_{n}^{\prime}(W / L)_{n}
$$

Equation (12.40) simplifies to

$$
I_{Q}=I_{\mathrm{BIAS}} \frac{(W / L)_{n}}{(W / L)_{1}}
$$

which is an intuitively appealing result.

# EXERCISE 

12.12 For the CMOS class AB output stage of Fig. 12.23, consider the case of matched $Q_{1}$ and $Q_{2}$, and matched $Q_{N}$ and $Q_{P}$. If $I_{Q}=1 \mathrm{~mA}$ and $I_{\text {BIAS }}=0.2 \mathrm{~mA}$, find $(W / L)$ for each of $Q_{1}, Q_{2}, Q_{N}$, and $Q_{P}$ so that in the quiescent state each transistor operates at an overdrive voltage of 0.2 V . Let $V_{D D}=V_{S S}=2.5 \mathrm{~V}, k_{n}^{\prime}=250 \mu \mathrm{~A} / \mathrm{V}^{3}, k_{p}^{\prime}=100 \mu \mathrm{~A} / \mathrm{V}^{3}$, and $V_{m}=-V_{t p}=0.5 \mathrm{~V}$. Also find $V_{G G}$. Ans. 40; 100; 200; 500; 1.4 V

A drawback of the CMOS class AB circuit of Fig. 12.23 is the restricted range of output voltage swing. To find the maximum possible value of $v_{O}$, refer to Fig. 12.23 and assume that across the bias current source is a dc voltage of $V_{\text {BIAS }}$. We can write for $v_{O}$,

$$
v_{O}=V_{D D}-V_{\mathrm{BIAS}}-v_{G S N}
$$

The maximum value of $v_{O}$ will be limited by the need to keep $V_{\text {BIAS }}$ to a minimum of $V_{O V}$ of the transistor supplying $I_{\text {BIAS }}$ (otherwise the current-source transistor no longer operates in saturation); thus,

$$
v_{O \max }=V_{D D}-\left.V_{O V}\right|_{\mathrm{BIAS}}-v_{G S N}
$$

Note that when $v_{O}$ is at its maximum value, $Q_{N}$ will be supplying most or all of $i_{L}$, and $v_{G S N}$ will be large, thus

$$
v_{O \max }=V_{D D}-\left.V_{O V}\right|_{\mathrm{BIAS}}-V_{m}-v_{O V N}
$$

where $v_{O V N}$ is the overdrive voltage of $Q_{N}$ when it is supplying $i_{L \max }$.
# EXERCISE 

12.13 For the circuit specified in Exercise 12.12, find $v_{O \max }$ when $i_{L \max }=10 \mathrm{~mA}$. Assume that $Q_{N}$ is supplying all of $i_{L \max }$ and that $\left.V_{O V}\right|_{\text {BIAS }}=0.2 \mathrm{~V}$.
Ans. 1.17 V

The minimum allowed value of $v_{O}$ can be found in a similar way. Here we note that the transistor supplying $v_{I}$ (not shown) will need a minimum voltage across it of $\left.V_{O V}\right|_{t}$. Thus,

$$
v_{O \min }=-V_{S S}+\left.V_{O V}\right|_{t}+\left|V_{S S}\right|+\left|v_{O V P}\right|
$$

where $\left|v_{O V P}\right|$ is the overdrive voltage of $Q_{P}$ when sinking the maximum negative value of $i_{L}$.
Finally, we observe that the reason for the lower allowable range of $v_{O}$ in the CMOS circuit is the relatively large value of $v_{O V N}$ and $\left|v_{O V P}\right|$; that is, the large values of $v_{G S N}$ and $v_{S G P}$ required to supply the large output currents. In the BJT circuit the corresponding voltages, $v_{B E N}$ and $v_{E B P}$, remain close to 0.7 V . The overdrive voltages $v_{O V N}$ and $\left|v_{O V P}\right|$ can be reduced by making the $W / L$ ratios of $Q_{N}$ and $Q_{P}$ large. This, however, can lead to impractically large devices.

### 12.7.2 An Alternative Circuit Utilizing Common-Source Transistors

The allowable range of $v_{O}$ can be increased by replacing the source followers with a pair of complementary transistors connected in the common-source configuration, as shown in Fig. 12.24. Here $Q_{P}$ supplies the load current when $v_{O}$ is positive and allows $v_{O}$ to go as high as $\left(V_{D D}-\left|v_{O V P}\right|\right)$, a much higher value than that given by Eq. (12.46). For negative $v_{O}, Q_{N}$ sinks the load current and allows $v_{O}$ to go as low as $-V_{S S}+v_{O V N}$. This also is larger in magnitude than the value given by Eq. (12.47). Thus, the circuit of Fig. 12.24 provides an output voltage


Figure 12.24 An alternative CMOS output stage utilizing a pair of complementary MOSFETs connected in the common-source configuration. The driving circuit is not shown.


Figure 12.25 Inserting an amplifier in the negative feedback path of each of $Q_{N}$ and $Q_{P}$ reduces the output resistance and makes $v_{O} \simeq v_{I}$; both are desirable properties for the output stage.
range that is within an overdrive voltage of each of the supplies. The disadvantage of the circuit, however, is its high output resistance,

$$
R_{\text {out }}=r_{o n} \| r_{o p}
$$

To reduce the output resistance, negative feedback is employed as shown in Fig. 12.25. Here an amplifier with gain $\mu$ is inserted between drain and gate of each of $Q_{N}$ and $Q_{P}$. To verify that the feedback around each amplifier is negative, assume that $v_{O}$ increases. The top amplifier will cause the gate voltage of $Q_{P}$ to increase, thus its $v_{S G}$ decreases and $i_{D P}$ decreases. The decrease in $i_{D P}$ causes $v_{O}$ to decrease, which is opposite to the initially assumed change, thus verifying that the feedback is negative. A similar process can be used to verify that the feedback around the bottom amplifier also is negative.

From our study of feedback in Chapter 11, we observe that each of the two feedback loops is of the series-shunt type, which is the topology appropriate for a voltage amplifier. Thus, as we shall show shortly, the feedback will reduce the output resistance of the amplifier. Also, observe that if the loop gain is large, the voltage difference between the two input terminals of each feedback amplifier, the error voltage, will be small, resulting in $v_{O} \simeq v_{I}$. For this reason, the two amplifiers $\mu$ are known as error amplifiers.

Both the low output resistance and the near-unity dc gain are highly desirable properties for an output stage.

Output Resistance To derive an expression for the output resistance $R_{\text {out }}$, we consider each half of the circuit separately, find its output resistance, $R_{\text {outp }}$ for the top half and $R_{\text {outn }}$ for the bottom half, and then obtain the overall output resistance as the parallel equivalent of the two resistances,

$$
R_{\text {out }}=R_{\text {outn }} \| R_{\text {outp }}
$$


Figure 12.26 Determining the output resistance. (a) The top half of the output stage showing the definition of $R_{\text {outp }}$ and $R_{o f}$. (b) The $\beta$ circuit and (c) the $A$ circuit.

Figure 12.26(a) shows the top half of the circuit. Observe that feedback is applied by connecting the output back to the input. Thus the feedback network is the two-port shown in Fig. 12.26(b) and the feedback factor is

$$
\beta=1
$$

Including the loading effects of the feedback network results in the $A$ circuit shown in Fig. 12.26(c). Note that since we are now interested in incremental quantities, we have replaced $V_{D D}$ with a short circuit to ground. The open-loop gain $A$ can be found from the circuit in Fig. 12.26(c) as

$$
A \equiv \frac{v_{o}}{v_{i}}=\mu g_{m p}\left(r_{o p} \| R_{L}\right)
$$

where we have utilized implicitly the small-signal model of $Q_{P}$. The values of the small-signal parameters $g_{m p}$ and $r_{o p}$ are to be evaluated at the current at which $Q_{P}$ is operating. The open-loop output resistance $R_{o}$ is found by inspection as

$$
R_{o}=R_{L} \| r_{o p}
$$
The output resistance with feedback $R_{o f}$ can now be found as

$$
R_{o f}=\frac{R_{o}}{1+A \beta}=\frac{\left(R_{L} \| r_{o p}\right)}{1+\mu g_{m p}\left(r_{o p} \| R_{L}\right)}
$$

and the output resistance $R_{\text {outp }}$ is found by excluding $R_{L}$ from $R_{o f}$, that is,

$$
R_{\text {outp }}=1 /\left(\frac{1}{R_{o f}}-\frac{1}{R_{L}}\right)
$$

which results in

$$
R_{\text {outp }}=r_{o p} \| \frac{1}{\mu g_{m p}} \simeq \frac{1}{\mu g_{m p}}
$$

which can be quite low. A similar development applied to the bottom half of the circuit in Fig. 12.25 results in

$$
R_{\text {outn }} \simeq 1 / \mu g_{m n}
$$

Combining Eqs. (12.55) and (12.56) gives

$$
R_{\text {out }} \simeq 1 / \mu\left(g_{m p}+g_{m n}\right)
$$

The Voltage-Transfer Characteristic Next we derive an expression for the voltagetransfer characteristic, $v_{O}$ versus $v_{I}$, of the class AB common-source buffer. Toward that end, we first consider the circuit in the quiescent state, shown in Fig. 12.27(a). Here $v_{I}=0$ and $v_{O}=0$. Each of the error amplifiers is designed to deliver to the gate of its associated MOSFET the dc voltage required to establish the desired value of quiescent current $I_{Q}$.

Note that these voltages at the outputs of the error amplifiers are the dc bias or quiescent values. These voltages will undergo incremental changes when the input voltages of the amplifiers change from zero. To obtain class AB operation, $I_{Q}$ is usually selected to be $10 \%$

(a)

(b)

Figure 12.27 Analysis of the CMOS output stage to determine $v_{O}$ versus $v_{I}$. (a) Quiescent conditions. (b) The situation with $v_{I}$ applied.
or so of the maximum output current. Referring to Fig. 12.27(a), we can write for $Q_{P}$,

$$
I_{D P}=I_{Q}=\frac{1}{2} k_{p}^{\prime}\left(\frac{W}{L}\right)_{p}\left(V_{S G P}-\left|V_{t p}\right|\right)^{2}
$$

Substituting $V_{S G P}=\left|V_{t p}\right|+V_{O V}$, where $V_{O V}$ is the magnitude of the quiescent overdrive voltage of $Q_{P}$, gives

$$
I_{Q}=\frac{1}{2} k_{p}^{\prime}\left(\frac{W}{L}\right)_{p} V_{O V}^{2}
$$

Similarly, we obtain for $Q_{N}$

$$
I_{Q}=\frac{1}{2} k_{n}^{\prime}\left(\frac{W}{L}\right)_{n} V_{O V}^{2}
$$

Usually the two transistors are matched,

$$
k_{p}^{\prime}\left(\frac{W}{L}\right)_{p}=k_{n}^{\prime}\left(\frac{W}{L}\right)_{n}=k
$$

Thus,

$$
I_{Q}=\frac{1}{2} k V_{O V}^{2}
$$

Next consider the situation with $v_{I}$ applied, illustrated in Fig. 12.27(b). The voltage at the output of each of the error amplifiers increases by $\mu\left(v_{O}-v_{I}\right)$. Thus $v_{S G P}$ decreases by $\mu\left(v_{O}-v_{I}\right)$ and $v_{G S N}$ increases by $\mu\left(v_{O}-v_{I}\right)$, and we can write

$$
\begin{aligned}
i_{D P} & =\frac{1}{2} k\left[V_{O V}-\mu\left(v_{O}-v_{I}\right)\right]^{2} \\
& =\frac{1}{2} k V_{O V}^{2}\left[1-\mu \frac{v_{O}-v_{I}}{V_{O V}}\right]^{2} \\
& =I_{Q}\left(1-\mu \frac{v_{O}-v_{I}}{V_{O V}}\right)^{2}
\end{aligned}
$$

and

$$
i_{D N}=I_{Q}\left(1+\mu \frac{v_{O}-v_{I}}{V_{O V}}\right)^{2}
$$

At the output node we have

$$
i_{L}=i_{D P}-i_{D N}
$$

Substituting for $i_{L}=v_{O} / R_{L}$ and for $i_{D P}$ and $i_{D N}$ from Eqs. (12.61) and (12.62), and solving the resulting equation to obtain $v_{O}$, results in

$$
v_{O}=\frac{v_{I}}{1+\frac{V_{O V}}{4 \mu I_{Q} R_{L}}}
$$

Usually $\left(V_{O V} / 4 \mu I_{Q} R_{L}\right) \ll 1$, enabling us to express $v_{O}$ as

$$
v_{O} \simeq v_{I}\left(1-\frac{V_{O V}}{4 \mu I_{Q} R_{L}}\right)
$$
Thus the gain error is

$$
\text { Gain error } \equiv \frac{v_{O}}{v_{I}}-1=-\frac{V_{O V}}{4 \mu I_{Q} R_{L}}
$$

Since at the quiescent point,

$$
g_{m p}=g_{m n}=g_{m}=\frac{2 I_{Q}}{V_{O V}}
$$

the gain error can be expressed as

$$
\text { Gain error }=-\frac{1}{2 \mu g_{m} R_{L}}
$$

Thus selecting a large value for $\mu$ results in reducing both the gain error and the output resistance. However, a large $\mu$ can make the quiescent current $I_{Q}$ too dependent on the input offset voltages that are inevitably present in the error amplifiers. Typically, $\mu$ is selected in the range 5 to 10 . Trade-offs are also present in the selection of $I_{Q}$ : A large $I_{Q}$ reduces crossover distortion, $R_{\text {out }}$, and gain error, at the expense of increased quiescent power dissipation.

# Example 12.6 

In this example we explore the design and operation of a class AB common-source output stage of the type shown in Fig. 12.25, required to operate from a $\pm 2.5-\mathrm{V}$ power supply to feed a load resistance $R_{L}=100 \Omega$. The transistors available have $V_{m}=-V_{i p}=0.5 \mathrm{~V}$ and $k_{n}=2.5 k_{p}=250 \mu \mathrm{~A} / \mathrm{V}^{2}$. The gain error is required to be less than $2.5 \%$ and $I_{Q}=1 \mathrm{~mA}$.

## Solution

The gain error is given by Eq. (12.66),

$$
\text { Gain error }=-\frac{V_{O V}}{4 \mu I_{Q} R_{L}}
$$

We are given the required maximum gain error of $-0.025, I_{Q}=1 \mathrm{~mA}$, and $R_{L}=100 \Omega$. In order to keep $\mu$ low and also obtain as high a $g_{m}$ as possible $\left(g_{m}=2 I_{Q} / V_{O V}\right)$, we select $V_{O V}$ to be as low as possible. Practically speaking, $V_{O V}$ is usually 0.1 V to 0.2 V . Selecting $V_{O V}=0.1 \mathrm{~V}$ results in

$$
0.025=\frac{0.1}{4 \times \mu \times 1 \times 10^{-3} \times 100}
$$

which yields

$$
\mu=10
$$

which is within the typically recommended range.
Figure 12.28(a) shows the circuit in the quiescent state with the various dc voltages and currents indicated. Note that the dc voltages $( \pm 1.9 \mathrm{~V})$ at the output of the error amplifiers are the dc bias values,
obtained with zero input signals applied at the amplifier inputs. The required (W/L) ratios of $Q_{N}$ and $Q_{P}$ can be found as follows:

$$
\begin{aligned}
I_{Q} & =\frac{1}{2} I_{0}\left(\frac{W}{L}\right)_{P} V_{O V}^{2} \\
1 \times 10^{-3} & =\frac{1}{2} \times 0.1 \times 10^{-3}\left(\frac{W}{L}\right)_{P} \times(0.1)^{2}
\end{aligned}
$$


(a)

(b)

Figure 12.28 (a) Circuit in the quiescent state; (b) circuit at the point at which $Q_{N}$ turns off; (c) conditions at $v_{O}=v_{O \max }$.
# Example 12.6 continued 



Figure 12.28 continued

Thus,

$$
\begin{gathered}
\left(\frac{W}{L}\right)_{p}=2000 \\
\left(\frac{W}{L}\right)_{n}=\frac{(W / L)_{p}}{k_{n} / k_{p}}=\frac{2000}{2.5}=800
\end{gathered}
$$

Thus $Q_{N}$ and $Q_{P}$ are very large transistors, not an unusual situation in a high-power output stage.
To obtain the output resistance at the quiescent point, we use Eq. (12.57),

$$
R_{\text {out }}=\frac{1}{\mu\left(g_{m p}+g_{m n}\right)}
$$

where

$$
g_{m p}=g_{m n}=\frac{2 I_{Q}}{V_{O V}}=\frac{2 \times 1}{0.1}=20 \mathrm{~mA} / \mathrm{V}
$$

Thus

$$
R_{\text {out }}=\frac{1}{10(0.02+0.02)}=2.5 \Omega
$$

Next we wish to determine the maximum and minimum allowed values of $v_{O}$. Since the circuit is symmetrical, we need to consider only the positive-output or the negative-output case. For $v_{O}$ positive, $Q_{P}$ conducts more of the output current $i_{L}$. Eventually, $Q_{N}$ turns off and $Q_{P}$ conducts all of $i_{L}$. To find
the value of $v_{O}$ at which this occurs, note that $Q_{N}$ turns off when the voltage at its gate drops from the quiescent value of -1.9 V [see Fig. 12.28(a)] to -2 V , at which point $v_{G S N}=V_{m}$. An equal change of -0.1 V appears at the output of the top amplifier, as shown in Fig. 12.28(b). Analysis of the circuit in Fig. 12.28(b) shows that

$$
\begin{aligned}
i_{D P} & =\frac{1}{2} \times 0.1 \times 10^{-3} \times 2000 \times(0.2)^{2}=4 \mathrm{~mA} \\
i_{L} & =i_{D P}=4 \mathrm{~mA} \\
v_{O} & =i_{L} R_{L}=4 \times 10^{-3} \times 100=0.4 \mathrm{~V} \\
v_{I} & =v_{O}+(0.1 / 10)=0.41 \mathrm{~V}
\end{aligned}
$$

For $v_{O}>0.4 \mathrm{~V}, Q_{P}$ must conduct all the current $i_{L}$. The situation at $v_{O}=v_{O_{\max }}$ is illustrated in Fig. 12.28(c). Analysis of this circuit results in

$$
v_{O \max } \simeq 2.05 \mathrm{~V}
$$

and

$$
i_{L \max }=20.5 \mathrm{~mA}
$$

# EXERCISE 

12.14 Suppose it is required to reduce the $W / L$ ratios of $Q_{N}$ and $Q_{P}$ in the circuit considered in the above example by a factor of 2 while keeping $I_{Q}$ at 1 mA . What value should be used for $V_{O V}$ ? What is the new value for the gain error and for $R_{\text {out }}$ at the quiescent point?
Ans. $0.14 \mathrm{~V} ;-3.5 \% ; 3.5 \Omega$

### 12.8 IC Power Amplifiers

A variety of IC power amplifiers are available. Most consist of a high-gain, small-signal amplifier followed by a class AB output stage. Some have overall negative feedback already applied, resulting in a fixed closed-loop voltage gain. Others do not have on-chip feedback and are, in effect, op amps with large output-power capability. In fact, the output current-driving capability of any general-purpose op amp can be increased by cascading it with a class B or class AB output stage and applying overall negative feedback. The additional output stage can be either a discrete circuit or a hybrid IC such as the buffer discussed in Section 12.6. In the following we discuss some power-amplifier examples.## EARLY POWER-OP-AMP PRODUCT:

In 1985 Robert J. Widlar (1937-1991) and Mineo Yamatake at National Semiconductor introduced the LM12, probably the first very-high-power monolithic operational amplifier, offering an order-of-magnitude improvement over its predecessors. Nominally rated at $150-\mathrm{W}$ output, this op amp could sustain 90 W of continuous sine-wave output with a $40-\Omega$ load, while handling up to 800 W of short-term dynamic loading. The design operated from $\pm 35-\mathrm{V}$ supplies to provide a $\pm 25-\mathrm{V}$ signal with a $\pm 10-\mathrm{A}$ output. This monolithic amplifier employed polycrystalline film resistors for thermal stability. It incorporated a variety of novel protection features involving disconnection of the load from the output terminal, turn-on delay while awaiting internal stabilization, overtemperature control, and output-current limiting. It was internally unity-gain compensated with a unity-gain bandwidth of 700 kHz . While now obsolete, the LM12 was a clear forerunner of a modern approach to a vast array of special applications in audio and motor control.

### 12.8.1 A Fixed-Gain IC Power Amplifier

Our first example is the LM380 (a product of National Semiconductor Corporation), which is a fixed-gain monolithic power amplifier. A simplified version of the internal circuit of the amplifier ${ }^{2}$ is shown in Fig. 12.29. The circuit consists of an input differential amplifier utilizing $Q_{1}$ and $Q_{2}$ as emitter followers for input buffering, and $Q_{3}$ and $Q_{4}$ as a differential pair with an emitter resistor $R_{3}$. The two resistors $R_{4}$ and $R_{5}$ provide dc paths to ground for the base currents of $Q_{1}$ and $Q_{2}$, thus enabling the input signal source to be capacitively coupled to either of the two input terminals.

The differential amplifier transistors $Q_{3}$ and $Q_{4}$ are biased by two separate currents: $Q_{3}$ is biased by a current from the dc supply $V_{S}$ through the diode-connected transistor $Q_{10}$, and resistor $R_{1} ; Q_{4}$ is biased by a dc current from the output terminal through $R_{2}$. Under quiescent conditions (i.e., with no input signal applied) the two bias currents will be equal, and the current through and the voltage across $R_{3}$ will be zero. For the emitter current of $Q_{3}$ we can write

$$
I_{3} \simeq \frac{V_{S}-V_{E B 10}-V_{E B 3}-V_{E B 1}}{R_{1}}
$$

where we have neglected the small dc voltage drop across $R_{4}$. Assuming, for simplicity, all $V_{E B}$ to be equal,

$$
I_{3} \simeq \frac{V_{S}-3 V_{E B}}{R_{1}}
$$

For the emitter current of $Q_{4}$ we have

$$
I_{4}=\frac{V_{O}-V_{E B 4}-V_{E B 2}}{R_{2}} \simeq \frac{V_{O}-2 V_{E B}}{R_{2}}
$$

[^0]
[^0]:    ${ }^{2}$ The main objective of showing this circuit is to point out some interesting design features. The circuit is not a detailed schematic diagram of what is actually on the chip.


Figure 12.29 The simplified internal circuit of the LM380 IC power amplifier. (Courtesy National Semiconductor Corporation.)
where $V_{O}$ is the dc voltage at the output, and we have neglected the small drop across $R_{5}$. Equating $I_{5}$ and $I_{4}$ and using the fact that $R_{1}=2 R_{2}$ results in

$$
V_{O}=\frac{1}{2} V_{S}+\frac{1}{2} V_{E B}
$$

Thus the output is biased at approximately half the power-supply voltage, as desired for maximum output voltage swing. An important feature is the dc feedback from the output to the emitter of $Q_{4}$, through $R_{2}$. This dc feedback acts to stabilize the output dc bias voltage at the value in Eq. (12.71). Qualitatively, the dc feedback functions as follows: If for some reason $V_{O}$ increases, a corresponding current increment will flow through $R_{2}$ and into the emitter of $Q_{4}$. Thus the collector current of $Q_{4}$ increases, resulting in a positive increment in the voltage at the base of $Q_{12}$. This, in turn, causes the collector current of $Q_{12}$ to increase, thus bringing down the voltage at the base of $Q_{8}$ and hence $V_{O}$.

Continuing with the description of the circuit in Fig. 12.29, we observe that the differential amplifier $\left(Q_{3}, Q_{4}\right)$ has a current-mirror load composed of $Q_{5}$ and $Q_{6}$ (refer to Chapter 9 , Section 9.5). The single-ended output voltage signal of the first stage appears at the collector of $Q_{6}$ and thus is applied to the base of the second-stage common-emitter amplifier $Q_{12}$. Transistor $Q_{12}$ is biased by the constant-current source $Q_{11}$, which also acts as its active load. In actual operation, however, the load of $Q_{12}$ will be dominated by the reflected resistance due to $R_{L}$. Capacitor $C$ provides frequency compensation (see Chapter 11).


Figure 12.30 Small-signal analysis of the circuit in Fig. 12.29. The circled numbers indicate the order of the analysis steps.

The output stage is class AB , utilizing a compound $p n p$ transistor $\left(Q_{8}\right.$ and $\left.Q_{9}\right)$. Negative feedback is applied from the output to the emitter of $Q_{4}$ via resistor $R_{3}$. To find the closed-loop gain consider the small-signal equivalent circuit shown in Fig. 12.30. Here, we have replaced the second-stage common-emitter amplifier and the output stage with an inverting amplifier block with gain $A$. We shall assume that the amplifier $A$ has high gain and high input resistance, and thus the input signal current into $A$ is negligibly small. Under this assumption, Fig. 12.30 shows the analysis details with an input signal $v_{i}$ applied to the inverting input terminal. The order of the analysis steps is indicated by the circled numbers. Note that since the input differential amplifier has a relatively large resistance, $R_{3}$, in the emitter circuit, most of the applied input voltage appears across $R_{3}$. In other words, the signal voltages across the emitter-base junctions of $Q_{1}, Q_{2}, Q_{3}$, and $Q_{4}$ are small in comparison to the voltage across $R_{3}$. Accordingly, the voltage gain can be found by writing a node equation at the collector of $Q_{6}$ :

$$
\frac{v_{i}}{R_{3}}+\frac{v_{o}}{R_{2}}+\frac{v_{i}}{R_{3}}=0
$$

which yields

$$
\frac{v_{o}}{v_{i}}=-\frac{2 R_{2}}{R_{3}} \simeq-50 \mathrm{~V} / \mathrm{V}
$$
# EXERCISE 

12.15 Denoting the total resistance between the collector of $Q_{h}$ and ground by $R$, show, using Fig. 12.30, that

$$
\frac{v_{o}}{v_{i}}=\frac{-2 R_{2} / R_{3}}{1+\left(R_{2} / A R\right)}
$$

which reduces to $\left(-2 R_{2} / R_{3}\right)$ under the condition that $A R \gg R_{2}$.

As was demonstrated in Chapter 11, one of the advantages of negative feedback is the reduction of nonlinear distortion. This is the case in the circuit of the LM380.

The LM380 is designed to operate from a single supply $V_{S}$ in the range of 12 V to 22 V . The selection of supply voltage depends on the value of $R_{L}$ and the required output power $P_{L}$. The manufacturer supplies curves for the device power dissipation versus output power for a given load resistance and various supply voltages. One such set of curves for $R_{L}=8 \Omega$ is shown in Fig. 12.31. Note the similarity to the class B power dissipation curve of Fig. 12.8. In fact, the reader can easily verify that the location and value of the peaks of the curves in Fig. 12.31 are accurately predicted by Eqs. (12.20) and (12.21), respectively (where $V_{C C}=\frac{1}{2} V_{S}$ ). The line labeled " $3 \%$ distortion level" in Fig. 12.31 is the locus of the points on the various curves at


Figure 12.31 Power dissipation $\left(P_{p}\right)$ versus output power $\left(P_{L}\right)$ for the LM380 with $R_{L}=8 \Omega$. (Courtesy National Semiconductor Corporation.)
which the distortion (THD) reaches $3 \%$. A THD of $3 \%$ represents the onset of peak clipping due to output-transistor saturation.

# EXERCISE 

D12.16 It is required to use the LM380 to drive an 8- $\Omega$ loudspeaker. Use the curves of Fig. 12.31 to determine the maximum power supply possible while limiting the maximum power dissipation to 2.9 W . If for this application a $3 \%$ THD is allowed, find $P_{L}$ and the peak-to-peak output voltage. Ans. $20 \mathrm{~V} ; 4.2 \mathrm{~W} ; 16.4 \mathrm{~V}$

### 12.8.2 The Bridge Amplifier

We conclude this section with a discussion of a circuit configuration that is popular in high-power applications. This is the bridge amplifier configuration shown in Fig. 12.32 utilizing two power op amps, $\mathrm{A}_{1}$ and $\mathrm{A}_{2}$. While $\mathrm{A}_{1}$ is connected in the noninverting configuration with a gain $K=1+\left(R_{2} / R_{1}\right), \mathrm{A}_{2}$ is connected as an inverting amplifier with a gain of equal magnitude $K=R_{4} / R_{3}$. The load $R_{L}$ is floating and is connected between the output terminals of the two op amps.

If $v_{L}$ is a sinusoid with amplitude $\hat{V}_{i}$, the voltage swing at the output of each op amp will be $\pm K \hat{V}_{i}$, and that across the load will be $\pm 2 K \hat{V}_{i}$. Thus, with op amps operated from $\pm 15-\mathrm{V}$ supplies and capable of providing, say, a $\pm 12-\mathrm{V}$ output swing, an output swing of $\pm 24 \mathrm{~V}$ can be obtained across the load of the bridge amplifier.

In designing bridge amplifiers, note should be taken of the fact that the peak current drawn from each op amp is $2 K \hat{V}_{i} / R_{L}$. This effect can be taken into account by considering the load seen by each op amp (to ground) to be $R_{L} / 2$.


Figure 12.32 The bridge amplifier configuration.
# EXERCISE 

12.17 Consider the circuit of Fig. 12.32 with $R_{1}=R_{3}=10 \mathrm{k} \Omega, R_{2}=5 \mathrm{k} \Omega, R_{4}=15 \mathrm{k} \Omega$, and $R_{L}=8 \Omega$. Find the voltage gain and the input resistance. The power supply used is $\pm 18 \mathrm{~V}$. If $v_{I}$ is a $20-\mathrm{V}$ peak-to-peak sine wave, what is the peak-to-peak output voltage? What is the peak load current? What is the load power?
Ans. $3 \mathrm{~V} / \mathrm{V} ; 10 \mathrm{k} \Omega ; 60 \mathrm{~V} ; 3.75 \mathrm{~A} ; 56.25 \mathrm{~W}$

### 12.9 Class D Power Amplifiers

The class $\mathrm{A}, \mathrm{B}$, and AB output stages studied in the previous sections are linear amplifiers. They operate basically as voltage followers, reproducing across the load a replica of the input signal. The output transistors in these amplifiers can dissipate considerable power. This occurs because when providing a large current to the load, the voltage across the transistors can be relatively large. The result is a relatively low power-conversion efficiency, ranging from a theoretical maximum of $25 \%$ for the class A stage to $78.5 \%$ for the class B and AB stages. In practice, only $50 \%$ to $60 \%$ efficiencies are achieved in the class B and AB stages.

A very different approach to power amplification, utilized frequently in audio amplifier design, is found in the class D stage. Here, the power dissipated in the output transistors is reduced, theoretically to zero, by operating the transistors as on-off switches. ${ }^{3}$ For this to be possible, the audio-frequency signal is converted to a pulse format and the pulses are utilized to operate the output transistor switches. Commonly, pulsewidth modulation (PWM) is utilized. The PWM signal has a frequency at least 10 times higher than the highest audio frequency signal to be amplified. While the amplitude and frequency of the PWM signal remain constant, the magnitude of the audio signal is encoded in the width of the pulses. Specifically, the width of successive pulses is made proportional to the corresponding instantaneous magnitude of the audio signal $v_{A}$.

Figure 12.33(a) shows how a PWM signal can be generated. The magnitude of the audio signal $v_{A}$ is compared to that of a triangular wave $v_{T}$ whose frequency in the example shown is 10 times that of $v_{A}$. The comparison is performed by a circuit building block known as a comparator, shown in Fig. 12.33(c) as a black box. We shall study comparators in Chapter 18. Observe that whenever the magnitude of $v_{A}$ exceeds that of $v_{T}$, the comparator output will be at its high level, $V^{+}$. Conversely, when the magnitude of $v_{A}$ falls below that of $v_{T}$, the comparator output goes to its low level, $V^{-}$. Thus, at the output of the comparator we obtain the pulse waveform shown in Fig. 12.33(b). This waveform has the same frequency $f_{s}$ of the triangular wave and has standard high and low levels determined by the comparator design. The width of each pulse, $t_{P}$, and hence the duty ratio $\left(t_{P} / T\right)$, where $T=1 / f_{s}$, is proportional to the corresponding instantaneous value of $v_{A}$. This is the PWM signal.

[^0]
[^0]:    ${ }^{3}$ An ideal switch has a zero "on" resistance and thus dissipates no power when it is closed and delivering the high load current. Also, it has infinite off resistance and thus dissipates zero power when it is open.


Figure 12.33 (a) By comparing the magnitude of the audio signal $v_{A}$ to that of a triangular wave $v_{T}$, the PWM signal in (b) can be generated by using the comparator in (c). (d) The original signal $v_{A}$ can be recovered from the PWM signal by means of a low-pass filter with a passband frequency $f_{p}$ slightly larger than the highest audio-frequency component of $v_{A}$.

Since the average of a pulse waveform is determined by its duty ratio, the original audio signal $v_{A}$ can be recovered from the PWM signal by taking the time average of the latter. This in turn can be achieved by passing the PWM signal through a low-pass filter (LPF) whose cutoff frequency is just above the highest frequency of the audio signal. ${ }^{4}$ This is shown in block-diagram form in Fig. 12.33(d). The design of low-pass filters will be studied in Chapter 17.

HANS
CAMENZIND-THE
INVENTOR OF
THE CLASS D
AMPLIFIER:

In 1966, while working for Mallory (now Duracell), Swiss-born engineer Hans Camenzind (1934-2012) filed a patent on "Pulse-Width Modulation Circuits," introducing the two-state or class D amplifier. Camenzind had begun his U.S. career in 1960, at Transitron, an early semiconductor manufacturer. Later, in 1969, while at Mallory, he filed a second patent on a "Two-State Amplifier." The class D amplifier has revolutionized the field of high-efficiency compact amplifiers. Today these devices, ubiquitous in mobile phones, also see application at enormous power levels for live-performance sound systems with thousands of watts per channel.

[^0]
[^0]:    ${ }^{4}$ The PWM signal has frequency components at $f_{c}$ and its harmonics, all of which will be higher than the frequency of the audio signal and thus can be easily removed by the low-pass filter.


Figure 12.34 Two schemes for driving the load of a class D amplifier. The differential scheme in (b) results in doubling the voltage excursion across the load.

Having obtained a pulse waveform in which the audio signal is encoded, we now show how the PWM signal can be used to drive the switches that supply the load power. Two alternative schemes for accomplishing this task are shown in Fig. 12.34. In Fig. 12.34(a), the logical inverse of PWM, denoted $\overline{\mathrm{PWM}}$ and obtained from the comparator by simply exchanging the terminals to which $v_{A}$ and $v_{T}$ are applied, is used to drive two complementary MOS switches $Q_{P}$ and $Q_{N}$. These switches connect the output node alternatively to $V_{D D}$ and ground, in effect producing a high-power version of PWM at their drain node. This is the signal applied to the load (shown as a loudspeaker) through a low-pass filter. It follows that $v_{A}$ appears across the load and the large current required by the low-resistance load is supplied by $Q_{P}$ and $Q_{N}$.

To double the voltage excursion across the load, the scheme in Fig. 12.34(b) can be utilized. Here both PWM and its logical inverse $\overline{\mathrm{PWM}}$ are used in a differential driving arrangement. When PWM is high and thus $\overline{\mathrm{PWM}}$ is low, $Q_{3}$ and $Q_{2}$ are turned on while $Q_{1}$ and $Q_{4}$ are off. Thus current flows from $V_{D D}$ to ground through the load (from right to left). The opposite happens when PWM is low. Thus the voltage across the load will be twice that obtained with
the arrangement in Fig. 12.34(a). The circuit of the differential driving arrangement is known as an H bridge ${ }^{5}$ and can result in a maximum sinusoidal output voltage of amplitude $V_{D D}$.

The description above leads to the conclusion that the power-conversion efficiency of a class D amplifier is $100 \%$. This, of course, is only a theoretical limit. In practice, the power transistors exhibit finite on-resistances that lead to conduction losses. Also, every time the power MOSFETs are turned on and off, the gate and load capacitances are charged and discharged, resulting in power loss in the driving circuit. In addition, due to the finite switching speed of power MOSFETs, there will be a momentary short between $V_{D D}$ and ground during every switching cycle. The resulting shoot-through current is exactly the same as that encountered in a CMOS inverter (see Chapter 14), but it could be of much larger magnitude owing to the large transistor size. All these sources of power dissipation cause the power-conversion efficiency to be in the $85 \%$ to $95 \%$ range, still much larger than is achieved in a class AB stage.

As a final note, distortion in the class D amplifier can be contributed by the PWM modulation scheme, by inaccuracy of the duty ratio at the output node due to finite switching speeds of the power MOSFETs, and by the quality factor of the $L$ and $C$ elements in the output filter. Class D amplifiers typically exhibit THD of $0.1 \%$ to $1 \%$ at best. Another imperfection of the class D amplifiers is the generation of unwanted switching noise, usually in the inaudible range as electromagnetic interference. As a result, class D amplifiers are most useful in applications where power-conversion efficiency is of paramount importance. Class A and AB amplifiers can achieve THD figures of less than $0.01 \%$ and are mostly used in high-fidelity applications.

# EXERCISES 

12.18 Consider the comparator in Fig. 12.33(c) with the triangular wave $v_{T}$ having $\pm 10 \mathrm{~V}$ peak voltages and comparator output levels of $\pm 10 \mathrm{~V}$. Find the duty ratio $D$ and the average of the output voltage for the case in which $v_{A}$ is a constant voltage of magnitude (a) 0 V ; (b) +5 V ; (c) +10 V ; (d) -5 V ; (e) -10 V
Ans. (a) $50 \%, 0 \mathrm{~V}$; (b) $75 \%,+5 \mathrm{~V}$; (c) $100 \%,+10 \mathrm{~V}$; (d) $25 \%,-5 \mathrm{~V}$; (e) $0 \% ;-10 \mathrm{~V}$
12.19 If the audio signal $v_{A}$ has a frequency spectrum of 20 Hz to 20 kHz , what is an appropriate value for $f_{s}$ ? Now if the low-pass filter is of second order, with its passband edge at 20 kHz and its gain falling off at $40 \mathrm{~dB} /$ decade, what is the attenuation encountered by the PWM component with frequency $f_{s}$ ? Ans. $200 \mathrm{kHz} ; 40 \mathrm{~dB}$
12.20 If the differential switching scheme shown in Fig. 12.34(b) is utilized and $v_{A}$ is a sine wave, what is the maximum peak amplitude achieved across $R_{L}$ and what is the maximum power delivered to $R_{L}$ ? Evaluate these quantities for $V_{D D}=35 \mathrm{~V}$ and $R_{L}=8 \Omega$. Now, if the power-conversion efficiency is $90 \%$, what is the power delivered by the power supplies?
Ans. $V_{D D}, \frac{V_{D D}^{2}}{2 R_{L}} ; 35 \mathrm{~V}, 76.6 \mathrm{~W} ; 85.1 \mathrm{~W}$

[^0]
[^0]:    ${ }^{5}$ The name H arises from the resemblance of the circuit diagram to the letter H : The switches represent the vertical strokes of H and the load with the filter represents the horizontal stroke.
# 12.10 Power Transistors 

The BJTs and MOSFETs that are utilized in the design of the output stages and power amplifiers studied in this chapter can be called upon to conduct currents in the ampere range, to support voltages in excess of 100 V , and to withstand power dissipation in the tens-of-watts range. Hence, they are called power transistors. In this section, we study the characteristics, specifications, and thermal operation of power transistors. ${ }^{6}$

### 12.10.1 Packages and Heat Sinks

Power transistors are basically larger versions of their small-signal counterparts; hence they retain similar characteristics. However, as will be explained shortly, their structures are modified for optimal voltage and current capabilities. Also, discrete power transistors are housed in special packages such as those shown in Fig. 12.35. The packages are usually mounted on heat sinks, special metal surfaces whose function is to facilitate the conduction of heat away from the transistor, thus keeping its internal temperature within safe operating limits. We shall have more to say about thermal issues in Section 12.10.4. A typical heat sink is shown in Fig. 12.36.


Figure 12.35 Most popular packages for power transistors: (a) TO-03 metal package; (b) TO-220 plastic package.


Figure 12.36 Typical heat sink.

[^0]
[^0]:    ${ }^{6}$ Other semiconductor devices utilized in power electronic applications include thyristors and silicon-controlled rectifiers (SCRs). These are usually used in applications requiring much higher current and voltage ratings than those studied in this chapter. As well, a more recent device, the insulated-gate bipolar transistor, or IGBT, has a merged MOS/bipolar structure and combines the advantages of both. It is used in very high current applications and is not studied in this book.